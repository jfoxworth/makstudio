(function(l,ya){"object"===typeof exports&&"undefined"!==typeof module?ya(exports):"function"===typeof define&&define.amd?define(["exports"],ya):ya(l.THREE={})})(this,function(l){function ya(){}function A(a,b){this.x=a||0;this.y=b||0}function J(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function fa(a,b,c,d){this._x=a||0;this._y=b||0;this._z=c||0;this._w=void 0!==d?d:1}function p(a,
b,c){this.x=a||0;this.y=b||0;this.z=c||0}function ra(){this.elements=[1,0,0,0,1,0,0,0,1];0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function T(a,b,c,d,e,f,g,h,k,m){Object.defineProperty(this,"id",{value:Jf++});this.uuid=G.generateUUID();this.name="";this.image=void 0!==a?a:T.DEFAULT_IMAGE;this.mipmaps=[];this.mapping=void 0!==b?b:T.DEFAULT_MAPPING;this.wrapS=void 0!==c?c:1001;this.wrapT=void 0!==d?d:1001;this.magFilter=void 0!==
e?e:1006;this.minFilter=void 0!==f?f:1008;this.anisotropy=void 0!==k?k:1;this.format=void 0!==g?g:1023;this.type=void 0!==h?h:1009;this.offset=new A(0,0);this.repeat=new A(1,1);this.center=new A(0,0);this.rotation=0;this.matrixAutoUpdate=!0;this.matrix=new ra;this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.encoding=void 0!==m?m:3E3;this.version=0;this.onUpdate=null}function V(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.w=void 0!==d?d:1}function gb(a,
b,c){this.width=a;this.height=b;this.scissor=new V(0,0,a,b);this.scissorTest=!1;this.viewport=new V(0,0,a,b);c=c||{};void 0===c.minFilter&&(c.minFilter=1006);this.texture=new T(void 0,void 0,c.wrapS,c.wrapT,c.magFilter,c.minFilter,c.format,c.type,c.anisotropy,c.encoding);this.texture.generateMipmaps=void 0!==c.generateMipmaps?c.generateMipmaps:!0;this.depthBuffer=void 0!==c.depthBuffer?c.depthBuffer:!0;this.stencilBuffer=void 0!==c.stencilBuffer?c.stencilBuffer:!0;this.depthTexture=void 0!==c.depthTexture?
c.depthTexture:null}function Hb(a,b,c){gb.call(this,a,b,c);this.activeMipMapLevel=this.activeCubeFace=0}function hb(a,b,c,d,e,f,g,h,k,m,q,n){T.call(this,null,f,g,h,k,m,d,e,q,n);this.image={data:a,width:b,height:c};this.magFilter=void 0!==k?k:1003;this.minFilter=void 0!==m?m:1003;this.flipY=this.generateMipmaps=!1;this.unpackAlignment=1}function Sa(a,b){this.min=void 0!==a?a:new p(Infinity,Infinity,Infinity);this.max=void 0!==b?b:new p(-Infinity,-Infinity,-Infinity)}function Da(a,b){this.center=void 0!==
a?a:new p;this.radius=void 0!==b?b:0}function Ma(a,b){this.normal=void 0!==a?a:new p(1,0,0);this.constant=void 0!==b?b:0}function od(a,b,c,d,e,f){this.planes=[void 0!==a?a:new Ma,void 0!==b?b:new Ma,void 0!==c?c:new Ma,void 0!==d?d:new Ma,void 0!==e?e:new Ma,void 0!==f?f:new Ma]}function H(a,b,c){return void 0===b&&void 0===c?this.set(a):this.setRGB(a,b,c)}function Sd(){function a(e,f){!1!==c&&(d(e,f),b.requestAnimationFrame(a))}var b=null,c=!1,d=null;return{start:function(){!0!==c&&null!==d&&(b.requestAnimationFrame(a),
c=!0)},stop:function(){c=!1},setAnimationLoop:function(a){d=a},setContext:function(a){b=a}}}function Kf(a){function b(b,c){var d=b.array,e=b.dynamic?a.DYNAMIC_DRAW:a.STATIC_DRAW,h=a.createBuffer();a.bindBuffer(c,h);a.bufferData(c,d,e);b.onUploadCallback();c=a.FLOAT;d instanceof Float32Array?c=a.FLOAT:d instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):d instanceof Uint16Array?c=a.UNSIGNED_SHORT:d instanceof Int16Array?c=a.SHORT:d instanceof
Uint32Array?c=a.UNSIGNED_INT:d instanceof Int32Array?c=a.INT:d instanceof Int8Array?c=a.BYTE:d instanceof Uint8Array&&(c=a.UNSIGNED_BYTE);return{buffer:h,type:c,bytesPerElement:d.BYTES_PER_ELEMENT,version:b.version}}var c=new WeakMap;return{get:function(a){a.isInterleavedBufferAttribute&&(a=a.data);return c.get(a)},remove:function(b){b.isInterleavedBufferAttribute&&(b=b.data);var d=c.get(b);d&&(a.deleteBuffer(d.buffer),c.delete(b))},update:function(d,e){d.isInterleavedBufferAttribute&&(d=d.data);
var f=c.get(d);if(void 0===f)c.set(d,b(d,e));else if(f.version<d.version){var g=d,h=g.array,k=g.updateRange;a.bindBuffer(e,f.buffer);!1===g.dynamic?a.bufferData(e,h,a.STATIC_DRAW):-1===k.count?a.bufferSubData(e,0,h):0===k.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(a.bufferSubData(e,k.offset*h.BYTES_PER_ELEMENT,h.subarray(k.offset,k.offset+k.count)),k.count=
-1);f.version=d.version}}}}function ib(a,b,c,d){this._x=a||0;this._y=b||0;this._z=c||0;this._order=d||ib.DefaultOrder}function Td(){this.mask=1}function D(){Object.defineProperty(this,"id",{value:Lf++});this.uuid=G.generateUUID();this.name="";this.type="Object3D";this.parent=null;this.children=[];this.up=D.DefaultUp.clone();var a=new p,b=new ib,c=new fa,d=new p(1,1,1);b.onChange(function(){c.setFromEuler(b,!1)});c.onChange(function(){b.setFromQuaternion(c,void 0,!1)});Object.defineProperties(this,
{position:{enumerable:!0,value:a},rotation:{enumerable:!0,value:b},quaternion:{enumerable:!0,value:c},scale:{enumerable:!0,value:d},modelViewMatrix:{value:new J},normalMatrix:{value:new ra}});this.matrix=new J;this.matrixWorld=new J;this.matrixAutoUpdate=D.DefaultMatrixAutoUpdate;this.matrixWorldNeedsUpdate=!1;this.layers=new Td;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.renderOrder=0;this.userData={}}function Na(){D.call(this);this.type="Camera";this.matrixWorldInverse=
new J;this.projectionMatrix=new J}function Ib(a,b,c,d,e,f){Na.call(this);this.type="OrthographicCamera";this.zoom=1;this.view=null;this.left=a;this.right=b;this.top=c;this.bottom=d;this.near=void 0!==e?e:.1;this.far=void 0!==f?f:2E3;this.updateProjectionMatrix()}function Ta(a,b,c,d,e,f){this.a=a;this.b=b;this.c=c;this.normal=d&&d.isVector3?d:new p;this.vertexNormals=Array.isArray(d)?d:[];this.color=e&&e.isColor?e:new H;this.vertexColors=Array.isArray(e)?e:[];this.materialIndex=void 0!==f?f:0}function R(){Object.defineProperty(this,
"id",{value:Mf+=2});this.uuid=G.generateUUID();this.name="";this.type="Geometry";this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function Q(a,b,c){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");
this.name="";this.array=a;this.itemSize=b;this.count=void 0!==a?a.length/b:0;this.normalized=!0===c;this.dynamic=!1;this.updateRange={offset:0,count:-1};this.version=0}function pc(a,b,c){Q.call(this,new Int8Array(a),b,c)}function qc(a,b,c){Q.call(this,new Uint8Array(a),b,c)}function rc(a,b,c){Q.call(this,new Uint8ClampedArray(a),b,c)}function sc(a,b,c){Q.call(this,new Int16Array(a),b,c)}function jb(a,b,c){Q.call(this,new Uint16Array(a),b,c)}function tc(a,b,c){Q.call(this,new Int32Array(a),b,c)}function kb(a,
b,c){Q.call(this,new Uint32Array(a),b,c)}function z(a,b,c){Q.call(this,new Float32Array(a),b,c)}function uc(a,b,c){Q.call(this,new Float64Array(a),b,c)}function Fe(){this.vertices=[];this.normals=[];this.colors=[];this.uvs=[];this.uvs2=[];this.groups=[];this.morphTargets={};this.skinWeights=[];this.skinIndices=[];this.boundingSphere=this.boundingBox=null;this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function Ge(a){if(0===a.length)return-Infinity;
for(var b=a[0],c=1,d=a.length;c<d;++c)a[c]>b&&(b=a[c]);return b}function C(){Object.defineProperty(this,"id",{value:Nf+=2});this.uuid=G.generateUUID();this.name="";this.type="BufferGeometry";this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;this.drawRange={start:0,count:Infinity};this.userData={}}function Jb(a,b,c,d,e,f){R.call(this);this.type="BoxGeometry";this.parameters={width:a,height:b,depth:c,widthSegments:d,heightSegments:e,
depthSegments:f};this.fromBufferGeometry(new lb(a,b,c,d,e,f));this.mergeVertices()}function lb(a,b,c,d,e,f){function g(a,b,c,d,e,f,g,l,K,E,vc){var t=f/K,u=g/E,x=f/2,v=g/2,I=l/2;g=K+1;var y=E+1,B=f=0,P,A,z=new p;for(A=0;A<y;A++){var D=A*u-v;for(P=0;P<g;P++)z[a]=(P*t-x)*d,z[b]=D*e,z[c]=I,m.push(z.x,z.y,z.z),z[a]=0,z[b]=0,z[c]=0<l?1:-1,q.push(z.x,z.y,z.z),n.push(P/K),n.push(1-A/E),f+=1}for(A=0;A<E;A++)for(P=0;P<K;P++)a=r+P+g*(A+1),b=r+(P+1)+g*(A+1),c=r+(P+1)+g*A,k.push(r+P+g*A,a,c),k.push(a,b,c),B+=
6;h.addGroup(w,B,vc);w+=B;r+=f}C.call(this);this.type="BoxBufferGeometry";this.parameters={width:a,height:b,depth:c,widthSegments:d,heightSegments:e,depthSegments:f};var h=this;a=a||1;b=b||1;c=c||1;d=Math.floor(d)||1;e=Math.floor(e)||1;f=Math.floor(f)||1;var k=[],m=[],q=[],n=[],r=0,w=0;g("z","y","x",-1,-1,c,b,a,f,e,0);g("z","y","x",1,-1,c,b,-a,f,e,1);g("x","z","y",1,1,a,c,b,d,f,2);g("x","z","y",1,-1,a,c,-b,d,f,3);g("x","y","z",1,-1,a,b,c,d,e,4);g("x","y","z",-1,-1,a,b,-c,d,e,5);this.setIndex(k);this.addAttribute("position",
new z(m,3));this.addAttribute("normal",new z(q,3));this.addAttribute("uv",new z(n,2))}function wc(a,b,c,d){R.call(this);this.type="PlaneGeometry";this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};this.fromBufferGeometry(new mb(a,b,c,d));this.mergeVertices()}function mb(a,b,c,d){C.call(this);this.type="PlaneBufferGeometry";this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};a=a||1;b=b||1;var e=a/2,f=b/2;c=Math.floor(c)||1;d=Math.floor(d)||1;var g=c+1,h=d+1,k=a/c,m=
b/d,q=[],n=[],r=[],w=[];for(a=0;a<h;a++){var t=a*m-f;for(b=0;b<g;b++)n.push(b*k-e,-t,0),r.push(0,0,1),w.push(b/c),w.push(1-a/d)}for(a=0;a<d;a++)for(b=0;b<c;b++)e=b+g*(a+1),f=b+1+g*(a+1),h=b+1+g*a,q.push(b+g*a,e,h),q.push(e,f,h);this.setIndex(q);this.addAttribute("position",new z(n,3));this.addAttribute("normal",new z(r,3));this.addAttribute("uv",new z(w,2))}function O(){Object.defineProperty(this,"id",{value:Of++});this.uuid=G.generateUUID();this.name="";this.type="Material";this.lights=this.fog=
!0;this.blending=1;this.side=0;this.flatShading=!1;this.vertexColors=0;this.opacity=1;this.transparent=!1;this.blendSrc=204;this.blendDst=205;this.blendEquation=100;this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null;this.depthFunc=3;this.depthWrite=this.depthTest=!0;this.clippingPlanes=null;this.clipShadows=this.clipIntersection=!1;this.shadowSide=null;this.colorWrite=!0;this.precision=null;this.polygonOffset=!1;this.polygonOffsetUnits=this.polygonOffsetFactor=0;this.dithering=!1;
this.alphaTest=0;this.premultipliedAlpha=!1;this.overdraw=0;this.visible=!0;this.userData={};this.needsUpdate=!0;this.attributes=null}function da(a){O.call(this);this.type="MeshBasicMaterial";this.color=new H(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.envMap=this.alphaMap=this.specularMap=null;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap=
"round";this.lights=this.morphTargets=this.skinning=!1;this.setValues(a)}function ta(a){O.call(this);this.type="ShaderMaterial";this.defines={};this.uniforms={};this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}";this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=
!1;this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1};this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]};this.index0AttributeName=void 0;this.uniformsNeedUpdate=!1;this.attributes=null;void 0!==a&&this.setValues(a)}function nb(a,b){this.origin=void 0!==a?a:new p;this.direction=void 0!==b?b:new p}function ja(a,b,c){this.a=void 0!==a?a:new p;this.b=void 0!==b?b:new p;this.c=void 0!==c?c:new p}function ka(a,b){D.call(this);this.type="Mesh";this.geometry=void 0!==
a?a:new C;this.material=void 0!==b?b:new da({color:16777215*Math.random()});this.drawMode=0;this.updateMorphTargets()}function Pf(a,b,c,d){function e(a,c){b.buffers.color.setClear(a.r,a.g,a.b,c,d)}var f=new H(0),g=0,h,k,m;return{getClearColor:function(){return f},setClearColor:function(a,b){f.set(a);g=void 0!==b?b:1;e(f,g)},getClearAlpha:function(){return g},setClearAlpha:function(a){g=a;e(f,g)},render:function(b,d,r,w){d=d.background;null===d?e(f,g):d&&d.isColor&&(e(d,1),w=!0);(a.autoClear||w)&&
a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil);d&&d.isCubeTexture?(void 0===m&&(m=new ka(new lb(1,1,1),new ta({uniforms:ob.cube.uniforms,vertexShader:ob.cube.vertexShader,fragmentShader:ob.cube.fragmentShader,side:1,depthTest:!0,depthWrite:!1,fog:!1})),m.geometry.removeAttribute("normal"),m.geometry.removeAttribute("uv"),m.onBeforeRender=function(a,b,c){this.matrixWorld.copyPosition(c.matrixWorld)},c.update(m)),m.material.uniforms.tCube.value=d,b.push(m,m.geometry,m.material,0,null)):
d&&d.isTexture&&(void 0===h&&(h=new Ib(-1,1,1,-1,0,1),k=new ka(new mb(2,2),new da({depthTest:!1,depthWrite:!1,fog:!1})),c.update(k)),k.material.map=d,a.renderBufferDirect(h,null,k.geometry,k.material,k,null))}}}function Qf(a,b,c,d){var e;this.setMode=function(a){e=a};this.render=function(b,d){a.drawArrays(e,b,d);c.update(d,e)};this.renderInstances=function(f,g,h){if(d.isWebGL2)var k=a;else if(k=b.get("ANGLE_instanced_arrays"),null===k){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");
return}k[d.isWebGL2?"drawArraysInstanced":"drawArraysInstancedANGLE"](e,g,h,f.maxInstancedCount);c.update(h,e,f.maxInstancedCount)}}function Rf(a,b,c){function d(b){if("highp"===b){if(0<a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.HIGH_FLOAT).precision&&0<a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision)return"highp";b="mediump"}return"mediump"===b&&0<a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.MEDIUM_FLOAT).precision&&0<a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.MEDIUM_FLOAT).precision?
"mediump":"lowp"}var e,f="undefined"!==typeof WebGL2RenderingContext&&a instanceof WebGL2RenderingContext,g=void 0!==c.precision?c.precision:"highp",h=d(g);h!==g&&(console.warn("THREE.WebGLRenderer:",g,"not supported, using",h,"instead."),g=h);c=!0===c.logarithmicDepthBuffer;h=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS);var k=a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS),m=a.getParameter(a.MAX_TEXTURE_SIZE),q=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE),n=a.getParameter(a.MAX_VERTEX_ATTRIBS),r=a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS),
w=a.getParameter(a.MAX_VARYING_VECTORS),t=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS),l=0<k,x=f||!!b.get("OES_texture_float");return{isWebGL2:f,getMaxAnisotropy:function(){if(void 0!==e)return e;var c=b.get("EXT_texture_filter_anisotropic");return e=null!==c?a.getParameter(c.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:d,precision:g,logarithmicDepthBuffer:c,maxTextures:h,maxVertexTextures:k,maxTextureSize:m,maxCubemapSize:q,maxAttributes:n,maxVertexUniforms:r,maxVaryings:w,maxFragmentUniforms:t,
vertexTextures:l,floatFragmentTextures:x,floatVertexTextures:l&&x}}function Sf(){function a(){m.value!==d&&(m.value=d,m.needsUpdate=0<e);c.numPlanes=e;c.numIntersection=0}function b(a,b,d,e){var f=null!==a?a.length:0,g=null;if(0!==f){g=m.value;if(!0!==e||null===g){e=d+4*f;b=b.matrixWorldInverse;k.getNormalMatrix(b);if(null===g||g.length<e)g=new Float32Array(e);for(e=0;e!==f;++e,d+=4)h.copy(a[e]).applyMatrix4(b,k),h.normal.toArray(g,d),g[d+3]=h.constant}m.value=g;m.needsUpdate=!0}c.numPlanes=f;return g}
var c=this,d=null,e=0,f=!1,g=!1,h=new Ma,k=new ra,m={value:null,needsUpdate:!1};this.uniform=m;this.numIntersection=this.numPlanes=0;this.init=function(a,c,g){var h=0!==a.length||c||0!==e||f;f=c;d=b(a,g,0);e=a.length;return h};this.beginShadows=function(){g=!0;b(null)};this.endShadows=function(){g=!1;a()};this.setState=function(c,h,k,w,t,l){if(!f||null===c||0===c.length||g&&!k)g?b(null):a();else{k=g?0:e;var n=4*k,q=t.clippingState||null;m.value=q;q=b(c,w,n,l);for(c=0;c!==n;++c)q[c]=d[c];t.clippingState=
q;this.numIntersection=h?this.numPlanes:0;this.numPlanes+=k}}}function Tf(a){var b={};return{get:function(c){if(void 0!==b[c])return b[c];switch(c){case "WEBGL_depth_texture":var d=a.getExtension("WEBGL_depth_texture")||a.getExtension("MOZ_WEBGL_depth_texture")||a.getExtension("WEBKIT_WEBGL_depth_texture");break;case "EXT_texture_filter_anisotropic":d=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");
break;case "WEBGL_compressed_texture_s3tc":d=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case "WEBGL_compressed_texture_pvrtc":d=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:d=a.getExtension(c)}null===d&&console.warn("THREE.WebGLRenderer: "+c+" extension not supported.");return b[c]=d}}}function Uf(a,b,c){function d(a){var g=
a.target;a=e[g.id];null!==a.index&&b.remove(a.index);for(var k in a.attributes)b.remove(a.attributes[k]);g.removeEventListener("dispose",d);delete e[g.id];if(k=f[a.id])b.remove(k),delete f[a.id];c.memory.geometries--}var e={},f={};return{get:function(a,b){var f=e[b.id];if(f)return f;b.addEventListener("dispose",d);b.isBufferGeometry?f=b:b.isGeometry&&(void 0===b._bufferGeometry&&(b._bufferGeometry=(new C).setFromObject(a)),f=b._bufferGeometry);e[b.id]=f;c.memory.geometries++;return f},update:function(c){var d=
c.index,e=c.attributes;null!==d&&b.update(d,a.ELEMENT_ARRAY_BUFFER);for(var f in e)b.update(e[f],a.ARRAY_BUFFER);c=c.morphAttributes;for(f in c){d=c[f];e=0;for(var g=d.length;e<g;e++)b.update(d[e],a.ARRAY_BUFFER)}},getWireframeAttribute:function(c){var d=f[c.id];if(d)return d;d=[];var e=c.index,g=c.attributes;if(null!==e){e=e.array;g=0;for(var q=e.length;g<q;g+=3){var n=e[g+0],r=e[g+1],w=e[g+2];d.push(n,r,r,w,w,n)}}else for(e=g.position.array,g=0,q=e.length/3-1;g<q;g+=3)n=g+0,r=g+1,w=g+2,d.push(n,
r,r,w,w,n);d=new (65535<Ge(d)?kb:jb)(d,1);b.update(d,a.ELEMENT_ARRAY_BUFFER);return f[c.id]=d}}}function Vf(a,b,c,d){var e,f,g;this.setMode=function(a){e=a};this.setIndex=function(a){f=a.type;g=a.bytesPerElement};this.render=function(b,d){a.drawElements(e,d,f,b*g);c.update(d,e)};this.renderInstances=function(h,k,m){if(d.isWebGL2)var q=a;else if(q=b.get("ANGLE_instanced_arrays"),null===q){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");
return}q[d.isWebGL2?"drawElementsInstanced":"drawElementsInstancedANGLE"](e,m,f,k*g,h.maxInstancedCount);c.update(m,e,h.maxInstancedCount)}}function Wf(a){var b={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:b,programs:null,autoReset:!0,reset:function(){b.frame++;b.calls=0;b.triangles=0;b.points=0;b.lines=0},update:function(c,d,e){e=e||1;b.calls++;switch(d){case a.TRIANGLES:b.triangles+=c/3*e;break;case a.TRIANGLE_STRIP:case a.TRIANGLE_FAN:b.triangles+=
e*(c-2);break;case a.LINES:b.lines+=c/2*e;break;case a.LINE_STRIP:b.lines+=e*(c-1);break;case a.LINE_LOOP:b.lines+=e*c;break;case a.POINTS:b.points+=e*c;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",d)}}}}function Xf(a,b){return Math.abs(b[1])-Math.abs(a[1])}function Yf(a){var b={},c=new Float32Array(8);return{update:function(d,e,f,g){var h=d.morphTargetInfluences,k=h.length;d=b[e.id];if(void 0===d){d=[];for(var m=0;m<k;m++)d[m]=[m,0];b[e.id]=d}var q=f.morphTargets&&e.morphAttributes.position;
f=f.morphNormals&&e.morphAttributes.normal;for(m=0;m<k;m++){var n=d[m];0!==n[1]&&(q&&e.removeAttribute("morphTarget"+m),f&&e.removeAttribute("morphNormal"+m))}for(m=0;m<k;m++)n=d[m],n[0]=m,n[1]=h[m];d.sort(Xf);for(m=0;8>m;m++){if(n=d[m])if(h=n[0],k=n[1]){q&&e.addAttribute("morphTarget"+m,q[h]);f&&e.addAttribute("morphNormal"+m,f[h]);c[m]=k;continue}c[m]=0}g.getUniforms().setValue(a,"morphTargetInfluences",c)}}}function Zf(a,b){var c={};return{update:function(d){var e=b.render.frame,f=d.geometry,g=
a.get(d,f);c[g.id]!==e&&(f.isGeometry&&g.updateFromObject(d),a.update(g),c[g.id]=e);return g},dispose:function(){c={}}}}function Ua(a,b,c,d,e,f,g,h,k,m){a=void 0!==a?a:[];T.call(this,a,void 0!==b?b:301,c,d,e,f,g,h,k,m);this.flipY=!1}function Kb(a,b,c){var d=a[0];if(0>=d||0<d)return a;var e=b*c,f=He[e];void 0===f&&(f=new Float32Array(e),He[e]=f);if(0!==b)for(d.toArray(f,0),d=1,e=0;d!==b;++d)e+=c,a[d].toArray(f,e);return f}function ea(a,b){if(a.length!==b.length)return!1;for(var c=0,d=a.length;c<d;c++)if(a[c]!==
b[c])return!1;return!0}function qa(a,b){for(var c=0,d=b.length;c<d;c++)a[c]=b[c]}function Ie(a,b){var c=Je[b];void 0===c&&(c=new Int32Array(b),Je[b]=c);for(var d=0;d!==b;++d)c[d]=a.allocTextureUnit();return c}function $f(a,b){var c=this.cache;c[0]!==b&&(a.uniform1f(this.addr,b),c[0]=b)}function ag(a,b){var c=this.cache;c[0]!==b&&(a.uniform1i(this.addr,b),c[0]=b)}function bg(a,b){var c=this.cache;if(void 0!==b.x){if(c[0]!==b.x||c[1]!==b.y)a.uniform2f(this.addr,b.x,b.y),c[0]=b.x,c[1]=b.y}else ea(c,
b)||(a.uniform2fv(this.addr,b),qa(c,b))}function cg(a,b){var c=this.cache;if(void 0!==b.x){if(c[0]!==b.x||c[1]!==b.y||c[2]!==b.z)a.uniform3f(this.addr,b.x,b.y,b.z),c[0]=b.x,c[1]=b.y,c[2]=b.z}else if(void 0!==b.r){if(c[0]!==b.r||c[1]!==b.g||c[2]!==b.b)a.uniform3f(this.addr,b.r,b.g,b.b),c[0]=b.r,c[1]=b.g,c[2]=b.b}else ea(c,b)||(a.uniform3fv(this.addr,b),qa(c,b))}function dg(a,b){var c=this.cache;if(void 0!==b.x){if(c[0]!==b.x||c[1]!==b.y||c[2]!==b.z||c[3]!==b.w)a.uniform4f(this.addr,b.x,b.y,b.z,b.w),
c[0]=b.x,c[1]=b.y,c[2]=b.z,c[3]=b.w}else ea(c,b)||(a.uniform4fv(this.addr,b),qa(c,b))}function eg(a,b){var c=this.cache,d=b.elements;void 0===d?ea(c,b)||(a.uniformMatrix2fv(this.addr,!1,b),qa(c,b)):ea(c,d)||(Ke.set(d),a.uniformMatrix2fv(this.addr,!1,Ke),qa(c,d))}function fg(a,b){var c=this.cache,d=b.elements;void 0===d?ea(c,b)||(a.uniformMatrix3fv(this.addr,!1,b),qa(c,b)):ea(c,d)||(Le.set(d),a.uniformMatrix3fv(this.addr,!1,Le),qa(c,d))}function gg(a,b){var c=this.cache,d=b.elements;void 0===d?ea(c,
b)||(a.uniformMatrix4fv(this.addr,!1,b),qa(c,b)):ea(c,d)||(Me.set(d),a.uniformMatrix4fv(this.addr,!1,Me),qa(c,d))}function hg(a,b,c){var d=this.cache,e=c.allocTextureUnit();d[0]!==e&&(a.uniform1i(this.addr,e),d[0]=e);c.setTexture2D(b||Ne,e)}function ig(a,b,c){var d=this.cache,e=c.allocTextureUnit();d[0]!==e&&(a.uniform1i(this.addr,e),d[0]=e);c.setTextureCube(b||Oe,e)}function Pe(a,b){var c=this.cache;ea(c,b)||(a.uniform2iv(this.addr,b),qa(c,b))}function Qe(a,b){var c=this.cache;ea(c,b)||(a.uniform3iv(this.addr,
b),qa(c,b))}function Re(a,b){var c=this.cache;ea(c,b)||(a.uniform4iv(this.addr,b),qa(c,b))}function jg(a){switch(a){case 5126:return $f;case 35664:return bg;case 35665:return cg;case 35666:return dg;case 35674:return eg;case 35675:return fg;case 35676:return gg;case 35678:case 36198:return hg;case 35680:return ig;case 5124:case 35670:return ag;case 35667:case 35671:return Pe;case 35668:case 35672:return Qe;case 35669:case 35673:return Re}}function kg(a,b){var c=this.cache;ea(c,b)||(a.uniform1fv(this.addr,
b),qa(c,b))}function lg(a,b){var c=this.cache;ea(c,b)||(a.uniform1iv(this.addr,b),qa(c,b))}function mg(a,b){var c=this.cache;b=Kb(b,this.size,2);ea(c,b)||(a.uniform2fv(this.addr,b),this.updateCache(b))}function ng(a,b){var c=this.cache;b=Kb(b,this.size,3);ea(c,b)||(a.uniform3fv(this.addr,b),this.updateCache(b))}function og(a,b){var c=this.cache;b=Kb(b,this.size,4);ea(c,b)||(a.uniform4fv(this.addr,b),this.updateCache(b))}function pg(a,b){var c=this.cache;b=Kb(b,this.size,4);ea(c,b)||(a.uniformMatrix2fv(this.addr,
!1,b),this.updateCache(b))}function qg(a,b){var c=this.cache;b=Kb(b,this.size,9);ea(c,b)||(a.uniformMatrix3fv(this.addr,!1,b),this.updateCache(b))}function rg(a,b){var c=this.cache;b=Kb(b,this.size,16);ea(c,b)||(a.uniformMatrix4fv(this.addr,!1,b),this.updateCache(b))}function sg(a,b,c){var d=this.cache,e=b.length,f=Ie(c,e);!1===ea(d,f)&&(a.uniform1iv(this.addr,f),qa(d,f));for(a=0;a!==e;++a)c.setTexture2D(b[a]||Ne,f[a])}function tg(a,b,c){var d=this.cache,e=b.length,f=Ie(c,e);!1===ea(d,f)&&(a.uniform1iv(this.addr,
f),qa(d,f));for(a=0;a!==e;++a)c.setTextureCube(b[a]||Oe,f[a])}function ug(a){switch(a){case 5126:return kg;case 35664:return mg;case 35665:return ng;case 35666:return og;case 35674:return pg;case 35675:return qg;case 35676:return rg;case 35678:return sg;case 35680:return tg;case 5124:case 35670:return lg;case 35667:case 35671:return Pe;case 35668:case 35672:return Qe;case 35669:case 35673:return Re}}function vg(a,b,c){this.id=a;this.addr=c;this.cache=[];this.setValue=jg(b.type)}function Se(a,b,c){this.id=
a;this.addr=c;this.cache=[];this.size=b.size;this.setValue=ug(b.type)}function Te(a){this.id=a;this.seq=[];this.map={}}function $a(a,b,c,d){this.seq=[];this.map={};this.renderer=c;c=a.getProgramParameter(b,a.ACTIVE_UNIFORMS);for(d=0;d<c;++d){var e=a.getActiveUniform(b,d),f=a.getUniformLocation(b,e.name),g=this,h=e.name,k=h.length;for(Wd.lastIndex=0;;){var m=Wd.exec(h),q=Wd.lastIndex,n=m[1],r=m[3];"]"===m[2]&&(n|=0);if(void 0===r||"["===r&&q+2===k){h=g;e=void 0===r?new vg(n,e,f):new Se(n,e,f);h.seq.push(e);
h.map[e.id]=e;break}else r=g.map[n],void 0===r&&(r=new Te(n),n=g,g=r,n.seq.push(g),n.map[g.id]=g),g=r}}}function wg(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+": "+a[b];return a.join("\n")}function Ue(a,b,c){var d=Va.Settings.resolve(),e=a.createShader(b);a.shaderSource(e,c);a.compileShader(e);d.debug()&&xg.logShaderCompilationInformation(a,e,b,c);return e}function Ve(a){switch(a){case 3E3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];
case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw Error("unsupported encoding: "+a);}}function Xd(a,b){b=Ve(b);return"vec4 "+a+"( vec4 value ) { return "+b[0]+"ToLinear"+b[1]+"; }"}function yg(a,b){b=Ve(b);return"vec4 "+a+"( vec4 value ) { return LinearTo"+b[0]+b[1]+"; }"}function zg(a,b){switch(b){case 1:b="Linear";break;case 2:b="Reinhard";break;
case 3:b="Uncharted2";break;case 4:b="OptimizedCineon";break;default:throw Error("unsupported toneMapping: "+b);}return"vec3 "+a+"( vec3 color ) { return "+b+"ToneMapping( color ); }"}function Ag(a,b,c){a=a||{};return[a.derivatives||b.envMapCubeUV||b.bumpMap||b.normalMap&&!b.objectSpaceNormalMap||b.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(a.fragDepth||b.logarithmicDepthBuffer)&&c.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",a.drawBuffers&&c.get("WEBGL_draw_buffers")?
"#extension GL_EXT_draw_buffers : require":"",(a.shaderTextureLOD||b.envMap)&&c.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(xc).join("\n")}function Bg(a){var b=[],c;for(c in a){var d=a[c];!1!==d&&b.push("#define "+c+" "+d)}return b.join("\n")}function Cg(a,b,c){var d={},e=!1;c.attributes&&0<c.attributes.length?c.attributes.forEach(function(f){d[f]=a.getAttribLocation(b,f);-1===d[f]&&(We.warn("Attribute "+f+" not defined in material shader. Material: "+
c.type+". Check shader attributes or material.attributes definition."),e=!0)}):e=!0;if(e){d={};for(var f=a.getProgramParameter(b,a.ACTIVE_ATTRIBUTES),g=0;g<f;g++){var h=a.getActiveAttrib(b,g).name;We.warn("Fallback to getProgramParameter webgl method. Try to avoid it by settings attributes to material or attributes to ShaderMaterial constructor parameters. Material: "+c.type+" Attribute: "+h);d[h]=a.getAttribLocation(b,h)}}return d}function xc(a){return""!==a}function Xe(a,b){return a.replace(/NUM_DIR_LIGHTS/g,
b.numDirLights).replace(/NUM_SPOT_LIGHTS/g,b.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,b.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,b.numPointLights).replace(/NUM_HEMI_LIGHTS/g,b.numHemiLights)}function Ye(a,b){return a.replace(/NUM_CLIPPING_PLANES/g,b.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,b.numClippingPlanes-b.numClipIntersection)}function Yd(a){return a.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,function(a,c){a=S[c];if(void 0===a)throw Error("Can not resolve #include <"+c+
">");return Yd(a)})}function Ze(a){return a.replace(/#pragma unroll_loop[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(a,c,d,e){a="";for(c=parseInt(c);c<parseInt(d);c++)a+=e.replace(/\[ i \]/g,"[ "+c+" ]");return a})}function Dg(a,b,c,d,e,f,g){var h=Va.Settings.resolve(),k=a.context,m=d.defines,q=e.vertexShader,n=e.fragmentShader,r="SHADOWMAP_TYPE_BASIC";1===f.shadowMapType?r="SHADOWMAP_TYPE_PCF":2===f.shadowMapType&&(r="SHADOWMAP_TYPE_PCF_SOFT");var w="ENVMAP_TYPE_CUBE",
t="ENVMAP_MODE_REFLECTION",l="ENVMAP_BLENDING_MULTIPLY";if(f.envMap){switch(d.envMap.mapping){case 301:case 302:w="ENVMAP_TYPE_CUBE";break;case 306:case 307:w="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:w="ENVMAP_TYPE_EQUIREC";break;case 305:w="ENVMAP_TYPE_SPHERE"}switch(d.envMap.mapping){case 302:case 304:t="ENVMAP_MODE_REFRACTION"}switch(d.combine){case 0:l="ENVMAP_BLENDING_MULTIPLY";break;case 1:l="ENVMAP_BLENDING_MIX";break;case 2:l="ENVMAP_BLENDING_ADD"}}var x=0<a.gammaFactor?a.gammaFactor:
1,p=g.isWebGL2?"":Ag(d.extensions,f,b),v=Bg(m),B=k.createProgram();d.isRawShaderMaterial?(m=[v].filter(xc).join("\n"),0<m.length&&(m+="\n"),b=[p,v].filter(xc).join("\n"),0<b.length&&(b+="\n")):(m=["precision "+f.precision+" float;","precision "+f.precision+" int;","#define SHADER_NAME "+e.name,v,f.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+x,"#define MAX_BONES "+f.maxBones,f.useFog&&f.fog?"#define USE_FOG":"",f.useFog&&f.fogExp?"#define FOG_EXP2":"",f.map?"#define USE_MAP":
"",f.envMap?"#define USE_ENVMAP":"",f.envMap?"#define "+t:"",f.lightMap?"#define USE_LIGHTMAP":"",f.aoMap?"#define USE_AOMAP":"",f.emissiveMap?"#define USE_EMISSIVEMAP":"",f.bumpMap?"#define USE_BUMPMAP":"",f.normalMap?"#define USE_NORMALMAP":"",f.normalMap&&f.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",f.displacementMap&&f.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",f.specularMap?"#define USE_SPECULARMAP":"",f.roughnessMap?"#define USE_ROUGHNESSMAP":"",f.metalnessMap?"#define USE_METALNESSMAP":
"",f.alphaMap?"#define USE_ALPHAMAP":"",f.vertexColors?"#define USE_COLOR":"",f.flatShading?"#define FLAT_SHADED":"",f.skinning?"#define USE_SKINNING":"",f.useVertexTexture?"#define BONE_TEXTURE":"",f.morphTargets?"#define USE_MORPHTARGETS":"",f.morphNormals&&!1===f.flatShading?"#define USE_MORPHNORMALS":"",f.doubleSided?"#define DOUBLE_SIDED":"",f.flipSided?"#define FLIP_SIDED":"",f.shadowMapEnabled?"#define USE_SHADOWMAP":"",f.shadowMapEnabled?"#define "+r:"",f.sizeAttenuation?"#define USE_SIZEATTENUATION":
"",f.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",f.logarithmicDepthBuffer&&(g.isWebGL2||b.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;",
"\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;",
"#endif","\n"].filter(xc).join("\n"),b=[p,"precision "+f.precision+" float;","precision "+f.precision+" int;","#define SHADER_NAME "+e.name,v,f.alphaTest?"#define ALPHATEST "+f.alphaTest+(f.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+x,f.useFog&&f.fog?"#define USE_FOG":"",f.useFog&&f.fogExp?"#define FOG_EXP2":"",f.map?"#define USE_MAP":"",f.envMap?"#define USE_ENVMAP":"",f.envMap?"#define "+w:"",f.envMap?"#define "+t:"",f.envMap?"#define "+l:"",f.lightMap?"#define USE_LIGHTMAP":"",f.aoMap?"#define USE_AOMAP":
"",f.emissiveMap?"#define USE_EMISSIVEMAP":"",f.bumpMap?"#define USE_BUMPMAP":"",f.normalMap?"#define USE_NORMALMAP":"",f.normalMap&&f.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",f.specularMap?"#define USE_SPECULARMAP":"",f.roughnessMap?"#define USE_ROUGHNESSMAP":"",f.metalnessMap?"#define USE_METALNESSMAP":"",f.alphaMap?"#define USE_ALPHAMAP":"",f.vertexColors?"#define USE_COLOR":"",f.gradientMap?"#define USE_GRADIENTMAP":"",f.flatShading?"#define FLAT_SHADED":"",f.doubleSided?"#define DOUBLE_SIDED":
"",f.flipSided?"#define FLIP_SIDED":"",f.shadowMapEnabled?"#define USE_SHADOWMAP":"",f.shadowMapEnabled?"#define "+r:"",f.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",f.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",f.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",f.logarithmicDepthBuffer&&(g.isWebGL2||b.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",f.envMap&&(g.isWebGL2||b.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;",
"uniform vec3 cameraPosition;",0!==f.toneMapping?"#define TONE_MAPPING":"",0!==f.toneMapping?S.tonemapping_pars_fragment:"",0!==f.toneMapping?zg("toneMapping",f.toneMapping):"",f.dithering?"#define DITHERING":"",f.outputEncoding||f.mapEncoding||f.envMapEncoding||f.emissiveMapEncoding?S.encodings_pars_fragment:"",f.mapEncoding?Xd("mapTexelToLinear",f.mapEncoding):"",f.envMapEncoding?Xd("envMapTexelToLinear",f.envMapEncoding):"",f.emissiveMapEncoding?Xd("emissiveMapTexelToLinear",f.emissiveMapEncoding):
"",f.outputEncoding?yg("linearToOutputTexel",f.outputEncoding):"",f.depthPacking?"#define DEPTH_PACKING "+d.depthPacking:"","\n"].filter(xc).join("\n"));q=Yd(q);q=Xe(q,f);q=Ye(q,f);n=Yd(n);n=Xe(n,f);n=Ye(n,f);q=Ze(q);n=Ze(n);g.isWebGL2&&!d.isRawShaderMaterial&&(g=!1,r=/^\s*#version\s+300\s+es\s*\n/,d.isShaderMaterial&&null!==q.match(r)&&null!==n.match(r)&&(g=!0,q=q.replace(r,""),n=n.replace(r,"")),m="#version 300 es\n\n#define attribute in\n#define varying out\n#define texture2D texture\n"+m,b=["#version 300 es\n\n#define varying in",
g?"":"out highp vec4 pc_fragColor;",g?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth\n#define texture2D texture\n#define textureCube texture\n#define texture2DProj textureProj\n#define texture2DLodEXT textureLod\n#define texture2DProjLodEXT textureProjLod\n#define textureCubeLodEXT textureLod\n#define texture2DGradEXT textureGrad\n#define texture2DProjGradEXT textureProjGrad\n#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+b);n=b+n;q=Ue(k,k.VERTEX_SHADER,m+q);
n=Ue(k,k.FRAGMENT_SHADER,n);k.attachShader(B,q);k.attachShader(B,n);void 0!==d.index0AttributeName?k.bindAttribLocation(B,0,d.index0AttributeName):!0===f.morphTargets&&k.bindAttribLocation(B,0,"position");k.linkProgram(B);h.debug()&&(f=Eg.getWebGLProgramDiagnostics(k,B,q,n,m,b,d))&&(this.diagnostics=f);k.deleteShader(q);k.deleteShader(n);var I;this.getUniforms=function(){void 0===I&&(I=new $a(k,B,a,d));return I};var P;this.getAttributes=function(){void 0===P&&(P=Cg(k,B,d));return P};this.destroy=
function(){k.deleteProgram(B);this.program=void 0};Object.defineProperties(this,{uniforms:{get:function(){console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms().");return this.getUniforms()}},attributes:{get:function(){console.warn("THREE.WebGLProgram: .attributes is now .getAttributes().");return this.getAttributes()}}});this.name=e.name;this.id=Fg++;this.code=c;this.usedTimes=1;this.program=B;this.vertexShader=q;this.fragmentShader=n;return this}function Gg(a,b,c){function d(a,b){if(a)a.isTexture?
c=a.encoding:a.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),c=a.texture.encoding);else var c=3E3;3E3===c&&b&&(c=3007);return c}var e=[],f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",
LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},g="precision supportsVertexTextures map mapEncoding envMap envMapMode envMapEncoding lightMap aoMap emissiveMap emissiveMapEncoding bumpMap normalMap objectSpaceNormalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors fog useFog fogExp flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering".split(" ");
this.getParameters=function(b,e,g,q,n,r,w){var h=f[b.type];if(w.isSkinnedMesh){var k=w.skeleton.bones;if(c.floatVertexTextures)k=1024;else{var m=Math.min(Math.floor((c.maxVertexUniforms-20)/4),k.length);m<k.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+k.length+" bones. This GPU supports "+m+"."),k=0):k=m}}else k=0;m=c.precision;null!==b.precision&&(m=c.getMaxPrecision(b.precision),m!==b.precision&&console.warn("THREE.WebGLProgram.getParameters:",b.precision,"not supported, using",m,"instead."));
var l=a.getRenderTarget();return{shaderID:h,precision:m,supportsVertexTextures:c.vertexTextures,outputEncoding:d(l?l.texture:null,a.gammaOutput),map:!!b.map,mapEncoding:d(b.map,a.gammaInput),envMap:!!b.envMap,envMapMode:b.envMap&&b.envMap.mapping,envMapEncoding:d(b.envMap,a.gammaInput),envMapCubeUV:!!b.envMap&&(306===b.envMap.mapping||307===b.envMap.mapping),lightMap:!!b.lightMap,aoMap:!!b.aoMap,emissiveMap:!!b.emissiveMap,emissiveMapEncoding:d(b.emissiveMap,a.gammaInput),bumpMap:!!b.bumpMap,normalMap:!!b.normalMap,
objectSpaceNormalMap:1===b.normalMapType,displacementMap:!!b.displacementMap,roughnessMap:!!b.roughnessMap,metalnessMap:!!b.metalnessMap,specularMap:!!b.specularMap,alphaMap:!!b.alphaMap,gradientMap:!!b.gradientMap,combine:b.combine,vertexColors:b.vertexColors,fog:!!q,useFog:b.fog,fogExp:q&&q.isFogExp2,flatShading:b.flatShading,sizeAttenuation:b.sizeAttenuation,logarithmicDepthBuffer:c.logarithmicDepthBuffer,skinning:b.skinning&&0<k,maxBones:k,useVertexTexture:c.floatVertexTextures,morphTargets:b.morphTargets,
morphNormals:b.morphNormals,maxMorphTargets:a.maxMorphTargets,maxMorphNormals:a.maxMorphNormals,numDirLights:e.directional.length,numPointLights:e.point.length,numSpotLights:e.spot.length,numRectAreaLights:e.rectArea.length,numHemiLights:e.hemi.length,numClippingPlanes:n,numClipIntersection:r,dithering:b.dithering,shadowMapEnabled:a.shadowMap.enabled&&w.receiveShadow&&0<g.length,shadowMapType:a.shadowMap.type,toneMapping:a.toneMapping,physicallyCorrectLights:a.physicallyCorrectLights,premultipliedAlpha:b.premultipliedAlpha,
alphaTest:b.alphaTest,doubleSided:2===b.side,flipSided:1===b.side,depthPacking:void 0!==b.depthPacking?b.depthPacking:!1}};this.getProgramCode=function(b,c){var d=[];c.shaderID?d.push(c.shaderID):(d.push(b.fragmentShader),d.push(b.vertexShader));if(void 0!==b.defines)for(var e in b.defines)d.push(e),d.push(b.defines[e]);for(e=0;e<g.length;e++)d.push(c[g[e]]);d.push(b.onBeforeCompile.toString());d.push(a.gammaOutput);return d.join()};this.acquireProgram=function(d,f,g,q){for(var h,k=0,m=e.length;k<
m;k++){var t=e[k];if(t.code===q){h=t;++h.usedTimes;break}}void 0===h&&(h=new Dg(a,b,q,d,f,g,c),e.push(h));return h};this.releaseProgram=function(a){if(!(e.length<Va.Settings.resolve().allowedCachedPrograms())&&0===--a.usedTimes){var b=e.indexOf(a);e[b]=e[e.length-1];e.pop();a.destroy()}};this.disposeCached=function(){for(;0<e.length;)e.pop().destroy()};this.programs=e}function Hg(){var a=new WeakMap;return{get:function(b){var c=a.get(b);void 0===c&&(c={},a.set(b,c));return c},remove:function(b){a.delete(b)},
update:function(b,c,d){a.get(b)[c]=d},dispose:function(){a=new WeakMap}}}function Ig(a,b){return a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.program&&b.program&&a.program!==b.program?a.program.id-b.program.id:a.material.id!==b.material.id?a.material.id-b.material.id:a.z!==b.z?a.z-b.z:a.id-b.id}function Jg(a,b){return a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.z!==b.z?b.z-a.z:a.id-b.id}function Kg(){var a=[],b=0,c=[],d=[];return{opaque:c,transparent:d,init:function(){b=
0;c.length=0;d.length=0},push:function(e,f,g,h,k){var m=a[b];void 0===m?(m={id:e.id,object:e,geometry:f,material:g,program:g.program,renderOrder:e.renderOrder,z:h,group:k},a[b]=m):(m.id=e.id,m.object=e,m.geometry=f,m.material=g,m.program=g.program,m.renderOrder=e.renderOrder,m.z=h,m.group=k);(!0===g.transparent?d:c).push(m);b++},sort:function(){1<c.length&&c.sort(Ig);1<d.length&&d.sort(Jg)}}}function Lg(){var a={};return{get:function(b,c){b=b.id+","+c.id;c=a[b];void 0===c&&(c=new Kg,a[b]=c);return c},
dispose:function(){a={}}}}function Mg(){var a={};return{get:function(b){if(void 0!==a[b.id])return a[b.id];switch(b.type){case "DirectionalLight":var c={direction:new p,color:new H,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new A};break;case "SpotLight":c={position:new p,direction:new p,color:new H,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new A};break;case "PointLight":c={position:new p,color:new H,distance:0,decay:0,shadow:!1,shadowBias:0,
shadowRadius:1,shadowMapSize:new A,shadowCameraNear:1,shadowCameraFar:1E3};break;case "HemisphereLight":c={direction:new p,skyColor:new H,groundColor:new H};break;case "RectAreaLight":c={color:new H,position:new p,halfWidth:new p,halfHeight:new p}}return a[b.id]=c}}}function Ng(){var a=new Mg,b={id:Og++,hash:{stateID:-1,directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],
spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},c=new p,d=new J,e=new J;return{setup:function(f,g,h){var k=0,m=0,q=0,n=0,r=0,w=0,t=0,l=0;h=h.matrixWorldInverse;for(var x=0,p=f.length;x<p;x++){var v=f[x],B=v.color,I=v.intensity,P=v.distance,K=v.shadow&&v.shadow.map?v.shadow.map.texture:null;if(v.isAmbientLight)k+=B.r*I,m+=B.g*I,q+=B.b*I;else if(v.isDirectionalLight){var E=a.get(v);E.color.copy(v.color).multiplyScalar(v.intensity);E.direction.setFromMatrixPosition(v.matrixWorld);
c.setFromMatrixPosition(v.target.matrixWorld);E.direction.sub(c);E.direction.transformDirection(h);if(E.shadow=v.castShadow)B=v.shadow,E.shadowBias=B.bias,E.shadowRadius=B.radius,E.shadowMapSize=B.mapSize;b.directionalShadowMap[n]=K;b.directionalShadowMatrix[n]=v.shadow.matrix;b.directional[n]=E;n++}else if(v.isSpotLight){E=a.get(v);E.position.setFromMatrixPosition(v.matrixWorld);E.position.applyMatrix4(h);E.color.copy(B).multiplyScalar(I);E.distance=P;E.direction.setFromMatrixPosition(v.matrixWorld);
c.setFromMatrixPosition(v.target.matrixWorld);E.direction.sub(c);E.direction.transformDirection(h);E.coneCos=Math.cos(v.angle);E.penumbraCos=Math.cos(v.angle*(1-v.penumbra));E.decay=0===v.distance?0:v.decay;if(E.shadow=v.castShadow)B=v.shadow,E.shadowBias=B.bias,E.shadowRadius=B.radius,E.shadowMapSize=B.mapSize;b.spotShadowMap[w]=K;b.spotShadowMatrix[w]=v.shadow.matrix;b.spot[w]=E;w++}else if(v.isRectAreaLight)E=a.get(v),E.color.copy(B).multiplyScalar(I),E.position.setFromMatrixPosition(v.matrixWorld),
E.position.applyMatrix4(h),e.identity(),d.copy(v.matrixWorld),d.premultiply(h),e.extractRotation(d),E.halfWidth.set(.5*v.width,0,0),E.halfHeight.set(0,.5*v.height,0),E.halfWidth.applyMatrix4(e),E.halfHeight.applyMatrix4(e),b.rectArea[t]=E,t++;else if(v.isPointLight){E=a.get(v);E.position.setFromMatrixPosition(v.matrixWorld);E.position.applyMatrix4(h);E.color.copy(v.color).multiplyScalar(v.intensity);E.distance=v.distance;E.decay=0===v.distance?0:v.decay;if(E.shadow=v.castShadow)B=v.shadow,E.shadowBias=
B.bias,E.shadowRadius=B.radius,E.shadowMapSize=B.mapSize,E.shadowCameraNear=B.camera.near,E.shadowCameraFar=B.camera.far;b.pointShadowMap[r]=K;b.pointShadowMatrix[r]=v.shadow.matrix;b.point[r]=E;r++}else v.isHemisphereLight&&(E=a.get(v),E.direction.setFromMatrixPosition(v.matrixWorld),E.direction.transformDirection(h),E.direction.normalize(),E.skyColor.copy(v.color).multiplyScalar(I),E.groundColor.copy(v.groundColor).multiplyScalar(I),b.hemi[l]=E,l++)}b.ambient[0]=k;b.ambient[1]=m;b.ambient[2]=q;
b.directional.length=n;b.spot.length=w;b.rectArea.length=t;b.point.length=r;b.hemi.length=l;b.hash.stateID=b.id;b.hash.directionalLength=n;b.hash.pointLength=r;b.hash.spotLength=w;b.hash.rectAreaLength=t;b.hash.hemiLength=l;b.hash.shadowsLength=g.length},state:b}}function $e(){var a=new Ng,b=[],c=[];return{init:function(){b.length=0;c.length=0},state:{lightsArray:b,shadowsArray:c,lights:a},setupLights:function(d){a.setup(b,c,d)},pushLight:function(a){b.push(a)},pushShadow:function(a){c.push(a)}}}
function Pg(){var a={};return{get:function(b,c){if(void 0===a[b.id]){var d=new $e;a[b.id]={};a[b.id][c.id]=d}else void 0===a[b.id][c.id]?(d=new $e,a[b.id][c.id]=d):d=a[b.id][c.id];return d},dispose:function(){a={}}}}function ab(a){O.call(this);this.type="MeshDepthMaterial";this.depthPacking=3200;this.morphTargets=this.skinning=!1;this.displacementMap=this.alphaMap=this.map=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=!1;this.wireframeLinewidth=1;this.lights=this.fog=!1;this.setValues(a);
this.attributes=["position"]}function bb(a){O.call(this);this.type="MeshDistanceMaterial";this.referencePosition=new p;this.nearDistance=1;this.farDistance=1E3;this.morphTargets=this.skinning=!1;this.displacementMap=this.alphaMap=this.map=null;this.displacementScale=1;this.displacementBias=0;this.lights=this.fog=!1;this.setValues(a)}function af(a,b,c){function d(b,c,d,e,f,g){var h=b.geometry;var k=n;var m=b.customDepthMaterial;d&&(k=r,m=b.customDistanceMaterial);m?k=m:(m=!1,c.morphTargets&&(h&&h.isBufferGeometry?
m=h.morphAttributes&&h.morphAttributes.position&&0<h.morphAttributes.position.length:h&&h.isGeometry&&(m=h.morphTargets&&0<h.morphTargets.length)),b.isSkinnedMesh&&!1===c.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",b),b=b.isSkinnedMesh&&c.skinning,h=0,m&&(h|=1),b&&(h|=2),k=k[h]);a.localClippingEnabled&&!0===c.clipShadows&&0!==c.clippingPlanes.length&&(h=k.uuid,m=c.uuid,b=w[h],void 0===b&&(b={},w[h]=b),h=b[m],void 0===h&&(h=k.clone(),b[m]=h),
k=h);k.visible=c.visible;k.wireframe=c.wireframe;k.side=null!=c.shadowSide?c.shadowSide:t[c.side];k.clipShadows=c.clipShadows;k.clippingPlanes=c.clippingPlanes;k.clipIntersection=c.clipIntersection;k.wireframeLinewidth=c.wireframeLinewidth;k.linewidth=c.linewidth;d&&k.isMeshDistanceMaterial&&(k.referencePosition.copy(e),k.nearDistance=f,k.farDistance=g);return k}function e(c,g,h,k){if(!1!==c.visible){if(c.layers.test(g.layers)&&(c.isMesh||c.isLine||c.isPoints)&&c.castShadow&&(!c.frustumCulled||f.intersectsObject(c))){c.modelViewMatrix.multiplyMatrices(h.matrixWorldInverse,
c.matrixWorld);var m=b.update(c),n=c.material;if(Array.isArray(n))for(var r=m.groups,w=0,t=r.length;w<t;w++){var l=r[w],K=n[l.materialIndex];K&&K.visible&&(K=d(c,K,k,q,h.near,h.far),a.renderBufferDirect(h,null,m,K,c,l))}else n.visible&&(K=d(c,n,k,q,h.near,h.far),a.renderBufferDirect(h,null,m,K,c,null))}c=c.children;m=0;for(n=c.length;m<n;m++)e(c[m],g,h,k)}}var f=new od,g=new J,h=new A,k=new A(c,c),m=new p,q=new p,n=Array(4),r=Array(4),w={},t={0:1,1:0,2:2},l=[new p(1,0,0),new p(-1,0,0),new p(0,0,1),
new p(0,0,-1),new p(0,1,0),new p(0,-1,0)],x=[new p(0,1,0),new p(0,1,0),new p(0,1,0),new p(0,1,0),new p(0,0,1),new p(0,0,-1)],y=[new V,new V,new V,new V,new V,new V];for(c=0;4!==c;++c){var v=0!==(c&1),B=0!==(c&2),I=new ab({depthPacking:3201,morphTargets:v,skinning:B});n[c]=I;v=new bb({morphTargets:v,skinning:B});r[c]=v}var P=this;this.enabled=!1;this.autoUpdate=!0;this.needsUpdate=!1;this.type=1;this.render=function(b,c,d){if(!1!==P.enabled&&(!1!==P.autoUpdate||!1!==P.needsUpdate)&&0!==b.length){var n=
a.state;n.disable(a.context.BLEND);n.buffers.color.setClear(1,1,1,1);n.buffers.depth.setTest(!0);n.setScissorTest(!1);for(var r,w=0,t=b.length;w<t;w++){var K=b[w];r=K.shadow;var u=K&&K.isPointLight;if(void 0===r)console.warn("THREE.WebGLShadowMap:",K,"has no shadow.");else{var p=r.camera;h.copy(r.mapSize);h.min(k);if(u){var v=h.x,E=h.y;y[0].set(2*v,E,v,E);y[1].set(0,E,v,E);y[2].set(3*v,E,v,E);y[3].set(v,E,v,E);y[4].set(3*v,0,v,E);y[5].set(v,0,v,E);h.x*=4;h.y*=2}null===r.map&&(r.map=new gb(h.x,h.y,
{minFilter:1003,magFilter:1003,format:1023}),r.map.texture.name=K.name+".shadowMap",p.updateProjectionMatrix());r.isSpotLightShadow&&r.update(K);v=r.map;E=r.matrix;q.setFromMatrixPosition(K.matrixWorld);p.position.copy(q);u?(r=6,E.makeTranslation(-q.x,-q.y,-q.z)):(r=1,m.setFromMatrixPosition(K.target.matrixWorld),p.lookAt(m),p.updateMatrixWorld(),E.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),E.multiply(p.projectionMatrix),E.multiply(p.matrixWorldInverse));a.setRenderTarget(v);a.clear();for(K=0;K<r;K++)u&&
(m.copy(p.position),m.add(l[K]),p.up.copy(x[K]),p.lookAt(m),p.updateMatrixWorld(),n.viewport(y[K])),g.multiplyMatrices(p.projectionMatrix,p.matrixWorldInverse),f.setFromMatrix(g),e(c,d,p,u)}}P.needsUpdate=!1}}}function Qg(a,b,c,d){function e(b,c,d){var e=new Uint8Array(4),f=a.createTexture();a.bindTexture(b,f);a.texParameteri(b,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(b,a.TEXTURE_MAG_FILTER,a.NEAREST);for(b=0;b<d;b++)a.texImage2D(c+b,0,a.RGBA,1,1,0,a.RGBA,a.UNSIGNED_BYTE,e);return f}function f(c,
e){y[c]=1;0===v[c]&&(a.enableVertexAttribArray(c),v[c]=1);B[c]!==e&&((d.isWebGL2?a:b.get("ANGLE_instanced_arrays"))[d.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](c,e),B[c]=e)}function g(b){!0!==I[b]&&(a.enable(b),I[b]=!0)}function h(b){!1!==I[b]&&(a.disable(b),I[b]=!1)}function k(b,d,e,f,k,m,n,q){0!==b?g(a.BLEND):h(a.BLEND);if(5!==b){if(b!==E||q!==H)switch(b){case 2:q?(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ONE,a.ONE,a.ONE,a.ONE)):(a.blendEquation(a.FUNC_ADD),
a.blendFunc(a.SRC_ALPHA,a.ONE));break;case 3:q?(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ZERO,a.ZERO,a.ONE_MINUS_SRC_COLOR,a.ONE_MINUS_SRC_ALPHA)):(a.blendEquation(a.FUNC_ADD),a.blendFunc(a.ZERO,a.ONE_MINUS_SRC_COLOR));break;case 4:q?(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ZERO,a.SRC_COLOR,a.ZERO,a.SRC_ALPHA)):(a.blendEquation(a.FUNC_ADD),a.blendFunc(a.ZERO,a.SRC_COLOR));break;default:q?(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ONE,
a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA)):(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA))}C=D=Ud=z=A=vc=null}else{k=k||d;m=m||e;n=n||f;if(d!==vc||k!==Ud)a.blendEquationSeparate(c.convert(d),c.convert(k)),vc=d,Ud=k;if(e!==A||f!==z||m!==D||n!==C)a.blendFuncSeparate(c.convert(e),c.convert(f),c.convert(m),c.convert(n)),A=e,z=f,D=m,C=n}E=b;H=q}function m(b){L!==b&&(b?a.frontFace(a.CW):a.frontFace(a.CCW),L=b)}
function q(b){0!==b?(g(a.CULL_FACE),b!==Vd&&(1===b?a.cullFace(a.BACK):2===b?a.cullFace(a.FRONT):a.cullFace(a.FRONT_AND_BACK))):h(a.CULL_FACE);Vd=b}function n(b,c,d){if(b){if(g(a.POLYGON_OFFSET_FILL),R!==c||J!==d)a.polygonOffset(c,d),R=c,J=d}else h(a.POLYGON_OFFSET_FILL)}function r(b){void 0===b&&(b=a.TEXTURE0+O-1);Q!==b&&(a.activeTexture(b),Q=b)}var w=new function(){var b=!1,c=new V,d=null,e=new V(0,0,0,0);return{setMask:function(c){d===c||b||(a.colorMask(c,c,c,c),d=c)},setLocked:function(a){b=a},
setClear:function(b,d,f,g,h){!0===h&&(b*=g,d*=g,f*=g);c.set(b,d,f,g);!1===e.equals(c)&&(a.clearColor(b,d,f,g),e.copy(c))},reset:function(){b=!1;d=null;e.set(-1,0,0,0)}}},t=new function(){var b=!1,c=null,d=null,e=null;return{setTest:function(b){b?g(a.DEPTH_TEST):h(a.DEPTH_TEST)},setMask:function(d){c===d||b||(a.depthMask(d),c=d)},setFunc:function(b){if(d!==b){if(b)switch(b){case 0:a.depthFunc(a.NEVER);break;case 1:a.depthFunc(a.ALWAYS);break;case 2:a.depthFunc(a.LESS);break;case 3:a.depthFunc(a.LEQUAL);
break;case 4:a.depthFunc(a.EQUAL);break;case 5:a.depthFunc(a.GEQUAL);break;case 6:a.depthFunc(a.GREATER);break;case 7:a.depthFunc(a.NOTEQUAL);break;default:a.depthFunc(a.LEQUAL)}else a.depthFunc(a.LEQUAL);d=b}},setLocked:function(a){b=a},setClear:function(b){e!==b&&(a.clearDepth(b),e=b)},reset:function(){b=!1;e=d=c=null}}},l=new function(){var b=!1,c=null,d=null,e=null,f=null,k=null,m=null,n=null,q=null;return{setTest:function(b){b?g(a.STENCIL_TEST):h(a.STENCIL_TEST)},setMask:function(d){c===d||b||
(a.stencilMask(d),c=d)},setFunc:function(b,c,g){if(d!==b||e!==c||f!==g)a.stencilFunc(b,c,g),d=b,e=c,f=g},setOp:function(b,c,d){if(k!==b||m!==c||n!==d)a.stencilOp(b,c,d),k=b,m=c,n=d},setLocked:function(a){b=a},setClear:function(b){q!==b&&(a.clearStencil(b),q=b)},reset:function(){b=!1;q=n=m=k=f=e=d=c=null}}},p=a.getParameter(a.MAX_VERTEX_ATTRIBS),y=new Uint8Array(p),v=new Uint8Array(p),B=new Uint8Array(p),I={},P=null,K=null,E=null,vc=null,A=null,z=null,Ud=null,D=null,C=null,H=!1,L=null,Vd=null,M=null,
R=null,J=null,O=a.getParameter(a.MAX_COMBINED_TEXTURE_IMAGE_UNITS),G=!1;p=0;p=a.getParameter(a.VERSION);-1!==p.indexOf("WebGL")?(p=parseFloat(/^WebGL ([0-9])/.exec(p)[1]),G=1<=p):-1!==p.indexOf("OpenGL ES")&&(p=parseFloat(/^OpenGL ES ([0-9])/.exec(p)[1]),G=2<=p);var Q=null,S={},Y=new V,W=new V,N={};N[a.TEXTURE_2D]=e(a.TEXTURE_2D,a.TEXTURE_2D,1);N[a.TEXTURE_CUBE_MAP]=e(a.TEXTURE_CUBE_MAP,a.TEXTURE_CUBE_MAP_POSITIVE_X,6);w.setClear(0,0,0,1);t.setClear(1);l.setClear(0);g(a.DEPTH_TEST);t.setFunc(3);m(!1);
q(1);g(a.CULL_FACE);g(a.BLEND);k(1);return{buffers:{color:w,depth:t,stencil:l},initAttributes:function(){for(var a=0,b=y.length;a<b;a++)y[a]=0},enableAttribute:function(a){f(a,0)},enableAttributeAndDivisor:f,disableUnusedAttributes:function(){for(var b=0,c=v.length;b!==c;++b)v[b]!==y[b]&&(a.disableVertexAttribArray(b),v[b]=0)},enable:g,disable:h,getCompressedTextureFormats:function(){if(null===P&&(P=[],b.get("WEBGL_compressed_texture_pvrtc")||b.get("WEBGL_compressed_texture_s3tc")||b.get("WEBGL_compressed_texture_etc1")||
b.get("WEBGL_compressed_texture_astc")))for(var c=a.getParameter(a.COMPRESSED_TEXTURE_FORMATS),d=0;d<c.length;d++)P.push(c[d]);return P},useProgram:function(b){return K!==b?(a.useProgram(b),K=b,!0):!1},setBlending:k,setMaterial:function(b,c){2===b.side?h(a.CULL_FACE):g(a.CULL_FACE);var d=1===b.side;c&&(d=!d);m(d);1===b.blending&&!1===b.transparent?k(0):k(b.blending,b.blendEquation,b.blendSrc,b.blendDst,b.blendEquationAlpha,b.blendSrcAlpha,b.blendDstAlpha,b.premultipliedAlpha);t.setFunc(b.depthFunc);
t.setTest(b.depthTest);t.setMask(b.depthWrite);w.setMask(b.colorWrite);n(b.polygonOffset,b.polygonOffsetFactor,b.polygonOffsetUnits)},setFlipSided:m,setCullFace:q,setLineWidth:function(b){b!==M&&(G&&a.lineWidth(b),M=b)},setPolygonOffset:n,setScissorTest:function(b){b?g(a.SCISSOR_TEST):h(a.SCISSOR_TEST)},activeTexture:r,bindTexture:function(b,c){null===Q&&r();var d=S[Q];void 0===d&&(d={type:void 0,texture:void 0},S[Q]=d);if(d.type!==b||d.texture!==c)a.bindTexture(b,c||N[b]),d.type=b,d.texture=c},compressedTexImage2D:function(){try{a.compressedTexImage2D.apply(a,
arguments)}catch(U){console.error("THREE.WebGLState:",U)}},texImage2D:function(){try{a.texImage2D.apply(a,arguments)}catch(U){console.error("THREE.WebGLState:",U)}},scissor:function(b){!1===Y.equals(b)&&(a.scissor(b.x,b.y,b.z,b.w),Y.copy(b))},viewport:function(b){!1===W.equals(b)&&(a.viewport(b.x,b.y,b.z,b.w),W.copy(b))},reset:function(){for(var b=0;b<v.length;b++)1===v[b]&&(a.disableVertexAttribArray(b),v[b]=0);I={};Q=P=null;S={};Vd=L=E=K=null;w.reset();t.reset();l.reset()}}}function Rg(a,b,c,d,
e,f,g){function h(a,b){if(a.width>b||a.height>b){if("data"in a){P.warn("THREE.WebGLRenderer: image in DataTexture is too big ("+a.width+"x"+a.height+").");return}b/=Math.max(a.width,a.height);var c=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");c.width=Math.floor(a.width*b);c.height=Math.floor(a.height*b);c.getContext("2d").drawImage(a,0,0,a.width,a.height,0,0,c.width,c.height);P.warn("THREE.WebGLRenderer: image is too big ("+a.width+"x"+a.height+"). Resized to "+c.width+"x"+c.height);
return c}return a}function k(a){return G.isPowerOfTwo(a.width)&&G.isPowerOfTwo(a.height)}function m(a,b){return a.generateMipmaps&&b&&1003!==a.minFilter&&1006!==a.minFilter}function q(b,c,e,f){a.generateMipmap(b);d.get(c).__maxMipLevel=Math.log(Math.max(e,f))*Math.LOG2E}function n(b,c){if(!e.isWebGL2)return b;if(b===a.RGB){if(c===a.FLOAT)return a.RGB32F;if(c===a.HALF_FLOAT)return a.RGB16F;if(c===a.UNSIGNED_BYTE)return a.RGB8}if(b===a.RGBA){if(c===a.FLOAT)return a.RGBA32F;if(c===a.HALF_FLOAT)return a.RGBA16F;
if(c===a.UNSIGNED_BYTE)return a.RGBA8}return b}function r(b){return 1003===b||1004===b||1005===b?a.NEAREST:a.LINEAR}function w(b){b=b.target;b.removeEventListener("dispose",w);a:{var c=d.get(b);if(b.image&&c.__image__webglTextureCube)a.deleteTexture(c.__image__webglTextureCube);else{if(void 0===c.__webglInit)break a;a.deleteTexture(c.__webglTexture)}d.remove(b)}b.isVideoTexture&&delete B[b.id];g.memory.textures--}function t(b){b=b.target;b.removeEventListener("dispose",t);var c=d.get(b),e=d.get(b.texture);
if(b){void 0!==e.__webglTexture&&a.deleteTexture(e.__webglTexture);b.depthTexture&&b.depthTexture.dispose();if(b.isWebGLRenderTargetCube)for(e=0;6>e;e++)a.deleteFramebuffer(c.__webglFramebuffer[e]),c.__webglDepthbuffer&&a.deleteRenderbuffer(c.__webglDepthbuffer[e]);else a.deleteFramebuffer(c.__webglFramebuffer),c.__webglDepthbuffer&&a.deleteRenderbuffer(c.__webglDepthbuffer);d.remove(b.texture);d.remove(b)}g.memory.textures--}function l(b,r){var t=d.get(b);if(b.isVideoTexture){var l=b.id,u=g.render.frame;
B[l]!==u&&(B[l]=u,b.update())}if(0<b.version&&t.__version!==b.version)if(l=b.image,void 0===l)P.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(!1===l.complete)P.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{void 0===t.__webglInit&&(t.__webglInit=!0,b.addEventListener("dispose",w),t.__webglTexture=a.createTexture(),g.memory.textures++);c.activeTexture(a.TEXTURE0+r);c.bindTexture(a.TEXTURE_2D,t.__webglTexture);a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,
b.flipY);a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b.premultiplyAlpha);a.pixelStorei(a.UNPACK_ALIGNMENT,b.unpackAlignment);r=h(b.image,e.maxTextureSize);(e.isWebGL2?0:1001!==b.wrapS||1001!==b.wrapT||1003!==b.minFilter&&1006!==b.minFilter)&&!1===k(r)&&(r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof ImageBitmap)&&(void 0===I&&(I=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),I.width=G.floorPowerOfTwo(r.width),I.height=G.floorPowerOfTwo(r.height),
I.getContext("2d").drawImage(r,0,0,I.width,I.height),P.warn("THREE.WebGLRenderer: image is not power of two ("+r.width+"x"+r.height+"). Resized to "+I.width+"x"+I.height),r=I);l=k(r);u=f.convert(b.format);var v=f.convert(b.type),x=n(u,v);p(a.TEXTURE_2D,b,l);var K=b.mipmaps;if(b.isDepthTexture){x=a.DEPTH_COMPONENT;if(1015===b.type){if(!e.isWebGL2)throw Error("Float Depth Texture only supported in WebGL2.0");x=a.DEPTH_COMPONENT32F}else e.isWebGL2&&(x=a.DEPTH_COMPONENT16);1026===b.format&&x===a.DEPTH_COMPONENT&&
1012!==b.type&&1014!==b.type&&(P.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),b.type=1012,v=f.convert(b.type));1027===b.format&&(x=a.DEPTH_STENCIL,1020!==b.type&&(P.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),b.type=1020,v=f.convert(b.type)));c.texImage2D(a.TEXTURE_2D,0,x,r.width,r.height,0,u,v,null)}else if(b.isDataTexture)if(0<K.length&&l){for(var E=0,y=K.length;E<y;E++){var A=K[E];c.texImage2D(a.TEXTURE_2D,
E,x,A.width,A.height,0,u,v,A.data)}b.generateMipmaps=!1;t.__maxMipLevel=K.length-1}else c.texImage2D(a.TEXTURE_2D,0,x,r.width,r.height,0,u,v,r.data),t.__maxMipLevel=0;else if(b.isCompressedTexture){E=0;for(y=K.length;E<y;E++)A=K[E],1023!==b.format&&1022!==b.format?-1<c.getCompressedTextureFormats().indexOf(u)?c.compressedTexImage2D(a.TEXTURE_2D,E,x,A.width,A.height,0,A.data):P.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):c.texImage2D(a.TEXTURE_2D,
E,x,A.width,A.height,0,u,v,A.data);t.__maxMipLevel=K.length-1}else if(0<K.length&&l){E=0;for(y=K.length;E<y;E++)A=K[E],c.texImage2D(a.TEXTURE_2D,E,x,u,v,A);b.generateMipmaps=!1;t.__maxMipLevel=K.length-1}else c.texImage2D(a.TEXTURE_2D,0,x,u,v,r),t.__maxMipLevel=0;m(b,l)&&q(a.TEXTURE_2D,b,r.width,r.height);t.__version=b.version;if(b.onUpdate)b.onUpdate(b);return}c.activeTexture(a.TEXTURE0+r);c.bindTexture(a.TEXTURE_2D,t.__webglTexture)}function p(c,g,h){h?(a.texParameteri(c,a.TEXTURE_WRAP_S,f.convert(g.wrapS)),
a.texParameteri(c,a.TEXTURE_WRAP_T,f.convert(g.wrapT)),a.texParameteri(c,a.TEXTURE_MAG_FILTER,f.convert(g.magFilter)),a.texParameteri(c,a.TEXTURE_MIN_FILTER,f.convert(g.minFilter))):(a.texParameteri(c,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(c,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),1001===g.wrapS&&1001===g.wrapT||P.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),a.texParameteri(c,a.TEXTURE_MAG_FILTER,r(g.magFilter)),
a.texParameteri(c,a.TEXTURE_MIN_FILTER,r(g.minFilter)),1003!==g.minFilter&&1006!==g.minFilter&&P.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));!(h=b.get("EXT_texture_filter_anisotropic"))||1015===g.type&&null===b.get("OES_texture_float_linear")||1016===g.type&&null===(e.isWebGL2||b.get("OES_texture_half_float_linear"))||!(1<g.anisotropy||d.get(g).__currentAnisotropy)||(a.texParameterf(c,h.TEXTURE_MAX_ANISOTROPY_EXT,
Math.min(g.anisotropy,e.getMaxAnisotropy())),d.get(g).__currentAnisotropy=g.anisotropy)}function y(b,e,g,h){var k=f.convert(e.texture.format),m=f.convert(e.texture.type),q=n(k,m);c.texImage2D(h,0,q,e.width,e.height,0,k,m,null);a.bindFramebuffer(a.FRAMEBUFFER,b);a.framebufferTexture2D(a.FRAMEBUFFER,g,h,d.get(e.texture).__webglTexture,0);a.bindFramebuffer(a.FRAMEBUFFER,null)}function v(b,c){a.bindRenderbuffer(a.RENDERBUFFER,b);c.depthBuffer&&!c.stencilBuffer?(a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,
c.width,c.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,b)):c.depthBuffer&&c.stencilBuffer?(a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_STENCIL,c.width,c.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,b)):a.renderbufferStorage(a.RENDERBUFFER,a.RGBA4,c.width,c.height);a.bindRenderbuffer(a.RENDERBUFFER,null)}var B={},I,P=Va.Logger.resolve();this.setTexture2D=l;this.setTextureCube=function(b,r){var t=d.get(b);if(6===b.image.length)if(0<
b.version&&t.__version!==b.version){t.__image__webglTextureCube||(b.addEventListener("dispose",w),t.__image__webglTextureCube=a.createTexture(),g.memory.textures++);c.activeTexture(a.TEXTURE0+r);c.bindTexture(a.TEXTURE_CUBE_MAP,t.__image__webglTextureCube);a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,b.flipY);r=b&&b.isCompressedTexture;for(var l=b.image[0]&&b.image[0].isDataTexture,u=[],v=0;6>v;v++)u[v]=r||l?l?b.image[v].image:b.image[v]:h(b.image[v],e.maxCubemapSize);var x=u[0],I=k(x),K=f.convert(b.format),
y=f.convert(b.type),E=n(K,y);p(a.TEXTURE_CUBE_MAP,b,I);for(v=0;6>v;v++)if(r)for(var B,A=u[v].mipmaps,z=0,D=A.length;z<D;z++)B=A[z],1023!==b.format&&1022!==b.format?-1<c.getCompressedTextureFormats().indexOf(K)?c.compressedTexImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+v,z,E,B.width,B.height,0,B.data):P.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):c.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+v,z,E,B.width,B.height,0,K,y,B.data);else l?c.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+
v,0,E,u[v].width,u[v].height,0,K,y,u[v].data):c.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,E,K,y,u[v]);t.__maxMipLevel=r?A.length-1:0;m(b,I)&&q(a.TEXTURE_CUBE_MAP,b,x.width,x.height);t.__version=b.version;if(b.onUpdate)b.onUpdate(b)}else c.activeTexture(a.TEXTURE0+r),c.bindTexture(a.TEXTURE_CUBE_MAP,t.__image__webglTextureCube)};this.setTextureCubeDynamic=function(b,e){c.activeTexture(a.TEXTURE0+e);c.bindTexture(a.TEXTURE_CUBE_MAP,d.get(b).__webglTexture)};this.setupRenderTarget=function(b){var e=
d.get(b),f=d.get(b.texture);b.addEventListener("dispose",t);f.__webglTexture=a.createTexture();g.memory.textures++;var h=!0===b.isWebGLRenderTargetCube,n=k(b);if(h){e.__webglFramebuffer=[];for(var r=0;6>r;r++)e.__webglFramebuffer[r]=a.createFramebuffer()}else e.__webglFramebuffer=a.createFramebuffer();if(h){c.bindTexture(a.TEXTURE_CUBE_MAP,f.__webglTexture);p(a.TEXTURE_CUBE_MAP,b.texture,n);for(r=0;6>r;r++)y(e.__webglFramebuffer[r],b,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+r);m(b.texture,
n)&&q(a.TEXTURE_CUBE_MAP,b.texture,b.width,b.height);c.bindTexture(a.TEXTURE_CUBE_MAP,null)}else c.bindTexture(a.TEXTURE_2D,f.__webglTexture),p(a.TEXTURE_2D,b.texture,n),y(e.__webglFramebuffer,b,a.COLOR_ATTACHMENT0,a.TEXTURE_2D),m(b.texture,n)&&q(a.TEXTURE_2D,b.texture,b.width,b.height),c.bindTexture(a.TEXTURE_2D,null);if(b.depthBuffer){e=d.get(b);f=!0===b.isWebGLRenderTargetCube;if(b.depthTexture){if(f)throw Error("target.depthTexture not supported in Cube render targets");if(b&&b.isWebGLRenderTargetCube)throw Error("Depth Texture with cube render targets is not supported");
a.bindFramebuffer(a.FRAMEBUFFER,e.__webglFramebuffer);if(!b.depthTexture||!b.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");d.get(b.depthTexture).__webglTexture&&b.depthTexture.image.width===b.width&&b.depthTexture.image.height===b.height||(b.depthTexture.image.width=b.width,b.depthTexture.image.height=b.height,b.depthTexture.needsUpdate=!0);l(b.depthTexture,0);e=d.get(b.depthTexture).__webglTexture;if(1026===b.depthTexture.format)a.framebufferTexture2D(a.FRAMEBUFFER,
a.DEPTH_ATTACHMENT,a.TEXTURE_2D,e,0);else if(1027===b.depthTexture.format)a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,e,0);else throw Error("Unknown depthTexture format");}else if(f)for(e.__webglDepthbuffer=[],f=0;6>f;f++)a.bindFramebuffer(a.FRAMEBUFFER,e.__webglFramebuffer[f]),e.__webglDepthbuffer[f]=a.createRenderbuffer(),v(e.__webglDepthbuffer[f],b);else a.bindFramebuffer(a.FRAMEBUFFER,e.__webglFramebuffer),e.__webglDepthbuffer=a.createRenderbuffer(),v(e.__webglDepthbuffer,
b);a.bindFramebuffer(a.FRAMEBUFFER,null)}};this.updateRenderTargetMipmap=function(b){var e=b.texture,f=k(b);if(m(e,f)){f=b.isWebGLRenderTargetCube?a.TEXTURE_CUBE_MAP:a.TEXTURE_2D;var g=d.get(e).__webglTexture;c.bindTexture(f,g);q(f,e,b.width,b.height);c.bindTexture(f,null)}}}function bf(a,b,c){return{convert:function(d){if(1E3===d)return a.REPEAT;if(1001===d)return a.CLAMP_TO_EDGE;if(1002===d)return a.MIRRORED_REPEAT;if(1003===d)return a.NEAREST;if(1004===d)return a.NEAREST_MIPMAP_NEAREST;if(1005===
d)return a.NEAREST_MIPMAP_LINEAR;if(1006===d)return a.LINEAR;if(1007===d)return a.LINEAR_MIPMAP_NEAREST;if(1008===d)return a.LINEAR_MIPMAP_LINEAR;if(1009===d)return a.UNSIGNED_BYTE;if(1017===d)return a.UNSIGNED_SHORT_4_4_4_4;if(1018===d)return a.UNSIGNED_SHORT_5_5_5_1;if(1019===d)return a.UNSIGNED_SHORT_5_6_5;if(1010===d)return a.BYTE;if(1011===d)return a.SHORT;if(1012===d)return a.UNSIGNED_SHORT;if(1013===d)return a.INT;if(1014===d)return a.UNSIGNED_INT;if(1015===d)return a.FLOAT;if(1016===d){if(c.isWebGL2)return a.HALF_FLOAT;
var e=b.get("OES_texture_half_float");if(null!==e)return e.HALF_FLOAT_OES}if(1021===d)return a.ALPHA;if(1022===d)return a.RGB;if(1023===d)return a.RGBA;if(1024===d)return a.LUMINANCE;if(1025===d)return a.LUMINANCE_ALPHA;if(1026===d)return a.DEPTH_COMPONENT;if(1027===d)return a.DEPTH_STENCIL;if(100===d)return a.FUNC_ADD;if(101===d)return a.FUNC_SUBTRACT;if(102===d)return a.FUNC_REVERSE_SUBTRACT;if(200===d)return a.ZERO;if(201===d)return a.ONE;if(202===d)return a.SRC_COLOR;if(203===d)return a.ONE_MINUS_SRC_COLOR;
if(204===d)return a.SRC_ALPHA;if(205===d)return a.ONE_MINUS_SRC_ALPHA;if(206===d)return a.DST_ALPHA;if(207===d)return a.ONE_MINUS_DST_ALPHA;if(208===d)return a.DST_COLOR;if(209===d)return a.ONE_MINUS_DST_COLOR;if(210===d)return a.SRC_ALPHA_SATURATE;if(33776===d||33777===d||33778===d||33779===d)if(e=b.get("WEBGL_compressed_texture_s3tc"),null!==e){if(33776===d)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===d)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===d)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;
if(33779===d)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===d||35841===d||35842===d||35843===d)if(e=b.get("WEBGL_compressed_texture_pvrtc"),null!==e){if(35840===d)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===d)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===d)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===d)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===d&&(e=b.get("WEBGL_compressed_texture_etc1"),null!==e))return e.COMPRESSED_RGB_ETC1_WEBGL;if(37808===d||37809===d||37810===
d||37811===d||37812===d||37813===d||37814===d||37815===d||37816===d||37817===d||37818===d||37819===d||37820===d||37821===d)if(e=b.get("WEBGL_compressed_texture_astc"),null!==e)return d;if(103===d||104===d){if(c.isWebGL2){if(103===d)return a.MIN;if(104===d)return a.MAX}e=b.get("EXT_blend_minmax");if(null!==e){if(103===d)return e.MIN_EXT;if(104===d)return e.MAX_EXT}}if(1020===d){if(c.isWebGL2)return a.UNSIGNED_INT_24_8;e=b.get("WEBGL_depth_texture");if(null!==e)return e.UNSIGNED_INT_24_8_WEBGL}return 0}}}
function Lb(){D.call(this);this.type="Group"}function Z(a,b,c,d){Na.call(this);this.type="PerspectiveCamera";this.fov=void 0!==a?a:50;this.zoom=1;this.near=void 0!==c?c:.1;this.far=void 0!==d?d:2E3;this.focus=10;this.aspect=void 0!==b?b:1;this.view=null;this.filmGauge=35;this.filmOffset=0;this.updateProjectionMatrix()}function Ac(a){Z.call(this);this.cameras=a||[]}function cf(a){function b(){return null!==e&&!0===e.isPresenting}function c(){if(b()){var c=e.getEyeParameters("left"),f=c.renderWidth;
c=c.renderHeight;y=a.getPixelRatio();x=a.getSize();a.setDrawingBufferSize(2*f,c,1);B.start()}else d.enabled&&(a.setDrawingBufferSize(x.width,x.height,y),B.stop())}var d=this,e=null,f=null,g=null,h=[],k=new J,m=new J;"undefined"!==typeof window&&"VRFrameData"in window&&(f=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",c,!1));var q=new J,n=new fa,r=new p,w=new Z;w.bounds=new V(0,0,.5,1);w.layers.enable(1);var t=new Z;t.bounds=new V(.5,0,.5,1);t.layers.enable(2);var l=new Ac([w,
t]);l.layers.enable(1);l.layers.enable(2);var x,y,v=[];this.enabled=!1;this.userHeight=1.6;this.getController=function(a){var b=h[a];void 0===b&&(b=new Lb,b.matrixAutoUpdate=!1,b.visible=!1,h[a]=b);return b};this.getDevice=function(){return e};this.setDevice=function(a){void 0!==a&&(e=a);B.setContext(a)};this.setPoseTarget=function(a){void 0!==a&&(g=a)};this.getCamera=function(a){if(null===e)return a.position.set(0,d.userHeight,0),a;e.depthNear=a.near;e.depthFar=a.far;e.getFrameData(f);var b=e.stageParameters;
b?k.fromArray(b.sittingToStandingTransform):k.makeTranslation(0,d.userHeight,0);b=f.pose;var c=null!==g?g:a;c.matrix.copy(k);c.matrix.decompose(c.position,c.quaternion,c.scale);null!==b.orientation&&(n.fromArray(b.orientation),c.quaternion.multiply(n));null!==b.position&&(n.setFromRotationMatrix(k),r.fromArray(b.position),r.applyQuaternion(n),c.position.add(r));c.updateMatrixWorld();if(!1===e.isPresenting)return a;w.near=a.near;t.near=a.near;w.far=a.far;t.far=a.far;l.matrixWorld.copy(a.matrixWorld);
l.matrixWorldInverse.copy(a.matrixWorldInverse);w.matrixWorldInverse.fromArray(f.leftViewMatrix);t.matrixWorldInverse.fromArray(f.rightViewMatrix);m.getInverse(k);w.matrixWorldInverse.multiply(m);t.matrixWorldInverse.multiply(m);a=c.parent;null!==a&&(q.getInverse(a.matrixWorld),w.matrixWorldInverse.multiply(q),t.matrixWorldInverse.multiply(q));w.matrixWorld.getInverse(w.matrixWorldInverse);t.matrixWorld.getInverse(t.matrixWorldInverse);w.projectionMatrix.fromArray(f.leftProjectionMatrix);t.projectionMatrix.fromArray(f.rightProjectionMatrix);
l.projectionMatrix.copy(w.projectionMatrix);a=e.getLayers();a.length&&(a=a[0],null!==a.leftBounds&&4===a.leftBounds.length&&w.bounds.fromArray(a.leftBounds),null!==a.rightBounds&&4===a.rightBounds.length&&t.bounds.fromArray(a.rightBounds));a:for(a=0;a<h.length;a++){b=h[a];b:{c=a;for(var u=navigator.getGamepads&&navigator.getGamepads(),p=0,x=0,y=u.length;p<y;p++){var B=u[p];if(B&&("Daydream Controller"===B.id||"Gear VR Controller"===B.id||"Oculus Go Controller"===B.id||"OpenVR Gamepad"===B.id||B.id.startsWith("Oculus Touch")||
B.id.startsWith("Spatial Controller"))){if(x===c){c=B;break b}x++}}c=void 0}if(void 0!==c&&void 0!==c.pose){if(null===c.pose)break a;u=c.pose;!1===u.hasPosition&&b.position.set(.2,-.6,-.05);null!==u.position&&b.position.fromArray(u.position);null!==u.orientation&&b.quaternion.fromArray(u.orientation);b.matrix.compose(b.position,b.quaternion,b.scale);b.matrix.premultiply(k);b.matrix.decompose(b.position,b.quaternion,b.scale);b.matrixWorldNeedsUpdate=!0;b.visible=!0;u="Daydream Controller"===c.id?0:
1;v[a]!==c.buttons[u].pressed&&(v[a]=c.buttons[u].pressed,!0===v[a]?b.dispatchEvent({type:"selectstart"}):(b.dispatchEvent({type:"selectend"}),b.dispatchEvent({type:"select"})))}else b.visible=!1}return l};this.getStandingMatrix=function(){return k};this.isPresenting=b;var B=new Sd;this.setAnimationLoop=function(a){B.setAnimationLoop(a)};this.submitFrame=function(){b()&&e.submitFrame()};this.dispose=function(){"undefined"!==typeof window&&window.removeEventListener("vrdisplaypresentchange",c)}}function Sg(a){function b(){return null!==
h&&null!==k}function c(a){var b=q[n.indexOf(a.inputSource)];b&&b.dispatchEvent({type:a.type})}function d(){a.setFramebuffer(null);p.stop()}function e(a,b){null===b?a.matrixWorld.copy(a.matrix):a.matrixWorld.multiplyMatrices(b.matrixWorld,a.matrix);a.matrixWorldInverse.getInverse(a.matrixWorld)}var f=a.context,g=null,h=null,k=null,m=null,q=[],n=[],r=new Z;r.layers.enable(1);r.viewport=new V;var w=new Z;w.layers.enable(2);w.viewport=new V;var t=new Ac([r,w]);t.layers.enable(1);t.layers.enable(2);this.enabled=
!1;this.getController=function(a){var b=q[a];void 0===b&&(b=new Lb,b.matrixAutoUpdate=!1,b.visible=!1,q[a]=b);return b};this.getDevice=function(){return g};this.setDevice=function(a){void 0!==a&&(g=a);a instanceof XRDevice&&f.setCompatibleXRDevice(a)};this.setSession=function(b,e){h=b;null!==h&&(h.addEventListener("select",c),h.addEventListener("selectstart",c),h.addEventListener("selectend",c),h.addEventListener("end",d),h.baseLayer=new XRWebGLLayer(h,f),h.requestFrameOfReference(e.frameOfReferenceType).then(function(b){k=
b;a.setFramebuffer(h.baseLayer.framebuffer);p.setContext(h);p.start()}),n=h.getInputSources(),h.addEventListener("inputsourceschange",function(){n=h.getInputSources();console.log(n)}))};this.getCamera=function(a){if(b()){var c=a.parent,d=t.cameras;e(t,c);for(var f=0;f<d.length;f++)e(d[f],c);a.matrixWorld.copy(t.matrixWorld);a=a.children;f=0;for(c=a.length;f<c;f++)a[f].updateMatrixWorld(!0);return t}return a};this.isPresenting=b;var l=null,p=new Sd;p.setAnimationLoop(function(a,b){m=b.getDevicePose(k);
if(null!==m)for(var c=h.baseLayer,d=b.views,e=0;e<d.length;e++){var f=d[e],g=c.getViewport(f),r=m.getViewMatrix(f),w=t.cameras[e];w.matrix.fromArray(r).getInverse(w.matrix);w.projectionMatrix.fromArray(f.projectionMatrix);w.viewport.set(g.x,g.y,g.width,g.height);0===e&&(t.matrix.copy(w.matrix),t.projectionMatrix.copy(w.projectionMatrix))}for(e=0;e<q.length;e++){c=q[e];if(d=n[e])if(d=b.getInputPose(d,k),null!==d){c.matrix.elements=d.pointerMatrix;c.matrix.decompose(c.position,c.rotation,c.scale);c.visible=
!0;continue}c.visible=!1}l&&l(a)});this.setAnimationLoop=function(a){l=a};this.dispose=function(){};this.getStandingMatrix=function(){console.warn("THREE.WebXRManager: getStandingMatrix() is no longer needed.");return new THREE.Matrix4};this.submitFrame=function(){}}function $d(a){var b;function c(){ha=new Tf(F);ua=new Rf(F,ha,a);ua.isWebGL2||(ha.get("WEBGL_depth_texture"),ha.get("OES_texture_float"),ha.get("OES_texture_half_float"),ha.get("OES_texture_half_float_linear"),ha.get("OES_standard_derivatives"),
ha.get("OES_element_index_uint"),ha.get("ANGLE_instanced_arrays"));ha.get("OES_texture_float_linear");da=new bf(F,ha,ua);ba=new Qg(F,ha,da,ua);ba.scissor(yc.copy(fa).multiplyScalar(U));ba.viewport(T.copy(qd).multiplyScalar(U));ca=new Wf(F);Ba=new Hg;ia=new Rg(F,ha,ba,Ba,ua,da,ca);pa=new Kf(F);ra=new Uf(F,pa,ca);ma=new Zf(ra,ca);va=new Yf(F);ka=new Gg(C,ha,ua);sa=new Lg;na=new Pg;la=new Pf(C,ba,ma,K);xa=new Qf(F,ha,ca,ua);ya=new Vf(F,ha,ca,ua);ca.programs=ka.programs;C.context=F;C.capabilities=ua;
C.extensions=ha;C.properties=Ba;C.renderLists=sa;C.state=ba;C.info=ca}function d(a){a.preventDefault();console.log("THREE.WebGLRenderer: Context Lost.");H=!0}function e(){console.log("THREE.WebGLRenderer: Context Restored.");H=!1;c()}function f(a){a=a.target;a.removeEventListener("dispose",f);g(a);Ba.remove(a)}function g(a){var b=Ba.get(a).program;a.program=void 0;void 0!==b&&ka.releaseProgram(b)}function h(a,b){a.render(function(a){C.renderBufferImmediate(a,b)})}function k(a,b,c){if(!1!==a.visible){if(a.layers.test(b.layers))if(a.isLight)D.pushLight(a),
a.castShadow&&D.pushShadow(a);else if(a.isSprite){if(!a.frustumCulled||oa.intersectsSprite(a)){c&&cb.setFromMatrixPosition(a.matrixWorld).applyMatrix4(zc);var d=ma.update(a),e=a.material;z.push(a,d,e,cb.z,null)}}else if(a.isImmediateRenderObject)c&&cb.setFromMatrixPosition(a.matrixWorld).applyMatrix4(zc),z.push(a,null,a.material,cb.z,null);else if(a.isMesh||a.isLine||a.isPoints)if(a.isSkinnedMesh&&a.skeleton.update(),!a.frustumCulled||oa.intersectsObject(a))if(c&&cb.setFromMatrixPosition(a.matrixWorld).applyMatrix4(zc),
d=ma.update(a),e=a.material,Array.isArray(e))for(var f=d.groups,g=0,h=f.length;g<h;g++){var m=f[g],n=e[m.materialIndex];n&&n.visible&&z.push(a,d,n,cb.z,m)}else e.visible&&z.push(a,d,e,cb.z,null);a=a.children;g=0;for(h=a.length;g<h;g++)k(a[g],b,c)}}function m(a,b,c,d){for(var e=0,f=a.length;e<f;e++){var g=a[e],h=g.object,k=g.geometry,m=void 0===d?g.material:d;g=g.group;if(c.isArrayCamera){W=c;for(var n=c.cameras,r=0,w=n.length;r<w;r++){var l=n[r];if(h.layers.test(l.layers)){if("viewport"in l)ba.viewport(T.copy(l.viewport));
else{var t=l.bounds;ba.viewport(T.set(t.x*Z,t.y*N,t.z*Z,t.w*N).multiplyScalar(U))}q(h,b,l,k,m,g)}}}else W=null,q(h,b,c,k,m,g)}}function q(a,c,d,e,f,g){a.onBeforeRender(C,c,d,e,f,g);D=na.get(c,W||d);a.modelViewMatrix.multiplyMatrices(d.matrixWorldInverse,a.matrixWorld);a.normalMatrix.getNormalMatrix(a.modelViewMatrix);if(a.isImmediateRenderObject){ba.setMaterial(f);var k=r(d,c.fog,f,a);S=b=null;pd=!1;h(a,k)}else C.renderBufferDirect(d,c.fog,e,f,a,g);a.onAfterRender(C,c,d,e,f,g);D=na.get(c,W||d)}function n(a,
b,c){var d=Ba.get(a),e=D.state.lights,h=d.lightsHash,k=e.state.hash;c=ka.getParameters(a,e.state,D.state.shadowsArray,b,aa.numPlanes,aa.numIntersection,c);var m=ka.getProgramCode(a,c),n=d.program,q=!0;if(void 0===n)a.addEventListener("dispose",f);else if(n.code!==m)g(a);else{if(h.stateID!==k.stateID||h.directionalLength!==k.directionalLength||h.pointLength!==k.pointLength||h.spotLength!==k.spotLength||h.rectAreaLength!==k.rectAreaLength||h.hemiLength!==k.hemiLength||h.shadowsLength!==k.shadowsLength)h.stateID=
k.stateID,h.directionalLength=k.directionalLength,h.pointLength=k.pointLength,h.spotLength=k.spotLength,h.rectAreaLength=k.rectAreaLength,h.hemiLength=k.hemiLength,h.shadowsLength=k.shadowsLength;else if(void 0!==c.shaderID)return;q=!1}q&&(c.shaderID?(m=ob[c.shaderID],d.shader={name:a.type,uniforms:Aa.clone(m.uniforms),vertexShader:m.vertexShader,fragmentShader:m.fragmentShader}):d.shader={name:a.type,uniforms:a.uniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader},a.onBeforeCompile(d.shader,
C),m=ka.getProgramCode(a,c),n=ka.acquireProgram(a,d.shader,c,m),d.program=n,a.program=n);c=n.getAttributes();if(a.morphTargets)for(m=a.numSupportedMorphTargets=0;m<C.maxMorphTargets;m++)0<=c["morphTarget"+m]&&a.numSupportedMorphTargets++;if(a.morphNormals)for(m=a.numSupportedMorphNormals=0;m<C.maxMorphNormals;m++)0<=c["morphNormal"+m]&&a.numSupportedMorphNormals++;c=d.shader.uniforms;if(!a.isShaderMaterial&&!a.isRawShaderMaterial||!0===a.clipping)d.numClippingPlanes=aa.numPlanes,d.numIntersection=
aa.numIntersection,c.clippingPlanes=aa.uniform;d.fog=b;void 0===h&&(d.lightsHash=h={});h.stateID=k.stateID;h.directionalLength=k.directionalLength;h.pointLength=k.pointLength;h.spotLength=k.spotLength;h.rectAreaLength=k.rectAreaLength;h.hemiLength=k.hemiLength;h.shadowsLength=k.shadowsLength;a.lights&&(c.ambientLightColor.value=e.state.ambient,c.directionalLights.value=e.state.directional,c.spotLights.value=e.state.spot,c.rectAreaLights.value=e.state.rectArea,c.pointLights.value=e.state.point,c.hemisphereLights.value=
e.state.hemi,c.directionalShadowMap.value=e.state.directionalShadowMap,c.directionalShadowMatrix.value=e.state.directionalShadowMatrix,c.spotShadowMap.value=e.state.spotShadowMap,c.spotShadowMatrix.value=e.state.spotShadowMatrix,c.pointShadowMap.value=e.state.pointShadowMap,c.pointShadowMatrix.value=e.state.pointShadowMatrix);a=d.program.getUniforms();a=$a.seqWithValue(a.seq,c);d.uniformsList=a}function r(a,b,c,d){X=0;var e=Ba.get(c),f=e.lightsHash,g=D.state.lights.state.hash;rd&&(Zd||a!==Y)&&aa.setState(c.clippingPlanes,
c.clipIntersection,c.clipShadows,a,e,a===Y&&c.id===O);!1===c.needsUpdate&&(void 0===e.program?c.needsUpdate=!0:c.fog&&e.fog!==b?c.needsUpdate=!0:!c.lights||f.stateID===g.stateID&&f.directionalLength===g.directionalLength&&f.pointLength===g.pointLength&&f.spotLength===g.spotLength&&f.rectAreaLength===g.rectAreaLength&&f.hemiLength===g.hemiLength&&f.shadowsLength===g.shadowsLength?void 0===e.numClippingPlanes||e.numClippingPlanes===aa.numPlanes&&e.numIntersection===aa.numIntersection||(c.needsUpdate=
!0):c.needsUpdate=!0);c.needsUpdate&&(n(c,b,d),c.needsUpdate=!1);var h=!1,k=!1,m=!1;f=e.program;g=f.getUniforms();var q=e.shader.uniforms;ba.useProgram(f.program)&&(m=k=h=!0);c.id!==O&&(O=c.id,k=!0);if(h||a!==Y){g.setValue(F,"projectionMatrix",a.projectionMatrix);ua.logarithmicDepthBuffer&&g.setValue(F,"logDepthBufFC",2/(Math.log(a.far+1)/Math.LN2));Y!==(W||a)&&(Y=W||a,m=k=!0);if(c.isShaderMaterial||c.isMeshPhongMaterial||c.isMeshStandardMaterial||c.envMap)h=g.map.cameraPosition,void 0!==h&&h.setValue(F,
cb.setFromMatrixPosition(a.matrixWorld));(c.isMeshPhongMaterial||c.isMeshLambertMaterial||c.isMeshBasicMaterial||c.isMeshStandardMaterial||c.isShaderMaterial||c.skinning)&&g.setValue(F,"viewMatrix",a.matrixWorldInverse)}if(c.skinning&&(g.setOptional(F,d,"bindMatrix"),g.setOptional(F,d,"bindMatrixInverse"),a=d.skeleton))if(h=a.bones,ua.floatVertexTextures){if(void 0===a.boneTexture){h=Math.sqrt(4*h.length);h=G.ceilPowerOfTwo(h);h=Math.max(h,4);var r=new Float32Array(h*h*4);r.set(a.boneMatrices);var t=
new hb(r,h,h,1023,1015);t.needsUpdate=!0;a.boneMatrices=r;a.boneTexture=t;a.boneTextureSize=h}g.setValue(F,"boneTexture",a.boneTexture);g.setValue(F,"boneTextureSize",a.boneTextureSize)}else g.setOptional(F,a,"boneMatrices");k&&(g.setValue(F,"toneMappingExposure",C.toneMappingExposure),g.setValue(F,"toneMappingWhitePoint",C.toneMappingWhitePoint),c.lights&&(k=m,q.ambientLightColor.needsUpdate=k,q.directionalLights.needsUpdate=k,q.pointLights.needsUpdate=k,q.spotLights.needsUpdate=k,q.rectAreaLights.needsUpdate=
k,q.hemisphereLights.needsUpdate=k),b&&c.fog&&(q.fogColor.value=b.color,b.isFog?(q.fogNear.value=b.near,q.fogFar.value=b.far):b.isFogExp2&&(q.fogDensity.value=b.density)),c.isMeshBasicMaterial?w(q,c):c.isMeshLambertMaterial?(w(q,c),c.emissiveMap&&(q.emissiveMap.value=c.emissiveMap)):c.isMeshPhongMaterial?(w(q,c),c.isMeshToonMaterial?(l(q,c),c.gradientMap&&(q.gradientMap.value=c.gradientMap)):l(q,c)):c.isMeshStandardMaterial?(w(q,c),c.isMeshPhysicalMaterial?(u(q,c),q.reflectivity.value=c.reflectivity,
q.clearCoat.value=c.clearCoat,q.clearCoatRoughness.value=c.clearCoatRoughness):u(q,c)):c.isMeshDepthMaterial?(w(q,c),c.displacementMap&&(q.displacementMap.value=c.displacementMap,q.displacementScale.value=c.displacementScale,q.displacementBias.value=c.displacementBias)):c.isMeshDistanceMaterial?(w(q,c),c.displacementMap&&(q.displacementMap.value=c.displacementMap,q.displacementScale.value=c.displacementScale,q.displacementBias.value=c.displacementBias),q.referencePosition.value.copy(c.referencePosition),
q.nearDistance.value=c.nearDistance,q.farDistance.value=c.farDistance):c.isMeshNormalMaterial?(w(q,c),c.bumpMap&&(q.bumpMap.value=c.bumpMap,q.bumpScale.value=c.bumpScale,1===c.side&&(q.bumpScale.value*=-1)),c.normalMap&&(q.normalMap.value=c.normalMap,q.normalScale.value.copy(c.normalScale),1===c.side&&q.normalScale.value.negate()),c.displacementMap&&(q.displacementMap.value=c.displacementMap,q.displacementScale.value=c.displacementScale,q.displacementBias.value=c.displacementBias)):c.isLineBasicMaterial?
(q.diffuse.value=c.color,q.opacity.value=c.opacity,c.isLineDashedMaterial&&(q.dashSize.value=c.dashSize,q.totalSize.value=c.dashSize+c.gapSize,q.scale.value=c.scale)):c.isPointsMaterial?(q.diffuse.value=c.color,q.opacity.value=c.opacity,q.size.value=c.size*U,q.scale.value=.5*N,q.map.value=c.map,null!==c.map&&(!0===c.map.matrixAutoUpdate&&c.map.updateMatrix(),q.uvTransform.value.copy(c.map.matrix))):c.isSpriteMaterial?(q.diffuse.value=c.color,q.opacity.value=c.opacity,q.rotation.value=c.rotation,q.map.value=
c.map,null!==c.map&&(!0===c.map.matrixAutoUpdate&&c.map.updateMatrix(),q.uvTransform.value.copy(c.map.matrix))):c.isShadowMaterial&&(q.color.value=c.color,q.opacity.value=c.opacity),void 0!==q.ltc_1&&(q.ltc_1.value=L.LTC_1),void 0!==q.ltc_2&&(q.ltc_2.value=L.LTC_2),$a.upload(F,e.uniformsList,q,C));c.isShaderMaterial&&!0===c.uniformsNeedUpdate&&($a.upload(F,e.uniformsList,q,C),c.uniformsNeedUpdate=!1);c.isSpriteMaterial&&g.setValue(F,"center",d.center);g.setValue(F,"modelViewMatrix",d.modelViewMatrix);
g.setValue(F,"normalMatrix",d.normalMatrix);g.setValue(F,"modelMatrix",d.matrixWorld);return f}function w(a,b){a.opacity.value=b.opacity;b.color&&(a.diffuse.value=b.color);b.emissive&&a.emissive.value.copy(b.emissive).multiplyScalar(b.emissiveIntensity);b.map&&(a.map.value=b.map);b.alphaMap&&(a.alphaMap.value=b.alphaMap);b.specularMap&&(a.specularMap.value=b.specularMap);b.envMap&&(a.envMap.value=b.envMap,a.flipEnvMap.value=b.envMap&&b.envMap.isCubeTexture?-1:1,a.reflectivity.value=b.reflectivity,
a.refractionRatio.value=b.refractionRatio,a.maxMipLevel.value=Ba.get(b.envMap).__maxMipLevel);b.lightMap&&(a.lightMap.value=b.lightMap,a.lightMapIntensity.value=b.lightMapIntensity);b.aoMap&&(a.aoMap.value=b.aoMap,a.aoMapIntensity.value=b.aoMapIntensity);if(b.map)var c=b.map;else b.specularMap?c=b.specularMap:b.displacementMap?c=b.displacementMap:b.normalMap?c=b.normalMap:b.bumpMap?c=b.bumpMap:b.roughnessMap?c=b.roughnessMap:b.metalnessMap?c=b.metalnessMap:b.alphaMap?c=b.alphaMap:b.emissiveMap&&(c=
b.emissiveMap);void 0!==c&&(c.isWebGLRenderTarget&&(c=c.texture),!0===c.matrixAutoUpdate&&c.updateMatrix(),a.uvTransform.value.copy(c.matrix))}function l(a,b){a.specular.value=b.specular;a.shininess.value=Math.max(b.shininess,1E-4);b.emissiveMap&&(a.emissiveMap.value=b.emissiveMap);b.bumpMap&&(a.bumpMap.value=b.bumpMap,a.bumpScale.value=b.bumpScale,1===b.side&&(a.bumpScale.value*=-1));b.normalMap&&(a.normalMap.value=b.normalMap,a.normalScale.value.copy(b.normalScale),1===b.side&&a.normalScale.value.negate());
b.displacementMap&&(a.displacementMap.value=b.displacementMap,a.displacementScale.value=b.displacementScale,a.displacementBias.value=b.displacementBias)}function u(a,b){a.roughness.value=b.roughness;a.metalness.value=b.metalness;b.roughnessMap&&(a.roughnessMap.value=b.roughnessMap);b.metalnessMap&&(a.metalnessMap.value=b.metalnessMap);b.emissiveMap&&(a.emissiveMap.value=b.emissiveMap);b.bumpMap&&(a.bumpMap.value=b.bumpMap,a.bumpScale.value=b.bumpScale,1===b.side&&(a.bumpScale.value*=-1));b.normalMap&&
(a.normalMap.value=b.normalMap,a.normalScale.value.copy(b.normalScale),1===b.side&&a.normalScale.value.negate());b.displacementMap&&(a.displacementMap.value=b.displacementMap,a.displacementScale.value=b.displacementScale,a.displacementBias.value=b.displacementBias);b.envMap&&(a.envMapIntensity.value=b.envMapIntensity)}console.log("THREE.WebGLRenderer","95");a=a||{};var x=void 0!==a.canvas?a.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),y=void 0!==a.context?a.context:null,
v=void 0!==a.alpha?a.alpha:!1,B=void 0!==a.depth?a.depth:!0,I=void 0!==a.stencil?a.stencil:!0,P=void 0!==a.antialias?a.antialias:!1,K=void 0!==a.premultipliedAlpha?a.premultipliedAlpha:!0,E=void 0!==a.preserveDrawingBuffer?a.preserveDrawingBuffer:!1,A=void 0!==a.powerPreference?a.powerPreference:"default",z=null,D=null;this.domElement=x;this.context=null;this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.clippingPlanes=[];this.localClippingEnabled=
!1;this.gammaFactor=2;this.physicallyCorrectLights=this.gammaOutput=this.gammaInput=!1;this.toneMappingWhitePoint=this.toneMappingExposure=this.toneMapping=1;this.maxMorphTargets=8;this.maxMorphNormals=4;var C=this,H=!1,M=null,R=null,Q=null,O=-1;var S=b=null;var pd=!1;var Y=null,W=null,T=new V,yc=new V,ea=null,X=0,Z=x.width,N=x.height,U=1,qd=new V(0,0,Z,N),fa=new V(0,0,Z,N),qa=!1,oa=new od,aa=new Sf,rd=!1,Zd=!1,zc=new J,cb=new p;try{v={alpha:v,depth:B,stencil:I,antialias:P,premultipliedAlpha:K,preserveDrawingBuffer:E,
powerPreference:A};x.addEventListener("webglcontextlost",d,!1);x.addEventListener("webglcontextrestored",e,!1);var F=y||x.getContext("webgl",v)||x.getContext("experimental-webgl",v);if(null===F){if(null!==x.getContext("webgl"))throw Error("Error creating WebGL context with your selected attributes.");throw Error("Error creating WebGL context.");}void 0===F.getShaderPrecisionFormat&&(F.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Tg){console.error("THREE.WebGLRenderer: "+
Tg.message)}var ha,ua,ba,ca,Ba,ia,pa,ra,ma,ka,sa,na,la,va,xa,ya,da;c();var ja="xr"in navigator?new Sg(C):new cf(C);this.vr=ja;var za=new af(C,ma,ua.maxTextureSize);this.shadowMap=za;this.getContext=function(){return F};this.getContextAttributes=function(){return F.getContextAttributes()};this.forceContextLoss=function(){var a=ha.get("WEBGL_lose_context");a&&a.loseContext()};this.forceContextRestore=function(){var a=ha.get("WEBGL_lose_context");a&&a.restoreContext()};this.getPixelRatio=function(){return U};
this.setPixelRatio=function(a){void 0!==a&&(U=a,this.setSize(Z,N,!1))};this.getSize=function(){return{width:Z,height:N}};this.setSize=function(a,b,c){ja.isPresenting()?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Z=a,N=b,x.width=a*U,x.height=b*U,!1!==c&&(x.style.width=a+"px",x.style.height=b+"px"),this.setViewport(0,0,a,b))};this.getDrawingBufferSize=function(){return{width:Z*U,height:N*U}};this.setDrawingBufferSize=function(a,b,c){Z=a;N=b;U=c;x.width=a*c;
x.height=b*c;this.setViewport(0,0,a,b)};this.getCurrentViewport=function(){return T};this.setViewport=function(a,b,c,d){qd.set(a,N-b-d,c,d);ba.viewport(T.copy(qd).multiplyScalar(U))};this.setScissor=function(a,b,c,d){fa.set(a,N-b-d,c,d);ba.scissor(yc.copy(fa).multiplyScalar(U))};this.setScissorTest=function(a){ba.setScissorTest(qa=a)};this.getClearColor=function(){return la.getClearColor()};this.setClearColor=function(){la.setClearColor.apply(la,arguments)};this.getClearAlpha=function(){return la.getClearAlpha()};
this.setClearAlpha=function(){la.setClearAlpha.apply(la,arguments)};this.clear=function(a,b,c){var d=0;if(void 0===a||a)d|=F.COLOR_BUFFER_BIT;if(void 0===b||b)d|=F.DEPTH_BUFFER_BIT;if(void 0===c||c)d|=F.STENCIL_BUFFER_BIT;F.clear(d)};this.clearColor=function(){this.clear(!0,!1,!1)};this.clearDepth=function(){this.clear(!1,!0,!1)};this.clearStencil=function(){this.clear(!1,!1,!0)};this.clearTarget=function(a,b,c,d){this.setRenderTarget(a);this.clear(b,c,d)};this.dispose=function(){x.removeEventListener("webglcontextlost",
d,!1);x.removeEventListener("webglcontextrestored",e,!1);sa.dispose();na.dispose();Ba.dispose();ma.dispose();ka.disposeCached();ja.dispose();ta.stop()};this.renderBufferImmediate=function(a,b){ba.initAttributes();var c=Ba.get(a);a.hasPositions&&!c.position&&(c.position=F.createBuffer());a.hasNormals&&!c.normal&&(c.normal=F.createBuffer());a.hasUvs&&!c.uv&&(c.uv=F.createBuffer());a.hasColors&&!c.color&&(c.color=F.createBuffer());b=b.getAttributes();a.hasPositions&&(F.bindBuffer(F.ARRAY_BUFFER,c.position),
F.bufferData(F.ARRAY_BUFFER,a.positionArray,F.DYNAMIC_DRAW),ba.enableAttribute(b.position),F.vertexAttribPointer(b.position,3,F.FLOAT,!1,0,0));a.hasNormals&&(F.bindBuffer(F.ARRAY_BUFFER,c.normal),F.bufferData(F.ARRAY_BUFFER,a.normalArray,F.DYNAMIC_DRAW),ba.enableAttribute(b.normal),F.vertexAttribPointer(b.normal,3,F.FLOAT,!1,0,0));a.hasUvs&&(F.bindBuffer(F.ARRAY_BUFFER,c.uv),F.bufferData(F.ARRAY_BUFFER,a.uvArray,F.DYNAMIC_DRAW),ba.enableAttribute(b.uv),F.vertexAttribPointer(b.uv,2,F.FLOAT,!1,0,0));
a.hasColors&&(F.bindBuffer(F.ARRAY_BUFFER,c.color),F.bufferData(F.ARRAY_BUFFER,a.colorArray,F.DYNAMIC_DRAW),ba.enableAttribute(b.color),F.vertexAttribPointer(b.color,3,F.FLOAT,!1,0,0));ba.disableUnusedAttributes();F.drawArrays(F.TRIANGLES,0,a.count);a.count=0};this.renderBufferDirect=function(a,c,d,e,f,g){var h=f.isMesh&&0>f.normalMatrix.determinant();ba.setMaterial(e,h);var k=r(a,c,e,f),m=!1;if(b!==d.id||S!==k.id||pd!==(!0===e.wireframe))b=d.id,S=k.id,pd=!0===e.wireframe,m=!0;f.morphTargetInfluences&&
(va.update(f,d,e,k),m=!0);h=d.index;var q=d.attributes.position;c=1;!0===e.wireframe&&(h=ra.getWireframeAttribute(d),c=2);a=xa;if(null!==h){var n=pa.get(h);a=ya;a.setIndex(n)}if(m){if(d&&d.isInstancedBufferGeometry&!ua.isWebGL2&&null===ha.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{ba.initAttributes();m=d.attributes;k=k.getAttributes();var w=e.defaultAttributeValues;
for(K in k){var l=k[K];if(0<=l){var t=m[K];if(void 0!==t){var u=t.normalized,p=t.itemSize,v=pa.get(t);if(void 0!==v){var x=v.buffer,B=v.type;v=v.bytesPerElement;if(t.isInterleavedBufferAttribute){var y=t.data,I=y.stride;t=t.offset;y&&y.isInstancedInterleavedBuffer?(ba.enableAttributeAndDivisor(l,y.meshPerAttribute),void 0===d.maxInstancedCount&&(d.maxInstancedCount=y.meshPerAttribute*y.count)):ba.enableAttribute(l);F.bindBuffer(F.ARRAY_BUFFER,x);F.vertexAttribPointer(l,p,B,u,I*v,t*v)}else t.isInstancedBufferAttribute?
(ba.enableAttributeAndDivisor(l,t.meshPerAttribute),void 0===d.maxInstancedCount&&(d.maxInstancedCount=t.meshPerAttribute*t.count)):ba.enableAttribute(l),F.bindBuffer(F.ARRAY_BUFFER,x),F.vertexAttribPointer(l,p,B,u,0,0)}}else if(void 0!==w&&(u=w[K],void 0!==u))switch(u.length){case 2:F.vertexAttrib2fv(l,u);break;case 3:F.vertexAttrib3fv(l,u);break;case 4:F.vertexAttrib4fv(l,u);break;default:F.vertexAttrib1fv(l,u)}}}ba.disableUnusedAttributes()}null!==h&&F.bindBuffer(F.ELEMENT_ARRAY_BUFFER,n.buffer)}n=
Infinity;null!==h?n=h.count:void 0!==q&&(n=q.count);h=d.drawRange.start*c;q=null!==g?g.start*c:0;var K=Math.max(h,q);g=Math.max(0,Math.min(n,h+d.drawRange.count*c,q+(null!==g?g.count*c:Infinity))-1-K+1);if(0!==g){if(f.isMesh)if(!0===e.wireframe)ba.setLineWidth(e.wireframeLinewidth*(null===R?U:1)),a.setMode(F.LINES);else switch(f.drawMode){case 0:a.setMode(F.TRIANGLES);break;case 1:a.setMode(F.TRIANGLE_STRIP);break;case 2:a.setMode(F.TRIANGLE_FAN)}else f.isLine?(e=e.linewidth,void 0===e&&(e=1),ba.setLineWidth(e*
(null===R?U:1)),f.isLineSegments?a.setMode(F.LINES):f.isLineLoop?a.setMode(F.LINE_LOOP):a.setMode(F.LINE_STRIP)):f.isPoints?a.setMode(F.POINTS):f.isSprite&&a.setMode(F.TRIANGLES);d&&d.isInstancedBufferGeometry?0<d.maxInstancedCount&&a.renderInstances(d,K,g):a.render(K,g)}};this.compile=function(a,b){D=na.get(a,b);D.init();a.traverse(function(a){a.isLight&&(D.pushLight(a),a.castShadow&&D.pushShadow(a))});D.setupLights(b);a.traverse(function(b){if(b.material)if(Array.isArray(b.material))for(var c=0;c<
b.material.length;c++)n(b.material[c],a.fog,b);else n(b.material,a.fog,b)})};var wa=null,ta=new Sd;ta.setAnimationLoop(function(a){ja.isPresenting()||wa&&wa(a)});"undefined"!==typeof window&&ta.setContext(window);this.setAnimationLoop=function(a){wa=a;ja.setAnimationLoop(a);ta.start()};this.render=function(a,c,d,e){if(!c||!c.isCamera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else if(!H){S=b=null;pd=!1;O=-1;Y=null;!0===a.autoUpdate&&a.updateMatrixWorld();
null===c.parent&&c.updateMatrixWorld();ja.enabled&&(c=ja.getCamera(c));D=na.get(a,c);D.init();a.onBeforeRender(C,a,c,d);zc.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse);oa.setFromMatrix(zc);Zd=this.localClippingEnabled;rd=aa.init(this.clippingPlanes,Zd,c);z=sa.get(a,c);z.init();k(a,c,C.sortObjects);!0===C.sortObjects&&z.sort();rd&&aa.beginShadows();za.render(D.state.shadowsArray,a,c);D.setupLights(c);rd&&aa.endShadows();this.info.autoReset&&this.info.reset();void 0===d&&(d=null);this.setRenderTarget(d);
la.render(z,a,c,e);e=z.opaque;var f=z.transparent;if(a.overrideMaterial){var g=a.overrideMaterial;e.length&&m(e,a,c,g);f.length&&m(f,a,c,g)}else e.length&&m(e,a,c),f.length&&m(f,a,c);d&&ia.updateRenderTargetMipmap(d);ba.buffers.depth.setTest(!0);ba.buffers.depth.setMask(!0);ba.buffers.color.setMask(!0);ba.setPolygonOffset(!1);a.onAfterRender(C,a,c);ja.enabled&&ja.submitFrame();D=z=null}};this.allocTextureUnit=function(){var a=X;a>=ua.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+
a+" texture units while this GPU supports only "+ua.maxTextures);X+=1;return a};this.setTexture2D=function(){var a=!1;return function(b,c){b&&b.isWebGLRenderTarget&&(a||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),a=!0),b=b.texture);ia.setTexture2D(b,c)}}();this.setTexture=function(){var a=!1;return function(b,c){a||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),a=!0);ia.setTexture2D(b,
c)}}();this.setTextureCube=function(){var a=!1;return function(b,c){b&&b.isWebGLRenderTargetCube&&(a||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),a=!0),b=b.texture);b&&b.isCubeTexture||Array.isArray(b.image)&&6===b.image.length?ia.setTextureCube(b,c):ia.setTextureCubeDynamic(b,c)}}();this.setFramebuffer=function(a){M=a};this.getRenderTarget=function(){return R};this.setRenderTarget=function(a){(R=a)&&void 0===
Ba.get(a).__webglFramebuffer&&ia.setupRenderTarget(a);var b=M,c=!1;a?(b=Ba.get(a).__webglFramebuffer,a.isWebGLRenderTargetCube&&(b=b[a.activeCubeFace],c=!0),T.copy(a.viewport),yc.copy(a.scissor),ea=a.scissorTest):(T.copy(qd).multiplyScalar(U),yc.copy(fa).multiplyScalar(U),ea=qa);Q!==b&&(F.bindFramebuffer(F.FRAMEBUFFER,b),Q=b);ba.viewport(T);ba.scissor(yc);ba.setScissorTest(ea);c&&(c=Ba.get(a.texture),F.framebufferTexture2D(F.FRAMEBUFFER,F.COLOR_ATTACHMENT0,F.TEXTURE_CUBE_MAP_POSITIVE_X+a.activeCubeFace,
c.__webglTexture,a.activeMipMapLevel))};this.readRenderTargetPixels=function(a,b,c,d,e,f){if(a&&a.isWebGLRenderTarget){var g=Ba.get(a).__webglFramebuffer;if(g){var h=!1;g!==Q&&(F.bindFramebuffer(F.FRAMEBUFFER,g),h=!0);try{var k=a.texture,m=k.format,q=k.type;1023!==m&&da.convert(m)!==F.getParameter(F.IMPLEMENTATION_COLOR_READ_FORMAT)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):1009===q||da.convert(q)===F.getParameter(F.IMPLEMENTATION_COLOR_READ_TYPE)||
1015===q&&(ua.isWebGL2||ha.get("OES_texture_float")||ha.get("WEBGL_color_buffer_float"))||1016===q&&(ua.isWebGL2?ha.get("EXT_color_buffer_float"):ha.get("EXT_color_buffer_half_float"))?F.checkFramebufferStatus(F.FRAMEBUFFER)===F.FRAMEBUFFER_COMPLETE?0<=b&&b<=a.width-d&&0<=c&&c<=a.height-e&&F.readPixels(b,c,d,e,da.convert(m),da.convert(q),f):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{h&&
F.bindFramebuffer(F.FRAMEBUFFER,Q)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")};this.copyFramebufferToTexture=function(a,b,c){var d=b.image.width,e=b.image.height,f=da.convert(b.format);this.setTexture2D(b,0);F.copyTexImage2D(F.TEXTURE_2D,c||0,f,a.x,a.y,d,e,0)};this.copyTextureToTexture=function(a,b,c,d){var e=b.image.width,f=b.image.height,g=da.convert(c.format),h=da.convert(c.type);this.setTexture2D(c,0);b.isDataTexture?F.texSubImage2D(F.TEXTURE_2D,
d||0,a.x,a.y,e,f,g,h,b.image.data):F.texSubImage2D(F.TEXTURE_2D,d||0,a.x,a.y,g,h,b.image)}}function Mb(a,b){this.name="";this.color=new H(a);this.density=void 0!==b?b:2.5E-4}function Nb(a,b,c){this.name="";this.color=new H(a);this.near=void 0!==b?b:1;this.far=void 0!==c?c:1E3}function sd(){D.call(this);this.type="Scene";this.overrideMaterial=this.fog=this.background=null;this.autoUpdate=!0}function pb(a,b){this.array=a;this.stride=b;this.count=void 0!==a?a.length/b:0;this.dynamic=!1;this.updateRange=
{offset:0,count:-1};this.version=0}function Bc(a,b,c,d){this.data=a;this.itemSize=b;this.offset=c;this.normalized=!0===d}function db(a){O.call(this);this.type="SpriteMaterial";this.color=new H(16777215);this.map=null;this.rotation=0;this.lights=!1;this.transparent=!0;this.setValues(a)}function Cc(a){D.call(this);this.type="Sprite";if(void 0===Ob){Ob=new C;var b=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]);b=new pb(b,5);Ob.setIndex([0,1,2,0,2,3]);Ob.addAttribute("position",
new Bc(b,3,0,!1));Ob.addAttribute("uv",new Bc(b,2,3,!1))}this.geometry=Ob;this.material=void 0!==a?a:new db;this.center=new A(.5,.5)}function Dc(){D.call(this);this.type="LOD";Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function Ec(a,b){a=a||[];this.bones=a.slice(0);this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===b)this.calculateInverses();else if(this.bones.length===b.length)this.boneInverses=b.slice(0);else for(console.warn("THREE.Skeleton boneInverses is the wrong length."),
this.boneInverses=[],a=0,b=this.bones.length;a<b;a++)this.boneInverses.push(new J)}function td(){D.call(this);this.type="Bone"}function ud(a,b){ka.call(this,a,b);this.type="SkinnedMesh";this.bindMode="attached";this.bindMatrix=new J;this.bindMatrixInverse=new J;a=this.initBones();a=new Ec(a);this.bind(a,this.matrixWorld);this.normalizeSkinWeights()}function Y(a){O.call(this);this.type="LineBasicMaterial";this.color=new H(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.lights=!1;
this.setValues(a);this.attributes=["position","color"]}function sa(a,b,c){1===c&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead.");D.call(this);this.type="Line";this.geometry=void 0!==a?a:new C;this.material=void 0!==b?b:new Y({color:16777215*Math.random()})}function W(a,b){sa.call(this,a,b);this.type="LineSegments"}function vd(a,b){sa.call(this,a,b);this.type="LineLoop"}function Ea(a){O.call(this);this.type="PointsMaterial";this.color=new H(16777215);
this.map=null;this.size=1;this.sizeAttenuation=!0;this.lights=this.morphTargets=!1;this.setValues(a)}function Pb(a,b){D.call(this);this.type="Points";this.geometry=void 0!==a?a:new C;this.material=void 0!==b?b:new Ea({color:16777215*Math.random()})}function ae(a,b,c,d,e,f,g,h,k){T.call(this,a,b,c,d,e,f,g,h,k);this.generateMipmaps=!1}function Qb(a,b,c,d,e,f,g,h,k,m,q,n){T.call(this,null,f,g,h,k,m,d,e,q,n);this.image={width:b,height:c};this.mipmaps=a;this.generateMipmaps=this.flipY=!1}function Fc(a,
b,c,d,e,f,g,h,k){T.call(this,a,b,c,d,e,f,g,h,k);this.needsUpdate=!0}function Gc(a,b,c,d,e,f,g,h,k,m){m=void 0!==m?m:1026;if(1026!==m&&1027!==m)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===c&&1026===m&&(c=1012);void 0===c&&1027===m&&(c=1020);T.call(this,null,d,e,f,g,h,m,c,k);this.image={width:a,height:b};this.magFilter=void 0!==g?g:1003;this.minFilter=void 0!==h?h:1003;this.generateMipmaps=this.flipY=!1}function Rb(a){C.call(this);this.type=
"WireframeGeometry";var b=[],c,d,e,f=[0,0],g={},h=["a","b","c"];if(a&&a.isGeometry){var k=a.faces;var m=0;for(d=k.length;m<d;m++){var q=k[m];for(c=0;3>c;c++){var n=q[h[c]];var r=q[h[(c+1)%3]];f[0]=Math.min(n,r);f[1]=Math.max(n,r);n=f[0]+","+f[1];void 0===g[n]&&(g[n]={index1:f[0],index2:f[1]})}}for(n in g)m=g[n],h=a.vertices[m.index1],b.push(h.x,h.y,h.z),h=a.vertices[m.index2],b.push(h.x,h.y,h.z)}else if(a&&a.isBufferGeometry)if(h=new p,null!==a.index){k=a.attributes.position;q=a.index;var l=a.groups;
0===l.length&&(l=[{start:0,count:q.count,materialIndex:0}]);a=0;for(e=l.length;a<e;++a)for(m=l[a],c=m.start,d=m.count,m=c,d=c+d;m<d;m+=3)for(c=0;3>c;c++)n=q.getX(m+c),r=q.getX(m+(c+1)%3),f[0]=Math.min(n,r),f[1]=Math.max(n,r),n=f[0]+","+f[1],void 0===g[n]&&(g[n]={index1:f[0],index2:f[1]});for(n in g)m=g[n],h.fromBufferAttribute(k,m.index1),b.push(h.x,h.y,h.z),h.fromBufferAttribute(k,m.index2),b.push(h.x,h.y,h.z)}else for(k=a.attributes.position,m=0,d=k.count/3;m<d;m++)for(c=0;3>c;c++)g=3*m+c,h.fromBufferAttribute(k,
g),b.push(h.x,h.y,h.z),g=3*m+(c+1)%3,h.fromBufferAttribute(k,g),b.push(h.x,h.y,h.z);this.addAttribute("position",new z(b,3))}function Hc(a,b,c){R.call(this);this.type="ParametricGeometry";this.parameters={func:a,slices:b,stacks:c};this.fromBufferGeometry(new Sb(a,b,c));this.mergeVertices()}function Sb(a,b,c){C.call(this);this.type="ParametricBufferGeometry";this.parameters={func:a,slices:b,stacks:c};var d=[],e=[],f=[],g=[],h=new p,k=new p,m=new p,q=new p,n=new p,r,l;3>a.length&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");
var t=b+1;for(r=0;r<=c;r++){var u=r/c;for(l=0;l<=b;l++){var x=l/b;a(x,u,k);e.push(k.x,k.y,k.z);0<=x-1E-5?(a(x-1E-5,u,m),q.subVectors(k,m)):(a(x+1E-5,u,m),q.subVectors(m,k));0<=u-1E-5?(a(x,u-1E-5,m),n.subVectors(k,m)):(a(x,u+1E-5,m),n.subVectors(m,k));h.crossVectors(q,n).normalize();f.push(h.x,h.y,h.z);g.push(x,u)}}for(r=0;r<c;r++)for(l=0;l<b;l++)a=r*t+l+1,h=(r+1)*t+l+1,k=(r+1)*t+l,d.push(r*t+l,a,k),d.push(a,h,k);this.setIndex(d);this.addAttribute("position",new z(e,3));this.addAttribute("normal",
new z(f,3));this.addAttribute("uv",new z(g,2))}function Ic(a,b,c,d){R.call(this);this.type="PolyhedronGeometry";this.parameters={vertices:a,indices:b,radius:c,detail:d};this.fromBufferGeometry(new na(a,b,c,d));this.mergeVertices()}function na(a,b,c,d){function e(a){h.push(a.x,a.y,a.z)}function f(b,c){b*=3;c.x=a[b+0];c.y=a[b+1];c.z=a[b+2]}function g(a,b,c,d){0>d&&1===a.x&&(k[b]=a.x-1);0===c.x&&0===c.z&&(k[b]=d/2/Math.PI+.5)}C.call(this);this.type="PolyhedronBufferGeometry";this.parameters={vertices:a,
indices:b,radius:c,detail:d};c=c||1;d=d||0;var h=[],k=[];(function(a){for(var c=new p,d=new p,g=new p,h=0;h<b.length;h+=3){f(b[h+0],c);f(b[h+1],d);f(b[h+2],g);var k,m,l=c,y=d,v=g,B=Math.pow(2,a),I=[];for(m=0;m<=B;m++){I[m]=[];var P=l.clone().lerp(v,m/B),K=y.clone().lerp(v,m/B),E=B-m;for(k=0;k<=E;k++)I[m][k]=0===k&&m===B?P:P.clone().lerp(K,k/E)}for(m=0;m<B;m++)for(k=0;k<2*(B-m)-1;k++)l=Math.floor(k/2),0===k%2?(e(I[m][l+1]),e(I[m+1][l]),e(I[m][l])):(e(I[m][l+1]),e(I[m+1][l+1]),e(I[m+1][l]))}})(d);(function(a){for(var b=
new p,c=0;c<h.length;c+=3)b.x=h[c+0],b.y=h[c+1],b.z=h[c+2],b.normalize().multiplyScalar(a),h[c+0]=b.x,h[c+1]=b.y,h[c+2]=b.z})(c);(function(){for(var a=new p,b=0;b<h.length;b+=3)a.x=h[b+0],a.y=h[b+1],a.z=h[b+2],k.push(Math.atan2(a.z,-a.x)/2/Math.PI+.5,1-(Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+.5));a=new p;b=new p;for(var c=new p,d=new p,e=new A,f=new A,l=new A,x=0,y=0;x<h.length;x+=9,y+=6){a.set(h[x+0],h[x+1],h[x+2]);b.set(h[x+3],h[x+4],h[x+5]);c.set(h[x+6],h[x+7],h[x+8]);e.set(k[y+0],
k[y+1]);f.set(k[y+2],k[y+3]);l.set(k[y+4],k[y+5]);d.copy(a).add(b).add(c).divideScalar(3);var v=Math.atan2(d.z,-d.x);g(e,y+0,a,v);g(f,y+2,b,v);g(l,y+4,c,v)}for(a=0;a<k.length;a+=6)b=k[a+0],c=k[a+2],d=k[a+4],e=Math.min(b,c,d),.9<Math.max(b,c,d)&&.1>e&&(.2>b&&(k[a+0]+=1),.2>c&&(k[a+2]+=1),.2>d&&(k[a+4]+=1))})();this.addAttribute("position",new z(h,3));this.addAttribute("normal",new z(h.slice(),3));this.addAttribute("uv",new z(k,2));0===d?this.computeVertexNormals():this.normalizeNormals()}function Jc(a,
b){R.call(this);this.type="TetrahedronGeometry";this.parameters={radius:a,detail:b};this.fromBufferGeometry(new Tb(a,b));this.mergeVertices()}function Tb(a,b){na.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],a,b);this.type="TetrahedronBufferGeometry";this.parameters={radius:a,detail:b}}function Kc(a,b){R.call(this);this.type="OctahedronGeometry";this.parameters={radius:a,detail:b};this.fromBufferGeometry(new qb(a,b));this.mergeVertices()}function qb(a,b){na.call(this,[1,0,0,
-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],a,b);this.type="OctahedronBufferGeometry";this.parameters={radius:a,detail:b}}function Lc(a,b){R.call(this);this.type="IcosahedronGeometry";this.parameters={radius:a,detail:b};this.fromBufferGeometry(new Ub(a,b));this.mergeVertices()}function Ub(a,b){var c=(1+Math.sqrt(5))/2;na.call(this,[-1,c,0,1,c,0,-1,-c,0,1,-c,0,0,-1,c,0,1,c,0,-1,-c,0,1,-c,c,0,-1,c,0,1,-c,0,-1,-c,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,
11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a,b);this.type="IcosahedronBufferGeometry";this.parameters={radius:a,detail:b}}function Mc(a,b){R.call(this);this.type="DodecahedronGeometry";this.parameters={radius:a,detail:b};this.fromBufferGeometry(new Vb(a,b));this.mergeVertices()}function Vb(a,b){var c=(1+Math.sqrt(5))/2,d=1/c;na.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-d,-c,0,-d,c,0,d,-c,0,d,c,-d,-c,0,-d,c,0,d,-c,0,d,c,
0,-c,0,-d,c,0,-d,-c,0,d,c,0,d],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a,b);this.type="DodecahedronBufferGeometry";this.parameters={radius:a,detail:b}}function Nc(a,b,c,d,e,f){R.call(this);this.type="TubeGeometry";this.parameters={path:a,tubularSegments:b,radius:c,radialSegments:d,
closed:e};void 0!==f&&console.warn("THREE.TubeGeometry: taper has been removed.");a=new Wb(a,b,c,d,e);this.tangents=a.tangents;this.normals=a.normals;this.binormals=a.binormals;this.fromBufferGeometry(a);this.mergeVertices()}function Wb(a,b,c,d,e){function f(e){q=a.getPointAt(e/b,q);var f=g.normals[e];e=g.binormals[e];for(r=0;r<=d;r++){var m=r/d*Math.PI*2,n=Math.sin(m);m=-Math.cos(m);k.x=m*f.x+n*e.x;k.y=m*f.y+n*e.y;k.z=m*f.z+n*e.z;k.normalize();t.push(k.x,k.y,k.z);h.x=q.x+c*k.x;h.y=q.y+c*k.y;h.z=
q.z+c*k.z;l.push(h.x,h.y,h.z)}}C.call(this);this.type="TubeBufferGeometry";this.parameters={path:a,tubularSegments:b,radius:c,radialSegments:d,closed:e};b=b||64;c=c||1;d=d||8;e=e||!1;var g=a.computeFrenetFrames(b,e);this.tangents=g.tangents;this.normals=g.normals;this.binormals=g.binormals;var h=new p,k=new p,m=new A,q=new p,n,r,l=[],t=[],u=[],x=[];for(n=0;n<b;n++)f(n);f(!1===e?b:0);for(n=0;n<=b;n++)for(r=0;r<=d;r++)m.x=n/b,m.y=r/d,u.push(m.x,m.y);(function(){for(r=1;r<=b;r++)for(n=1;n<=d;n++){var a=
(d+1)*r+(n-1),c=(d+1)*r+n,e=(d+1)*(r-1)+n;x.push((d+1)*(r-1)+(n-1),a,e);x.push(a,c,e)}})();this.setIndex(x);this.addAttribute("position",new z(l,3));this.addAttribute("normal",new z(t,3));this.addAttribute("uv",new z(u,2))}function Oc(a,b,c,d,e,f,g){R.call(this);this.type="TorusKnotGeometry";this.parameters={radius:a,tube:b,tubularSegments:c,radialSegments:d,p:e,q:f};void 0!==g&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead.");this.fromBufferGeometry(new Xb(a,
b,c,d,e,f));this.mergeVertices()}function Xb(a,b,c,d,e,f){function g(a,b,c,d,e){var f=Math.sin(a);b=c/b*a;c=Math.cos(b);e.x=d*(2+c)*.5*Math.cos(a);e.y=d*(2+c)*f*.5;e.z=d*Math.sin(b)*.5}C.call(this);this.type="TorusKnotBufferGeometry";this.parameters={radius:a,tube:b,tubularSegments:c,radialSegments:d,p:e,q:f};a=a||1;b=b||.4;c=Math.floor(c)||64;d=Math.floor(d)||8;e=e||2;f=f||3;var h=[],k=[],m=[],q=[],n,r=new p,l=new p,t=new p,u=new p,x=new p,y=new p,v=new p;for(n=0;n<=c;++n){var B=n/c*e*Math.PI*2;
g(B,e,f,a,t);g(B+.01,e,f,a,u);y.subVectors(u,t);v.addVectors(u,t);x.crossVectors(y,v);v.crossVectors(x,y);x.normalize();v.normalize();for(B=0;B<=d;++B){var I=B/d*Math.PI*2,P=-b*Math.cos(I);I=b*Math.sin(I);r.x=t.x+(P*v.x+I*x.x);r.y=t.y+(P*v.y+I*x.y);r.z=t.z+(P*v.z+I*x.z);k.push(r.x,r.y,r.z);l.subVectors(r,t).normalize();m.push(l.x,l.y,l.z);q.push(n/c);q.push(B/d)}}for(B=1;B<=c;B++)for(n=1;n<=d;n++)a=(d+1)*B+(n-1),b=(d+1)*B+n,e=(d+1)*(B-1)+n,h.push((d+1)*(B-1)+(n-1),a,e),h.push(a,b,e);this.setIndex(h);
this.addAttribute("position",new z(k,3));this.addAttribute("normal",new z(m,3));this.addAttribute("uv",new z(q,2))}function Pc(a,b,c,d,e){R.call(this);this.type="TorusGeometry";this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:d,arc:e};this.fromBufferGeometry(new Yb(a,b,c,d,e));this.mergeVertices()}function Yb(a,b,c,d,e){C.call(this);this.type="TorusBufferGeometry";this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:d,arc:e};a=a||1;b=b||.4;c=Math.floor(c)||8;d=Math.floor(d)||
6;e=e||2*Math.PI;var f=[],g=[],h=[],k=[],m=new p,q=new p,n=new p,r,l;for(r=0;r<=c;r++)for(l=0;l<=d;l++){var t=l/d*e,u=r/c*Math.PI*2;q.x=(a+b*Math.cos(u))*Math.cos(t);q.y=(a+b*Math.cos(u))*Math.sin(t);q.z=b*Math.sin(u);g.push(q.x,q.y,q.z);m.x=a*Math.cos(t);m.y=a*Math.sin(t);n.subVectors(q,m).normalize();h.push(n.x,n.y,n.z);k.push(l/d);k.push(r/c)}for(r=1;r<=c;r++)for(l=1;l<=d;l++)a=(d+1)*(r-1)+l-1,b=(d+1)*(r-1)+l,e=(d+1)*r+l,f.push((d+1)*r+l-1,a,e),f.push(a,b,e);this.setIndex(f);this.addAttribute("position",
new z(g,3));this.addAttribute("normal",new z(h,3));this.addAttribute("uv",new z(k,2))}function df(a,b,c,d,e){for(var f,g=0,h=b,k=c-d;h<c;h+=d)g+=(a[k]-a[h])*(a[h+1]+a[k+1]),k=h;if(e===0<g)for(e=b;e<c;e+=d)f=ef(e,a[e],a[e+1],f);else for(e=c-d;e>=b;e-=d)f=ef(e,a[e],a[e+1],f);f&&rb(f,f.next)&&(Qc(f),f=f.next);return f}function Rc(a,b){if(!a)return a;b||(b=a);do{var c=!1;if(a.steiner||!rb(a,a.next)&&0!==ma(a.prev,a,a.next))a=a.next;else{Qc(a);a=b=a.prev;if(a===a.next)break;c=!0}}while(c||a!==b);return b}
function Sc(a,b,c,d,e,f,g){if(a){if(!g&&f){var h=a,k=h;do null===k.z&&(k.z=be(k.x,k.y,d,e,f)),k.prevZ=k.prev,k=k.nextZ=k.next;while(k!==h);k.prevZ.nextZ=null;k.prevZ=null;h=k;var m,q,n,r,l=1;do{k=h;var t=h=null;for(q=0;k;){q++;var p=k;for(m=n=0;m<l&&(n++,p=p.nextZ,p);m++);for(r=l;0<n||0<r&&p;)0!==n&&(0===r||!p||k.z<=p.z)?(m=k,k=k.nextZ,n--):(m=p,p=p.nextZ,r--),t?t.nextZ=m:h=m,m.prevZ=t,t=m;k=p}t.nextZ=null;l*=2}while(1<q)}for(h=a;a.prev!==a.next;){k=a.prev;p=a.next;if(f)a:{t=a;r=d;var x=e,y=f;q=t.prev;
n=t;l=t.next;if(0<=ma(q,n,l))t=!1;else{var v=q.x>n.x?q.x>l.x?q.x:l.x:n.x>l.x?n.x:l.x,B=q.y>n.y?q.y>l.y?q.y:l.y:n.y>l.y?n.y:l.y;m=be(q.x<n.x?q.x<l.x?q.x:l.x:n.x<l.x?n.x:l.x,q.y<n.y?q.y<l.y?q.y:l.y:n.y<l.y?n.y:l.y,r,x,y);r=be(v,B,r,x,y);for(x=t.nextZ;x&&x.z<=r;){if(x!==t.prev&&x!==t.next&&wd(q.x,q.y,n.x,n.y,l.x,l.y,x.x,x.y)&&0<=ma(x.prev,x,x.next)){t=!1;break a}x=x.nextZ}for(x=t.prevZ;x&&x.z>=m;){if(x!==t.prev&&x!==t.next&&wd(q.x,q.y,n.x,n.y,l.x,l.y,x.x,x.y)&&0<=ma(x.prev,x,x.next)){t=!1;break a}x=
x.prevZ}t=!0}}else a:if(t=a,q=t.prev,n=t,l=t.next,0<=ma(q,n,l))t=!1;else{for(m=t.next.next;m!==t.prev;){if(wd(q.x,q.y,n.x,n.y,l.x,l.y,m.x,m.y)&&0<=ma(m.prev,m,m.next)){t=!1;break a}m=m.next}t=!0}if(t)b.push(k.i/c),b.push(a.i/c),b.push(p.i/c),Qc(a),h=a=p.next;else if(a=p,a===h){if(!g)Sc(Rc(a),b,c,d,e,f,1);else if(1===g){g=b;h=c;k=a;do p=k.prev,t=k.next.next,!rb(p,t)&&ff(p,k,k.next,t)&&Tc(p,t)&&Tc(t,p)&&(g.push(p.i/h),g.push(k.i/h),g.push(t.i/h),Qc(k),Qc(k.next),k=a=t),k=k.next;while(k!==a);a=k;Sc(a,
b,c,d,e,f,2)}else if(2===g)a:{g=a;do{for(h=g.next.next;h!==g.prev;){if(k=g.i!==h.i){k=g;p=h;if(t=k.next.i!==p.i&&k.prev.i!==p.i){b:{t=k;do{if(t.i!==k.i&&t.next.i!==k.i&&t.i!==p.i&&t.next.i!==p.i&&ff(t,t.next,k,p)){t=!0;break b}t=t.next}while(t!==k);t=!1}t=!t}if(t=t&&Tc(k,p)&&Tc(p,k)){t=k;q=!1;n=(k.x+p.x)/2;p=(k.y+p.y)/2;do t.y>p!==t.next.y>p&&t.next.y!==t.y&&n<(t.next.x-t.x)*(p-t.y)/(t.next.y-t.y)+t.x&&(q=!q),t=t.next;while(t!==k);t=q}k=t}if(k){a=gf(g,h);g=Rc(g,g.next);a=Rc(a,a.next);Sc(g,b,c,d,e,
f);Sc(a,b,c,d,e,f);break a}h=h.next}g=g.next}while(g!==a)}break}}}}function Ug(a,b){return a.x-b.x}function Vg(a,b){var c=b,d=a.x,e=a.y,f=-Infinity;do{if(e<=c.y&&e>=c.next.y&&c.next.y!==c.y){var g=c.x+(e-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if(g<=d&&g>f){f=g;if(g===d){if(e===c.y)return c;if(e===c.next.y)return c.next}var h=c.x<c.next.x?c:c.next}}c=c.next}while(c!==b);if(!h)return null;if(d===f)return h.prev;b=h;g=h.x;var k=h.y,m=Infinity;for(c=h.next;c!==b;){if(d>=c.x&&c.x>=g&&d!==c.x&&wd(e<k?d:f,e,
g,k,e<k?f:d,e,c.x,c.y)){var q=Math.abs(e-c.y)/(d-c.x);(q<m||q===m&&c.x>h.x)&&Tc(c,a)&&(h=c,m=q)}c=c.next}return h}function be(a,b,c,d,e){a=32767*(a-c)*e;b=32767*(b-d)*e;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;b=(b|b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;return(a|a<<1)&1431655765|((b|b<<1)&1431655765)<<1}function Wg(a){var b=a,c=a;do b.x<c.x&&(c=b),b=b.next;while(b!==a);return c}function wd(a,b,c,d,e,f,g,h){return 0<=(e-g)*(b-h)-(a-g)*(f-h)&&0<=(a-g)*(d-h)-(c-
g)*(b-h)&&0<=(c-g)*(f-h)-(e-g)*(d-h)}function ma(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function rb(a,b){return a.x===b.x&&a.y===b.y}function ff(a,b,c,d){return rb(a,b)&&rb(c,d)||rb(a,d)&&rb(c,b)?!0:0<ma(a,b,c)!==0<ma(a,b,d)&&0<ma(c,d,a)!==0<ma(c,d,b)}function Tc(a,b){return 0>ma(a.prev,a,a.next)?0<=ma(a,b,a.next)&&0<=ma(a,a.prev,b):0>ma(a,b,a.prev)||0>ma(a,a.next,b)}function gf(a,b){var c=new ce(a.i,a.x,a.y),d=new ce(b.i,b.x,b.y),e=a.next,f=b.prev;a.next=b;b.prev=a;c.next=e;e.prev=
c;d.next=c;c.prev=d;f.next=d;d.prev=f;return d}function ef(a,b,c,d){a=new ce(a,b,c);d?(a.next=d.next,a.prev=d,d.next.prev=a,d.next=a):(a.prev=a,a.next=a);return a}function Qc(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function ce(a,b,c){this.i=a;this.x=b;this.y=c;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function hf(a){var b=a.length;2<b&&a[b-1].equals(a[0])&&a.pop()}function jf(a,b){for(var c=0;c<b.length;c++)a.push(b[c].x),
a.push(b[c].y)}function sb(a,b){R.call(this);this.type="ExtrudeGeometry";this.parameters={shapes:a,options:b};this.fromBufferGeometry(new Oa(a,b));this.mergeVertices()}function Oa(a,b){function c(a){function c(a,b,c){b||console.error("THREE.ExtrudeGeometry: vec does not exist");return b.clone().multiplyScalar(c).add(a)}function g(a,b,c){var d=a.x-b.x;var e=a.y-b.y;var f=c.x-a.x;var g=c.y-a.y,h=d*d+e*e;if(Math.abs(d*g-e*f)>Number.EPSILON){var k=Math.sqrt(h),m=Math.sqrt(f*f+g*g);h=b.x-e/k;b=b.y+d/k;
g=((c.x-g/m-h)*g-(c.y+f/m-b)*f)/(d*g-e*f);f=h+d*g-a.x;d=b+e*g-a.y;e=f*f+d*d;if(2>=e)return new A(f,d);e=Math.sqrt(e/2)}else a=!1,d>Number.EPSILON?f>Number.EPSILON&&(a=!0):d<-Number.EPSILON?f<-Number.EPSILON&&(a=!0):Math.sign(e)===Math.sign(g)&&(a=!0),a?(f=-e,e=Math.sqrt(h)):(f=d,d=e,e=Math.sqrt(h/2));return new A(f/e,d/e)}function h(a,b){for(N=a.length;0<=--N;){var c=N;var f=N-1;0>f&&(f=a.length-1);var g,h=v+2*E;for(g=0;g<h;g++){var k=Z*g,m=Z*(g+1),q=b+f+k,n=b+f+m;m=b+c+m;t(b+c+k);t(q);t(m);t(q);
t(n);t(m);k=e.length/3;k=D.generateSideWallUV(d,e,k-6,k-3,k-2,k-1);u(k[0]);u(k[1]);u(k[3]);u(k[1]);u(k[2]);u(k[3])}}}function k(a,b,c){x.push(a);x.push(b);x.push(c)}function l(a,b,c){t(a);t(b);t(c);a=e.length/3;a=D.generateTopUV(d,e,a-3,a-2,a-1);u(a[0]);u(a[1]);u(a[2])}function t(a){e.push(x[3*a]);e.push(x[3*a+1]);e.push(x[3*a+2])}function u(a){f.push(a.x);f.push(a.y)}var x=[],y=void 0!==b.curveSegments?b.curveSegments:12,v=void 0!==b.steps?b.steps:1,B=void 0!==b.depth?b.depth:100,I=void 0!==b.bevelEnabled?
b.bevelEnabled:!0,P=void 0!==b.bevelThickness?b.bevelThickness:6,K=void 0!==b.bevelSize?b.bevelSize:P-2,E=void 0!==b.bevelSegments?b.bevelSegments:3,z=b.extrudePath,D=void 0!==b.UVGenerator?b.UVGenerator:Xg;void 0!==b.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),B=b.amount);var C=!1;if(z){var H=z.getSpacedPoints(v);C=!0;I=!1;var L=z.computeFrenetFrames(v,!1);var M=new p;var R=new p;var Q=new p}I||(K=P=E=0);var J;y=a.extractPoints(y);a=y.shape;var O=y.holes;
if(!Wa.isClockWise(a)){a=a.reverse();var G=0;for(J=O.length;G<J;G++){var S=O[G];Wa.isClockWise(S)&&(O[G]=S.reverse())}}var Y=Wa.triangulateShape(a,O),W=a;G=0;for(J=O.length;G<J;G++)S=O[G],a=a.concat(S);var T,Z=a.length,V,ea=Y.length;y=[];var N=0;var U=W.length;var X=U-1;for(T=N+1;N<U;N++,X++,T++)X===U&&(X=0),T===U&&(T=0),y[N]=g(W[N],W[X],W[T]);z=[];var fa=y.concat();G=0;for(J=O.length;G<J;G++){S=O[G];var ca=[];N=0;U=S.length;X=U-1;for(T=N+1;N<U;N++,X++,T++)X===U&&(X=0),T===U&&(T=0),ca[N]=g(S[N],S[X],
S[T]);z.push(ca);fa=fa.concat(ca)}for(X=0;X<E;X++){U=X/E;var da=P*Math.cos(U*Math.PI/2);T=K*Math.sin(U*Math.PI/2);N=0;for(U=W.length;N<U;N++){var aa=c(W[N],y[N],T);k(aa.x,aa.y,-da)}G=0;for(J=O.length;G<J;G++)for(S=O[G],ca=z[G],N=0,U=S.length;N<U;N++)aa=c(S[N],ca[N],T),k(aa.x,aa.y,-da)}T=K;for(N=0;N<Z;N++)aa=I?c(a[N],fa[N],T):a[N],C?(R.copy(L.normals[0]).multiplyScalar(aa.x),M.copy(L.binormals[0]).multiplyScalar(aa.y),Q.copy(H[0]).add(R).add(M),k(Q.x,Q.y,Q.z)):k(aa.x,aa.y,0);for(U=1;U<=v;U++)for(N=
0;N<Z;N++)aa=I?c(a[N],fa[N],T):a[N],C?(R.copy(L.normals[U]).multiplyScalar(aa.x),M.copy(L.binormals[U]).multiplyScalar(aa.y),Q.copy(H[U]).add(R).add(M),k(Q.x,Q.y,Q.z)):k(aa.x,aa.y,B/v*U);for(X=E-1;0<=X;X--){U=X/E;da=P*Math.cos(U*Math.PI/2);T=K*Math.sin(U*Math.PI/2);N=0;for(U=W.length;N<U;N++)aa=c(W[N],y[N],T),k(aa.x,aa.y,B+da);G=0;for(J=O.length;G<J;G++)for(S=O[G],ca=z[G],N=0,U=S.length;N<U;N++)aa=c(S[N],ca[N],T),C?k(aa.x,aa.y+H[v-1].y,H[v-1].x+da):k(aa.x,aa.y,B+da)}(function(){var a=e.length/3;if(I){var b=
0*Z;for(N=0;N<ea;N++)V=Y[N],l(V[2]+b,V[1]+b,V[0]+b);b=Z*(v+2*E);for(N=0;N<ea;N++)V=Y[N],l(V[0]+b,V[1]+b,V[2]+b)}else{for(N=0;N<ea;N++)V=Y[N],l(V[2],V[1],V[0]);for(N=0;N<ea;N++)V=Y[N],l(V[0]+Z*v,V[1]+Z*v,V[2]+Z*v)}d.addGroup(a,e.length/3-a,0)})();(function(){var a=e.length/3,b=0;h(W,b);b+=W.length;G=0;for(J=O.length;G<J;G++)S=O[G],h(S,b),b+=S.length;d.addGroup(a,e.length/3-a,1)})()}C.call(this);this.type="ExtrudeBufferGeometry";this.parameters={shapes:a,options:b};a=Array.isArray(a)?a:[a];for(var d=
this,e=[],f=[],g=0,h=a.length;g<h;g++)c(a[g]);this.addAttribute("position",new z(e,3));this.addAttribute("uv",new z(f,2));this.computeVertexNormals()}function kf(a,b,c){c.shapes=[];if(Array.isArray(a))for(var d=0,e=a.length;d<e;d++)c.shapes.push(a[d].uuid);else c.shapes.push(a.uuid);void 0!==b.extrudePath&&(c.options.extrudePath=b.extrudePath.toJSON());return c}function Uc(a,b){R.call(this);this.type="TextGeometry";this.parameters={text:a,parameters:b};this.fromBufferGeometry(new Zb(a,b));this.mergeVertices()}
function Zb(a,b){b=b||{};var c=b.font;if(!c||!c.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new R;a=c.generateShapes(a,b.size);b.depth=void 0!==b.height?b.height:50;void 0===b.bevelThickness&&(b.bevelThickness=10);void 0===b.bevelSize&&(b.bevelSize=8);void 0===b.bevelEnabled&&(b.bevelEnabled=!1);Oa.call(this,a,b);this.type="TextBufferGeometry"}function Vc(a,b,c,d,e,f,g){R.call(this);this.type="SphereGeometry";this.parameters={radius:a,widthSegments:b,
heightSegments:c,phiStart:d,phiLength:e,thetaStart:f,thetaLength:g};this.fromBufferGeometry(new tb(a,b,c,d,e,f,g));this.mergeVertices()}function tb(a,b,c,d,e,f,g){C.call(this);this.type="SphereBufferGeometry";this.parameters={radius:a,widthSegments:b,heightSegments:c,phiStart:d,phiLength:e,thetaStart:f,thetaLength:g};a=a||1;b=Math.max(3,Math.floor(b)||8);c=Math.max(2,Math.floor(c)||6);d=void 0!==d?d:0;e=void 0!==e?e:2*Math.PI;f=void 0!==f?f:0;g=void 0!==g?g:Math.PI;var h=f+g,k,m,q=0,n=[],l=new p,
w=new p,t=[],u=[],x=[],y=[];for(m=0;m<=c;m++){var v=[],B=m/c;for(k=0;k<=b;k++){var I=k/b;l.x=-a*Math.cos(d+I*e)*Math.sin(f+B*g);l.y=a*Math.cos(f+B*g);l.z=a*Math.sin(d+I*e)*Math.sin(f+B*g);u.push(l.x,l.y,l.z);w.set(l.x,l.y,l.z).normalize();x.push(w.x,w.y,w.z);y.push(I,1-B);v.push(q++)}n.push(v)}for(m=0;m<c;m++)for(k=0;k<b;k++)a=n[m][k+1],d=n[m][k],e=n[m+1][k],g=n[m+1][k+1],(0!==m||0<f)&&t.push(a,d,g),(m!==c-1||h<Math.PI)&&t.push(d,e,g);this.setIndex(t);this.addAttribute("position",new z(u,3));this.addAttribute("normal",
new z(x,3));this.addAttribute("uv",new z(y,2))}function Wc(a,b,c,d,e,f){R.call(this);this.type="RingGeometry";this.parameters={innerRadius:a,outerRadius:b,thetaSegments:c,phiSegments:d,thetaStart:e,thetaLength:f};this.fromBufferGeometry(new $b(a,b,c,d,e,f));this.mergeVertices()}function $b(a,b,c,d,e,f){C.call(this);this.type="RingBufferGeometry";this.parameters={innerRadius:a,outerRadius:b,thetaSegments:c,phiSegments:d,thetaStart:e,thetaLength:f};a=a||.5;b=b||1;e=void 0!==e?e:0;f=void 0!==f?f:2*Math.PI;
c=void 0!==c?Math.max(3,c):8;d=void 0!==d?Math.max(1,d):1;var g=[],h=[],k=[],m=[],q=a,n=(b-a)/d,l=new p,w=new A,t,u;for(t=0;t<=d;t++){for(u=0;u<=c;u++)a=e+u/c*f,l.x=q*Math.cos(a),l.y=q*Math.sin(a),h.push(l.x,l.y,l.z),k.push(0,0,1),w.x=(l.x/b+1)/2,w.y=(l.y/b+1)/2,m.push(w.x,w.y);q+=n}for(t=0;t<d;t++)for(b=t*(c+1),u=0;u<c;u++)a=u+b,e=a+c+1,f=a+c+2,q=a+1,g.push(a,e,q),g.push(e,f,q);this.setIndex(g);this.addAttribute("position",new z(h,3));this.addAttribute("normal",new z(k,3));this.addAttribute("uv",
new z(m,2))}function Xc(a,b,c,d){R.call(this);this.type="LatheGeometry";this.parameters={points:a,segments:b,phiStart:c,phiLength:d};this.fromBufferGeometry(new ac(a,b,c,d));this.mergeVertices()}function ac(a,b,c,d){C.call(this);this.type="LatheBufferGeometry";this.parameters={points:a,segments:b,phiStart:c,phiLength:d};b=Math.floor(b)||12;c=c||0;d=d||2*Math.PI;d=G.clamp(d,0,2*Math.PI);var e=[],f=[],g=[],h=1/b,k=new p,m=new A,q;for(q=0;q<=b;q++){var n=c+q*h*d;var l=Math.sin(n),w=Math.cos(n);for(n=
0;n<=a.length-1;n++)k.x=a[n].x*l,k.y=a[n].y,k.z=a[n].x*w,f.push(k.x,k.y,k.z),m.x=q/b,m.y=n/(a.length-1),g.push(m.x,m.y)}for(q=0;q<b;q++)for(n=0;n<a.length-1;n++)c=n+q*a.length,h=c+a.length,k=c+a.length+1,m=c+1,e.push(c,h,m),e.push(h,k,m);this.setIndex(e);this.addAttribute("position",new z(f,3));this.addAttribute("uv",new z(g,2));this.computeVertexNormals();if(d===2*Math.PI)for(d=this.attributes.normal.array,e=new p,f=new p,g=new p,c=b*a.length*3,n=q=0;q<a.length;q++,n+=3)e.x=d[n+0],e.y=d[n+1],e.z=
d[n+2],f.x=d[c+n+0],f.y=d[c+n+1],f.z=d[c+n+2],g.addVectors(e,f).normalize(),d[n+0]=d[c+n+0]=g.x,d[n+1]=d[c+n+1]=g.y,d[n+2]=d[c+n+2]=g.z}function ub(a,b){R.call(this);this.type="ShapeGeometry";"object"===typeof b&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),b=b.curveSegments);this.parameters={shapes:a,curveSegments:b};this.fromBufferGeometry(new vb(a,b));this.mergeVertices()}function vb(a,b){function c(a){var c,h=e.length/3;a=a.extractPoints(b);var m=a.shape,q=a.holes;
if(!1===Wa.isClockWise(m))for(m=m.reverse(),a=0,c=q.length;a<c;a++){var l=q[a];!0===Wa.isClockWise(l)&&(q[a]=l.reverse())}var p=Wa.triangulateShape(m,q);a=0;for(c=q.length;a<c;a++)l=q[a],m=m.concat(l);a=0;for(c=m.length;a<c;a++)l=m[a],e.push(l.x,l.y,0),f.push(0,0,1),g.push(l.x,l.y);a=0;for(c=p.length;a<c;a++)m=p[a],d.push(m[0]+h,m[1]+h,m[2]+h),k+=3}C.call(this);this.type="ShapeBufferGeometry";this.parameters={shapes:a,curveSegments:b};b=b||12;var d=[],e=[],f=[],g=[],h=0,k=0;if(!1===Array.isArray(a))c(a);
else for(var m=0;m<a.length;m++)c(a[m]),this.addGroup(h,k,m),h+=k,k=0;this.setIndex(d);this.addAttribute("position",new z(e,3));this.addAttribute("normal",new z(f,3));this.addAttribute("uv",new z(g,2))}function lf(a,b){b.shapes=[];if(Array.isArray(a))for(var c=0,d=a.length;c<d;c++)b.shapes.push(a[c].uuid);else b.shapes.push(a.uuid);return b}function bc(a,b){C.call(this);this.type="EdgesGeometry";this.parameters={thresholdAngle:b};var c=[];b=Math.cos(G.DEG2RAD*(void 0!==b?b:1));var d=[0,0],e={},f=
["a","b","c"];if(a.isBufferGeometry){var g=new R;g.fromBufferGeometry(a)}else g=a.clone();g.mergeVertices();g.computeFaceNormals();a=g.vertices;g=g.faces;for(var h=0,k=g.length;h<k;h++)for(var m=g[h],q=0;3>q;q++){var n=m[f[q]];var l=m[f[(q+1)%3]];d[0]=Math.min(n,l);d[1]=Math.max(n,l);n=d[0]+","+d[1];void 0===e[n]?e[n]={index1:d[0],index2:d[1],face1:h,face2:void 0}:e[n].face2=h}for(n in e)if(d=e[n],void 0===d.face2||g[d.face1].normal.dot(g[d.face2].normal)<=b)f=a[d.index1],c.push(f.x,f.y,f.z),f=a[d.index2],
c.push(f.x,f.y,f.z);this.addAttribute("position",new z(c,3))}function wb(a,b,c,d,e,f,g,h){R.call(this);this.type="CylinderGeometry";this.parameters={radiusTop:a,radiusBottom:b,height:c,radialSegments:d,heightSegments:e,openEnded:f,thetaStart:g,thetaLength:h};this.fromBufferGeometry(new Xa(a,b,c,d,e,f,g,h));this.mergeVertices()}function Xa(a,b,c,d,e,f,g,h){function k(c){var e,f=new A,k=new p,r=0,u=!0===c?a:b,v=!0===c?1:-1;var z=t;for(e=1;e<=d;e++)n.push(0,x*v,0),l.push(0,v,0),w.push(.5,.5),t++;var C=
t;for(e=0;e<=d;e++){var D=e/d*h+g,G=Math.cos(D);D=Math.sin(D);k.x=u*D;k.y=x*v;k.z=u*G;n.push(k.x,k.y,k.z);l.push(0,v,0);f.x=.5*G+.5;f.y=.5*D*v+.5;w.push(f.x,f.y);t++}for(e=0;e<d;e++)f=z+e,k=C+e,!0===c?q.push(k,k+1,f):q.push(k+1,k,f),r+=3;m.addGroup(y,r,!0===c?1:2);y+=r}C.call(this);this.type="CylinderBufferGeometry";this.parameters={radiusTop:a,radiusBottom:b,height:c,radialSegments:d,heightSegments:e,openEnded:f,thetaStart:g,thetaLength:h};var m=this;a=void 0!==a?a:1;b=void 0!==b?b:1;c=c||1;d=Math.floor(d)||
8;e=Math.floor(e)||1;f=void 0!==f?f:!1;g=void 0!==g?g:0;h=void 0!==h?h:2*Math.PI;var q=[],n=[],l=[],w=[],t=0,u=[],x=c/2,y=0;(function(){var f,k,r=new p,P=new p,K=0,E=(b-a)/c;for(k=0;k<=e;k++){var A=[],z=k/e,D=z*(b-a)+a;for(f=0;f<=d;f++){var C=f/d,G=C*h+g,H=Math.sin(G);G=Math.cos(G);P.x=D*H;P.y=-z*c+x;P.z=D*G;n.push(P.x,P.y,P.z);r.set(H,E,G).normalize();l.push(r.x,r.y,r.z);w.push(C,1-z);A.push(t++)}u.push(A)}for(f=0;f<d;f++)for(k=0;k<e;k++)r=u[k+1][f],P=u[k+1][f+1],E=u[k][f+1],q.push(u[k][f],r,E),
q.push(r,P,E),K+=6;m.addGroup(y,K,0);y+=K})();!1===f&&(0<a&&k(!0),0<b&&k(!1));this.setIndex(q);this.addAttribute("position",new z(n,3));this.addAttribute("normal",new z(l,3));this.addAttribute("uv",new z(w,2))}function Yc(a,b,c,d,e,f,g){wb.call(this,0,a,b,c,d,e,f,g);this.type="ConeGeometry";this.parameters={radius:a,height:b,radialSegments:c,heightSegments:d,openEnded:e,thetaStart:f,thetaLength:g}}function Zc(a,b,c,d,e,f,g){Xa.call(this,0,a,b,c,d,e,f,g);this.type="ConeBufferGeometry";this.parameters=
{radius:a,height:b,radialSegments:c,heightSegments:d,openEnded:e,thetaStart:f,thetaLength:g}}function $c(a,b,c,d){R.call(this);this.type="CircleGeometry";this.parameters={radius:a,segments:b,thetaStart:c,thetaLength:d};this.fromBufferGeometry(new cc(a,b,c,d));this.mergeVertices()}function cc(a,b,c,d){C.call(this);this.type="CircleBufferGeometry";this.parameters={radius:a,segments:b,thetaStart:c,thetaLength:d};a=a||1;b=void 0!==b?Math.max(3,b):8;c=void 0!==c?c:0;d=void 0!==d?d:2*Math.PI;var e=[],f=
[],g=[],h=[],k,m=new p,q=new A;f.push(0,0,0);g.push(0,0,1);h.push(.5,.5);var n=0;for(k=3;n<=b;n++,k+=3){var l=c+n/b*d;m.x=a*Math.cos(l);m.y=a*Math.sin(l);f.push(m.x,m.y,m.z);g.push(0,0,1);q.x=(f[k]/a+1)/2;q.y=(f[k+1]/a+1)/2;h.push(q.x,q.y)}for(k=1;k<=b;k++)e.push(k,k+1,0);this.setIndex(e);this.addAttribute("position",new z(f,3));this.addAttribute("normal",new z(g,3));this.addAttribute("uv",new z(h,2))}function xb(a){O.call(this);this.type="ShadowMaterial";this.color=new H(0);this.transparent=!0;this.setValues(a)}
function dc(a){ta.call(this,a);this.type="RawShaderMaterial"}function Pa(a){O.call(this);this.defines={STANDARD:""};this.type="MeshStandardMaterial";this.color=new H(16777215);this.metalness=this.roughness=.5;this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new H(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new A(1,1);this.displacementMap=null;this.displacementScale=
1;this.displacementBias=0;this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null;this.envMapIntensity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)}function yb(a){Pa.call(this);this.defines={PHYSICAL:""};this.type="MeshPhysicalMaterial";this.reflectivity=.5;this.clearCoatRoughness=this.clearCoat=0;this.setValues(a)}function Fa(a){O.call(this);
this.type="MeshPhongMaterial";this.color=new H(16777215);this.specular=new H(1118481);this.shininess=30;this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new H(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new A(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.specularMap=null;this.combine=0;
this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)}function zb(a){Fa.call(this);this.defines={TOON:""};this.type="MeshToonMaterial";this.gradientMap=null;this.setValues(a)}function Ab(a){O.call(this);this.type="MeshNormalMaterial";this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new A(1,1);this.displacementMap=
null;this.displacementScale=1;this.displacementBias=0;this.wireframe=!1;this.wireframeLinewidth=1;this.morphNormals=this.morphTargets=this.skinning=this.lights=this.fog=!1;this.setValues(a);this.attributes=["position","normal"]}function Bb(a){O.call(this);this.type="MeshLambertMaterial";this.color=new H(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new H(0);this.emissiveIntensity=1;this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=
null;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)}function Cb(a){Y.call(this);this.type="LineDashedMaterial";this.scale=1;this.dashSize=3;this.gapSize=1;this.setValues(a)}function de(a,b,c){var d=this,e=!1,f=0,g=0,h=void 0;this.onStart=void 0;this.onLoad=a;this.onProgress=b;this.onError=c;this.itemStart=function(a){g++;
if(!1===e&&void 0!==d.onStart)d.onStart(a,f,g);e=!0};this.itemEnd=function(a){f++;if(void 0!==d.onProgress)d.onProgress(a,f,g);if(f===g&&(e=!1,void 0!==d.onLoad))d.onLoad()};this.itemError=function(a){if(void 0!==d.onError)d.onError(a)};this.resolveURL=function(a){return h?h(a):a};this.setURLModifier=function(a){h=a;return this}}function Ga(a){this.manager=void 0!==a?a:la}function mf(a){this.manager=void 0!==a?a:la;this._parser=null}function ee(a){this.manager=void 0!==a?a:la;this._parser=null}function ad(a){this.manager=
void 0!==a?a:la}function fe(a){this.manager=void 0!==a?a:la}function xd(a){this.manager=void 0!==a?a:la}function M(){this.type="Curve";this.arcLengthDivisions=200}function za(a,b,c,d,e,f,g,h){M.call(this);this.type="EllipseCurve";this.aX=a||0;this.aY=b||0;this.xRadius=c||1;this.yRadius=d||1;this.aStartAngle=e||0;this.aEndAngle=f||2*Math.PI;this.aClockwise=g||!1;this.aRotation=h||0}function ec(a,b,c,d,e,f){za.call(this,a,b,c,c,d,e,f);this.type="ArcCurve"}function ge(){var a=0,b=0,c=0,d=0;return{initCatmullRom:function(e,
f,g,h,k){e=k*(g-e);h=k*(h-f);a=f;b=e;c=-3*f+3*g-2*e-h;d=2*f-2*g+e+h},initNonuniformCatmullRom:function(e,f,g,h,k,m,q){e=((f-e)/k-(g-e)/(k+m)+(g-f)/m)*m;h=((g-f)/m-(h-f)/(m+q)+(h-g)/q)*m;a=f;b=e;c=-3*f+3*g-2*e-h;d=2*f-2*g+e+h},calc:function(e){var f=e*e;return a+b*e+c*f+d*f*e}}}function ca(a,b,c,d){M.call(this);this.type="CatmullRomCurve3";this.points=a||[];this.closed=b||!1;this.curveType=c||"centripetal";this.tension=d||.5}function nf(a,b,c,d,e){b=.5*(d-b);e=.5*(e-c);var f=a*a;return(2*c-2*d+b+e)*
a*f+(-3*c+3*d-2*b-e)*f+b*a+c}function bd(a,b,c,d){var e=1-a;return e*e*b+2*(1-a)*a*c+a*a*d}function cd(a,b,c,d,e){var f=1-a,g=1-a;return f*f*f*b+3*g*g*a*c+3*(1-a)*a*a*d+a*a*a*e}function Ha(a,b,c,d){M.call(this);this.type="CubicBezierCurve";this.v0=a||new A;this.v1=b||new A;this.v2=c||new A;this.v3=d||new A}function Qa(a,b,c,d){M.call(this);this.type="CubicBezierCurve3";this.v0=a||new p;this.v1=b||new p;this.v2=c||new p;this.v3=d||new p}function va(a,b){M.call(this);this.type="LineCurve";this.v1=a||
new A;this.v2=b||new A}function Ia(a,b){M.call(this);this.type="LineCurve3";this.v1=a||new p;this.v2=b||new p}function Ja(a,b,c){M.call(this);this.type="QuadraticBezierCurve";this.v0=a||new A;this.v1=b||new A;this.v2=c||new A}function Ra(a,b,c){M.call(this);this.type="QuadraticBezierCurve3";this.v0=a||new p;this.v1=b||new p;this.v2=c||new p}function Ka(a){M.call(this);this.type="SplineCurve";this.points=a||[]}function Ya(){M.call(this);this.type="CurvePath";this.curves=[];this.autoClose=!1}function La(a){Ya.call(this);
this.type="Path";this.currentPoint=new A;a&&this.setFromPoints(a)}function eb(a){La.call(this,a);this.uuid=G.generateUUID();this.type="Shape";this.holes=[]}function X(a,b){D.call(this);this.type="Light";this.color=new H(a);this.intensity=void 0!==b?b:1;this.receiveShadow=void 0}function yd(a,b,c){X.call(this,a,c);this.type="HemisphereLight";this.castShadow=void 0;this.position.copy(D.DefaultUp);this.updateMatrix();this.groundColor=new H(b)}function Db(a){this.camera=a;this.bias=0;this.radius=1;this.mapSize=
new A(512,512);this.map=null;this.matrix=new J}function zd(){Db.call(this,new Z(50,1,.5,500))}function Ad(a,b,c,d,e,f){X.call(this,a,b);this.type="SpotLight";this.position.copy(D.DefaultUp);this.updateMatrix();this.target=new D;Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(a){this.intensity=a/Math.PI}});this.distance=void 0!==c?c:0;this.angle=void 0!==d?d:Math.PI/3;this.penumbra=void 0!==e?e:0;this.decay=void 0!==f?f:1;this.shadow=new zd}function Bd(a,
b,c,d){X.call(this,a,b);this.type="PointLight";Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(a){this.intensity=a/(4*Math.PI)}});this.distance=void 0!==c?c:0;this.decay=void 0!==d?d:1;this.shadow=new Db(new Z(90,1,.5,500))}function Cd(){Db.call(this,new Ib(-5,5,5,-5,.5,500))}function Dd(a,b){X.call(this,a,b);this.type="DirectionalLight";this.position.copy(D.DefaultUp);this.updateMatrix();this.target=new D;this.shadow=new Cd}function Ed(a,b){X.call(this,
a,b);this.type="AmbientLight";this.castShadow=void 0}function Fd(a,b,c,d){X.call(this,a,b);this.type="RectAreaLight";this.width=void 0!==c?c:10;this.height=void 0!==d?d:10}function wa(a,b,c,d){this.parameterPositions=a;this._cachedIndex=0;this.resultBuffer=void 0!==d?d:new b.constructor(c);this.sampleValues=b;this.valueSize=c}function Gd(a,b,c,d){wa.call(this,a,b,c,d);this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0}function dd(a,b,c,d){wa.call(this,a,b,c,d)}function Hd(a,b,
c,d){wa.call(this,a,b,c,d)}function oa(a,b,c,d){if(void 0===a)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===b||0===b.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+a);this.name=a;this.times=ia.convertArray(b,this.TimeBufferType);this.values=ia.convertArray(c,this.ValueBufferType);this.setInterpolation(d||this.DefaultInterpolation)}function Id(a,b,c){oa.call(this,a,b,c)}function Jd(a,b,c,d){oa.call(this,a,b,c,d)}function fc(a,b,c,d){oa.call(this,a,
b,c,d)}function Kd(a,b,c,d){wa.call(this,a,b,c,d)}function ed(a,b,c,d){oa.call(this,a,b,c,d)}function Ld(a,b,c,d){oa.call(this,a,b,c,d)}function gc(a,b,c,d){oa.call(this,a,b,c,d)}function Ca(a,b,c){this.name=a;this.tracks=c;this.duration=void 0!==b?b:-1;this.uuid=G.generateUUID();0>this.duration&&this.resetDuration()}function Yg(a){switch(a.toLowerCase()){case "scalar":case "double":case "float":case "number":case "integer":return fc;case "vector":case "vector2":case "vector3":case "vector4":return gc;
case "color":return Jd;case "quaternion":return ed;case "bool":case "boolean":return Id;case "string":return Ld}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+a);}function Zg(a){if(void 0===a.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");var b=Yg(a.type);if(void 0===a.times){var c=[],d=[];ia.flattenJSON(a.keys,c,d,"value");a.times=c;a.values=d}return void 0!==b.parse?b.parse(a):new b(a.name,a.times,a.values,a.interpolation)}function Md(a){this.manager=void 0!==
a?a:la;this.textures={}}function he(a){this.manager=void 0!==a?a:la}function hc(){}function ie(a){"boolean"===typeof a&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),a=void 0);this.manager=void 0!==a?a:la;this.withCredentials=!1}function of(a){this.manager=void 0!==a?a:la;this.texturePath=""}function je(a){"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported.");"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported.");
this.manager=void 0!==a?a:la;this.options=void 0}function ke(){this.type="ShapePath";this.color=new H;this.subPaths=[];this.currentPath=null}function le(a){this.type="Font";this.data=a}function pf(a){this.manager=void 0!==a?a:la}function me(a){this.manager=void 0!==a?a:la}function qf(){this.type="StereoCamera";this.aspect=1;this.eyeSep=.064;this.cameraL=new Z;this.cameraL.layers.enable(1);this.cameraL.matrixAutoUpdate=!1;this.cameraR=new Z;this.cameraR.layers.enable(2);this.cameraR.matrixAutoUpdate=
!1}function fd(a,b,c){D.call(this);this.type="CubeCamera";var d=new Z(90,1,a,b);d.up.set(0,-1,0);d.lookAt(new p(1,0,0));this.add(d);var e=new Z(90,1,a,b);e.up.set(0,-1,0);e.lookAt(new p(-1,0,0));this.add(e);var f=new Z(90,1,a,b);f.up.set(0,0,1);f.lookAt(new p(0,1,0));this.add(f);var g=new Z(90,1,a,b);g.up.set(0,0,-1);g.lookAt(new p(0,-1,0));this.add(g);var h=new Z(90,1,a,b);h.up.set(0,-1,0);h.lookAt(new p(0,0,1));this.add(h);var k=new Z(90,1,a,b);k.up.set(0,-1,0);k.lookAt(new p(0,0,-1));this.add(k);
this.renderTarget=new Hb(c,c,{format:1022,magFilter:1006,minFilter:1006});this.renderTarget.texture.name="CubeCamera";this.update=function(a,b){null===this.parent&&this.updateMatrixWorld();var c=this.renderTarget,m=c.texture.generateMipmaps;c.texture.generateMipmaps=!1;c.activeCubeFace=0;a.render(b,d,c);c.activeCubeFace=1;a.render(b,e,c);c.activeCubeFace=2;a.render(b,f,c);c.activeCubeFace=3;a.render(b,g,c);c.activeCubeFace=4;a.render(b,h,c);c.texture.generateMipmaps=m;c.activeCubeFace=5;a.render(b,
k,c);a.setRenderTarget(null)};this.clear=function(a,b,c,d){for(var e=this.renderTarget,f=0;6>f;f++)e.activeCubeFace=f,a.setRenderTarget(e),a.clear(b,c,d);a.setRenderTarget(null)}}function ne(){D.call(this);this.type="AudioListener";this.context=oe.getContext();this.gain=this.context.createGain();this.gain.connect(this.context.destination);this.filter=null}function ic(a){D.call(this);this.type="Audio";this.context=a.context;this.gain=this.context.createGain();this.gain.connect(a.getInput());this.autoplay=
!1;this.buffer=null;this.loop=!1;this.offset=this.startTime=0;this.playbackRate=1;this.isPlaying=!1;this.hasPlaybackControl=!0;this.sourceType="empty";this.filters=[]}function pe(a){ic.call(this,a);this.panner=this.context.createPanner();this.panner.connect(this.gain)}function qe(a,b){this.analyser=a.context.createAnalyser();this.analyser.fftSize=void 0!==b?b:2048;this.data=new Uint8Array(this.analyser.frequencyBinCount);a.getOutput().connect(this.analyser)}function re(a,b,c){this.binding=a;this.valueSize=
c;a=Float64Array;switch(b){case "quaternion":b=this._slerp;break;case "string":case "bool":a=Array;b=this._select;break;default:b=this._lerp}this.buffer=new a(4*c);this._mixBufferRegion=b;this.referenceCount=this.useCount=this.cumulativeWeight=0}function rf(a,b,c){c=c||pa.parseTrackName(b);this._targetGroup=a;this._bindings=a.subscribe_(b,c)}function pa(a,b,c){this.path=b;this.parsedPath=c||pa.parseTrackName(b);this.node=pa.findNode(a,this.parsedPath.nodeName)||a;this.rootNode=a}function sf(){this.uuid=
G.generateUUID();this._objects=Array.prototype.slice.call(arguments);this.nCachedObjects_=0;var a={};this._indicesByUUID=a;for(var b=0,c=arguments.length;b!==c;++b)a[arguments[b].uuid]=b;this._paths=[];this._parsedPaths=[];this._bindings=[];this._bindingsIndicesByPath={};var d=this;this.stats={objects:{get total(){return d._objects.length},get inUse(){return this.total-d.nCachedObjects_}},get bindingsPerObject(){return d._bindings.length}}}function tf(a,b,c){this._mixer=a;this._clip=b;this._localRoot=
c||null;a=b.tracks;b=a.length;c=Array(b);for(var d={endingStart:2400,endingEnd:2400},e=0;e!==b;++e){var f=a[e].createInterpolant(null);c[e]=f;f.settings=d}this._interpolantSettings=d;this._interpolants=c;this._propertyBindings=Array(b);this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null;this.loop=2201;this._loopCount=-1;this._startTime=null;this.time=0;this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1;this.repetitions=Infinity;
this.paused=!1;this.enabled=!0;this.clampWhenFinished=!1;this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}function se(a){this._root=a;this._initMemoryManager();this.time=this._accuIndex=0;this.timeScale=1}function Nd(a,b){"string"===typeof a&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),a=b);this.value=a}function te(){C.call(this);this.type="InstancedBufferGeometry";this.maxInstancedCount=void 0}function ue(a,b,c){pb.call(this,a,b);this.meshPerAttribute=c||1}function ve(a,b,c){Q.call(this,
a,b);this.meshPerAttribute=c||1}function uf(a,b,c,d){this.ray=new nb(a,b);this.near=c||0;this.far=d||Infinity;this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}};Object.defineProperties(this.params,{PointCloud:{get:function(){console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points.");return this.Points}}})}function vf(a,b){return a.distance-b.distance}function we(a,b,c,d){if(!1!==a.visible&&(a.raycast(b,c),!0===d)){a=a.children;d=0;for(var e=a.length;d<e;d++)we(a[d],
b,c,!0)}}function wf(a){this.autoStart=void 0!==a?a:!0;this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1}function xf(a,b,c){this.radius=void 0!==a?a:1;this.phi=void 0!==b?b:0;this.theta=void 0!==c?c:0;return this}function yf(a,b,c){this.radius=void 0!==a?a:1;this.theta=void 0!==b?b:0;this.y=void 0!==c?c:0;return this}function xe(a,b){this.min=void 0!==a?a:new A(Infinity,Infinity);this.max=void 0!==b?b:new A(-Infinity,-Infinity)}function ye(a,b){this.start=void 0!==a?a:new p;this.end=
void 0!==b?b:new p}function gd(a){D.call(this);this.material=a;this.render=function(){}}function hd(a,b,c,d){this.object=a;this.size=void 0!==b?b:1;a=void 0!==c?c:16711680;d=void 0!==d?d:1;b=0;(c=this.object.geometry)&&c.isGeometry?b=3*c.faces.length:c&&c.isBufferGeometry&&(b=c.attributes.normal.count);c=new C;b=new z(6*b,3);c.addAttribute("position",b);W.call(this,c,new Y({color:a,linewidth:d}));this.matrixAutoUpdate=!1;this.update()}function jc(a,b){D.call(this);this.light=a;this.light.updateMatrixWorld();
this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=b;a=new C;b=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var c=0,d=1;32>c;c++,d++){var e=c/32*Math.PI*2,f=d/32*Math.PI*2;b.push(Math.cos(e),Math.sin(e),1,Math.cos(f),Math.sin(f),1)}a.addAttribute("position",new z(b,3));b=new Y({fog:!1});this.cone=new W(a,b);this.add(this.cone);this.update()}function zf(a){var b=[];a&&a.isBone&&b.push(a);for(var c=0;c<a.children.length;c++)b.push.apply(b,zf(a.children[c]));return b}
function kc(a){for(var b=zf(a),c=new C,d=[],e=[],f=new H(0,0,1),g=new H(0,1,0),h=0;h<b.length;h++){var k=b[h];k.parent&&k.parent.isBone&&(d.push(0,0,0),d.push(0,0,0),e.push(f.r,f.g,f.b),e.push(g.r,g.g,g.b))}c.addAttribute("position",new z(d,3));c.addAttribute("color",new z(e,3));d=new Y({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0});W.call(this,c,d);this.root=a;this.bones=b;this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1}function lc(a,b,c){this.light=a;this.light.updateMatrixWorld();
this.color=c;a=new tb(b,4,2);b=new da({wireframe:!0,fog:!1});ka.call(this,a,b);this.matrix=this.light.matrixWorld;this.matrixAutoUpdate=!1;this.update()}function mc(a,b){D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=b;a=new Y({fog:!1});b=new C;b.addAttribute("position",new Q(new Float32Array(15),3));this.line=new sa(b,a);this.add(this.line);this.update()}function nc(a,b,c){D.call(this);this.light=a;this.light.updateMatrixWorld();
this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=c;a=new qb(b);a.rotateY(.5*Math.PI);this.material=new da({wireframe:!0,fog:!1});void 0===this.color&&(this.material.vertexColors=2);b=a.getAttribute("position");b=new Float32Array(3*b.count);a.addAttribute("color",new Q(b,3));this.add(new ka(a,this.material));this.update()}function id(a,b,c,d){a=a||10;b=b||10;c=new H(void 0!==c?c:4473924);d=new H(void 0!==d?d:8947848);var e=b/2,f=a/b,g=a/2;a=[];for(var h=[],k=0,m=0,q=-g;k<=b;k++,q+=f){a.push(-g,
0,q,g,0,q);a.push(q,0,-g,q,0,g);var n=k===e?c:d;n.toArray(h,m);m+=3;n.toArray(h,m);m+=3;n.toArray(h,m);m+=3;n.toArray(h,m);m+=3}b=new C;b.addAttribute("position",new z(a,3));b.addAttribute("color",new z(h,3));c=new Y({vertexColors:2});W.call(this,b,c)}function Od(a,b,c,d,e,f){a=a||10;b=b||16;c=c||8;d=d||64;e=new H(void 0!==e?e:4473924);f=new H(void 0!==f?f:8947848);var g=[],h=[],k;for(k=0;k<=b;k++){var m=k/b*2*Math.PI;var q=Math.sin(m)*a;m=Math.cos(m)*a;g.push(0,0,0);g.push(q,0,m);var n=k&1?e:f;h.push(n.r,
n.g,n.b);h.push(n.r,n.g,n.b)}for(k=0;k<=c;k++){n=k&1?e:f;var l=a-a/c*k;for(b=0;b<d;b++)m=b/d*2*Math.PI,q=Math.sin(m)*l,m=Math.cos(m)*l,g.push(q,0,m),h.push(n.r,n.g,n.b),m=(b+1)/d*2*Math.PI,q=Math.sin(m)*l,m=Math.cos(m)*l,g.push(q,0,m),h.push(n.r,n.g,n.b)}a=new C;a.addAttribute("position",new z(g,3));a.addAttribute("color",new z(h,3));g=new Y({vertexColors:2});W.call(this,a,g)}function jd(a,b,c,d){this.object=a;this.size=void 0!==b?b:1;a=void 0!==c?c:16776960;d=void 0!==d?d:1;b=0;(c=this.object.geometry)&&
c.isGeometry?b=c.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");c=new C;b=new z(6*b,3);c.addAttribute("position",b);W.call(this,c,new Y({color:a,linewidth:d}));this.matrixAutoUpdate=!1;this.update()}function oc(a,b,c){D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=c;void 0===b&&(b=1);a=new C;a.addAttribute("position",new z([-b,b,0,b,b,0,b,-b,0,-b,
-b,0,-b,b,0],3));b=new Y({fog:!1});this.lightPlane=new sa(a,b);this.add(this.lightPlane);a=new C;a.addAttribute("position",new z([0,0,0,0,0,1],3));this.targetLine=new sa(a,b);this.add(this.targetLine);this.update()}function kd(a){function b(a,b,d){c(a,d);c(b,d)}function c(a,b){f.push(0,0,0);g.push(b.r,b.g,b.b);void 0===h[a]&&(h[a]=[]);h[a].push(f.length/3-1)}var d=new C,e=new Y({color:16777215,vertexColors:1}),f=[],g=[],h={},k=new H(16755200),m=new H(16711680),q=new H(43775),n=new H(16777215),l=new H(3355443);
b("n1","n2",k);b("n2","n4",k);b("n4","n3",k);b("n3","n1",k);b("f1","f2",k);b("f2","f4",k);b("f4","f3",k);b("f3","f1",k);b("n1","f1",k);b("n2","f2",k);b("n3","f3",k);b("n4","f4",k);b("p","n1",m);b("p","n2",m);b("p","n3",m);b("p","n4",m);b("u1","u2",q);b("u2","u3",q);b("u3","u1",q);b("c","t",n);b("p","c",l);b("cn1","cn2",l);b("cn3","cn4",l);b("cf1","cf2",l);b("cf3","cf4",l);d.addAttribute("position",new z(f,3));d.addAttribute("color",new z(g,3));W.call(this,d,e);this.camera=a;this.camera.updateProjectionMatrix&&
this.camera.updateProjectionMatrix();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.pointMap=h;this.update()}function Eb(a,b){this.object=a;void 0===b&&(b=16776960);a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var c=new Float32Array(24),d=new C;d.setIndex(new Q(a,1));d.addAttribute("position",new Q(c,3));W.call(this,d,new Y({color:b}));this.matrixAutoUpdate=!1;this.update()}function ld(a,b){this.type="Box3Helper";this.box=a;a=void 0!==b?b:16776960;b=new Uint16Array([0,
1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var c=new C;c.setIndex(new Q(b,1));c.addAttribute("position",new z([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3));W.call(this,c,new Y({color:a}));this.geometry.computeBoundingSphere()}function md(a,b,c){this.type="PlaneHelper";this.plane=a;this.size=void 0===b?1:b;a=void 0!==c?c:16776960;b=new C;b.addAttribute("position",new z([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3));b.computeBoundingSphere();sa.call(this,
b,new Y({color:a}));b=new C;b.addAttribute("position",new z([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3));b.computeBoundingSphere();this.add(new ka(b,new da({color:a,opacity:.2,transparent:!0,depthWrite:!1})))}function Fb(a,b,c,d,e,f){D.call(this);void 0===d&&(d=16776960);void 0===c&&(c=1);void 0===e&&(e=.2*c);void 0===f&&(f=.2*e);void 0===Pd&&(Pd=new C,Pd.addAttribute("position",new z([0,0,0,0,1,0],3)),ze=new Xa(0,.5,1,5,1),ze.translate(0,-.5,0));this.position.copy(b);this.line=new sa(Pd,new Y({color:d}));
this.line.matrixAutoUpdate=!1;this.add(this.line);this.cone=new ka(ze,new da({color:d}));this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(a);this.setLength(c,e,f)}function nd(a){a=a||1;var b=[0,0,0,a,0,0,0,0,0,0,a,0,0,0,0,0,0,a];a=new C;a.addAttribute("position",new z(b,3));a.addAttribute("color",new z([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));b=new Y({vertexColors:2});W.call(this,a,b)}function Af(a){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.");
ca.call(this,a);this.type="catmullrom";this.closed=!0}function Bf(a){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.");ca.call(this,a);this.type="catmullrom"}function Ae(a){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead.");ca.call(this,a);this.type="catmullrom"}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52));void 0===Number.isInteger&&(Number.isInteger=function(a){return"number"===typeof a&&isFinite(a)&&Math.floor(a)===
a});void 0===Math.sign&&(Math.sign=function(a){return 0>a?-1:0<a?1:+a});!1==="name"in Function.prototype&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}});void 0===Object.assign&&function(){Object.assign=function(a){if(void 0===a||null===a)throw new TypeError("Cannot convert undefined or null to object");for(var b=Object(a),c=1;c<arguments.length;c++){var d=arguments[c];if(void 0!==d&&null!==d)for(var e in d)Object.prototype.hasOwnProperty.call(d,
e)&&(b[e]=d[e])}return b}}();Object.assign(ya.prototype,{addEventListener:function(a,b){void 0===this._listeners&&(this._listeners={});var c=this._listeners;void 0===c[a]&&(c[a]=[]);-1===c[a].indexOf(b)&&c[a].push(b)},hasEventListener:function(a,b){if(void 0===this._listeners)return!1;var c=this._listeners;return void 0!==c[a]&&-1!==c[a].indexOf(b)},removeEventListener:function(a,b){void 0!==this._listeners&&(a=this._listeners[a],void 0!==a&&(b=a.indexOf(b),-1!==b&&a.splice(b,1)))},dispatchEvent:function(a){if(void 0!==
this._listeners){var b=this._listeners[a.type];if(void 0!==b){a.target=this;b=b.slice(0);for(var c=0,d=b.length;c<d;c++)b[c].call(this,a)}}}});var G={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var a=[],b=0;256>b;b++)a[b]=(16>b?"0":"")+b.toString(16);return function(){var b=4294967295*Math.random()|0,d=4294967295*Math.random()|0,e=4294967295*Math.random()|0,f=4294967295*Math.random()|0;return(a[b&255]+a[b>>8&255]+a[b>>16&255]+a[b>>24&255]+"-"+a[d&255]+a[d>>8&255]+"-"+a[d>>
16&15|64]+a[d>>24&255]+"-"+a[e&63|128]+a[e>>8&255]+"-"+a[e>>16&255]+a[e>>24&255]+a[f&255]+a[f>>8&255]+a[f>>16&255]+a[f>>24&255]).toUpperCase()}}(),clamp:function(a,b,c){return Math.max(b,Math.min(c,a))},euclideanModulo:function(a,b){return(a%b+b)%b},mapLinear:function(a,b,c,d,e){return d+(a-b)*(e-d)/(c-b)},lerp:function(a,b,c){return(1-c)*a+c*b},smoothstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*(3-2*a)},smootherstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;
a=(a-b)/(c-b);return a*a*a*(a*(6*a-15)+10)},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(.5-Math.random())},degToRad:function(a){return a*G.DEG2RAD},radToDeg:function(a){return a*G.RAD2DEG},isPowerOfTwo:function(a){return 0===(a&a-1)&&0!==a},ceilPowerOfTwo:function(a){return Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},floorPowerOfTwo:function(a){return Math.pow(2,Math.floor(Math.log(a)/
Math.LN2))}};Object.defineProperties(A.prototype,{width:{get:function(){return this.x},set:function(a){this.x=a}},height:{get:function(){return this.y},set:function(a){this.y=a}}});Object.assign(A.prototype,{isVector2:!0,set:function(a,b){this.x=a;this.y=b;return this},setScalar:function(a){this.y=this.x=a;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw Error("index is out of range: "+
a);}return this},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(a){this.x=a.x;this.y=a.y;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;return this},addScalar:function(a){this.x+=a;this.y+=a;return this},
addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;return this},subScalar:function(a){this.x-=a;this.y-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},multiply:function(a){this.x*=a.x;this.y*=
a.y;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;return this},divide:function(a){this.x/=a.x;this.y/=a.y;return this},divideScalar:function(a){return this.multiplyScalar(1/a)},applyMatrix3:function(a){var b=this.x,c=this.y;a=a.elements;this.x=a[0]*b+a[3]*c+a[6];this.y=a[1]*b+a[4]*c+a[7];return this},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);return this},clamp:function(a,
b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));return this},clampScalar:function(){var a=new A,b=new A;return function(c,d){a.set(c,c);b.set(d,d);return this.clamp(a,b)}}(),clampLength:function(a,b){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},round:function(){this.x=
Math.round(this.x);this.y=Math.round(this.y);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);return this},negate:function(){this.x=-this.x;this.y=-this.y;return this},dot:function(a){return this.x*a.x+this.y*a.y},cross:function(a){return this.x*a.y-this.y*a.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+
Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var a=Math.atan2(this.y,this.x);0>a&&(a+=2*Math.PI);return a},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a},manhattanDistanceTo:function(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=
(a.y-this.y)*b;return this},lerpVectors:function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},equals:function(a){return a.x===this.x&&a.y===this.y},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;return a},fromBufferAttribute:function(a,b,c){void 0!==c&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute().");this.x=a.getX(b);this.y=a.getY(b);
return this},rotateAround:function(a,b){var c=Math.cos(b);b=Math.sin(b);var d=this.x-a.x,e=this.y-a.y;this.x=d*c-e*b+a.x;this.y=d*b+e*c+a.y;return this}});Object.assign(J.prototype,{isMatrix4:!0,set:function(a,b,c,d,e,f,g,h,k,m,q,n,l,w,t,p){var r=this.elements;r[0]=a;r[4]=b;r[8]=c;r[12]=d;r[1]=e;r[5]=f;r[9]=g;r[13]=h;r[2]=k;r[6]=m;r[10]=q;r[14]=n;r[3]=l;r[7]=w;r[11]=t;r[15]=p;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},clone:function(){return(new J).fromArray(this.elements)},
copy:function(a){var b=this.elements;a=a.elements;b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return this},copyPosition:function(a){var b=this.elements;a=a.elements;b[12]=a[12];b[13]=a[13];b[14]=a[14];return this},extractBasis:function(a,b,c){a.setFromMatrixColumn(this,0);b.setFromMatrixColumn(this,1);c.setFromMatrixColumn(this,2);return this},makeBasis:function(a,b,c){this.set(a.x,
b.x,c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1);return this},extractRotation:function(){var a=new p;return function(b){var c=this.elements,d=b.elements,e=1/a.setFromMatrixColumn(b,0).length(),f=1/a.setFromMatrixColumn(b,1).length();b=1/a.setFromMatrixColumn(b,2).length();c[0]=d[0]*e;c[1]=d[1]*e;c[2]=d[2]*e;c[3]=0;c[4]=d[4]*f;c[5]=d[5]*f;c[6]=d[6]*f;c[7]=0;c[8]=d[8]*b;c[9]=d[9]*b;c[10]=d[10]*b;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return this}}(),makeRotationFromEuler:function(a){a&&a.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");
var b=this.elements,c=a.x,d=a.y,e=a.z,f=Math.cos(c);c=Math.sin(c);var g=Math.cos(d);d=Math.sin(d);var h=Math.cos(e);e=Math.sin(e);if("XYZ"===a.order){a=f*h;var k=f*e,m=c*h,q=c*e;b[0]=g*h;b[4]=-g*e;b[8]=d;b[1]=k+m*d;b[5]=a-q*d;b[9]=-c*g;b[2]=q-a*d;b[6]=m+k*d;b[10]=f*g}else"YXZ"===a.order?(a=g*h,k=g*e,m=d*h,q=d*e,b[0]=a+q*c,b[4]=m*c-k,b[8]=f*d,b[1]=f*e,b[5]=f*h,b[9]=-c,b[2]=k*c-m,b[6]=q+a*c,b[10]=f*g):"ZXY"===a.order?(a=g*h,k=g*e,m=d*h,q=d*e,b[0]=a-q*c,b[4]=-f*e,b[8]=m+k*c,b[1]=k+m*c,b[5]=f*h,b[9]=
q-a*c,b[2]=-f*d,b[6]=c,b[10]=f*g):"ZYX"===a.order?(a=f*h,k=f*e,m=c*h,q=c*e,b[0]=g*h,b[4]=m*d-k,b[8]=a*d+q,b[1]=g*e,b[5]=q*d+a,b[9]=k*d-m,b[2]=-d,b[6]=c*g,b[10]=f*g):"YZX"===a.order?(a=f*g,k=f*d,m=c*g,q=c*d,b[0]=g*h,b[4]=q-a*e,b[8]=m*e+k,b[1]=e,b[5]=f*h,b[9]=-c*h,b[2]=-d*h,b[6]=k*e+m,b[10]=a-q*e):"XZY"===a.order&&(a=f*g,k=f*d,m=c*g,q=c*d,b[0]=g*h,b[4]=-e,b[8]=d*h,b[1]=a*e+q,b[5]=f*h,b[9]=k*e-m,b[2]=m*e-k,b[6]=c*h,b[10]=q*e+a);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},makeRotationFromQuaternion:function(){var a=
new p(0,0,0),b=new p(1,1,1);return function(c){return this.compose(a,c,b)}}(),lookAt:function(){var a=new p,b=new p,c=new p;return function(d,e,f){var g=this.elements;c.subVectors(d,e);0===c.lengthSq()&&(c.z=1);c.normalize();a.crossVectors(f,c);0===a.lengthSq()&&(1===Math.abs(f.z)?c.x+=1E-4:c.z+=1E-4,c.normalize(),a.crossVectors(f,c));a.normalize();b.crossVectors(c,a);g[0]=a.x;g[4]=b.x;g[8]=c.x;g[1]=a.y;g[5]=b.y;g[9]=c.y;g[2]=a.z;g[6]=b.z;g[10]=c.z;return this}}(),multiply:function(a,b){return void 0!==
b?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(a,b)):this.multiplyMatrices(this,a)},premultiply:function(a){return this.multiplyMatrices(a,this)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements;b=this.elements;a=c[0];var e=c[4],f=c[8],g=c[12],h=c[1],k=c[5],m=c[9],q=c[13],n=c[2],l=c[6],w=c[10],t=c[14],p=c[3],x=c[7],y=c[11];c=c[15];var v=d[0],B=d[4],I=d[8],P=d[12],K=d[1],E=d[5],A=d[9],z=d[13],D=d[2],
C=d[6],G=d[10],H=d[14],L=d[3],M=d[7],J=d[11];d=d[15];b[0]=a*v+e*K+f*D+g*L;b[4]=a*B+e*E+f*C+g*M;b[8]=a*I+e*A+f*G+g*J;b[12]=a*P+e*z+f*H+g*d;b[1]=h*v+k*K+m*D+q*L;b[5]=h*B+k*E+m*C+q*M;b[9]=h*I+k*A+m*G+q*J;b[13]=h*P+k*z+m*H+q*d;b[2]=n*v+l*K+w*D+t*L;b[6]=n*B+l*E+w*C+t*M;b[10]=n*I+l*A+w*G+t*J;b[14]=n*P+l*z+w*H+t*d;b[3]=p*v+x*K+y*D+c*L;b[7]=p*B+x*E+y*C+c*M;b[11]=p*I+x*A+y*G+c*J;b[15]=p*P+x*z+y*H+c*d;return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=
a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},applyToBufferAttribute:function(){var a=new p;return function(b){for(var c=0,d=b.count;c<d;c++)a.x=b.getX(c),a.y=b.getY(c),a.z=b.getZ(c),a.applyMatrix4(this),b.setXYZ(c,a.x,a.y,a.z);return b}}(),determinant:function(){var a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],k=a[13],m=a[2],q=a[6],n=a[10],l=a[14];return a[3]*(+e*h*q-d*k*q-e*g*n+c*k*n+d*g*l-c*h*l)+a[7]*(+b*h*l-b*k*n+e*f*n-
d*f*l+d*k*m-e*h*m)+a[11]*(+b*k*q-b*g*l-e*f*q+c*f*l+e*g*m-c*k*m)+a[15]*(-d*g*m-b*h*q+b*g*n+d*f*q-c*f*n+c*h*m)},transpose:function(){var a=this.elements;var b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},setPosition:function(a){var b=this.elements;b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(a,b){var c=this.elements,d=a.elements;a=d[0];var e=d[1],f=d[2],g=d[3],h=d[4],
k=d[5],m=d[6],q=d[7],l=d[8],r=d[9],p=d[10],t=d[11],u=d[12],x=d[13],y=d[14];d=d[15];var v=r*y*q-x*p*q+x*m*t-k*y*t-r*m*d+k*p*d,B=u*p*q-l*y*q-u*m*t+h*y*t+l*m*d-h*p*d,I=l*x*q-u*r*q+u*k*t-h*x*t-l*k*d+h*r*d,P=u*r*m-l*x*m-u*k*p+h*x*p+l*k*y-h*r*y,K=a*v+e*B+f*I+g*P;if(0===K){if(!0===b)throw Error("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0");console.warn("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0");return this.identity()}b=1/K;c[0]=v*b;c[1]=(x*p*g-r*y*g-x*f*
t+e*y*t+r*f*d-e*p*d)*b;c[2]=(k*y*g-x*m*g+x*f*q-e*y*q-k*f*d+e*m*d)*b;c[3]=(r*m*g-k*p*g-r*f*q+e*p*q+k*f*t-e*m*t)*b;c[4]=B*b;c[5]=(l*y*g-u*p*g+u*f*t-a*y*t-l*f*d+a*p*d)*b;c[6]=(u*m*g-h*y*g-u*f*q+a*y*q+h*f*d-a*m*d)*b;c[7]=(h*p*g-l*m*g+l*f*q-a*p*q-h*f*t+a*m*t)*b;c[8]=I*b;c[9]=(u*r*g-l*x*g-u*e*t+a*x*t+l*e*d-a*r*d)*b;c[10]=(h*x*g-u*k*g+u*e*q-a*x*q-h*e*d+a*k*d)*b;c[11]=(l*k*g-h*r*g-l*e*q+a*r*q+h*e*t-a*k*t)*b;c[12]=P*b;c[13]=(l*x*f-u*r*f+u*e*p-a*x*p-l*e*y+a*r*y)*b;c[14]=(u*k*f-h*x*f-u*e*m+a*x*m+h*e*y-a*k*y)*
b;c[15]=(h*r*f-l*k*f+l*e*m-a*r*m-h*e*p+a*k*p)*b;return this},scale:function(a){var b=this.elements,c=a.x,d=a.y;a=a.z;b[0]*=c;b[4]*=d;b[8]*=a;b[1]*=c;b[5]*=d;b[9]*=a;b[2]*=c;b[6]*=d;b[10]*=a;b[3]*=c;b[7]*=d;b[11]*=a;return this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10]))},makeTranslation:function(a,b,c){this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1);return this},makeRotationX:function(a){var b=
Math.cos(a);a=Math.sin(a);this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this},makeRotationY:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this},makeRotationZ:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var c=Math.cos(b);b=Math.sin(b);var d=1-c,e=a.x,f=a.y;a=a.z;var g=d*e,h=d*f;this.set(g*e+c,g*f-b*a,g*a+b*f,0,g*f+b*a,h*f+c,h*a-b*e,0,g*a-b*f,h*a+b*e,d*a*a+c,0,0,
0,0,1);return this},makeScale:function(a,b,c){this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1);return this},makeShear:function(a,b,c){this.set(1,b,c,0,a,1,c,0,a,b,1,0,0,0,0,1);return this},compose:function(a,b,c){var d=this.elements,e=b._x,f=b._y,g=b._z,h=b._w,k=e+e,m=f+f,q=g+g;b=e*k;var l=e*m;e*=q;var r=f*m;f*=q;g*=q;k*=h;m*=h;h*=q;q=c.x;var p=c.y;c=c.z;d[0]=(1-(r+g))*q;d[1]=(l+h)*q;d[2]=(e-m)*q;d[3]=0;d[4]=(l-h)*p;d[5]=(1-(b+g))*p;d[6]=(f+k)*p;d[7]=0;d[8]=(e+m)*c;d[9]=(f-k)*c;d[10]=(1-(b+r))*c;d[11]=0;
d[12]=a.x;d[13]=a.y;d[14]=a.z;d[15]=1;return this},decompose:function(){var a=new p,b=new J;return function(c,d,e){var f=this.elements,g=a.set(f[0],f[1],f[2]).length(),h=a.set(f[4],f[5],f[6]).length(),k=a.set(f[8],f[9],f[10]).length();0>this.determinant()&&(g=-g);c.x=f[12];c.y=f[13];c.z=f[14];b.copy(this);c=1/g;f=1/h;var m=1/k;b.elements[0]*=c;b.elements[1]*=c;b.elements[2]*=c;b.elements[4]*=f;b.elements[5]*=f;b.elements[6]*=f;b.elements[8]*=m;b.elements[9]*=m;b.elements[10]*=m;d.setFromRotationMatrix(b);
e.x=g;e.y=h;e.z=k;return this}}(),makePerspective:function(a,b,c,d,e,f){void 0===f&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var g=this.elements;g[0]=2*e/(b-a);g[4]=0;g[8]=(b+a)/(b-a);g[12]=0;g[1]=0;g[5]=2*e/(c-d);g[9]=(c+d)/(c-d);g[13]=0;g[2]=0;g[6]=0;g[10]=-(f+e)/(f-e);g[14]=-2*f*e/(f-e);g[3]=0;g[7]=0;g[11]=-1;g[15]=0;return this},makeOrthographic:function(a,b,c,d,e,f){var g=this.elements,h=1/(b-a),k=1/(c-d),m=1/(f-e);g[0]=
2*h;g[4]=0;g[8]=0;g[12]=-((b+a)*h);g[1]=0;g[5]=2*k;g[9]=0;g[13]=-((c+d)*k);g[2]=0;g[6]=0;g[10]=-2*m;g[14]=-((f+e)*m);g[3]=0;g[7]=0;g[11]=0;g[15]=1;return this},equals:function(a){var b=this.elements;a=a.elements;for(var c=0;16>c;c++)if(b[c]!==a[c])return!1;return!0},fromArray:function(a,b){void 0===b&&(b=0);for(var c=0;16>c;c++)this.elements[c]=a[c+b];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];
a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a}});Object.assign(fa,{slerp:function(a,b,c,d){return c.copy(a).slerp(b,d)},slerpFlat:function(a,b,c,d,e,f,g){var h=c[d+0],k=c[d+1],m=c[d+2];c=c[d+3];d=e[f+0];var q=e[f+1],l=e[f+2];e=e[f+3];if(c!==e||h!==d||k!==q||m!==l){f=1-g;var r=h*d+k*q+m*l+c*e,p=0<=r?1:-1,t=1-r*r;t>Number.EPSILON&&(t=Math.sqrt(t),r=Math.atan2(t,r*p),f=Math.sin(f*r)/t,g=Math.sin(g*
r)/t);p*=g;h=h*f+d*p;k=k*f+q*p;m=m*f+l*p;c=c*f+e*p;f===1-g&&(g=1/Math.sqrt(h*h+k*k+m*m+c*c),h*=g,k*=g,m*=g,c*=g)}a[b]=h;a[b+1]=k;a[b+2]=m;a[b+3]=c}});Object.defineProperties(fa.prototype,{x:{get:function(){return this._x},set:function(a){this._x=a;this.onChangeCallback()}},y:{get:function(){return this._y},set:function(a){this._y=a;this.onChangeCallback()}},z:{get:function(){return this._z},set:function(a){this._z=a;this.onChangeCallback()}},w:{get:function(){return this._w},set:function(a){this._w=
a;this.onChangeCallback()}}});Object.assign(fa.prototype,{set:function(a,b,c,d){this._x=a;this._y=b;this._z=c;this._w=d;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(a){this._x=a.x;this._y=a.y;this._z=a.z;this._w=a.w;this.onChangeCallback();return this},setFromEuler:function(a,b){if(!a||!a.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var c=
a._x,d=a._y,e=a._z;a=a.order;var f=Math.cos,g=Math.sin,h=f(c/2),k=f(d/2);f=f(e/2);c=g(c/2);d=g(d/2);e=g(e/2);"XYZ"===a?(this._x=c*k*f+h*d*e,this._y=h*d*f-c*k*e,this._z=h*k*e+c*d*f,this._w=h*k*f-c*d*e):"YXZ"===a?(this._x=c*k*f+h*d*e,this._y=h*d*f-c*k*e,this._z=h*k*e-c*d*f,this._w=h*k*f+c*d*e):"ZXY"===a?(this._x=c*k*f-h*d*e,this._y=h*d*f+c*k*e,this._z=h*k*e+c*d*f,this._w=h*k*f-c*d*e):"ZYX"===a?(this._x=c*k*f-h*d*e,this._y=h*d*f+c*k*e,this._z=h*k*e-c*d*f,this._w=h*k*f+c*d*e):"YZX"===a?(this._x=c*k*f+
h*d*e,this._y=h*d*f+c*k*e,this._z=h*k*e-c*d*f,this._w=h*k*f-c*d*e):"XZY"===a&&(this._x=c*k*f-h*d*e,this._y=h*d*f-c*k*e,this._z=h*k*e+c*d*f,this._w=h*k*f+c*d*e);if(!1!==b)this.onChangeCallback();return this},setFromAxisAngle:function(a,b){b/=2;var c=Math.sin(b);this._x=a.x*c;this._y=a.y*c;this._z=a.z*c;this._w=Math.cos(b);this.onChangeCallback();return this},setFromRotationMatrix:function(a){var b=a.elements,c=b[0];a=b[4];var d=b[8],e=b[1],f=b[5],g=b[9],h=b[2],k=b[6];b=b[10];var m=c+f+b;0<m?(c=.5/
Math.sqrt(m+1),this._w=.25/c,this._x=(k-g)*c,this._y=(d-h)*c,this._z=(e-a)*c):c>f&&c>b?(c=2*Math.sqrt(1+c-f-b),this._w=(k-g)/c,this._x=.25*c,this._y=(a+e)/c,this._z=(d+h)/c):f>b?(c=2*Math.sqrt(1+f-c-b),this._w=(d-h)/c,this._x=(a+e)/c,this._y=.25*c,this._z=(g+k)/c):(c=2*Math.sqrt(1+b-c-f),this._w=(e-a)/c,this._x=(d+h)/c,this._y=(g+k)/c,this._z=.25*c);this.onChangeCallback();return this},setFromUnitVectors:function(){var a=new p,b;return function(c,d){void 0===a&&(a=new p);b=c.dot(d)+1;1E-6>b?(b=0,
Math.abs(c.x)>Math.abs(c.z)?a.set(-c.y,c.x,0):a.set(0,-c.z,c.y)):a.crossVectors(c,d);this._x=a.x;this._y=a.y;this._z=a.z;this._w=b;return this.normalize()}}(),angleTo:function(a){return 2*Math.acos(Math.abs(G.clamp(this.dot(a),-1,1)))},rotateTowards:function(a,b){var c=this.angleTo(a);if(0===c)return this;this.slerp(a,Math.min(1,b/c));return this},inverse:function(){return this.conjugate()},conjugate:function(){this._x*=-1;this._y*=-1;this._z*=-1;this.onChangeCallback();return this},dot:function(a){return this._x*
a._x+this._y*a._y+this._z*a._z+this._w*a._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var a=this.length();0===a?(this._z=this._y=this._x=0,this._w=1):(a=1/a,this._x*=a,this._y*=a,this._z*=a,this._w*=a);this.onChangeCallback();return this},multiply:function(a,b){return void 0!==b?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),
this.multiplyQuaternions(a,b)):this.multiplyQuaternions(this,a)},premultiply:function(a){return this.multiplyQuaternions(a,this)},multiplyQuaternions:function(a,b){var c=a._x,d=a._y,e=a._z;a=a._w;var f=b._x,g=b._y,h=b._z;b=b._w;this._x=c*b+a*f+d*h-e*g;this._y=d*b+a*g+e*f-c*h;this._z=e*b+a*h+c*g-d*f;this._w=a*b-c*f-d*g-e*h;this.onChangeCallback();return this},slerp:function(a,b){if(0===b)return this;if(1===b)return this.copy(a);var c=this._x,d=this._y,e=this._z,f=this._w,g=f*a._w+c*a._x+d*a._y+e*a._z;
0>g?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,g=-g):this.copy(a);if(1<=g)return this._w=f,this._x=c,this._y=d,this._z=e,this;a=1-g*g;if(a<=Number.EPSILON)return g=1-b,this._w=g*f+b*this._w,this._x=g*c+b*this._x,this._y=g*d+b*this._y,this._z=g*e+b*this._z,this.normalize();a=Math.sqrt(a);var h=Math.atan2(a,g);g=Math.sin((1-b)*h)/a;b=Math.sin(b*h)/a;this._w=f*g+this._w*b;this._x=c*g+this._x*b;this._y=d*g+this._y*b;this._z=e*g+this._z*b;this.onChangeCallback();return this},equals:function(a){return a._x===
this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w},fromArray:function(a,b){void 0===b&&(b=0);this._x=a[b];this._y=a[b+1];this._z=a[b+2];this._w=a[b+3];this.onChangeCallback();return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._w;return a},onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){}});Object.assign(p.prototype,{isVector3:!0,set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},
setScalar:function(a){this.z=this.y=this.x=a;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a);}return this},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,
this.y,this.z)},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;this.z+=
a.z*b;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},subScalar:function(a){this.x-=a;this.y-=a;this.z-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},multiply:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),
this.multiplyVectors(a,b);this.x*=a.x;this.y*=a.y;this.z*=a.z;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;return this},multiplyVectors:function(a,b){this.x=a.x*b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},applyEuler:function(){var a=new fa;return function(b){b&&b.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.");return this.applyQuaternion(a.setFromEuler(b))}}(),applyAxisAngle:function(){var a=new fa;return function(b,
c){return this.applyQuaternion(a.setFromAxisAngle(b,c))}}(),applyMatrix3:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[3]*c+a[6]*d;this.y=a[1]*b+a[4]*c+a[7]*d;this.z=a[2]*b+a[5]*c+a[8]*d;return this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;var e=1/(a[3]*b+a[7]*c+a[11]*d+a[15]);this.x=(a[0]*b+a[4]*c+a[8]*d+a[12])*e;this.y=(a[1]*b+a[5]*c+a[9]*d+a[13])*e;this.z=(a[2]*b+a[6]*c+a[10]*d+a[14])*e;return this},applyQuaternion:function(a){var b=this.x,
c=this.y,d=this.z,e=a.x,f=a.y,g=a.z;a=a.w;var h=a*b+f*d-g*c,k=a*c+g*b-e*d,m=a*d+e*c-f*b;b=-e*b-f*c-g*d;this.x=h*a+b*-e+k*-g-m*-f;this.y=k*a+b*-f+m*-e-h*-g;this.z=m*a+b*-g+h*-f-k*-e;return this},project:function(){var a=new J;return function(b){a.multiplyMatrices(b.projectionMatrix,a.getInverse(b.matrixWorld));return this.applyMatrix4(a)}}(),unproject:function(){var a=new J;return function(b){a.multiplyMatrices(b.matrixWorld,a.getInverse(b.projectionMatrix));return this.applyMatrix4(a)}}(),transformDirection:function(a){var b=
this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d;this.y=a[1]*b+a[5]*c+a[9]*d;this.z=a[2]*b+a[6]*c+a[10]*d;return this.normalize()},divide:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this},divideScalar:function(a){return this.multiplyScalar(1/a)},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.z=Math.min(this.z,a.z);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);return this},clamp:function(a,
b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));this.z=Math.max(a.z,Math.min(b.z,this.z));return this},clampScalar:function(){var a=new p,b=new p;return function(c,d){a.set(c,c,c);b.set(d,d,d);return this.clamp(a,b)}}(),clampLength:function(a,b){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},ceil:function(){this.x=
Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this},dot:function(a){return this.x*a.x+this.y*
a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},lerpVectors:function(a,
b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},cross:function(a,b){return void 0!==b?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(a,b)):this.crossVectors(this,a)},crossVectors:function(a,b){var c=a.x,d=a.y;a=a.z;var e=b.x,f=b.y;b=b.z;this.x=d*b-a*f;this.y=a*e-c*b;this.z=c*f-d*e;return this},projectOnVector:function(a){var b=a.dot(this)/a.lengthSq();return this.copy(a).multiplyScalar(b)},projectOnPlane:function(){var a=
new p;return function(b){a.copy(this).projectOnVector(b);return this.sub(a)}}(),reflect:function(){var a=new p;return function(b){return this.sub(a.copy(b).multiplyScalar(2*this.dot(b)))}}(),angleTo:function(a){a=this.dot(a)/Math.sqrt(this.lengthSq()*a.lengthSq());return Math.acos(G.clamp(a,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a},manhattanDistanceTo:function(a){return Math.abs(this.x-
a.x)+Math.abs(this.y-a.y)+Math.abs(this.z-a.z)},setFromSpherical:function(a){var b=Math.sin(a.phi)*a.radius;this.x=b*Math.sin(a.theta);this.y=Math.cos(a.phi)*a.radius;this.z=b*Math.cos(a.theta);return this},setFromCylindrical:function(a){this.x=a.radius*Math.sin(a.theta);this.y=a.y;this.z=a.radius*Math.cos(a.theta);return this},setFromMatrixPosition:function(a){a=a.elements;this.x=a[12];this.y=a[13];this.z=a[14];return this},setFromMatrixScale:function(a){var b=this.setFromMatrixColumn(a,0).length(),
c=this.setFromMatrixColumn(a,1).length();a=this.setFromMatrixColumn(a,2).length();this.x=b;this.y=c;this.z=a;return this},setFromMatrixColumn:function(a,b){return this.fromArray(a.elements,4*b)},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;return a},fromBufferAttribute:function(a,b,c){void 0!==
c&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute().");this.x=a.getX(b);this.y=a.getY(b);this.z=a.getZ(b);return this}});Object.assign(ra.prototype,{isMatrix3:!0,set:function(a,b,c,d,e,f,g,h,k){var m=this.elements;m[0]=a;m[1]=d;m[2]=g;m[3]=b;m[4]=e;m[5]=h;m[6]=c;m[7]=f;m[8]=k;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(a){var b=this.elements;a=a.elements;
b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return this},setFromMatrix4:function(a){a=a.elements;this.set(a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]);return this},applyToBufferAttribute:function(){var a=new p;return function(b){for(var c=0,d=b.count;c<d;c++)a.x=b.getX(c),a.y=b.getY(c),a.z=b.getZ(c),a.applyMatrix3(this),b.setXYZ(c,a.x,a.y,a.z);return b}}(),multiply:function(a){return this.multiplyMatrices(this,a)},premultiply:function(a){return this.multiplyMatrices(a,
this)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements;b=this.elements;a=c[0];var e=c[3],f=c[6],g=c[1],h=c[4],k=c[7],m=c[2],q=c[5];c=c[8];var l=d[0],r=d[3],p=d[6],t=d[1],u=d[4],x=d[7],y=d[2],v=d[5];d=d[8];b[0]=a*l+e*t+f*y;b[3]=a*r+e*u+f*v;b[6]=a*p+e*x+f*d;b[1]=g*l+h*t+k*y;b[4]=g*r+h*u+k*v;b[7]=g*p+h*x+k*d;b[2]=m*l+q*t+c*y;b[5]=m*r+q*u+c*v;b[8]=m*p+q*x+c*d;return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[3]*=a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=
a;return this},determinant:function(){var a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],k=a[7];a=a[8];return b*f*a-b*g*k-c*e*a+c*g*h+d*e*k-d*f*h},getInverse:function(a,b){a&&a.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var c=a.elements;a=this.elements;var d=c[0],e=c[1],f=c[2],g=c[3],h=c[4],k=c[5],m=c[6],l=c[7];c=c[8];var n=c*h-k*l,r=k*m-c*g,p=l*g-h*m,t=d*n+e*r+f*p;if(0===t){if(!0===b)throw Error("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0");
console.warn("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0");return this.identity()}b=1/t;a[0]=n*b;a[1]=(f*l-c*e)*b;a[2]=(k*e-f*h)*b;a[3]=r*b;a[4]=(c*d-f*m)*b;a[5]=(f*g-k*d)*b;a[6]=p*b;a[7]=(e*m-l*d)*b;a[8]=(h*d-e*g)*b;return this},transpose:function(){var a=this.elements;var b=a[1];a[1]=a[3];a[3]=b;b=a[2];a[2]=a[6];a[6]=b;b=a[5];a[5]=a[7];a[7]=b;return this},getNormalMatrix:function(a){return this.setFromMatrix4(a).getInverse(this).transpose()},transposeIntoArray:function(a){var b=
this.elements;a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=b[2];a[7]=b[5];a[8]=b[8];return this},setUvTransform:function(a,b,c,d,e,f,g){var h=Math.cos(e);e=Math.sin(e);this.set(c*h,c*e,-c*(h*f+e*g)+f+a,-d*e,d*h,-d*(-e*f+h*g)+g+b,0,0,1)},scale:function(a,b){var c=this.elements;c[0]*=a;c[3]*=a;c[6]*=a;c[1]*=b;c[4]*=b;c[7]*=b;return this},rotate:function(a){var b=Math.cos(a);a=Math.sin(a);var c=this.elements,d=c[0],e=c[3],f=c[6],g=c[1],h=c[4],k=c[7];c[0]=b*d+a*g;c[3]=b*e+a*h;c[6]=
b*f+a*k;c[1]=-a*d+b*g;c[4]=-a*e+b*h;c[7]=-a*f+b*k;return this},translate:function(a,b){var c=this.elements;c[0]+=a*c[2];c[3]+=a*c[5];c[6]+=a*c[8];c[1]+=b*c[2];c[4]+=b*c[5];c[7]+=b*c[8];return this},equals:function(a){var b=this.elements;a=a.elements;for(var c=0;9>c;c++)if(b[c]!==a[c])return!1;return!0},fromArray:function(a,b){void 0===b&&(b=0);for(var c=0;9>c;c++)this.elements[c]=a[c+b];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);var c=this.elements;a[b]=c[0];a[b+1]=c[1];
a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];return a}});var fb={getDataURL:function(a){if(a instanceof HTMLCanvasElement)var b=a;else{"undefined"!==typeof OffscreenCanvas?b=new OffscreenCanvas(a.width,a.height):(b=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),b.width=a.width,b.height=a.height);var c=b.getContext("2d");a instanceof ImageData?c.putImageData(a,0,0):c.drawImage(a,0,0,a.width,a.height)}return 2048<b.width||2048<b.height?b.toDataURL("image/jpeg",
.6):b.toDataURL("image/png")}},Jf=0;T.DEFAULT_IMAGE=void 0;T.DEFAULT_MAPPING=300;T.prototype=Object.assign(Object.create(ya.prototype),{constructor:T,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.name=a.name;this.image=a.image;this.mipmaps=a.mipmaps.slice(0);this.mapping=a.mapping;this.wrapS=a.wrapS;this.wrapT=
a.wrapT;this.magFilter=a.magFilter;this.minFilter=a.minFilter;this.anisotropy=a.anisotropy;this.format=a.format;this.type=a.type;this.offset.copy(a.offset);this.repeat.copy(a.repeat);this.center.copy(a.center);this.rotation=a.rotation;this.matrixAutoUpdate=a.matrixAutoUpdate;this.matrix.copy(a.matrix);this.generateMipmaps=a.generateMipmaps;this.premultiplyAlpha=a.premultiplyAlpha;this.flipY=a.flipY;this.unpackAlignment=a.unpackAlignment;this.encoding=a.encoding;return this},toJSON:function(a){var b=
void 0===a||"string"===typeof a;if(!b&&void 0!==a.textures[this.uuid])return a.textures[this.uuid];var c={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==
this.image){var d=this.image;void 0===d.uuid&&(d.uuid=G.generateUUID());if(!b&&void 0===a.images[d.uuid]){if(Array.isArray(d)){var e=[];for(var f=0,g=d.length;f<g;f++)e.push(fb.getDataURL(d[f]))}else e=fb.getDataURL(d);a.images[d.uuid]={uuid:d.uuid,url:e}}c.image=d.uuid}b||(a.textures[this.uuid]=c);return c},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(a){if(300===this.mapping){a.applyMatrix3(this.matrix);if(0>a.x||1<a.x)switch(this.wrapS){case 1E3:a.x-=Math.floor(a.x);
break;case 1001:a.x=0>a.x?0:1;break;case 1002:a.x=1===Math.abs(Math.floor(a.x)%2)?Math.ceil(a.x)-a.x:a.x-Math.floor(a.x)}if(0>a.y||1<a.y)switch(this.wrapT){case 1E3:a.y-=Math.floor(a.y);break;case 1001:a.y=0>a.y?0:1;break;case 1002:a.y=1===Math.abs(Math.floor(a.y)%2)?Math.ceil(a.y)-a.y:a.y-Math.floor(a.y)}this.flipY&&(a.y=1-a.y)}}});Object.defineProperty(T.prototype,"needsUpdate",{set:function(a){!0===a&&this.version++}});Object.assign(V.prototype,{isVector4:!0,set:function(a,b,c,d){this.x=a;this.y=
b;this.z=c;this.w=d;return this},setScalar:function(a){this.w=this.z=this.y=this.x=a;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setW:function(a){this.w=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw Error("index is out of range: "+a);}return this},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;
case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=void 0!==a.w?a.w:1;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this},addScalar:function(a){this.x+=
a;this.y+=a;this.z+=a;this.w+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.w=a.w+b.w;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;this.z+=a.z*b;this.w+=a.w*b;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this},subScalar:function(a){this.x-=a;this.y-=
a;this.z-=a;this.w-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.w=a.w-b.w;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;this.w*=a;return this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,e=this.w;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12]*e;this.y=a[1]*b+a[5]*c+a[9]*d+a[13]*e;this.z=a[2]*b+a[6]*c+a[10]*d+a[14]*e;this.w=a[3]*b+a[7]*c+a[11]*d+a[15]*e;return this},divideScalar:function(a){return this.multiplyScalar(1/
a)},setAxisAngleFromQuaternion:function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);1E-4>b?(this.x=1,this.z=this.y=0):(this.x=a.x/b,this.y=a.y/b,this.z=a.z/b);return this},setAxisAngleFromRotationMatrix:function(a){a=a.elements;var b=a[0];var c=a[4];var d=a[8],e=a[1],f=a[5],g=a[9];var h=a[2];var k=a[6];var m=a[10];if(.01>Math.abs(c-e)&&.01>Math.abs(d-h)&&.01>Math.abs(g-k)){if(.1>Math.abs(c+e)&&.1>Math.abs(d+h)&&.1>Math.abs(g+k)&&.1>Math.abs(b+f+m-3))return this.set(1,0,0,0),this;a=Math.PI;
b=(b+1)/2;f=(f+1)/2;m=(m+1)/2;c=(c+e)/4;d=(d+h)/4;g=(g+k)/4;b>f&&b>m?.01>b?(k=0,c=h=.707106781):(k=Math.sqrt(b),h=c/k,c=d/k):f>m?.01>f?(k=.707106781,h=0,c=.707106781):(h=Math.sqrt(f),k=c/h,c=g/h):.01>m?(h=k=.707106781,c=0):(c=Math.sqrt(m),k=d/c,h=g/c);this.set(k,h,c,a);return this}a=Math.sqrt((k-g)*(k-g)+(d-h)*(d-h)+(e-c)*(e-c));.001>Math.abs(a)&&(a=1);this.x=(k-g)/a;this.y=(d-h)/a;this.z=(e-c)/a;this.w=Math.acos((b+f+m-1)/2);return this},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,
a.y);this.z=Math.min(this.z,a.z);this.w=Math.min(this.w,a.w);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);this.w=Math.max(this.w,a.w);return this},clamp:function(a,b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));this.z=Math.max(a.z,Math.min(b.z,this.z));this.w=Math.max(a.w,Math.min(b.w,this.w));return this},clampScalar:function(){var a,b;return function(c,d){void 0===a&&(a=new V,b=new V);a.set(c,
c,c,c);b.set(d,d,d,d);return this.clamp(a,b)}}(),clampLength:function(a,b){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);
this.z=Math.round(this.z);this.w=Math.round(this.w);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*
this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.w+=(a.w-this.w)*b;return this},lerpVectors:function(a,
b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];this.w=a[b+3];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;a[b+3]=this.w;return a},fromBufferAttribute:function(a,b,c){void 0!==c&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute().");
this.x=a.getX(b);this.y=a.getY(b);this.z=a.getZ(b);this.w=a.getW(b);return this}});gb.prototype=Object.assign(Object.create(ya.prototype),{constructor:gb,isWebGLRenderTarget:!0,setSize:function(a,b){if(this.width!==a||this.height!==b)this.width=a,this.height=b,this.dispose();this.viewport.set(0,0,a,b);this.scissor.set(0,0,a,b)},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.width=a.width;this.height=a.height;this.viewport.copy(a.viewport);this.texture=a.texture.clone();
this.depthBuffer=a.depthBuffer;this.stencilBuffer=a.stencilBuffer;this.depthTexture=a.depthTexture;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});Hb.prototype=Object.create(gb.prototype);Hb.prototype.constructor=Hb;Hb.prototype.isWebGLRenderTargetCube=!0;hb.prototype=Object.create(T.prototype);hb.prototype.constructor=hb;hb.prototype.isDataTexture=!0;Object.assign(Sa.prototype,{isBox3:!0,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromArray:function(a){for(var b=
Infinity,c=Infinity,d=Infinity,e=-Infinity,f=-Infinity,g=-Infinity,h=0,k=a.length;h<k;h+=3){var m=a[h],l=a[h+1],n=a[h+2];m<b&&(b=m);l<c&&(c=l);n<d&&(d=n);m>e&&(e=m);l>f&&(f=l);n>g&&(g=n)}this.min.set(b,c,d);this.max.set(e,f,g);return this},setFromBufferAttribute:function(a){for(var b=Infinity,c=Infinity,d=Infinity,e=-Infinity,f=-Infinity,g=-Infinity,h=0,k=a.count;h<k;h++){var m=a.getX(h),l=a.getY(h),n=a.getZ(h);m<b&&(b=m);l<c&&(c=l);n<d&&(d=n);m>e&&(e=m);l>f&&(f=l);n>g&&(g=n)}this.min.set(b,c,d);
this.max.set(e,f,g);return this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(){var a=new p;return function(b,c){c=a.copy(c).multiplyScalar(.5);this.min.copy(b).sub(c);this.max.copy(b).add(c);return this}}(),setFromObject:function(a){this.makeEmpty();return this.expandByObject(a)},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},
makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(a){void 0===a&&(console.warn("THREE.Box3: .getCenter() target is now required"),a=new p);return this.isEmpty()?a.set(0,0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(a){void 0===a&&(console.warn("THREE.Box3: .getSize() target is now required"),
a=new p);return this.isEmpty()?a.set(0,0,0):a.subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},expandByObject:function(){function a(a){var f=a.geometry;if(void 0!==f)if(f.isGeometry)for(f=f.vertices,c=0,d=f.length;c<d;c++)e.copy(f[c]),e.applyMatrix4(a.matrixWorld),b.expandByPoint(e);else if(f.isBufferGeometry&&
(f=f.attributes.position,void 0!==f))for(c=0,d=f.count;c<d;c++)e.fromBufferAttribute(f,c).applyMatrix4(a.matrixWorld),b.expandByPoint(e)}var b,c,d,e=new p;return function(c){b=this;c.updateMatrixWorld(!0);c.traverse(a);return this}}(),containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&
a.max.z<=this.max.z},getParameter:function(a,b){void 0===b&&(console.warn("THREE.Box3: .getParameter() target is now required"),b=new p);return b.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z?!1:!0},intersectsSphere:function(){var a=new p;return function(b){this.clampPoint(b.center,
a);return a.distanceToSquared(b.center)<=b.radius*b.radius}}(),intersectsPlane:function(a){if(0<a.normal.x){var b=a.normal.x*this.min.x;var c=a.normal.x*this.max.x}else b=a.normal.x*this.max.x,c=a.normal.x*this.min.x;0<a.normal.y?(b+=a.normal.y*this.min.y,c+=a.normal.y*this.max.y):(b+=a.normal.y*this.max.y,c+=a.normal.y*this.min.y);0<a.normal.z?(b+=a.normal.z*this.min.z,c+=a.normal.z*this.max.z):(b+=a.normal.z*this.max.z,c+=a.normal.z*this.min.z);return b<=a.constant&&c>=a.constant},intersectsTriangle:function(){function a(a){var e;
var f=0;for(e=a.length-3;f<=e;f+=3){h.fromArray(a,f);var g=m.x*Math.abs(h.x)+m.y*Math.abs(h.y)+m.z*Math.abs(h.z),k=b.dot(h),l=c.dot(h),q=d.dot(h);if(Math.max(-Math.max(k,l,q),Math.min(k,l,q))>g)return!1}return!0}var b=new p,c=new p,d=new p,e=new p,f=new p,g=new p,h=new p,k=new p,m=new p,l=new p;return function(h){if(this.isEmpty())return!1;this.getCenter(k);m.subVectors(this.max,k);b.subVectors(h.a,k);c.subVectors(h.b,k);d.subVectors(h.c,k);e.subVectors(c,b);f.subVectors(d,c);g.subVectors(b,d);h=
[0,-e.z,e.y,0,-f.z,f.y,0,-g.z,g.y,e.z,0,-e.x,f.z,0,-f.x,g.z,0,-g.x,-e.y,e.x,0,-f.y,f.x,0,-g.y,g.x,0];if(!a(h))return!1;h=[1,0,0,0,1,0,0,0,1];if(!a(h))return!1;l.crossVectors(e,f);h=[l.x,l.y,l.z];return a(h)}}(),clampPoint:function(a,b){void 0===b&&(console.warn("THREE.Box3: .clampPoint() target is now required"),b=new p);return b.copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new p;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),getBoundingSphere:function(){var a=
new p;return function(b){void 0===b&&(console.warn("THREE.Box3: .getBoundingSphere() target is now required"),b=new Da);this.getCenter(b.center);b.radius=.5*this.getSize(a).length();return b}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);this.isEmpty()&&this.makeEmpty();return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},applyMatrix4:function(a){if(this.isEmpty())return this;a=a.elements;var b=a[0]*this.min.x,c=a[1]*this.min.x,d=a[2]*this.min.x,e=
a[0]*this.max.x,f=a[1]*this.max.x,g=a[2]*this.max.x,h=a[4]*this.min.y,k=a[5]*this.min.y,m=a[6]*this.min.y,l=a[4]*this.max.y,n=a[5]*this.max.y,r=a[6]*this.max.y,p=a[8]*this.min.z,t=a[9]*this.min.z,u=a[10]*this.min.z,x=a[8]*this.max.z,y=a[9]*this.max.z,v=a[10]*this.max.z;this.min.x=Math.min(b,e)+Math.min(h,l)+Math.min(p,x)+a[12];this.min.y=Math.min(c,f)+Math.min(k,n)+Math.min(t,y)+a[13];this.min.z=Math.min(d,g)+Math.min(m,r)+Math.min(u,v)+a[14];this.max.x=Math.max(b,e)+Math.max(h,l)+Math.max(p,x)+a[12];
this.max.y=Math.max(c,f)+Math.max(k,n)+Math.max(t,y)+a[13];this.max.z=Math.max(d,g)+Math.max(m,r)+Math.max(u,v)+a[14];return this},translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)}});Object.assign(Da.prototype,{set:function(a,b){this.center.copy(a);this.radius=b;return this},setFromPoints:function(){var a=new Sa;return function(b,c){var d=this.center;void 0!==c?d.copy(c):a.setFromPoints(b).getCenter(d);for(var e=
c=0,f=b.length;e<f;e++)c=Math.max(c,d.distanceToSquared(b[e]));this.radius=Math.sqrt(c);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.center.copy(a.center);this.radius=a.radius;return this},empty:function(){return 0>=this.radius},containsPoint:function(a){return a.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(a){return a.distanceTo(this.center)-this.radius},intersectsSphere:function(a){var b=this.radius+a.radius;
return a.center.distanceToSquared(this.center)<=b*b},intersectsBox:function(a){return a.intersectsSphere(this)},intersectsPlane:function(a){return Math.abs(a.distanceToPoint(this.center))<=this.radius},clampPoint:function(a,b){var c=this.center.distanceToSquared(a);void 0===b&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),b=new p);b.copy(a);c>this.radius*this.radius&&(b.sub(this.center).normalize(),b.multiplyScalar(this.radius).add(this.center));return b},getBoundingBox:function(a){void 0===
a&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),a=new Sa);a.set(this.center,this.center);a.expandByScalar(this.radius);return a},applyMatrix4:function(a){this.center.applyMatrix4(a);this.radius*=a.getMaxScaleOnAxis();return this},translate:function(a){this.center.add(a);return this},equals:function(a){return a.center.equals(this.center)&&a.radius===this.radius}});Object.assign(Ma.prototype,{set:function(a,b){this.normal.copy(a);this.constant=b;return this},setComponents:function(a,
b,c,d){this.normal.set(a,b,c);this.constant=d;return this},setFromNormalAndCoplanarPoint:function(a,b){this.normal.copy(a);this.constant=-b.dot(this.normal);return this},setFromCoplanarPoints:function(){var a=new p,b=new p;return function(c,d,e){d=a.subVectors(e,d).cross(b.subVectors(c,d)).normalize();this.setFromNormalAndCoplanarPoint(d,c);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.normal.copy(a.normal);this.constant=a.constant;return this},normalize:function(){var a=
1/this.normal.length();this.normal.multiplyScalar(a);this.constant*=a;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,b){void 0===b&&(console.warn("THREE.Plane: .projectPoint() target is now required"),b=new p);return b.copy(this.normal).multiplyScalar(-this.distanceToPoint(a)).add(a)},intersectLine:function(){var a=
new p;return function(b,c){void 0===c&&(console.warn("THREE.Plane: .intersectLine() target is now required"),c=new p);var d=b.delta(a),e=this.normal.dot(d);if(0===e){if(0===this.distanceToPoint(b.start))return c.copy(b.start)}else if(e=-(b.start.dot(this.normal)+this.constant)/e,!(0>e||1<e))return c.copy(d).multiplyScalar(e).add(b.start)}}(),intersectsLine:function(a){var b=this.distanceToPoint(a.start);a=this.distanceToPoint(a.end);return 0>b&&0<a||0>a&&0<b},intersectsBox:function(a){return a.intersectsPlane(this)},
intersectsSphere:function(a){return a.intersectsPlane(this)},coplanarPoint:function(a){void 0===a&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),a=new p);return a.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var a=new p,b=new ra;return function(c,d){d=d||b.getNormalMatrix(c);c=this.coplanarPoint(a).applyMatrix4(c);d=this.normal.applyMatrix3(d).normalize();this.constant=-c.dot(d);return this}}(),translate:function(a){this.constant-=a.dot(this.normal);
return this},equals:function(a){return a.normal.equals(this.normal)&&a.constant===this.constant}});Object.assign(od.prototype,{set:function(a,b,c,d,e,f){var g=this.planes;g[0].copy(a);g[1].copy(b);g[2].copy(c);g[3].copy(d);g[4].copy(e);g[5].copy(f);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){for(var b=this.planes,c=0;6>c;c++)b[c].copy(a.planes[c]);return this},setFromMatrix:function(a){var b=this.planes,c=a.elements;a=c[0];var d=c[1],e=c[2],f=c[3],g=c[4],
h=c[5],k=c[6],m=c[7],l=c[8],n=c[9],r=c[10],p=c[11],t=c[12],u=c[13],x=c[14];c=c[15];b[0].setComponents(f-a,m-g,p-l,c-t).normalize();b[1].setComponents(f+a,m+g,p+l,c+t).normalize();b[2].setComponents(f+d,m+h,p+n,c+u).normalize();b[3].setComponents(f-d,m-h,p-n,c-u).normalize();b[4].setComponents(f-e,m-k,p-r,c-x).normalize();b[5].setComponents(f+e,m+k,p+r,c+x).normalize();return this},intersectsObject:function(){var a=new Da;return function(b){var c=b.geometry;null===c.boundingSphere&&c.computeBoundingSphere();
a.copy(c.boundingSphere).applyMatrix4(b.matrixWorld);return this.intersectsSphere(a)}}(),intersectsSprite:function(){var a=new Da;return function(b){a.center.set(0,0,0);a.radius=.7071067811865476;a.applyMatrix4(b.matrixWorld);return this.intersectsSphere(a)}}(),intersectsSphere:function(a){var b=this.planes,c=a.center;a=-a.radius;for(var d=0;6>d;d++)if(b[d].distanceToPoint(c)<a)return!1;return!0},intersectsBox:function(){var a=new p;return function(b){for(var c=this.planes,d=0;6>d;d++){var e=c[d];
a.x=0<e.normal.x?b.max.x:b.min.x;a.y=0<e.normal.y?b.max.y:b.min.y;a.z=0<e.normal.z?b.max.z:b.min.z;if(0>e.distanceToPoint(a))return!1}return!0}}(),containsPoint:function(a){for(var b=this.planes,c=0;6>c;c++)if(0>b[c].distanceToPoint(a))return!1;return!0}});var S={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",
aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",
begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",
bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",
clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif\n",
clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",
color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",
cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",
defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",
emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",
envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",
envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",
envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",
envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",
fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",
gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",
lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",
lights_pars_begin:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n",
lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",
lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",
lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",
lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif\n",
lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif\n",
lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",
logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",
map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",
metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",
morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",
normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n",normal_fragment_maps:"#ifdef USE_NORMALMAP\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t#ifdef FLIP_SIDED\n\t\t\tnormal = - normal;\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\tnormal = normalize( normalMatrix * normal );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",
normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tuniform mat3 normalMatrix;\n\t#else\n\t\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\t\tvec2 st0 = dFdx( vUv.st );\n\t\t\tvec2 st1 = dFdy( vUv.st );\n\t\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\t\tvec3 N = normalize( surf_norm );\n\t\t\tmat3 tsn = mat3( S, T, N );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy *= normalScale;\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\treturn normalize( tsn * mapN );\n\t\t}\n\t#endif\n#endif\n",
packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",
premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",
roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",
shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",
shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",
shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",
skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",
skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",
specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",
uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",
uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",
uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",
cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",
depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",
distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",
distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",
equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",
linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",
linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",
meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",
meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",
meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",
meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",
meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",
meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",
meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",
meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",
normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",
normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",
points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",
points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}\n",
shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",
sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",
sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tvec4 mvPosition;\n\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n"},
Aa={merge:function(a){for(var b={},c=0;c<a.length;c++){var d=this.clone(a[c]),e;for(e in d)b[e]=d[e]}return b},clone:function(a){var b={},c;for(c in a){b[c]={};for(var d in a[c]){var e=a[c][d];e&&(e.isColor||e.isMatrix3||e.isMatrix4||e.isVector2||e.isVector3||e.isVector4||e.isTexture)?b[c][d]=e.clone():Array.isArray(e)?b[c][d]=e.slice():b[c][d]=e}}return b}},$g={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,
blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,
darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,
lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,
mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,
rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Object.assign(H.prototype,
{isColor:!0,r:1,g:1,b:1,set:function(a){a&&a.isColor?this.copy(a):"number"===typeof a?this.setHex(a):"string"===typeof a&&this.setStyle(a);return this},setScalar:function(a){this.b=this.g=this.r=a;return this},setHex:function(a){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;return this},setRGB:function(a,b,c){this.r=a;this.g=b;this.b=c;return this},setHSL:function(){function a(a,c,d){0>d&&(d+=1);1<d&&--d;return d<1/6?a+6*(c-a)*d:.5>d?c:d<2/3?a+6*(c-a)*(2/3-d):a}return function(b,
c,d){b=G.euclideanModulo(b,1);c=G.clamp(c,0,1);d=G.clamp(d,0,1);0===c?this.r=this.g=this.b=d:(c=.5>=d?d*(1+c):d+c-d*c,d=2*d-c,this.r=a(d,c,b+1/3),this.g=a(d,c,b),this.b=a(d,c,b-1/3));return this}}(),setStyle:function(a){var b;if(b=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(a)){var c=b[2];switch(b[1]){case "rgb":case "rgba":if(b=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(c))return this.r=Math.min(255,parseInt(b[1],10))/255,this.g=Math.min(255,parseInt(b[2],10))/255,this.b=Math.min(255,
parseInt(b[3],10))/255,this;if(b=/^(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(c))return this.r=Math.min(100,parseInt(b[1],10))/100,this.g=Math.min(100,parseInt(b[2],10))/100,this.b=Math.min(100,parseInt(b[3],10))/100,this;break;case "hsl":case "hsla":if(b=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(c))return a=parseFloat(b[1])/360,c=parseInt(b[2],10)/100,b=parseInt(b[3],10)/100,this.setHSL(a,c,b)}}else if(b=/^#([A-Fa-f0-9]+)$/.exec(a)){b=
b[1];c=b.length;if(3===c)return this.r=parseInt(b.charAt(0)+b.charAt(0),16)/255,this.g=parseInt(b.charAt(1)+b.charAt(1),16)/255,this.b=parseInt(b.charAt(2)+b.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(b.charAt(0)+b.charAt(1),16)/255,this.g=parseInt(b.charAt(2)+b.charAt(3),16)/255,this.b=parseInt(b.charAt(4)+b.charAt(5),16)/255,this}a&&0<a.length&&(b=$g[a],void 0!==b?this.setHex(b):console.warn("THREE.Color: Unknown color "+a));return this},clone:function(){return new this.constructor(this.r,
this.g,this.b)},copy:function(a){this.r=a.r;this.g=a.g;this.b=a.b;return this},copyGammaToLinear:function(a,b){void 0===b&&(b=2);this.r=Math.pow(a.r,b);this.g=Math.pow(a.g,b);this.b=Math.pow(a.b,b);return this},copyLinearToGamma:function(a,b){void 0===b&&(b=2);b=0<b?1/b:1;this.r=Math.pow(a.r,b);this.g=Math.pow(a.g,b);this.b=Math.pow(a.b,b);return this},convertGammaToLinear:function(a){this.copyGammaToLinear(this,a);return this},convertLinearToGamma:function(a){this.copyLinearToGamma(this,a);return this},
copySRGBToLinear:function(){function a(a){return.04045>a?.0773993808*a:Math.pow(.9478672986*a+.0521327014,2.4)}return function(b){this.r=a(b.r);this.g=a(b.g);this.b=a(b.b);return this}}(),copyLinearToSRGB:function(){function a(a){return.0031308>a?12.92*a:1.055*Math.pow(a,.41666)-.055}return function(b){this.r=a(b.r);this.g=a(b.g);this.b=a(b.b);return this}}(),convertSRGBToLinear:function(){this.copySRGBToLinear(this);return this},convertLinearToSRGB:function(){this.copyLinearToSRGB(this);return this},
getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(a){void 0===a&&(console.warn("THREE.Color: .getHSL() target is now required"),a={h:0,s:0,l:0});var b=this.r,c=this.g,d=this.b,e=Math.max(b,c,d),f=Math.min(b,c,d),g,h=(f+e)/2;if(f===e)f=g=0;else{var k=e-f;f=.5>=h?k/(e+f):k/(2-e-f);switch(e){case b:g=(c-d)/k+(c<d?6:0);break;case c:g=(d-b)/k+2;break;case d:g=(b-c)/k+4}g/=6}a.h=g;a.s=f;a.l=
h;return a},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(){var a={};return function(b,c,d){this.getHSL(a);a.h+=b;a.s+=c;a.l+=d;this.setHSL(a.h,a.s,a.l);return this}}(),add:function(a){this.r+=a.r;this.g+=a.g;this.b+=a.b;return this},addColors:function(a,b){this.r=a.r+b.r;this.g=a.g+b.g;this.b=a.b+b.b;return this},addScalar:function(a){this.r+=a;this.g+=a;this.b+=a;return this},sub:function(a){this.r=Math.max(0,this.r-a.r);this.g=Math.max(0,
this.g-a.g);this.b=Math.max(0,this.b-a.b);return this},multiply:function(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;return this},multiplyScalar:function(a){this.r*=a;this.g*=a;this.b*=a;return this},lerp:function(a,b){this.r+=(a.r-this.r)*b;this.g+=(a.g-this.g)*b;this.b+=(a.b-this.b)*b;return this},equals:function(a){return a.r===this.r&&a.g===this.g&&a.b===this.b},fromArray:function(a,b){void 0===b&&(b=0);this.r=a[b];this.g=a[b+1];this.b=a[b+2];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===
b&&(b=0);a[b]=this.r;a[b+1]=this.g;a[b+2]=this.b;return a},toJSON:function(){return this.getHex()}});var L={common:{diffuse:{value:new H(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new ra},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},
emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new A(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:2.5E-4},fogNear:{value:1},fogFar:{value:2E3},fogColor:{value:new H(16777215)}},lights:{ambientLightColor:{value:[]},
directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},
shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new H(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new ra}},sprite:{diffuse:{value:new H(15658734)},opacity:{value:1},center:{value:new A(.5,
.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new ra}}},ob={basic:{uniforms:Aa.merge([L.common,L.specularmap,L.envmap,L.aomap,L.lightmap,L.fog]),vertexShader:S.meshbasic_vert,fragmentShader:S.meshbasic_frag},lambert:{uniforms:Aa.merge([L.common,L.specularmap,L.envmap,L.aomap,L.lightmap,L.emissivemap,L.fog,L.lights,{emissive:{value:new H(0)}}]),vertexShader:S.meshlambert_vert,fragmentShader:S.meshlambert_frag},phong:{uniforms:Aa.merge([L.common,L.specularmap,L.envmap,L.aomap,L.lightmap,
L.emissivemap,L.bumpmap,L.normalmap,L.displacementmap,L.gradientmap,L.fog,L.lights,{emissive:{value:new H(0)},specular:{value:new H(1118481)},shininess:{value:30}}]),vertexShader:S.meshphong_vert,fragmentShader:S.meshphong_frag},standard:{uniforms:Aa.merge([L.common,L.envmap,L.aomap,L.lightmap,L.emissivemap,L.bumpmap,L.normalmap,L.displacementmap,L.roughnessmap,L.metalnessmap,L.fog,L.lights,{emissive:{value:new H(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:S.meshphysical_vert,
fragmentShader:S.meshphysical_frag},points:{uniforms:Aa.merge([L.points,L.fog]),vertexShader:S.points_vert,fragmentShader:S.points_frag},dashed:{uniforms:Aa.merge([L.common,L.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:S.linedashed_vert,fragmentShader:S.linedashed_frag},depth:{uniforms:Aa.merge([L.common,L.displacementmap]),vertexShader:S.depth_vert,fragmentShader:S.depth_frag},normal:{uniforms:Aa.merge([L.common,L.bumpmap,L.normalmap,L.displacementmap,{opacity:{value:1}}]),
vertexShader:S.normal_vert,fragmentShader:S.normal_frag},sprite:{uniforms:Aa.merge([L.sprite,L.fog]),vertexShader:S.sprite_vert,fragmentShader:S.sprite_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:S.cube_vert,fragmentShader:S.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:S.equirect_vert,fragmentShader:S.equirect_frag},distanceRGBA:{uniforms:Aa.merge([L.common,L.displacementmap,{referencePosition:{value:new p},nearDistance:{value:1},
farDistance:{value:1E3}}]),vertexShader:S.distanceRGBA_vert,fragmentShader:S.distanceRGBA_frag},shadow:{uniforms:Aa.merge([L.lights,L.fog,{color:{value:new H(0)},opacity:{value:1}}]),vertexShader:S.shadow_vert,fragmentShader:S.shadow_frag}};ob.physical={uniforms:Aa.merge([ob.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:S.meshphysical_vert,fragmentShader:S.meshphysical_frag};ib.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");ib.DefaultOrder="XYZ";Object.defineProperties(ib.prototype,
{x:{get:function(){return this._x},set:function(a){this._x=a;this.onChangeCallback()}},y:{get:function(){return this._y},set:function(a){this._y=a;this.onChangeCallback()}},z:{get:function(){return this._z},set:function(a){this._z=a;this.onChangeCallback()}},order:{get:function(){return this._order},set:function(a){this._order=a;this.onChangeCallback()}}});Object.assign(ib.prototype,{isEuler:!0,set:function(a,b,c,d){this._x=a;this._y=b;this._z=c;this._order=d||this._order;this.onChangeCallback();
return this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(a){this._x=a._x;this._y=a._y;this._z=a._z;this._order=a._order;this.onChangeCallback();return this},setFromRotationMatrix:function(a,b,c){var d=G.clamp,e=a.elements;a=e[0];var f=e[4],g=e[8],h=e[1],k=e[5],m=e[9],l=e[2],n=e[6];e=e[10];b=b||this._order;"XYZ"===b?(this._y=Math.asin(d(g,-1,1)),.99999>Math.abs(g)?(this._x=Math.atan2(-m,e),this._z=Math.atan2(-f,a)):(this._x=Math.atan2(n,k),this._z=
0)):"YXZ"===b?(this._x=Math.asin(-d(m,-1,1)),.99999>Math.abs(m)?(this._y=Math.atan2(g,e),this._z=Math.atan2(h,k)):(this._y=Math.atan2(-l,a),this._z=0)):"ZXY"===b?(this._x=Math.asin(d(n,-1,1)),.99999>Math.abs(n)?(this._y=Math.atan2(-l,e),this._z=Math.atan2(-f,k)):(this._y=0,this._z=Math.atan2(h,a))):"ZYX"===b?(this._y=Math.asin(-d(l,-1,1)),.99999>Math.abs(l)?(this._x=Math.atan2(n,e),this._z=Math.atan2(h,a)):(this._x=0,this._z=Math.atan2(-f,k))):"YZX"===b?(this._z=Math.asin(d(h,-1,1)),.99999>Math.abs(h)?
(this._x=Math.atan2(-m,k),this._y=Math.atan2(-l,a)):(this._x=0,this._y=Math.atan2(g,e))):"XZY"===b?(this._z=Math.asin(-d(f,-1,1)),.99999>Math.abs(f)?(this._x=Math.atan2(n,k),this._y=Math.atan2(g,a)):(this._x=Math.atan2(-m,e),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+b);this._order=b;if(!1!==c)this.onChangeCallback();return this},setFromQuaternion:function(){var a=new J;return function(b,c,d){a.makeRotationFromQuaternion(b);return this.setFromRotationMatrix(a,
c,d)}}(),setFromVector3:function(a,b){return this.set(a.x,a.y,a.z,b||this._order)},reorder:function(){var a=new fa;return function(b){a.setFromEuler(this);return this.setFromQuaternion(a,b)}}(),equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order},fromArray:function(a){this._x=a[0];this._y=a[1];this._z=a[2];void 0!==a[3]&&(this._order=a[3]);this.onChangeCallback();return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=
this._y;a[b+2]=this._z;a[b+3]=this._order;return a},toVector3:function(a){return a?a.set(this._x,this._y,this._z):new p(this._x,this._y,this._z)},onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){}});Object.assign(Td.prototype,{set:function(a){this.mask=1<<a|0},enable:function(a){this.mask=this.mask|1<<a|0},toggle:function(a){this.mask^=1<<a|0},disable:function(a){this.mask&=~(1<<a|0)},test:function(a){return 0!==(this.mask&a.mask)}});var Lf=0;D.DefaultUp=new p(0,
1,0);D.DefaultMatrixAutoUpdate=!0;D.prototype=Object.assign(Object.create(ya.prototype),{constructor:D,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(a){this.matrix.multiplyMatrices(a,this.matrix);this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(a){this.quaternion.premultiply(a);return this},setRotationFromAxisAngle:function(a,b){this.quaternion.setFromAxisAngle(a,b)},setRotationFromEuler:function(a){this.quaternion.setFromEuler(a,
!0)},setRotationFromMatrix:function(a){this.quaternion.setFromRotationMatrix(a)},setRotationFromQuaternion:function(a){this.quaternion.copy(a)},rotateOnAxis:function(){var a=new fa;return function(b,c){a.setFromAxisAngle(b,c);this.quaternion.multiply(a);return this}}(),rotateOnWorldAxis:function(){var a=new fa;return function(b,c){a.setFromAxisAngle(b,c);this.quaternion.premultiply(a);return this}}(),rotateX:function(){var a=new p(1,0,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateY:function(){var a=
new p(0,1,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateZ:function(){var a=new p(0,0,1);return function(b){return this.rotateOnAxis(a,b)}}(),translateOnAxis:function(){var a=new p;return function(b,c){a.copy(b).applyQuaternion(this.quaternion);this.position.add(a.multiplyScalar(c));return this}}(),translateX:function(){var a=new p(1,0,0);return function(b){return this.translateOnAxis(a,b)}}(),translateY:function(){var a=new p(0,1,0);return function(b){return this.translateOnAxis(a,
b)}}(),translateZ:function(){var a=new p(0,0,1);return function(b){return this.translateOnAxis(a,b)}}(),localToWorld:function(a){return a.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var a=new J;return function(b){return b.applyMatrix4(a.getInverse(this.matrixWorld))}}(),lookAt:function(){var a=new J,b=new p;return function(c,d,e){c.isVector3?b.copy(c):b.set(c,d,e);this.isCamera?a.lookAt(this.position,b,this.up):a.lookAt(b,this.position,this.up);this.quaternion.setFromRotationMatrix(a)}}(),
add:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.add(arguments[b]);return this}if(a===this)return console.error("THREE.Object3D.add: object can't be added as a child of itself.",a),this;a&&a.isObject3D?(null!==a.parent&&a.parent.remove(a),a.parent=this,a.dispatchEvent({type:"added"}),this.children.push(a)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",a);return this},remove:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.remove(arguments[b]);
return this}b=this.children.indexOf(a);-1!==b&&(a.parent=null,a.dispatchEvent({type:"removed"}),this.children.splice(b,1));return this},getObjectById:function(a){return this.getObjectByProperty("id",a)},getObjectByName:function(a){return this.getObjectByProperty("name",a)},getObjectByProperty:function(a,b){if(this[a]===b)return this;for(var c=0,d=this.children.length;c<d;c++){var e=this.children[c].getObjectByProperty(a,b);if(void 0!==e)return e}},getWorldPosition:function(a){void 0===a&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),
a=new p);this.updateMatrixWorld(!0);return a.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var a=new p,b=new p;return function(c){void 0===c&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),c=new fa);this.updateMatrixWorld(!0);this.matrixWorld.decompose(a,c,b);return c}}(),getWorldScale:function(){var a=new p,b=new fa;return function(c){void 0===c&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),c=new p);this.updateMatrixWorld(!0);
this.matrixWorld.decompose(a,b,c);return c}}(),getWorldDirection:function(){var a=new fa;return function(b){void 0===b&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),b=new p);this.getWorldQuaternion(a);return b.set(0,0,1).applyQuaternion(a)}}(),raycast:function(){},traverse:function(a){a(this);for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].traverse(a)},traverseVisible:function(a){if(!1!==this.visible){a(this);for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].traverseVisible(a)}},
traverseAncestors:function(a){var b=this.parent;null!==b&&(a(b),b.traverseAncestors(a))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(a){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||a)null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0;for(var b=this.children,c=
0,d=b.length;c<d;c++)b[c].updateMatrixWorld(a)},toJSON:function(a){function b(b,c){void 0===b[c.uuid]&&(b[c.uuid]=c.toJSON(a));return c.uuid}function c(a){var b=[],c;for(c in a){var d=a[c];delete d.metadata;b.push(d)}return b}var d=void 0===a||"string"===typeof a,e={};d&&(a={geometries:{},materials:{},textures:{},images:{},shapes:{}},e.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var f={};f.uuid=this.uuid;f.type=this.type;""!==this.name&&(f.name=this.name);!0===this.castShadow&&
(f.castShadow=!0);!0===this.receiveShadow&&(f.receiveShadow=!0);!1===this.visible&&(f.visible=!1);!1===this.frustumCulled&&(f.frustumCulled=!1);0!==this.renderOrder&&(f.renderOrder=this.renderOrder);"{}"!==JSON.stringify(this.userData)&&(f.userData=this.userData);f.layers=this.layers.mask;f.matrix=this.matrix.toArray();!1===this.matrixAutoUpdate&&(f.matrixAutoUpdate=!1);if(this.isMesh||this.isLine||this.isPoints){f.geometry=b(a.geometries,this.geometry);var g=this.geometry.parameters;if(void 0!==
g&&void 0!==g.shapes)if(g=g.shapes,Array.isArray(g))for(var h=0,k=g.length;h<k;h++)b(a.shapes,g[h]);else b(a.shapes,g)}if(void 0!==this.material)if(Array.isArray(this.material)){g=[];h=0;for(k=this.material.length;h<k;h++)g.push(b(a.materials,this.material[h]));f.material=g}else f.material=b(a.materials,this.material);if(0<this.children.length)for(f.children=[],h=0;h<this.children.length;h++)f.children.push(this.children[h].toJSON(a).object);if(d){d=c(a.geometries);h=c(a.materials);k=c(a.textures);
var m=c(a.images);g=c(a.shapes);0<d.length&&(e.geometries=d);0<h.length&&(e.materials=h);0<k.length&&(e.textures=k);0<m.length&&(e.images=m);0<g.length&&(e.shapes=g)}e.object=f;return e},clone:function(a){return(new this.constructor).copy(this,a)},copy:function(a,b){void 0===b&&(b=!0);this.name=a.name;this.up.copy(a.up);this.position.copy(a.position);this.quaternion.copy(a.quaternion);this.scale.copy(a.scale);this.matrix.copy(a.matrix);this.matrixWorld.copy(a.matrixWorld);this.matrixAutoUpdate=a.matrixAutoUpdate;
this.matrixWorldNeedsUpdate=a.matrixWorldNeedsUpdate;this.layers.mask=a.layers.mask;this.visible=a.visible;this.castShadow=a.castShadow;this.receiveShadow=a.receiveShadow;this.frustumCulled=a.frustumCulled;this.renderOrder=a.renderOrder;this.userData=JSON.parse(JSON.stringify(a.userData));if(!0===b)for(b=0;b<a.children.length;b++)this.add(a.children[b].clone());return this}});Na.prototype=Object.assign(Object.create(D.prototype),{constructor:Na,isCamera:!0,copy:function(a,b){D.prototype.copy.call(this,
a,b);this.matrixWorldInverse.copy(a.matrixWorldInverse);this.projectionMatrix.copy(a.projectionMatrix);return this},getWorldDirection:function(){var a=new fa;return function(b){void 0===b&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),b=new p);this.getWorldQuaternion(a);return b.set(0,0,-1).applyQuaternion(a)}}(),updateMatrixWorld:function(a){D.prototype.updateMatrixWorld.call(this,a);this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}});
Ib.prototype=Object.assign(Object.create(Na.prototype),{constructor:Ib,isOrthographicCamera:!0,copy:function(a,b){Na.prototype.copy.call(this,a,b);this.left=a.left;this.right=a.right;this.top=a.top;this.bottom=a.bottom;this.near=a.near;this.far=a.far;this.zoom=a.zoom;this.view=null===a.view?null:Object.assign({},a.view);return this},setViewOffset:function(a,b,c,d,e,f){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1});this.view.enabled=!0;this.view.fullWidth=
a;this.view.fullHeight=b;this.view.offsetX=c;this.view.offsetY=d;this.view.width=e;this.view.height=f;this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1);this.updateProjectionMatrix()},updateProjectionMatrix:function(){var a=(this.right-this.left)/(2*this.zoom),b=(this.top-this.bottom)/(2*this.zoom),c=(this.right+this.left)/2,d=(this.top+this.bottom)/2,e=c-a;c+=a;a=d+b;b=d-b;if(null!==this.view&&this.view.enabled){c=this.zoom/(this.view.width/this.view.fullWidth);
b=this.zoom/(this.view.height/this.view.fullHeight);var f=(this.right-this.left)/this.view.width;d=(this.top-this.bottom)/this.view.height;e+=this.view.offsetX/c*f;c=e+this.view.width/c*f;a-=this.view.offsetY/b*d;b=a-this.view.height/b*d}this.projectionMatrix.makeOrthographic(e,c,a,b,this.near,this.far)},toJSON:function(a){a=D.prototype.toJSON.call(this,a);a.object.zoom=this.zoom;a.object.left=this.left;a.object.right=this.right;a.object.top=this.top;a.object.bottom=this.bottom;a.object.near=this.near;
a.object.far=this.far;null!==this.view&&(a.object.view=Object.assign({},this.view));return a}});Object.assign(Ta.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.a=a.a;this.b=a.b;this.c=a.c;this.normal.copy(a.normal);this.color.copy(a.color);this.materialIndex=a.materialIndex;for(var b=0,c=a.vertexNormals.length;b<c;b++)this.vertexNormals[b]=a.vertexNormals[b].clone();b=0;for(c=a.vertexColors.length;b<c;b++)this.vertexColors[b]=a.vertexColors[b].clone();return this}});
var Mf=0;R.prototype=Object.assign(Object.create(ya.prototype),{constructor:R,isGeometry:!0,applyMatrix:function(a){for(var b=(new ra).getNormalMatrix(a),c=0,d=this.vertices.length;c<d;c++)this.vertices[c].applyMatrix4(a);c=0;for(d=this.faces.length;c<d;c++){a=this.faces[c];a.normal.applyMatrix3(b).normalize();for(var e=0,f=a.vertexNormals.length;e<f;e++)a.vertexNormals[e].applyMatrix3(b).normalize()}null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere();
this.normalsNeedUpdate=this.verticesNeedUpdate=!0;return this},rotateX:function(){var a=new J;return function(b){a.makeRotationX(b);this.applyMatrix(a);return this}}(),rotateY:function(){var a=new J;return function(b){a.makeRotationY(b);this.applyMatrix(a);return this}}(),rotateZ:function(){var a=new J;return function(b){a.makeRotationZ(b);this.applyMatrix(a);return this}}(),translate:function(){var a=new J;return function(b,c,d){a.makeTranslation(b,c,d);this.applyMatrix(a);return this}}(),scale:function(){var a=
new J;return function(b,c,d){a.makeScale(b,c,d);this.applyMatrix(a);return this}}(),lookAt:function(){var a=new D;return function(b){a.lookAt(b);a.updateMatrix();this.applyMatrix(a.matrix)}}(),fromBufferGeometry:function(a){function b(a,b,d,e){var f=void 0!==g?[l[a].clone(),l[b].clone(),l[d].clone()]:[],q=void 0!==h?[c.colors[a].clone(),c.colors[b].clone(),c.colors[d].clone()]:[];e=new Ta(a,b,d,f,q,e);c.faces.push(e);void 0!==k&&c.faceVertexUvs[0].push([n[a].clone(),n[b].clone(),n[d].clone()]);void 0!==
m&&c.faceVertexUvs[1].push([r[a].clone(),r[b].clone(),r[d].clone()])}var c=this,d=null!==a.index?a.index.array:void 0,e=a.attributes,f=e.position.array,g=void 0!==e.normal?e.normal.array:void 0,h=void 0!==e.color?e.color.array:void 0,k=void 0!==e.uv?e.uv.array:void 0,m=void 0!==e.uv2?e.uv2.array:void 0;void 0!==m&&(this.faceVertexUvs[1]=[]);for(var l=[],n=[],r=[],w=e=0;e<f.length;e+=3,w+=2)c.vertices.push(new p(f[e],f[e+1],f[e+2])),void 0!==g&&l.push(new p(g[e],g[e+1],g[e+2])),void 0!==h&&c.colors.push(new H(h[e],
h[e+1],h[e+2])),void 0!==k&&n.push(new A(k[w],k[w+1])),void 0!==m&&r.push(new A(m[w],m[w+1]));var t=a.groups;if(0<t.length)for(e=0;e<t.length;e++){f=t[e];var u=f.start,x=f.count;w=u;for(u+=x;w<u;w+=3)void 0!==d?b(d[w],d[w+1],d[w+2],f.materialIndex):b(w,w+1,w+2,f.materialIndex)}else if(void 0!==d)for(e=0;e<d.length;e+=3)b(d[e],d[e+1],d[e+2]);else for(e=0;e<f.length/3;e+=3)b(e,e+1,e+2);this.computeFaceNormals();null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone());null!==a.boundingSphere&&
(this.boundingSphere=a.boundingSphere.clone());return this},center:function(){var a=new p;return function(){this.computeBoundingBox();this.boundingBox.getCenter(a).negate();this.translate(a.x,a.y,a.z);return this}}(),normalize:function(){this.computeBoundingSphere();var a=this.boundingSphere.center,b=this.boundingSphere.radius;b=0===b?1:1/b;var c=new J;c.set(b,0,0,-b*a.x,0,b,0,-b*a.y,0,0,b,-b*a.z,0,0,0,1);this.applyMatrix(c);return this},computeFaceNormals:function(){for(var a=new p,b=new p,c=0,d=
this.faces.length;c<d;c++){var e=this.faces[c],f=this.vertices[e.a],g=this.vertices[e.b];a.subVectors(this.vertices[e.c],g);b.subVectors(f,g);a.cross(b);a.normalize();e.normal.copy(a)}},computeVertexNormals:function(a){void 0===a&&(a=!0);var b;var c=Array(this.vertices.length);var d=0;for(b=this.vertices.length;d<b;d++)c[d]=new p;if(a){var e=new p,f=new p;a=0;for(d=this.faces.length;a<d;a++){b=this.faces[a];var g=this.vertices[b.a];var h=this.vertices[b.b];var k=this.vertices[b.c];e.subVectors(k,
h);f.subVectors(g,h);e.cross(f);c[b.a].add(e);c[b.b].add(e);c[b.c].add(e)}}else for(this.computeFaceNormals(),a=0,d=this.faces.length;a<d;a++)b=this.faces[a],c[b.a].add(b.normal),c[b.b].add(b.normal),c[b.c].add(b.normal);d=0;for(b=this.vertices.length;d<b;d++)c[d].normalize();a=0;for(d=this.faces.length;a<d;a++)b=this.faces[a],g=b.vertexNormals,3===g.length?(g[0].copy(c[b.a]),g[1].copy(c[b.b]),g[2].copy(c[b.c])):(g[0]=c[b.a].clone(),g[1]=c[b.b].clone(),g[2]=c[b.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=
!0)},computeFlatVertexNormals:function(){var a;this.computeFaceNormals();var b=0;for(a=this.faces.length;b<a;b++){var c=this.faces[b];var d=c.vertexNormals;3===d.length?(d[0].copy(c.normal),d[1].copy(c.normal),d[2].copy(c.normal)):(d[0]=c.normal.clone(),d[1]=c.normal.clone(),d[2]=c.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var a,b;var c=0;for(b=this.faces.length;c<b;c++){var d=this.faces[c];d.__originalFaceNormal?d.__originalFaceNormal.copy(d.normal):
d.__originalFaceNormal=d.normal.clone();d.__originalVertexNormals||(d.__originalVertexNormals=[]);var e=0;for(a=d.vertexNormals.length;e<a;e++)d.__originalVertexNormals[e]?d.__originalVertexNormals[e].copy(d.vertexNormals[e]):d.__originalVertexNormals[e]=d.vertexNormals[e].clone()}var f=new R;f.faces=this.faces;e=0;for(a=this.morphTargets.length;e<a;e++){if(!this.morphNormals[e]){this.morphNormals[e]={};this.morphNormals[e].faceNormals=[];this.morphNormals[e].vertexNormals=[];d=this.morphNormals[e].faceNormals;
var g=this.morphNormals[e].vertexNormals;c=0;for(b=this.faces.length;c<b;c++){var h=new p;var k={a:new p,b:new p,c:new p};d.push(h);g.push(k)}}g=this.morphNormals[e];f.vertices=this.morphTargets[e].vertices;f.computeFaceNormals();f.computeVertexNormals();c=0;for(b=this.faces.length;c<b;c++)d=this.faces[c],h=g.faceNormals[c],k=g.vertexNormals[c],h.copy(d.normal),k.a.copy(d.vertexNormals[0]),k.b.copy(d.vertexNormals[1]),k.c.copy(d.vertexNormals[2])}c=0;for(b=this.faces.length;c<b;c++)d=this.faces[c],
d.normal=d.__originalFaceNormal,d.vertexNormals=d.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Sa);this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Da);this.boundingSphere.setFromPoints(this.vertices)},merge:function(a,b,c){if(a&&a.isGeometry){var d,e=this.vertices.length,f=this.vertices,g=a.vertices,h=this.faces,k=a.faces,m=this.faceVertexUvs[0],l=a.faceVertexUvs[0],
n=this.colors,r=a.colors;void 0===c&&(c=0);void 0!==b&&(d=(new ra).getNormalMatrix(b));a=0;for(var p=g.length;a<p;a++){var t=g[a].clone();void 0!==b&&t.applyMatrix4(b);f.push(t)}a=0;for(p=r.length;a<p;a++)n.push(r[a].clone());a=0;for(p=k.length;a<p;a++){g=k[a];var u=g.vertexNormals;r=g.vertexColors;n=new Ta(g.a+e,g.b+e,g.c+e);n.normal.copy(g.normal);void 0!==d&&n.normal.applyMatrix3(d).normalize();b=0;for(f=u.length;b<f;b++)t=u[b].clone(),void 0!==d&&t.applyMatrix3(d).normalize(),n.vertexNormals.push(t);
n.color.copy(g.color);b=0;for(f=r.length;b<f;b++)t=r[b],n.vertexColors.push(t.clone());n.materialIndex=g.materialIndex+c;h.push(n)}a=0;for(p=l.length;a<p;a++)if(c=l[a],d=[],void 0!==c){b=0;for(f=c.length;b<f;b++)d.push(c[b].clone());m.push(d)}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",a)},mergeMesh:function(a){a&&a.isMesh?(a.matrixAutoUpdate&&a.updateMatrix(),this.merge(a.geometry,a.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",
a)},mergeVertices:function(){var a={},b=[],c=[],d=Math.pow(10,4),e;var f=0;for(e=this.vertices.length;f<e;f++){var g=this.vertices[f];g=Math.round(g.x*d)+"_"+Math.round(g.y*d)+"_"+Math.round(g.z*d);void 0===a[g]?(a[g]=f,b.push(this.vertices[f]),c[f]=b.length-1):c[f]=c[a[g]]}a=[];f=0;for(e=this.faces.length;f<e;f++)for(d=this.faces[f],d.a=c[d.a],d.b=c[d.b],d.c=c[d.c],d=[d.a,d.b,d.c],g=0;3>g;g++)if(d[g]===d[(g+1)%3]){a.push(f);break}for(f=a.length-1;0<=f;f--)for(d=a[f],this.faces.splice(d,1),c=0,e=
this.faceVertexUvs.length;c<e;c++)this.faceVertexUvs[c].splice(d,1);f=this.vertices.length-b.length;this.vertices=b;return f},setFromPoints:function(a){this.vertices=[];for(var b=0,c=a.length;b<c;b++){var d=a[b];this.vertices.push(new p(d.x,d.y,d.z||0))}return this},sortFacesByMaterialIndex:function(){for(var a=this.faces,b=a.length,c=0;c<b;c++)a[c]._id=c;a.sort(function(a,b){return a.materialIndex-b.materialIndex});var d=this.faceVertexUvs[0],e=this.faceVertexUvs[1],f,g;d&&d.length===b&&(f=[]);e&&
e.length===b&&(g=[]);for(c=0;c<b;c++){var h=a[c]._id;f&&f.push(d[h]);g&&g.push(e[h])}f&&(this.faceVertexUvs[0]=f);g&&(this.faceVertexUvs[1]=g)},toJSON:function(){function a(a,b,c){return c?a|1<<b:a&~(1<<b)}function b(a){var b=a.x.toString()+a.y.toString()+a.z.toString();if(void 0!==m[b])return m[b];m[b]=k.length/3;k.push(a.x,a.y,a.z);return m[b]}function c(a){var b=a.r.toString()+a.g.toString()+a.b.toString();if(void 0!==n[b])return n[b];n[b]=l.length;l.push(a.getHex());return n[b]}function d(a){var b=
a.x.toString()+a.y.toString();if(void 0!==p[b])return p[b];p[b]=r.length/2;r.push(a.x,a.y);return p[b]}var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};e.uuid=this.uuid;e.type=this.type;""!==this.name&&(e.name=this.name);if(void 0!==this.parameters){var f=this.parameters,g;for(g in f)void 0!==f[g]&&(e[g]=f[g]);return e}f=[];for(g=0;g<this.vertices.length;g++){var h=this.vertices[g];f.push(h.x,h.y,h.z)}h=[];var k=[],m={},l=[],n={},r=[],p={};for(g=0;g<this.faces.length;g++){var t=
this.faces[g],u=void 0!==this.faceVertexUvs[0][g],x=0<t.normal.length(),y=0<t.vertexNormals.length,v=1!==t.color.r||1!==t.color.g||1!==t.color.b,B=0<t.vertexColors.length,I=0;I=a(I,0,0);I=a(I,1,!0);I=a(I,2,!1);I=a(I,3,u);I=a(I,4,x);I=a(I,5,y);I=a(I,6,v);I=a(I,7,B);h.push(I);h.push(t.a,t.b,t.c);h.push(t.materialIndex);u&&(u=this.faceVertexUvs[0][g],h.push(d(u[0]),d(u[1]),d(u[2])));x&&h.push(b(t.normal));y&&(x=t.vertexNormals,h.push(b(x[0]),b(x[1]),b(x[2])));v&&h.push(c(t.color));B&&(t=t.vertexColors,
h.push(c(t[0]),c(t[1]),c(t[2])))}e.data={};e.data.vertices=f;e.data.normals=k;0<l.length&&(e.data.colors=l);0<r.length&&(e.data.uvs=[r]);e.data.faces=h;return e},clone:function(){return(new R).copy(this)},copy:function(a){var b,c,d;this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.name=a.name;var e=a.vertices;var f=0;for(b=e.length;f<
b;f++)this.vertices.push(e[f].clone());e=a.colors;f=0;for(b=e.length;f<b;f++)this.colors.push(e[f].clone());e=a.faces;f=0;for(b=e.length;f<b;f++)this.faces.push(e[f].clone());f=0;for(b=a.faceVertexUvs.length;f<b;f++){var g=a.faceVertexUvs[f];void 0===this.faceVertexUvs[f]&&(this.faceVertexUvs[f]=[]);e=0;for(c=g.length;e<c;e++){var h=g[e],k=[];var m=0;for(d=h.length;m<d;m++)k.push(h[m].clone());this.faceVertexUvs[f].push(k)}}m=a.morphTargets;f=0;for(b=m.length;f<b;f++){d={};d.name=m[f].name;if(void 0!==
m[f].vertices)for(d.vertices=[],e=0,c=m[f].vertices.length;e<c;e++)d.vertices.push(m[f].vertices[e].clone());if(void 0!==m[f].normals)for(d.normals=[],e=0,c=m[f].normals.length;e<c;e++)d.normals.push(m[f].normals[e].clone());this.morphTargets.push(d)}m=a.morphNormals;f=0;for(b=m.length;f<b;f++){d={};if(void 0!==m[f].vertexNormals)for(d.vertexNormals=[],e=0,c=m[f].vertexNormals.length;e<c;e++)g=m[f].vertexNormals[e],h={},h.a=g.a.clone(),h.b=g.b.clone(),h.c=g.c.clone(),d.vertexNormals.push(h);if(void 0!==
m[f].faceNormals)for(d.faceNormals=[],e=0,c=m[f].faceNormals.length;e<c;e++)d.faceNormals.push(m[f].faceNormals[e].clone());this.morphNormals.push(d)}e=a.skinWeights;f=0;for(b=e.length;f<b;f++)this.skinWeights.push(e[f].clone());e=a.skinIndices;f=0;for(b=e.length;f<b;f++)this.skinIndices.push(e[f].clone());e=a.lineDistances;f=0;for(b=e.length;f<b;f++)this.lineDistances.push(e[f]);f=a.boundingBox;null!==f&&(this.boundingBox=f.clone());f=a.boundingSphere;null!==f&&(this.boundingSphere=f.clone());this.elementsNeedUpdate=
a.elementsNeedUpdate;this.verticesNeedUpdate=a.verticesNeedUpdate;this.uvsNeedUpdate=a.uvsNeedUpdate;this.normalsNeedUpdate=a.normalsNeedUpdate;this.colorsNeedUpdate=a.colorsNeedUpdate;this.lineDistancesNeedUpdate=a.lineDistancesNeedUpdate;this.groupsNeedUpdate=a.groupsNeedUpdate;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});Object.defineProperty(Q.prototype,"needsUpdate",{set:function(a){!0===a&&this.version++}});Object.assign(Q.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},
setArray:function(a){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==a?a.length/this.itemSize:0;this.array=a;return this},setDynamic:function(a){this.dynamic=a;return this},copy:function(a){this.name=a.name;this.array=new a.array.constructor(a.array);this.itemSize=a.itemSize;this.count=a.count;this.normalized=a.normalized;this.dynamic=a.dynamic;return this},copyAt:function(a,b,c){a*=this.itemSize;c*=b.itemSize;for(var d=0,e=this.itemSize;d<
e;d++)this.array[a+d]=b.array[c+d];return this},copyArray:function(a){this.array.set(a);return this},copyColorsArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];void 0===f&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",d),f=new H);b[c++]=f.r;b[c++]=f.g;b[c++]=f.b}return this},copyVector2sArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];void 0===f&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",
d),f=new A);b[c++]=f.x;b[c++]=f.y}return this},copyVector3sArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];void 0===f&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",d),f=new p);b[c++]=f.x;b[c++]=f.y;b[c++]=f.z}return this},copyVector4sArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];void 0===f&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",d),f=new V);b[c++]=f.x;b[c++]=f.y;
b[c++]=f.z;b[c++]=f.w}return this},set:function(a,b){void 0===b&&(b=0);this.array.set(a,b);return this},getX:function(a){return this.array[a*this.itemSize]},setX:function(a,b){this.array[a*this.itemSize]=b;return this},getY:function(a){return this.array[a*this.itemSize+1]},setY:function(a,b){this.array[a*this.itemSize+1]=b;return this},getZ:function(a){return this.array[a*this.itemSize+2]},setZ:function(a,b){this.array[a*this.itemSize+2]=b;return this},getW:function(a){return this.array[a*this.itemSize+
3]},setW:function(a,b){this.array[a*this.itemSize+3]=b;return this},setXY:function(a,b,c){a*=this.itemSize;this.array[a+0]=b;this.array[a+1]=c;return this},setXYZ:function(a,b,c,d){a*=this.itemSize;this.array[a+0]=b;this.array[a+1]=c;this.array[a+2]=d;return this},setXYZW:function(a,b,c,d,e){a*=this.itemSize;this.array[a+0]=b;this.array[a+1]=c;this.array[a+2]=d;this.array[a+3]=e;return this},onUpload:function(a){this.onUploadCallback=a;return this},clone:function(){return(new this.constructor(this.array,
this.itemSize)).copy(this)}});pc.prototype=Object.create(Q.prototype);pc.prototype.constructor=pc;qc.prototype=Object.create(Q.prototype);qc.prototype.constructor=qc;rc.prototype=Object.create(Q.prototype);rc.prototype.constructor=rc;sc.prototype=Object.create(Q.prototype);sc.prototype.constructor=sc;jb.prototype=Object.create(Q.prototype);jb.prototype.constructor=jb;tc.prototype=Object.create(Q.prototype);tc.prototype.constructor=tc;kb.prototype=Object.create(Q.prototype);kb.prototype.constructor=
kb;z.prototype=Object.create(Q.prototype);z.prototype.constructor=z;uc.prototype=Object.create(Q.prototype);uc.prototype.constructor=uc;Object.assign(Fe.prototype,{computeGroups:function(a){var b=[],c=void 0;a=a.faces;for(var d=0;d<a.length;d++){var e=a[d];if(e.materialIndex!==c){c=e.materialIndex;void 0!==f&&(f.count=3*d-f.start,b.push(f));var f={start:3*d,materialIndex:c}}}void 0!==f&&(f.count=3*d-f.start,b.push(f));this.groups=b},fromGeometry:function(a){var b=a.faces,c=a.vertices,d=a.faceVertexUvs,
e=d[0]&&0<d[0].length,f=d[1]&&0<d[1].length,g=a.morphTargets,h=g.length;if(0<h){var k=[];for(var m=0;m<h;m++)k[m]=[];this.morphTargets.position=k}var l=a.morphNormals,n=l.length;if(0<n){var r=[];for(m=0;m<n;m++)r[m]=[];this.morphTargets.normal=r}var p=a.skinIndices,t=a.skinWeights,u=p.length===c.length,x=t.length===c.length;0<c.length&&0===b.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(m=0;m<b.length;m++){var y=b[m];this.vertices.push(c[y.a],c[y.b],c[y.c]);
var v=y.vertexNormals;3===v.length?this.normals.push(v[0],v[1],v[2]):(v=y.normal,this.normals.push(v,v,v));v=y.vertexColors;3===v.length?this.colors.push(v[0],v[1],v[2]):(v=y.color,this.colors.push(v,v,v));!0===e&&(v=d[0][m],void 0!==v?this.uvs.push(v[0],v[1],v[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",m),this.uvs.push(new A,new A,new A)));!0===f&&(v=d[1][m],void 0!==v?this.uvs2.push(v[0],v[1],v[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",
m),this.uvs2.push(new A,new A,new A)));for(v=0;v<h;v++){var B=g[v].vertices;k[v].push(B[y.a],B[y.b],B[y.c])}for(v=0;v<n;v++)B=l[v].vertexNormals[m],r[v].push(B.a,B.b,B.c);u&&this.skinIndices.push(p[y.a],p[y.b],p[y.c]);x&&this.skinWeights.push(t[y.a],t[y.b],t[y.c])}this.computeGroups(a);this.verticesNeedUpdate=a.verticesNeedUpdate;this.normalsNeedUpdate=a.normalsNeedUpdate;this.colorsNeedUpdate=a.colorsNeedUpdate;this.uvsNeedUpdate=a.uvsNeedUpdate;this.groupsNeedUpdate=a.groupsNeedUpdate;return this}});
var Nf=1;C.prototype=Object.assign(Object.create(ya.prototype),{constructor:C,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(a){Array.isArray(a)?this.index=new (65535<Ge(a)?kb:jb)(a,1):this.index=a},addAttribute:function(a,b,c){if(!(b&&b.isBufferAttribute||b&&b.isInterleavedBufferAttribute))return console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(a,new Q(b,c));if("index"===a)return console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),
this.setIndex(b),this;this.attributes[a]=b;return this},getAttribute:function(a){return this.attributes[a]},removeAttribute:function(a){delete this.attributes[a];return this},addGroup:function(a,b,c){this.groups.push({start:a,count:b,materialIndex:void 0!==c?c:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(a,b){this.drawRange.start=a;this.drawRange.count=b},applyMatrix:function(a){var b=this.attributes.position;void 0!==b&&(a.applyToBufferAttribute(b),b.needsUpdate=!0);b=this.attributes.normal;
void 0!==b&&((new ra).getNormalMatrix(a).applyToBufferAttribute(b),b.needsUpdate=!0);null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere();return this},rotateX:function(){var a=new J;return function(b){a.makeRotationX(b);this.applyMatrix(a);return this}}(),rotateY:function(){var a=new J;return function(b){a.makeRotationY(b);this.applyMatrix(a);return this}}(),rotateZ:function(){var a=new J;return function(b){a.makeRotationZ(b);this.applyMatrix(a);
return this}}(),translate:function(){var a=new J;return function(b,c,d){a.makeTranslation(b,c,d);this.applyMatrix(a);return this}}(),scale:function(){var a=new J;return function(b,c,d){a.makeScale(b,c,d);this.applyMatrix(a);return this}}(),lookAt:function(){var a=new D;return function(b){a.lookAt(b);a.updateMatrix();this.applyMatrix(a.matrix)}}(),center:function(){var a=new p;return function(){this.computeBoundingBox();this.boundingBox.getCenter(a).negate();this.translate(a.x,a.y,a.z);return this}}(),
setFromObject:function(a){var b=a.geometry;if(a.isPoints||a.isLine){a=new z(3*b.vertices.length,3);var c=new z(3*b.colors.length,3);this.addAttribute("position",a.copyVector3sArray(b.vertices));this.addAttribute("color",c.copyColorsArray(b.colors));b.lineDistances&&b.lineDistances.length===b.vertices.length&&(a=new z(b.lineDistances.length,1),this.addAttribute("lineDistance",a.copyArray(b.lineDistances)));null!==b.boundingSphere&&(this.boundingSphere=b.boundingSphere.clone());null!==b.boundingBox&&
(this.boundingBox=b.boundingBox.clone())}else a.isMesh&&b&&b.isGeometry&&this.fromGeometry(b);return this},setFromPoints:function(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c];b.push(e.x,e.y,e.z||0)}this.addAttribute("position",new z(b,3));return this},updateFromObject:function(a){var b=a.geometry;if(a.isMesh){var c=b.__directGeometry;!0===b.elementsNeedUpdate&&(c=void 0,b.elementsNeedUpdate=!1);if(void 0===c)return this.fromGeometry(b);c.verticesNeedUpdate=b.verticesNeedUpdate;c.normalsNeedUpdate=
b.normalsNeedUpdate;c.colorsNeedUpdate=b.colorsNeedUpdate;c.uvsNeedUpdate=b.uvsNeedUpdate;c.groupsNeedUpdate=b.groupsNeedUpdate;b.verticesNeedUpdate=!1;b.normalsNeedUpdate=!1;b.colorsNeedUpdate=!1;b.uvsNeedUpdate=!1;b.groupsNeedUpdate=!1;b=c}!0===b.verticesNeedUpdate&&(c=this.attributes.position,void 0!==c&&(c.copyVector3sArray(b.vertices),c.needsUpdate=!0),b.verticesNeedUpdate=!1);!0===b.normalsNeedUpdate&&(c=this.attributes.normal,void 0!==c&&(c.copyVector3sArray(b.normals),c.needsUpdate=!0),b.normalsNeedUpdate=
!1);!0===b.colorsNeedUpdate&&(c=this.attributes.color,void 0!==c&&(c.copyColorsArray(b.colors),c.needsUpdate=!0),b.colorsNeedUpdate=!1);b.uvsNeedUpdate&&(c=this.attributes.uv,void 0!==c&&(c.copyVector2sArray(b.uvs),c.needsUpdate=!0),b.uvsNeedUpdate=!1);b.lineDistancesNeedUpdate&&(c=this.attributes.lineDistance,void 0!==c&&(c.copyArray(b.lineDistances),c.needsUpdate=!0),b.lineDistancesNeedUpdate=!1);b.groupsNeedUpdate&&(b.computeGroups(a.geometry),this.groups=b.groups,b.groupsNeedUpdate=!1);return this},
fromGeometry:function(a){a.__directGeometry=(new Fe).fromGeometry(a);return this.fromDirectGeometry(a.__directGeometry)},fromDirectGeometry:function(a){var b=new Float32Array(3*a.vertices.length);this.addAttribute("position",(new Q(b,3)).copyVector3sArray(a.vertices));0<a.normals.length&&(b=new Float32Array(3*a.normals.length),this.addAttribute("normal",(new Q(b,3)).copyVector3sArray(a.normals)));0<a.colors.length&&(b=new Float32Array(3*a.colors.length),this.addAttribute("color",(new Q(b,3)).copyColorsArray(a.colors)));
0<a.uvs.length&&(b=new Float32Array(2*a.uvs.length),this.addAttribute("uv",(new Q(b,2)).copyVector2sArray(a.uvs)));0<a.uvs2.length&&(b=new Float32Array(2*a.uvs2.length),this.addAttribute("uv2",(new Q(b,2)).copyVector2sArray(a.uvs2)));this.groups=a.groups;for(var c in a.morphTargets){b=[];for(var d=a.morphTargets[c],e=0,f=d.length;e<f;e++){var g=d[e],h=new z(3*g.length,3);b.push(h.copyVector3sArray(g))}this.morphAttributes[c]=b}0<a.skinIndices.length&&(c=new z(4*a.skinIndices.length,4),this.addAttribute("skinIndex",
c.copyVector4sArray(a.skinIndices)));0<a.skinWeights.length&&(c=new z(4*a.skinWeights.length,4),this.addAttribute("skinWeight",c.copyVector4sArray(a.skinWeights)));null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone());null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone());return this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Sa);var a=this.attributes.position;void 0!==a?this.boundingBox.setFromBufferAttribute(a):this.boundingBox.makeEmpty();
(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var a=new Sa,b=new p;return function(){null===this.boundingSphere&&(this.boundingSphere=new Da);var c=this.attributes.position;if(c){var d=this.boundingSphere.center;a.setFromBufferAttribute(c);a.getCenter(d);for(var e=0,
f=0,g=c.count;f<g;f++)b.x=c.getX(f),b.y=c.getY(f),b.z=c.getZ(f),e=Math.max(e,d.distanceToSquared(b));this.boundingSphere.radius=Math.sqrt(e);isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var a=this.index,b=this.attributes,c=this.groups;if(b.position){var d=b.position.array;if(void 0===b.normal)this.addAttribute("normal",
new Q(new Float32Array(d.length),3));else for(var e=b.normal.array,f=0,g=e.length;f<g;f++)e[f]=0;e=b.normal.array;var h=new p,k=new p,m=new p,l=new p,n=new p;if(a){a=a.array;0===c.length&&this.addGroup(0,a.length);for(var r=0,w=c.length;r<w;++r){f=c[r];g=f.start;var t=f.count;f=g;for(g+=t;f<g;f+=3){t=3*a[f+0];var u=3*a[f+1];var x=3*a[f+2];h.fromArray(d,t);k.fromArray(d,u);m.fromArray(d,x);l.subVectors(m,k);n.subVectors(h,k);l.cross(n);e[t]+=l.x;e[t+1]+=l.y;e[t+2]+=l.z;e[u]+=l.x;e[u+1]+=l.y;e[u+2]+=
l.z;e[x]+=l.x;e[x+1]+=l.y;e[x+2]+=l.z}}}else for(f=0,g=d.length;f<g;f+=9)h.fromArray(d,f),k.fromArray(d,f+3),m.fromArray(d,f+6),l.subVectors(m,k),n.subVectors(h,k),l.cross(n),e[f]=l.x,e[f+1]=l.y,e[f+2]=l.z,e[f+3]=l.x,e[f+4]=l.y,e[f+5]=l.z,e[f+6]=l.x,e[f+7]=l.y,e[f+8]=l.z;this.normalizeNormals();b.normal.needsUpdate=!0}},merge:function(a,b){if(a&&a.isBufferGeometry){void 0===b&&(b=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));
var c=this.attributes,d;for(d in c)if(void 0!==a.attributes[d]){var e=c[d].array,f=a.attributes[d],g=f.array,h=0;for(f=f.itemSize*b;h<g.length;h++,f++)e[f]=g[h]}return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",a)},normalizeNormals:function(){var a=new p;return function(){for(var b=this.attributes.normal,c=0,d=b.count;c<d;c++)a.x=b.getX(c),a.y=b.getY(c),a.z=b.getZ(c),a.normalize(),b.setXYZ(c,a.x,a.y,a.z)}}(),toNonIndexed:function(){if(null===
this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var a=new C,b=this.index.array,c=this.attributes,d;for(d in c){var e=c[d],f=e.array,g=e.itemSize,h=new f.constructor(b.length*g),k=0;e=0;for(var m=b.length;e<m;e++){var l=b[e]*g;for(var n=0;n<g;n++)h[k++]=f[l++]}a.addAttribute(d,new Q(h,g))}b=this.groups;e=0;for(m=b.length;e<m;e++)c=b[e],a.addGroup(c.start,c.count,c.materialIndex);return a},toJSON:function(){var a={metadata:{version:4.5,type:"BufferGeometry",
generator:"BufferGeometry.toJSON"}};a.uuid=this.uuid;a.type=this.type;""!==this.name&&(a.name=this.name);0<Object.keys(this.userData).length&&(a.userData=this.userData);if(void 0!==this.parameters){var b=this.parameters;for(e in b)void 0!==b[e]&&(a[e]=b[e]);return a}a.data={attributes:{}};var c=this.index;null!==c&&(b=Array.prototype.slice.call(c.array),a.data.index={type:c.array.constructor.name,array:b});c=this.attributes;for(e in c){var d=c[e];b=Array.prototype.slice.call(d.array);a.data.attributes[e]=
{itemSize:d.itemSize,type:d.array.constructor.name,array:b,normalized:d.normalized}}var e=this.groups;0<e.length&&(a.data.groups=JSON.parse(JSON.stringify(e)));e=this.boundingSphere;null!==e&&(a.data.boundingSphere={center:e.center.toArray(),radius:e.radius});return a},clone:function(){return(new C).copy(this)},copy:function(a){var b;this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;this.name=a.name;var c=a.index;null!==c&&this.setIndex(c.clone());
c=a.attributes;for(g in c)this.addAttribute(g,c[g].clone());var d=a.morphAttributes;for(g in d){var e=[],f=d[g];c=0;for(b=f.length;c<b;c++)e.push(f[c].clone());this.morphAttributes[g]=e}var g=a.groups;c=0;for(b=g.length;c<b;c++)d=g[c],this.addGroup(d.start,d.count,d.materialIndex);g=a.boundingBox;null!==g&&(this.boundingBox=g.clone());g=a.boundingSphere;null!==g&&(this.boundingSphere=g.clone());this.drawRange.start=a.drawRange.start;this.drawRange.count=a.drawRange.count;this.userData=a.userData;
return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});Jb.prototype=Object.create(R.prototype);Jb.prototype.constructor=Jb;lb.prototype=Object.create(C.prototype);lb.prototype.constructor=lb;wc.prototype=Object.create(R.prototype);wc.prototype.constructor=wc;mb.prototype=Object.create(C.prototype);mb.prototype.constructor=mb;var Of=0;O.prototype=Object.assign(Object.create(ya.prototype),{constructor:O,isMaterial:!0,onBeforeCompile:function(){},setValues:function(a){if(void 0!==a)for(var b in a){var c=
a[b];if(void 0===c)console.warn("THREE.Material: '"+b+"' parameter is undefined.");else if("shading"===b)console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===c?!0:!1;else{var d=this[b];void 0===d?console.warn("THREE."+this.type+": '"+b+"' is not a property of this material."):d&&d.isColor?d.set(c):d&&d.isVector3&&c&&c.isVector3?d.copy(c):this[b]="overdraw"===b?Number(c):c}}},toJSON:function(a){function b(a){var b=[],c;for(c in a){var d=
a[c];delete d.metadata;b.push(d)}return b}var c=void 0===a||"string"===typeof a;c&&(a={textures:{},images:{}});var d={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};d.uuid=this.uuid;d.type=this.type;""!==this.name&&(d.name=this.name);this.color&&this.color.isColor&&(d.color=this.color.getHex());void 0!==this.roughness&&(d.roughness=this.roughness);void 0!==this.metalness&&(d.metalness=this.metalness);this.emissive&&this.emissive.isColor&&(d.emissive=this.emissive.getHex());1!==
this.emissiveIntensity&&(d.emissiveIntensity=this.emissiveIntensity);this.specular&&this.specular.isColor&&(d.specular=this.specular.getHex());void 0!==this.shininess&&(d.shininess=this.shininess);void 0!==this.clearCoat&&(d.clearCoat=this.clearCoat);void 0!==this.clearCoatRoughness&&(d.clearCoatRoughness=this.clearCoatRoughness);this.map&&this.map.isTexture&&(d.map=this.map.toJSON(a).uuid);this.alphaMap&&this.alphaMap.isTexture&&(d.alphaMap=this.alphaMap.toJSON(a).uuid);this.lightMap&&this.lightMap.isTexture&&
(d.lightMap=this.lightMap.toJSON(a).uuid);this.aoMap&&this.aoMap.isTexture&&(d.aoMap=this.aoMap.toJSON(a).uuid,d.aoMapIntensity=this.aoMapIntensity);this.bumpMap&&this.bumpMap.isTexture&&(d.bumpMap=this.bumpMap.toJSON(a).uuid,d.bumpScale=this.bumpScale);this.normalMap&&this.normalMap.isTexture&&(d.normalMap=this.normalMap.toJSON(a).uuid,d.normalMapType=this.normalMapType,d.normalScale=this.normalScale.toArray());this.displacementMap&&this.displacementMap.isTexture&&(d.displacementMap=this.displacementMap.toJSON(a).uuid,
d.displacementScale=this.displacementScale,d.displacementBias=this.displacementBias);this.roughnessMap&&this.roughnessMap.isTexture&&(d.roughnessMap=this.roughnessMap.toJSON(a).uuid);this.metalnessMap&&this.metalnessMap.isTexture&&(d.metalnessMap=this.metalnessMap.toJSON(a).uuid);this.emissiveMap&&this.emissiveMap.isTexture&&(d.emissiveMap=this.emissiveMap.toJSON(a).uuid);this.specularMap&&this.specularMap.isTexture&&(d.specularMap=this.specularMap.toJSON(a).uuid);this.envMap&&this.envMap.isTexture&&
(d.envMap=this.envMap.toJSON(a).uuid,d.reflectivity=this.reflectivity);this.gradientMap&&this.gradientMap.isTexture&&(d.gradientMap=this.gradientMap.toJSON(a).uuid);void 0!==this.size&&(d.size=this.size);void 0!==this.sizeAttenuation&&(d.sizeAttenuation=this.sizeAttenuation);1!==this.blending&&(d.blending=this.blending);!0===this.flatShading&&(d.flatShading=this.flatShading);0!==this.side&&(d.side=this.side);0!==this.vertexColors&&(d.vertexColors=this.vertexColors);1>this.opacity&&(d.opacity=this.opacity);
!0===this.transparent&&(d.transparent=this.transparent);d.depthFunc=this.depthFunc;d.depthTest=this.depthTest;d.depthWrite=this.depthWrite;0!==this.rotation&&(d.rotation=this.rotation);1!==this.linewidth&&(d.linewidth=this.linewidth);void 0!==this.dashSize&&(d.dashSize=this.dashSize);void 0!==this.gapSize&&(d.gapSize=this.gapSize);void 0!==this.scale&&(d.scale=this.scale);!0===this.dithering&&(d.dithering=!0);0<this.alphaTest&&(d.alphaTest=this.alphaTest);!0===this.premultipliedAlpha&&(d.premultipliedAlpha=
this.premultipliedAlpha);!0===this.wireframe&&(d.wireframe=this.wireframe);1<this.wireframeLinewidth&&(d.wireframeLinewidth=this.wireframeLinewidth);"round"!==this.wireframeLinecap&&(d.wireframeLinecap=this.wireframeLinecap);"round"!==this.wireframeLinejoin&&(d.wireframeLinejoin=this.wireframeLinejoin);!0===this.morphTargets&&(d.morphTargets=!0);!0===this.skinning&&(d.skinning=!0);!1===this.visible&&(d.visible=!1);"{}"!==JSON.stringify(this.userData)&&(d.userData=this.userData);c&&(c=b(a.textures),
a=b(a.images),0<c.length&&(d.textures=c),0<a.length&&(d.images=a));return d},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.name=a.name;this.fog=a.fog;this.lights=a.lights;this.blending=a.blending;this.side=a.side;this.flatShading=a.flatShading;this.vertexColors=a.vertexColors;this.opacity=a.opacity;this.transparent=a.transparent;this.blendSrc=a.blendSrc;this.blendDst=a.blendDst;this.blendEquation=a.blendEquation;this.blendSrcAlpha=a.blendSrcAlpha;this.blendDstAlpha=
a.blendDstAlpha;this.blendEquationAlpha=a.blendEquationAlpha;this.depthFunc=a.depthFunc;this.depthTest=a.depthTest;this.depthWrite=a.depthWrite;this.colorWrite=a.colorWrite;this.precision=a.precision;this.polygonOffset=a.polygonOffset;this.polygonOffsetFactor=a.polygonOffsetFactor;this.polygonOffsetUnits=a.polygonOffsetUnits;this.dithering=a.dithering;this.alphaTest=a.alphaTest;this.premultipliedAlpha=a.premultipliedAlpha;this.overdraw=a.overdraw;this.visible=a.visible;this.userData=JSON.parse(JSON.stringify(a.userData));
this.clipShadows=a.clipShadows;this.clipIntersection=a.clipIntersection;var b=a.clippingPlanes,c=null;if(null!==b){var d=b.length;c=Array(d);for(var e=0;e!==d;++e)c[e]=b[e].clone()}this.clippingPlanes=c;this.shadowSide=a.shadowSide;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});da.prototype=Object.create(O.prototype);da.prototype.constructor=da;da.prototype.isMeshBasicMaterial=!0;da.prototype.copy=function(a){O.prototype.copy.call(this,a);this.color.copy(a.color);this.map=
a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.skinning=a.skinning;this.morphTargets=
a.morphTargets;return this};ta.prototype=Object.create(O.prototype);ta.prototype.constructor=ta;ta.prototype.isShaderMaterial=!0;ta.prototype.copy=function(a){O.prototype.copy.call(this,a);this.fragmentShader=a.fragmentShader;this.vertexShader=a.vertexShader;this.uniforms=Aa.clone(a.uniforms);this.defines=Object.assign({},a.defines);this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.lights=a.lights;this.clipping=a.clipping;this.skinning=a.skinning;this.morphTargets=a.morphTargets;
this.morphNormals=a.morphNormals;this.extensions=a.extensions;return this};ta.prototype.toJSON=function(a){a=O.prototype.toJSON.call(this,a);a.uniforms=this.uniforms;a.vertexShader=this.vertexShader;a.fragmentShader=this.fragmentShader;return a};Object.assign(nb.prototype,{set:function(a,b){this.origin.copy(a);this.direction.copy(b);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this},at:function(a,
b){void 0===b&&(console.warn("THREE.Ray: .at() target is now required"),b=new p);return b.copy(this.direction).multiplyScalar(a).add(this.origin)},lookAt:function(a){this.direction.copy(a).sub(this.origin).normalize();return this},recast:function(){var a=new p;return function(b){this.origin.copy(this.at(b,a));return this}}(),closestPointToPoint:function(a,b){void 0===b&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),b=new p);b.subVectors(a,this.origin);a=b.dot(this.direction);
return 0>a?b.copy(this.origin):b.copy(this.direction).multiplyScalar(a).add(this.origin)},distanceToPoint:function(a){return Math.sqrt(this.distanceSqToPoint(a))},distanceSqToPoint:function(){var a=new p;return function(b){var c=a.subVectors(b,this.origin).dot(this.direction);if(0>c)return this.origin.distanceToSquared(b);a.copy(this.direction).multiplyScalar(c).add(this.origin);return a.distanceToSquared(b)}}(),distanceSqToSegment:function(){var a=new p,b=new p,c=new p;return function(d,e,f,g){a.copy(d).add(e).multiplyScalar(.5);
b.copy(e).sub(d).normalize();c.copy(this.origin).sub(a);var h=.5*d.distanceTo(e),k=-this.direction.dot(b),m=c.dot(this.direction),l=-c.dot(b),n=c.lengthSq(),r=Math.abs(1-k*k);if(0<r){d=k*l-m;e=k*m-l;var p=h*r;0<=d?e>=-p?e<=p?(h=1/r,d*=h,e*=h,k=d*(d+k*e+2*m)+e*(k*d+e+2*l)+n):(e=h,d=Math.max(0,-(k*e+m)),k=-d*d+e*(e+2*l)+n):(e=-h,d=Math.max(0,-(k*e+m)),k=-d*d+e*(e+2*l)+n):e<=-p?(d=Math.max(0,-(-k*h+m)),e=0<d?-h:Math.min(Math.max(-h,-l),h),k=-d*d+e*(e+2*l)+n):e<=p?(d=0,e=Math.min(Math.max(-h,-l),h),k=
e*(e+2*l)+n):(d=Math.max(0,-(k*h+m)),e=0<d?h:Math.min(Math.max(-h,-l),h),k=-d*d+e*(e+2*l)+n)}else e=0<k?-h:h,d=Math.max(0,-(k*e+m)),k=-d*d+e*(e+2*l)+n;f&&f.copy(this.direction).multiplyScalar(d).add(this.origin);g&&g.copy(b).multiplyScalar(e).add(a);return k}}(),intersectSphere:function(){var a=new p;return function(b,c){a.subVectors(b.center,this.origin);var d=a.dot(this.direction),e=a.dot(a)-d*d;b=b.radius*b.radius;if(e>b)return null;b=Math.sqrt(b-e);e=d-b;d+=b;return 0>e&&0>d?null:0>e?this.at(d,
c):this.at(e,c)}}(),intersectsSphere:function(a){return this.distanceToPoint(a.center)<=a.radius},distanceToPlane:function(a){var b=a.normal.dot(this.direction);if(0===b)return 0===a.distanceToPoint(this.origin)?0:null;a=-(this.origin.dot(a.normal)+a.constant)/b;return 0<=a?a:null},intersectPlane:function(a,b){a=this.distanceToPlane(a);return null===a?null:this.at(a,b)},intersectsPlane:function(a){var b=a.distanceToPoint(this.origin);return 0===b||0>a.normal.dot(this.direction)*b?!0:!1},intersectBox:function(a,
b){var c=1/this.direction.x;var d=1/this.direction.y;var e=1/this.direction.z,f=this.origin;if(0<=c){var g=(a.min.x-f.x)*c;c*=a.max.x-f.x}else g=(a.max.x-f.x)*c,c*=a.min.x-f.x;if(0<=d){var h=(a.min.y-f.y)*d;d*=a.max.y-f.y}else h=(a.max.y-f.y)*d,d*=a.min.y-f.y;if(g>d||h>c)return null;if(h>g||g!==g)g=h;if(d<c||c!==c)c=d;0<=e?(h=(a.min.z-f.z)*e,a=(a.max.z-f.z)*e):(h=(a.max.z-f.z)*e,a=(a.min.z-f.z)*e);if(g>a||h>c)return null;if(h>g||g!==g)g=h;if(a<c||c!==c)c=a;return 0>c?null:this.at(0<=g?g:c,b)},intersectsBox:function(){var a=
new p;return function(b){return null!==this.intersectBox(b,a)}}(),intersectTriangle:function(){var a=new p,b=new p,c=new p,d=new p;return function(e,f,g,h,k){b.subVectors(f,e);c.subVectors(g,e);d.crossVectors(b,c);f=this.direction.dot(d);if(0<f){if(h)return null;h=1}else if(0>f)h=-1,f=-f;else return null;a.subVectors(this.origin,e);e=h*this.direction.dot(c.crossVectors(a,c));if(0>e)return null;g=h*this.direction.dot(b.cross(a));if(0>g||e+g>f)return null;e=-h*a.dot(d);return 0>e?null:this.at(e/f,k)}}(),
applyMatrix4:function(a){this.origin.applyMatrix4(a);this.direction.transformDirection(a);return this},equals:function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)}});Object.assign(ja,{getNormal:function(){var a=new p;return function(b,c,d,e){void 0===e&&(console.warn("THREE.Triangle: .getNormal() target is now required"),e=new p);e.subVectors(d,c);a.subVectors(b,c);e.cross(a);b=e.lengthSq();return 0<b?e.multiplyScalar(1/Math.sqrt(b)):e.set(0,0,0)}}(),getBarycoord:function(){var a=
new p,b=new p,c=new p;return function(d,e,f,g,h){a.subVectors(g,e);b.subVectors(f,e);c.subVectors(d,e);d=a.dot(a);e=a.dot(b);f=a.dot(c);var k=b.dot(b);g=b.dot(c);var m=d*k-e*e;void 0===h&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),h=new p);if(0===m)return h.set(-2,-1,-1);m=1/m;k=(k*f-e*g)*m;d=(d*g-e*f)*m;return h.set(1-k-d,d,k)}}(),containsPoint:function(){var a=new p;return function(b,c,d,e){ja.getBarycoord(b,c,d,e,a);return 0<=a.x&&0<=a.y&&1>=a.x+a.y}}()});Object.assign(ja.prototype,
{set:function(a,b,c){this.a.copy(a);this.b.copy(b);this.c.copy(c);return this},setFromPointsAndIndices:function(a,b,c,d){this.a.copy(a[b]);this.b.copy(a[c]);this.c.copy(a[d]);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.a.copy(a.a);this.b.copy(a.b);this.c.copy(a.c);return this},getArea:function(){var a=new p,b=new p;return function(){a.subVectors(this.c,this.b);b.subVectors(this.a,this.b);return.5*a.cross(b).length()}}(),getMidpoint:function(a){void 0===
a&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),a=new p);return a.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(a){return ja.getNormal(this.a,this.b,this.c,a)},getPlane:function(a){void 0===a&&(console.warn("THREE.Triangle: .getPlane() target is now required"),a=new p);return a.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(a,b){return ja.getBarycoord(a,this.a,this.b,this.c,b)},containsPoint:function(a){return ja.containsPoint(a,
this.a,this.b,this.c)},intersectsBox:function(a){return a.intersectsTriangle(this)},closestPointToPoint:function(){var a=new p,b=new p,c=new p,d=new p,e=new p,f=new p;return function(g,h){void 0===h&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),h=new p);var k=this.a,m=this.b,l=this.c;a.subVectors(m,k);b.subVectors(l,k);d.subVectors(g,k);var n=a.dot(d),r=b.dot(d);if(0>=n&&0>=r)return h.copy(k);e.subVectors(g,m);var w=a.dot(e),t=b.dot(e);if(0<=w&&t<=w)return h.copy(m);
var u=n*t-w*r;if(0>=u&&0<=n&&0>=w)return m=n/(n-w),h.copy(k).addScaledVector(a,m);f.subVectors(g,l);g=a.dot(f);var x=b.dot(f);if(0<=x&&g<=x)return h.copy(l);n=g*r-n*x;if(0>=n&&0<=r&&0>=x)return u=r/(r-x),h.copy(k).addScaledVector(b,u);r=w*x-g*t;if(0>=r&&0<=t-w&&0<=g-x)return c.subVectors(l,m),u=(t-w)/(t-w+(g-x)),h.copy(m).addScaledVector(c,u);l=1/(r+n+u);m=n*l;u*=l;return h.copy(k).addScaledVector(a,m).addScaledVector(b,u)}}(),equals:function(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)}});
ka.prototype=Object.assign(Object.create(D.prototype),{constructor:ka,isMesh:!0,setDrawMode:function(a){this.drawMode=a},copy:function(a){D.prototype.copy.call(this,a);this.drawMode=a.drawMode;void 0!==a.morphTargetInfluences&&(this.morphTargetInfluences=a.morphTargetInfluences.slice());void 0!==a.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},a.morphTargetDictionary));return this},updateMorphTargets:function(){var a=this.geometry;if(a.isBufferGeometry){a=a.morphAttributes;var b=
Object.keys(a);if(0<b.length){var c=a[b[0]];if(void 0!==c)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},a=0,b=c.length;a<b;a++){var d=c[a].name||String(a);this.morphTargetInfluences.push(0);this.morphTargetDictionary[d]=a}}}else if(c=a.morphTargets,void 0!==c&&0<c.length)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},a=0,b=c.length;a<b;a++)d=c[a].name||String(a),this.morphTargetInfluences.push(0),this.morphTargetDictionary[d]=a},raycast:function(){function a(a,b,
c,d,e,f,g){ja.getBarycoord(a,b,c,d,u);e.multiplyScalar(u.x);f.multiplyScalar(u.y);g.multiplyScalar(u.z);e.add(f).add(g);return e.clone()}function b(a,b,c,d,e,f,g,h){if(null===(1===b.side?d.intersectTriangle(g,f,e,!0,h):d.intersectTriangle(e,f,g,2!==b.side,h)))return null;y.copy(h);y.applyMatrix4(a.matrixWorld);b=c.ray.origin.distanceTo(y);return b<c.near||b>c.far?null:{distance:b,point:y.clone(),object:a}}function c(c,d,e,f,m,l,n,q,p){g.fromBufferAttribute(m,n);h.fromBufferAttribute(m,q);k.fromBufferAttribute(m,
p);if(c=b(c,d,e,f,g,h,k,x))l&&(r.fromBufferAttribute(l,n),w.fromBufferAttribute(l,q),t.fromBufferAttribute(l,p),c.uv=a(x,g,h,k,r,w,t)),l=new Ta(n,q,p),ja.getNormal(g,h,k,l.normal),c.face=l;return c}var d=new J,e=new nb,f=new Da,g=new p,h=new p,k=new p,m=new p,l=new p,n=new p,r=new A,w=new A,t=new A,u=new p,x=new p,y=new p;return function(q,p){var u=this.geometry,v=this.material,y=this.matrixWorld;if(void 0!==v&&(null===u.boundingSphere&&u.computeBoundingSphere(),f.copy(u.boundingSphere),f.applyMatrix4(y),
!1!==q.ray.intersectsSphere(f)&&(d.getInverse(y),e.copy(q.ray).applyMatrix4(d),null===u.boundingBox||!1!==e.intersectsBox(u.boundingBox))))if(u.isBufferGeometry){var B=u.index,A=u.attributes.position,z=u.attributes.uv,D=u.groups;u=u.drawRange;var C;if(null!==B)if(Array.isArray(v)){var G=0;for(C=D.length;G<C;G++){var H=D[G];var L=v[H.materialIndex];y=Math.max(H.start,u.start);var M=Math.min(H.start+H.count,u.start+u.count);for(H=y;H<M;H+=3){y=B.getX(H);var J=B.getX(H+1);var O=B.getX(H+2);if(y=c(this,
L,q,e,A,z,y,J,O))y.faceIndex=Math.floor(H/3),p.push(y)}}}else for(y=Math.max(0,u.start),M=Math.min(B.count,u.start+u.count),G=y,C=M;G<C;G+=3){if(y=B.getX(G),J=B.getX(G+1),O=B.getX(G+2),y=c(this,v,q,e,A,z,y,J,O))y.faceIndex=Math.floor(G/3),p.push(y)}else if(void 0!==A)if(Array.isArray(v))for(G=0,C=D.length;G<C;G++)for(H=D[G],L=v[H.materialIndex],y=Math.max(H.start,u.start),M=Math.min(H.start+H.count,u.start+u.count),H=y;H<M;H+=3){if(y=H,J=H+1,O=H+2,y=c(this,L,q,e,A,z,y,J,O))y.faceIndex=Math.floor(H/
3),p.push(y)}else for(y=Math.max(0,u.start),M=Math.min(A.count,u.start+u.count),G=y,C=M;G<C;G+=3)if(y=G,J=G+1,O=G+2,y=c(this,v,q,e,A,z,y,J,O))y.faceIndex=Math.floor(G/3),p.push(y)}else if(u.isGeometry)for(A=Array.isArray(v),z=u.vertices,D=u.faces,y=u.faceVertexUvs[0],0<y.length&&(B=y),H=0,M=D.length;H<M;H++)if(J=D[H],y=A?v[J.materialIndex]:v,void 0!==y){G=z[J.a];C=z[J.b];L=z[J.c];if(!0===y.morphTargets){O=u.morphTargets;var R=this.morphTargetInfluences;g.set(0,0,0);h.set(0,0,0);k.set(0,0,0);for(var Q=
0,S=O.length;Q<S;Q++){var T=R[Q];if(0!==T){var V=O[Q].vertices;g.addScaledVector(m.subVectors(V[J.a],G),T);h.addScaledVector(l.subVectors(V[J.b],C),T);k.addScaledVector(n.subVectors(V[J.c],L),T)}}g.add(G);h.add(C);k.add(L);G=g;C=h;L=k}if(y=b(this,y,q,e,G,C,L,x))B&&B[H]&&(O=B[H],r.copy(O[0]),w.copy(O[1]),t.copy(O[2]),y.uv=a(x,G,C,L,r,w,t)),y.face=J,y.faceIndex=H,p.push(y)}}}(),clone:function(){return(new this.constructor(this.geometry,this.material)).copy(this)}});var Cf=function(a,b){this._instance=
b;this.bind=function(c){"object"===typeof c&&(Object.keys(a).forEach(function(a){if("function"!==typeof c[a])throw Error(typeof c+" must implement "+a);}),this._instance=c);return b};this.resolve=function(){return this._instance}},Df=function(){return{log:function(){},error:function(){},warn:function(){},info:function(){},debug:function(){}}}(),Ef=function(){return{debug:function(){return!1},allowedCachedPrograms:function(){return 50}}}(),Va={Logger:new Cf(Df,Df),Settings:new Cf(Ef,Ef)},Eg=function(){return{getWebGLProgramDiagnostics:function(a,
b,c,d,e,f,g){var h=Va.Logger.resolve(),k=a.getProgramInfoLog(b).trim();c=a.getShaderInfoLog(c).trim();d=a.getShaderInfoLog(d).trim();var m=!0,l=!0;if(!1===a.getProgramParameter(b,a.LINK_STATUS))m=!1,h.error("THREE.WebGLProgram: shader error: ",a.getError(),"gl.VALIDATE_STATUS",a.getProgramParameter(b,a.VALIDATE_STATUS),"gl.getProgramInfoLog",k,c,d);else if(""!==k)h.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",k);else if(""===c||""===d)l=!1;return l?{runnable:m,material:g,programLog:k,vertexShader:{log:c,
prefix:e},fragmentShader:{log:d,prefix:f}}:null}}}();Ua.prototype=Object.create(T.prototype);Ua.prototype.constructor=Ua;Ua.prototype.isCubeTexture=!0;Object.defineProperty(Ua.prototype,"images",{get:function(){return this.image},set:function(a){this.image=a}});var Ne=new T,Oe=new Ua,He=[],Je=[],Me=new Float32Array(16),Le=new Float32Array(9),Ke=new Float32Array(4);Se.prototype.updateCache=function(a){var b=this.cache;a instanceof Float32Array&&b.length!==a.length&&(this.cache=new Float32Array(a.length));
qa(b,a)};Te.prototype.setValue=function(a,b,c){for(var d=this.seq,e=0,f=d.length;e!==f;++e){var g=d[e];g.setValue(a,b[g.id],c)}};var Wd=/([\w\d_]+)(\])?(\[|\.)?/g;$a.prototype.setValue=function(a,b,c){b=this.map[b];void 0!==b&&b.setValue(a,c,this.renderer)};$a.prototype.setOptional=function(a,b,c){b=b[c];void 0!==b&&this.setValue(a,c,b)};$a.upload=function(a,b,c,d){for(var e=0,f=b.length;e!==f;++e){var g=b[e],h=c[g.id];!1!==h.needsUpdate&&g.setValue(a,h.value,d)}};$a.seqWithValue=function(a,b){for(var c=
[],d=0,e=a.length;d!==e;++d){var f=a[d];f.id in b&&c.push(f)}return c};var xg=function(){var a=Va.Logger.resolve();return{logShaderCompilationInformation:function(b,c,d,e){!1===b.getShaderParameter(c,b.COMPILE_STATUS)&&a.error("THREE.WebGLShader: Shader couldn't compile.");c=b.getShaderInfoLog(c);""!==c&&a.warn("THREE.WebGLShader: gl.getShaderInfoLog()",d===b.VERTEX_SHADER?"vertex":"fragment",c,wg(e))}}}(),Fg=0,We=Va.Logger.resolve();Va.Settings.resolve();var Og=0;ab.prototype=Object.create(O.prototype);
ab.prototype.constructor=ab;ab.prototype.isMeshDepthMaterial=!0;ab.prototype.copy=function(a){O.prototype.copy.call(this,a);this.depthPacking=a.depthPacking;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.map=a.map;this.alphaMap=a.alphaMap;this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;return this};bb.prototype=Object.create(O.prototype);
bb.prototype.constructor=bb;bb.prototype.isMeshDistanceMaterial=!0;bb.prototype.copy=function(a){O.prototype.copy.call(this,a);this.referencePosition.copy(a.referencePosition);this.nearDistance=a.nearDistance;this.farDistance=a.farDistance;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.map=a.map;this.alphaMap=a.alphaMap;this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;return this};Lb.prototype=Object.assign(Object.create(D.prototype),
{constructor:Lb,isGroup:!0});Z.prototype=Object.assign(Object.create(Na.prototype),{constructor:Z,isPerspectiveCamera:!0,copy:function(a,b){Na.prototype.copy.call(this,a,b);this.fov=a.fov;this.zoom=a.zoom;this.near=a.near;this.far=a.far;this.focus=a.focus;this.aspect=a.aspect;this.view=null===a.view?null:Object.assign({},a.view);this.filmGauge=a.filmGauge;this.filmOffset=a.filmOffset;return this},setFocalLength:function(a){a=.5*this.getFilmHeight()/a;this.fov=2*G.RAD2DEG*Math.atan(a);this.updateProjectionMatrix()},
getFocalLength:function(){var a=Math.tan(.5*G.DEG2RAD*this.fov);return.5*this.getFilmHeight()/a},getEffectiveFOV:function(){return 2*G.RAD2DEG*Math.atan(Math.tan(.5*G.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(a,b,c,d,e,f){this.aspect=a/b;null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1});this.view.enabled=
!0;this.view.fullWidth=a;this.view.fullHeight=b;this.view.offsetX=c;this.view.offsetY=d;this.view.width=e;this.view.height=f;this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1);this.updateProjectionMatrix()},updateProjectionMatrix:function(){var a=this.near,b=a*Math.tan(.5*G.DEG2RAD*this.fov)/this.zoom,c=2*b,d=this.aspect*c,e=-.5*d,f=this.view;if(null!==this.view&&this.view.enabled){var g=f.fullWidth,h=f.fullHeight;e+=f.offsetX*d/g;b-=f.offsetY*c/h;d*=
f.width/g;c*=f.height/h}f=this.filmOffset;0!==f&&(e+=a*f/this.getFilmWidth());this.projectionMatrix.makePerspective(e,e+d,b,b-c,a,this.far)},toJSON:function(a){a=D.prototype.toJSON.call(this,a);a.object.fov=this.fov;a.object.zoom=this.zoom;a.object.near=this.near;a.object.far=this.far;a.object.focus=this.focus;a.object.aspect=this.aspect;null!==this.view&&(a.object.view=Object.assign({},this.view));a.object.filmGauge=this.filmGauge;a.object.filmOffset=this.filmOffset;return a}});Ac.prototype=Object.assign(Object.create(Z.prototype),
{constructor:Ac,isArrayCamera:!0});Mb.prototype.isFogExp2=!0;Mb.prototype.clone=function(){return new Mb(this.color,this.density)};Mb.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}};Nb.prototype.isFog=!0;Nb.prototype.clone=function(){return new Nb(this.color,this.near,this.far)};Nb.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}};sd.prototype=Object.assign(Object.create(D.prototype),{constructor:sd,
copy:function(a,b){D.prototype.copy.call(this,a,b);null!==a.background&&(this.background=a.background.clone());null!==a.fog&&(this.fog=a.fog.clone());null!==a.overrideMaterial&&(this.overrideMaterial=a.overrideMaterial.clone());this.autoUpdate=a.autoUpdate;this.matrixAutoUpdate=a.matrixAutoUpdate;return this},toJSON:function(a){var b=D.prototype.toJSON.call(this,a);null!==this.background&&(b.object.background=this.background.toJSON(a));null!==this.fog&&(b.object.fog=this.fog.toJSON());return b}});
Object.defineProperty(pb.prototype,"needsUpdate",{set:function(a){!0===a&&this.version++}});Object.assign(pb.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(a){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==a?a.length/this.stride:0;this.array=a;return this},setDynamic:function(a){this.dynamic=a;return this},copy:function(a){this.array=new a.array.constructor(a.array);this.count=a.count;this.stride=
a.stride;this.dynamic=a.dynamic;return this},copyAt:function(a,b,c){a*=this.stride;c*=b.stride;for(var d=0,e=this.stride;d<e;d++)this.array[a+d]=b.array[c+d];return this},set:function(a,b){void 0===b&&(b=0);this.array.set(a,b);return this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(a){this.onUploadCallback=a;return this}});Object.defineProperties(Bc.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}});Object.assign(Bc.prototype,
{isInterleavedBufferAttribute:!0,setX:function(a,b){this.data.array[a*this.data.stride+this.offset]=b;return this},setY:function(a,b){this.data.array[a*this.data.stride+this.offset+1]=b;return this},setZ:function(a,b){this.data.array[a*this.data.stride+this.offset+2]=b;return this},setW:function(a,b){this.data.array[a*this.data.stride+this.offset+3]=b;return this},getX:function(a){return this.data.array[a*this.data.stride+this.offset]},getY:function(a){return this.data.array[a*this.data.stride+this.offset+
1]},getZ:function(a){return this.data.array[a*this.data.stride+this.offset+2]},getW:function(a){return this.data.array[a*this.data.stride+this.offset+3]},setXY:function(a,b,c){a=a*this.data.stride+this.offset;this.data.array[a+0]=b;this.data.array[a+1]=c;return this},setXYZ:function(a,b,c,d){a=a*this.data.stride+this.offset;this.data.array[a+0]=b;this.data.array[a+1]=c;this.data.array[a+2]=d;return this},setXYZW:function(a,b,c,d,e){a=a*this.data.stride+this.offset;this.data.array[a+0]=b;this.data.array[a+
1]=c;this.data.array[a+2]=d;this.data.array[a+3]=e;return this}});db.prototype=Object.create(O.prototype);db.prototype.constructor=db;db.prototype.isSpriteMaterial=!0;db.prototype.copy=function(a){O.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.rotation=a.rotation;return this};var Ob;Cc.prototype=Object.assign(Object.create(D.prototype),{constructor:Cc,isSprite:!0,raycast:function(){function a(a,b,c,d,h,k){e.subVectors(a,c).addScalar(.5).multiply(d);void 0!==h?(f.x=k*e.x-
h*e.y,f.y=h*e.x+k*e.y):f.copy(e);a.copy(b);a.x+=f.x;a.y+=f.y;a.applyMatrix4(g)}var b=new p,c=new p,d=new p,e=new A,f=new A,g=new J,h=new p,k=new p,m=new p;return function(e,f){c.setFromMatrixScale(this.matrixWorld);g.getInverse(this.modelViewMatrix).premultiply(this.matrixWorld);d.setFromMatrixPosition(this.modelViewMatrix);var l=this.material.rotation;if(0!==l){var n=Math.cos(l);var q=Math.sin(l)}l=this.center;a(h.set(-.5,-.5,0),d,l,c,q,n);a(k.set(.5,-.5,0),d,l,c,q,n);a(m.set(.5,.5,0),d,l,c,q,n);
var p=e.ray.intersectTriangle(h,k,m,!1,b);if(null===p&&(a(k.set(-.5,.5,0),d,l,c,q,n),p=e.ray.intersectTriangle(h,m,k,!1,b),null===p))return;q=e.ray.origin.distanceTo(b);q<e.near||q>e.far||f.push({distance:q,point:b.clone(),face:null,object:this})}}(),clone:function(){return(new this.constructor(this.material)).copy(this)},copy:function(a){D.prototype.copy.call(this,a);void 0!==a.center&&this.center.copy(a.center);return this}});Dc.prototype=Object.assign(Object.create(D.prototype),{constructor:Dc,
copy:function(a){D.prototype.copy.call(this,a,!1);a=a.levels;for(var b=0,c=a.length;b<c;b++){var d=a[b];this.addLevel(d.object.clone(),d.distance)}return this},addLevel:function(a,b){void 0===b&&(b=0);b=Math.abs(b);for(var c=this.levels,d=0;d<c.length&&!(b<c[d].distance);d++);c.splice(d,0,{distance:b,object:a});this.add(a)},getObjectForDistance:function(a){for(var b=this.levels,c=1,d=b.length;c<d&&!(a<b[c].distance);c++);return b[c-1].object},raycast:function(){var a=new p;return function(b,c){a.setFromMatrixPosition(this.matrixWorld);
var d=b.ray.origin.distanceTo(a);this.getObjectForDistance(d).raycast(b,c)}}(),update:function(){var a=new p,b=new p;return function(c){var d=this.levels;if(1<d.length){a.setFromMatrixPosition(c.matrixWorld);b.setFromMatrixPosition(this.matrixWorld);c=a.distanceTo(b);d[0].object.visible=!0;for(var e=1,f=d.length;e<f;e++)if(c>=d[e].distance)d[e-1].object.visible=!1,d[e].object.visible=!0;else break;for(;e<f;e++)d[e].object.visible=!1}}}(),toJSON:function(a){a=D.prototype.toJSON.call(this,a);a.object.levels=
[];for(var b=this.levels,c=0,d=b.length;c<d;c++){var e=b[c];a.object.levels.push({object:e.object.uuid,distance:e.distance})}return a}});Object.assign(Ec.prototype,{calculateInverses:function(){this.boneInverses=[];for(var a=0,b=this.bones.length;a<b;a++){var c=new J;this.bones[a]&&c.getInverse(this.bones[a].matrixWorld);this.boneInverses.push(c)}},pose:function(){var a,b;var c=0;for(b=this.bones.length;c<b;c++)(a=this.bones[c])&&a.matrixWorld.getInverse(this.boneInverses[c]);c=0;for(b=this.bones.length;c<
b;c++)if(a=this.bones[c])a.parent&&a.parent.isBone?(a.matrix.getInverse(a.parent.matrixWorld),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale)},update:function(){var a=new J,b=new J;return function(){for(var c=this.bones,d=this.boneInverses,e=this.boneMatrices,f=this.boneTexture,g=0,h=c.length;g<h;g++)a.multiplyMatrices(c[g]?c[g].matrixWorld:b,d[g]),a.toArray(e,16*g);void 0!==f&&(f.needsUpdate=!0)}}(),clone:function(){return new Ec(this.bones,
this.boneInverses)},getBoneByName:function(a){for(var b=0,c=this.bones.length;b<c;b++){var d=this.bones[b];if(d.name===a)return d}}});td.prototype=Object.assign(Object.create(D.prototype),{constructor:td,isBone:!0});ud.prototype=Object.assign(Object.create(ka.prototype),{constructor:ud,isSkinnedMesh:!0,initBones:function(){var a=[],b;if(this.geometry&&void 0!==this.geometry.bones){var c=0;for(b=this.geometry.bones.length;c<b;c++){var d=this.geometry.bones[c];var e=new td;a.push(e);e.name=d.name;e.position.fromArray(d.pos);
e.quaternion.fromArray(d.rotq);void 0!==d.scl&&e.scale.fromArray(d.scl)}c=0;for(b=this.geometry.bones.length;c<b;c++)d=this.geometry.bones[c],-1!==d.parent&&null!==d.parent&&void 0!==a[d.parent]?a[d.parent].add(a[c]):this.add(a[c])}this.updateMatrixWorld(!0);return a},bind:function(a,b){this.skeleton=a;void 0===b&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),b=this.matrixWorld);this.bindMatrix.copy(b);this.bindMatrixInverse.getInverse(b)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var a;
if(this.geometry&&this.geometry.isGeometry)for(a=0;a<this.geometry.skinWeights.length;a++){var b=this.geometry.skinWeights[a];var c=1/b.manhattanLength();Infinity!==c?b.multiplyScalar(c):b.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){b=new V;var d=this.geometry.attributes.skinWeight;for(a=0;a<d.count;a++)b.x=d.getX(a),b.y=d.getY(a),b.z=d.getZ(a),b.w=d.getW(a),c=1/b.manhattanLength(),Infinity!==c?b.multiplyScalar(c):b.set(1,0,0,0),d.setXYZW(a,b.x,b.y,b.z,b.w)}},updateMatrixWorld:function(a){ka.prototype.updateMatrixWorld.call(this,
a);"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return(new this.constructor(this.geometry,this.material)).copy(this)}});Y.prototype=Object.create(O.prototype);Y.prototype.constructor=Y;Y.prototype.isLineBasicMaterial=!0;Y.prototype.copy=function(a){O.prototype.copy.call(this,a);this.color.copy(a.color);
this.linewidth=a.linewidth;this.linecap=a.linecap;this.linejoin=a.linejoin;return this};sa.prototype=Object.assign(Object.create(D.prototype),{constructor:sa,isLine:!0,computeLineDistances:function(){var a=new p,b=new p;return function(){var c=this.geometry;if(c.isBufferGeometry)if(null===c.index){for(var d=c.attributes.position,e=[0],f=1,g=d.count;f<g;f++)a.fromBufferAttribute(d,f-1),b.fromBufferAttribute(d,f),e[f]=e[f-1],e[f]+=a.distanceTo(b);c.addAttribute("lineDistance",new z(e,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");
else if(c.isGeometry)for(d=c.vertices,e=c.lineDistances,e[0]=0,f=1,g=d.length;f<g;f++)e[f]=e[f-1],e[f]+=d[f-1].distanceTo(d[f]);return this}}(),raycast:function(){var a=new J,b=new nb,c=new Da;return function(d,e){var f=d.linePrecision;f*=f;var g=this.geometry,h=this.matrixWorld;null===g.boundingSphere&&g.computeBoundingSphere();c.copy(g.boundingSphere);c.applyMatrix4(h);if(!1!==d.ray.intersectsSphere(c)){a.getInverse(h);b.copy(d.ray).applyMatrix4(a);var k=new p,m=new p;h=new p;var l=new p,n=this&&
this.isLineSegments?2:1;if(g.isBufferGeometry){var r=g.index,w=g.attributes.position.array;if(null!==r){r=r.array;g=0;for(var t=r.length-1;g<t;g+=n){var u=r[g+1];k.fromArray(w,3*r[g]);m.fromArray(w,3*u);u=b.distanceSqToSegment(k,m,l,h);u>f||(l.applyMatrix4(this.matrixWorld),u=d.ray.origin.distanceTo(l),u<d.near||u>d.far||e.push({distance:u,point:h.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this}))}}else for(g=0,t=w.length/3-1;g<t;g+=n)k.fromArray(w,3*g),m.fromArray(w,
3*g+3),u=b.distanceSqToSegment(k,m,l,h),u>f||(l.applyMatrix4(this.matrixWorld),u=d.ray.origin.distanceTo(l),u<d.near||u>d.far||e.push({distance:u,point:h.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this}))}else if(g.isGeometry)for(k=g.vertices,m=k.length,g=0;g<m-1;g+=n)u=b.distanceSqToSegment(k[g],k[g+1],l,h),u>f||(l.applyMatrix4(this.matrixWorld),u=d.ray.origin.distanceTo(l),u<d.near||u>d.far||e.push({distance:u,point:h.clone().applyMatrix4(this.matrixWorld),index:g,
face:null,faceIndex:null,object:this}))}}}(),clone:function(){return(new this.constructor(this.geometry,this.material)).copy(this)}});W.prototype=Object.assign(Object.create(sa.prototype),{constructor:W,isLineSegments:!0,computeLineDistances:function(){var a=new p,b=new p;return function(){var c=this.geometry;if(c.isBufferGeometry)if(null===c.index){for(var d=c.attributes.position,e=[],f=0,g=d.count;f<g;f+=2)a.fromBufferAttribute(d,f),b.fromBufferAttribute(d,f+1),e[f]=0===f?0:e[f-1],e[f+1]=e[f]+a.distanceTo(b);
c.addAttribute("lineDistance",new z(e,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(c.isGeometry)for(d=c.vertices,e=c.lineDistances,f=0,g=d.length;f<g;f+=2)a.copy(d[f]),b.copy(d[f+1]),e[f]=0===f?0:e[f-1],e[f+1]=e[f]+a.distanceTo(b);return this}}()});vd.prototype=Object.assign(Object.create(sa.prototype),{constructor:vd,isLineLoop:!0});Ea.prototype=Object.create(O.prototype);Ea.prototype.constructor=Ea;Ea.prototype.isPointsMaterial=
!0;Ea.prototype.copy=function(a){O.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.size=a.size;this.sizeAttenuation=a.sizeAttenuation;this.morphTargets=a.morphTargets;return this};Pb.prototype=Object.assign(Object.create(D.prototype),{constructor:Pb,isPoints:!0,raycast:function(){var a=new J,b=new nb,c=new Da;return function(d,e){function f(a,c){var f=b.distanceSqToPoint(a);f<l&&(b.closestPointToPoint(a,n),n.applyMatrix4(k),a=d.ray.origin.distanceTo(n),a<d.near||a>d.far||
e.push({distance:a,distanceToRay:Math.sqrt(f),point:n.clone(),index:c,face:null,object:g}))}var g=this,h=this.geometry,k=this.matrixWorld,m=d.params.Points.threshold;null===h.boundingSphere&&h.computeBoundingSphere();c.copy(h.boundingSphere);c.applyMatrix4(k);c.radius+=m;if(!1!==d.ray.intersectsSphere(c)){a.getInverse(k);b.copy(d.ray).applyMatrix4(a);m/=(this.scale.x+this.scale.y+this.scale.z)/3;var l=m*m;m=new p;var n=new p;if(h.isBufferGeometry){var r=h.index;h=h.attributes.position.array;if(null!==
r){var w=r.array;r=0;for(var t=w.length;r<t;r++){var u=w[r];m.fromArray(h,3*u);f(m,u)}}else for(r=0,w=h.length/3;r<w;r++)m.fromArray(h,3*r),f(m,r)}else for(m=h.vertices,r=0,w=m.length;r<w;r++)f(m[r],r)}}}(),clone:function(){return(new this.constructor(this.geometry,this.material)).copy(this)}});ae.prototype=Object.assign(Object.create(T.prototype),{constructor:ae,isVideoTexture:!0,update:function(){var a=this.image;a.readyState>=a.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});Qb.prototype=Object.create(T.prototype);
Qb.prototype.constructor=Qb;Qb.prototype.isCompressedTexture=!0;Fc.prototype=Object.create(T.prototype);Fc.prototype.constructor=Fc;Fc.prototype.isCanvasTexture=!0;Gc.prototype=Object.create(T.prototype);Gc.prototype.constructor=Gc;Gc.prototype.isDepthTexture=!0;Rb.prototype=Object.create(C.prototype);Rb.prototype.constructor=Rb;Hc.prototype=Object.create(R.prototype);Hc.prototype.constructor=Hc;Sb.prototype=Object.create(C.prototype);Sb.prototype.constructor=Sb;Ic.prototype=Object.create(R.prototype);
Ic.prototype.constructor=Ic;na.prototype=Object.create(C.prototype);na.prototype.constructor=na;Jc.prototype=Object.create(R.prototype);Jc.prototype.constructor=Jc;Tb.prototype=Object.create(na.prototype);Tb.prototype.constructor=Tb;Kc.prototype=Object.create(R.prototype);Kc.prototype.constructor=Kc;qb.prototype=Object.create(na.prototype);qb.prototype.constructor=qb;Lc.prototype=Object.create(R.prototype);Lc.prototype.constructor=Lc;Ub.prototype=Object.create(na.prototype);Ub.prototype.constructor=
Ub;Mc.prototype=Object.create(R.prototype);Mc.prototype.constructor=Mc;Vb.prototype=Object.create(na.prototype);Vb.prototype.constructor=Vb;Nc.prototype=Object.create(R.prototype);Nc.prototype.constructor=Nc;Wb.prototype=Object.create(C.prototype);Wb.prototype.constructor=Wb;Oc.prototype=Object.create(R.prototype);Oc.prototype.constructor=Oc;Xb.prototype=Object.create(C.prototype);Xb.prototype.constructor=Xb;Pc.prototype=Object.create(R.prototype);Pc.prototype.constructor=Pc;Yb.prototype=Object.create(C.prototype);
Yb.prototype.constructor=Yb;var ah={triangulate:function(a,b,c){c=c||2;var d=b&&b.length,e=d?b[0]*c:a.length,f=df(a,0,e,c,!0),g=[];if(!f)return g;var h;if(d){var k=c;d=[];var m;var l=0;for(m=b.length;l<m;l++){var n=b[l]*k;var r=l<m-1?b[l+1]*k:a.length;n=df(a,n,r,k,!1);n===n.next&&(n.steiner=!0);d.push(Wg(n))}d.sort(Ug);for(l=0;l<d.length;l++){b=d[l];k=f;if(k=Vg(b,k))b=gf(k,b),Rc(b,b.next);f=Rc(f,f.next)}}if(a.length>80*c){var p=h=a[0];var t=d=a[1];for(k=c;k<e;k+=c)l=a[k],b=a[k+1],l<p&&(p=l),b<t&&
(t=b),l>h&&(h=l),b>d&&(d=b);h=Math.max(h-p,d-t);h=0!==h?1/h:0}Sc(f,g,c,p,t,h);return g}},Wa={area:function(a){for(var b=a.length,c=0,d=b-1,e=0;e<b;d=e++)c+=a[d].x*a[e].y-a[e].x*a[d].y;return.5*c},isClockWise:function(a){return 0>Wa.area(a)},triangulateShape:function(a,b){var c=[],d=[],e=[];hf(a);jf(c,a);var f=a.length;b.forEach(hf);for(a=0;a<b.length;a++)d.push(f),f+=b[a].length,jf(c,b[a]);b=ah.triangulate(c,d);for(a=0;a<b.length;a+=3)e.push(b.slice(a,a+3));return e}};sb.prototype=Object.create(R.prototype);
sb.prototype.constructor=sb;sb.prototype.toJSON=function(){var a=R.prototype.toJSON.call(this);return kf(this.parameters.shapes,this.parameters.options,a)};Oa.prototype=Object.create(C.prototype);Oa.prototype.constructor=Oa;Oa.prototype.toJSON=function(){var a=C.prototype.toJSON.call(this);return kf(this.parameters.shapes,this.parameters.options,a)};var Xg={generateTopUV:function(a,b,c,d,e){a=b[3*d];d=b[3*d+1];var f=b[3*e];e=b[3*e+1];return[new A(b[3*c],b[3*c+1]),new A(a,d),new A(f,e)]},generateSideWallUV:function(a,
b,c,d,e,f){a=b[3*c];var g=b[3*c+1];c=b[3*c+2];var h=b[3*d],k=b[3*d+1];d=b[3*d+2];var m=b[3*e],l=b[3*e+1];e=b[3*e+2];var n=b[3*f],r=b[3*f+1];b=b[3*f+2];return.01>Math.abs(g-k)?[new A(a,1-c),new A(h,1-d),new A(m,1-e),new A(n,1-b)]:[new A(g,1-c),new A(k,1-d),new A(l,1-e),new A(r,1-b)]}};Uc.prototype=Object.create(R.prototype);Uc.prototype.constructor=Uc;Zb.prototype=Object.create(Oa.prototype);Zb.prototype.constructor=Zb;Vc.prototype=Object.create(R.prototype);Vc.prototype.constructor=Vc;tb.prototype=
Object.create(C.prototype);tb.prototype.constructor=tb;Wc.prototype=Object.create(R.prototype);Wc.prototype.constructor=Wc;$b.prototype=Object.create(C.prototype);$b.prototype.constructor=$b;Xc.prototype=Object.create(R.prototype);Xc.prototype.constructor=Xc;ac.prototype=Object.create(C.prototype);ac.prototype.constructor=ac;ub.prototype=Object.create(R.prototype);ub.prototype.constructor=ub;ub.prototype.toJSON=function(){var a=R.prototype.toJSON.call(this);return lf(this.parameters.shapes,a)};vb.prototype=
Object.create(C.prototype);vb.prototype.constructor=vb;vb.prototype.toJSON=function(){var a=C.prototype.toJSON.call(this);return lf(this.parameters.shapes,a)};bc.prototype=Object.create(C.prototype);bc.prototype.constructor=bc;wb.prototype=Object.create(R.prototype);wb.prototype.constructor=wb;Xa.prototype=Object.create(C.prototype);Xa.prototype.constructor=Xa;Yc.prototype=Object.create(wb.prototype);Yc.prototype.constructor=Yc;Zc.prototype=Object.create(Xa.prototype);Zc.prototype.constructor=Zc;
$c.prototype=Object.create(R.prototype);$c.prototype.constructor=$c;cc.prototype=Object.create(C.prototype);cc.prototype.constructor=cc;var xa=Object.freeze({WireframeGeometry:Rb,ParametricGeometry:Hc,ParametricBufferGeometry:Sb,TetrahedronGeometry:Jc,TetrahedronBufferGeometry:Tb,OctahedronGeometry:Kc,OctahedronBufferGeometry:qb,IcosahedronGeometry:Lc,IcosahedronBufferGeometry:Ub,DodecahedronGeometry:Mc,DodecahedronBufferGeometry:Vb,PolyhedronGeometry:Ic,PolyhedronBufferGeometry:na,TubeGeometry:Nc,
TubeBufferGeometry:Wb,TorusKnotGeometry:Oc,TorusKnotBufferGeometry:Xb,TorusGeometry:Pc,TorusBufferGeometry:Yb,TextGeometry:Uc,TextBufferGeometry:Zb,SphereGeometry:Vc,SphereBufferGeometry:tb,RingGeometry:Wc,RingBufferGeometry:$b,PlaneGeometry:wc,PlaneBufferGeometry:mb,LatheGeometry:Xc,LatheBufferGeometry:ac,ShapeGeometry:ub,ShapeBufferGeometry:vb,ExtrudeGeometry:sb,ExtrudeBufferGeometry:Oa,EdgesGeometry:bc,ConeGeometry:Yc,ConeBufferGeometry:Zc,CylinderGeometry:wb,CylinderBufferGeometry:Xa,CircleGeometry:$c,
CircleBufferGeometry:cc,BoxGeometry:Jb,BoxBufferGeometry:lb});xb.prototype=Object.create(O.prototype);xb.prototype.constructor=xb;xb.prototype.isShadowMaterial=!0;xb.prototype.copy=function(a){O.prototype.copy.call(this,a);this.color.copy(a.color);return this};dc.prototype=Object.create(ta.prototype);dc.prototype.constructor=dc;dc.prototype.isRawShaderMaterial=!0;Pa.prototype=Object.create(O.prototype);Pa.prototype.constructor=Pa;Pa.prototype.isMeshStandardMaterial=!0;Pa.prototype.copy=function(a){O.prototype.copy.call(this,
a);this.defines={STANDARD:""};this.color.copy(a.color);this.roughness=a.roughness;this.metalness=a.metalness;this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);
this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.roughnessMap=a.roughnessMap;this.metalnessMap=a.metalnessMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.envMapIntensity=a.envMapIntensity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.skinning=a.skinning;this.morphTargets=
a.morphTargets;this.morphNormals=a.morphNormals;return this};yb.prototype=Object.create(Pa.prototype);yb.prototype.constructor=yb;yb.prototype.isMeshPhysicalMaterial=!0;yb.prototype.copy=function(a){Pa.prototype.copy.call(this,a);this.defines={PHYSICAL:""};this.reflectivity=a.reflectivity;this.clearCoat=a.clearCoat;this.clearCoatRoughness=a.clearCoatRoughness;return this};Fa.prototype=Object.create(O.prototype);Fa.prototype.constructor=Fa;Fa.prototype.isMeshPhongMaterial=!0;Fa.prototype.copy=function(a){O.prototype.copy.call(this,
a);this.color.copy(a.color);this.specular.copy(a.specular);this.shininess=a.shininess;this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;
this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;
return this};zb.prototype=Object.create(Fa.prototype);zb.prototype.constructor=zb;zb.prototype.isMeshToonMaterial=!0;zb.prototype.copy=function(a){Fa.prototype.copy.call(this,a);this.gradientMap=a.gradientMap;return this};Ab.prototype=Object.create(O.prototype);Ab.prototype.constructor=Ab;Ab.prototype.isMeshNormalMaterial=!0;Ab.prototype.copy=function(a){O.prototype.copy.call(this,a);this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);
this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;return this};Bb.prototype=Object.create(O.prototype);Bb.prototype.constructor=Bb;Bb.prototype.isMeshLambertMaterial=!0;Bb.prototype.copy=function(a){O.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;
this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;
this.wireframeLinejoin=a.wireframeLinejoin;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;return this};Cb.prototype=Object.create(Y.prototype);Cb.prototype.constructor=Cb;Cb.prototype.isLineDashedMaterial=!0;Cb.prototype.copy=function(a){Y.prototype.copy.call(this,a);this.scale=a.scale;this.dashSize=a.dashSize;this.gapSize=a.gapSize;return this};var bh=Object.freeze({ShadowMaterial:xb,SpriteMaterial:db,RawShaderMaterial:dc,ShaderMaterial:ta,PointsMaterial:Ea,
MeshPhysicalMaterial:yb,MeshStandardMaterial:Pa,MeshPhongMaterial:Fa,MeshToonMaterial:zb,MeshNormalMaterial:Ab,MeshLambertMaterial:Bb,MeshDepthMaterial:ab,MeshDistanceMaterial:bb,MeshBasicMaterial:da,LineDashedMaterial:Cb,LineBasicMaterial:Y,Material:O}),Gb={enabled:!1,files:{},add:function(a,b){!1!==this.enabled&&(this.files[a]=b)},get:function(a){if(!1!==this.enabled)return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}},la=new de,Za={};Object.assign(Ga.prototype,
{load:function(a,b,c,d){void 0===a&&(a="");void 0!==this.path&&(a=this.path+a);a=this.manager.resolveURL(a);var e=this,f=Gb.get(a);if(void 0!==f)return e.manager.itemStart(a),setTimeout(function(){b&&b(f);e.manager.itemEnd(a)},0),f;if(void 0!==Za[a])Za[a].push({onLoad:b,onProgress:c,onError:d});else{var g=a.match(/^data:(.*?)(;base64)?,(.*)$/);if(g){c=g[1];var h=!!g[2];g=g[3];g=window.decodeURIComponent(g);h&&(g=window.atob(g));try{var k=(this.responseType||"").toLowerCase();switch(k){case "arraybuffer":case "blob":var m=
new Uint8Array(g.length);for(h=0;h<g.length;h++)m[h]=g.charCodeAt(h);var l="blob"===k?new Blob([m.buffer],{type:c}):m.buffer;break;case "document":l=(new DOMParser).parseFromString(g,c);break;case "json":l=JSON.parse(g);break;default:l=g}window.setTimeout(function(){b&&b(l);e.manager.itemEnd(a)},0)}catch(r){window.setTimeout(function(){d&&d(r);e.manager.itemEnd(a);e.manager.itemError(a)},0)}}else{Za[a]=[];Za[a].push({onLoad:b,onProgress:c,onError:d});var n=new XMLHttpRequest;n.open("GET",a,!0);n.addEventListener("load",
function(b){var c=this.response;Gb.add(a,c);var d=Za[a];delete Za[a];if(200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var f=0,g=d.length;f<g;f++){var h=d[f];if(h.onLoad)h.onLoad(c)}e.manager.itemEnd(a)}else{f=0;for(g=d.length;f<g;f++)if(h=d[f],h.onError)h.onError(b);e.manager.itemEnd(a);e.manager.itemError(a)}},!1);n.addEventListener("progress",function(b){for(var c=Za[a],d=0,e=c.length;d<e;d++){var f=c[d];if(f.onProgress)f.onProgress(b)}},
!1);n.addEventListener("error",function(b){var c=Za[a];delete Za[a];for(var d=0,f=c.length;d<f;d++){var g=c[d];if(g.onError)g.onError(b)}e.manager.itemEnd(a);e.manager.itemError(a)},!1);void 0!==this.responseType&&(n.responseType=this.responseType);void 0!==this.withCredentials&&(n.withCredentials=this.withCredentials);n.overrideMimeType&&n.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(h in this.requestHeader)n.setRequestHeader(h,this.requestHeader[h]);n.send(null)}e.manager.itemStart(a);
return n}},setPath:function(a){this.path=a;return this},setResponseType:function(a){this.responseType=a;return this},setWithCredentials:function(a){this.withCredentials=a;return this},setMimeType:function(a){this.mimeType=a;return this},setRequestHeader:function(a){this.requestHeader=a;return this}});Object.assign(mf.prototype,{load:function(a,b,c,d){function e(e){k.load(a[e],function(a){a=f._parser(a,!0);g[e]={width:a.width,height:a.height,format:a.format,mipmaps:a.mipmaps};m+=1;6===m&&(1===a.mipmapCount&&
(h.minFilter=1006),h.format=a.format,h.needsUpdate=!0,b&&b(h))},c,d)}var f=this,g=[],h=new Qb;h.image=g;var k=new Ga(this.manager);k.setPath(this.path);k.setResponseType("arraybuffer");if(Array.isArray(a))for(var m=0,l=0,n=a.length;l<n;++l)e(l);else k.load(a,function(a){a=f._parser(a,!0);if(a.isCubemap)for(var c=a.mipmaps.length/a.mipmapCount,d=0;d<c;d++){g[d]={mipmaps:[]};for(var e=0;e<a.mipmapCount;e++)g[d].mipmaps.push(a.mipmaps[d*a.mipmapCount+e]),g[d].format=a.format,g[d].width=a.width,g[d].height=
a.height}else h.image.width=a.width,h.image.height=a.height,h.mipmaps=a.mipmaps;1===a.mipmapCount&&(h.minFilter=1006);h.format=a.format;h.needsUpdate=!0;b&&b(h)},c,d);return h},setPath:function(a){this.path=a;return this}});Object.assign(ee.prototype,{load:function(a,b,c,d){var e=this,f=new hb,g=new Ga(this.manager);g.setResponseType("arraybuffer");g.load(a,function(a){if(a=e._parser(a))void 0!==a.image?f.image=a.image:void 0!==a.data&&(f.image.width=a.width,f.image.height=a.height,f.image.data=a.data),
f.wrapS=void 0!==a.wrapS?a.wrapS:1001,f.wrapT=void 0!==a.wrapT?a.wrapT:1001,f.magFilter=void 0!==a.magFilter?a.magFilter:1006,f.minFilter=void 0!==a.minFilter?a.minFilter:1008,f.anisotropy=void 0!==a.anisotropy?a.anisotropy:1,void 0!==a.format&&(f.format=a.format),void 0!==a.type&&(f.type=a.type),void 0!==a.mipmaps&&(f.mipmaps=a.mipmaps),1===a.mipmapCount&&(f.minFilter=1006),f.needsUpdate=!0,b&&b(f,a)},c,d);return f}});Object.assign(ad.prototype,{crossOrigin:"anonymous",load:function(a,b,c,d){function e(){k.removeEventListener("load",
e,!1);k.removeEventListener("error",f,!1);Gb.add(a,this);b&&b(this);g.manager.itemEnd(a)}function f(b){k.removeEventListener("load",e,!1);k.removeEventListener("error",f,!1);d&&d(b);g.manager.itemEnd(a);g.manager.itemError(a)}void 0===a&&(a="");void 0!==this.path&&(a=this.path+a);a=this.manager.resolveURL(a);var g=this,h=Gb.get(a);if(void 0!==h)return g.manager.itemStart(a),setTimeout(function(){b&&b(h);g.manager.itemEnd(a)},0),h;var k=document.createElementNS("http://www.w3.org/1999/xhtml","img");
k.addEventListener("load",e,!1);k.addEventListener("error",f,!1);"data:"!==a.substr(0,5)&&void 0!==this.crossOrigin&&(k.crossOrigin=this.crossOrigin);g.manager.itemStart(a);k.src=a;return k},setCrossOrigin:function(a){this.crossOrigin=a;return this},setPath:function(a){this.path=a;return this}});Object.assign(fe.prototype,{crossOrigin:"anonymous",load:function(a,b,c,d){function e(c){g.load(a[c],function(a){f.images[c]=a;h++;6===h&&(f.needsUpdate=!0,b&&b(f))},void 0,d)}var f=new Ua,g=new ad(this.manager);
g.setCrossOrigin(this.crossOrigin);g.setPath(this.path);var h=0;for(c=0;c<a.length;++c)e(c);return f},setCrossOrigin:function(a){this.crossOrigin=a;return this},setPath:function(a){this.path=a;return this}});Object.assign(xd.prototype,{crossOrigin:"anonymous",load:function(a,b,c,d){var e=new T,f=new ad(this.manager);f.setCrossOrigin(this.crossOrigin);f.setPath(this.path);f.load(a,function(c){e.image=c;c=0<a.search(/\.(jpg|jpeg)$/)||0===a.search(/^data:image\/jpeg/);e.format=c?1022:1023;e.needsUpdate=
!0;void 0!==b&&b(e)},c,d);return e},setCrossOrigin:function(a){this.crossOrigin=a;return this},setPath:function(a){this.path=a;return this}});Object.assign(M.prototype,{getPoint:function(){console.warn("THREE.Curve: .getPoint() not implemented.");return null},getPointAt:function(a,b){a=this.getUtoTmapping(a);return this.getPoint(a,b)},getPoints:function(a){void 0===a&&(a=5);for(var b=[],c=0;c<=a;c++)b.push(this.getPoint(c/a));return b},getSpacedPoints:function(a){void 0===a&&(a=5);for(var b=[],c=
0;c<=a;c++)b.push(this.getPointAt(c/a));return b},getLength:function(){var a=this.getLengths();return a[a.length-1]},getLengths:function(a){void 0===a&&(a=this.arcLengthDivisions);if(this.cacheArcLengths&&this.cacheArcLengths.length===a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var b=[],c=this.getPoint(0),d,e=0;b.push(0);for(d=1;d<=a;d++){var f=this.getPoint(d/a);e+=f.distanceTo(c);b.push(e);c=f}return this.cacheArcLengths=b},updateArcLengths:function(){this.needsUpdate=
!0;this.getLengths()},getUtoTmapping:function(a,b){var c=this.getLengths(),d=c.length;b=b?b:a*c[d-1];for(var e=0,f=d-1,g;e<=f;)if(a=Math.floor(e+(f-e)/2),g=c[a]-b,0>g)e=a+1;else if(0<g)f=a-1;else{f=a;break}a=f;if(c[a]===b)return a/(d-1);e=c[a];return(a+(b-e)/(c[a+1]-e))/(d-1)},getTangent:function(a){var b=a-1E-4;a+=1E-4;0>b&&(b=0);1<a&&(a=1);b=this.getPoint(b);return this.getPoint(a).clone().sub(b).normalize()},getTangentAt:function(a){a=this.getUtoTmapping(a);return this.getTangent(a)},computeFrenetFrames:function(a,
b){var c=new p,d=[],e=[],f=[],g=new p,h=new J,k;for(k=0;k<=a;k++){var m=k/a;d[k]=this.getTangentAt(m);d[k].normalize()}e[0]=new p;f[0]=new p;k=Number.MAX_VALUE;m=Math.abs(d[0].x);var l=Math.abs(d[0].y),n=Math.abs(d[0].z);m<=k&&(k=m,c.set(1,0,0));l<=k&&(k=l,c.set(0,1,0));n<=k&&c.set(0,0,1);g.crossVectors(d[0],c).normalize();e[0].crossVectors(d[0],g);f[0].crossVectors(d[0],e[0]);for(k=1;k<=a;k++)e[k]=e[k-1].clone(),f[k]=f[k-1].clone(),g.crossVectors(d[k-1],d[k]),g.length()>Number.EPSILON&&(g.normalize(),
c=Math.acos(G.clamp(d[k-1].dot(d[k]),-1,1)),e[k].applyMatrix4(h.makeRotationAxis(g,c))),f[k].crossVectors(d[k],e[k]);if(!0===b)for(c=Math.acos(G.clamp(e[0].dot(e[a]),-1,1)),c/=a,0<d[0].dot(g.crossVectors(e[0],e[a]))&&(c=-c),k=1;k<=a;k++)e[k].applyMatrix4(h.makeRotationAxis(d[k],c*k)),f[k].crossVectors(d[k],e[k]);return{tangents:d,normals:e,binormals:f}},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.arcLengthDivisions=a.arcLengthDivisions;return this},toJSON:function(){var a=
{metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};a.arcLengthDivisions=this.arcLengthDivisions;a.type=this.type;return a},fromJSON:function(a){this.arcLengthDivisions=a.arcLengthDivisions;return this}});za.prototype=Object.create(M.prototype);za.prototype.constructor=za;za.prototype.isEllipseCurve=!0;za.prototype.getPoint=function(a,b){b=b||new A;for(var c=2*Math.PI,d=this.aEndAngle-this.aStartAngle,e=Math.abs(d)<Number.EPSILON;0>d;)d+=c;for(;d>c;)d-=c;d<Number.EPSILON&&(d=e?0:c);!0!==
this.aClockwise||e||(d=d===c?-c:d-c);c=this.aStartAngle+a*d;a=this.aX+this.xRadius*Math.cos(c);var f=this.aY+this.yRadius*Math.sin(c);0!==this.aRotation&&(c=Math.cos(this.aRotation),d=Math.sin(this.aRotation),e=a-this.aX,f-=this.aY,a=e*c-f*d+this.aX,f=e*d+f*c+this.aY);return b.set(a,f)};za.prototype.copy=function(a){M.prototype.copy.call(this,a);this.aX=a.aX;this.aY=a.aY;this.xRadius=a.xRadius;this.yRadius=a.yRadius;this.aStartAngle=a.aStartAngle;this.aEndAngle=a.aEndAngle;this.aClockwise=a.aClockwise;
this.aRotation=a.aRotation;return this};za.prototype.toJSON=function(){var a=M.prototype.toJSON.call(this);a.aX=this.aX;a.aY=this.aY;a.xRadius=this.xRadius;a.yRadius=this.yRadius;a.aStartAngle=this.aStartAngle;a.aEndAngle=this.aEndAngle;a.aClockwise=this.aClockwise;a.aRotation=this.aRotation;return a};za.prototype.fromJSON=function(a){M.prototype.fromJSON.call(this,a);this.aX=a.aX;this.aY=a.aY;this.xRadius=a.xRadius;this.yRadius=a.yRadius;this.aStartAngle=a.aStartAngle;this.aEndAngle=a.aEndAngle;
this.aClockwise=a.aClockwise;this.aRotation=a.aRotation;return this};ec.prototype=Object.create(za.prototype);ec.prototype.constructor=ec;ec.prototype.isArcCurve=!0;var Qd=new p,Be=new ge,Ce=new ge,De=new ge;ca.prototype=Object.create(M.prototype);ca.prototype.constructor=ca;ca.prototype.isCatmullRomCurve3=!0;ca.prototype.getPoint=function(a,b){b=b||new p;var c=this.points,d=c.length;a*=d-(this.closed?0:1);var e=Math.floor(a);a-=e;this.closed?e+=0<e?0:(Math.floor(Math.abs(e)/d)+1)*d:0===a&&e===d-
1&&(e=d-2,a=1);if(this.closed||0<e)var f=c[(e-1)%d];else Qd.subVectors(c[0],c[1]).add(c[0]),f=Qd;var g=c[e%d];var h=c[(e+1)%d];this.closed||e+2<d?c=c[(e+2)%d]:(Qd.subVectors(c[d-1],c[d-2]).add(c[d-1]),c=Qd);if("centripetal"===this.curveType||"chordal"===this.curveType){var k="chordal"===this.curveType?.5:.25;d=Math.pow(f.distanceToSquared(g),k);e=Math.pow(g.distanceToSquared(h),k);k=Math.pow(h.distanceToSquared(c),k);1E-4>e&&(e=1);1E-4>d&&(d=e);1E-4>k&&(k=e);Be.initNonuniformCatmullRom(f.x,g.x,h.x,
c.x,d,e,k);Ce.initNonuniformCatmullRom(f.y,g.y,h.y,c.y,d,e,k);De.initNonuniformCatmullRom(f.z,g.z,h.z,c.z,d,e,k)}else"catmullrom"===this.curveType&&(Be.initCatmullRom(f.x,g.x,h.x,c.x,this.tension),Ce.initCatmullRom(f.y,g.y,h.y,c.y,this.tension),De.initCatmullRom(f.z,g.z,h.z,c.z,this.tension));b.set(Be.calc(a),Ce.calc(a),De.calc(a));return b};ca.prototype.copy=function(a){M.prototype.copy.call(this,a);this.points=[];for(var b=0,c=a.points.length;b<c;b++)this.points.push(a.points[b].clone());this.closed=
a.closed;this.curveType=a.curveType;this.tension=a.tension;return this};ca.prototype.toJSON=function(){var a=M.prototype.toJSON.call(this);a.points=[];for(var b=0,c=this.points.length;b<c;b++)a.points.push(this.points[b].toArray());a.closed=this.closed;a.curveType=this.curveType;a.tension=this.tension;return a};ca.prototype.fromJSON=function(a){M.prototype.fromJSON.call(this,a);this.points=[];for(var b=0,c=a.points.length;b<c;b++){var d=a.points[b];this.points.push((new p).fromArray(d))}this.closed=
a.closed;this.curveType=a.curveType;this.tension=a.tension;return this};Ha.prototype=Object.create(M.prototype);Ha.prototype.constructor=Ha;Ha.prototype.isCubicBezierCurve=!0;Ha.prototype.getPoint=function(a,b){b=b||new A;var c=this.v0,d=this.v1,e=this.v2,f=this.v3;b.set(cd(a,c.x,d.x,e.x,f.x),cd(a,c.y,d.y,e.y,f.y));return b};Ha.prototype.copy=function(a){M.prototype.copy.call(this,a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);this.v3.copy(a.v3);return this};Ha.prototype.toJSON=function(){var a=
M.prototype.toJSON.call(this);a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();a.v3=this.v3.toArray();return a};Ha.prototype.fromJSON=function(a){M.prototype.fromJSON.call(this,a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);this.v3.fromArray(a.v3);return this};Qa.prototype=Object.create(M.prototype);Qa.prototype.constructor=Qa;Qa.prototype.isCubicBezierCurve3=!0;Qa.prototype.getPoint=function(a,b){b=b||new p;var c=this.v0,d=this.v1,e=this.v2,f=this.v3;
b.set(cd(a,c.x,d.x,e.x,f.x),cd(a,c.y,d.y,e.y,f.y),cd(a,c.z,d.z,e.z,f.z));return b};Qa.prototype.copy=function(a){M.prototype.copy.call(this,a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);this.v3.copy(a.v3);return this};Qa.prototype.toJSON=function(){var a=M.prototype.toJSON.call(this);a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();a.v3=this.v3.toArray();return a};Qa.prototype.fromJSON=function(a){M.prototype.fromJSON.call(this,a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);
this.v2.fromArray(a.v2);this.v3.fromArray(a.v3);return this};va.prototype=Object.create(M.prototype);va.prototype.constructor=va;va.prototype.isLineCurve=!0;va.prototype.getPoint=function(a,b){b=b||new A;1===a?b.copy(this.v2):(b.copy(this.v2).sub(this.v1),b.multiplyScalar(a).add(this.v1));return b};va.prototype.getPointAt=function(a,b){return this.getPoint(a,b)};va.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()};va.prototype.copy=function(a){M.prototype.copy.call(this,
a);this.v1.copy(a.v1);this.v2.copy(a.v2);return this};va.prototype.toJSON=function(){var a=M.prototype.toJSON.call(this);a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a};va.prototype.fromJSON=function(a){M.prototype.fromJSON.call(this,a);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this};Ia.prototype=Object.create(M.prototype);Ia.prototype.constructor=Ia;Ia.prototype.isLineCurve3=!0;Ia.prototype.getPoint=function(a,b){b=b||new p;1===a?b.copy(this.v2):(b.copy(this.v2).sub(this.v1),
b.multiplyScalar(a).add(this.v1));return b};Ia.prototype.getPointAt=function(a,b){return this.getPoint(a,b)};Ia.prototype.copy=function(a){M.prototype.copy.call(this,a);this.v1.copy(a.v1);this.v2.copy(a.v2);return this};Ia.prototype.toJSON=function(){var a=M.prototype.toJSON.call(this);a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a};Ia.prototype.fromJSON=function(a){M.prototype.fromJSON.call(this,a);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this};Ja.prototype=Object.create(M.prototype);
Ja.prototype.constructor=Ja;Ja.prototype.isQuadraticBezierCurve=!0;Ja.prototype.getPoint=function(a,b){b=b||new A;var c=this.v0,d=this.v1,e=this.v2;b.set(bd(a,c.x,d.x,e.x),bd(a,c.y,d.y,e.y));return b};Ja.prototype.copy=function(a){M.prototype.copy.call(this,a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);return this};Ja.prototype.toJSON=function(){var a=M.prototype.toJSON.call(this);a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a};Ja.prototype.fromJSON=function(a){M.prototype.fromJSON.call(this,
a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this};Ra.prototype=Object.create(M.prototype);Ra.prototype.constructor=Ra;Ra.prototype.isQuadraticBezierCurve3=!0;Ra.prototype.getPoint=function(a,b){b=b||new p;var c=this.v0,d=this.v1,e=this.v2;b.set(bd(a,c.x,d.x,e.x),bd(a,c.y,d.y,e.y),bd(a,c.z,d.z,e.z));return b};Ra.prototype.copy=function(a){M.prototype.copy.call(this,a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);return this};Ra.prototype.toJSON=function(){var a=
M.prototype.toJSON.call(this);a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a};Ra.prototype.fromJSON=function(a){M.prototype.fromJSON.call(this,a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this};Ka.prototype=Object.create(M.prototype);Ka.prototype.constructor=Ka;Ka.prototype.isSplineCurve=!0;Ka.prototype.getPoint=function(a,b){b=b||new A;var c=this.points,d=(c.length-1)*a;a=Math.floor(d);d-=a;var e=c[0===a?a:a-1],f=c[a],g=c[a>c.length-
2?c.length-1:a+1];c=c[a>c.length-3?c.length-1:a+2];b.set(nf(d,e.x,f.x,g.x,c.x),nf(d,e.y,f.y,g.y,c.y));return b};Ka.prototype.copy=function(a){M.prototype.copy.call(this,a);this.points=[];for(var b=0,c=a.points.length;b<c;b++)this.points.push(a.points[b].clone());return this};Ka.prototype.toJSON=function(){var a=M.prototype.toJSON.call(this);a.points=[];for(var b=0,c=this.points.length;b<c;b++)a.points.push(this.points[b].toArray());return a};Ka.prototype.fromJSON=function(a){M.prototype.fromJSON.call(this,
a);this.points=[];for(var b=0,c=a.points.length;b<c;b++){var d=a.points[b];this.points.push((new A).fromArray(d))}return this};var Ff=Object.freeze({ArcCurve:ec,CatmullRomCurve3:ca,CubicBezierCurve:Ha,CubicBezierCurve3:Qa,EllipseCurve:za,LineCurve:va,LineCurve3:Ia,QuadraticBezierCurve:Ja,QuadraticBezierCurve3:Ra,SplineCurve:Ka});Ya.prototype=Object.assign(Object.create(M.prototype),{constructor:Ya,add:function(a){this.curves.push(a)},closePath:function(){var a=this.curves[0].getPoint(0),b=this.curves[this.curves.length-
1].getPoint(1);a.equals(b)||this.curves.push(new va(b,a))},getPoint:function(a){var b=a*this.getLength(),c=this.getCurveLengths();for(a=0;a<c.length;){if(c[a]>=b)return b=c[a]-b,a=this.curves[a],c=a.getLength(),a.getPointAt(0===c?0:1-b/c);a++}return null},getLength:function(){var a=this.getCurveLengths();return a[a.length-1]},updateArcLengths:function(){this.needsUpdate=!0;this.cacheLengths=null;this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;
for(var a=[],b=0,c=0,d=this.curves.length;c<d;c++)b+=this.curves[c].getLength(),a.push(b);return this.cacheLengths=a},getSpacedPoints:function(a){void 0===a&&(a=40);for(var b=[],c=0;c<=a;c++)b.push(this.getPoint(c/a));this.autoClose&&b.push(b[0]);return b},getPoints:function(a){a=a||12;for(var b=[],c,d=0,e=this.curves;d<e.length;d++){var f=e[d];f=f.getPoints(f&&f.isEllipseCurve?2*a:f&&(f.isLineCurve||f.isLineCurve3)?1:f&&f.isSplineCurve?a*f.points.length:a);for(var g=0;g<f.length;g++){var h=f[g];
c&&c.equals(h)||(b.push(h),c=h)}}this.autoClose&&1<b.length&&!b[b.length-1].equals(b[0])&&b.push(b[0]);return b},copy:function(a){M.prototype.copy.call(this,a);this.curves=[];for(var b=0,c=a.curves.length;b<c;b++)this.curves.push(a.curves[b].clone());this.autoClose=a.autoClose;return this},toJSON:function(){var a=M.prototype.toJSON.call(this);a.autoClose=this.autoClose;a.curves=[];for(var b=0,c=this.curves.length;b<c;b++)a.curves.push(this.curves[b].toJSON());return a},fromJSON:function(a){M.prototype.fromJSON.call(this,
a);this.autoClose=a.autoClose;this.curves=[];for(var b=0,c=a.curves.length;b<c;b++){var d=a.curves[b];this.curves.push((new Ff[d.type]).fromJSON(d))}return this}});La.prototype=Object.assign(Object.create(Ya.prototype),{constructor:La,setFromPoints:function(a){this.moveTo(a[0].x,a[0].y);for(var b=1,c=a.length;b<c;b++)this.lineTo(a[b].x,a[b].y)},moveTo:function(a,b){this.currentPoint.set(a,b)},lineTo:function(a,b){var c=new va(this.currentPoint.clone(),new A(a,b));this.curves.push(c);this.currentPoint.set(a,
b)},quadraticCurveTo:function(a,b,c,d){a=new Ja(this.currentPoint.clone(),new A(a,b),new A(c,d));this.curves.push(a);this.currentPoint.set(c,d)},bezierCurveTo:function(a,b,c,d,e,f){a=new Ha(this.currentPoint.clone(),new A(a,b),new A(c,d),new A(e,f));this.curves.push(a);this.currentPoint.set(e,f)},splineThru:function(a){var b=[this.currentPoint.clone()].concat(a);b=new Ka(b);this.curves.push(b);this.currentPoint.copy(a[a.length-1])},arc:function(a,b,c,d,e,f){this.absarc(a+this.currentPoint.x,b+this.currentPoint.y,
c,d,e,f)},absarc:function(a,b,c,d,e,f){this.absellipse(a,b,c,c,d,e,f)},ellipse:function(a,b,c,d,e,f,g,h){this.absellipse(a+this.currentPoint.x,b+this.currentPoint.y,c,d,e,f,g,h)},absellipse:function(a,b,c,d,e,f,g,h){a=new za(a,b,c,d,e,f,g,h);0<this.curves.length&&(b=a.getPoint(0),b.equals(this.currentPoint)||this.lineTo(b.x,b.y));this.curves.push(a);a=a.getPoint(1);this.currentPoint.copy(a)},copy:function(a){Ya.prototype.copy.call(this,a);this.currentPoint.copy(a.currentPoint);return this},toJSON:function(){var a=
Ya.prototype.toJSON.call(this);a.currentPoint=this.currentPoint.toArray();return a},fromJSON:function(a){Ya.prototype.fromJSON.call(this,a);this.currentPoint.fromArray(a.currentPoint);return this}});eb.prototype=Object.assign(Object.create(La.prototype),{constructor:eb,getPointsHoles:function(a){for(var b=[],c=0,d=this.holes.length;c<d;c++)b[c]=this.holes[c].getPoints(a);return b},extractPoints:function(a){return{shape:this.getPoints(a),holes:this.getPointsHoles(a)}},copy:function(a){La.prototype.copy.call(this,
a);this.holes=[];for(var b=0,c=a.holes.length;b<c;b++)this.holes.push(a.holes[b].clone());return this},toJSON:function(){var a=La.prototype.toJSON.call(this);a.uuid=this.uuid;a.holes=[];for(var b=0,c=this.holes.length;b<c;b++)a.holes.push(this.holes[b].toJSON());return a},fromJSON:function(a){La.prototype.fromJSON.call(this,a);this.uuid=a.uuid;this.holes=[];for(var b=0,c=a.holes.length;b<c;b++){var d=a.holes[b];this.holes.push((new La).fromJSON(d))}return this}});X.prototype=Object.assign(Object.create(D.prototype),
{constructor:X,isLight:!0,copy:function(a){D.prototype.copy.call(this,a);this.color.copy(a.color);this.intensity=a.intensity;return this},toJSON:function(a){a=D.prototype.toJSON.call(this,a);a.object.color=this.color.getHex();a.object.intensity=this.intensity;void 0!==this.groundColor&&(a.object.groundColor=this.groundColor.getHex());void 0!==this.distance&&(a.object.distance=this.distance);void 0!==this.angle&&(a.object.angle=this.angle);void 0!==this.decay&&(a.object.decay=this.decay);void 0!==
this.penumbra&&(a.object.penumbra=this.penumbra);void 0!==this.shadow&&(a.object.shadow=this.shadow.toJSON());return a}});yd.prototype=Object.assign(Object.create(X.prototype),{constructor:yd,isHemisphereLight:!0,copy:function(a){X.prototype.copy.call(this,a);this.groundColor.copy(a.groundColor);return this}});Object.assign(Db.prototype,{copy:function(a){this.camera=a.camera.clone();this.bias=a.bias;this.radius=a.radius;this.mapSize.copy(a.mapSize);return this},clone:function(){return(new this.constructor).copy(this)},
toJSON:function(){var a={};0!==this.bias&&(a.bias=this.bias);1!==this.radius&&(a.radius=this.radius);if(512!==this.mapSize.x||512!==this.mapSize.y)a.mapSize=this.mapSize.toArray();a.camera=this.camera.toJSON(!1).object;delete a.camera.matrix;return a}});zd.prototype=Object.assign(Object.create(Db.prototype),{constructor:zd,isSpotLightShadow:!0,update:function(a){var b=this.camera,c=2*G.RAD2DEG*a.angle,d=this.mapSize.width/this.mapSize.height;a=a.distance||b.far;if(c!==b.fov||d!==b.aspect||a!==b.far)b.fov=
c,b.aspect=d,b.far=a,b.updateProjectionMatrix()}});Ad.prototype=Object.assign(Object.create(X.prototype),{constructor:Ad,isSpotLight:!0,copy:function(a){X.prototype.copy.call(this,a);this.distance=a.distance;this.angle=a.angle;this.penumbra=a.penumbra;this.decay=a.decay;this.target=a.target.clone();this.shadow=a.shadow.clone();return this}});Bd.prototype=Object.assign(Object.create(X.prototype),{constructor:Bd,isPointLight:!0,copy:function(a){X.prototype.copy.call(this,a);this.distance=a.distance;
this.decay=a.decay;this.shadow=a.shadow.clone();return this}});Cd.prototype=Object.assign(Object.create(Db.prototype),{constructor:Cd});Dd.prototype=Object.assign(Object.create(X.prototype),{constructor:Dd,isDirectionalLight:!0,copy:function(a){X.prototype.copy.call(this,a);this.target=a.target.clone();this.shadow=a.shadow.clone();return this}});Ed.prototype=Object.assign(Object.create(X.prototype),{constructor:Ed,isAmbientLight:!0});Fd.prototype=Object.assign(Object.create(X.prototype),{constructor:Fd,
isRectAreaLight:!0,copy:function(a){X.prototype.copy.call(this,a);this.width=a.width;this.height=a.height;return this},toJSON:function(a){a=X.prototype.toJSON.call(this,a);a.object.width=this.width;a.object.height=this.height;return a}});var ia={arraySlice:function(a,b,c){return ia.isTypedArray(a)?new a.constructor(a.subarray(b,void 0!==c?c:a.length)):a.slice(b,c)},convertArray:function(a,b,c){return!a||!c&&a.constructor===b?a:"number"===typeof b.BYTES_PER_ELEMENT?new b(a):Array.prototype.slice.call(a)},
isTypedArray:function(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)},getKeyframeOrder:function(a){for(var b=a.length,c=Array(b),d=0;d!==b;++d)c[d]=d;c.sort(function(b,c){return a[b]-a[c]});return c},sortedArray:function(a,b,c){for(var d=a.length,e=new a.constructor(d),f=0,g=0;g!==d;++f)for(var h=c[f]*b,k=0;k!==b;++k)e[g++]=a[h+k];return e},flattenJSON:function(a,b,c,d){for(var e=1,f=a[0];void 0!==f&&void 0===f[d];)f=a[e++];if(void 0!==f){var g=f[d];if(void 0!==g)if(Array.isArray(g)){do g=
f[d],void 0!==g&&(b.push(f.time),c.push.apply(c,g)),f=a[e++];while(void 0!==f)}else if(void 0!==g.toArray){do g=f[d],void 0!==g&&(b.push(f.time),g.toArray(c,c.length)),f=a[e++];while(void 0!==f)}else{do g=f[d],void 0!==g&&(b.push(f.time),c.push(g)),f=a[e++];while(void 0!==f)}}}};Object.assign(wa.prototype,{evaluate:function(a){var b=this.parameterPositions,c=this._cachedIndex,d=b[c],e=b[c-1];a:{b:{c:{d:if(!(a<d)){for(var f=c+2;;){if(void 0===d){if(a<e)break d;this._cachedIndex=c=b.length;return this.afterEnd_(c-
1,a,e)}if(c===f)break;e=d;d=b[++c];if(a<d)break b}d=b.length;break c}if(a>=e)break a;else{f=b[1];a<f&&(c=2,e=f);for(f=c-2;;){if(void 0===e)return this._cachedIndex=0,this.beforeStart_(0,a,d);if(c===f)break;d=e;e=b[--c-1];if(a>=e)break b}d=c;c=0}}for(;c<d;)e=c+d>>>1,a<b[e]?d=e:c=e+1;d=b[c];e=b[c-1];if(void 0===e)return this._cachedIndex=0,this.beforeStart_(0,a,d);if(void 0===d)return this._cachedIndex=c=b.length,this.afterEnd_(c-1,e,a)}this._cachedIndex=c;this.intervalChanged_(c,e,d)}return this.interpolate_(c,
e,a,d)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(a){var b=this.resultBuffer,c=this.sampleValues,d=this.valueSize;a*=d;for(var e=0;e!==d;++e)b[e]=c[a+e];return b},interpolate_:function(){throw Error("call to abstract method");},intervalChanged_:function(){}});Object.assign(wa.prototype,{beforeStart_:wa.prototype.copySampleValue_,afterEnd_:wa.prototype.copySampleValue_});Gd.prototype=Object.assign(Object.create(wa.prototype),
{constructor:Gd,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(a,b,c){var d=this.parameterPositions,e=a-2,f=a+1,g=d[e],h=d[f];if(void 0===g)switch(this.getSettings_().endingStart){case 2401:e=a;g=2*b-c;break;case 2402:e=d.length-2;g=b+d[e]-d[e+1];break;default:e=a,g=c}if(void 0===h)switch(this.getSettings_().endingEnd){case 2401:f=a;h=2*c-b;break;case 2402:f=1;h=c+d[1]-d[0];break;default:f=a-1,h=b}a=.5*(c-b);d=this.valueSize;this._weightPrev=a/(b-g);this._weightNext=
a/(h-c);this._offsetPrev=e*d;this._offsetNext=f*d},interpolate_:function(a,b,c,d){var e=this.resultBuffer,f=this.sampleValues,g=this.valueSize;a*=g;var h=a-g,k=this._offsetPrev,m=this._offsetNext,l=this._weightPrev,n=this._weightNext,p=(c-b)/(d-b);c=p*p;d=c*p;b=-l*d+2*l*c-l*p;l=(1+l)*d+(-1.5-2*l)*c+(-.5+l)*p+1;p=(-1-n)*d+(1.5+n)*c+.5*p;n=n*d-n*c;for(c=0;c!==g;++c)e[c]=b*f[k+c]+l*f[h+c]+p*f[a+c]+n*f[m+c];return e}});dd.prototype=Object.assign(Object.create(wa.prototype),{constructor:dd,interpolate_:function(a,
b,c,d){var e=this.resultBuffer,f=this.sampleValues,g=this.valueSize;a*=g;var h=a-g;b=(c-b)/(d-b);c=1-b;for(d=0;d!==g;++d)e[d]=f[h+d]*c+f[a+d]*b;return e}});Hd.prototype=Object.assign(Object.create(wa.prototype),{constructor:Hd,interpolate_:function(a){return this.copySampleValue_(a-1)}});Object.assign(oa,{toJSON:function(a){var b=a.constructor;if(void 0!==b.toJSON)b=b.toJSON(a);else{b={name:a.name,times:ia.convertArray(a.times,Array),values:ia.convertArray(a.values,Array)};var c=a.getInterpolation();
c!==a.DefaultInterpolation&&(b.interpolation=c)}b.type=a.ValueTypeName;return b}});Object.assign(oa.prototype,{constructor:oa,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(a){return new Hd(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodLinear:function(a){return new dd(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodSmooth:function(a){return new Gd(this.times,this.values,this.getValueSize(),
a)},setInterpolation:function(a){switch(a){case 2300:var b=this.InterpolantFactoryMethodDiscrete;break;case 2301:b=this.InterpolantFactoryMethodLinear;break;case 2302:b=this.InterpolantFactoryMethodSmooth}if(void 0===b){b="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant)if(a!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(b);console.warn("THREE.KeyframeTrack:",b);return this}this.createInterpolant=
b;return this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(a){if(0!==a)for(var b=this.times,c=0,d=b.length;c!==d;++c)b[c]+=a;return this},scale:function(a){if(1!==a)for(var b=this.times,c=0,d=b.length;c!==d;++c)b[c]*=a;return this},trim:function(a,
b){for(var c=this.times,d=c.length,e=0,f=d-1;e!==d&&c[e]<a;)++e;for(;-1!==f&&c[f]>b;)--f;++f;if(0!==e||f!==d)e>=f&&(f=Math.max(f,1),e=f-1),a=this.getValueSize(),this.times=ia.arraySlice(c,e,f),this.values=ia.arraySlice(this.values,e*a,f*a);return this},validate:function(){var a=!0,b=this.getValueSize();0!==b-Math.floor(b)&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),a=!1);var c=this.times;b=this.values;var d=c.length;0===d&&(console.error("THREE.KeyframeTrack: Track is empty.",
this),a=!1);for(var e=null,f=0;f!==d;f++){var g=c[f];if("number"===typeof g&&isNaN(g)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,f,g);a=!1;break}if(null!==e&&e>g){console.error("THREE.KeyframeTrack: Out of order keys.",this,f,g,e);a=!1;break}e=g}if(void 0!==b&&ia.isTypedArray(b))for(f=0,c=b.length;f!==c;++f)if(d=b[f],isNaN(d)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,f,d);a=!1;break}return a},optimize:function(){for(var a=this.times,b=this.values,
c=this.getValueSize(),d=2302===this.getInterpolation(),e=1,f=a.length-1,g=1;g<f;++g){var h=!1,k=a[g];if(k!==a[g+1]&&(1!==g||k!==k[0]))if(d)h=!0;else{var m=g*c,l=m-c,n=m+c;for(k=0;k!==c;++k){var p=b[m+k];if(p!==b[l+k]||p!==b[n+k]){h=!0;break}}}if(h){if(g!==e)for(a[e]=a[g],h=g*c,m=e*c,k=0;k!==c;++k)b[m+k]=b[h+k];++e}}if(0<f){a[e]=a[f];h=f*c;m=e*c;for(k=0;k!==c;++k)b[m+k]=b[h+k];++e}e!==a.length&&(this.times=ia.arraySlice(a,0,e),this.values=ia.arraySlice(b,0,e*c));return this}});Id.prototype=Object.assign(Object.create(oa.prototype),
{constructor:Id,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});Jd.prototype=Object.assign(Object.create(oa.prototype),{constructor:Jd,ValueTypeName:"color"});fc.prototype=Object.assign(Object.create(oa.prototype),{constructor:fc,ValueTypeName:"number"});Kd.prototype=Object.assign(Object.create(wa.prototype),{constructor:Kd,interpolate_:function(a,b,c,d){var e=this.resultBuffer,f=this.sampleValues,g=
this.valueSize;a*=g;b=(c-b)/(d-b);for(c=a+g;a!==c;a+=4)fa.slerpFlat(e,0,f,a-g,f,a,b);return e}});ed.prototype=Object.assign(Object.create(oa.prototype),{constructor:ed,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(a){return new Kd(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodSmooth:void 0});Ld.prototype=Object.assign(Object.create(oa.prototype),{constructor:Ld,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,
InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});gc.prototype=Object.assign(Object.create(oa.prototype),{constructor:gc,ValueTypeName:"vector"});Object.assign(Ca,{parse:function(a){for(var b=[],c=a.tracks,d=1/(a.fps||1),e=0,f=c.length;e!==f;++e)b.push(Zg(c[e]).scale(d));return new Ca(a.name,a.duration,b)},toJSON:function(a){var b=[],c=a.tracks;a={name:a.name,duration:a.duration,tracks:b,uuid:a.uuid};for(var d=0,e=c.length;d!==e;++d)b.push(oa.toJSON(c[d]));return a},CreateFromMorphTargetSequence:function(a,
b,c,d){for(var e=b.length,f=[],g=0;g<e;g++){var h=[],k=[];h.push((g+e-1)%e,g,(g+1)%e);k.push(0,1,0);var m=ia.getKeyframeOrder(h);h=ia.sortedArray(h,1,m);k=ia.sortedArray(k,1,m);d||0!==h[0]||(h.push(e),k.push(k[0]));f.push((new fc(".morphTargetInfluences["+b[g].name+"]",h,k)).scale(1/c))}return new Ca(a,-1,f)},findByName:function(a,b){var c=a;Array.isArray(a)||(c=a.geometry&&a.geometry.animations||a.animations);for(a=0;a<c.length;a++)if(c[a].name===b)return c[a];return null},CreateClipsFromMorphTargetSequences:function(a,
b,c){for(var d={},e=/^([\w-]*?)([\d]+)$/,f=0,g=a.length;f<g;f++){var h=a[f],k=h.name.match(e);if(k&&1<k.length){var m=k[1];(k=d[m])||(d[m]=k=[]);k.push(h)}}a=[];for(m in d)a.push(Ca.CreateFromMorphTargetSequence(m,d[m],b,c));return a},parseAnimation:function(a,b){if(!a)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;var c=function(a,b,c,d,e){if(0!==c.length){var f=[],g=[];ia.flattenJSON(c,f,g,d);0!==f.length&&e.push(new a(b,f,g))}},d=[],e=a.name||"default",f=a.length||
-1,g=a.fps||30;a=a.hierarchy||[];for(var h=0;h<a.length;h++){var k=a[h].keys;if(k&&0!==k.length)if(k[0].morphTargets){f={};for(var m=0;m<k.length;m++)if(k[m].morphTargets)for(var l=0;l<k[m].morphTargets.length;l++)f[k[m].morphTargets[l]]=-1;for(var n in f){var p=[],w=[];for(l=0;l!==k[m].morphTargets.length;++l){var t=k[m];p.push(t.time);w.push(t.morphTarget===n?1:0)}d.push(new fc(".morphTargetInfluence["+n+"]",p,w))}f=f.length*(g||1)}else m=".bones["+b[h].name+"]",c(gc,m+".position",k,"pos",d),c(ed,
m+".quaternion",k,"rot",d),c(gc,m+".scale",k,"scl",d)}return 0===d.length?null:new Ca(e,f,d)}});Object.assign(Ca.prototype,{resetDuration:function(){for(var a=0,b=0,c=this.tracks.length;b!==c;++b){var d=this.tracks[b];a=Math.max(a,d.times[d.times.length-1])}this.duration=a;return this},trim:function(){for(var a=0;a<this.tracks.length;a++)this.tracks[a].trim(0,this.duration);return this},validate:function(){for(var a=!0,b=0;b<this.tracks.length;b++)a=a&&this.tracks[b].validate();return a},optimize:function(){for(var a=
0;a<this.tracks.length;a++)this.tracks[a].optimize();return this}});Object.assign(Md.prototype,{load:function(a,b,c,d){var e=this;(new Ga(e.manager)).load(a,function(a){b(e.parse(JSON.parse(a)))},c,d)},setTextures:function(a){this.textures=a},parse:function(a){function b(a){void 0===c[a]&&console.warn("THREE.MaterialLoader: Undefined texture",a);return c[a]}var c=this.textures,d=new bh[a.type];void 0!==a.uuid&&(d.uuid=a.uuid);void 0!==a.name&&(d.name=a.name);void 0!==a.color&&d.color.setHex(a.color);
void 0!==a.roughness&&(d.roughness=a.roughness);void 0!==a.metalness&&(d.metalness=a.metalness);void 0!==a.emissive&&d.emissive.setHex(a.emissive);void 0!==a.specular&&d.specular.setHex(a.specular);void 0!==a.shininess&&(d.shininess=a.shininess);void 0!==a.clearCoat&&(d.clearCoat=a.clearCoat);void 0!==a.clearCoatRoughness&&(d.clearCoatRoughness=a.clearCoatRoughness);void 0!==a.uniforms&&(d.uniforms=a.uniforms);void 0!==a.vertexShader&&(d.vertexShader=a.vertexShader);void 0!==a.fragmentShader&&(d.fragmentShader=
a.fragmentShader);void 0!==a.vertexColors&&(d.vertexColors=a.vertexColors);void 0!==a.fog&&(d.fog=a.fog);void 0!==a.flatShading&&(d.flatShading=a.flatShading);void 0!==a.blending&&(d.blending=a.blending);void 0!==a.side&&(d.side=a.side);void 0!==a.opacity&&(d.opacity=a.opacity);void 0!==a.transparent&&(d.transparent=a.transparent);void 0!==a.alphaTest&&(d.alphaTest=a.alphaTest);void 0!==a.depthTest&&(d.depthTest=a.depthTest);void 0!==a.depthWrite&&(d.depthWrite=a.depthWrite);void 0!==a.colorWrite&&
(d.colorWrite=a.colorWrite);void 0!==a.wireframe&&(d.wireframe=a.wireframe);void 0!==a.wireframeLinewidth&&(d.wireframeLinewidth=a.wireframeLinewidth);void 0!==a.wireframeLinecap&&(d.wireframeLinecap=a.wireframeLinecap);void 0!==a.wireframeLinejoin&&(d.wireframeLinejoin=a.wireframeLinejoin);void 0!==a.rotation&&(d.rotation=a.rotation);1!==a.linewidth&&(d.linewidth=a.linewidth);void 0!==a.dashSize&&(d.dashSize=a.dashSize);void 0!==a.gapSize&&(d.gapSize=a.gapSize);void 0!==a.scale&&(d.scale=a.scale);
void 0!==a.polygonOffset&&(d.polygonOffset=a.polygonOffset);void 0!==a.polygonOffsetFactor&&(d.polygonOffsetFactor=a.polygonOffsetFactor);void 0!==a.polygonOffsetUnits&&(d.polygonOffsetUnits=a.polygonOffsetUnits);void 0!==a.skinning&&(d.skinning=a.skinning);void 0!==a.morphTargets&&(d.morphTargets=a.morphTargets);void 0!==a.dithering&&(d.dithering=a.dithering);void 0!==a.visible&&(d.visible=a.visible);void 0!==a.userData&&(d.userData=a.userData);void 0!==a.shading&&(d.flatShading=1===a.shading);void 0!==
a.size&&(d.size=a.size);void 0!==a.sizeAttenuation&&(d.sizeAttenuation=a.sizeAttenuation);void 0!==a.map&&(d.map=b(a.map));void 0!==a.alphaMap&&(d.alphaMap=b(a.alphaMap),d.transparent=!0);void 0!==a.bumpMap&&(d.bumpMap=b(a.bumpMap));void 0!==a.bumpScale&&(d.bumpScale=a.bumpScale);void 0!==a.normalMap&&(d.normalMap=b(a.normalMap));void 0!==a.normalMapType&&(d.normalMapType=a.normalMapType);if(void 0!==a.normalScale){var e=a.normalScale;!1===Array.isArray(e)&&(e=[e,e]);d.normalScale=(new A).fromArray(e)}void 0!==
a.displacementMap&&(d.displacementMap=b(a.displacementMap));void 0!==a.displacementScale&&(d.displacementScale=a.displacementScale);void 0!==a.displacementBias&&(d.displacementBias=a.displacementBias);void 0!==a.roughnessMap&&(d.roughnessMap=b(a.roughnessMap));void 0!==a.metalnessMap&&(d.metalnessMap=b(a.metalnessMap));void 0!==a.emissiveMap&&(d.emissiveMap=b(a.emissiveMap));void 0!==a.emissiveIntensity&&(d.emissiveIntensity=a.emissiveIntensity);void 0!==a.specularMap&&(d.specularMap=b(a.specularMap));
void 0!==a.envMap&&(d.envMap=b(a.envMap));void 0!==a.reflectivity&&(d.reflectivity=a.reflectivity);void 0!==a.lightMap&&(d.lightMap=b(a.lightMap));void 0!==a.lightMapIntensity&&(d.lightMapIntensity=a.lightMapIntensity);void 0!==a.aoMap&&(d.aoMap=b(a.aoMap));void 0!==a.aoMapIntensity&&(d.aoMapIntensity=a.aoMapIntensity);void 0!==a.gradientMap&&(d.gradientMap=b(a.gradientMap));return d}});Object.assign(he.prototype,{load:function(a,b,c,d){var e=this;(new Ga(e.manager)).load(a,function(a){b(e.parse(JSON.parse(a)))},
c,d)},parse:function(a){var b=new C,c=a.data.index;void 0!==c&&(c=new Gf[c.type](c.array),b.setIndex(new Q(c,1)));var d=a.data.attributes;for(f in d){var e=d[f];c=new Gf[e.type](e.array);b.addAttribute(f,new Q(c,e.itemSize,e.normalized))}var f=a.data.groups||a.data.drawcalls||a.data.offsets;if(void 0!==f)for(c=0,d=f.length;c!==d;++c)e=f[c],b.addGroup(e.start,e.count,e.materialIndex);a=a.data.boundingSphere;void 0!==a&&(f=new p,void 0!==a.center&&f.fromArray(a.center),b.boundingSphere=new Da(f,a.radius));
return b}});var Gf={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!==typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};hc.Handlers={handlers:[],add:function(a,b){this.handlers.push(a,b)},get:function(a){for(var b=this.handlers,c=0,d=b.length;c<d;c+=2){var e=b[c+1];if(b[c].test(a))return e}return null}};Object.assign(hc.prototype,
{crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(a,b,c){for(var d=[],e=0;e<a.length;++e)d[e]=this.createMaterial(a[e],b,c);return d},createMaterial:function(){var a={NoBlending:0,NormalBlending:1,AdditiveBlending:2,SubtractiveBlending:3,MultiplyBlending:4,CustomBlending:5},b=new H,c=new xd,d=new Md;return function(e,f,g){function h(a,b,d,e,h){a=f+a;var m=hc.Handlers.get(a);null!==m?a=m.load(a):(c.setCrossOrigin(g),a=c.load(a));
void 0!==b&&(a.repeat.fromArray(b),1!==b[0]&&(a.wrapS=1E3),1!==b[1]&&(a.wrapT=1E3));void 0!==d&&a.offset.fromArray(d);void 0!==e&&("repeat"===e[0]&&(a.wrapS=1E3),"mirror"===e[0]&&(a.wrapS=1002),"repeat"===e[1]&&(a.wrapT=1E3),"mirror"===e[1]&&(a.wrapT=1002));void 0!==h&&(a.anisotropy=h);b=G.generateUUID();k[b]=a;return b}var k={},m={uuid:G.generateUUID(),type:"MeshLambertMaterial"},l;for(l in e){var n=e[l];switch(l){case "DbgColor":case "DbgIndex":case "opticalDensity":case "illumination":break;case "DbgName":m.name=
n;break;case "blending":m.blending=a[n];break;case "colorAmbient":case "mapAmbient":console.warn("THREE.Loader.createMaterial:",l,"is no longer supported.");break;case "colorDiffuse":m.color=b.fromArray(n).getHex();break;case "colorSpecular":m.specular=b.fromArray(n).getHex();break;case "colorEmissive":m.emissive=b.fromArray(n).getHex();break;case "specularCoef":m.shininess=n;break;case "shading":"basic"===n.toLowerCase()&&(m.type="MeshBasicMaterial");"phong"===n.toLowerCase()&&(m.type="MeshPhongMaterial");
"standard"===n.toLowerCase()&&(m.type="MeshStandardMaterial");break;case "mapDiffuse":m.map=h(n,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy);break;case "mapDiffuseRepeat":case "mapDiffuseOffset":case "mapDiffuseWrap":case "mapDiffuseAnisotropy":break;case "mapEmissive":m.emissiveMap=h(n,e.mapEmissiveRepeat,e.mapEmissiveOffset,e.mapEmissiveWrap,e.mapEmissiveAnisotropy);break;case "mapEmissiveRepeat":case "mapEmissiveOffset":case "mapEmissiveWrap":case "mapEmissiveAnisotropy":break;
case "mapLight":m.lightMap=h(n,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy);break;case "mapLightRepeat":case "mapLightOffset":case "mapLightWrap":case "mapLightAnisotropy":break;case "mapAO":m.aoMap=h(n,e.mapAORepeat,e.mapAOOffset,e.mapAOWrap,e.mapAOAnisotropy);break;case "mapAORepeat":case "mapAOOffset":case "mapAOWrap":case "mapAOAnisotropy":break;case "mapBump":m.bumpMap=h(n,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy);break;case "mapBumpScale":m.bumpScale=
n;break;case "mapBumpRepeat":case "mapBumpOffset":case "mapBumpWrap":case "mapBumpAnisotropy":break;case "mapNormal":m.normalMap=h(n,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy);break;case "mapNormalFactor":m.normalScale=n;break;case "mapNormalRepeat":case "mapNormalOffset":case "mapNormalWrap":case "mapNormalAnisotropy":break;case "mapSpecular":m.specularMap=h(n,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy);break;case "mapSpecularRepeat":case "mapSpecularOffset":case "mapSpecularWrap":case "mapSpecularAnisotropy":break;
case "mapMetalness":m.metalnessMap=h(n,e.mapMetalnessRepeat,e.mapMetalnessOffset,e.mapMetalnessWrap,e.mapMetalnessAnisotropy);break;case "mapMetalnessRepeat":case "mapMetalnessOffset":case "mapMetalnessWrap":case "mapMetalnessAnisotropy":break;case "mapRoughness":m.roughnessMap=h(n,e.mapRoughnessRepeat,e.mapRoughnessOffset,e.mapRoughnessWrap,e.mapRoughnessAnisotropy);break;case "mapRoughnessRepeat":case "mapRoughnessOffset":case "mapRoughnessWrap":case "mapRoughnessAnisotropy":break;case "mapAlpha":m.alphaMap=
h(n,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy);break;case "mapAlphaRepeat":case "mapAlphaOffset":case "mapAlphaWrap":case "mapAlphaAnisotropy":break;case "flipSided":m.side=1;break;case "doubleSided":m.side=2;break;case "transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity");m.opacity=n;break;case "depthTest":case "depthWrite":case "colorWrite":case "opacity":case "reflectivity":case "transparent":case "visible":case "wireframe":m[l]=
n;break;case "vertexColors":!0===n&&(m.vertexColors=2);"face"===n&&(m.vertexColors=1);break;default:console.error("THREE.Loader.createMaterial: Unsupported",l,n)}}"MeshBasicMaterial"===m.type&&delete m.emissive;"MeshPhongMaterial"!==m.type&&delete m.specular;1>m.opacity&&(m.transparent=!0);d.setTextures(k);return d.parse(m)}}()});var Ee={decodeText:function(a){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(a);for(var b="",c=0,d=a.length;c<d;c++)b+=String.fromCharCode(a[c]);return decodeURIComponent(escape(b))},
extractUrlBase:function(a){var b=a.lastIndexOf("/");return-1===b?"./":a.substr(0,b+1)}};Object.assign(ie.prototype,{crossOrigin:"anonymous",load:function(a,b,c,d){var e=this,f=this.texturePath&&"string"===typeof this.texturePath?this.texturePath:Ee.extractUrlBase(a),g=new Ga(this.manager);g.setWithCredentials(this.withCredentials);g.load(a,function(c){c=JSON.parse(c);var d=c.metadata;if(void 0!==d&&(d=d.type,void 0!==d&&"object"===d.toLowerCase())){console.error("THREE.JSONLoader: "+a+" should be loaded with THREE.ObjectLoader instead.");
return}c=e.parse(c,f);b(c.geometry,c.materials)},c,d)},setCrossOrigin:function(a){this.crossOrigin=a;return this},setTexturePath:function(a){this.texturePath=a;return this},parse:function(){return function(a,b){void 0!==a.data&&(a=a.data);a.scale=void 0!==a.scale?1/a.scale:1;var c=new R,d=a,e,f,g,h=d.faces;var k=d.vertices;var m=d.normals,l=d.colors;var n=d.scale;var r=0;if(void 0!==d.uvs){for(e=0;e<d.uvs.length;e++)d.uvs[e].length&&r++;for(e=0;e<r;e++)c.faceVertexUvs[e]=[]}var w=0;for(g=k.length;w<
g;)e=new p,e.x=k[w++]*n,e.y=k[w++]*n,e.z=k[w++]*n,c.vertices.push(e);w=0;for(g=h.length;w<g;){k=h[w++];var t=k&1;var u=k&2;e=k&8;var x=k&16;var y=k&32;n=k&64;k&=128;if(t){t=new Ta;t.a=h[w];t.b=h[w+1];t.c=h[w+3];var v=new Ta;v.a=h[w+1];v.b=h[w+2];v.c=h[w+3];w+=4;u&&(u=h[w++],t.materialIndex=u,v.materialIndex=u);u=c.faces.length;if(e)for(e=0;e<r;e++){var B=d.uvs[e];c.faceVertexUvs[e][u]=[];c.faceVertexUvs[e][u+1]=[];for(f=0;4>f;f++){var z=h[w++];var C=B[2*z];z=B[2*z+1];C=new A(C,z);2!==f&&c.faceVertexUvs[e][u].push(C);
0!==f&&c.faceVertexUvs[e][u+1].push(C)}}x&&(x=3*h[w++],t.normal.set(m[x++],m[x++],m[x]),v.normal.copy(t.normal));if(y)for(e=0;4>e;e++)x=3*h[w++],y=new p(m[x++],m[x++],m[x]),2!==e&&t.vertexNormals.push(y),0!==e&&v.vertexNormals.push(y);n&&(n=h[w++],n=l[n],t.color.setHex(n),v.color.setHex(n));if(k)for(e=0;4>e;e++)n=h[w++],n=l[n],2!==e&&t.vertexColors.push(new H(n)),0!==e&&v.vertexColors.push(new H(n));c.faces.push(t);c.faces.push(v)}else{t=new Ta;t.a=h[w++];t.b=h[w++];t.c=h[w++];u&&(u=h[w++],t.materialIndex=
u);u=c.faces.length;if(e)for(e=0;e<r;e++)for(B=d.uvs[e],c.faceVertexUvs[e][u]=[],f=0;3>f;f++)z=h[w++],C=B[2*z],z=B[2*z+1],C=new A(C,z),c.faceVertexUvs[e][u].push(C);x&&(x=3*h[w++],t.normal.set(m[x++],m[x++],m[x]));if(y)for(e=0;3>e;e++)x=3*h[w++],y=new p(m[x++],m[x++],m[x]),t.vertexNormals.push(y);n&&(n=h[w++],t.color.setHex(l[n]));if(k)for(e=0;3>e;e++)n=h[w++],t.vertexColors.push(new H(l[n]));c.faces.push(t)}}d=a;w=void 0!==d.influencesPerVertex?d.influencesPerVertex:2;if(d.skinWeights)for(g=0,h=
d.skinWeights.length;g<h;g+=w)c.skinWeights.push(new V(d.skinWeights[g],1<w?d.skinWeights[g+1]:0,2<w?d.skinWeights[g+2]:0,3<w?d.skinWeights[g+3]:0));if(d.skinIndices)for(g=0,h=d.skinIndices.length;g<h;g+=w)c.skinIndices.push(new V(d.skinIndices[g],1<w?d.skinIndices[g+1]:0,2<w?d.skinIndices[g+2]:0,3<w?d.skinIndices[g+3]:0));c.bones=d.bones;c.bones&&0<c.bones.length&&(c.skinWeights.length!==c.skinIndices.length||c.skinIndices.length!==c.vertices.length)&&console.warn("When skinning, number of vertices ("+
c.vertices.length+"), skinIndices ("+c.skinIndices.length+"), and skinWeights ("+c.skinWeights.length+") should match.");g=a;h=g.scale;if(void 0!==g.morphTargets)for(d=0,w=g.morphTargets.length;d<w;d++)for(c.morphTargets[d]={},c.morphTargets[d].name=g.morphTargets[d].name,c.morphTargets[d].vertices=[],m=c.morphTargets[d].vertices,l=g.morphTargets[d].vertices,r=0,k=l.length;r<k;r+=3)n=new p,n.x=l[r]*h,n.y=l[r+1]*h,n.z=l[r+2]*h,m.push(n);if(void 0!==g.morphColors&&0<g.morphColors.length)for(console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.'),
h=c.faces,g=g.morphColors[0].colors,d=0,w=h.length;d<w;d++)h[d].color.fromArray(g,3*d);g=a;d=[];w=[];void 0!==g.animation&&w.push(g.animation);void 0!==g.animations&&(g.animations.length?w=w.concat(g.animations):w.push(g.animations));for(g=0;g<w.length;g++)(h=Ca.parseAnimation(w[g],c.bones))&&d.push(h);c.morphTargets&&(w=Ca.CreateClipsFromMorphTargetSequences(c.morphTargets,10),d=d.concat(w));0<d.length&&(c.animations=d);c.computeFaceNormals();c.computeBoundingSphere();if(void 0===a.materials||0===
a.materials.length)return{geometry:c};a=hc.prototype.initMaterials(a.materials,b,this.crossOrigin);return{geometry:c,materials:a}}}()});Object.assign(of.prototype,{crossOrigin:"anonymous",load:function(a,b,c,d){""===this.texturePath&&(this.texturePath=a.substring(0,a.lastIndexOf("/")+1));var e=this;(new Ga(e.manager)).load(a,function(c){var f=null;try{f=JSON.parse(c)}catch(h){void 0!==d&&d(h);console.error("THREE:ObjectLoader: Can't parse "+a+".",h.message);return}c=f.metadata;void 0===c||void 0===
c.type||"geometry"===c.type.toLowerCase()?console.error("THREE.ObjectLoader: Can't load "+a+". Use THREE.JSONLoader instead."):e.parse(f,b)},c,d)},setTexturePath:function(a){this.texturePath=a;return this},setCrossOrigin:function(a){this.crossOrigin=a;return this},parse:function(a,b){var c=this.parseShape(a.shapes);c=this.parseGeometries(a.geometries,c);var d=this.parseImages(a.images,function(){void 0!==b&&b(e)});d=this.parseTextures(a.textures,d);d=this.parseMaterials(a.materials,d);var e=this.parseObject(a.object,
c,d);a.animations&&(e.animations=this.parseAnimations(a.animations));void 0!==a.images&&0!==a.images.length||void 0===b||b(e);return e},parseShape:function(a){var b={};if(void 0!==a)for(var c=0,d=a.length;c<d;c++){var e=(new eb).fromJSON(a[c]);b[e.uuid]=e}return b},parseGeometries:function(a,b){var c={};if(void 0!==a)for(var d=new ie,e=new he,f=0,g=a.length;f<g;f++){var h=a[f];switch(h.type){case "PlaneGeometry":case "PlaneBufferGeometry":var k=new xa[h.type](h.width,h.height,h.widthSegments,h.heightSegments);
break;case "BoxGeometry":case "BoxBufferGeometry":case "CubeGeometry":k=new xa[h.type](h.width,h.height,h.depth,h.widthSegments,h.heightSegments,h.depthSegments);break;case "CircleGeometry":case "CircleBufferGeometry":k=new xa[h.type](h.radius,h.segments,h.thetaStart,h.thetaLength);break;case "CylinderGeometry":case "CylinderBufferGeometry":k=new xa[h.type](h.radiusTop,h.radiusBottom,h.height,h.radialSegments,h.heightSegments,h.openEnded,h.thetaStart,h.thetaLength);break;case "ConeGeometry":case "ConeBufferGeometry":k=
new xa[h.type](h.radius,h.height,h.radialSegments,h.heightSegments,h.openEnded,h.thetaStart,h.thetaLength);break;case "SphereGeometry":case "SphereBufferGeometry":k=new xa[h.type](h.radius,h.widthSegments,h.heightSegments,h.phiStart,h.phiLength,h.thetaStart,h.thetaLength);break;case "DodecahedronGeometry":case "DodecahedronBufferGeometry":case "IcosahedronGeometry":case "IcosahedronBufferGeometry":case "OctahedronGeometry":case "OctahedronBufferGeometry":case "TetrahedronGeometry":case "TetrahedronBufferGeometry":k=
new xa[h.type](h.radius,h.detail);break;case "RingGeometry":case "RingBufferGeometry":k=new xa[h.type](h.innerRadius,h.outerRadius,h.thetaSegments,h.phiSegments,h.thetaStart,h.thetaLength);break;case "TorusGeometry":case "TorusBufferGeometry":k=new xa[h.type](h.radius,h.tube,h.radialSegments,h.tubularSegments,h.arc);break;case "TorusKnotGeometry":case "TorusKnotBufferGeometry":k=new xa[h.type](h.radius,h.tube,h.tubularSegments,h.radialSegments,h.p,h.q);break;case "LatheGeometry":case "LatheBufferGeometry":k=
new xa[h.type](h.points,h.segments,h.phiStart,h.phiLength);break;case "PolyhedronGeometry":case "PolyhedronBufferGeometry":k=new xa[h.type](h.vertices,h.indices,h.radius,h.details);break;case "ShapeGeometry":case "ShapeBufferGeometry":k=[];for(var m=0,l=h.shapes.length;m<l;m++){var n=b[h.shapes[m]];k.push(n)}k=new xa[h.type](k,h.curveSegments);break;case "ExtrudeGeometry":case "ExtrudeBufferGeometry":k=[];m=0;for(l=h.shapes.length;m<l;m++)n=b[h.shapes[m]],k.push(n);m=h.options.extrudePath;void 0!==
m&&(h.options.extrudePath=(new Ff[m.type]).fromJSON(m));k=new xa[h.type](k,h.options);break;case "BufferGeometry":k=e.parse(h);break;case "Geometry":k=d.parse(h,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+h.type+'"');continue}k.uuid=h.uuid;void 0!==h.name&&(k.name=h.name);!0===k.isBufferGeometry&&void 0!==h.userData&&(k.userData=h.userData);c[h.uuid]=k}return c},parseMaterials:function(a,b){var c={};if(void 0!==a){var d=new Md;d.setTextures(b);
b=0;for(var e=a.length;b<e;b++){var f=a[b];if("MultiMaterial"===f.type){for(var g=[],h=0;h<f.materials.length;h++)g.push(d.parse(f.materials[h]));c[f.uuid]=g}else c[f.uuid]=d.parse(f)}}return c},parseAnimations:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=Ca.parse(d);void 0!==d.uuid&&(e.uuid=d.uuid);b.push(e)}return b},parseImages:function(a,b){function c(a){d.manager.itemStart(a);return f.load(a,function(){d.manager.itemEnd(a)},void 0,function(){d.manager.itemEnd(a);d.manager.itemError(a)})}
var d=this,e={};if(void 0!==a&&0<a.length){b=new de(b);var f=new ad(b);f.setCrossOrigin(this.crossOrigin);b=0;for(var g=a.length;b<g;b++){var h=a[b],k=h.url;if(Array.isArray(k)){e[h.uuid]=[];for(var m=0,l=k.length;m<l;m++){var n=k[m];n=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:d.texturePath+n;e[h.uuid].push(c(n))}}else n=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h.url)?h.url:d.texturePath+h.url,e[h.uuid]=c(n)}}return e},parseTextures:function(a,b){function c(a,b){if("number"===typeof a)return a;console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",
a);return b[a]}var d={};if(void 0!==a)for(var e=0,f=a.length;e<f;e++){var g=a[e];void 0===g.image&&console.warn('THREE.ObjectLoader: No "image" specified for',g.uuid);void 0===b[g.image]&&console.warn("THREE.ObjectLoader: Undefined image",g.image);var h=Array.isArray(b[g.image])?new Ua(b[g.image]):new T(b[g.image]);h.needsUpdate=!0;h.uuid=g.uuid;void 0!==g.name&&(h.name=g.name);void 0!==g.mapping&&(h.mapping=c(g.mapping,ch));void 0!==g.offset&&h.offset.fromArray(g.offset);void 0!==g.repeat&&h.repeat.fromArray(g.repeat);
void 0!==g.center&&h.center.fromArray(g.center);void 0!==g.rotation&&(h.rotation=g.rotation);void 0!==g.wrap&&(h.wrapS=c(g.wrap[0],Hf),h.wrapT=c(g.wrap[1],Hf));void 0!==g.format&&(h.format=g.format);void 0!==g.minFilter&&(h.minFilter=c(g.minFilter,If));void 0!==g.magFilter&&(h.magFilter=c(g.magFilter,If));void 0!==g.anisotropy&&(h.anisotropy=g.anisotropy);void 0!==g.flipY&&(h.flipY=g.flipY);d[g.uuid]=h}return d},parseObject:function(a,b,c){function d(a){void 0===b[a]&&console.warn("THREE.ObjectLoader: Undefined geometry",
a);return b[a]}function e(a){if(void 0!==a){if(Array.isArray(a)){for(var b=[],d=0,e=a.length;d<e;d++){var f=a[d];void 0===c[f]&&console.warn("THREE.ObjectLoader: Undefined material",f);b.push(c[f])}return b}void 0===c[a]&&console.warn("THREE.ObjectLoader: Undefined material",a);return c[a]}}switch(a.type){case "Scene":var f=new sd;void 0!==a.background&&Number.isInteger(a.background)&&(f.background=new H(a.background));void 0!==a.fog&&("Fog"===a.fog.type?f.fog=new Nb(a.fog.color,a.fog.near,a.fog.far):
"FogExp2"===a.fog.type&&(f.fog=new Mb(a.fog.color,a.fog.density)));break;case "PerspectiveCamera":f=new Z(a.fov,a.aspect,a.near,a.far);void 0!==a.focus&&(f.focus=a.focus);void 0!==a.zoom&&(f.zoom=a.zoom);void 0!==a.filmGauge&&(f.filmGauge=a.filmGauge);void 0!==a.filmOffset&&(f.filmOffset=a.filmOffset);void 0!==a.view&&(f.view=Object.assign({},a.view));break;case "OrthographicCamera":f=new Ib(a.left,a.right,a.top,a.bottom,a.near,a.far);void 0!==a.zoom&&(f.zoom=a.zoom);void 0!==a.view&&(f.view=Object.assign({},
a.view));break;case "AmbientLight":f=new Ed(a.color,a.intensity);break;case "DirectionalLight":f=new Dd(a.color,a.intensity);break;case "PointLight":f=new Bd(a.color,a.intensity,a.distance,a.decay);break;case "RectAreaLight":f=new Fd(a.color,a.intensity,a.width,a.height);break;case "SpotLight":f=new Ad(a.color,a.intensity,a.distance,a.angle,a.penumbra,a.decay);break;case "HemisphereLight":f=new yd(a.color,a.groundColor,a.intensity);break;case "SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");
case "Mesh":f=d(a.geometry);var g=e(a.material);f=f.bones&&0<f.bones.length?new ud(f,g):new ka(f,g);break;case "LOD":f=new Dc;break;case "Line":f=new sa(d(a.geometry),e(a.material),a.mode);break;case "LineLoop":f=new vd(d(a.geometry),e(a.material));break;case "LineSegments":f=new W(d(a.geometry),e(a.material));break;case "PointCloud":case "Points":f=new Pb(d(a.geometry),e(a.material));break;case "Sprite":f=new Cc(e(a.material));break;case "Group":f=new Lb;break;default:f=new D}f.uuid=a.uuid;void 0!==
a.name&&(f.name=a.name);void 0!==a.matrix?(f.matrix.fromArray(a.matrix),void 0!==a.matrixAutoUpdate&&(f.matrixAutoUpdate=a.matrixAutoUpdate),f.matrixAutoUpdate&&f.matrix.decompose(f.position,f.quaternion,f.scale)):(void 0!==a.position&&f.position.fromArray(a.position),void 0!==a.rotation&&f.rotation.fromArray(a.rotation),void 0!==a.quaternion&&f.quaternion.fromArray(a.quaternion),void 0!==a.scale&&f.scale.fromArray(a.scale));void 0!==a.castShadow&&(f.castShadow=a.castShadow);void 0!==a.receiveShadow&&
(f.receiveShadow=a.receiveShadow);a.shadow&&(void 0!==a.shadow.bias&&(f.shadow.bias=a.shadow.bias),void 0!==a.shadow.radius&&(f.shadow.radius=a.shadow.radius),void 0!==a.shadow.mapSize&&f.shadow.mapSize.fromArray(a.shadow.mapSize),void 0!==a.shadow.camera&&(f.shadow.camera=this.parseObject(a.shadow.camera)));void 0!==a.visible&&(f.visible=a.visible);void 0!==a.frustumCulled&&(f.frustumCulled=a.frustumCulled);void 0!==a.renderOrder&&(f.renderOrder=a.renderOrder);void 0!==a.userData&&(f.userData=a.userData);
void 0!==a.layers&&(f.layers.mask=a.layers);if(void 0!==a.children){g=a.children;for(var h=0;h<g.length;h++)f.add(this.parseObject(g[h],b,c))}if("LOD"===a.type)for(a=a.levels,g=0;g<a.length;g++){h=a[g];var k=f.getObjectByProperty("uuid",h.object);void 0!==k&&f.addLevel(k,h.distance)}return f}});var ch={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,
CubeUVRefractionMapping:307},Hf={RepeatWrapping:1E3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},If={NearestFilter:1003,NearestMipMapNearestFilter:1004,NearestMipMapLinearFilter:1005,LinearFilter:1006,LinearMipMapNearestFilter:1007,LinearMipMapLinearFilter:1008};je.prototype={constructor:je,setOptions:function(a){this.options=a;return this},load:function(a,b,c,d){void 0===a&&(a="");void 0!==this.path&&(a=this.path+a);a=this.manager.resolveURL(a);var e=this,f=Gb.get(a);if(void 0!==f)return e.manager.itemStart(a),
setTimeout(function(){b&&b(f);e.manager.itemEnd(a)},0),f;fetch(a).then(function(a){return a.blob()}).then(function(a){return createImageBitmap(a,e.options)}).then(function(c){Gb.add(a,c);b&&b(c);e.manager.itemEnd(a)}).catch(function(b){d&&d(b);e.manager.itemEnd(a);e.manager.itemError(a)})},setCrossOrigin:function(){return this},setPath:function(a){this.path=a;return this}};Object.assign(ke.prototype,{moveTo:function(a,b){this.currentPath=new La;this.subPaths.push(this.currentPath);this.currentPath.moveTo(a,
b)},lineTo:function(a,b){this.currentPath.lineTo(a,b)},quadraticCurveTo:function(a,b,c,d){this.currentPath.quadraticCurveTo(a,b,c,d)},bezierCurveTo:function(a,b,c,d,e,f){this.currentPath.bezierCurveTo(a,b,c,d,e,f)},splineThru:function(a){this.currentPath.splineThru(a)},toShapes:function(a,b){function c(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c],f=new eb;f.curves=e.curves;b.push(f)}return b}function d(a,b){for(var c=b.length,d=!1,e=c-1,f=0;f<c;e=f++){var g=b[e],h=b[f],k=h.x-g.x,l=h.y-g.y;if(Math.abs(l)>
Number.EPSILON){if(0>l&&(g=b[f],k=-k,h=b[e],l=-l),!(a.y<g.y||a.y>h.y))if(a.y===g.y){if(a.x===g.x)return!0}else{e=l*(a.x-g.x)-k*(a.y-g.y);if(0===e)return!0;0>e||(d=!d)}}else if(a.y===g.y&&(h.x<=a.x&&a.x<=g.x||g.x<=a.x&&a.x<=h.x))return!0}return d}var e=Wa.isClockWise,f=this.subPaths;if(0===f.length)return[];if(!0===b)return c(f);b=[];if(1===f.length){var g=f[0];var h=new eb;h.curves=g.curves;b.push(h);return b}var k=!e(f[0].getPoints());k=a?!k:k;h=[];var l=[],p=[],n=0;l[n]=void 0;p[n]=[];for(var r=
0,w=f.length;r<w;r++){g=f[r];var t=g.getPoints();var u=e(t);(u=a?!u:u)?(!k&&l[n]&&n++,l[n]={s:new eb,p:t},l[n].s.curves=g.curves,k&&n++,p[n]=[]):p[n].push({h:g,p:t[0]})}if(!l[0])return c(f);if(1<l.length){r=!1;a=[];e=0;for(f=l.length;e<f;e++)h[e]=[];e=0;for(f=l.length;e<f;e++)for(g=p[e],u=0;u<g.length;u++){k=g[u];n=!0;for(t=0;t<l.length;t++)d(k.p,l[t].p)&&(e!==t&&a.push({froms:e,tos:t,hole:u}),n?(n=!1,h[t].push(k)):r=!0);n&&h[e].push(k)}0<a.length&&(r||(p=h))}r=0;for(e=l.length;r<e;r++)for(h=l[r].s,
b.push(h),a=p[r],f=0,g=a.length;f<g;f++)h.holes.push(a[f].h);return b}});Object.assign(le.prototype,{isFont:!0,generateShapes:function(a,b){void 0===b&&(b=100);var c=[],d=b;b=this.data;var e=Array.from?Array.from(a):String(a).split("");d/=b.resolution;var f=(b.boundingBox.yMax-b.boundingBox.yMin+b.underlineThickness)*d;a=[];for(var g=0,h=0,k=0;k<e.length;k++){var l=e[k];if("\n"===l)g=0,h-=f;else{var p=d;var n=g,r=h;if(l=b.glyphs[l]||b.glyphs["?"]){var w=new ke;if(l.o)for(var t=l._cachedOutline||(l._cachedOutline=
l.o.split(" ")),u=0,x=t.length;u<x;)switch(t[u++]){case "m":var y=t[u++]*p+n;var v=t[u++]*p+r;w.moveTo(y,v);break;case "l":y=t[u++]*p+n;v=t[u++]*p+r;w.lineTo(y,v);break;case "q":var z=t[u++]*p+n;var A=t[u++]*p+r;var C=t[u++]*p+n;var D=t[u++]*p+r;w.quadraticCurveTo(C,D,z,A);break;case "b":z=t[u++]*p+n,A=t[u++]*p+r,C=t[u++]*p+n,D=t[u++]*p+r,y=t[u++]*p+n,v=t[u++]*p+r,w.bezierCurveTo(C,D,y,v,z,A)}p={offsetX:l.ha*p,path:w}}else p=void 0;g+=p.offsetX;a.push(p.path)}}b=0;for(e=a.length;b<e;b++)Array.prototype.push.apply(c,
a[b].toShapes());return c}});Object.assign(pf.prototype,{load:function(a,b,c,d){var e=this,f=new Ga(this.manager);f.setPath(this.path);f.load(a,function(a){try{var c=JSON.parse(a)}catch(k){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),c=JSON.parse(a.substring(65,a.length-2))}a=e.parse(c);b&&b(a)},c,d)},parse:function(a){return new le(a)},setPath:function(a){this.path=a;return this}});var Rd,oe={getContext:function(){void 0===Rd&&(Rd=new (window.AudioContext||
window.webkitAudioContext));return Rd},setContext:function(a){Rd=a}};Object.assign(me.prototype,{load:function(a,b,c,d){var e=new Ga(this.manager);e.setResponseType("arraybuffer");e.load(a,function(a){a=a.slice(0);oe.getContext().decodeAudioData(a,function(a){b(a)})},c,d)}});Object.assign(qf.prototype,{update:function(){var a,b,c,d,e,f,g,h,k=new J,l=new J;return function(m){if(a!==this||b!==m.focus||c!==m.fov||d!==m.aspect*this.aspect||e!==m.near||f!==m.far||g!==m.zoom||h!==this.eyeSep){a=this;b=
m.focus;c=m.fov;d=m.aspect*this.aspect;e=m.near;f=m.far;g=m.zoom;var n=m.projectionMatrix.clone();h=this.eyeSep/2;var p=h*e/b,q=e*Math.tan(G.DEG2RAD*c*.5)/g;l.elements[12]=-h;k.elements[12]=h;var t=-q*d+p;var u=q*d+p;n.elements[0]=2*e/(u-t);n.elements[8]=(u+t)/(u-t);this.cameraL.projectionMatrix.copy(n);t=-q*d-p;u=q*d-p;n.elements[0]=2*e/(u-t);n.elements[8]=(u+t)/(u-t);this.cameraR.projectionMatrix.copy(n)}this.cameraL.matrixWorld.copy(m.matrixWorld).multiply(l);this.cameraR.matrixWorld.copy(m.matrixWorld).multiply(k)}}()});
fd.prototype=Object.create(D.prototype);fd.prototype.constructor=fd;ne.prototype=Object.assign(Object.create(D.prototype),{constructor:ne,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null);return this},getFilter:function(){return this.filter},setFilter:function(a){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):
this.gain.disconnect(this.context.destination);this.filter=a;this.gain.connect(this.filter);this.filter.connect(this.context.destination);return this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(a){this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01);return this},updateMatrixWorld:function(){var a=new p,b=new fa,c=new p,d=new p;return function(e){D.prototype.updateMatrixWorld.call(this,e);e=this.context.listener;var f=this.up;this.matrixWorld.decompose(a,
b,c);d.set(0,0,-1).applyQuaternion(b);e.positionX?(e.positionX.setValueAtTime(a.x,this.context.currentTime),e.positionY.setValueAtTime(a.y,this.context.currentTime),e.positionZ.setValueAtTime(a.z,this.context.currentTime),e.forwardX.setValueAtTime(d.x,this.context.currentTime),e.forwardY.setValueAtTime(d.y,this.context.currentTime),e.forwardZ.setValueAtTime(d.z,this.context.currentTime),e.upX.setValueAtTime(f.x,this.context.currentTime),e.upY.setValueAtTime(f.y,this.context.currentTime),e.upZ.setValueAtTime(f.z,
this.context.currentTime)):(e.setPosition(a.x,a.y,a.z),e.setOrientation(d.x,d.y,d.z,f.x,f.y,f.z))}}()});ic.prototype=Object.assign(Object.create(D.prototype),{constructor:ic,getOutput:function(){return this.gain},setNodeSource:function(a){this.hasPlaybackControl=!1;this.sourceType="audioNode";this.source=a;this.connect();return this},setMediaElementSource:function(a){this.hasPlaybackControl=!1;this.sourceType="mediaNode";this.source=this.context.createMediaElementSource(a);this.connect();return this},
setBuffer:function(a){this.buffer=a;this.sourceType="buffer";this.autoplay&&this.play();return this},play:function(){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else{var a=this.context.createBufferSource();a.buffer=this.buffer;a.loop=this.loop;a.onended=this.onEnded.bind(this);a.playbackRate.setValueAtTime(this.playbackRate,this.startTime);this.startTime=this.context.currentTime;
a.start(this.startTime,this.offset);this.isPlaying=!0;this.source=a;return this.connect()}},pause:function(){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return!0===this.isPlaying&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this},stop:function(){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return this.source.stop(),
this.source.onended=null,this.offset=0,this.isPlaying=!1,this},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var a=1,b=this.filters.length;a<b;a++)this.filters[a-1].connect(this.filters[a]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var a=1,b=this.filters.length;a<b;a++)this.filters[a-1].disconnect(this.filters[a]);
this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(a){a||(a=[]);!0===this.isPlaying?(this.disconnect(),this.filters=a,this.connect()):this.filters=a;return this},getFilter:function(){return this.getFilters()[0]},setFilter:function(a){return this.setFilters(a?[a]:[])},setPlaybackRate:function(a){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");
else return this.playbackRate=a,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(a){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return this.loop=
a,!0===this.isPlaying&&(this.source.loop=this.loop),this},getVolume:function(){return this.gain.gain.value},setVolume:function(a){this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01);return this}});pe.prototype=Object.assign(Object.create(ic.prototype),{constructor:pe,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(a){this.panner.refDistance=a;return this},getRolloffFactor:function(){return this.panner.rolloffFactor},
setRolloffFactor:function(a){this.panner.rolloffFactor=a;return this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(a){this.panner.distanceModel=a;return this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(a){this.panner.maxDistance=a;return this},setDirectionalCone:function(a,b,c){this.panner.coneInnerAngle=a;this.panner.coneOuterAngle=b;this.panner.coneOuterGain=c;return this},updateMatrixWorld:function(){var a=new p,
b=new fa,c=new p,d=new p;return function(e){D.prototype.updateMatrixWorld.call(this,e);e=this.panner;this.matrixWorld.decompose(a,b,c);d.set(0,0,1).applyQuaternion(b);e.setPosition(a.x,a.y,a.z);e.setOrientation(d.x,d.y,d.z)}}()});Object.assign(qe.prototype,{getFrequencyData:function(){this.analyser.getByteFrequencyData(this.data);return this.data},getAverageFrequency:function(){for(var a=0,b=this.getFrequencyData(),c=0;c<b.length;c++)a+=b[c];return a/b.length}});Object.assign(re.prototype,{accumulate:function(a,
b){var c=this.buffer,d=this.valueSize;a=a*d+d;var e=this.cumulativeWeight;if(0===e){for(e=0;e!==d;++e)c[a+e]=c[e];e=b}else e+=b,this._mixBufferRegion(c,a,0,b/e,d);this.cumulativeWeight=e},apply:function(a){var b=this.valueSize,c=this.buffer;a=a*b+b;var d=this.cumulativeWeight,e=this.binding;this.cumulativeWeight=0;1>d&&this._mixBufferRegion(c,a,3*b,1-d,b);d=b;for(var f=b+b;d!==f;++d)if(c[d]!==c[d+b]){e.setValue(c,a);break}},saveOriginalState:function(){var a=this.buffer,b=this.valueSize,c=3*b;this.binding.getValue(a,
c);for(var d=b;d!==c;++d)a[d]=a[c+d%b];this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_select:function(a,b,c,d,e){if(.5<=d)for(d=0;d!==e;++d)a[b+d]=a[c+d]},_slerp:function(a,b,c,d){fa.slerpFlat(a,b,a,b,a,c,d)},_lerp:function(a,b,c,d,e){for(var f=1-d,g=0;g!==e;++g){var h=b+g;a[h]=a[h]*f+a[c+g]*d}}});Object.assign(rf.prototype,{getValue:function(a,b){this.bind();var c=this._bindings[this._targetGroup.nCachedObjects_];void 0!==c&&c.getValue(a,
b)},setValue:function(a,b){for(var c=this._bindings,d=this._targetGroup.nCachedObjects_,e=c.length;d!==e;++d)c[d].setValue(a,b)},bind:function(){for(var a=this._bindings,b=this._targetGroup.nCachedObjects_,c=a.length;b!==c;++b)a[b].bind()},unbind:function(){for(var a=this._bindings,b=this._targetGroup.nCachedObjects_,c=a.length;b!==c;++b)a[b].unbind()}});Object.assign(pa,{Composite:rf,create:function(a,b,c){return a&&a.isAnimationObjectGroup?new pa.Composite(a,b,c):new pa(a,b,c)},sanitizeNodeName:function(){var a=
/[\[\]\.:\/]/g;return function(b){return b.replace(/\s/g,"_").replace(a,"")}}(),parseTrackName:function(){var a="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",b=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]");a=/(WCOD+)?/.source.replace("WCOD",a);var c=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),d=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),e=new RegExp("^"+b+a+c+d+"$"),f=["material","materials","bones"];return function(a){var b=e.exec(a);if(!b)throw Error("PropertyBinding: Cannot parse trackName: "+
a);b={nodeName:b[2],objectName:b[3],objectIndex:b[4],propertyName:b[5],propertyIndex:b[6]};var c=b.nodeName&&b.nodeName.lastIndexOf(".");if(void 0!==c&&-1!==c){var d=b.nodeName.substring(c+1);-1!==f.indexOf(d)&&(b.nodeName=b.nodeName.substring(0,c),b.objectName=d)}if(null===b.propertyName||0===b.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+a);return b}}(),findNode:function(a,b){if(!b||""===b||"root"===b||"."===b||-1===b||b===a.name||b===a.uuid)return a;
if(a.skeleton){var c=a.skeleton.getBoneByName(b);if(void 0!==c)return c}if(a.children){var d=function(a){for(var c=0;c<a.length;c++){var e=a[c];if(e.name===b||e.uuid===b||(e=d(e.children)))return e}return null};if(a=d(a.children))return a}return null}});Object.assign(pa.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(a,
b){a[b]=this.node[this.propertyName]},function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)a[b++]=c[d]},function(a,b){a[b]=this.resolvedProperty[this.propertyIndex]},function(a,b){this.resolvedProperty.toArray(a,b)}],SetterByBindingTypeAndVersioning:[[function(a,b){this.targetObject[this.propertyName]=a[b]},function(a,b){this.targetObject[this.propertyName]=a[b];this.targetObject.needsUpdate=!0},function(a,b){this.targetObject[this.propertyName]=a[b];this.targetObject.matrixWorldNeedsUpdate=
!0}],[function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)c[d]=a[b++]},function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)c[d]=a[b++];this.targetObject.needsUpdate=!0},function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)c[d]=a[b++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(a,b){this.resolvedProperty[this.propertyIndex]=a[b]},function(a,b){this.resolvedProperty[this.propertyIndex]=a[b];this.targetObject.needsUpdate=!0},function(a,
b){this.resolvedProperty[this.propertyIndex]=a[b];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(a,b){this.resolvedProperty.fromArray(a,b)},function(a,b){this.resolvedProperty.fromArray(a,b);this.targetObject.needsUpdate=!0},function(a,b){this.resolvedProperty.fromArray(a,b);this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(a,b){this.bind();this.getValue(a,b)},setValue:function(a,b){this.bind();this.setValue(a,b)},bind:function(){var a=this.node,b=this.parsedPath,c=b.objectName,
d=b.propertyName,e=b.propertyIndex;a||(this.node=a=pa.findNode(this.rootNode,b.nodeName)||this.rootNode);this.getValue=this._getValue_unavailable;this.setValue=this._setValue_unavailable;if(a){if(c){var f=b.objectIndex;switch(c){case "materials":if(!a.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!a.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",
this);return}a=a.material.materials;break;case "bones":if(!a.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}a=a.skeleton.bones;for(c=0;c<a.length;c++)if(a[c].name===f){f=c;break}break;default:if(void 0===a[c]){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}a=a[c]}if(void 0!==f){if(void 0===a[f]){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",
this,a);return}a=a[f]}}f=a[d];if(void 0===f)console.error("THREE.PropertyBinding: Trying to update property for track: "+b.nodeName+"."+d+" but it wasn't found.",a);else{b=this.Versioning.None;void 0!==a.needsUpdate?(b=this.Versioning.NeedsUpdate,this.targetObject=a):void 0!==a.matrixWorldNeedsUpdate&&(b=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=a);c=this.BindingType.Direct;if(void 0!==e){if("morphTargetInfluences"===d){if(!a.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",
this);return}if(a.geometry.isBufferGeometry){if(!a.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}for(c=0;c<this.node.geometry.morphAttributes.position.length;c++)if(a.geometry.morphAttributes.position[c].name===e){e=c;break}}else{if(!a.geometry.morphTargets){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",
this);return}for(c=0;c<this.node.geometry.morphTargets.length;c++)if(a.geometry.morphTargets[c].name===e){e=c;break}}}c=this.BindingType.ArrayElement;this.resolvedProperty=f;this.propertyIndex=e}else void 0!==f.fromArray&&void 0!==f.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=f):Array.isArray(f)?(c=this.BindingType.EntireArray,this.resolvedProperty=f):this.propertyName=d;this.getValue=this.GetterByBindingType[c];this.setValue=this.SetterByBindingTypeAndVersioning[c][b]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+
this.path+" but it wasn't found.")},unbind:function(){this.node=null;this.getValue=this._getValue_unbound;this.setValue=this._setValue_unbound}});Object.assign(pa.prototype,{_getValue_unbound:pa.prototype.getValue,_setValue_unbound:pa.prototype.setValue});Object.assign(sf.prototype,{isAnimationObjectGroup:!0,add:function(){for(var a=this._objects,b=a.length,c=this.nCachedObjects_,d=this._indicesByUUID,e=this._paths,f=this._parsedPaths,g=this._bindings,h=g.length,k=void 0,l=0,p=arguments.length;l!==
p;++l){var n=arguments[l],r=n.uuid,w=d[r];if(void 0===w){w=b++;d[r]=w;a.push(n);r=0;for(var t=h;r!==t;++r)g[r].push(new pa(n,e[r],f[r]))}else if(w<c){k=a[w];var u=--c;t=a[u];d[t.uuid]=w;a[w]=t;d[r]=u;a[u]=n;r=0;for(t=h;r!==t;++r){var x=g[r],y=x[w];x[w]=x[u];void 0===y&&(y=new pa(n,e[r],f[r]));x[u]=y}}else a[w]!==k&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=
c},remove:function(){for(var a=this._objects,b=this.nCachedObjects_,c=this._indicesByUUID,d=this._bindings,e=d.length,f=0,g=arguments.length;f!==g;++f){var h=arguments[f],k=h.uuid,l=c[k];if(void 0!==l&&l>=b){var p=b++,n=a[p];c[n.uuid]=l;a[l]=n;c[k]=p;a[p]=h;h=0;for(k=e;h!==k;++h){n=d[h];var r=n[l];n[l]=n[p];n[p]=r}}}this.nCachedObjects_=b},uncache:function(){for(var a=this._objects,b=a.length,c=this.nCachedObjects_,d=this._indicesByUUID,e=this._bindings,f=e.length,g=0,h=arguments.length;g!==h;++g){var k=
arguments[g].uuid,l=d[k];if(void 0!==l)if(delete d[k],l<c){k=--c;var p=a[k],n=--b,r=a[n];d[p.uuid]=l;a[l]=p;d[r.uuid]=k;a[k]=r;a.pop();p=0;for(r=f;p!==r;++p){var w=e[p],t=w[n];w[l]=w[k];w[k]=t;w.pop()}}else for(n=--b,r=a[n],d[r.uuid]=l,a[l]=r,a.pop(),p=0,r=f;p!==r;++p)w=e[p],w[l]=w[n],w.pop()}this.nCachedObjects_=c},subscribe_:function(a,b){var c=this._bindingsIndicesByPath,d=c[a],e=this._bindings;if(void 0!==d)return e[d];var f=this._paths,g=this._parsedPaths,h=this._objects,k=this.nCachedObjects_,
l=Array(h.length);d=e.length;c[a]=d;f.push(a);g.push(b);e.push(l);c=k;for(d=h.length;c!==d;++c)l[c]=new pa(h[c],a,b);return l},unsubscribe_:function(a){var b=this._bindingsIndicesByPath,c=b[a];if(void 0!==c){var d=this._paths,e=this._parsedPaths,f=this._bindings,g=f.length-1,h=f[g];b[a[g]]=c;f[c]=h;f.pop();e[c]=e[g];e.pop();d[c]=d[g];d.pop()}}});Object.assign(tf.prototype,{play:function(){this._mixer._activateAction(this);return this},stop:function(){this._mixer._deactivateAction(this);return this.reset()},
reset:function(){this.paused=!1;this.enabled=!0;this.time=0;this._loopCount=-1;this._startTime=null;return this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(a){this._startTime=a;return this},setLoop:function(a,b){this.loop=a;this.repetitions=b;return this},setEffectiveWeight:function(a){this.weight=a;
this._effectiveWeight=this.enabled?a:0;return this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(a){return this._scheduleFading(a,0,1)},fadeOut:function(a){return this._scheduleFading(a,1,0)},crossFadeFrom:function(a,b,c){a.fadeOut(b);this.fadeIn(b);if(c){c=this._clip.duration;var d=a._clip.duration,e=c/d;a.warp(1,d/c,b);this.warp(e,1,b)}return this},crossFadeTo:function(a,b,c){return a.crossFadeFrom(this,b,c)},stopFading:function(){var a=this._weightInterpolant;
null!==a&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(a));return this},setEffectiveTimeScale:function(a){this.timeScale=a;this._effectiveTimeScale=this.paused?0:a;return this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(a){this.timeScale=this._clip.duration/a;return this.stopWarping()},syncWith:function(a){this.time=a.time;this.timeScale=a.timeScale;return this.stopWarping()},halt:function(a){return this.warp(this._effectiveTimeScale,
0,a)},warp:function(a,b,c){var d=this._mixer,e=d.time,f=this._timeScaleInterpolant,g=this.timeScale;null===f&&(this._timeScaleInterpolant=f=d._lendControlInterpolant());d=f.parameterPositions;f=f.sampleValues;d[0]=e;d[1]=e+c;f[0]=a/g;f[1]=b/g;return this},stopWarping:function(){var a=this._timeScaleInterpolant;null!==a&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(a));return this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||
this._mixer._root},_update:function(a,b,c,d){if(this.enabled){var e=this._startTime;if(null!==e){b=(a-e)*c;if(0>b||0===c)return;this._startTime=null;b*=c}b*=this._updateTimeScale(a);c=this._updateTime(b);a=this._updateWeight(a);if(0<a){b=this._interpolants;e=this._propertyBindings;for(var f=0,g=b.length;f!==g;++f)b[f].evaluate(c),e[f].accumulate(d,a)}}else this._updateWeight(a)},_updateWeight:function(a){var b=0;if(this.enabled){b=this.weight;var c=this._weightInterpolant;if(null!==c){var d=c.evaluate(a)[0];
b*=d;a>c.parameterPositions[1]&&(this.stopFading(),0===d&&(this.enabled=!1))}}return this._effectiveWeight=b},_updateTimeScale:function(a){var b=0;if(!this.paused){b=this.timeScale;var c=this._timeScaleInterpolant;if(null!==c){var d=c.evaluate(a)[0];b*=d;a>c.parameterPositions[1]&&(this.stopWarping(),0===b?this.paused=!0:this.timeScale=b)}}return this._effectiveTimeScale=b},_updateTime:function(a){var b=this.time+a,c=this._clip.duration,d=this.loop,e=this._loopCount,f=2202===d;if(0===a)return-1===
e?b:f&&1===(e&1)?c-b:b;if(2200===d)a:{if(-1===e&&(this._loopCount=0,this._setEndings(!0,!0,!1)),b>=c)b=c;else if(0>b)b=0;else break a;this.clampWhenFinished?this.paused=!0:this.enabled=!1;this._mixer.dispatchEvent({type:"finished",action:this,direction:0>a?-1:1})}else{-1===e&&(0<=a?(e=0,this._setEndings(!0,0===this.repetitions,f)):this._setEndings(0===this.repetitions,!0,f));if(b>=c||0>b){d=Math.floor(b/c);b-=c*d;e+=Math.abs(d);var g=this.repetitions-e;0>=g?(this.clampWhenFinished?this.paused=!0:
this.enabled=!1,b=0<a?c:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<a?1:-1})):(1===g?(a=0>a,this._setEndings(a,!a,f)):this._setEndings(!1,!1,f),this._loopCount=e,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:d}))}if(f&&1===(e&1))return this.time=b,c-b}return this.time=b},_setEndings:function(a,b,c){var d=this._interpolantSettings;c?(d.endingStart=2401,d.endingEnd=2401):(d.endingStart=a?this.zeroSlopeAtStart?2401:2400:2402,d.endingEnd=b?this.zeroSlopeAtEnd?2401:
2400:2402)},_scheduleFading:function(a,b,c){var d=this._mixer,e=d.time,f=this._weightInterpolant;null===f&&(this._weightInterpolant=f=d._lendControlInterpolant());d=f.parameterPositions;f=f.sampleValues;d[0]=e;f[0]=b;d[1]=e+a;f[1]=c;return this}});se.prototype=Object.assign(Object.create(ya.prototype),{constructor:se,_bindAction:function(a,b){var c=a._localRoot||this._root,d=a._clip.tracks,e=d.length,f=a._propertyBindings;a=a._interpolants;var g=c.uuid,h=this._bindingsByRootAndName,k=h[g];void 0===
k&&(k={},h[g]=k);for(h=0;h!==e;++h){var l=d[h],p=l.name,n=k[p];if(void 0===n){n=f[h];if(void 0!==n){null===n._cacheIndex&&(++n.referenceCount,this._addInactiveBinding(n,g,p));continue}n=new re(pa.create(c,p,b&&b._propertyBindings[h].binding.parsedPath),l.ValueTypeName,l.getValueSize());++n.referenceCount;this._addInactiveBinding(n,g,p)}f[h]=n;a[h].resultBuffer=n.buffer}},_activateAction:function(a){if(!this._isActiveAction(a)){if(null===a._cacheIndex){var b=(a._localRoot||this._root).uuid,c=a._clip.uuid,
d=this._actionsByClip[c];this._bindAction(a,d&&d.knownActions[0]);this._addInactiveAction(a,c,b)}b=a._propertyBindings;c=0;for(d=b.length;c!==d;++c){var e=b[c];0===e.useCount++&&(this._lendBinding(e),e.saveOriginalState())}this._lendAction(a)}},_deactivateAction:function(a){if(this._isActiveAction(a)){for(var b=a._propertyBindings,c=0,d=b.length;c!==d;++c){var e=b[c];0===--e.useCount&&(e.restoreOriginalState(),this._takeBackBinding(e))}this._takeBackAction(a)}},_initMemoryManager:function(){this._actions=
[];this._nActiveActions=0;this._actionsByClip={};this._bindings=[];this._nActiveBindings=0;this._bindingsByRootAndName={};this._controlInterpolants=[];this._nActiveControlInterpolants=0;var a=this;this.stats={actions:{get total(){return a._actions.length},get inUse(){return a._nActiveActions}},bindings:{get total(){return a._bindings.length},get inUse(){return a._nActiveBindings}},controlInterpolants:{get total(){return a._controlInterpolants.length},get inUse(){return a._nActiveControlInterpolants}}}},
_isActiveAction:function(a){a=a._cacheIndex;return null!==a&&a<this._nActiveActions},_addInactiveAction:function(a,b,c){var d=this._actions,e=this._actionsByClip,f=e[b];void 0===f?(f={knownActions:[a],actionByRoot:{}},a._byClipCacheIndex=0,e[b]=f):(b=f.knownActions,a._byClipCacheIndex=b.length,b.push(a));a._cacheIndex=d.length;d.push(a);f.actionByRoot[c]=a},_removeInactiveAction:function(a){var b=this._actions,c=b[b.length-1],d=a._cacheIndex;c._cacheIndex=d;b[d]=c;b.pop();a._cacheIndex=null;b=a._clip.uuid;
c=this._actionsByClip;d=c[b];var e=d.knownActions,f=e[e.length-1],g=a._byClipCacheIndex;f._byClipCacheIndex=g;e[g]=f;e.pop();a._byClipCacheIndex=null;delete d.actionByRoot[(a._localRoot||this._root).uuid];0===e.length&&delete c[b];this._removeInactiveBindingsForAction(a)},_removeInactiveBindingsForAction:function(a){a=a._propertyBindings;for(var b=0,c=a.length;b!==c;++b){var d=a[b];0===--d.referenceCount&&this._removeInactiveBinding(d)}},_lendAction:function(a){var b=this._actions,c=a._cacheIndex,
d=this._nActiveActions++,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e},_takeBackAction:function(a){var b=this._actions,c=a._cacheIndex,d=--this._nActiveActions,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e},_addInactiveBinding:function(a,b,c){var d=this._bindingsByRootAndName,e=d[b],f=this._bindings;void 0===e&&(e={},d[b]=e);e[c]=a;a._cacheIndex=f.length;f.push(a)},_removeInactiveBinding:function(a){var b=this._bindings,c=a.binding,d=c.rootNode.uuid;c=c.path;var e=this._bindingsByRootAndName,
f=e[d],g=b[b.length-1];a=a._cacheIndex;g._cacheIndex=a;b[a]=g;b.pop();delete f[c];a:{for(var h in f)break a;delete e[d]}},_lendBinding:function(a){var b=this._bindings,c=a._cacheIndex,d=this._nActiveBindings++,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e},_takeBackBinding:function(a){var b=this._bindings,c=a._cacheIndex,d=--this._nActiveBindings,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e},_lendControlInterpolant:function(){var a=this._controlInterpolants,b=this._nActiveControlInterpolants++,
c=a[b];void 0===c&&(c=new dd(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),c.__cacheIndex=b,a[b]=c);return c},_takeBackControlInterpolant:function(a){var b=this._controlInterpolants,c=a.__cacheIndex,d=--this._nActiveControlInterpolants,e=b[d];a.__cacheIndex=d;b[d]=a;e.__cacheIndex=c;b[c]=e},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(a,b){var c=b||this._root,d=c.uuid;c="string"===typeof a?Ca.findByName(c,a):a;a=null!==c?c.uuid:a;var e=
this._actionsByClip[a],f=null;if(void 0!==e){f=e.actionByRoot[d];if(void 0!==f)return f;f=e.knownActions[0];null===c&&(c=f._clip)}if(null===c)return null;b=new tf(this,c,b);this._bindAction(b,f);this._addInactiveAction(b,a,d);return b},existingAction:function(a,b){var c=b||this._root;b=c.uuid;c="string"===typeof a?Ca.findByName(c,a):a;a=this._actionsByClip[c?c.uuid:a];return void 0!==a?a.actionByRoot[b]||null:null},stopAllAction:function(){for(var a=this._actions,b=this._nActiveActions,c=this._bindings,
d=this._nActiveBindings,e=this._nActiveBindings=this._nActiveActions=0;e!==b;++e)a[e].reset();for(e=0;e!==d;++e)c[e].useCount=0;return this},update:function(a){a*=this.timeScale;for(var b=this._actions,c=this._nActiveActions,d=this.time+=a,e=Math.sign(a),f=this._accuIndex^=1,g=0;g!==c;++g)b[g]._update(d,a,e,f);a=this._bindings;b=this._nActiveBindings;for(g=0;g!==b;++g)a[g].apply(f);return this},getRoot:function(){return this._root},uncacheClip:function(a){var b=this._actions;a=a.uuid;var c=this._actionsByClip,
d=c[a];if(void 0!==d){d=d.knownActions;for(var e=0,f=d.length;e!==f;++e){var g=d[e];this._deactivateAction(g);var h=g._cacheIndex,k=b[b.length-1];g._cacheIndex=null;g._byClipCacheIndex=null;k._cacheIndex=h;b[h]=k;b.pop();this._removeInactiveBindingsForAction(g)}delete c[a]}},uncacheRoot:function(a){a=a.uuid;var b=this._actionsByClip;for(d in b){var c=b[d].actionByRoot[a];void 0!==c&&(this._deactivateAction(c),this._removeInactiveAction(c))}var d=this._bindingsByRootAndName[a];if(void 0!==d)for(var e in d)a=
d[e],a.restoreOriginalState(),this._removeInactiveBinding(a)},uncacheAction:function(a,b){a=this.existingAction(a,b);null!==a&&(this._deactivateAction(a),this._removeInactiveAction(a))}});Nd.prototype.clone=function(){return new Nd(void 0===this.value.clone?this.value:this.value.clone())};te.prototype=Object.assign(Object.create(C.prototype),{constructor:te,isInstancedBufferGeometry:!0,copy:function(a){C.prototype.copy.call(this,a);this.maxInstancedCount=a.maxInstancedCount;return this},clone:function(){return(new this.constructor).copy(this)}});
ue.prototype=Object.assign(Object.create(pb.prototype),{constructor:ue,isInstancedInterleavedBuffer:!0,copy:function(a){pb.prototype.copy.call(this,a);this.meshPerAttribute=a.meshPerAttribute;return this}});ve.prototype=Object.assign(Object.create(Q.prototype),{constructor:ve,isInstancedBufferAttribute:!0,copy:function(a){Q.prototype.copy.call(this,a);this.meshPerAttribute=a.meshPerAttribute;return this}});Object.assign(uf.prototype,{linePrecision:1,set:function(a,b){this.ray.set(a,b)},setFromCamera:function(a,
b){b&&b.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(b.matrixWorld),this.ray.direction.set(a.x,a.y,.5).unproject(b).sub(this.ray.origin).normalize()):b&&b.isOrthographicCamera?(this.ray.origin.set(a.x,a.y,(b.near+b.far)/(b.near-b.far)).unproject(b),this.ray.direction.set(0,0,-1).transformDirection(b.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(a,b,c){c=c||[];we(a,this,c,b);c.sort(vf);return c},intersectObjects:function(a,b,c){c=c||
[];if(!1===Array.isArray(a))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),c;for(var d=0,e=a.length;d<e;d++)we(a[d],this,c,b);c.sort(vf);return c}});Object.assign(wf.prototype,{start:function(){this.oldTime=this.startTime=("undefined"===typeof performance?Date:performance).now();this.elapsedTime=0;this.running=!0},stop:function(){this.getElapsedTime();this.autoStart=this.running=!1},getElapsedTime:function(){this.getDelta();return this.elapsedTime},getDelta:function(){var a=
0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var b=("undefined"===typeof performance?Date:performance).now();a=(b-this.oldTime)/1E3;this.oldTime=b;this.elapsedTime+=a}return a}});Object.assign(xf.prototype,{set:function(a,b,c){this.radius=a;this.phi=b;this.theta=c;return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.radius=a.radius;this.phi=a.phi;this.theta=a.theta;return this},makeSafe:function(){this.phi=Math.max(1E-6,Math.min(Math.PI-
1E-6,this.phi));return this},setFromVector3:function(a){this.radius=a.length();0===this.radius?this.phi=this.theta=0:(this.theta=Math.atan2(a.x,a.z),this.phi=Math.acos(G.clamp(a.y/this.radius,-1,1)));return this}});Object.assign(yf.prototype,{set:function(a,b,c){this.radius=a;this.theta=b;this.y=c;return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.radius=a.radius;this.theta=a.theta;this.y=a.y;return this},setFromVector3:function(a){this.radius=Math.sqrt(a.x*
a.x+a.z*a.z);this.theta=Math.atan2(a.x,a.z);this.y=a.y;return this}});Object.assign(xe.prototype,{set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(){var a=new A;return function(b,c){c=a.copy(c).multiplyScalar(.5);this.min.copy(b).sub(c);this.max.copy(b).add(c);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.min.copy(a.min);
this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(a){void 0===a&&(console.warn("THREE.Box2: .getCenter() target is now required"),a=new A);return this.isEmpty()?a.set(0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(a){void 0===a&&(console.warn("THREE.Box2: .getSize() target is now required"),a=new A);return this.isEmpty()?
a.set(0,0):a.subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y},getParameter:function(a,
b){void 0===b&&(console.warn("THREE.Box2: .getParameter() target is now required"),b=new A);return b.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y?!1:!0},clampPoint:function(a,b){void 0===b&&(console.warn("THREE.Box2: .clampPoint() target is now required"),b=new A);return b.copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new A;
return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)}});Object.assign(ye.prototype,{set:function(a,b){this.start.copy(a);this.end.copy(b);return this},clone:function(){return(new this.constructor).copy(this)},
copy:function(a){this.start.copy(a.start);this.end.copy(a.end);return this},getCenter:function(a){void 0===a&&(console.warn("THREE.Line3: .getCenter() target is now required"),a=new p);return a.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(a){void 0===a&&(console.warn("THREE.Line3: .delta() target is now required"),a=new p);return a.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},
at:function(a,b){void 0===b&&(console.warn("THREE.Line3: .at() target is now required"),b=new p);return this.delta(b).multiplyScalar(a).add(this.start)},closestPointToPointParameter:function(){var a=new p,b=new p;return function(c,d){a.subVectors(c,this.start);b.subVectors(this.end,this.start);c=b.dot(b);c=b.dot(a)/c;d&&(c=G.clamp(c,0,1));return c}}(),closestPointToPoint:function(a,b,c){a=this.closestPointToPointParameter(a,b);void 0===c&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),
c=new p);return this.delta(c).multiplyScalar(a).add(this.start)},applyMatrix4:function(a){this.start.applyMatrix4(a);this.end.applyMatrix4(a);return this},equals:function(a){return a.start.equals(this.start)&&a.end.equals(this.end)}});gd.prototype=Object.create(D.prototype);gd.prototype.constructor=gd;gd.prototype.isImmediateRenderObject=!0;hd.prototype=Object.create(W.prototype);hd.prototype.constructor=hd;hd.prototype.update=function(){var a=new p,b=new p,c=new ra;return function(){var d=["a","b",
"c"];this.object.updateMatrixWorld(!0);c.getNormalMatrix(this.object.matrixWorld);var e=this.object.matrixWorld,f=this.geometry.attributes.position,g=this.object.geometry;if(g&&g.isGeometry)for(var h=g.vertices,k=g.faces,l=g=0,p=k.length;l<p;l++)for(var n=k[l],r=0,w=n.vertexNormals.length;r<w;r++){var t=n.vertexNormals[r];a.copy(h[n[d[r]]]).applyMatrix4(e);b.copy(t).applyMatrix3(c).normalize().multiplyScalar(this.size).add(a);f.setXYZ(g,a.x,a.y,a.z);g+=1;f.setXYZ(g,b.x,b.y,b.z);g+=1}else if(g&&g.isBufferGeometry)for(d=
g.attributes.position,h=g.attributes.normal,r=g=0,w=d.count;r<w;r++)a.set(d.getX(r),d.getY(r),d.getZ(r)).applyMatrix4(e),b.set(h.getX(r),h.getY(r),h.getZ(r)),b.applyMatrix3(c).normalize().multiplyScalar(this.size).add(a),f.setXYZ(g,a.x,a.y,a.z),g+=1,f.setXYZ(g,b.x,b.y,b.z),g+=1;f.needsUpdate=!0}}();jc.prototype=Object.create(D.prototype);jc.prototype.constructor=jc;jc.prototype.dispose=function(){this.cone.geometry.dispose();this.cone.material.dispose()};jc.prototype.update=function(){var a=new p,
b=new p;return function(){this.light.updateMatrixWorld();var c=this.light.distance?this.light.distance:1E3,d=c*Math.tan(this.light.angle);this.cone.scale.set(d,d,c);a.setFromMatrixPosition(this.light.matrixWorld);b.setFromMatrixPosition(this.light.target.matrixWorld);this.cone.lookAt(b.sub(a));void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}();kc.prototype=Object.create(W.prototype);kc.prototype.constructor=kc;kc.prototype.updateMatrixWorld=
function(){var a=new p,b=new J,c=new J;return function(d){var e=this.bones,f=this.geometry,g=f.getAttribute("position");c.getInverse(this.root.matrixWorld);for(var h=0,k=0;h<e.length;h++){var l=e[h];l.parent&&l.parent.isBone&&(b.multiplyMatrices(c,l.matrixWorld),a.setFromMatrixPosition(b),g.setXYZ(k,a.x,a.y,a.z),b.multiplyMatrices(c,l.parent.matrixWorld),a.setFromMatrixPosition(b),g.setXYZ(k+1,a.x,a.y,a.z),k+=2)}f.getAttribute("position").needsUpdate=!0;D.prototype.updateMatrixWorld.call(this,d)}}();
lc.prototype=Object.create(ka.prototype);lc.prototype.constructor=lc;lc.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};lc.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};mc.prototype=Object.create(D.prototype);mc.prototype.constructor=mc;mc.prototype.dispose=function(){this.children[0].geometry.dispose();this.children[0].material.dispose()};mc.prototype.update=function(){var a=.5*this.light.width,
b=.5*this.light.height,c=this.line.geometry.attributes.position,d=c.array;d[0]=a;d[1]=-b;d[2]=0;d[3]=a;d[4]=b;d[5]=0;d[6]=-a;d[7]=b;d[8]=0;d[9]=-a;d[10]=-b;d[11]=0;d[12]=a;d[13]=-b;d[14]=0;c.needsUpdate=!0;void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)};nc.prototype=Object.create(D.prototype);nc.prototype.constructor=nc;nc.prototype.dispose=function(){this.children[0].geometry.dispose();this.children[0].material.dispose()};nc.prototype.update=
function(){var a=new p,b=new H,c=new H;return function(){var d=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var e=d.geometry.getAttribute("color");b.copy(this.light.color);c.copy(this.light.groundColor);for(var f=0,g=e.count;f<g;f++){var h=f<g/2?b:c;e.setXYZ(f,h.r,h.g,h.b)}e.needsUpdate=!0}d.lookAt(a.setFromMatrixPosition(this.light.matrixWorld).negate())}}();id.prototype=Object.create(W.prototype);id.prototype.constructor=id;Od.prototype=Object.create(W.prototype);
Od.prototype.constructor=Od;jd.prototype=Object.create(W.prototype);jd.prototype.constructor=jd;jd.prototype.update=function(){var a=new p,b=new p,c=new ra;return function(){this.object.updateMatrixWorld(!0);c.getNormalMatrix(this.object.matrixWorld);var d=this.object.matrixWorld,e=this.geometry.attributes.position,f=this.object.geometry,g=f.vertices;f=f.faces;for(var h=0,k=0,l=f.length;k<l;k++){var p=f[k],n=p.normal;a.copy(g[p.a]).add(g[p.b]).add(g[p.c]).divideScalar(3).applyMatrix4(d);b.copy(n).applyMatrix3(c).normalize().multiplyScalar(this.size).add(a);
e.setXYZ(h,a.x,a.y,a.z);h+=1;e.setXYZ(h,b.x,b.y,b.z);h+=1}e.needsUpdate=!0}}();oc.prototype=Object.create(D.prototype);oc.prototype.constructor=oc;oc.prototype.dispose=function(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();this.targetLine.geometry.dispose();this.targetLine.material.dispose()};oc.prototype.update=function(){var a=new p,b=new p,c=new p;return function(){a.setFromMatrixPosition(this.light.matrixWorld);b.setFromMatrixPosition(this.light.target.matrixWorld);c.subVectors(b,
a);this.lightPlane.lookAt(c);void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color));this.targetLine.lookAt(c);this.targetLine.scale.z=c.length()}}();kd.prototype=Object.create(W.prototype);kd.prototype.constructor=kd;kd.prototype.update=function(){function a(a,g,h,k){d.set(g,h,k).unproject(e);a=c[a];if(void 0!==a)for(g=b.getAttribute("position"),
h=0,k=a.length;h<k;h++)g.setXYZ(a[h],d.x,d.y,d.z)}var b,c,d=new p,e=new Na;return function(){b=this.geometry;c=this.pointMap;e.projectionMatrix.copy(this.camera.projectionMatrix);a("c",0,0,-1);a("t",0,0,1);a("n1",-1,-1,-1);a("n2",1,-1,-1);a("n3",-1,1,-1);a("n4",1,1,-1);a("f1",-1,-1,1);a("f2",1,-1,1);a("f3",-1,1,1);a("f4",1,1,1);a("u1",.7,1.1,-1);a("u2",-.7,1.1,-1);a("u3",0,2,-1);a("cf1",-1,0,1);a("cf2",1,0,1);a("cf3",0,-1,1);a("cf4",0,1,1);a("cn1",-1,0,-1);a("cn2",1,0,-1);a("cn3",0,-1,-1);a("cn4",
0,1,-1);b.getAttribute("position").needsUpdate=!0}}();Eb.prototype=Object.create(W.prototype);Eb.prototype.constructor=Eb;Eb.prototype.update=function(){var a=new Sa;return function(b){void 0!==b&&console.warn("THREE.BoxHelper: .update() has no longer arguments.");void 0!==this.object&&a.setFromObject(this.object);if(!a.isEmpty()){b=a.min;var c=a.max,d=this.geometry.attributes.position,e=d.array;e[0]=c.x;e[1]=c.y;e[2]=c.z;e[3]=b.x;e[4]=c.y;e[5]=c.z;e[6]=b.x;e[7]=b.y;e[8]=c.z;e[9]=c.x;e[10]=b.y;e[11]=
c.z;e[12]=c.x;e[13]=c.y;e[14]=b.z;e[15]=b.x;e[16]=c.y;e[17]=b.z;e[18]=b.x;e[19]=b.y;e[20]=b.z;e[21]=c.x;e[22]=b.y;e[23]=b.z;d.needsUpdate=!0;this.geometry.computeBoundingSphere()}}}();Eb.prototype.setFromObject=function(a){this.object=a;this.update();return this};ld.prototype=Object.create(W.prototype);ld.prototype.constructor=ld;ld.prototype.updateMatrixWorld=function(a){var b=this.box;b.isEmpty()||(b.getCenter(this.position),b.getSize(this.scale),this.scale.multiplyScalar(.5),D.prototype.updateMatrixWorld.call(this,
a))};md.prototype=Object.create(sa.prototype);md.prototype.constructor=md;md.prototype.updateMatrixWorld=function(a){var b=-this.plane.constant;1E-8>Math.abs(b)&&(b=1E-8);this.scale.set(.5*this.size,.5*this.size,b);this.children[0].material.side=0>b?1:0;this.lookAt(this.plane.normal);D.prototype.updateMatrixWorld.call(this,a)};var Pd,ze;Fb.prototype=Object.create(D.prototype);Fb.prototype.constructor=Fb;Fb.prototype.setDirection=function(){var a=new p,b;return function(c){.99999<c.y?this.quaternion.set(0,
0,0,1):-.99999>c.y?this.quaternion.set(1,0,0,0):(a.set(c.z,0,-c.x).normalize(),b=Math.acos(c.y),this.quaternion.setFromAxisAngle(a,b))}}();Fb.prototype.setLength=function(a,b,c){void 0===b&&(b=.2*a);void 0===c&&(c=.2*b);this.line.scale.set(1,Math.max(0,a-b),1);this.line.updateMatrix();this.cone.scale.set(c,b,c);this.cone.position.y=a;this.cone.updateMatrix()};Fb.prototype.setColor=function(a){this.line.material.color.copy(a);this.cone.material.color.copy(a)};nd.prototype=Object.create(W.prototype);
nd.prototype.constructor=nd;M.create=function(a,b){console.log("THREE.Curve.create() has been deprecated");a.prototype=Object.create(M.prototype);a.prototype.constructor=a;a.prototype.getPoint=b;return a};Object.assign(Ya.prototype,{createPointsGeometry:function(a){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");a=this.getPoints(a);return this.createGeometry(a)},createSpacedPointsGeometry:function(a){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");
a=this.getSpacedPoints(a);return this.createGeometry(a)},createGeometry:function(a){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var b=new R,c=0,d=a.length;c<d;c++){var e=a[c];b.vertices.push(new p(e.x,e.y,e.z||0))}return b}});Object.assign(La.prototype,{fromPoints:function(a){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints().");this.setFromPoints(a)}});Af.prototype=Object.create(ca.prototype);
Bf.prototype=Object.create(ca.prototype);Ae.prototype=Object.create(ca.prototype);Object.assign(Ae.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}});id.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")};
kc.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};Object.assign(hc.prototype,{extractUrlBase:function(a){console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead.");return Ee.extractUrlBase(a)}});Object.assign(xe.prototype,{center:function(a){console.warn("THREE.Box2: .center() has been renamed to .getCenter().");return this.getCenter(a)},empty:function(){console.warn("THREE.Box2: .empty() has been renamed to .isEmpty().");
return this.isEmpty()},isIntersectionBox:function(a){console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(a)},size:function(a){console.warn("THREE.Box2: .size() has been renamed to .getSize().");return this.getSize(a)}});Object.assign(Sa.prototype,{center:function(a){console.warn("THREE.Box3: .center() has been renamed to .getCenter().");return this.getCenter(a)},empty:function(){console.warn("THREE.Box3: .empty() has been renamed to .isEmpty().");
return this.isEmpty()},isIntersectionBox:function(a){console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(a)},isIntersectionSphere:function(a){console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere().");return this.intersectsSphere(a)},size:function(a){console.warn("THREE.Box3: .size() has been renamed to .getSize().");return this.getSize(a)}});ye.prototype.center=function(a){console.warn("THREE.Line3: .center() has been renamed to .getCenter().");
return this.getCenter(a)};Object.assign(G,{random16:function(){console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead.");return Math.random()},nearestPowerOfTwo:function(a){console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo().");return G.floorPowerOfTwo(a)},nextPowerOfTwo:function(a){console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo().");return G.ceilPowerOfTwo(a)}});Object.assign(ra.prototype,{flattenToArrayOffset:function(a,
b){console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.");return this.toArray(a,b)},multiplyVector3:function(a){console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return a.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(a){console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.");
return this.applyToBufferAttribute(a)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}});Object.assign(J.prototype,{extractPosition:function(a){console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().");return this.copyPosition(a)},flattenToArrayOffset:function(a,b){console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.");return this.toArray(a,b)},getPosition:function(){var a;
return function(){void 0===a&&(a=new p);console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");return a.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(a){console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().");return this.makeRotationFromQuaternion(a)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(a){console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead.");
return a.applyMatrix4(this)},multiplyVector4:function(a){console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(a){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");a.transformDirection(this)},crossVector:function(a){console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");
return a.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(a){console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.");
return this.applyToBufferAttribute(a)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(a,b,c,d,e,f){console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead.");return this.makePerspective(a,b,d,c,e,f)}});Ma.prototype.isIntersectionLine=function(a){console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine().");return this.intersectsLine(a)};
fa.prototype.multiplyVector3=function(a){console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return a.applyQuaternion(this)};Object.assign(nb.prototype,{isIntersectionBox:function(a){console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(a)},isIntersectionPlane:function(a){console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane().");return this.intersectsPlane(a)},
isIntersectionSphere:function(a){console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere().");return this.intersectsSphere(a)}});Object.assign(ja.prototype,{area:function(){console.warn("THREE.Triangle: .area() has been renamed to .getArea().");return this.getArea()},barycoordFromPoint:function(a,b){console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().");return this.getBarycoord(a,b)},midpoint:function(a){console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint().");
return this.getMidpoint(a)},normal:function(a){console.warn("THREE.Triangle: .normal() has been renamed to .getNormal().");return this.getNormal(a)},plane:function(a){console.warn("THREE.Triangle: .plane() has been renamed to .getPlane().");return this.getPlane(a)}});Object.assign(ja,{barycoordFromPoint:function(a,b,c,d,e){console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().");return ja.getBarycoord(a,b,c,d,e)},normal:function(a,b,c,d){console.warn("THREE.Triangle: .normal() has been renamed to .getNormal().");
return ja.getNormal(a,b,c,d)}});Object.assign(eb.prototype,{extractAllPoints:function(a){console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead.");return this.extractPoints(a)},extrude:function(a){console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead.");return new sb(this,a)},makeGeometry:function(a){console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead.");return new ub(this,a)}});Object.assign(A.prototype,
{fromAttribute:function(a,b,c){console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute().");return this.fromBufferAttribute(a,b,c)},distanceToManhattan:function(a){console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo().");return this.manhattanDistanceTo(a)},lengthManhattan:function(){console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength().");return this.manhattanLength()}});Object.assign(p.prototype,
{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(a){console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().");return this.setFromMatrixPosition(a)},getScaleFromMatrix:function(a){console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().");
return this.setFromMatrixScale(a)},getColumnFromMatrix:function(a,b){console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().");return this.setFromMatrixColumn(b,a)},applyProjection:function(a){console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead.");return this.applyMatrix4(a)},fromAttribute:function(a,b,c){console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute().");return this.fromBufferAttribute(a,
b,c)},distanceToManhattan:function(a){console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo().");return this.manhattanDistanceTo(a)},lengthManhattan:function(){console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength().");return this.manhattanLength()}});Object.assign(V.prototype,{fromAttribute:function(a,b,c){console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute().");return this.fromBufferAttribute(a,
b,c)},lengthManhattan:function(){console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength().");return this.manhattanLength()}});Object.assign(R.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}});Object.assign(D.prototype,{getChildByName:function(a){console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().");
return this.getObjectByName(a)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(a,b){console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.");return this.translateOnAxis(b,a)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}});Object.defineProperties(D.prototype,
{eulerOrder:{get:function(){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order.");return this.rotation.order},set:function(a){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order.");this.rotation.order=a}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}});
Object.defineProperties(Dc.prototype,{objects:{get:function(){console.warn("THREE.LOD: .objects has been renamed to .levels.");return this.levels}}});Object.defineProperty(Ec.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}});Object.defineProperty(M.prototype,"__arcLengthDivisions",{get:function(){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.");
return this.arcLengthDivisions},set:function(a){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.");this.arcLengthDivisions=a}});Z.prototype.setLens=function(a,b){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup.");void 0!==b&&(this.filmGauge=b);this.setFocalLength(a)};Object.defineProperties(X.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(a){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov.");
this.shadow.camera.fov=a}},shadowCameraLeft:{set:function(a){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left.");this.shadow.camera.left=a}},shadowCameraRight:{set:function(a){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right.");this.shadow.camera.right=a}},shadowCameraTop:{set:function(a){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top.");this.shadow.camera.top=a}},shadowCameraBottom:{set:function(a){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.");
this.shadow.camera.bottom=a}},shadowCameraNear:{set:function(a){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near.");this.shadow.camera.near=a}},shadowCameraFar:{set:function(a){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far.");this.shadow.camera.far=a}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(a){console.warn("THREE.Light: .shadowBias is now .shadow.bias.");
this.shadow.bias=a}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(a){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.");this.shadow.mapSize.width=a}},shadowMapHeight:{set:function(a){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.");this.shadow.mapSize.height=a}}});Object.defineProperties(Q.prototype,{length:{get:function(){console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead.");
return this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}});Object.assign(C.prototype,{addIndex:function(a){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().");this.setIndex(a)},addDrawCall:function(a,b,c){void 0!==c&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.");console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup().");this.addGroup(a,b)},
clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().");this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}});Object.defineProperties(C.prototype,{drawcalls:{get:function(){console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups.");return this.groups}},offsets:{get:function(){console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups.");
return this.groups}}});Object.assign(Oa.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}});Object.defineProperties(Nd.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},
onUpdate:{value:function(){console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead.");return this}}});Object.defineProperties(O.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){console.warn("THREE.Material: .wrapRGB has been removed.");return new H}},shading:{get:function(){console.error("THREE."+this.type+
": .shading has been removed. Use the boolean .flatShading instead.")},set:function(a){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.");this.flatShading=1===a}}});Object.defineProperties(Fa.prototype,{metal:{get:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead.");return!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}});
Object.defineProperties(ta.prototype,{derivatives:{get:function(){console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives.");return this.extensions.derivatives},set:function(a){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.");this.extensions.derivatives=a}}});Object.assign($d.prototype,{animate:function(a){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop().");this.setAnimationLoop(a)},getCurrentRenderTarget:function(){console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget().");
return this.getRenderTarget()},getMaxAnisotropy:function(){console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy().");return this.capabilities.getMaxAnisotropy()},getPrecision:function(){console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision.");return this.capabilities.precision},resetGLState:function(){console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset().");return this.state.reset()},supportsFloatTextures:function(){console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' ).");
return this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' ).");return this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' ).");return this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' ).");
return this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' ).");return this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' ).");return this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures.");
return this.capabilities.vertexTextures},supportsInstancedArrays:function(){console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' ).");return this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(a){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().");this.setScissorTest(a)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},
addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")}});Object.defineProperties($d.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.");
this.shadowMap.enabled=a}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.");this.shadowMap.type=a}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}});Object.defineProperties(af.prototype,
{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},
renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});Object.defineProperties(gb.prototype,{wrapS:{get:function(){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.");return this.texture.wrapS},set:function(a){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.");
this.texture.wrapS=a}},wrapT:{get:function(){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.");return this.texture.wrapT},set:function(a){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.");this.texture.wrapT=a}},magFilter:{get:function(){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.");return this.texture.magFilter},set:function(a){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.");this.texture.magFilter=
a}},minFilter:{get:function(){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.");return this.texture.minFilter},set:function(a){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.");this.texture.minFilter=a}},anisotropy:{get:function(){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.");return this.texture.anisotropy},set:function(a){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.");this.texture.anisotropy=
a}},offset:{get:function(){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset.");return this.texture.offset},set:function(a){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset.");this.texture.offset=a}},repeat:{get:function(){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat.");return this.texture.repeat},set:function(a){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat.");this.texture.repeat=a}},format:{get:function(){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format.");
return this.texture.format},set:function(a){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format.");this.texture.format=a}},type:{get:function(){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type.");return this.texture.type},set:function(a){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type.");this.texture.type=a}},generateMipmaps:{get:function(){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.");return this.texture.generateMipmaps},
set:function(a){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.");this.texture.generateMipmaps=a}}});Object.defineProperties(cf.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}}});ic.prototype.load=function(a){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var b=this;(new me).load(a,function(a){b.setBuffer(a)});return this};qe.prototype.getData=function(){console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData().");
return this.getFrequencyData()};fd.prototype.updateCubeMap=function(a,b){console.warn("THREE.CubeCamera: .updateCubeMap() is now .update().");return this.update(a,b)};fb.crossOrigin=void 0;fb.loadTexture=function(a,b,c,d){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var e=new xd;e.setCrossOrigin(this.crossOrigin);a=e.load(a,c,void 0,d);b&&(a.mapping=b);return a};fb.loadTextureCube=function(a,b,c,d){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");
var e=new fe;e.setCrossOrigin(this.crossOrigin);a=e.load(a,c,void 0,d);b&&(a.mapping=b);return a};fb.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")};fb.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};l.WebGLRenderTargetCube=Hb;l.WebGLRenderTarget=gb;l.WebGLRenderer=$d;l.ShaderLib=ob;l.UniformsLib=L;l.UniformsUtils=
Aa;l.ShaderChunk=S;l.FogExp2=Mb;l.Fog=Nb;l.Scene=sd;l.Sprite=Cc;l.LOD=Dc;l.SkinnedMesh=ud;l.Skeleton=Ec;l.Bone=td;l.Mesh=ka;l.LineSegments=W;l.LineLoop=vd;l.Line=sa;l.Points=Pb;l.Group=Lb;l.VideoTexture=ae;l.DataTexture=hb;l.CompressedTexture=Qb;l.CubeTexture=Ua;l.CanvasTexture=Fc;l.DepthTexture=Gc;l.Texture=T;l.CompressedTextureLoader=mf;l.DataTextureLoader=ee;l.CubeTextureLoader=fe;l.TextureLoader=xd;l.ObjectLoader=of;l.MaterialLoader=Md;l.BufferGeometryLoader=he;l.DefaultLoadingManager=la;l.LoadingManager=
de;l.JSONLoader=ie;l.ImageLoader=ad;l.ImageBitmapLoader=je;l.FontLoader=pf;l.FileLoader=Ga;l.Loader=hc;l.LoaderUtils=Ee;l.Cache=Gb;l.AudioLoader=me;l.SpotLightShadow=zd;l.SpotLight=Ad;l.PointLight=Bd;l.RectAreaLight=Fd;l.HemisphereLight=yd;l.DirectionalLightShadow=Cd;l.DirectionalLight=Dd;l.AmbientLight=Ed;l.LightShadow=Db;l.Light=X;l.StereoCamera=qf;l.PerspectiveCamera=Z;l.OrthographicCamera=Ib;l.CubeCamera=fd;l.ArrayCamera=Ac;l.Camera=Na;l.AudioListener=ne;l.PositionalAudio=pe;l.AudioContext=oe;
l.AudioAnalyser=qe;l.Audio=ic;l.VectorKeyframeTrack=gc;l.StringKeyframeTrack=Ld;l.QuaternionKeyframeTrack=ed;l.NumberKeyframeTrack=fc;l.ColorKeyframeTrack=Jd;l.BooleanKeyframeTrack=Id;l.PropertyMixer=re;l.PropertyBinding=pa;l.KeyframeTrack=oa;l.AnimationUtils=ia;l.AnimationObjectGroup=sf;l.AnimationMixer=se;l.AnimationClip=Ca;l.Uniform=Nd;l.InstancedBufferGeometry=te;l.BufferGeometry=C;l.Geometry=R;l.InterleavedBufferAttribute=Bc;l.InstancedInterleavedBuffer=ue;l.InterleavedBuffer=pb;l.InstancedBufferAttribute=
ve;l.Face3=Ta;l.Object3D=D;l.Raycaster=uf;l.Layers=Td;l.EventDispatcher=ya;l.Clock=wf;l.QuaternionLinearInterpolant=Kd;l.LinearInterpolant=dd;l.DiscreteInterpolant=Hd;l.CubicInterpolant=Gd;l.Interpolant=wa;l.Triangle=ja;l.Math=G;l.Spherical=xf;l.Cylindrical=yf;l.Plane=Ma;l.Frustum=od;l.Sphere=Da;l.Ray=nb;l.Matrix4=J;l.Matrix3=ra;l.Box3=Sa;l.Box2=xe;l.Line3=ye;l.Euler=ib;l.Vector4=V;l.Vector3=p;l.Vector2=A;l.Quaternion=fa;l.Color=H;l.ImmediateRenderObject=gd;l.VertexNormalsHelper=hd;l.SpotLightHelper=
jc;l.SkeletonHelper=kc;l.PointLightHelper=lc;l.RectAreaLightHelper=mc;l.HemisphereLightHelper=nc;l.GridHelper=id;l.PolarGridHelper=Od;l.FaceNormalsHelper=jd;l.DirectionalLightHelper=oc;l.CameraHelper=kd;l.BoxHelper=Eb;l.Box3Helper=ld;l.PlaneHelper=md;l.ArrowHelper=Fb;l.AxesHelper=nd;l.Shape=eb;l.Path=La;l.ShapePath=ke;l.Font=le;l.CurvePath=Ya;l.Curve=M;l.ImageUtils=fb;l.ShapeUtils=Wa;l.WebGLUtils=bf;l.Extensions=Va;l.WireframeGeometry=Rb;l.ParametricGeometry=Hc;l.ParametricBufferGeometry=Sb;l.TetrahedronGeometry=
Jc;l.TetrahedronBufferGeometry=Tb;l.OctahedronGeometry=Kc;l.OctahedronBufferGeometry=qb;l.IcosahedronGeometry=Lc;l.IcosahedronBufferGeometry=Ub;l.DodecahedronGeometry=Mc;l.DodecahedronBufferGeometry=Vb;l.PolyhedronGeometry=Ic;l.PolyhedronBufferGeometry=na;l.TubeGeometry=Nc;l.TubeBufferGeometry=Wb;l.TorusKnotGeometry=Oc;l.TorusKnotBufferGeometry=Xb;l.TorusGeometry=Pc;l.TorusBufferGeometry=Yb;l.TextGeometry=Uc;l.TextBufferGeometry=Zb;l.SphereGeometry=Vc;l.SphereBufferGeometry=tb;l.RingGeometry=Wc;l.RingBufferGeometry=
$b;l.PlaneGeometry=wc;l.PlaneBufferGeometry=mb;l.LatheGeometry=Xc;l.LatheBufferGeometry=ac;l.ShapeGeometry=ub;l.ShapeBufferGeometry=vb;l.ExtrudeGeometry=sb;l.ExtrudeBufferGeometry=Oa;l.EdgesGeometry=bc;l.ConeGeometry=Yc;l.ConeBufferGeometry=Zc;l.CylinderGeometry=wb;l.CylinderBufferGeometry=Xa;l.CircleGeometry=$c;l.CircleBufferGeometry=cc;l.BoxGeometry=Jb;l.BoxBufferGeometry=lb;l.ShadowMaterial=xb;l.SpriteMaterial=db;l.RawShaderMaterial=dc;l.ShaderMaterial=ta;l.PointsMaterial=Ea;l.MeshPhysicalMaterial=
yb;l.MeshStandardMaterial=Pa;l.MeshPhongMaterial=Fa;l.MeshToonMaterial=zb;l.MeshNormalMaterial=Ab;l.MeshLambertMaterial=Bb;l.MeshDepthMaterial=ab;l.MeshDistanceMaterial=bb;l.MeshBasicMaterial=da;l.LineDashedMaterial=Cb;l.LineBasicMaterial=Y;l.Material=O;l.Float64BufferAttribute=uc;l.Float32BufferAttribute=z;l.Uint32BufferAttribute=kb;l.Int32BufferAttribute=tc;l.Uint16BufferAttribute=jb;l.Int16BufferAttribute=sc;l.Uint8ClampedBufferAttribute=rc;l.Uint8BufferAttribute=qc;l.Int8BufferAttribute=pc;l.BufferAttribute=
Q;l.ArcCurve=ec;l.CatmullRomCurve3=ca;l.CubicBezierCurve=Ha;l.CubicBezierCurve3=Qa;l.EllipseCurve=za;l.LineCurve=va;l.LineCurve3=Ia;l.QuadraticBezierCurve=Ja;l.QuadraticBezierCurve3=Ra;l.SplineCurve=Ka;l.REVISION="95";l.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2};l.CullFaceNone=0;l.CullFaceBack=1;l.CullFaceFront=2;l.CullFaceFrontBack=3;l.FrontFaceDirectionCW=0;l.FrontFaceDirectionCCW=1;l.BasicShadowMap=0;l.PCFShadowMap=1;l.PCFSoftShadowMap=2;l.FrontSide=0;l.BackSide=1;l.DoubleSide=2;l.FlatShading=1;l.SmoothShading=
2;l.NoColors=0;l.FaceColors=1;l.VertexColors=2;l.NoBlending=0;l.NormalBlending=1;l.AdditiveBlending=2;l.SubtractiveBlending=3;l.MultiplyBlending=4;l.CustomBlending=5;l.AddEquation=100;l.SubtractEquation=101;l.ReverseSubtractEquation=102;l.MinEquation=103;l.MaxEquation=104;l.ZeroFactor=200;l.OneFactor=201;l.SrcColorFactor=202;l.OneMinusSrcColorFactor=203;l.SrcAlphaFactor=204;l.OneMinusSrcAlphaFactor=205;l.DstAlphaFactor=206;l.OneMinusDstAlphaFactor=207;l.DstColorFactor=208;l.OneMinusDstColorFactor=
209;l.SrcAlphaSaturateFactor=210;l.NeverDepth=0;l.AlwaysDepth=1;l.LessDepth=2;l.LessEqualDepth=3;l.EqualDepth=4;l.GreaterEqualDepth=5;l.GreaterDepth=6;l.NotEqualDepth=7;l.MultiplyOperation=0;l.MixOperation=1;l.AddOperation=2;l.NoToneMapping=0;l.LinearToneMapping=1;l.ReinhardToneMapping=2;l.Uncharted2ToneMapping=3;l.CineonToneMapping=4;l.UVMapping=300;l.CubeReflectionMapping=301;l.CubeRefractionMapping=302;l.EquirectangularReflectionMapping=303;l.EquirectangularRefractionMapping=304;l.SphericalReflectionMapping=
305;l.CubeUVReflectionMapping=306;l.CubeUVRefractionMapping=307;l.RepeatWrapping=1E3;l.ClampToEdgeWrapping=1001;l.MirroredRepeatWrapping=1002;l.NearestFilter=1003;l.NearestMipMapNearestFilter=1004;l.NearestMipMapLinearFilter=1005;l.LinearFilter=1006;l.LinearMipMapNearestFilter=1007;l.LinearMipMapLinearFilter=1008;l.UnsignedByteType=1009;l.ByteType=1010;l.ShortType=1011;l.UnsignedShortType=1012;l.IntType=1013;l.UnsignedIntType=1014;l.FloatType=1015;l.HalfFloatType=1016;l.UnsignedShort4444Type=1017;
l.UnsignedShort5551Type=1018;l.UnsignedShort565Type=1019;l.UnsignedInt248Type=1020;l.AlphaFormat=1021;l.RGBFormat=1022;l.RGBAFormat=1023;l.LuminanceFormat=1024;l.LuminanceAlphaFormat=1025;l.RGBEFormat=1023;l.DepthFormat=1026;l.DepthStencilFormat=1027;l.RGB_S3TC_DXT1_Format=33776;l.RGBA_S3TC_DXT1_Format=33777;l.RGBA_S3TC_DXT3_Format=33778;l.RGBA_S3TC_DXT5_Format=33779;l.RGB_PVRTC_4BPPV1_Format=35840;l.RGB_PVRTC_2BPPV1_Format=35841;l.RGBA_PVRTC_4BPPV1_Format=35842;l.RGBA_PVRTC_2BPPV1_Format=35843;l.RGB_ETC1_Format=
36196;l.RGBA_ASTC_4x4_Format=37808;l.RGBA_ASTC_5x4_Format=37809;l.RGBA_ASTC_5x5_Format=37810;l.RGBA_ASTC_6x5_Format=37811;l.RGBA_ASTC_6x6_Format=37812;l.RGBA_ASTC_8x5_Format=37813;l.RGBA_ASTC_8x6_Format=37814;l.RGBA_ASTC_8x8_Format=37815;l.RGBA_ASTC_10x5_Format=37816;l.RGBA_ASTC_10x6_Format=37817;l.RGBA_ASTC_10x8_Format=37818;l.RGBA_ASTC_10x10_Format=37819;l.RGBA_ASTC_12x10_Format=37820;l.RGBA_ASTC_12x12_Format=37821;l.LoopOnce=2200;l.LoopRepeat=2201;l.LoopPingPong=2202;l.InterpolateDiscrete=2300;
l.InterpolateLinear=2301;l.InterpolateSmooth=2302;l.ZeroCurvatureEnding=2400;l.ZeroSlopeEnding=2401;l.WrapAroundEnding=2402;l.TrianglesDrawMode=0;l.TriangleStripDrawMode=1;l.TriangleFanDrawMode=2;l.LinearEncoding=3E3;l.sRGBEncoding=3001;l.GammaEncoding=3007;l.RGBEEncoding=3002;l.LogLuvEncoding=3003;l.RGBM7Encoding=3004;l.RGBM16Encoding=3005;l.RGBDEncoding=3006;l.BasicDepthPacking=3200;l.RGBADepthPacking=3201;l.TangentSpaceNormalMap=0;l.ObjectSpaceNormalMap=1;l.CubeGeometry=Jb;l.Face4=function(a,b,
c,d,e,f,g){console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead.");return new Ta(a,b,c,e,f,g)};l.LineStrip=0;l.LinePieces=1;l.MeshFaceMaterial=function(a){console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead.");return a};l.MultiMaterial=function(a){void 0===a&&(a=[]);console.warn("THREE.MultiMaterial has been removed. Use an Array instead.");a.isMultiMaterial=!0;a.materials=a;a.clone=function(){return a.slice()};return a};l.PointCloud=function(a,
b){console.warn("THREE.PointCloud has been renamed to THREE.Points.");return new Pb(a,b)};l.Particle=function(a){console.warn("THREE.Particle has been renamed to THREE.Sprite.");return new Cc(a)};l.ParticleSystem=function(a,b){console.warn("THREE.ParticleSystem has been renamed to THREE.Points.");return new Pb(a,b)};l.PointCloudMaterial=function(a){console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.");return new Ea(a)};l.ParticleBasicMaterial=function(a){console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.");
return new Ea(a)};l.ParticleSystemMaterial=function(a){console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.");return new Ea(a)};l.Vertex=function(a,b,c){console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead.");return new p(a,b,c)};l.DynamicBufferAttribute=function(a,b){console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead.");return(new Q(a,b)).setDynamic(!0)};l.Int8Attribute=function(a,
b){console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead.");return new pc(a,b)};l.Uint8Attribute=function(a,b){console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead.");return new qc(a,b)};l.Uint8ClampedAttribute=function(a,b){console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead.");return new rc(a,b)};l.Int16Attribute=function(a,b){console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead.");
return new sc(a,b)};l.Uint16Attribute=function(a,b){console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead.");return new jb(a,b)};l.Int32Attribute=function(a,b){console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead.");return new tc(a,b)};l.Uint32Attribute=function(a,b){console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead.");return new kb(a,b)};l.Float32Attribute=
function(a,b){console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead.");return new z(a,b)};l.Float64Attribute=function(a,b){console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead.");return new uc(a,b)};l.ClosedSplineCurve3=Af;l.SplineCurve3=Bf;l.Spline=Ae;l.AxisHelper=function(a){console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper.");return new nd(a)};l.BoundingBoxHelper=function(a,b){console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead.");
return new Eb(a,b)};l.EdgesHelper=function(a,b){console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead.");return new W(new bc(a.geometry),new Y({color:void 0!==b?b:16777215}))};l.WireframeHelper=function(a,b){console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead.");return new W(new Rb(a.geometry),new Y({color:void 0!==b?b:16777215}))};l.XHRLoader=function(a){console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader.");return new Ga(a)};
l.BinaryTextureLoader=function(a){console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader.");return new ee(a)};l.GeometryUtils={merge:function(a,b,c){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");if(b.isMesh){b.matrixAutoUpdate&&b.updateMatrix();var d=b.matrix;b=b.geometry}a.merge(b,d,c)},center:function(a){console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.");
return a.center()}};l.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js.");this.projectVector=function(a,b){console.warn("THREE.Projector: .projectVector() is now vector.project().");a.project(b)};this.unprojectVector=function(a,b){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject().");a.unproject(b)};this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}};l.CanvasRenderer=
function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js");this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");this.clear=function(){};this.render=function(){};this.setClearColor=function(){};this.setSize=function(){}};l.SceneUtils={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},
attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}};l.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")};Object.defineProperty(l,"__esModule",{value:!0})});

/*! verb 2017-01-16 */
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.verb=a()}}(function(){var a={},b=this,c=(new Function("try {return this===window;}catch(e){ return false;}"),new Function("try {return this===global;}catch(e){return false;}")),d=new Function("try {return typeof importScripts === 'function';}catch(e){return false;}");if(c()&&!d()&&(console.log(typeof e),Worker=require("webworker-threads").Worker),c()||d()){var e=b;if(d()){var f=function(a,c){var d=b;return a.split(".").forEach(function(a){d&&(d=d[a])}),d?d[c]:null};onmessage=function(a){if(a.data.className&&a.data.methodName){var b=f(a.data.className,a.data.methodName);return b?void postMessage({result:b.apply(null,a.data.args),id:a.data.id}):console.error("could not find "+a.data.className+"."+a.data.methodName)}}}}return function(a,b,c){"use strict";function d(a,b){function c(){}c.prototype=a;var d=new c;for(var e in b)d[e]=b[e];return b.toString!==Object.prototype.toString&&(d.toString=b.toString),d}function e(a){return a instanceof Array?function(){return i.iter(a)}:"function"==typeof a.iterator?f(a,a.iterator):a.iterator}function f(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=ib++);var c;return null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__],null==c&&(c=function(){return c.method.apply(c.scope,arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c),c}b.geom=b.geom||{},b.exe=b.exe||{},b.eval=b.eval||{},b.core=b.core||{},b.promhx=b.promhx||{};var g={},h=function(){return D.__string_rec(this,"")},i=function(){};g.HxOverrides=i,i.__name__=["HxOverrides"],i.strDate=function(a){var b=a.length;switch(b){case 8:var c=a.split(":"),d=new Date;return d.setTime(0),d.setUTCHours(c[0]),d.setUTCMinutes(c[1]),d.setUTCSeconds(c[2]),d;case 10:var e=a.split("-");return new Date(e[0],e[1]-1,e[2],0,0,0);case 19:var f=a.split(" "),g=f[0].split("-"),h=f[1].split(":");return new Date(g[0],g[1]-1,g[2],h[0],h[1],h[2]);default:throw new C("Invalid date format : "+a)}},i.cca=function(a,b){var c=a.charCodeAt(b);if(c==c)return c},i.substr=function(a,b,c){return null!=b&&0!=b&&null!=c&&c<0?"":(null==c&&(c=a.length),b<0?(b=a.length+b,b<0&&(b=0)):c<0&&(c=a.length+c-b),a.substr(b,c))},i.iter=function(a){return{cur:0,arr:a,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var j=function(){};g.Lambda=j,j.__name__=["Lambda"],j.fold=function(a,b,c){for(var d=e(a)();d.hasNext();){var f=d.next();c=b(f,c)}return c};var k=function(){this.length=0};g.List=k,k.__name__=["List"],k.prototype={add:function(a){var b=[a];null==this.h?this.h=b:this.q[1]=b,this.q=b,this.length++},pop:function(){if(null==this.h)return null;var a=this.h[0];return this.h=this.h[1],null==this.h&&(this.q=null),this.length--,a},isEmpty:function(){return null==this.h},__class__:k},Math.__name__=["Math"];var l=function(){};g.Reflect=l,l.__name__=["Reflect"],l.field=function(a,b){try{return a[b]}catch(c){return c instanceof C&&(c=c.val),null}},l.callMethod=function(a,b,c){return b.apply(a,c)},l.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty;for(var d in a)"__id__"!=d&&"hx__closures__"!=d&&c.call(a,d)&&b.push(d)}return b},l.isFunction=function(a){return"function"==typeof a&&!(a.__name__||a.__ename__)},l.deleteField=function(a,b){return!!Object.prototype.hasOwnProperty.call(a,b)&&(delete a[b],!0)};var m=function(){};g.Std=m,m.__name__=["Std"],m.string=function(a){return D.__string_rec(a,"")},m.parseFloat=function(a){return parseFloat(a)};var n=function(){this.b=""};g.StringBuf=n,n.__name__=["StringBuf"],n.prototype={add:function(a){this.b+=m.string(a)},__class__:n};var o=function(){};g.StringTools=o,o.__name__=["StringTools"],o.fastCodeAt=function(a,b){return a.charCodeAt(b)};var p=g.ValueType={__ename__:["ValueType"],__constructs__:["TNull","TInt","TFloat","TBool","TObject","TFunction","TClass","TEnum","TUnknown"]};p.TNull=["TNull",0],p.TNull.toString=h,p.TNull.__enum__=p,p.TInt=["TInt",1],p.TInt.toString=h,p.TInt.__enum__=p,p.TFloat=["TFloat",2],p.TFloat.toString=h,p.TFloat.__enum__=p,p.TBool=["TBool",3],p.TBool.toString=h,p.TBool.__enum__=p,p.TObject=["TObject",4],p.TObject.toString=h,p.TObject.__enum__=p,p.TFunction=["TFunction",5],p.TFunction.toString=h,p.TFunction.__enum__=p,p.TClass=function(a){var b=["TClass",6,a];return b.__enum__=p,b.toString=h,b},p.TEnum=function(a){var b=["TEnum",7,a];return b.__enum__=p,b.toString=h,b},p.TUnknown=["TUnknown",8],p.TUnknown.toString=h,p.TUnknown.__enum__=p;var q=function(){};g.Type=q,q.__name__=["Type"],q.getClassName=function(a){var b=a.__name__;return null==b?null:b.join(".")},q.getEnumName=function(a){var b=a.__ename__;return b.join(".")},q.resolveClass=function(a){var b=g[a];return null!=b&&b.__name__?b:null},q.resolveEnum=function(a){var b=g[a];return null!=b&&b.__ename__?b:null},q.createEmptyInstance=function(a){function b(){}return b.prototype=a.prototype,new b},q.createEnum=function(a,b,c){var d=l.field(a,b);if(null==d)throw new C("No such constructor "+b);if(l.isFunction(d)){if(null==c)throw new C("Constructor "+b+" need parameters");return l.callMethod(a,d,c)}if(null!=c&&0!=c.length)throw new C("Constructor "+b+" does not need parameters");return d},q.getEnumConstructs=function(a){var b=a.__constructs__;return b.slice()},q.typeof=function(a){var b=typeof a;switch(b){case"boolean":return p.TBool;case"string":return p.TClass(String);case"number":return Math.ceil(a)==a%2147483648?p.TInt:p.TFloat;case"object":if(null==a)return p.TNull;var c=a.__enum__;if(null!=c)return p.TEnum(c);var d=D.getClass(a);return null!=d?p.TClass(d):p.TObject;case"function":return a.__name__||a.__ename__?p.TObject:p.TFunction;case"undefined":return p.TNull;default:return p.TUnknown}};var r=function(){};g["haxe.IMap"]=r,r.__name__=["haxe","IMap"];var s=function(a,b){this.high=a,this.low=b};g["haxe._Int64.___Int64"]=s,s.__name__=["haxe","_Int64","___Int64"],s.prototype={__class__:s};var t=function(){this.buf=new n,this.cache=[],this.useCache=t.USE_CACHE,this.useEnumIndex=t.USE_ENUM_INDEX,this.shash=new y,this.scount=0};g["haxe.Serializer"]=t,t.__name__=["haxe","Serializer"],t.prototype={toString:function(){return this.buf.b},serializeString:function(a){var b=this.shash.get(a);return null!=b?(this.buf.b+="R",void(null==b?this.buf.b+="null":this.buf.b+=""+b)):(this.shash.set(a,this.scount++),this.buf.b+="y",a=encodeURIComponent(a),null==a.length?this.buf.b+="null":this.buf.b+=""+a.length,this.buf.b+=":",void(null==a?this.buf.b+="null":this.buf.b+=""+a))},serializeRef:function(a){for(var b=typeof a,c=0,d=this.cache.length;c<d;){var e=c++,f=this.cache[e];if(typeof f==b&&f==a)return this.buf.b+="r",null==e?this.buf.b+="null":this.buf.b+=""+e,!0}return this.cache.push(a),!1},serializeFields:function(a){for(var b=0,c=l.fields(a);b<c.length;){var d=c[b];++b,this.serializeString(d),this.serialize(l.field(a,d))}this.buf.b+="g"},serialize:function(a){var b=q.typeof(a);switch(b[1]){case 0:this.buf.b+="n";break;case 1:var c=a;if(0==c)return void(this.buf.b+="z");this.buf.b+="i",null==c?this.buf.b+="null":this.buf.b+=""+c;break;case 2:var d=a;isNaN(d)?this.buf.b+="k":isFinite(d)?(this.buf.b+="d",null==d?this.buf.b+="null":this.buf.b+=""+d):d<0?this.buf.b+="m":this.buf.b+="p";break;case 3:a?this.buf.b+="t":this.buf.b+="f";break;case 6:var e=b[2];if(e==String)return void this.serializeString(a);if(this.useCache&&this.serializeRef(a))return;switch(e){case Array:var f=0;this.buf.b+="a";for(var g=a.length,h=0;h<g;){var i=h++;null==a[i]?f++:(f>0&&(1==f?this.buf.b+="n":(this.buf.b+="u",null==f?this.buf.b+="null":this.buf.b+=""+f),f=0),this.serialize(a[i]))}f>0&&(1==f?this.buf.b+="n":(this.buf.b+="u",null==f?this.buf.b+="null":this.buf.b+=""+f)),this.buf.b+="h";break;case k:this.buf.b+="l";for(var j=a,o=j.h,p=null;null!=o;){var r;p=o[0],o=o[1],r=p,this.serialize(r)}this.buf.b+="h";break;case Date:var s=a;this.buf.b+="v",this.buf.add(s.getTime());break;case y:this.buf.b+="b";for(var u=a,x=u.keys();x.hasNext();){var A=x.next();this.serializeString(A),this.serialize(null!=pb[A]?u.getReserved(A):u.h[A])}this.buf.b+="h";break;case v:this.buf.b+="q";for(var B=a,E=B.keys();E.hasNext();){var F=E.next();this.buf.b+=":",null==F?this.buf.b+="null":this.buf.b+=""+F,this.serialize(B.h[F])}this.buf.b+="h";break;case w:this.buf.b+="M";for(var G=a,H=G.keys();H.hasNext();){var I=H.next(),J=l.field(I,"__id__");l.deleteField(I,"__id__"),this.serialize(I),I.__id__=J,this.serialize(G.h[I.__id__])}this.buf.b+="h";break;case z:for(var K=a,L=0,M=K.length-2,N=new n,O=t.BASE64;L<M;){var P=K.get(L++),Q=K.get(L++),R=K.get(L++);N.add(O.charAt(P>>2)),N.add(O.charAt(63&(P<<4|Q>>4))),N.add(O.charAt(63&(Q<<2|R>>6))),N.add(O.charAt(63&R))}if(L==M){var S=K.get(L++),T=K.get(L++);N.add(O.charAt(S>>2)),N.add(O.charAt(63&(S<<4|T>>4))),N.add(O.charAt(T<<2&63))}else if(L==M+1){var U=K.get(L++);N.add(O.charAt(U>>2)),N.add(O.charAt(U<<4&63))}var V=N.b;this.buf.b+="s",null==V.length?this.buf.b+="null":this.buf.b+=""+V.length,this.buf.b+=":",null==V?this.buf.b+="null":this.buf.b+=""+V;break;default:this.useCache&&this.cache.pop(),null!=a.hxSerialize?(this.buf.b+="C",this.serializeString(q.getClassName(e)),this.useCache&&this.cache.push(a),a.hxSerialize(this),this.buf.b+="g"):(this.buf.b+="c",this.serializeString(q.getClassName(e)),this.useCache&&this.cache.push(a),this.serializeFields(a))}break;case 4:if(D.__instanceof(a,nb)){var W=q.getClassName(a);this.buf.b+="A",this.serializeString(W)}else if(D.__instanceof(a,ob))this.buf.b+="B",this.serializeString(q.getEnumName(a));else{if(this.useCache&&this.serializeRef(a))return;this.buf.b+="o",this.serializeFields(a)}break;case 7:var X=b[2];if(this.useCache){if(this.serializeRef(a))return;this.cache.pop()}this.useEnumIndex?this.buf.b+="j":this.buf.b+="w",this.serializeString(q.getEnumName(X)),this.useEnumIndex?(this.buf.b+=":",this.buf.b+=m.string(a[1])):this.serializeString(a[0]),this.buf.b+=":";var Y=a.length;this.buf.b+=m.string(Y-2);for(var Z=2;Z<Y;){var $=Z++;this.serialize(a[$])}this.useCache&&this.cache.push(a);break;case 5:throw new C("Cannot serialize function");default:throw new C("Cannot serialize "+m.string(a))}},__class__:t};var u=function(a){this.buf=a,this.length=a.length,this.pos=0,this.scache=[],this.cache=[];var b=u.DEFAULT_RESOLVER;null==b&&(b=q,u.DEFAULT_RESOLVER=b),this.setResolver(b)};g["haxe.Unserializer"]=u,u.__name__=["haxe","Unserializer"],u.initCodes=function(){for(var a=[],b=0,c=u.BASE64.length;b<c;){var d=b++;a[u.BASE64.charCodeAt(d)]=d}return a},u.prototype={setResolver:function(a){null==a?this.resolver={resolveClass:function(a){return null},resolveEnum:function(a){return null}}:this.resolver=a},get:function(a){return this.buf.charCodeAt(a)},readDigits:function(){for(var a=0,b=!1,c=this.pos;;){var d=this.buf.charCodeAt(this.pos);if(d!=d)break;if(45!=d){if(d<48||d>57)break;a=10*a+(d-48),this.pos++}else{if(this.pos!=c)break;b=!0,this.pos++}}return b&&(a*=-1),a},readFloat:function(){for(var a=this.pos;;){var b=this.buf.charCodeAt(this.pos);if(!(b>=43&&b<58||101==b||69==b))break;this.pos++}return m.parseFloat(i.substr(this.buf,a,this.pos-a))},unserializeObject:function(a){for(;;){if(this.pos>=this.length)throw new C("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var b=this.unserialize();if("string"!=typeof b)throw new C("Invalid object key");var c=this.unserialize();a[b]=c}this.pos++},unserializeEnum:function(a,b){if(58!=this.get(this.pos++))throw new C("Invalid enum format");var c=this.readDigits();if(0==c)return q.createEnum(a,b);for(var d=[];c-- >0;)d.push(this.unserialize());return q.createEnum(a,b,d)},unserialize:function(){var a=this.get(this.pos++);switch(a){case 110:return null;case 116:return!0;case 102:return!1;case 122:return 0;case 105:return this.readDigits();case 100:return this.readFloat();case 121:var b=this.readDigits();if(58!=this.get(this.pos++)||this.length-this.pos<b)throw new C("Invalid string length");var c=i.substr(this.buf,this.pos,b);return this.pos+=b,c=decodeURIComponent(c.split("+").join(" ")),this.scache.push(c),c;case 107:return NaN;case 109:return-(1/0);case 112:return 1/0;case 97:var d=(this.buf,[]);for(this.cache.push(d);;){var e=this.buf.charCodeAt(this.pos);if(104==e){this.pos++;break}if(117==e){this.pos++;var f=this.readDigits();d[d.length+f-1]=null}else d.push(this.unserialize())}return d;case 111:var g={};return this.cache.push(g),this.unserializeObject(g),g;case 114:var h=this.readDigits();if(h<0||h>=this.cache.length)throw new C("Invalid reference");return this.cache[h];case 82:var j=this.readDigits();if(j<0||j>=this.scache.length)throw new C("Invalid string reference");return this.scache[j];case 120:throw new C(this.unserialize());case 99:var l=this.unserialize(),m=this.resolver.resolveClass(l);if(null==m)throw new C("Class not found "+l);var n=q.createEmptyInstance(m);return this.cache.push(n),this.unserializeObject(n),n;case 119:var p=this.unserialize(),r=this.resolver.resolveEnum(p);if(null==r)throw new C("Enum not found "+p);var s=this.unserializeEnum(r,this.unserialize());return this.cache.push(s),s;case 106:var t=this.unserialize(),x=this.resolver.resolveEnum(t);if(null==x)throw new C("Enum not found "+t);this.pos++;var A=this.readDigits(),B=q.getEnumConstructs(x)[A];if(null==B)throw new C("Unknown enum index "+t+"@"+A);var D=this.unserializeEnum(x,B);return this.cache.push(D),D;case 108:var E=new k;this.cache.push(E);for(this.buf;104!=this.buf.charCodeAt(this.pos);)E.add(this.unserialize());return this.pos++,E;case 98:var F=new y;this.cache.push(F);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var G=this.unserialize();F.set(G,this.unserialize())}return this.pos++,F;case 113:var H=new v;this.cache.push(H);for(var I=(this.buf,this.get(this.pos++));58==I;){var J=this.readDigits();H.set(J,this.unserialize()),I=this.get(this.pos++)}if(104!=I)throw new C("Invalid IntMap format");return H;case 77:var K=new w;this.cache.push(K);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var L=this.unserialize();K.set(L,this.unserialize())}return this.pos++,K;case 118:var M;if(this.buf.charCodeAt(this.pos)>=48&&this.buf.charCodeAt(this.pos)<=57&&this.buf.charCodeAt(this.pos+1)>=48&&this.buf.charCodeAt(this.pos+1)<=57&&this.buf.charCodeAt(this.pos+2)>=48&&this.buf.charCodeAt(this.pos+2)<=57&&this.buf.charCodeAt(this.pos+3)>=48&&this.buf.charCodeAt(this.pos+3)<=57&&45==this.buf.charCodeAt(this.pos+4)){var N=i.substr(this.buf,this.pos,19);M=i.strDate(N),this.pos+=19}else{var O=this.readFloat(),P=new Date;P.setTime(O),M=P}return this.cache.push(M),M;case 115:var Q=this.readDigits(),R=this.buf;if(58!=this.get(this.pos++)||this.length-this.pos<Q)throw new C("Invalid bytes length");var S=u.CODES;null==S&&(S=u.initCodes(),u.CODES=S);var T,U=this.pos,V=3&Q;T=3*(Q>>2)+(V>=2?V-1:0);for(var W=U+(Q-V),X=z.alloc(T),Y=0;U<W;){var Z=S[o.fastCodeAt(R,U++)],$=S[o.fastCodeAt(R,U++)];X.set(Y++,Z<<2|$>>4);var _=S[o.fastCodeAt(R,U++)];X.set(Y++,$<<4|_>>2);var aa=S[o.fastCodeAt(R,U++)];X.set(Y++,_<<6|aa)}if(V>=2){var ba=S[o.fastCodeAt(R,U++)],ca=S[o.fastCodeAt(R,U++)];if(X.set(Y++,ba<<2|ca>>4),3==V){var da=S[o.fastCodeAt(R,U++)];X.set(Y++,ca<<4|da>>2)}}return this.pos+=Q,this.cache.push(X),X;case 67:var ea=this.unserialize(),fa=this.resolver.resolveClass(ea);if(null==fa)throw new C("Class not found "+ea);var ga=q.createEmptyInstance(fa);if(this.cache.push(ga),ga.hxUnserialize(this),103!=this.get(this.pos++))throw new C("Invalid custom data");return ga;case 65:var ha=this.unserialize(),ia=this.resolver.resolveClass(ha);if(null==ia)throw new C("Class not found "+ha);return ia;case 66:var ja=this.unserialize(),ka=this.resolver.resolveEnum(ja);if(null==ka)throw new C("Enum not found "+ja);return ka}throw this.pos--,new C("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:u};var v=function(){this.h={}};g["haxe.ds.IntMap"]=v,v.__name__=["haxe","ds","IntMap"],v.__interfaces__=[r],v.prototype={set:function(a,b){this.h[a]=b},remove:function(a){return!!this.h.hasOwnProperty(a)&&(delete this.h[a],!0)},keys:function(){var a=[];for(var b in this.h)this.h.hasOwnProperty(b)&&a.push(0|b);return i.iter(a)},__class__:v};var w=function(){this.h={},this.h.__keys__={}};g["haxe.ds.ObjectMap"]=w,w.__name__=["haxe","ds","ObjectMap"],w.__interfaces__=[r],w.prototype={set:function(a,b){var c=a.__id__||(a.__id__=++w.count);this.h[c]=b,this.h.__keys__[c]=a},keys:function(){var a=[];for(var b in this.h.__keys__)this.h.hasOwnProperty(b)&&a.push(this.h.__keys__[b]);return i.iter(a)},__class__:w};var x=g["haxe.ds.Option"]={__ename__:["haxe","ds","Option"],__constructs__:["Some","None"]};x.Some=function(a){var b=["Some",0,a];return b.__enum__=x,b.toString=h,b},x.None=["None",1],x.None.toString=h,x.None.__enum__=x;var y=function(){this.h={}};g["haxe.ds.StringMap"]=y,y.__name__=["haxe","ds","StringMap"],y.__interfaces__=[r],y.prototype={set:function(a,b){null!=pb[a]?this.setReserved(a,b):this.h[a]=b},get:function(a){return null!=pb[a]?this.getReserved(a):this.h[a]},setReserved:function(a,b){null==this.rh&&(this.rh={}),this.rh["$"+a]=b},getReserved:function(a){return null==this.rh?null:this.rh["$"+a]},keys:function(){var a=this.arrayKeys();return i.iter(a)},arrayKeys:function(){var a=[];for(var b in this.h)this.h.hasOwnProperty(b)&&a.push(b);if(null!=this.rh)for(var b in this.rh)36==b.charCodeAt(0)&&a.push(b.substr(1));return a},__class__:y};var z=function(a){this.length=a.byteLength,this.b=new rb(a),this.b.bufferValue=a,a.hxBytes=this,a.bytes=this.b};g["haxe.io.Bytes"]=z,z.__name__=["haxe","io","Bytes"],z.alloc=function(a){return new z(new qb(a))},z.prototype={get:function(a){return this.b[a]},set:function(a,b){this.b[a]=255&b},__class__:z};var A=g["haxe.io.Error"]={__ename__:["haxe","io","Error"],__constructs__:["Blocked","Overflow","OutsideBounds","Custom"]};A.Blocked=["Blocked",0],A.Blocked.toString=h,A.Blocked.__enum__=A,A.Overflow=["Overflow",1],A.Overflow.toString=h,A.Overflow.__enum__=A,A.OutsideBounds=["OutsideBounds",2],A.OutsideBounds.toString=h,A.OutsideBounds.__enum__=A,A.Custom=function(a){var b=["Custom",3,a];return b.__enum__=A,b.toString=h,b};var B=function(){};g["haxe.io.FPHelper"]=B,B.__name__=["haxe","io","FPHelper"],B.i32ToFloat=function(a){var b=1-(a>>>31<<1),c=a>>>23&255,d=8388607&a;return 0==d&&0==c?0:b*(1+Math.pow(2,-23)*d)*Math.pow(2,c-127)},B.floatToI32=function(a){if(0==a)return 0;var b;b=a<0?-a:a;var c=Math.floor(Math.log(b)/.6931471805599453);c<-127?c=-127:c>128&&(c=128);var d=8388607&Math.round(8388608*(b/Math.pow(2,c)-1));return(a<0?-2147483648:0)|c+127<<23|d},B.i64ToDouble=function(a,b){var c=1-(b>>>31<<1),d=(b>>20&2047)-1023,e=4294967296*(1048575&b)+2147483648*(a>>>31)+(2147483647&a);return 0==e&&d==-1023?0:c*(1+Math.pow(2,-52)*e)*Math.pow(2,d)},B.doubleToI64=function(a){var b=B.i64tmp;if(0==a)b.low=0,b.high=0;else{var c;c=a<0?-a:a;var d,e=Math.floor(Math.log(c)/.6931471805599453),f=4503599627370496*(c/Math.pow(2,e)-1);d=Math.round(f);var g=0|d,h=d/4294967296|0;b.low=g,b.high=(a<0?-2147483648:0)|e+1023<<20|h}return b};var C=function(a){Error.call(this),this.val=a,this.message=String(a),Error.captureStackTrace&&Error.captureStackTrace(this,C)};g["js._Boot.HaxeError"]=C,C.__name__=["js","_Boot","HaxeError"],C.__super__=Error,C.prototype=d(Error.prototype,{__class__:C});var D=function(){};g["js.Boot"]=D,D.__name__=["js","Boot"],D.getClass=function(a){if(a instanceof Array&&null==a.__enum__)return Array;var b=a.__class__;if(null!=b)return b;var c=D.__nativeClassName(a);return null!=c?D.__resolveNativeClass(c):null},D.__string_rec=function(a,b){if(null==a)return"null";if(b.length>=5)return"<...>";var c=typeof a;switch("function"==c&&(a.__name__||a.__ename__)&&(c="object"),c){case"object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];var d=a[0]+"(";b+="\t";for(var e=2,f=a.length;e<f;){var g=e++;d+=2!=g?","+D.__string_rec(a[g],b):D.__string_rec(a[g],b)}return d+")"}var h=a.length,i="[";b+="\t";for(var j=0;j<h;){var k=j++;i+=(k>0?",":"")+D.__string_rec(a[k],b)}return i+="]"}var l;try{l=a.toString}catch(m){return m instanceof C&&(m=m.val),"???"}if(null!=l&&l!=Object.toString&&"function"==typeof l){var n=a.toString();if("[object Object]"!=n)return n}var o=null,p="{\n";b+="\t";var q=null!=a.hasOwnProperty;for(var o in a)q&&!a.hasOwnProperty(o)||"prototype"!=o&&"__class__"!=o&&"__super__"!=o&&"__interfaces__"!=o&&"__properties__"!=o&&(2!=p.length&&(p+=", \n"),p+=b+o+" : "+D.__string_rec(a[o],b));return b=b.substring(1),p+="\n"+b+"}";case"function":return"<function>";case"string":return a;default:return String(a)}},D.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,e=c.length;d<e;){var f=d++,g=c[f];if(g==b||D.__interfLoop(g,b))return!0}return D.__interfLoop(a.__super__,b)},D.__instanceof=function(a,b){if(null==b)return!1;switch(b){case jb:return(0|a)===a;case lb:return"number"==typeof a;case mb:return"boolean"==typeof a;case String:return"string"==typeof a;case Array:return a instanceof Array&&null==a.__enum__;case kb:return!0;default:if(null==a)return!1;if("function"==typeof b){if(a instanceof b)return!0;if(D.__interfLoop(D.getClass(a),b))return!0}else if("object"==typeof b&&D.__isNativeObj(b)&&a instanceof b)return!0;return b==nb&&null!=a.__name__||(b==ob&&null!=a.__ename__||a.__enum__==b)}},D.__nativeClassName=function(a){var b=D.__toStr.call(a).slice(8,-1);return"Object"==b||"Function"==b||"Math"==b||"JSON"==b?null:b},D.__isNativeObj=function(a){return null!=D.__nativeClassName(a)},D.__resolveNativeClass=function(a){return c[a]};var E=function(a){if(a instanceof Array&&null==a.__enum__)this.a=a,this.byteLength=a.length;else{var b=a;this.a=[];for(var c=0;c<b;){var d=c++;this.a[d]=0}this.byteLength=b}};g["js.html.compat.ArrayBuffer"]=E,E.__name__=["js","html","compat","ArrayBuffer"],E.sliceImpl=function(a,b){var c=new rb(this,a,null==b?null:b-a),d=new qb(c.byteLength),e=new rb(d);return e.set(c),d},E.prototype={slice:function(a,b){return new E(this.a.slice(a,b))},__class__:E};var F=function(a,b,c){if(this.buf=a,null==b?this.offset=0:this.offset=b,null==c?this.length=a.byteLength-this.offset:this.length=c,this.offset<0||this.length<0||this.offset+this.length>a.byteLength)throw new C(A.OutsideBounds)};g["js.html.compat.DataView"]=F,F.__name__=["js","html","compat","DataView"],F.prototype={getInt8:function(a){var b=this.buf.a[this.offset+a];return b>=128?b-256:b},getUint8:function(a){return this.buf.a[this.offset+a]},getInt16:function(a,b){var c=this.getUint16(a,b);return c>=32768?c-65536:c},getUint16:function(a,b){return b?this.buf.a[this.offset+a]|this.buf.a[this.offset+a+1]<<8:this.buf.a[this.offset+a]<<8|this.buf.a[this.offset+a+1]},getInt32:function(a,b){var c=this.offset+a,d=this.buf.a[c++],e=this.buf.a[c++],f=this.buf.a[c++],g=this.buf.a[c++];return b?d|e<<8|f<<16|g<<24:g|f<<8|e<<16|d<<24},getUint32:function(a,b){var c=this.getInt32(a,b);return c<0?c+4294967296:c},getFloat32:function(a,b){return B.i32ToFloat(this.getInt32(a,b))},getFloat64:function(a,b){var c=this.getInt32(a,b),d=this.getInt32(a+4,b);return B.i64ToDouble(b?c:d,b?d:c)},setInt8:function(a,b){b<0?this.buf.a[a+this.offset]=b+128&255:this.buf.a[a+this.offset]=255&b},setUint8:function(a,b){this.buf.a[a+this.offset]=255&b},setInt16:function(a,b,c){this.setUint16(a,b<0?b+65536:b,c)},setUint16:function(a,b,c){var d=a+this.offset;c?(this.buf.a[d]=255&b,this.buf.a[d++]=b>>8&255):(this.buf.a[d++]=b>>8&255,this.buf.a[d]=255&b)},setInt32:function(a,b,c){this.setUint32(a,b,c)},setUint32:function(a,b,c){var d=a+this.offset;c?(this.buf.a[d++]=255&b,this.buf.a[d++]=b>>8&255,this.buf.a[d++]=b>>16&255,this.buf.a[d++]=b>>>24):(this.buf.a[d++]=b>>>24,this.buf.a[d++]=b>>16&255,this.buf.a[d++]=b>>8&255,this.buf.a[d++]=255&b)},setFloat32:function(a,b,c){this.setUint32(a,B.floatToI32(b),c)},setFloat64:function(a,b,c){var d=B.doubleToI64(b);c?(this.setUint32(a,d.low),this.setUint32(a,d.high)):(this.setUint32(a,d.high),this.setUint32(a,d.low))},__class__:F};var G=function(){};g["js.html.compat.Uint8Array"]=G,G.__name__=["js","html","compat","Uint8Array"],G._new=function(a,b,c){var d;if("number"==typeof a){d=[];for(var e=0;e<a;){var f=e++;d[f]=0}d.byteLength=d.length,d.byteOffset=0,d.buffer=new E(d)}else if(D.__instanceof(a,E)){var g=a;null==b&&(b=0),null==c&&(c=g.byteLength-b),d=0==b?g.a:g.a.slice(b,b+c),d.byteLength=d.length,d.byteOffset=b,d.buffer=g}else{if(!(a instanceof Array&&null==a.__enum__))throw new C("TODO "+m.string(a));d=a.slice(),d.byteLength=d.length,d.byteOffset=0,d.buffer=new E(d)}return d.subarray=G._subarray,d.set=G._set,d},G._set=function(a,b){var c=this;if(D.__instanceof(a.buffer,E)){var d=a;if(a.byteLength+b>c.byteLength)throw new C("set() outside of range");for(var e=0,f=a.byteLength;e<f;){var g=e++;c[g+b]=d[g]}}else{if(!(a instanceof Array&&null==a.__enum__))throw new C("TODO");var h=a;if(h.length+b>c.byteLength)throw new C("set() outside of range");for(var i=0,j=h.length;i<j;){var k=i++;c[k+b]=h[k]}}},G._subarray=function(a,b){var c=this,d=G._new(c.slice(a,b));return d.byteOffset=a,d};var H=function(a){this._resolved=!1,this._pending=!1,this._errorPending=!1,this._fulfilled=!1,this._update=[],this._error=[],this._errored=!1,null!=a&&H.link(a,this,function(a){return a})};g["promhx.base.AsyncBase"]=H,H.__name__=["promhx","base","AsyncBase"],H.link=function(a,b,c){a._update.push({async:b,linkf:function(a){b.handleResolve(c(a))}}),H.immediateLinkUpdate(a,b,c)},H.immediateLinkUpdate=function(a,b,c){if(!a._errored||a._errorPending||a._error.length>0||b.handleError(a._errorVal),a._resolved&&!a._pending)try{b.handleResolve(c(a._val))}catch(d){d instanceof C&&(d=d.val),b.handleError(d)}},H.linkAll=function(a,b){for(var c=function(c,d,f){if(0==c.length||H.allFulfilled(c)){for(var g,h=[],i=e(a)();i.hasNext();){var j=i.next();h.push(j==d?f:j._val)}g=h,b.handleResolve(g)}},d=e(a)();d.hasNext();){var f=d.next();f._update.push({async:b,linkf:function(a,b,c){return function(d){a(b,c,d)}}(c,function(b){for(var c,d=[],g=e(a)();g.hasNext();){var h=g.next();h!=f&&d.push(h)}return c=d}(this),f)})}H.allFulfilled(a)&&b.handleResolve(function(b){for(var c,d=[],f=e(a)();f.hasNext();){var g=f.next();d.push(g._val)}return c=d}(this))},H.pipeLink=function(a,b,c){var d=!1,e=function(a){if(!d){d=!0;var e=c(a);e._update.push({async:b,linkf:f(b,b.handleResolve)}),H.immediateLinkUpdate(e,b,function(a){return a})}};if(a._update.push({async:b,linkf:e}),a._resolved&&!a._pending)try{e(a._val)}catch(g){g instanceof C&&(g=g.val),b.handleError(g)}},H.allResolved=function(a){for(var b=e(a)();b.hasNext();){var c=b.next();if(!c._resolved)return!1}return!0},H.allFulfilled=function(a){for(var b=e(a)();b.hasNext();){var c=b.next();if(!c._fulfilled)return!1}return!0},H.prototype={catchError:function(a){return this._error.push(a),this},errorThen:function(a){return this._errorMap=a,this},isResolved:function(){return this._resolved},isErrored:function(){return this._errored},isErrorHandled:function(){return this._error.length>0},isErrorPending:function(){return this._errorPending},isFulfilled:function(){return this._fulfilled},isPending:function(){return this._pending},handleResolve:function(a){this._resolve(a)},_resolve:function(a){var b=this;this._pending?M.enqueue(function(a,b){return function(){a(b)}}(f(this,this._resolve),a)):(this._resolved=!0,this._pending=!0,M.queue.add(function(){b._val=a;for(var c=0,d=b._update;c<d.length;){var e=d[c];++c;try{e.linkf(a)}catch(f){f instanceof C&&(f=f.val),e.async.handleError(f)}}b._fulfilled=!0,b._pending=!1}),M.continueOnNextLoop())},handleError:function(a){this._handleError(a)},_handleError:function(a){var b=this,c=function(a){if(b._error.length>0)for(var c=0,d=b._error;c<d.length;){var e=d[c];++c,e(a)}else{if(!(b._update.length>0))throw new C(a);for(var f=0,g=b._update;f<g.length;){var h=g[f];++f,h.async.handleError(a)}}b._errorPending=!1};this._errorPending||(this._errorPending=!0,this._errored=!0,this._errorVal=a,M.queue.add(function(){if(null!=b._errorMap)try{b._resolve(b._errorMap(a))}catch(d){d instanceof C&&(d=d.val),c(d)}else c(a)}),M.continueOnNextLoop())},then:function(a){var b=new H(null);return H.link(this,b,a),b},unlink:function(a){var b=this;M.queue.add(function(){b._update=b._update.filter(function(b){return b.async!=a})}),M.continueOnNextLoop()},isLinked:function(a){for(var b=!1,c=0,d=this._update;c<d.length;){var e=d[c];if(++c,e.async==a)return!0}return b},__class__:H};var I=b.promhx.Deferred=function(){H.call(this)};g["promhx.Deferred"]=I,I.__name__=["promhx","Deferred"],I.__super__=H,I.prototype=d(H.prototype,{resolve:function(a){this.handleResolve(a)},throwError:function(a){this.handleError(a)},promise:function(){return new J(this)},stream:function(){return new K(this)},publicStream:function(){return new L(this)},__class__:I});var J=b.promhx.Promise=function(a){H.call(this,a),this._rejected=!1};g["promhx.Promise"]=J,J.__name__=["promhx","Promise"],J.whenAll=function(a){var b=new J(null);return H.linkAll(a,b),b},J.promise=function(a){var b=new J;return b.handleResolve(a),b},J.__super__=H,J.prototype=d(H.prototype,{isRejected:function(){return this._rejected},reject:function(a){this._rejected=!0,this.handleError(a)},handleResolve:function(a){if(this._resolved){var b="Promise has already been resolved";throw new C(N.AlreadyResolved(b))}this._resolve(a)},then:function(a){var b=new J(null);return H.link(this,b,a),b},unlink:function(a){var b=this;M.queue.add(function(){if(b._fulfilled)b._update=b._update.filter(function(b){return b.async!=a});else{var c="Downstream Promise is not fullfilled";b.handleError(N.DownstreamNotFullfilled(c))}}),M.continueOnNextLoop()},handleError:function(a){this._rejected=!0,this._handleError(a)},pipe:function(a){var b=new J(null);return H.pipeLink(this,b,a),b},errorPipe:function(a){var b=new J;return this.catchError(function(c){var d=a(c);d.then(f(b,b._resolve))}),this.then(f(b,b._resolve)),b},__class__:J});var K=b.promhx.Stream=function(a){H.call(this,a),this._end_promise=new J};g["promhx.Stream"]=K,K.__name__=["promhx","Stream"],K.foreach=function(a){for(var b=new K(null),c=e(a)();c.hasNext();){var d=c.next();b.handleResolve(d)}return b.end(),b},K.wheneverAll=function(a){var b=new K(null);return H.linkAll(a,b),b},K.concatAll=function(a){for(var b=new K(null),c=e(a)();c.hasNext();){var d=c.next();b.concat(d)}return b},K.mergeAll=function(a){for(var b=new K(null),c=e(a)();c.hasNext();){var d=c.next();b.merge(d)}return b},K.stream=function(a){var b=new K(null);return b.handleResolve(a),b},K.__super__=H,K.prototype=d(H.prototype,{then:function(a){var b=new K(null);return H.link(this,b,a),this._end_promise._update.push({async:b._end_promise,linkf:function(a){b.end()}}),b},detachStream:function(a){for(var b=[],c=!1,d=0,e=this._update;d<e.length;){var f=e[d];++d,f.async==a?(this._end_promise._update=this._end_promise._update.filter(function(b){return b.async!=a._end_promise}),c=!0):b.push(f)}return this._update=b,c},first:function(){var a=new J(null);return this.then(function(b){a._resolved||a.handleResolve(b)}),a},handleResolve:function(a){this._end||this._pause||this._resolve(a)},pause:function(a){null==a&&(a=!this._pause),this._pause=a},pipe:function(a){var b=new K(null);return H.pipeLink(this,b,a),this._end_promise.then(function(a){b.end()}),b},errorPipe:function(a){var b=new K(null);return this.catchError(function(c){var d=a(c);d.then(f(b,b._resolve)),d._end_promise.then((hb=b._end_promise,f(hb,hb._resolve)))}),this.then(f(b,b._resolve)),this._end_promise.then(function(a){b.end()}),b},handleEnd:function(){if(this._pending)M.queue.add(f(this,this.handleEnd)),M.continueOnNextLoop();else{if(this._end_promise._resolved)return;this._end=!0;var a;a=this._resolved?x.Some(this._val):x.None,this._end_promise.handleResolve(a),this._update=[],this._error=[]}},end:function(){return M.queue.add(f(this,this.handleEnd)),M.continueOnNextLoop(),
this},endThen:function(a){return this._end_promise.then(a)},filter:function(a){var b=new K(null);return this._update.push({async:b,linkf:function(c){a(c)&&b.handleResolve(c)}}),H.immediateLinkUpdate(this,b,function(a){return a}),b},concat:function(a){var b=new K(null);return this._update.push({async:b,linkf:f(b,b.handleResolve)}),H.immediateLinkUpdate(this,b,function(a){return a}),this._end_promise.then(function(c){a.pipe(function(a){return b.handleResolve(a),b}),a._end_promise.then(function(a){b.end()})}),b},merge:function(a){var b=new K(null);return this._update.push({async:b,linkf:f(b,b.handleResolve)}),a._update.push({async:b,linkf:f(b,b.handleResolve)}),H.immediateLinkUpdate(this,b,function(a){return a}),H.immediateLinkUpdate(a,b,function(a){return a}),b},__class__:K});var L=b.promhx.PublicStream=function(a){K.call(this,a)};g["promhx.PublicStream"]=L,L.__name__=["promhx","PublicStream"],L.publicstream=function(a){var b=new L(null);return b.handleResolve(a),b},L.__super__=K,L.prototype=d(K.prototype,{resolve:function(a){this.handleResolve(a)},throwError:function(a){this.handleError(a)},update:function(a){this.handleResolve(a)},__class__:L});var M=function(){};g["promhx.base.EventLoop"]=M,M.__name__=["promhx","base","EventLoop"],M.enqueue=function(a){M.queue.add(a),M.continueOnNextLoop()},M.set_nextLoop=function(a){if(null!=M.nextLoop)throw new C("nextLoop has already been set");return M.nextLoop=a,M.nextLoop},M.queueEmpty=function(){return M.queue.isEmpty()},M.finish=function(a){null==a&&(a=1e3);for(var b=null;a-- >0&&null!=(b=M.queue.pop());)b();return M.queue.isEmpty()},M.clear=function(){M.queue=new k},M.f=function(){var a=M.queue.pop();null!=a&&a(),M.queue.isEmpty()||M.continueOnNextLoop()},M.continueOnNextLoop=function(){null!=M.nextLoop?M.nextLoop(M.f):setImmediate(M.f)};var N=g["promhx.error.PromiseError"]={__ename__:["promhx","error","PromiseError"],__constructs__:["AlreadyResolved","DownstreamNotFullfilled"]};N.AlreadyResolved=function(a){var b=["AlreadyResolved",0,a];return b.__enum__=N,b.toString=h,b},N.DownstreamNotFullfilled=function(a){var b=["DownstreamNotFullfilled",1,a];return b.__enum__=N,b.toString=h,b};var O=function(){};g["verb.Verb"]=O,O.__name__=["verb","Verb"],O.main=function(){a.log("verb 2.0.0")};var P=function(){};g["verb.core.ArrayExtensions"]=P,P.__name__=["verb","core","ArrayExtensions"],P.alloc=function(a,b){if(!(b<0))for(;a.length<b;)a.push(null)},P.reversed=function(a){var b=a.slice();return b.reverse(),b},P.last=function(a){return a[a.length-1]},P.first=function(a){return a[0]},P.spliceAndInsert=function(a,b,c,d){a.splice(b,c),a.splice(b,0,d)},P.left=function(a){if(0==a.length)return[];var b=Math.ceil(a.length/2);return a.slice(0,b)},P.right=function(a){if(0==a.length)return[];var b=Math.ceil(a.length/2);return a.slice(b)},P.rightWithPivot=function(a){if(0==a.length)return[];var b=Math.ceil(a.length/2);return a.slice(b-1)},P.unique=function(a,b){if(0==a.length)return[];for(var c=[a.pop()];a.length>0;){for(var d=a.pop(),e=!0,f=0;f<c.length;){var g=c[f];if(++f,b(d,g)){e=!1;break}}e&&c.push(d)}return c};var Q=function(){};g["verb.core.Binomial"]=Q,Q.__name__=["verb","core","Binomial"],Q.get=function(a,b){if(0==b)return 1;if(0==a||b>a)return 0;if(b>a-b&&(b=a-b),Q.memo_exists(a,b))return Q.get_memo(a,b);for(var c=1,d=a,e=1,f=b+1;e<f;){var g=e++;Q.memo_exists(d,g)?(a--,c=Q.get_memo(d,g)):(c*=a--,c/=g,Q.memoize(d,g,c))}return c},Q.get_no_memo=function(a,b){if(0==b)return 1;if(0==a||b>a)return 0;b>a-b&&(b=a-b);for(var c=1,d=1,e=b+1;d<e;){var f=d++;c*=a--,c/=f}return c},Q.memo_exists=function(a,b){return Q.memo.h.hasOwnProperty(a)&&Q.memo.h[a].h.hasOwnProperty(b)},Q.get_memo=function(a,b){return Q.memo.h[a].h[b]},Q.memoize=function(a,b,c){Q.memo.h.hasOwnProperty(a)||Q.memo.set(a,new v),Q.memo.h[a].h[b]=c};var R=b.core.BoundingBox=function(a){this.max=null,this.min=null,this.dim=3,this.initialized=!1,null!=a&&this.addRange(a)};g["verb.core.BoundingBox"]=R,R.__name__=["verb","core","BoundingBox"],R.intervalsOverlap=function(a,b,c,d,e){null==e&&(e=-1);var f;f=e<-.5?S.TOLERANCE:e;var g=Math.min(a,b)-f,h=Math.max(a,b)+f,i=Math.min(c,d)-f,j=Math.max(c,d)+f;return g>=i&&g<=j||h>=i&&h<=j||i>=g&&i<=h||j>=g&&j<=h},R.prototype={fromPoint:function(a){return new R([a])},add:function(a){if(!this.initialized)return this.dim=a.length,this.min=a.slice(0),this.max=a.slice(0),this.initialized=!0,this;for(var b=0,c=this.dim;b<c;){var d=b++;a[d]>this.max[d]&&(this.max[d]=a[d]),a[d]<this.min[d]&&(this.min[d]=a[d])}return this},addRange:function(a){for(var b=a.length,c=0;c<b;){var d=c++;this.add(a[d])}return this},contains:function(a,b){return null==b&&(b=-1),!!this.initialized&&this.intersects(new R([a]),b)},intersects:function(a,b){if(null==b&&(b=-1),!this.initialized||!a.initialized)return!1;for(var c=this.min,d=this.max,e=a.min,f=a.max,g=0,h=this.dim;g<h;){var i=g++;if(!R.intervalsOverlap(c[i],d[i],e[i],f[i],b))return!1}return!0},clear:function(){return this.initialized=!1,this},getLongestAxis:function(){for(var a=0,b=0,c=0,d=this.dim;c<d;){var e=c++,f=this.getAxisLength(e);f>a&&(a=f,b=e)}return b},getAxisLength:function(a){return a<0||a>this.dim-1?0:Math.abs(this.min[a]-this.max[a])},intersect:function(a,b){if(!this.initialized)return null;var c=this.min,d=this.max,e=a.min,f=a.max;if(!this.intersects(a,b))return null;for(var g=[],h=[],i=0,j=this.dim;i<j;){var k=i++;g.push(Math.min(d[k],f[k])),h.push(Math.max(c[k],e[k]))}return new R([h,g])},__class__:R};var S=b.core.Constants=function(){};g["verb.core.Constants"]=S,S.__name__=["verb","core","Constants"];var T=b.core.SerializableBase=function(){};g["verb.core.SerializableBase"]=T,T.__name__=["verb","core","SerializableBase"],T.prototype={serialize:function(){var a=new t;return a.serialize(this),a.toString()},__class__:T};var U=b.core.Plane=function(a,b){this.origin=a,this.normal=b};g["verb.core.Plane"]=U,U.__name__=["verb","core","Plane"],U.__super__=T,U.prototype=d(T.prototype,{__class__:U});var V=b.core.Ray=function(a,b){this.origin=a,this.dir=b};g["verb.core.Ray"]=V,V.__name__=["verb","core","Ray"],V.__super__=T,V.prototype=d(T.prototype,{__class__:V});var W=b.core.NurbsCurveData=function(a,b,c){this.degree=a,this.controlPoints=c,this.knots=b};g["verb.core.NurbsCurveData"]=W,W.__name__=["verb","core","NurbsCurveData"],W.__super__=T,W.prototype=d(T.prototype,{__class__:W});var X=b.core.NurbsSurfaceData=function(a,b,c,d,e){this.degreeU=a,this.degreeV=b,this.knotsU=c,this.knotsV=d,this.controlPoints=e};g["verb.core.NurbsSurfaceData"]=X,X.__name__=["verb","core","NurbsSurfaceData"],X.__super__=T,X.prototype=d(T.prototype,{__class__:X});var Y=b.core.MeshData=function(a,b,c,d){this.faces=a,this.points=b,this.normals=c,this.uvs=d};g["verb.core.MeshData"]=Y,Y.__name__=["verb","core","MeshData"],Y.empty=function(){return new Y([],[],[],[])},Y.__super__=T,Y.prototype=d(T.prototype,{__class__:Y});var Z=b.core.PolylineData=function(a,b){this.points=a,this.params=b};g["verb.core.PolylineData"]=Z,Z.__name__=["verb","core","PolylineData"],Z.__super__=T,Z.prototype=d(T.prototype,{__class__:Z});var $=b.core.VolumeData=function(a,b,c,d,e,f,g){this.degreeU=a,this.degreeV=b,this.degreeW=c,this.knotsU=d,this.knotsV=e,this.knotsW=f,this.controlPoints=g};g["verb.core.VolumeData"]=$,$.__name__=["verb","core","VolumeData"],$.__super__=T,$.prototype=d(T.prototype,{__class__:$});var _=b.core.Pair=function(a,b){this.item0=a,this.item1=b};g["verb.core.Pair"]=_,_.__name__=["verb","core","Pair"],_.prototype={__class__:_};var aa=b.core.Interval=function(a,b){this.min=a,this.max=b};g["verb.core.Interval"]=aa,aa.__name__=["verb","core","Interval"],aa.prototype={__class__:aa};var ba=b.core.CurveCurveIntersection=function(a,b,c,d){this.point0=a,this.point1=b,this.u0=c,this.u1=d};g["verb.core.CurveCurveIntersection"]=ba,ba.__name__=["verb","core","CurveCurveIntersection"],ba.prototype={__class__:ba};var ca=b.core.CurveSurfaceIntersection=function(a,b,c,d){this.u=a,this.uv=b,this.curvePoint=c,this.surfacePoint=d};g["verb.core.CurveSurfaceIntersection"]=ca,ca.__name__=["verb","core","CurveSurfaceIntersection"],ca.prototype={__class__:ca};var da=b.core.MeshIntersectionPoint=function(a,b,c,d,e){this.visited=!1,this.adj=null,this.opp=null,this.uv0=a,this.uv1=b,this.point=c,this.faceIndex0,this.faceIndex1};g["verb.core.MeshIntersectionPoint"]=da,da.__name__=["verb","core","MeshIntersectionPoint"],da.prototype={__class__:da};var ea=b.core.PolylineMeshIntersection=function(a,b,c,d,e){this.point=a,this.u=b,this.uv=c,this.polylineIndex=d,this.faceIndex=e};g["verb.core.PolylineMeshIntersection"]=ea,ea.__name__=["verb","core","PolylineMeshIntersection"],ea.prototype={__class__:ea};var fa=b.core.SurfaceSurfaceIntersectionPoint=function(a,b,c,d){this.uv0=a,this.uv1=b,this.point=c,this.dist=d};g["verb.core.SurfaceSurfaceIntersectionPoint"]=fa,fa.__name__=["verb","core","SurfaceSurfaceIntersectionPoint"],fa.prototype={__class__:fa};var ga=b.core.TriSegmentIntersection=function(a,b,c,d){this.point=a,this.s=b,this.t=c,this.p=d};g["verb.core.TriSegmentIntersection"]=ga,ga.__name__=["verb","core","TriSegmentIntersection"],ga.prototype={__class__:ga};var ha=b.core.CurveTriPoint=function(a,b,c){this.u=a,this.point=b,this.uv=c};g["verb.core.CurveTriPoint"]=ha,ha.__name__=["verb","core","CurveTriPoint"],ha.prototype={__class__:ha};var ia=function(a,b,c,d,e){null==e&&(e=!1),null==d&&(d=-1),this.uv=c,this.point=a,this.normal=b,this.id=d,this.degen=e};g["verb.core.SurfacePoint"]=ia,ia.__name__=["verb","core","SurfacePoint"],ia.fromUv=function(a,b){return new ia(null,null,[a,b])},ia.prototype={__class__:ia};var ja=b.core.CurvePoint=function(a,b){this.u=a,this.pt=b};g["verb.core.CurvePoint"]=ja,ja.__name__=["verb","core","CurvePoint"],ja.prototype={__class__:ja};var ka=b.core.KdTree=function(a,b){this.dim=3,this.points=a,this.distanceFunction=b,this.dim=a[0].point.length,this.root=this.buildTree(a,0,null)};g["verb.core.KdTree"]=ka,ka.__name__=["verb","core","KdTree"],ka.prototype={buildTree:function(a,b,c){var d,e,f=b%this.dim;return 0==a.length?null:1==a.length?new na(a[0],f,c):(a.sort(function(a,b){var c=a.point[f]-b.point[f];return 0==c?0:c>0?1:-1}),d=Math.floor(a.length/2),e=new na(a[d],f,c),e.left=this.buildTree(a.slice(0,d),b+1,e),e.right=this.buildTree(a.slice(d+1),b+1,e),e)},nearest:function(a,b,c){var d,e=this,f=new la(function(a){return-a.item1}),g=null;g=function(c){for(var d,h,i=c.dimension,j=e.distanceFunction(a,c.kdPoint.point),k=[],l=0,m=e.dim;l<m;){l++;k.push(0)}h=k;for(var n,o,p=function(a,c){f.push(new _(a,c)),f.size()>b&&f.pop()},q=0,r=e.dim;q<r;){var s=q++;s==c.dimension?h[s]=a[s]:h[s]=c.kdPoint.point[s]}return n=e.distanceFunction(h,c.kdPoint.point),null==c.right&&null==c.left?void((f.size()<b||j<f.peek().item1)&&p(c,j)):(d=null==c.right?c.left:null==c.left?c.right:a[i]<c.kdPoint.point[i]?c.left:c.right,g(d),(f.size()<b||j<f.peek().item1)&&p(c,j),void((f.size()<b||Math.abs(n)<f.peek().item1)&&(o=d==c.left?c.right:c.left,null!=o&&g(o))))},d=g;for(var h=0;h<b;){h++;f.push(new _(null,c))}d(this.root);for(var i=[],j=0;j<b;){var k=j++;null!=f.content[k].item0&&i.push(new _(f.content[k].item0.kdPoint,f.content[k].item1))}return i},__class__:ka};var la=function(a){this.content=[],this.scoreFunction=a};g["verb.core.BinaryHeap"]=la,la.__name__=["verb","core","BinaryHeap"],la.prototype={push:function(a){this.content.push(a),this.bubbleUp(this.content.length-1)},pop:function(){var a=this.content[0],b=this.content.pop();return this.content.length>0&&(this.content[0]=b,this.sinkDown(0)),a},peek:function(){return this.content[0]},remove:function(a){for(var b=this.content.length,c=0;c<b;){var d=c++;if(this.content[d]==a){var e=this.content.pop();return void(d!=b-1&&(this.content[d]=e,this.scoreFunction(e)<this.scoreFunction(a)?this.bubbleUp(d):this.sinkDown(d)))}}throw new C("Node not found.")},size:function(){return this.content.length},bubbleUp:function(a){for(var b=this.content[a];a>0;){var c=Math.floor((a+1)/2)-1,d=this.content[c];if(!(this.scoreFunction(b)<this.scoreFunction(d)))break;this.content[c]=b,this.content[a]=d,a=c}},sinkDown:function(a){for(var b=this.content.length,c=this.content[a],d=this.scoreFunction(c);;){var e=2*(a+1),f=e-1,g=-1,h=0;if(f<b){var i=this.content[f];h=this.scoreFunction(i),h<d&&(g=f)}if(e<b){var j=this.content[e],k=this.scoreFunction(j);k<(g==-1?d:h)&&(g=e)}if(g==-1)break;this.content[a]=this.content[g],this.content[g]=c,a=g}},__class__:la};var ma=b.core.KdPoint=function(a,b){this.point=a,this.obj=b};g["verb.core.KdPoint"]=ma,ma.__name__=["verb","core","KdPoint"],ma.prototype={__class__:ma};var na=b.core.KdNode=function(a,b,c){this.kdPoint=a,this.left=null,this.right=null,this.parent=c,this.dimension=b};g["verb.core.KdNode"]=na,na.__name__=["verb","core","KdNode"],na.prototype={__class__:na};var oa=function(){};g["verb.eval.IBoundingBoxTree"]=oa,oa.__name__=["verb","eval","IBoundingBoxTree"],oa.prototype={__class__:oa};var pa=function(a,b){this._boundingBox=null,this._curve=a,null==b&&(b=Ca.domain(this._curve.knots)/64),this._knotTol=b};g["verb.core.LazyCurveBoundingBoxTree"]=pa,pa.__name__=["verb","core","LazyCurveBoundingBoxTree"],pa.__interfaces__=[oa],pa.prototype={split:function(){var a=P.first(this._curve.knots),b=P.last(this._curve.knots),c=b-a,d=Ga.curveSplit(this._curve,(b+a)/2+.1*c*Math.random());return new _(new pa(d[0],this._knotTol),new pa(d[1],this._knotTol))},boundingBox:function(){return null==this._boundingBox&&(this._boundingBox=new R(Ia.dehomogenize1d(this._curve.controlPoints))),this._boundingBox},yield:function(){return this._curve},indivisible:function(a){return Ca.domain(this._curve.knots)<this._knotTol},empty:function(){return!1},__class__:pa};var qa=function(a,b){if(this._boundingBox=null,this._mesh=a,null==b){for(var c=[],d=0,e=a.faces.length;d<e;){var f=d++;c.push(f)}b=c}this._faceIndices=b};g["verb.core.LazyMeshBoundingBoxTree"]=qa,qa.__name__=["verb","core","LazyMeshBoundingBoxTree"],qa.__interfaces__=[oa],qa.prototype={split:function(){var a=va.sortTrianglesOnLongestAxis(this.boundingBox(),this._mesh,this._faceIndices),b=P.left(a),c=P.right(a);return new _(new qa(this._mesh,b),new qa(this._mesh,c))},boundingBox:function(){return null==this._boundingBox&&(this._boundingBox=va.makeMeshAabb(this._mesh,this._faceIndices)),this._boundingBox},yield:function(){return this._faceIndices[0]},indivisible:function(a){return 1==this._faceIndices.length},empty:function(){return 0==this._faceIndices.length},__class__:qa};var ra=function(a,b){this._boundingBox=null,this._polyline=a,null==b&&(b=new aa(0,0!=a.points.length?a.points.length-1:0)),this._interval=b};g["verb.core.LazyPolylineBoundingBoxTree"]=ra,ra.__name__=["verb","core","LazyPolylineBoundingBoxTree"],ra.__interfaces__=[oa],ra.prototype={split:function(){var a=this._interval.min,b=this._interval.max,c=a+Math.ceil((b-a)/2),d=new aa(a,c),e=new aa(c,b);return new _(new ra(this._polyline,d),new ra(this._polyline,e))},boundingBox:function(){return null==this._boundingBox&&(this._boundingBox=new R(this._polyline.points)),this._boundingBox},yield:function(){return this._interval.min},indivisible:function(a){return this._interval.max-this._interval.min==1},empty:function(){return this._interval.max-this._interval.min==0},__class__:ra};var sa=function(a,b,c,d){null==b&&(b=!1),this._boundingBox=null,this._surface=a,this._splitV=b,null==c&&(c=Ca.domain(a.knotsU)/16),null==d&&(d=Ca.domain(a.knotsV)/16),this._knotTolU=c,this._knotTolV=d};g["verb.core.LazySurfaceBoundingBoxTree"]=sa,sa.__name__=["verb","core","LazySurfaceBoundingBoxTree"],sa.__interfaces__=[oa],sa.prototype={split:function(){var a,b;this._splitV?(a=P.first(this._surface.knotsV),b=P.last(this._surface.knotsV)):(a=P.first(this._surface.knotsU),b=P.last(this._surface.knotsU));var c=(a+b)/2,d=Ga.surfaceSplit(this._surface,c,this._splitV);return new _(new sa(d[0],!this._splitV,this._knotTolU,this._knotTolV),new sa(d[1],!this._splitV,this._knotTolU,this._knotTolV))},boundingBox:function(){if(null==this._boundingBox){this._boundingBox=new R;for(var a=0,b=this._surface.controlPoints;a<b.length;){var c=b[a];++a,this._boundingBox.addRange(Ia.dehomogenize1d(c))}}return this._boundingBox},yield:function(){return this._surface},indivisible:function(a){return Ca.domain(this._surface.knotsV)<this._knotTolV&&Ca.domain(this._surface.knotsU)<this._knotTolU},empty:function(){return!1},__class__:sa};var ta=b.core.Mat=function(){};g["verb.core.Mat"]=ta,ta.__name__=["verb","core","Mat"],ta.mul=function(a,b){for(var c=[],d=0,e=b.length;d<e;){var f=d++;c.push(Ca.mul(a,b[f]))}return c},ta.mult=function(a,b){var c,d,e,f,g,h,i,j;c=a.length,d=b.length,e=b[0].length,f=[];for(var k=c-1,l=0,m=0;k>=0;){for(g=[],h=a[k],m=e-1;m>=0;){for(i=h[d-1]*b[d-1][m],l=d-2;l>=1;)j=l-1,i+=h[l]*b[l][m]+h[j]*b[j][m],l-=2;0==l&&(i+=h[0]*b[0][m]),g[m]=i,m--}f[k]=g,k--}return f},ta.add=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(Ca.add(a[f],b[f]))}return c},ta.div=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(Ca.div(a[f],b))}return c},ta.sub=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(Ca.sub(a[f],b[f]))}return c},ta.dot=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(Ca.dot(a[f],b))}return c},ta.identity=function(a){for(var b=Ca.zeros2d(a,a),c=0;c<a;){var d=c++;b[d][d]=1}return b},ta.transpose=function(a){if(0==a.length)return[];for(var b=[],c=0,d=a[0].length;c<d;){var e=c++;b.push(function(b){for(var c,d=[],f=0,g=a.length;f<g;){var h=f++;d.push(a[h][e])}return c=d}(this))}return b},ta.solve=function(a,b){return ta.LUsolve(ta.LU(a),b)},ta.LUsolve=function(a,b){var c,d,e,f,g,h=a.LU,i=h.length,j=b.slice(),k=a.P;for(c=i-1;c!=-1;)j[c]=b[c],--c;for(c=0;c<i;){for(e=k[c],k[c]!=c&&(g=j[c],j[c]=j[e],j[e]=g),f=h[c],d=0;d<c;)j[c]-=j[d]*f[d],++d;++c}for(c=i-1;c>=0;){for(f=h[c],d=c+1;d<i;)j[c]-=j[d]*f[d],++d;j[c]/=f[c],--c}return j},ta.LU=function(a){for(var b,c,d,e,f,g,h,i,j,k=(Math.abs,[]),l=0,m=a.length;l<m;){var n=l++;k.push(a[n].slice())}a=k;var o=a.length,p=o-1,q=[];for(d=0;d<o;){for(h=d,g=a[d],j=Math.abs(g[d]),c=d+1;c<o;)e=Math.abs(a[c][d]),j<e&&(j=e,h=c),++c;for(q[d]=h,h!=d&&(a[d]=a[h],a[h]=g,g=a[d]),f=g[d],b=d+1;b<o;)a[b][d]/=f,++b;for(b=d+1;b<o;){for(i=a[b],c=d+1;c<p;)i[c]-=i[d]*g[c],++c,i[c]-=i[d]*g[c],++c;c==p&&(i[c]-=i[d]*g[c]),++b}++d}return new ua(a,q)};var ua=function(a,b){this.LU=a,this.P=b};g["verb.core._Mat.LUDecomp"]=ua,ua.__name__=["verb","core","_Mat","LUDecomp"],ua.prototype={__class__:ua};var va=b.core.Mesh=function(){};g["verb.core.Mesh"]=va,va.__name__=["verb","core","Mesh"],va.getTriangleNorm=function(a,b){var c=a[b[0]],d=a[b[1]],e=a[b[2]],f=Ca.sub(d,c),g=Ca.sub(e,c),h=Ca.cross(f,g);return Ca.mul(1/Ca.norm(h),h)},va.makeMeshAabb=function(a,b){for(var c=new R,d=0;d<b.length;){var e=b[d];++d,c.add(a.points[a.faces[e][0]]),c.add(a.points[a.faces[e][1]]),c.add(a.points[a.faces[e][2]])}return c},va.sortTrianglesOnLongestAxis=function(a,b,c){for(var d=a.getLongestAxis(),e=[],f=0;f<c.length;){var g=c[f];++f;var h=va.getMinCoordOnAxis(b.points,b.faces[g],d);e.push(new _(h,g))}e.sort(function(a,b){var c=a.item0,d=b.item0;return c==d?0:c>d?1:-1});for(var i=[],j=0,k=e.length;j<k;){var l=j++;i.push(e[l].item1)}return i},va.getMinCoordOnAxis=function(a,b,c){for(var d=1/0,e=0;e<3;){var f=e++,g=a[b[f]][c];g<d&&(d=g)}return d},va.getTriangleCentroid=function(a,b){for(var c=[0,0,0],d=0;d<3;)for(var e=d++,f=0;f<3;){var g=f++;c[g]+=a[b[e]][g]}for(var h=0;h<3;){var i=h++;c[i]/=3}return c},va.triangleUVFromPoint=function(a,b,c){var d=a.faces[b],e=a.points[d[0]],f=a.points[d[1]],g=a.points[d[2]],h=a.uvs[d[0]],i=a.uvs[d[1]],j=a.uvs[d[2]],k=Ca.sub(e,c),l=Ca.sub(f,c),m=Ca.sub(g,c),n=Ca.norm(Ca.cross(Ca.sub(e,f),Ca.sub(e,g))),o=Ca.norm(Ca.cross(l,m))/n,p=Ca.norm(Ca.cross(m,k))/n,q=Ca.norm(Ca.cross(k,l))/n;return Ca.add(Ca.mul(o,h),Ca.add(Ca.mul(p,i),Ca.mul(q,j)))};var wa=function(a,b){if(this._empty=!1,this._face=-1,null==b){for(var c=[],d=0,e=a.faces.length;d<e;){var f=d++;c.push(f)}b=c}if(this._boundingBox=va.makeMeshAabb(a,b),b.length<1)return void(this._empty=!0);if(b.length<2)return void(this._face=b[0]);var g=va.sortTrianglesOnLongestAxis(this._boundingBox,a,b),h=P.left(g),i=P.right(g);this._children=new _(new wa(a,h),new wa(a,i))};g["verb.core.MeshBoundingBoxTree"]=wa,wa.__name__=["verb","core","MeshBoundingBoxTree"],wa.__interfaces__=[oa],wa.prototype={split:function(){return this._children},boundingBox:function(){return this._boundingBox},yield:function(){return this._face},indivisible:function(a){return null==this._children},empty:function(){return this._empty},__class__:wa};var xa=b.core.Minimizer=function(){};g["verb.core.Minimizer"]=xa,xa.__name__=["verb","core","Minimizer"],xa.uncmin=function(a,b,c,d,e){null==c&&(c=1e-8),null==d&&(d=function(b){return xa.numericalGradient(a,b)}),null==e&&(e=1e3),b=b.slice(0);var f,g=b.length,h=a(b),i=h;if(isNaN(h))throw new C("uncmin: f(x0) is a NaN!");c=Math.max(c,S.EPSILON);var j,k,l,m,n,o,p,q,r,s=ta.identity(g),t=0,u=[],v="";for(k=d(b);t<e;){if(!Ca.all(Ca.finite(k))){v="Gradient has Infinity or NaN";break}if(j=Ca.neg(ta.dot(s,k)),!Ca.all(Ca.finite(j))){v="Search direction has Infinity or NaN";break}if(r=Ca.norm(j),r<c){v="Newton step smaller than tol";break}for(q=1,f=Ca.dot(k,j),m=b;t<e&&!(q*r<c)&&(u=Ca.mul(q,j),m=Ca.add(b,u),i=a(m),i-h>=.1*q*f||isNaN(i));)q*=.5,++t;if(q*r<c){v="Line search step size smaller than tol";break}if(t==e){v="maxit reached during line search";break}l=d(m),n=Ca.sub(l,k),p=Ca.dot(n,u),o=ta.dot(s,n),s=ta.sub(ta.add(s,ta.mul((p+Ca.dot(n,o))/(p*p),xa.tensor(u,u))),ta.div(ta.add(xa.tensor(o,u),xa.tensor(u,o)),p)),b=m,h=i,k=l,++t}return new ya(b,h,k,s,t,v)},xa.numericalGradient=function(a,b){var c=b.length,d=a(b);if(NaN==d)throw new C("gradient: f(x) is a NaN!");for(var e,f,g,h,i,j,k,l,m,n=b.slice(0),o=[],p=.001,q=0,r=0;r<c;)for(var s=r++,t=Math.max(1e-6*d,1e-8);;){if(++q,q>20)throw new C("Numerical gradient fails");if(n[s]=b[s]+t,e=a(n),n[s]=b[s]-t,f=a(n),n[s]=b[s],isNaN(e)||isNaN(f))t/=16;else{if(o[s]=(e-f)/(2*t),h=b[s]-t,i=b[s],j=b[s]+t,k=(e-d)/t,l=(d-f)/t,m=Ca.max([Math.abs(o[s]),Math.abs(d),Math.abs(e),Math.abs(f),Math.abs(h),Math.abs(i),Math.abs(j),1e-8]),g=Math.min(Ca.max([Math.abs(k-o[s]),Math.abs(l-o[s]),Math.abs(k-l)])/m,t/m),!(g>p))break;t/=16}}return o},xa.tensor=function(a,b){for(var c,d,e=a.length,f=b.length,g=[],h=e-1;h>=0;){c=[],d=a[h];for(var i=f-1;i>=3;)c[i]=d*b[i],--i,c[i]=d*b[i],--i,c[i]=d*b[i],--i,c[i]=d*b[i],--i;for(;i>=0;)c[i]=d*b[i],--i;g[h]=c,h--}return g};var ya=function(a,b,c,d,e,f){this.solution=a,this.value=b,this.gradient=c,this.invHessian=d,this.iterations=e,this.message=f};g["verb.core.MinimizationResult"]=ya,ya.__name__=["verb","core","MinimizationResult"],ya.prototype={__class__:ya};var za=function(){};g["verb.core.ISerializable"]=za,za.__name__=["verb","core","ISerializable"],za.prototype={__class__:za};var Aa=b.core.Deserializer=function(){};g["verb.core.Deserializer"]=Aa,Aa.__name__=["verb","core","Deserializer"],Aa.deserialize=function(a){var b=new u(a),c=b.unserialize();return c};var Ba=b.core.Trig=function(){};g["verb.core.Trig"]=Ba,Ba.__name__=["verb","core","Trig"],Ba.isPointInPlane=function(a,b,c){return Math.abs(Ca.dot(Ca.sub(a,b.origin),b.normal))<c},Ba.distToSegment=function(a,b,c){var d=Ba.segmentClosestPoint(b,a,c,0,1);return Ca.dist(b,d.pt)},Ba.rayClosestPoint=function(a,b,c){var d=Ca.sub(a,b),e=Ca.dot(d,c),f=Ca.add(b,Ca.mul(e,c));return f},Ba.distToRay=function(a,b,c){var d=Ba.rayClosestPoint(a,b,c),e=Ca.sub(d,a);return Ca.norm(e)},Ba.threePointsAreFlat=function(a,b,c,d){var e=Ca.sub(b,a),f=Ca.sub(c,a),g=Ca.cross(e,f),h=Ca.dot(g,g);return h<d},Ba.segmentClosestPoint=function(a,b,c,d,e){var f=Ca.sub(c,b),g=Ca.norm(f);if(g<S.EPSILON)return{u:d,pt:b};var h=b,i=Ca.mul(1/g,f),j=Ca.sub(a,h),k=Ca.dot(j,i);return k<0?{u:d,pt:b}:k>g?{u:e,pt:c}:{u:d+(e-d)*k/g,pt:Ca.add(h,Ca.mul(k,i))}};var Ca=b.core.Vec=function(){};g["verb.core.Vec"]=Ca,Ca.__name__=["verb","core","Vec"],Ca.angleBetween=function(a,b){return Math.acos(Ca.dot(a,b)/(Ca.norm(a)*Ca.norm(b)))},Ca.positiveAngleBetween=function(a,b,c){var d=Ca.cross(a,b),e=Ca.norm(a),f=Ca.norm(b),g=e*f,h=Ca.dot(a,b),i=Ca.norm(d)/g,j=h/g,k=Math.atan2(i,j),l=Ca.dot(c,d);return Math.abs(l)<S.EPSILON?k:l>0?k:-k},Ca.signedAngleBetween=function(a,b,c){var d=Ca.cross(a,b),e=Ca.norm(a),f=Ca.norm(b),g=e*f,h=Ca.dot(a,b),i=Ca.norm(d)/g,j=h/g,k=Math.atan2(i,j),l=Ca.dot(c,d);return l>0?k:2*Math.PI-k},Ca.angleBetweenNormalized2d=function(a,b){var c=a[0]*b[1]-a[1]*b[0];return Math.atan2(c,Ca.dot(a,b))},Ca.domain=function(a){return P.last(a)-P.first(a)},Ca.range=function(a){for(var b=[],c=0,d=0;d<a;){d++;b.push(c),c+=1}return b},Ca.span=function(a,b,c){if(null==c)return[];if(c<S.EPSILON)return[];if(a>b&&c>0)return[];if(b>a&&c<0)return[];for(var d=[],e=a;e<=b;)d.push(e),e+=c;return d},Ca.neg=function(a){return a.map(function(a){return-a})},Ca.min=function(a){return j.fold(a,function(a,b){return Math.min(a,b)},1/0)},Ca.max=function(a){return j.fold(a,function(a,b){return Math.max(a,b)},-(1/0))},Ca.all=function(a){return j.fold(a,function(a,b){return b&&a},!0)},Ca.finite=function(a){return a.map(function(a){return isFinite(a)})},Ca.onRay=function(a,b,c){return Ca.add(a,Ca.mul(c,b))},Ca.lerp=function(a,b,c){return Ca.add(Ca.mul(a,b),Ca.mul(1-a,c))},Ca.normalized=function(a){return Ca.div(a,Ca.norm(a))},Ca.cross=function(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]},Ca.dist=function(a,b){return Ca.norm(Ca.sub(a,b))},Ca.distSquared=function(a,b){return Ca.normSquared(Ca.sub(a,b))},Ca.sum=function(a){return j.fold(a,function(a,b){return b+a},0)},Ca.addAll=function(a){var b=e(a)();if(!b.hasNext())return null;var c=b.next().length;return j.fold(a,function(a,b){return Ca.add(b,a)},Ca.rep(c,0))},Ca.norm=function(a){var b=Ca.normSquared(a);return 0!=b?Math.sqrt(b):b},Ca.normSquared=function(a){return j.fold(a,function(a,b){return b+a*a},0)},Ca.rep=function(a,b){for(var c=[],d=0;d<a;){d++;c.push(b)}return c},Ca.zeros1d=function(a){for(var b=[],c=0;c<a;){c++;b.push(0)}return b},Ca.zeros2d=function(a,b){for(var c=[],d=0;d<a;){d++;c.push(Ca.zeros1d(b))}return c},Ca.zeros3d=function(a,b,c){for(var d=[],e=0;e<a;){e++;d.push(Ca.zeros2d(b,c))}return d},Ca.dot=function(a,b){for(var c=0,d=0,e=a.length;d<e;){var f=d++;c+=a[f]*b[f]}return c},Ca.add=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(a[f]+b[f])}return c},Ca.mul=function(a,b){for(var c=[],d=0,e=b.length;d<e;){var f=d++;c.push(a*b[f])}return c},Ca.div=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(a[f]/b)}return c},Ca.sub=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(a[f]-b[f])}return c},Ca.isZero=function(a){for(var b=0,c=a.length;b<c;){var d=b++;if(Math.abs(a[d])>S.TOLERANCE)return!1}return!0},Ca.sortedSetUnion=function(a,b){for(var c=[],d=0,e=0;d<a.length||e<b.length;)if(d>=a.length)c.push(b[e]),e++;else if(e>=b.length)c.push(a[d]),d++;else{var f=a[d]-b[e];Math.abs(f)<S.EPSILON?(c.push(a[d]),d++,e++):f>0?(c.push(b[e]),e++):(c.push(a[d]),d++)}return c},Ca.sortedSetSub=function(a,b){for(var c=[],d=0,e=0;d<a.length;)e>=b.length?(c.push(a[d]),d++):Math.abs(a[d]-b[e])<S.EPSILON?(d++,e++):(c.push(a[d]),d++);return c};var Da=b.eval.Analyze=function(){};g["verb.eval.Analyze"]=Da,Da.__name__=["verb","eval","Analyze"],Da.knotMultiplicities=function(a){for(var b=[new Ea(a[0],0)],c=b[0],d=0;d<a.length;){var e=a[d];++d,Math.abs(e-c.knot)>S.EPSILON&&(c=new Ea(e,0),b.push(c)),c.inc()}return b},Da.isRationalSurfaceClosed=function(a,b){null==b&&(b=!0);var c;c=b?a.controlPoints:ta.transpose(a.controlPoints);for(var d=0,e=c[0].length;d<e;){var f=d++,g=Ca.dist(P.first(c)[f],P.last(c)[f])<S.EPSILON;if(!g)return!1}return!0},Da.rationalSurfaceClosestPoint=function(a,b){var c=Da.rationalSurfaceClosestParam(a,b);return Ia.rationalSurfacePoint(a,c[0],c[1])},Da.rationalSurfaceClosestParam=function(a,b){for(var c,d,e,f=5,g=0,h=1e-4,i=5e-4,j=a.knotsU[0],k=P.last(a.knotsU),l=a.knotsV[0],m=P.last(a.knotsV),n=Da.isRationalSurfaceClosed(a),o=Da.isRationalSurfaceClosed(a,!1),p=Ma.rationalSurfaceAdaptive(a,new Na),q=1/0,r=0,s=p.points.length;r<s;){var t=r++,u=p.points[t],v=Ca.normSquared(Ca.sub(b,u));v<q&&(q=v,e=p.uvs[t])}for(var w=function(b){return Ia.rationalSurfaceDerivatives(a,b[0],b[1],2)},x=function(a,b,c){var d=b[1][0],e=b[0][1],f=b[2][0],g=b[0][2],h=b[1][1],i=b[1][1],j=Ca.dot(d,c),k=Ca.dot(e,c),l=[-j,-k],m=Ca.dot(d,d)+Ca.dot(f,c),n=Ca.dot(d,e)+Ca.dot(h,c),o=Ca.dot(d,e)+Ca.dot(i,c),p=Ca.dot(e,e)+Ca.dot(g,c),q=[[m,n],[o,p]],r=ta.solve(q,l);return Ca.add(r,a)};g<f;){c=w(e),d=Ca.sub(c[0][0],b);var y=Ca.norm(d),z=Ca.dot(c[1][0],d),A=Ca.norm(c[1][0])*y,B=Ca.dot(c[0][1],d),C=Ca.norm(c[0][1])*y,D=z/A,E=B/C,F=y<h,G=D<i,H=E<i;if(F&&G&&H)return e;var I=x(e,c,d);I[0]<j?I=n?[k-(I[0]-j),I[1]]:[j+S.EPSILON,I[1]]:I[0]>k&&(I=n?[j+(I[0]-k),I[1]]:[k-S.EPSILON,I[1]]),I[1]<l?I=o?[I[0],m-(I[1]-l)]:[I[0],l+S.EPSILON]:I[1]>m&&(I=o?[I[0],l+(I[0]-m)]:[I[0],m-S.EPSILON]);var J=Ca.norm(Ca.mul(I[0]-e[0],c[1][0])),K=Ca.norm(Ca.mul(I[1]-e[1],c[0][1]));if(J+K<h)return e;e=I,g++}return e},Da.rationalCurveClosestPoint=function(a,b){return Ia.rationalCurvePoint(a,Da.rationalCurveClosestParam(a,b))},Da.rationalCurveClosestParam=function(a,b){for(var c=1/0,d=0,e=Ma.rationalCurveRegularSample(a,a.controlPoints.length*a.degree,!0),f=0,g=e.length-1;f<g;){var h=f++,i=e[h][0],j=e[h+1][0],k=e[h].slice(1),l=e[h+1].slice(1),m=Ba.segmentClosestPoint(b,k,l,i,j),n=Ca.norm(Ca.sub(b,m.pt));n<c&&(c=n,d=m.u)}for(var o,p,q=5,r=0,s=1e-4,t=5e-4,u=a.knots[0],v=P.last(a.knots),w=Ca.normSquared(Ca.sub(a.controlPoints[0],P.last(a.controlPoints)))<S.EPSILON,x=d,y=function(b){return Ia.rationalCurveDerivatives(a,b,2)},z=function(a,b,c){var d=Ca.dot(b[1],c),e=Ca.dot(b[2],c),f=Ca.dot(b[1],b[1]),g=e+f;return a-d/g};r<q;){o=y(x),p=Ca.sub(o[0],b);var A=Ca.norm(p),B=Ca.dot(o[1],p),C=Ca.norm(o[1])*A,D=B/C,E=A<s,F=Math.abs(D)<t;if(E&&F)return x;var G=z(x,o,p);G<u?G=w?v-(G-u):u:G>v&&(G=w?u+(G-v):v);var H=Ca.norm(Ca.mul(G-x,o[1]));if(H<s)return x;x=G,r++}return x},Da.rationalCurveParamAtArcLength=function(a,b,c,d,e){if(null==c&&(c=.001),b<S.EPSILON)return a.knots[0];var f;f=null!=d?d:La.decomposeCurveIntoBeziers(a);var g,h=0,i=(f[h],-S.EPSILON);for(g=null!=e?e:[];i<b&&h<f.length;){if(h<g.length?g[h]=g[h]:g[h]=Da.rationalBezierCurveArcLength(a),i+=g[h],b<i+S.EPSILON)return Da.rationalBezierCurveParamAtArcLength(a,b,c,g[h]);h++}return-1},Da.rationalBezierCurveParamAtArcLength=function(a,b,c,d){if(b<0)return a.knots[0];var e;if(e=null!=d?d:Da.rationalBezierCurveArcLength(a),b>e)return P.last(a.knots);var f,g=a.knots[0],h=0,i=P.last(a.knots),j=e,k=0,l=0;for(f=null!=c?c:2*S.TOLERANCE;j-h>f;)k=(g+i)/2,l=Da.rationalBezierCurveArcLength(a,k),l>b?(i=k,j=l):(g=k,h=l);return(g+i)/2},Da.rationalCurveArcLength=function(a,b,c){null==c&&(c=16),b=null==b?P.last(a.knots):b;for(var d=La.decomposeCurveIntoBeziers(a),e=0,f=d[0],g=0;e<d.length&&f.knots[0]+S.EPSILON<b;){var h=Math.min(P.last(f.knots),b);g+=Da.rationalBezierCurveArcLength(f,h,c),f=d[++e]}return g},Da.rationalBezierCurveArcLength=function(a,b,c){null==c&&(c=16);var d;d=null==b?P.last(a.knots):b;for(var e,f,g=(d-a.knots[0])/2,h=0,i=a.degree+c,j=0;j<i;){var k=j++;e=g*Da.Tvalues[i][k]+g+a.knots[0],f=Ia.rationalCurveDerivatives(a,e,1),h+=Da.Cvalues[i][k]*Ca.norm(f[1])}return g*h};var Ea=b.eval.KnotMultiplicity=function(a,b){this.knot=a,this.mult=b};g["verb.eval.KnotMultiplicity"]=Ea,Ea.__name__=["verb","eval","KnotMultiplicity"],Ea.prototype={inc:function(){this.mult++},__class__:Ea};var Fa=b.eval.Check=function(){};g["verb.eval.Check"]=Fa,Fa.__name__=["verb","eval","Check"],Fa.isValidKnotVector=function(a,b){if(0==a.length)return!1;if(a.length<2*(b+1))return!1;for(var c=P.first(a),d=0,e=b+1;d<e;){var f=d++;if(Math.abs(a[f]-c)>S.EPSILON)return!1}c=P.last(a);for(var g=a.length-b-1,h=a.length;g<h;){var i=g++;if(Math.abs(a[i]-c)>S.EPSILON)return!1}return Fa.isNonDecreasing(a)},Fa.isNonDecreasing=function(a){for(var b=P.first(a),c=0,d=a.length;c<d;){var e=c++;if(a[e]<b-S.EPSILON)return!1;b=a[e]}return!0},
Fa.isValidNurbsCurveData=function(a){if(null==a.controlPoints)throw new C("Control points array cannot be null!");if(null==a.degree)throw new C("Degree cannot be null!");if(a.degree<1)throw new C("Degree must be greater than 1!");if(null==a.knots)throw new C("Knots cannot be null!");if(a.knots.length!=a.controlPoints.length+a.degree+1)throw new C("controlPoints.length + degree + 1 must equal knots.length!");if(!Fa.isValidKnotVector(a.knots,a.degree))throw new C("Invalid knot vector format!  Should begin with degree + 1 repeats and end with degree + 1 repeats!");return a},Fa.isValidNurbsSurfaceData=function(a){if(null==a.controlPoints)throw new C("Control points array cannot be null!");if(null==a.degreeU)throw new C("DegreeU cannot be null!");if(null==a.degreeV)throw new C("DegreeV cannot be null!");if(a.degreeU<1)throw new C("DegreeU must be greater than 1!");if(a.degreeV<1)throw new C("DegreeV must be greater than 1!");if(null==a.knotsU)throw new C("KnotsU cannot be null!");if(null==a.knotsV)throw new C("KnotsV cannot be null!");if(a.knotsU.length!=a.controlPoints.length+a.degreeU+1)throw new C("controlPointsU.length + degreeU + 1 must equal knotsU.length!");if(a.knotsV.length!=a.controlPoints[0].length+a.degreeV+1)throw new C("controlPointsV.length + degreeV + 1 must equal knotsV.length!");if(!Fa.isValidKnotVector(a.knotsU,a.degreeU)||!Fa.isValidKnotVector(a.knotsV,a.degreeV))throw new C("Invalid knot vector format!  Should begin with degree + 1 repeats and end with degree + 1 repeats!");return a};var Ga=b.eval.Divide=function(){};g["verb.eval.Divide"]=Ga,Ga.__name__=["verb","eval","Divide"],Ga.surfaceSplit=function(a,b,c){null==c&&(c=!1);var d,e,f;c?(f=a.controlPoints,d=a.knotsV,e=a.degreeV):(f=ta.transpose(a.controlPoints),d=a.knotsU,e=a.degreeU);for(var g,h=[],i=0,j=e+1;i<j;){i++;h.push(b)}g=h;for(var k=[],l=[],m=Ia.knotSpan(e,b,d),n=null,o=0;o<f.length;){var p=f[o];++o,n=La.curveKnotRefine(new W(e,d,p),g),k.push(n.controlPoints.slice(0,m+1)),l.push(n.controlPoints.slice(m+1))}var q=n.knots.slice(0,m+e+2),r=n.knots.slice(m+1);return c?[new X(a.degreeU,e,a.knotsU.slice(),q,k),new X(a.degreeU,e,a.knotsU.slice(),r,l)]:(k=ta.transpose(k),l=ta.transpose(l),[new X(e,a.degreeV,q,a.knotsV.slice(),k),new X(e,a.degreeV,r,a.knotsV.slice(),l)])},Ga.curveSplit=function(a,b){for(var c,d=a.degree,e=(a.controlPoints,a.knots),f=[],g=0,h=d+1;g<h;){g++;f.push(b)}c=f;var i=La.curveKnotRefine(a,c),j=Ia.knotSpan(d,b,e),k=i.knots.slice(0,j+d+2),l=i.knots.slice(j+1),m=i.controlPoints.slice(0,j+1),n=i.controlPoints.slice(j+1);return[new W(d,k,m),new W(d,l,n)]},Ga.rationalCurveByEqualArcLength=function(a,b){var c=Da.rationalCurveArcLength(a),d=c/b;return Ga.rationalCurveByArcLength(a,d)},Ga.rationalCurveByArcLength=function(a,b){var c=La.decomposeCurveIntoBeziers(a),d=c.map(function(a){return Da.rationalBezierCurveArcLength(a)}),e=Ca.sum(d),f=[new Ha(a.knots[0],0)];if(b>e)return f;for(var g,h=b,i=0,j=h,k=0,l=0;i<c.length;){for(k+=d[i];j<k+S.EPSILON;)g=Da.rationalBezierCurveParamAtArcLength(c[i],j-l,S.TOLERANCE,d[i]),f.push(new Ha(g,j)),j+=h;l+=d[i],i++}return f};var Ha=b.eval.CurveLengthSample=function(a,b){this.u=a,this.len=b};g["verb.eval.CurveLengthSample"]=Ha,Ha.__name__=["verb","eval","CurveLengthSample"],Ha.prototype={__class__:Ha};var Ia=b.eval.Eval=function(){};g["verb.eval.Eval"]=Ia,Ia.__name__=["verb","eval","Eval"],Ia.rationalCurveTangent=function(a,b){var c=Ia.rationalCurveDerivatives(a,b,1);return c[1]},Ia.rationalSurfaceNormal=function(a,b,c){var d=Ia.rationalSurfaceDerivatives(a,b,c,1);return Ca.cross(d[1][0],d[0][1])},Ia.rationalSurfaceDerivatives=function(a,b,c,d){null==d&&(d=1);for(var e=Ia.surfaceDerivatives(a,b,c,d),f=Ia.rational2d(e),g=Ia.weight2d(e),h=[],i=f[0][0].length,j=0,k=d+1;j<k;){var l=j++;h.push([]);for(var m=0,n=d-l+1;m<n;){for(var o=m++,p=f[l][o],q=1,r=o+1;q<r;){var s=q++;p=Ca.sub(p,Ca.mul(Q.get(o,s)*g[0][s],h[l][o-s]))}for(var t=1,u=l+1;t<u;){var v=t++;p=Ca.sub(p,Ca.mul(Q.get(l,v)*g[v][0],h[l-v][o]));for(var w=Ca.zeros1d(i),x=1,y=o+1;x<y;){var z=x++;w=Ca.add(w,Ca.mul(Q.get(o,z)*g[v][z],h[l-v][o-z]))}p=Ca.sub(p,Ca.mul(Q.get(l,v),w))}h[l].push(Ca.mul(1/g[0][0],p))}}return h},Ia.rationalSurfacePoint=function(a,b,c){return Ia.dehomogenize(Ia.surfacePoint(a,b,c))},Ia.rationalCurveDerivatives=function(a,b,c){null==c&&(c=1);for(var d=Ia.curveDerivatives(a,b,c),e=Ia.rational1d(d),f=Ia.weight1d(d),g=[],h=0,i=c+1;h<i;){for(var j=h++,k=e[j],l=1,m=j+1;l<m;){var n=l++;k=Ca.sub(k,Ca.mul(Q.get(j,n)*f[n],g[j-n]))}g.push(Ca.mul(1/f[0],k))}return g},Ia.rationalCurvePoint=function(a,b){return Ia.dehomogenize(Ia.curvePoint(a,b))},Ia.surfaceDerivatives=function(a,b,c,d){var e=a.knotsU.length-a.degreeU-2,f=a.knotsV.length-a.degreeV-2;return Ia.surfaceDerivativesGivenNM(e,f,a,b,c,d)},Ia.surfaceDerivativesGivenNM=function(a,b,c,d,e,f){var g=c.degreeU,h=c.degreeV,i=c.controlPoints,j=c.knotsU,k=c.knotsV;if(!Ia.areValidRelations(g,i.length,j.length)||!Ia.areValidRelations(h,i[0].length,k.length))throw new C("Invalid relations between control points, knot vector, and n");var l,m=i[0][0].length;l=f<g?f:g;var n;n=f<h?f:h;for(var o=Ca.zeros3d(f+1,f+1,m),p=Ia.knotSpanGivenN(a,g,d,j),q=Ia.knotSpanGivenN(b,h,e,k),r=Ia.derivativeBasisFunctionsGivenNI(p,d,g,a,j),s=Ia.derivativeBasisFunctionsGivenNI(q,e,h,b,k),t=Ca.zeros2d(h+1,m),u=0,v=0,w=l+1;v<w;){for(var x=v++,y=0,z=h+1;y<z;){var A=y++;t[A]=Ca.zeros1d(m);for(var B=0,D=g+1;B<D;){var E=B++;t[A]=Ca.add(t[A],Ca.mul(r[x][E],i[p-g+E][q-h+A]))}}var F=f-x;u=F<n?F:n;for(var G=0,H=u+1;G<H;){var I=G++;o[x][I]=Ca.zeros1d(m);for(var J=0,K=h+1;J<K;){var L=J++;o[x][I]=Ca.add(o[x][I],Ca.mul(s[I][L],t[L]))}}}return o},Ia.surfacePoint=function(a,b,c){var d=a.knotsU.length-a.degreeU-2,e=a.knotsV.length-a.degreeV-2;return Ia.surfacePointGivenNM(d,e,a,b,c)},Ia.surfacePointGivenNM=function(a,b,c,d,e){var f=c.degreeU,g=c.degreeV,h=c.controlPoints,i=c.knotsU,j=c.knotsV;if(!Ia.areValidRelations(f,h.length,i.length)||!Ia.areValidRelations(g,h[0].length,j.length))throw new C("Invalid relations between control points, knot vector, and n");for(var k=h[0][0].length,l=Ia.knotSpanGivenN(a,f,d,i),m=Ia.knotSpanGivenN(b,g,e,j),n=Ia.basisFunctionsGivenKnotSpanIndex(l,d,f,i),o=Ia.basisFunctionsGivenKnotSpanIndex(m,e,g,j),p=l-f,q=m,r=Ca.zeros1d(k),s=Ca.zeros1d(k),t=0,u=g+1;t<u;){var v=t++;s=Ca.zeros1d(k),q=m-g+v;for(var w=0,x=f+1;w<x;){var y=w++;s=Ca.add(s,Ca.mul(n[y],h[p+y][q]))}r=Ca.add(r,Ca.mul(o[v],s))}return r},Ia.curveDerivatives=function(a,b,c){var d=a.knots.length-a.degree-2;return Ia.curveDerivativesGivenN(d,a,b,c)},Ia.curveDerivativesGivenN=function(a,b,c,d){var e=b.degree,f=b.controlPoints,g=b.knots;if(!Ia.areValidRelations(e,f.length,g.length))throw new C("Invalid relations between control points, knot vector, and n");var h,i=f[0].length;h=d<e?d:e;for(var j=Ca.zeros2d(d+1,i),k=Ia.knotSpanGivenN(a,e,c,g),l=Ia.derivativeBasisFunctionsGivenNI(k,c,e,h,g),m=0,n=h+1;m<n;)for(var o=m++,p=0,q=e+1;p<q;){var r=p++;j[o]=Ca.add(j[o],Ca.mul(l[o][r],f[k-e+r]))}return j},Ia.curvePoint=function(a,b){var c=a.knots.length-a.degree-2;return Ia.curvePointGivenN(c,a,b)},Ia.areValidRelations=function(a,b,c){return b+a+1-c==0},Ia.curvePointGivenN=function(a,b,c){var d=b.degree,e=b.controlPoints,f=b.knots;if(!Ia.areValidRelations(d,e.length,f.length))throw new C("Invalid relations between control points, knot Array, and n");for(var g=Ia.knotSpanGivenN(a,d,c,f),h=Ia.basisFunctionsGivenKnotSpanIndex(g,c,d,f),i=Ca.zeros1d(e[0].length),j=0,k=d+1;j<k;){var l=j++;i=Ca.add(i,Ca.mul(h[l],e[g-d+l]))}return i},Ia.volumePoint=function(a,b,c,d){var e=a.knotsU.length-a.degreeU-2,f=a.knotsV.length-a.degreeV-2,g=a.knotsW.length-a.degreeW-2;return Ia.volumePointGivenNML(a,e,f,g,b,c,d)},Ia.volumePointGivenNML=function(a,b,c,d,e,f,g){if(!Ia.areValidRelations(a.degreeU,a.controlPoints.length,a.knotsU.length)||!Ia.areValidRelations(a.degreeV,a.controlPoints[0].length,a.knotsV.length)||!Ia.areValidRelations(a.degreeW,a.controlPoints[0][0].length,a.knotsW.length))throw new C("Invalid relations between control points and knot vector");for(var h=a.controlPoints,i=a.degreeU,j=a.degreeV,k=a.degreeW,l=a.knotsU,m=a.knotsV,n=a.knotsW,o=h[0][0][0].length,p=Ia.knotSpanGivenN(b,i,e,l),q=Ia.knotSpanGivenN(c,j,f,m),r=Ia.knotSpanGivenN(d,k,g,n),s=Ia.basisFunctionsGivenKnotSpanIndex(p,e,i,l),t=Ia.basisFunctionsGivenKnotSpanIndex(q,f,j,m),u=Ia.basisFunctionsGivenKnotSpanIndex(r,g,k,n),v=p-i,w=Ca.zeros1d(o),x=Ca.zeros1d(o),y=Ca.zeros1d(o),z=0,A=k+1;z<A;){var B=z++;y=Ca.zeros1d(o);for(var D=r-k+B,E=0,F=j+1;E<F;){var G=E++;x=Ca.zeros1d(o);for(var H=q-j+G,I=0,J=i+1;I<J;){var K=I++;x=Ca.add(x,Ca.mul(s[K],h[v+K][H][D]))}y=Ca.add(y,Ca.mul(t[G],x))}w=Ca.add(w,Ca.mul(u[B],y))}return w},Ia.derivativeBasisFunctions=function(a,b,c){var d=Ia.knotSpan(b,a,c),e=c.length-1,f=e-b-1;return Ia.derivativeBasisFunctionsGivenNI(d,a,b,f,c)},Ia.derivativeBasisFunctionsGivenNI=function(a,b,c,d,e){var f=Ca.zeros2d(c+1,c+1),g=Ca.zeros1d(c+1),h=Ca.zeros1d(c+1),i=0,j=0;f[0][0]=1;for(var k=1,l=c+1;k<l;){var m=k++;g[m]=b-e[a+1-m],h[m]=e[a+m]-b,i=0;for(var n=0;n<m;){var o=n++;f[m][o]=h[o+1]+g[m-o],j=f[o][m-1]/f[m][o],f[o][m]=i+h[o+1]*j,i=g[m-o]*j}f[m][m]=i}for(var p=Ca.zeros2d(d+1,c+1),q=Ca.zeros2d(2,c+1),r=0,s=1,t=0,u=0,v=0,w=0,x=0,y=0,z=c+1;y<z;){var A=y++;p[0][A]=f[A][c]}for(var B=0,C=c+1;B<C;){var D=B++;r=0,s=1,q[0][0]=1;for(var E=1,F=d+1;E<F;){var G=E++;t=0,u=D-G,v=c-G,D>=G&&(q[s][0]=q[r][0]/f[v+1][u],t=q[s][0]*f[u][v]),w=u>=-1?1:-u,x=D-1<=v?G-1:c-D;for(var H=w,I=x+1;H<I;){var J=H++;q[s][J]=(q[r][J]-q[r][J-1])/f[v+1][u+J],t+=q[s][J]*f[u+J][v]}D<=v&&(q[s][G]=-q[r][G-1]/f[v+1][D],t+=q[s][G]*f[D][v]),p[G][D]=t;var K=r;r=s,s=K}}for(var L=c,M=1,N=d+1;M<N;){for(var O=M++,P=0,Q=c+1;P<Q;){var R=P++;p[O][R]*=L}L*=c-O}return p},Ia.basisFunctions=function(a,b,c){var d=Ia.knotSpan(b,a,c);return Ia.basisFunctionsGivenKnotSpanIndex(d,a,b,c)},Ia.basisFunctionsGivenKnotSpanIndex=function(a,b,c,d){var e=Ca.zeros1d(c+1),f=Ca.zeros1d(c+1),g=Ca.zeros1d(c+1),h=0,i=0;e[0]=1;for(var j=1,k=c+1;j<k;){var l=j++;f[l]=b-d[a+1-l],g[l]=d[a+l]-b,h=0;for(var m=0;m<l;){var n=m++;i=e[n]/(g[n+1]+f[l-n]),e[n]=h+g[n+1]*i,h=f[l-n]*i}e[l]=h}return e},Ia.knotSpan=function(a,b,c){return Ia.knotSpanGivenN(c.length-a-2,a,b,c)},Ia.knotSpanGivenN=function(a,b,c,d){if(c>d[a+1]-S.EPSILON)return a;if(c<d[b]+S.EPSILON)return b;for(var e=b,f=a+1,g=Math.floor((e+f)/2);c<d[g]||c>=d[g+1];)c<d[g]?f=g:e=g,g=Math.floor((e+f)/2);return g},Ia.dehomogenize=function(a){for(var b=a.length,c=[],d=a[b-1],e=a.length-1,f=0;f<e;){var g=f++;c.push(a[g]/d)}return c},Ia.rational1d=function(a){var b=a[0].length-1;return a.map(function(a){return a.slice(0,b)})},Ia.rational2d=function(a){return a.map(Ia.rational1d)},Ia.weight1d=function(a){var b=a[0].length-1;return a.map(function(a){return a[b]})},Ia.weight2d=function(a){return a.map(Ia.weight1d)},Ia.dehomogenize1d=function(a){return a.map(Ia.dehomogenize)},Ia.dehomogenize2d=function(a){return a.map(Ia.dehomogenize1d)},Ia.homogenize1d=function(a,b){var c,d=a.length,e=a[0].length,f=[],g=0,h=[];c=null!=b?b:Ca.rep(a.length,1);for(var i=0;i<d;){var j=i++,k=[];h=a[j],g=c[j];for(var l=0;l<e;){var m=l++;k.push(h[m]*g)}k.push(g),f.push(k)}return f},Ia.homogenize2d=function(a,b){var c,d=a.length,e=[];if(null!=b)c=b;else{for(var f=[],g=0;g<d;){g++;f.push(Ca.rep(a[0].length,1))}c=f}for(var h=0;h<d;){var i=h++;e.push(Ia.homogenize1d(a[i],c[i]))}return e};var Ja=b.eval.Intersect=function(){};g["verb.eval.Intersect"]=Ja,Ja.__name__=["verb","eval","Intersect"],Ja.surfaces=function(a,b,c){var d=Ma.rationalSurfaceAdaptive(a),e=Ma.rationalSurfaceAdaptive(b),f=Ja.meshes(d,e),g=f.map(function(d){return d.map(function(d){return Ja.surfacesAtPointWithEstimate(a,b,d.uv0,d.uv1,c)})});return g.map(function(a){return Ka.rationalInterpCurve(a.map(function(a){return a.point}),3)})},Ja.surfacesAtPointWithEstimate=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s=5,t=0;do{if(f=Ia.rationalSurfaceDerivatives(a,c[0],c[1],1),g=f[0][0],i=f[1][0],j=f[0][1],h=Ca.normalized(Ca.cross(i,j)),k=Ca.dot(h,g),l=Ia.rationalSurfaceDerivatives(b,d[0],d[1],1),m=l[0][0],o=l[1][0],p=l[0][1],n=Ca.normalized(Ca.cross(o,p)),q=Ca.dot(n,m),r=Ca.distSquared(g,m),r<e*e)break;var u=Ca.normalized(Ca.cross(h,n)),v=Ca.dot(u,g),w=Ja.threePlanes(h,k,n,q,u,v);if(null==w)throw new C("panic!");var x=Ca.sub(w,g),y=Ca.sub(w,m),z=Ca.cross(i,h),A=Ca.cross(j,h),B=Ca.cross(o,n),D=Ca.cross(p,n),E=Ca.dot(A,x)/Ca.dot(A,i),F=Ca.dot(z,x)/Ca.dot(z,j),G=Ca.dot(D,y)/Ca.dot(D,o),H=Ca.dot(B,y)/Ca.dot(B,p);c=Ca.add([E,F],c),d=Ca.add([G,H],d),t++}while(t<s);return new fa(c,d,g,r)},Ja.meshes=function(a,b,c,d){null==c&&(c=new qa(a)),null==d&&(d=new qa(b));var e=Ja.boundingBoxTrees(c,d,0),f=P.unique(e.map(function(c){return Ja.triangles(a,c.item0,b,c.item1)}).filter(function(a){return null!=a}).filter(function(a){return Ca.distSquared(a.min.point,a.max.point)>S.EPSILON}),function(a,b){var c=Ca.sub(a.min.uv0,b.min.uv0),d=Ca.dot(c,c),e=Ca.sub(a.max.uv0,b.max.uv0),f=Ca.dot(e,e),g=Ca.sub(a.min.uv0,b.max.uv0),h=Ca.dot(g,g),i=Ca.sub(a.max.uv0,b.min.uv0),j=Ca.dot(i,i);return d<S.EPSILON&&f<S.EPSILON||h<S.EPSILON&&j<S.EPSILON});return Ja.makeMeshIntersectionPolylines(f)},Ja.meshSlices=function(a,b,c,d){for(var e=new wa(a),f=e.boundingBox(),g=f.min[0],h=f.min[1],i=f.max[0],j=f.max[1],k=Ca.span(b,c,d),l=[],m=0;m<k.length;){var n=k[m];++m;var o=[[g,h,n],[i,h,n],[i,j,n],[g,j,n]],p=[[0,0],[1,0],[1,1],[0,1]],q=[[0,1,2],[0,2,3]],r=new Y(q,o,null,p);l.push(Ja.meshes(a,r,e))}return l},Ja.makeMeshIntersectionPolylines=function(a){if(0==a.length)return[];for(var b=0;b<a.length;){var c=a[b];++b,c.max.opp=c.min,c.min.opp=c.max}for(var d=Ja.kdTreeFromSegments(a),e=[],f=0;f<a.length;){var g=a[f];++f,e.push(g.min),e.push(g.max)}for(var h=0;h<e.length;){var i=e[h];if(++h,null==i.adj){var j=Ja.lookupAdjacentSegment(i,d,a.length);null!=j&&null==j.adj&&(i.adj=j,j.adj=i)}}var k=e.filter(function(a){return null==a.adj});0==k.length&&(k=e);for(var l=[],m=0,n=!1;0!=k.length;){var o=k.pop();if(!o.visited){for(var p=[],q=o;null!=q&&!q.visited&&(q.visited=!0,q.opp.visited=!0,p.push(q),m+=2,q=q.opp.adj,q!=o););p.length>0&&(p.push(p[p.length-1].opp),l.push(p))}if(0==k.length&&e.length>0&&(n||m<e.length)){n=!0;var r=e.pop();k.push(r)}}return l},Ja.kdTreeFromSegments=function(a){for(var b=[],c=0;c<a.length;){var d=a[c];++c,b.push(new ma(d.min.point,d.min)),b.push(new ma(d.max.point,d.max))}return new ka(b,Ca.distSquared)},Ja.lookupAdjacentSegment=function(a,b,c){var d=b.nearest(a.point,c,S.EPSILON).filter(function(b){return a!=b.item0.obj}).map(function(a){return a.item0.obj});return 1==d.length?d[0]:null},Ja.curveAndSurface=function(a,b,c,d,e){null==c&&(c=.001),d=null!=d?d:new pa(a),e=null!=e?e:new sa(b);var f=Ja.boundingBoxTrees(d,e,c);return P.unique(f.map(function(a){var b=a.item0,d=a.item1,e=P.first(b.knots),f=P.last(b.knots),g=(e+f)/2,h=P.first(d.knotsU),i=P.last(d.knotsU),j=P.first(d.knotsV),k=P.last(d.knotsV),l=[(h+i)/2,(j+k)/2];return Ja.curveAndSurfaceWithEstimate(b,d,[g].concat(l),c)}).filter(function(a){return Ca.distSquared(a.curvePoint,a.surfacePoint)<c*c}),function(a,b){return Math.abs(a.u-b.u)<.5*c})},Ja.curveAndSurfaceWithEstimate=function(a,b,c,d){null==d&&(d=.001);var e=function(c){var d=Ia.rationalCurvePoint(a,c[0]),e=Ia.rationalSurfacePoint(b,c[1],c[2]),f=Ca.sub(d,e);return Ca.dot(f,f)},f=function(c){var d=Ia.rationalCurveDerivatives(a,c[0],1),e=Ia.rationalSurfaceDerivatives(b,c[1],c[2],1),f=Ca.sub(e[0][0],d[0]),g=Ca.mul(-1,d[1]),h=e[1][0],i=e[0][1];return[2*Ca.dot(g,f),2*Ca.dot(h,f),2*Ca.dot(i,f)]},g=xa.uncmin(e,c,d*d,f),h=g.solution;return new ca(h[0],[h[1],h[2]],Ia.rationalCurvePoint(a,h[0]),Ia.rationalSurfacePoint(b,h[1],h[2]))},Ja.polylineAndMesh=function(a,b,c){for(var d=Ja.boundingBoxTrees(new ra(a),new qa(b),c),e=[],f=0;f<d.length;){var g=d[f];++f;var h=g.item0,i=g.item1,j=Ja.segmentWithTriangle(a.points[h],a.points[h+1],b.points,b.faces[i]);if(null!=j){var k=j.point,l=Ca.lerp(j.p,[a.params[h]],[a.params[h+1]])[0],m=va.triangleUVFromPoint(b,i,k);e.push(new ea(k,l,m,h,i))}}return e},Ja.boundingBoxTrees=function(a,b,c){null==c&&(c=1e-9);var d=[],e=[];d.push(a),e.push(b);for(var f=[];d.length>0;){var g=d.pop(),h=e.pop();if(!g.empty()&&!h.empty()&&g.boundingBox().intersects(h.boundingBox(),c)){var i=g.indivisible(c),j=h.indivisible(c);if(i&&j)f.push(new _(g.yield(),h.yield()));else if(!i||j)if(i||!j){var k=g.split(),l=h.split();d.push(k.item1),e.push(l.item1),d.push(k.item1),e.push(l.item0),d.push(k.item0),e.push(l.item1),d.push(k.item0),e.push(l.item0)}else{var m=g.split();d.push(m.item1),e.push(h),d.push(m.item0),e.push(h)}else{var n=h.split();d.push(g),e.push(n.item1),d.push(g),e.push(n.item0)}}}return f},Ja.curves=function(a,b,c){var d=Ja.boundingBoxTrees(new pa(a),new pa(b),0);return P.unique(d.map(function(d){return Ja.curvesWithEstimate(a,b,P.first(d.item0.knots),P.first(d.item1.knots),c)}).filter(function(a){return Ca.distSquared(a.point0,a.point1)<c}),function(a,b){return Math.abs(a.u0-b.u0)<5*c})},Ja.curvesWithEstimate=function(a,b,c,d,e){var f=function(c){var d=Ia.rationalCurvePoint(a,c[0]),e=Ia.rationalCurvePoint(b,c[1]),f=Ca.sub(d,e);return Ca.dot(f,f)},g=function(c){var d=Ia.rationalCurveDerivatives(a,c[0],1),e=Ia.rationalCurveDerivatives(b,c[1],1),f=Ca.sub(d[0],e[0]),g=d[1],h=Ca.mul(-1,e[1]);return[2*Ca.dot(g,f),2*Ca.dot(h,f)]},h=xa.uncmin(f,[c,d],e*e,g),i=h.solution[0],j=h.solution[1],k=Ia.rationalCurvePoint(a,i),l=Ia.rationalCurvePoint(b,j);return new ba(k,l,i,j)},Ja.triangles=function(a,b,c,d){var e=a.faces[b],f=c.faces[d],g=va.getTriangleNorm(a.points,e),h=va.getTriangleNorm(c.points,f),i=a.points[e[0]],j=c.points[f[0]],k=Ja.planes(i,g,j,h);if(null==k)return null;var l=Ja.clipRayInCoplanarTriangle(k,a,b);if(null==l)return null;var m=Ja.clipRayInCoplanarTriangle(k,c,d);if(null==m)return null;var n=Ja.mergeTriangleClipIntervals(l,m,a,b,c,d);return null==n?null:new aa(new da(n.min.uv0,n.min.uv1,n.min.point,b,d),new da(n.max.uv0,n.max.uv1,n.max.point,b,d))},Ja.clipRayInCoplanarTriangle=function(a,b,c){for(var d=b.faces[c],e=[b.points[d[0]],b.points[d[1]],b.points[d[2]]],f=[b.uvs[d[0]],b.uvs[d[1]],b.uvs[d[2]]],g=[Ca.sub(f[1],f[0]),Ca.sub(f[2],f[1]),Ca.sub(f[0],f[2])],h=[Ca.sub(e[1],e[0]),Ca.sub(e[2],e[1]),Ca.sub(e[0],e[2])],i=h.map(Ca.normalized),j=h.map(Ca.norm),k=null,l=null,m=0;m<3;){var n=m++,o=e[n],p=i[n],q=Ja.rays(o,p,a.origin,a.dir);if(null!=q){var r=q.u0,s=q.u1;r<-S.EPSILON||r>j[n]+S.EPSILON||((null==k||s<k.u)&&(k=new ha(s,Ca.onRay(a.origin,a.dir,s),Ca.onRay(f[n],g[n],r/j[n]))),(null==l||s>l.u)&&(l=new ha(s,Ca.onRay(a.origin,a.dir,s),Ca.onRay(f[n],g[n],r/j[n]))))}}return null==l||null==k?null:new aa(k,l)},Ja.mergeTriangleClipIntervals=function(a,b,c,d,e,f){if(b.min.u>a.max.u+S.EPSILON||a.min.u>b.max.u+S.EPSILON)return null;var g;g=a.min.u>b.min.u?new _(a.min,0):new _(b.min,1);var h;h=a.max.u<b.max.u?new _(a.max,0):new _(b.max,1);var i=new aa(new da(null,null,g.item0.point,d,f),new da(null,null,h.item0.point,d,f));return 0==g.item1?(i.min.uv0=g.item0.uv,i.min.uv1=va.triangleUVFromPoint(e,f,g.item0.point)):(i.min.uv0=va.triangleUVFromPoint(c,d,g.item0.point),i.min.uv1=g.item0.uv),0==h.item1?(i.max.uv0=h.item0.uv,i.max.uv1=va.triangleUVFromPoint(e,f,h.item0.point)):(i.max.uv0=va.triangleUVFromPoint(c,d,h.item0.point),i.max.uv1=h.item0.uv),i},Ja.planes=function(a,b,c,d){var e=Ca.cross(b,d);if(Ca.dot(e,e)<S.EPSILON)return null;var f=0,g=Math.abs(e[0]),h=Math.abs(e[1]),i=Math.abs(e[2]);h>g&&(f=1,g=h),i>g&&(f=2,g=i);var j,k,l,m;0==f?(j=b[1],k=b[2],l=d[1],m=d[2]):1==f?(j=b[0],k=b[2],l=d[0],m=d[2]):(j=b[0],k=b[1],l=d[0],m=d[1]);var n,o=-Ca.dot(a,b),p=-Ca.dot(c,d),q=j*m-k*l,r=(k*p-o*m)/q,s=(o*l-j*p)/q;return n=0==f?[0,r,s]:1==f?[r,0,s]:[r,s,0],new V(n,Ca.normalized(e))},Ja.threePlanes=function(a,b,c,d,e,f){var g=Ca.cross(c,e),h=Ca.dot(a,g);if(Math.abs(h)<S.EPSILON)return null;var i=Ca.sub(Ca.mul(f,c),Ca.mul(d,e)),j=Ca.add(Ca.mul(b,g),Ca.cross(a,i));return Ca.mul(1/h,j)},Ja.polylines=function(a,b,c){for(var d=Ja.boundingBoxTrees(new ra(a),new ra(b),c),e=[],f=0;f<d.length;){var g=d[f];++f;var h=g.item0,i=g.item1,j=Ja.segments(a.points[h],a.points[h+1],b.points[i],b.points[i+1],c);null!=j&&(j.u0=Ca.lerp(j.u0,[a.params[h]],[a.params[h+1]])[0],j.u1=Ca.lerp(j.u1,[b.params[i]],[b.params[i+1]])[0],e.push(j))}return e},Ja.segments=function(a,b,c,d,e){var f=Ca.sub(b,a),g=Math.sqrt(Ca.dot(f,f)),h=Ca.mul(1/g,f),i=Ca.sub(d,c),j=Math.sqrt(Ca.dot(i,i)),k=Ca.mul(1/j,i),l=Ja.rays(a,h,c,k);if(null!=l){var m=Math.min(Math.max(0,l.u0/g),1),n=Math.min(Math.max(0,l.u1/j),1),o=Ca.onRay(a,f,m),p=Ca.onRay(c,i,n),q=Ca.distSquared(o,p);if(q<e*e)return new ba(o,p,m,n)}return null},Ja.rays=function(a,b,c,d){var e=Ca.dot(b,d),f=Ca.dot(b,c),g=Ca.dot(b,a),h=Ca.dot(d,c),i=Ca.dot(d,a),j=Ca.dot(b,b),k=Ca.dot(d,d),l=j*k-e*e;if(Math.abs(l)<S.EPSILON)return null;var m=e*(f-g)-j*(h-i),n=m/l,o=(f-g+n*e)/j,p=Ca.onRay(a,b,o),q=Ca.onRay(c,d,n);return new ba(p,q,o,n)},Ja.segmentWithTriangle=function(a,b,c,d){var e=c[d[0]],f=c[d[1]],g=c[d[2]],h=Ca.sub(f,e),i=Ca.sub(g,e),j=Ca.cross(h,i),k=Ca.sub(b,a),l=Ca.sub(a,e),m=-Ca.dot(j,l),n=Ca.dot(j,k);if(Math.abs(n)<S.EPSILON)return null;var o=m/n;if(o<0||o>1)return null;var p=Ca.add(a,Ca.mul(o,k)),q=Ca.dot(h,i),r=Ca.dot(h,h),s=Ca.dot(i,i),t=Ca.sub(p,e),u=Ca.dot(t,h),v=Ca.dot(t,i),w=q*q-r*s;if(Math.abs(w)<S.EPSILON)return null;var x=(q*v-s*u)/w,y=(q*u-r*v)/w;return x>1+S.EPSILON||y>1+S.EPSILON||y<-S.EPSILON||x<-S.EPSILON||x+y>1+S.EPSILON?null:new ga(p,x,y,o)},Ja.segmentAndPlane=function(a,b,c,d){var e=Ca.dot(d,Ca.sub(b,a));if(Math.abs(e)<S.EPSILON)return null;var f=Ca.dot(d,Ca.sub(c,a)),g=f/e;return g>1+S.EPSILON||g<-S.EPSILON?null:{p:g}};var Ka=b.eval.Make=function(){};g["verb.eval.Make"]=Ka,Ka.__name__=["verb","eval","Make"],Ka.rationalTranslationalSurface=function(a,b){for(var c=Ia.rationalCurvePoint(b,P.first(b.knots)),d=P.first(b.knots),e=P.last(b.knots),f=2*b.controlPoints.length,g=(e-d)/(f-1),h=[],i=0;i<f;){var j=i++,k=Ca.sub(Ia.rationalCurvePoint(b,d+j*g),c),l=La.rationalCurveTransform(a,[[1,0,0,k[0]],[0,1,0,k[1]],[0,0,1,k[2]],[0,0,0,1]]);h.push(l)}return Ka.loftedSurface(h)},Ka.surfaceBoundaryCurves=function(a){var b=Ka.surfaceIsocurve(a,P.first(a.knotsU),!1),c=Ka.surfaceIsocurve(a,P.last(a.knotsU),!1),d=Ka.surfaceIsocurve(a,P.first(a.knotsV),!0),e=Ka.surfaceIsocurve(a,P.last(a.knotsV),!0);return[b,c,d,e]},Ka.surfaceIsocurve=function(a,b,c){null==c&&(c=!1);var d;d=c?a.knotsV:a.knotsU;var e;e=c?a.degreeV:a.degreeU;for(var f=Da.knotMultiplicities(d),g=-1,h=0,i=f.length;h<i;){var j=h++;if(Math.abs(b-f[j].knot)<S.EPSILON){g=j;break}}var k=e+1;g>=0&&(k-=f[g].mult);var l;l=k>0?La.surfaceKnotRefine(a,Ca.rep(k,b),c):a;var m=Ia.knotSpan(e,b,d);return Math.abs(b-P.first(d))<S.EPSILON?m=0:Math.abs(b-P.last(d))<S.EPSILON&&(m=(c?l.controlPoints[0].length:l.controlPoints.length)-1),c?new W(l.degreeU,l.knotsU,function(a){for(var b,c=[],d=0,e=l.controlPoints;d<e.length;){var f=e[d];++d,c.push(f[m])}return b=c}(this)):new W(l.degreeV,l.knotsV,l.controlPoints[m])},Ka.loftedSurface=function(a,b){a=La.unifyCurveKnotVectors(a);var c=a[0].degree;null==b&&(b=3),b>a.length-1&&(b=a.length-1);for(var d=a[0].knots,e=[],f=[],g=0,h=a[0].controlPoints.length;g<h;){var i=[g++],j=a.map(function(a){return function(b){return b.controlPoints[a[0]]}}(i)),k=Ka.rationalInterpCurve(j,b,!0);f.push(k.controlPoints),e=k.knots}return new X(c,b,d,e,f)},Ka.clonedCurve=function(a){return new W(a.degree,a.knots.slice(),a.controlPoints.map(function(a){return a.slice()}))},Ka.rationalBezierCurve=function(a,b){for(var c=a.length-1,d=[],e=0,f=c+1;e<f;){e++;d.push(0)}for(var g=0,h=c+1;g<h;){g++;d.push(1)}return null==b&&(b=Ca.rep(a.length,1)),new W(c,d,Ia.homogenize1d(a,b))},Ka.fourPointSurface=function(a,b,c,d,e){null==e&&(e=3);for(var f=e,g=[],h=0,i=e+1;h<i;){for(var j=h++,k=[],l=0,m=e+1;l<m;){var n=l++,o=1-j/f,p=Ca.lerp(o,a,b),q=Ca.lerp(o,d,c),r=Ca.lerp(1-n/f,p,q);r.push(1),k.push(r)}g.push(k)}var s=Ca.rep(e+1,0),t=Ca.rep(e+1,1);return new X(e,e,s.concat(t),s.concat(t),g)},Ka.ellipseArc=function(a,b,c,d,e){var f=Ca.norm(b),g=Ca.norm(c);b=Ca.normalized(b),c=Ca.normalized(c),e<d&&(e=2*Math.PI+d);var h=e-d,i=0;i=h<=Math.PI/2?1:h<=Math.PI?2:h<=3*Math.PI/2?3:4;var j=h/i,k=Math.cos(j/2),l=Ca.add(a,Ca.add(Ca.mul(f*Math.cos(d),b),Ca.mul(g*Math.sin(d),c))),m=Ca.sub(Ca.mul(Math.cos(d),c),Ca.mul(Math.sin(d),b)),n=[],o=Ca.zeros1d(2*i+3),p=0,q=d,r=Ca.zeros1d(2*i);n[0]=l,r[0]=1;for(var s=1,t=i+1;s<t;){var u=s++;q+=j;var v=Ca.add(a,Ca.add(Ca.mul(f*Math.cos(q),b),Ca.mul(g*Math.sin(q),c)));r[p+2]=1,n[p+2]=v;var w=Ca.sub(Ca.mul(Math.cos(q),c),Ca.mul(Math.sin(q),b)),x=Ja.rays(l,Ca.mul(1/Ca.norm(m),m),v,Ca.mul(1/Ca.norm(w),w)),y=Ca.add(l,Ca.mul(x.u0,m));r[p+1]=k,n[p+1]=y,p+=2,u<i&&(l=v,m=w)}for(var z=2*i+1,A=0;A<3;){var B=A++;o[B]=0,o[B+z]=1}switch(i){case 2:o[3]=o[4]=.5;break;case 3:o[3]=o[4]=.3333333333333333,o[5]=o[6]=.6666666666666666;break;case 4:o[3]=o[4]=.25,o[5]=o[6]=.5,o[7]=o[8]=.75}return new W(2,o,Ia.homogenize1d(n,r))},Ka.arc=function(a,b,c,d,e,f){return Ka.ellipseArc(a,Ca.mul(d,Ca.normalized(b)),Ca.mul(d,Ca.normalized(c)),e,f)},Ka.polyline=function(a){for(var b=[0,0],c=0,d=0,e=a.length-1;d<e;){var f=d++;c+=Ca.dist(a[f],a[f+1]),b.push(c)}b.push(c),b=Ca.mul(1/c,b);for(var g,h=[],i=0,j=a.length;i<j;){i++;h.push(1)}return g=h,new W(1,b,Ia.homogenize1d(a.slice(0),g))},Ka.extrudedSurface=function(a,b,c){for(var d=[[],[],[]],e=[[],[],[]],f=Ia.dehomogenize1d(c.controlPoints),g=Ia.weight1d(c.controlPoints),h=Ca.mul(b,a),i=Ca.mul(.5*b,a),j=0,k=f.length;j<k;){var l=j++;d[2][l]=f[l],d[1][l]=Ca.add(i,f[l]),d[0][l]=Ca.add(h,f[l]),e[0][l]=g[l],e[1][l]=g[l],e[2][l]=g[l]}return new X(2,c.degree,[0,0,0,1,1,1],c.knots,Ia.homogenize2d(d,e))},Ka.cylindricalSurface=function(a,b,c,d,e){var f=Ca.cross(a,b),g=(2*Math.PI,Ka.arc(c,b,f,e,0,2*Math.PI));return Ka.extrudedSurface(a,d,g)},Ka.revolvedSurface=function(a,b,c,d){var e,f,g=Ia.dehomogenize1d(a.controlPoints),h=Ia.weight1d(a.controlPoints);d<=Math.PI/2?(e=1,f=Ca.zeros1d(6+2*(e-1))):d<=Math.PI?(e=2,f=Ca.zeros1d(6+2*(e-1)),f[3]=f[4]=.5):d<=3*Math.PI/2?(e=3,f=Ca.zeros1d(6+2*(e-1)),f[3]=f[4]=.3333333333333333,f[5]=f[6]=.6666666666666666):(e=4,f=Ca.zeros1d(6+2*(e-1)),f[3]=f[4]=.25,f[5]=f[6]=.5,f[7]=f[8]=.75);for(var i=d/e,j=3+2*(e-1),k=0;k<3;){var l=k++;f[l]=0,f[j+l]=1}for(var m=Math.cos(i/2),n=0,o=Ca.zeros1d(e+1),p=Ca.zeros1d(e+1),q=Ca.zeros3d(2*e+1,g.length,3),r=Ca.zeros2d(2*e+1,g.length),s=1,t=e+1;s<t;){var u=s++;n+=i,p[u]=Math.cos(n),o[u]=Math.sin(n)}for(var v=0,w=g.length;v<w;){var x=v++,y=Ba.rayClosestPoint(g[x],b,c),z=Ca.sub(g[x],y),A=Ca.norm(z),B=Ca.cross(c,z);A>S.EPSILON&&(z=Ca.mul(1/A,z),B=Ca.mul(1/A,B)),q[0][x]=g[x];var C=g[x];r[0][x]=h[x];for(var D=B,E=0,F=1,G=e+1;F<G;){var H,I=F++;H=0==A?y:Ca.add(y,Ca.add(Ca.mul(A*p[I],z),Ca.mul(A*o[I],B))),q[E+2][x]=H,r[E+2][x]=h[x];var J=Ca.sub(Ca.mul(p[I],B),Ca.mul(o[I],z));if(0==A)q[E+1][x]=y;else{var K=Ja.rays(C,Ca.mul(1/Ca.norm(D),D),H,Ca.mul(1/Ca.norm(J),J)),L=Ca.add(C,Ca.mul(K.u0,D));q[E+1][x]=L}r[E+1][x]=m*h[x],E+=2,I<e&&(C=H,D=J)}}return new X(2,a.degree,f,a.knots,Ia.homogenize2d(q,r))},Ka.sphericalSurface=function(a,b,c,d){var e=Ka.arc(a,Ca.mul(-1,b),c,d,0,Math.PI);return Ka.revolvedSurface(e,a,b,2*Math.PI)},Ka.conicalSurface=function(a,b,c,d,e){var f=2*Math.PI,g=1,h=[Ca.add(c,Ca.mul(d,a)),Ca.add(c,Ca.mul(e,b))],i=[0,0,1,1],j=[1,1],k=new W(g,i,Ia.homogenize1d(h,j));return Ka.revolvedSurface(k,c,a,f)},Ka.rationalInterpCurve=function(a,b,c,d,e){if(null==c&&(c=!1),null==b&&(b=3),a.length<b+1)throw new C("You need to supply at least degree + 1 points! You only supplied "+a.length+" points.");for(var f=[0],g=1,h=a.length;g<h;){var i=g++,j=Ca.norm(Ca.sub(a[i],a[i-1])),k=f[f.length-1];f.push(k+j)}for(var l=f[f.length-1],m=0,n=f.length;m<n;){var o=m++;f[o]=f[o]/l}var p,q=Ca.rep(b+1,0),r=null!=d&&null!=e;p=r?0:1;var s;s=r?f.length-b+1:f.length-b;for(var t=p;t<s;){for(var u=t++,v=0,w=0;w<b;){var x=w++;v+=f[u+x]}q.push(1/b*v)}var y,z=q.concat(Ca.rep(b+1,1)),A=[];y=r?a.length+1:a.length-1;var B;B=r?1:0;var D;D=r?a.length-(b-1):a.length-(b+1);for(var E=0;E<f.length;){var F=f[E];++E;var G=Ia.knotSpanGivenN(y,b,F,z),H=Ia.basisFunctionsGivenKnotSpanIndex(G,F,b,z),I=G-b,J=Ca.zeros1d(I),K=Ca.zeros1d(D-I);A.push(J.concat(H).concat(K))}if(r){var L=A[0].length-2,M=[-1,1].concat(Ca.zeros1d(L)),N=Ca.zeros1d(L).concat([-1,1]);P.spliceAndInsert(A,1,0,M),P.spliceAndInsert(A,A.length-1,0,N)}for(var O=a[0].length,Q=[],R=(1-z[z.length-b-2])/b,S=z[b+1]/b,T=0;T<O;){var U,V=[T++];if(r){U=[a[0][V[0]]],U.push(S*d[V[0]]);for(var X=1,Y=a.length-1;X<Y;){var Z=X++;U.push(a[Z][V[0]])}U.push(R*e[V[0]]),U.push(P.last(a)[V[0]])}else U=a.map(function(a){return function(b){return b[a[0]]}}(V));var $=ta.solve(A,U);Q.push($)}var _=ta.transpose(Q);if(!c){var aa=Ca.rep(_.length,1);_=Ia.homogenize1d(_,aa)}return new W(b,z,_)};var La=b.eval.Modify=function(){};g["verb.eval.Modify"]=La,La.__name__=["verb","eval","Modify"],La.curveReverse=function(a){return new W(a.degree,La.knotsReverse(a.knots),P.reversed(a.controlPoints))},La.surfaceReverse=function(a,b){return null==b&&(b=!1),b?new X(a.degreeU,a.degreeV,a.knotsU,La.knotsReverse(a.knotsV),function(b){for(var c,d=[],e=0,f=a.controlPoints;e<f.length;){var g=f[e];++e,d.push(P.reversed(g))}return c=d}(this)):new X(a.degreeU,a.degreeV,La.knotsReverse(a.knotsU),a.knotsV,P.reversed(a.controlPoints))},La.knotsReverse=function(a){for(var b=P.first(a),c=(P.last(a),[b]),d=a.length,e=1;e<d;){var f=e++;c.push(c[f-1]+(a[d-f]-a[d-f-1]))}return c},La.unifyCurveKnotVectors=function(a){a=a.map(Ka.clonedCurve);for(var b=j.fold(a,function(a,b){return La.imax(a.degree,b)},0),c=0,d=a.length;c<d;){var e=c++;a[e].degree<b&&(a[e]=La.curveElevateDegree(a[e],b))}for(var f,g=[],h=0;h<a.length;){var i=a[h];++h,g.push(new aa(P.first(i.knots),P.last(i.knots)))}f=g;for(var k=0,l=a.length;k<l;){var m=k++,n=[f[m].min];a[m].knots=a[m].knots.map(function(a){return function(b){return b-a[0]}}(n))}for(var o=f.map(function(a){return a.max-a.min}),p=j.fold(o,function(a,b){return Math.max(a,b)},0),q=0,r=a.length;q<r;){var s=q++,t=[p/o[s]];a[s].knots=a[s].knots.map(function(a){return function(b){return b*a[0]}}(t))}for(var u=j.fold(a,function(a,b){return Ca.sortedSetUnion(a.knots,b)},[]),v=0,w=a.length;v<w;){var x=v++,y=Ca.sortedSetSub(u,a[x].knots);0==y.length&&(a[x]=a[x]),a[x]=La.curveKnotRefine(a[x],y)}return a},La.imin=function(a,b){return a<b?a:b},La.imax=function(a,b){return a>b?a:b},La.curveElevateDegree=function(a,b){if(b<=a.degree)return a;var c,d=a.knots.length-a.degree-2,e=a.degree,f=a.knots,g=a.controlPoints,h=b-a.degree,i=a.controlPoints[0].length,j=Ca.zeros2d(e+h+1,e+1),k=[],l=[],m=[],n=d+e+1,o=b,p=Math.floor(o/2),q=[],r=[];j[0][0]=1,j[o][e]=1;for(var s=1,t=p+1;s<t;)for(var u=s++,v=1/Q.get(o,u),w=La.imin(e,u),x=La.imax(0,u-h),y=w+1;x<y;){var z=x++;j[u][z]=v*Q.get(e,z)*Q.get(h,u-z)}for(var A=p+1;A<o;)for(var B=A++,C=La.imin(e,B),D=La.imax(0,B-h),E=C+1;D<E;){var F=D++;j[B][F]=j[o-B][e-F]}var G=o,H=o+1,I=-1,J=e,K=e+1,L=1,M=f[0];q[0]=g[0];for(var N=0,O=o+1;N<O;){var P=N++;r[P]=M}for(var R=0,S=e+1;R<S;){var T=R++;k[T]=g[T]}for(;K<n;){for(var U=K;K<n&&f[K]==f[K+1];)K+=1;var V=K-U+1,X=f[K],Y=I;I=e-V;var Z;Z=Y>0?Math.floor((Y+2)/2):1;var $;if($=I>0?Math.floor(o-(I+1)/2):o,I>0){for(var _=X-M,aa=[],ba=e;ba>V;)aa[ba-V-1]=_/(f[J+ba]-M),ba--;for(var ca=1,da=I+1;ca<da;){for(var ea=ca++,fa=I-ea,ga=V+ea,ha=e;ha>=ga;)k[ha]=Ca.add(Ca.mul(aa[ha-ga],k[ha]),Ca.mul(1-aa[ha-ga],k[ha-1])),ha--;m[fa]=k[e]}}for(var ia=Z,ja=o+1;ia<ja;){var ka=ia++;l[ka]=Ca.zeros1d(i);for(var la=La.imin(e,ka),ma=La.imax(0,ka-h),na=la+1;ma<na;){var oa=ma++;l[ka]=Ca.add(l[ka],Ca.mul(j[ka][oa],k[oa]))}}if(Y>1)for(var pa=H-2,qa=H,ra=X-M,sa=(X-r[H-1])/ra,ta=1;ta<Y;){for(var ua=ta++,va=pa,wa=qa,xa=wa-H+1;wa-va>ua;){if(va<L){var ya=(X-r[va])/(M-r[va]);q[va]=Ca.lerp(ya,q[va],q[va-1])}if(wa>=Z){if(wa-ua<=H-o+Y){var za=(X-r[wa-ua])/ra;l[xa]=Ca.lerp(za,l[xa],l[xa+1])}}else l[xa]=Ca.lerp(sa,l[xa],l[xa+1]);va+=1,wa-=1,xa-=1}pa-=1,qa+=1}if(J!=e)for(var Aa=0,Ba=o-Y;Aa<Ba;){Aa++;r[H]=M,H+=1}for(var Da=Z,Ea=$+1;Da<Ea;){var Fa=Da++;q[L]=l[Fa],L+=1}if(K<n){for(var Ga=0;Ga<I;){var Ha=Ga++;k[Ha]=m[Ha]}for(var Ia=I,Ja=e+1;Ia<Ja;){
var Ka=Ia++;k[Ka]=g[K-e+Ka]}J=K,K+=1,M=X}else for(var Ma=0,Na=o+1;Ma<Na;){var Oa=Ma++;r[H+Oa]=X}}return c=G-o-1,new W(b,r,q)},La.rationalSurfaceTransform=function(a,b){for(var c=Ia.dehomogenize2d(a.controlPoints),d=0,e=c.length;d<e;)for(var f=d++,g=0,h=c[f].length;g<h;){var i=g++,j=c[f][i];j.push(1),c[f][i]=ta.dot(b,j).slice(0,j.length-1)}return new X(a.degreeU,a.degreeV,a.knotsU.slice(),a.knotsV.slice(),Ia.homogenize2d(c,Ia.weight2d(a.controlPoints)))},La.rationalCurveTransform=function(a,b){for(var c=Ia.dehomogenize1d(a.controlPoints),d=0,e=c.length;d<e;){var f=d++,g=c[f];g.push(1),c[f]=ta.dot(b,g).slice(0,g.length-1)}return new W(a.degree,a.knots.slice(),Ia.homogenize1d(c,Ia.weight1d(a.controlPoints)))},La.surfaceKnotRefine=function(a,b,c){var d,e,f,g=[];c?(f=a.controlPoints,d=a.knotsV,e=a.degreeV):(f=ta.transpose(a.controlPoints),d=a.knotsU,e=a.degreeU);for(var h=null,i=0;i<f.length;){var j=f[i];++i,h=La.curveKnotRefine(new W(e,d,j),b),g.push(h.controlPoints)}var k=h.knots;return c?new X(a.degreeU,a.degreeV,a.knotsU.slice(),k,g):(g=ta.transpose(g),new X(a.degreeU,a.degreeV,k,a.knotsV.slice(),g))},La.decomposeCurveIntoBeziers=function(a){for(var b=a.degree,c=a.controlPoints,d=a.knots,e=Da.knotMultiplicities(d),f=b+1,g=0;g<e.length;){var h=e[g];if(++g,h.mult<f){var i=Ca.rep(f-h.mult,h.knot),j=La.curveKnotRefine(new W(b,d,c),i);d=j.knots,c=j.controlPoints}}for(var k=(d.length/f-1,2*f),l=[],m=0;m<c.length;){var n=d.slice(m,m+k),o=c.slice(m,m+f);l.push(new W(b,n,o)),m+=f}return l},La.curveKnotRefine=function(a,b){if(0==b.length)return Ka.clonedCurve(a);for(var c=a.degree,d=a.controlPoints,e=a.knots,f=d.length-1,g=f+c+1,h=b.length-1,i=Ia.knotSpan(c,b[0],e),j=Ia.knotSpan(c,b[h],e),k=[],l=[],m=0,n=i-c+1;m<n;){var o=m++;k[o]=d[o]}for(var p=j-1,q=f+1;p<q;){var r=p++;k[r+h+1]=d[r]}for(var s=0,t=i+1;s<t;){var u=s++;l[u]=e[u]}for(var v=j+c,w=g+1;v<w;){var x=v++;l[x+h+1]=e[x]}for(var y=j+c-1,z=j+c+h,A=h;A>=0;){for(;b[A]<=e[y]&&y>i;)k[z-c-1]=d[y-c-1],l[z]=e[y],z-=1,y-=1;k[z-c-1]=k[z-c];for(var B=1,C=c+1;B<C;){var D=B++,E=z-c+D,F=l[z+D]-b[A];Math.abs(F)<S.EPSILON?k[E-1]=k[E]:(F/=l[z+D]-e[y-c+D],k[E-1]=Ca.add(Ca.mul(F,k[E-1]),Ca.mul(1-F,k[E])))}l[z]=b[A],z-=1,A--}return new W(c,l,k)},La.curveKnotInsert=function(a,b,c){for(var d=a.degree,e=a.controlPoints,f=a.knots,g=0,h=e.length,i=Ia.knotSpan(d,b,f),j=[],k=[],l=[],m=1,n=i+1;m<n;){var o=m++;k[o]=f[o]}for(var p=1,q=c+1;p<q;){var r=p++;k[i+r]=b}for(var s=i+1,t=f.length;s<t;){var u=s++;k[u+c]=f[u]}for(var v=0,w=i-d+1;v<w;){var x=v++;l[x]=e[x]}for(var y=i-g;y<h;){var z=y++;l[z+c]=e[z]}for(var A=0,B=d-g+1;A<B;){var C=A++;j[C]=e[i-d+C]}for(var D=0,E=0,F=1,G=c+1;F<G;){var H=F++;D=i-d+H;for(var I=0,J=d-H-g+1;I<J;){var K=I++;E=(b-f[D+K])/(f[K+i+1]-f[D+K]),j[K]=Ca.add(Ca.mul(E,j[K+1]),Ca.mul(1-E,j[K]))}l[D]=j[0],l[i+c-H-g]=j[d-H-g]}for(var L=D+1,M=i-g;L<M;){var N=L++;l[N]=j[N-D]}return new W(d,k,l)};var Ma=b.eval.Tess=function(){};g["verb.eval.Tess"]=Ma,Ma.__name__=["verb","eval","Tess"],Ma.rationalCurveRegularSample=function(a,b,c){return Ma.rationalCurveRegularSampleRange(a,a.knots[0],P.last(a.knots),b,c)},Ma.rationalCurveRegularSampleRange=function(a,b,c,d,e){d<1&&(d=2);for(var f=[],g=(c-b)/(d-1),h=0,i=0;i<d;){var j=i++;h=b+g*j,e?f.push([h].concat(Ia.rationalCurvePoint(a,h))):f.push(Ia.rationalCurvePoint(a,h))}return f},Ma.rationalCurveAdaptiveSample=function(a,b,c){if(null==c&&(c=!1),null==b&&(b=1e-6),1==a.degree){if(c){for(var d=[],e=0,f=a.controlPoints.length;e<f;){var g=e++;d.push([a.knots[g+1]].concat(Ia.dehomogenize(a.controlPoints[g])))}return d}return a.controlPoints.map(Ia.dehomogenize)}return Ma.rationalCurveAdaptiveSampleRange(a,a.knots[0],P.last(a.knots),b,c)},Ma.rationalCurveAdaptiveSampleRange=function(a,b,c,d,e){var f=Ia.rationalCurvePoint(a,b),g=Ia.rationalCurvePoint(a,c),h=.5+.2*Math.random(),i=b+(c-b)*h,j=Ia.rationalCurvePoint(a,i),k=Ca.sub(f,g),l=Ca.sub(f,j);if(Ca.dot(k,k)<d&&Ca.dot(l,l)>d||!Ba.threePointsAreFlat(f,j,g,d)){var m=b+.5*(c-b),n=Ma.rationalCurveAdaptiveSampleRange(a,b,m,d,e),o=Ma.rationalCurveAdaptiveSampleRange(a,m,c,d,e);return n.slice(0,-1).concat(o)}return e?[[b].concat(f),[c].concat(g)]:[f,g]},Ma.rationalSurfaceNaive=function(a,b,c){b<1&&(b=1),c<1&&(c=1);for(var d=(a.degreeU,a.degreeV,a.controlPoints,a.knotsU),e=a.knotsV,f=P.last(d)-d[0],g=P.last(e)-e[0],h=f/b,i=g/c,j=[],k=[],l=[],m=0,n=b+1;m<n;)for(var o=m++,p=0,q=c+1;p<q;){var r=p++,s=o*h,t=r*i;k.push([s,t]);var u=Ia.rationalSurfaceDerivatives(a,s,t,1),v=u[0][0];j.push(v);var w=Ca.normalized(Ca.cross(u[1][0],u[0][1]));l.push(w)}for(var x=[],y=0;y<b;)for(var z=y++,A=0;A<c;){var B=A++,C=z*(c+1)+B,D=(z+1)*(c+1)+B,E=D+1,F=C+1,G=[C,D,E],H=[C,E,F];x.push(G),x.push(H)}return new Y(x,j,l,k)},Ma.divideRationalSurfaceAdaptive=function(a,b){null==b&&(b=new Na),null!=b.minDivsU?b.minDivsU=b.minDivsU:b.minDivsU=1,null!=b.minDivsV?b.minDivsU=b.minDivsV:b.minDivsU=1,null!=b.refine?b.refine=b.refine:b.refine=!0;var c,d=2*(a.controlPoints.length-1),e=2*(a.controlPoints[0].length-1);c=b.minDivsU>d?b.minDivsU=b.minDivsU:b.minDivsU=d;var f;f=b.minDivsV>e?b.minDivsV=b.minDivsV:b.minDivsV=e;for(var g=P.last(a.knotsU),h=a.knotsU[0],i=P.last(a.knotsV),j=a.knotsV[0],k=(g-h)/c,l=(i-j)/f,m=[],n=[],o=0,p=f+1;o<p;){for(var q=o++,r=[],s=0,t=c+1;s<t;){var u=s++,v=h+k*u,w=j+l*q,x=Ia.rationalSurfaceDerivatives(a,v,w,1),y=Ca.normalized(Ca.cross(x[0][1],x[1][0]));r.push(new ia(x[0][0],y,[v,w],-1,Ca.isZero(y)))}n.push(r)}for(var z=0;z<f;)for(var A=z++,B=0;B<c;){var C=B++,D=[n[f-A-1][C],n[f-A-1][C+1],n[f-A][C+1],n[f-A][C]];m.push(new Oa(a,D))}if(!b.refine)return m;for(var E=0;E<f;)for(var F=E++,G=0;G<c;){var H=G++,I=F*c+H,J=Ma.north(I,F,H,c,f,m),K=Ma.east(I,F,H,c,f,m),L=Ma.south(I,F,H,c,f,m),M=Ma.west(I,F,H,c,f,m);m[I].neighbors=[L,K,J,M],m[I].divide(b)}return m},Ma.north=function(a,b,c,d,e,f){return 0==b?null:f[a-d]},Ma.south=function(a,b,c,d,e,f){return b==e-1?null:f[a+d]},Ma.east=function(a,b,c,d,e,f){return c==d-1?null:f[a+1]},Ma.west=function(a,b,c,d,e,f){return 0==c?null:f[a-1]},Ma.triangulateAdaptiveRefinementNodeTree=function(a){for(var b=Y.empty(),c=0;c<a.length;){var d=a[c];++c,d.triangulate(b)}return b},Ma.rationalSurfaceAdaptive=function(a,b){b=null!=b?b:new Na;var c=Ma.divideRationalSurfaceAdaptive(a,b);return Ma.triangulateAdaptiveRefinementNodeTree(c)};var Na=b.core.AdaptiveRefinementOptions=function(){this.minDivsV=1,this.minDivsU=1,this.refine=!0,this.maxDepth=10,this.minDepth=0,this.normTol=.025};g["verb.eval.AdaptiveRefinementOptions"]=Na,Na.__name__=["verb","eval","AdaptiveRefinementOptions"],Na.prototype={__class__:Na};var Oa=b.core.AdaptiveRefinementNode=function(a,b,c){if(this.srf=a,null==c?this.neighbors=[null,null,null,null]:this.neighbors=c,this.corners=b,null==this.corners){var d=a.knotsU[0],e=P.last(a.knotsU),f=a.knotsV[0],g=P.last(a.knotsV);this.corners=[ia.fromUv(d,f),ia.fromUv(e,f),ia.fromUv(e,g),ia.fromUv(d,g)]}};g["verb.eval.AdaptiveRefinementNode"]=Oa,Oa.__name__=["verb","eval","AdaptiveRefinementNode"],Oa.prototype={isLeaf:function(){return null==this.children},center:function(){return null!=this.centerPoint?this.centerPoint:this.evalSrf(this.u05,this.v05)},evalCorners:function(){this.u05=(this.corners[0].uv[0]+this.corners[2].uv[0])/2,this.v05=(this.corners[0].uv[1]+this.corners[2].uv[1])/2;for(var a=0;a<4;){var b=a++;if(null==this.corners[b].point){var c=this.corners[b];this.evalSrf(c.uv[0],c.uv[1],c)}}},evalSrf:function(a,b,c){var d=Ia.rationalSurfaceDerivatives(this.srf,a,b,1),e=d[0][0],f=Ca.cross(d[0][1],d[1][0]),g=Ca.isZero(f);return g||(f=Ca.normalized(f)),null!=c?(c.degen=g,c.point=e,c.normal=f,c):new ia(e,f,[a,b],-1,g)},getEdgeCorners:function(a){if(this.isLeaf())return[this.corners[a]];if(this.horizontal)switch(a){case 0:return this.children[0].getEdgeCorners(0);case 1:return this.children[0].getEdgeCorners(1).concat(this.children[1].getEdgeCorners(1));case 2:return this.children[1].getEdgeCorners(2);case 3:return this.children[1].getEdgeCorners(3).concat(this.children[0].getEdgeCorners(3))}switch(a){case 0:return this.children[0].getEdgeCorners(0).concat(this.children[1].getEdgeCorners(0));case 1:return this.children[1].getEdgeCorners(1);case 2:return this.children[1].getEdgeCorners(2).concat(this.children[0].getEdgeCorners(2));case 3:return this.children[0].getEdgeCorners(3)}return null},getAllCorners:function(a){var b=[this.corners[a]];if(null==this.neighbors[a])return b;var c=this.neighbors[a].getEdgeCorners((a+2)%4),d=a%2,e=S.EPSILON,f=this,g=[function(a){return a.uv[0]>f.corners[0].uv[0]+e&&a.uv[0]<f.corners[2].uv[0]-e},function(a){return a.uv[1]>f.corners[0].uv[1]+e&&a.uv[1]<f.corners[2].uv[1]-e}],h=c.filter(g[d]);return h.reverse(),b.concat(h)},midpoint:function(a){if(null==this.midPoints&&(this.midPoints=[null,null,null,null]),null!=this.midPoints[a])return this.midPoints[a];switch(a){case 0:this.midPoints[0]=this.evalSrf(this.u05,this.corners[0].uv[1]);break;case 1:this.midPoints[1]=this.evalSrf(this.corners[1].uv[0],this.v05);break;case 2:this.midPoints[2]=this.evalSrf(this.u05,this.corners[2].uv[1]);break;case 3:this.midPoints[3]=this.evalSrf(this.corners[0].uv[0],this.v05)}return this.midPoints[a]},hasBadNormals:function(){return this.corners[0].degen||this.corners[1].degen||this.corners[2].degen||this.corners[3].degen},fixNormals:function(){for(var a=this.corners.length,b=0;b<a;){var c=b++;this.corners[c];if(this.corners[c].degen){var d=this.corners[(c+1)%a],e=this.corners[(c+3)%a];d.degen?this.corners[c].normal=e.normal:this.corners[c].normal=d.normal}}},shouldDivide:function(a,b){if(b<a.minDepth)return!0;if(b>=a.maxDepth)return!1;if(this.hasBadNormals())return this.fixNormals(),!1;if(this.splitVert=Ca.normSquared(Ca.sub(this.corners[0].normal,this.corners[1].normal))>a.normTol||Ca.normSquared(Ca.sub(this.corners[2].normal,this.corners[3].normal))>a.normTol,this.splitHoriz=Ca.normSquared(Ca.sub(this.corners[1].normal,this.corners[2].normal))>a.normTol||Ca.normSquared(Ca.sub(this.corners[3].normal,this.corners[0].normal))>a.normTol,this.splitVert||this.splitHoriz)return!0;var c=this.center();return Ca.normSquared(Ca.sub(c.normal,this.corners[0].normal))>a.normTol||Ca.normSquared(Ca.sub(c.normal,this.corners[1].normal))>a.normTol||Ca.normSquared(Ca.sub(c.normal,this.corners[2].normal))>a.normTol||Ca.normSquared(Ca.sub(c.normal,this.corners[3].normal))>a.normTol},divide:function(a){null==a&&(a=new Na),null==a.normTol&&(a.normTol=.085),null==a.minDepth&&(a.minDepth=0),null==a.maxDepth&&(a.maxDepth=10),this._divide(a,0,!0)},_divide:function(a,b,c){if(this.evalCorners(),this.shouldDivide(a,b)){if(b++,this.splitVert&&!this.splitHoriz?c=!1:!this.splitVert&&this.splitHoriz&&(c=!0),this.horizontal=c,this.horizontal){var d=[this.corners[0],this.corners[1],this.midpoint(1),this.midpoint(3)],e=[this.midpoint(3),this.midpoint(1),this.corners[2],this.corners[3]];this.children=[new Oa(this.srf,d),new Oa(this.srf,e)],this.children[0].neighbors=[this.neighbors[0],this.neighbors[1],this.children[1],this.neighbors[3]],this.children[1].neighbors=[this.children[0],this.neighbors[1],this.neighbors[2],this.neighbors[3]]}else{var f=[this.corners[0],this.midpoint(0),this.midpoint(2),this.corners[3]],g=[this.midpoint(0),this.corners[1],this.corners[2],this.midpoint(2)];this.children=[new Oa(this.srf,f),new Oa(this.srf,g)],this.children[0].neighbors=[this.neighbors[0],this.children[1],this.neighbors[2],this.neighbors[3]],this.children[1].neighbors=[this.neighbors[0],this.neighbors[1],this.neighbors[2],this.children[0]]}for(var h=0,i=this.children;h<i.length;){var j=i[h];++h,j._divide(a,b,!c)}}},triangulate:function(a){if(null==a&&(a=Y.empty()),this.isLeaf())return this.triangulateLeaf(a);for(var b=0,c=this.children;b<c.length;){var d=c[b];if(++b,null==d)break;d.triangulate(a)}return a},triangulateLeaf:function(a){for(var b=a.points.length,c=[],d=[],e=0,f=0;f<4;){var g=f++,h=this.getAllCorners(g);2==h.length&&(e=g+1);for(var i=0,j=h.length;i<j;){var k=i++;c.push(h[k])}}for(var l=0;l<c.length;){var m=c[l];++l,m.id==-1?(a.uvs.push(m.uv),a.points.push(m.point),a.normals.push(m.normal),m.id=b,d.push(b),b++):d.push(m.id)}if(4==c.length)return a.faces.push([d[0],d[3],d[1]]),a.faces.push([d[3],d[2],d[1]]),a;if(5==c.length){var n=d.length;return a.faces.push([d[e],d[(e+2)%n],d[(e+1)%n]]),a.faces.push([d[(e+4)%n],d[(e+3)%n],d[e]]),a.faces.push([d[e],d[(e+3)%n],d[(e+2)%n]]),a}var o=this.center();a.uvs.push(o.uv),a.points.push(o.point),a.normals.push(o.normal);for(var p=a.points.length-1,q=0,r=c.length-1;q<c.length;)a.faces.push([p,d[q],d[r]]),r=q++;return a},__class__:Oa};var Pa=b.exe.Dispatcher=function(){};g["verb.exe.Dispatcher"]=Pa,Pa.__name__=["verb","exe","Dispatcher"],Pa.init=function(){Pa._init||(Pa._workerPool=new Qa(Pa.THREADS),Pa._init=!0)},Pa.dispatchMethod=function(a,b,c){Pa.init();var d=new I,e=function(a){d.resolve(a)};return Pa._workerPool.addWork(q.getClassName(a),b,c,e),new J(d)};var Qa=b.exe.WorkerPool=function(a,b){null==b&&(b="verb.js"),null==a&&(a=1),this._callbacks=new v,this._working=new v,this._pool=[],this._queue=[];for(var c=0;c<a;){var d;c++;try{d=new Worker(Qa.basePath+b)}catch(e){e instanceof C&&(e=e.val),d=new Worker(Qa.basePath+b.substring(0,-3)+".min.js")}this._pool.push(d)}};g["verb.exe.WorkerPool"]=Qa,Qa.__name__=["verb","exe","WorkerPool"],Qa.prototype={addWork:function(a,b,c,d){var e=new Ra(a,b,c);this._callbacks.set(e.id,d),this._queue.push(e),this.processQueue()},processQueue:function(){for(var b=this;this._queue.length>0&&this._pool.length>0;){var c=this._queue.shift(),d=[c.id],e=[this._pool.shift()];this._working.h[d[0]]=e[0],e[0].onmessage=function(c,d){return function(e){b._working.remove(d[0]),b._pool.push(c[0]);try{b._callbacks.h.hasOwnProperty(d[0])&&(b._callbacks.h[d[0]](e.data.result),b._callbacks.remove(d[0]))}catch(f){f instanceof C&&(f=f.val),a.log(f)}b.processQueue()}}(e,d),e[0].postMessage(c)}},__class__:Qa};var Ra=function(a,b,c){this.className=a,this.methodName=b,this.args=c,this.id=Ra.uuid++};g["verb.exe._WorkerPool.Work"]=Ra,Ra.__name__=["verb","exe","_WorkerPool","Work"],Ra.prototype={__class__:Ra};var Sa=function(){};g["verb.geom.ICurve"]=Sa,Sa.__name__=["verb","geom","ICurve"],Sa.__interfaces__=[za],Sa.prototype={__class__:Sa};var Ta=b.geom.NurbsCurve=function(a){this._data=Fa.isValidNurbsCurveData(a)};g["verb.geom.NurbsCurve"]=Ta,Ta.__name__=["verb","geom","NurbsCurve"],Ta.__interfaces__=[Sa],Ta.byKnotsControlPointsWeights=function(a,b,c,d){return new Ta(new W(a,b.slice(),Ia.homogenize1d(c,d)))},Ta.byPoints=function(a,b){return null==b&&(b=3),new Ta(Ka.rationalInterpCurve(a,b))},Ta.__super__=T,Ta.prototype=d(T.prototype,{degree:function(){return this._data.degree},knots:function(){return this._data.knots.slice(0)},controlPoints:function(){return Ia.dehomogenize1d(this._data.controlPoints)},weights:function(){return Ia.weight1d(this._data.controlPoints)},asNurbs:function(){return new W(this.degree(),this.knots(),Ia.homogenize1d(this.controlPoints(),this.weights()))},clone:function(){return new Ta(this._data)},domain:function(){return new aa(P.first(this._data.knots),P.last(this._data.knots))},transform:function(a){return new Ta(La.rationalCurveTransform(this._data,a))},transformAsync:function(a){return Pa.dispatchMethod(La,"rationalCurveTransform",[this._data,a]).then(function(a){return new Ta(a)})},point:function(a){return Ia.rationalCurvePoint(this._data,a)},pointAsync:function(a){return Pa.dispatchMethod(Ia,"rationalCurvePoint",[this._data,a])},tangent:function(a){return Ia.rationalCurveTangent(this._data,a)},tangentAsync:function(a){return Pa.dispatchMethod(Ia,"rationalCurveTangent",[this._data,a])},derivatives:function(a,b){return null==b&&(b=1),Ia.rationalCurveDerivatives(this._data,a,b)},derivativesAsync:function(a,b){return null==b&&(b=1),Pa.dispatchMethod(Ia,"rationalCurveDerivatives",[this._data,a,b])},closestPoint:function(a){return Da.rationalCurveClosestPoint(this._data,a)},closestPointAsync:function(a){return Pa.dispatchMethod(Da,"rationalCurveClosestPoint",[this._data,a])},closestParam:function(a){return Da.rationalCurveClosestParam(this._data,a)},closestParamAsync:function(a){return Pa.dispatchMethod(Da,"rationalCurveClosestParam",[this._data,a])},length:function(){return Da.rationalCurveArcLength(this._data)},lengthAsync:function(){return Pa.dispatchMethod(Da,"rationalCurveArcLength",[this._data])},lengthAtParam:function(a){return Da.rationalCurveArcLength(this._data,a)},lengthAtParamAsync:function(){return Pa.dispatchMethod(Da,"rationalCurveArcLength",[this._data])},paramAtLength:function(a,b){return Da.rationalCurveParamAtArcLength(this._data,a,b)},paramAtLengthAsync:function(a,b){return Pa.dispatchMethod(Da,"rationalCurveParamAtArcLength",[this._data,a,b])},divideByEqualArcLength:function(a){return Ga.rationalCurveByEqualArcLength(this._data,a)},divideByEqualArcLengthAsync:function(a){return Pa.dispatchMethod(Ga,"rationalCurveByEqualArcLength",[this._data,a])},divideByArcLength:function(a){return Ga.rationalCurveByArcLength(this._data,a)},divideByArcLengthAsync:function(a){return Pa.dispatchMethod(Ga,"rationalCurveByArcLength",[this._data,a])},split:function(a){return Ga.curveSplit(this._data,a).map(function(a){return new Ta(a)})},splitAsync:function(a){return Pa.dispatchMethod(Ga,"curveSplit",[this._data,a]).then(function(a){return a.map(function(a){return new Ta(a)})})},reverse:function(){return new Ta(La.curveReverse(this._data))},reverseAsync:function(){return Pa.dispatchMethod(La,"curveReverse",[this._data]).then(function(a){return new Ta(a)})},tessellate:function(a){return Ma.rationalCurveAdaptiveSample(this._data,a,!1)},tessellateAsync:function(a){return Pa.dispatchMethod(Ma,"rationalCurveAdaptiveSample",[this._data,a,!1])},__class__:Ta});var Ua=b.geom.Arc=function(a,b,c,d,e,f){Ta.call(this,Ka.arc(a,b,c,d,e,f)),this._center=a,this._xaxis=b,this._yaxis=c,this._radius=d,this._minAngle=e,this._maxAngle=f};g["verb.geom.Arc"]=Ua,Ua.__name__=["verb","geom","Arc"],Ua.__super__=Ta,Ua.prototype=d(Ta.prototype,{center:function(){return this._center},xaxis:function(){return this._xaxis},yaxis:function(){return this._yaxis},radius:function(){return this._radius},minAngle:function(){return this._minAngle},maxAngle:function(){return this._maxAngle},__class__:Ua});var Va=b.geom.BezierCurve=function(a,b){Ta.call(this,Ka.rationalBezierCurve(a,b))};g["verb.geom.BezierCurve"]=Va,Va.__name__=["verb","geom","BezierCurve"],Va.__super__=Ta,Va.prototype=d(Ta.prototype,{__class__:Va});var Wa=b.geom.Circle=function(a,b,c,d){Ua.call(this,a,b,c,d,0,2*Math.PI)};g["verb.geom.Circle"]=Wa,Wa.__name__=["verb","geom","Circle"],Wa.__super__=Ua,Wa.prototype=d(Ua.prototype,{__class__:Wa});var Xa=function(){};g["verb.geom.ISurface"]=Xa,Xa.__name__=["verb","geom","ISurface"],Xa.__interfaces__=[za],Xa.prototype={__class__:Xa};var Ya=b.geom.NurbsSurface=function(a){this._data=Fa.isValidNurbsSurfaceData(a)};g["verb.geom.NurbsSurface"]=Ya,Ya.__name__=["verb","geom","NurbsSurface"],Ya.__interfaces__=[Xa],Ya.byKnotsControlPointsWeights=function(a,b,c,d,e,f){return new Ya(new X(a,b,c,d,Ia.homogenize2d(e,f)))},Ya.byCorners=function(a,b,c,d){return new Ya(Ka.fourPointSurface(a,b,c,d))},Ya.byLoftingCurves=function(a,b){return new Ya(Ka.loftedSurface(function(b){for(var c,d=[],e=0;e<a.length;){var f=a[e];++e,d.push(f.asNurbs())}return c=d}(this),b))},Ya.__super__=T,Ya.prototype=d(T.prototype,{degreeU:function(){return this._data.degreeU},degreeV:function(){return this._data.degreeV},knotsU:function(){return this._data.knotsU.slice(0)},knotsV:function(){return this._data.knotsV.slice(0)},controlPoints:function(){return Ia.dehomogenize2d(this._data.controlPoints)},weights:function(){return Ia.weight2d(this._data.controlPoints)},asNurbs:function(){return new X(this.degreeU(),this.degreeV(),this.knotsU(),this.knotsV(),Ia.homogenize2d(this.controlPoints(),this.weights()))},clone:function(){return new Ya(this.asNurbs())},domainU:function(){return new aa(P.first(this._data.knotsU),P.last(this._data.knotsU))},domainV:function(){return new aa(P.first(this._data.knotsV),P.last(this._data.knotsV))},point:function(a,b){return Ia.rationalSurfacePoint(this._data,a,b)},pointAsync:function(a,b){return Pa.dispatchMethod(Ia,"rationalSurfacePoint",[this._data,a,b])},normal:function(a,b){return Ia.rationalSurfaceNormal(this._data,a,b)},normalAsync:function(a,b){return Pa.dispatchMethod(Ia,"rationalSurfaceNormal",[this._data,a,b])},derivatives:function(a,b,c){return null==c&&(c=1),Ia.rationalSurfaceDerivatives(this._data,a,b,c)},derivativesAsync:function(a,b,c){return null==c&&(c=1),Pa.dispatchMethod(Ia,"rationalSurfaceDerivatives",[this._data,a,b,c])},closestParam:function(a){return Da.rationalSurfaceClosestParam(this._data,a)},closestParamAsync:function(a){return Pa.dispatchMethod(Da,"rationalSurfaceClosestParam",[this._data,a])},closestPoint:function(a){return Da.rationalSurfaceClosestPoint(this._data,a)},closestPointAsync:function(a){return Pa.dispatchMethod(Da,"rationalSurfaceClosestPoint",[this._data,a])},split:function(a,b){return null==b&&(b=!1),Ga.surfaceSplit(this._data,a,b).map(function(a){return new Ya(a)})},splitAsync:function(a,b){return null==b&&(b=!1),Pa.dispatchMethod(Ga,"surfaceSplit",[this._data,a,b]).then(function(a){return a.map(function(a){return new Ya(a)})})},reverse:function(a){return null==a&&(a=!1),new Ya(La.surfaceReverse(this._data,a))},reverseAsync:function(a){return null==a&&(a=!1),Pa.dispatchMethod(La,"surfaceReverse",[this._data,a]).then(function(a){return new Ya(a)})},isocurve:function(a,b){return null==b&&(b=!1),new Ta(Ka.surfaceIsocurve(this._data,a,b))},isocurveAsync:function(a,b){return null==b&&(b=!1),Pa.dispatchMethod(Ka,"surfaceIsocurve",[this._data,a,b]).then(function(a){return new Ta(a)})},boundaries:function(a){return Ka.surfaceBoundaryCurves(this._data).map(function(a){return new Ta(a)})},boundariesAsync:function(a){return Pa.dispatchMethod(Ka,"surfaceBoundaryCurves",[this._data]).then(function(a){return a.map(function(a){return new Ta(a)})})},tessellate:function(a){return Ma.rationalSurfaceAdaptive(this._data,a)},tessellateAsync:function(a){return Pa.dispatchMethod(Ma,"rationalSurfaceAdaptive",[this._data,a])},transform:function(a){return new Ya(La.rationalSurfaceTransform(this._data,a))},transformAsync:function(a){return Pa.dispatchMethod(La,"rationalSurfaceTransform",[this._data,a]).then(function(a){return new Ya(a)})},__class__:Ya});var Za=b.geom.ConicalSurface=function(a,b,c,d,e){Ya.call(this,Ka.conicalSurface(a,b,c,d,e)),this._axis=a,this._xaxis=b,this._base=c,this._height=d,this._radius=e};g["verb.geom.ConicalSurface"]=Za,Za.__name__=["verb","geom","ConicalSurface"],Za.__super__=Ya,Za.prototype=d(Ya.prototype,{axis:function(){return this._axis},xaxis:function(){return this._xaxis},base:function(){return this._base},height:function(){return this._height},radius:function(){return this._radius},__class__:Za});var $a=b.geom.CylindricalSurface=function(a,b,c,d,e){Ya.call(this,Ka.cylindricalSurface(a,b,c,d,e)),this._axis=a,this._xaxis=b,this._base=c,this._height=d,this._radius=e};g["verb.geom.CylindricalSurface"]=$a,$a.__name__=["verb","geom","CylindricalSurface"],$a.__super__=Ya,$a.prototype=d(Ya.prototype,{axis:function(){return this._axis},xaxis:function(){return this._xaxis},base:function(){return this._base},height:function(){return this._height},radius:function(){return this._radius},__class__:$a});var _a=b.geom.EllipseArc=function(a,b,c,d,e){Ta.call(this,Ka.ellipseArc(a,b,c,d,e)),this._center=a,this._xaxis=b,this._yaxis=c,this._minAngle=d,this._maxAngle=e};g["verb.geom.EllipseArc"]=_a,_a.__name__=["verb","geom","EllipseArc"],_a.__super__=Ta,_a.prototype=d(Ta.prototype,{center:function(){return this._center},xaxis:function(){return this._xaxis},yaxis:function(){return this._yaxis},minAngle:function(){return this._minAngle},maxAngle:function(){return this._maxAngle},__class__:_a});var ab=b.geom.Ellipse=function(a,b,c){_a.call(this,a,b,c,0,2*Math.PI)};g["verb.geom.Ellipse"]=ab,ab.__name__=["verb","geom","Ellipse"],ab.__super__=_a,ab.prototype=d(_a.prototype,{__class__:ab});var bb=b.geom.ExtrudedSurface=function(a,b){Ya.call(this,Ka.extrudedSurface(Ca.normalized(b),Ca.norm(b),a.asNurbs())),this._profile=a,this._direction=b};g["verb.geom.ExtrudedSurface"]=bb,bb.__name__=["verb","geom","ExtrudedSurface"],bb.__super__=Ya,bb.prototype=d(Ya.prototype,{profile:function(){return this._profile},direction:function(){return this._direction},__class__:bb});var cb=b.geom.Intersect=function(){};g["verb.geom.Intersect"]=cb,cb.__name__=["verb","geom","Intersect"],cb.curves=function(a,b,c){return null==c&&(c=.001),Ja.curves(a.asNurbs(),b.asNurbs(),c)},cb.curvesAsync=function(a,b,c){return null==c&&(c=.001),Pa.dispatchMethod(Ja,"curves",[a.asNurbs(),b.asNurbs(),c])},cb.curveAndSurface=function(a,b,c){return null==c&&(c=.001),Ja.curveAndSurface(a.asNurbs(),b.asNurbs(),c)},cb.curveAndSurfaceAsync=function(a,b,c){return null==c&&(c=.001),Pa.dispatchMethod(Ja,"curveAndSurface",[a.asNurbs(),b.asNurbs(),c])},cb.surfaces=function(a,b,c){return null==c&&(c=.001),Ja.surfaces(a.asNurbs(),b.asNurbs(),c).map(function(a){return new Ta(a)})},cb.surfacesAsync=function(a,b,c){return null==c&&(c=.001),Pa.dispatchMethod(Ja,"surfaces",[a.asNurbs(),b.asNurbs(),c]).then(function(a){return a.map(function(a){return new Ta(a)})})};var db=b.geom.Line=function(a,b){Ta.call(this,Ka.polyline([a,b])),this._start=a,this._end=b};g["verb.geom.Line"]=db,db.__name__=["verb","geom","Line"],db.__super__=Ta,db.prototype=d(Ta.prototype,{start:function(){return this._start},end:function(){return this._end},__class__:db});var eb=b.geom.RevolvedSurface=function(a,b,c,d){Ya.call(this,Ka.revolvedSurface(a.asNurbs(),b,c,d)),this._profile=a,this._center=b,this._axis=c,this._angle=d};g["verb.geom.RevolvedSurface"]=eb,eb.__name__=["verb","geom","RevolvedSurface"],eb.__super__=Ya,eb.prototype=d(Ya.prototype,{profile:function(){return this._profile},center:function(){return this._center},axis:function(){return this._center},angle:function(){return this._angle},__class__:eb});var fb=b.geom.SphericalSurface=function(a,b){Ya.call(this,Ka.sphericalSurface(a,[0,0,1],[1,0,0],b)),this._center=a,this._radius=b};g["verb.geom.SphericalSurface"]=fb,fb.__name__=["verb","geom","SphericalSurface"],fb.__super__=Ya,fb.prototype=d(Ya.prototype,{center:function(){return this._center},radius:function(){return this._radius},__class__:fb});var gb=b.geom.SweptSurface=function(a,b){Ya.call(this,Ka.rationalTranslationalSurface(a.asNurbs(),b.asNurbs())),this._profile=a,this._rail=b};g["verb.geom.SweptSurface"]=gb,gb.__name__=["verb","geom","SweptSurface"],gb.__super__=Ya,gb.prototype=d(Ya.prototype,{profile:function(){return this._profile},rail:function(){return this._rail},__class__:gb});var hb,ib=0;g.Math=Math,String.prototype.__class__=g.String=String,String.__name__=["String"],g.Array=Array,Array.__name__=["Array"],Date.prototype.__class__=g.Date=Date,Date.__name__=["Date"];var jb=g.Int={__name__:["Int"]},kb=g.Dynamic={__name__:["Dynamic"]},lb=g.Float=Number;lb.__name__=["Float"];var mb=g.Bool=Boolean;mb.__ename__=["Bool"];var nb=g.Class={__name__:["Class"]},ob={};null==Array.prototype.map&&(Array.prototype.map=function(a){for(var b=[],c=0,d=this.length;c<d;){var e=c++;b[e]=a(this[e])}return b}),null==Array.prototype.filter&&(Array.prototype.filter=function(a){for(var b=[],c=0,d=this.length;c<d;){var e=c++,f=this[e];a(f)&&b.push(f)}return b});var pb={},qb=c.ArrayBuffer||E;null==qb.prototype.slice&&(qb.prototype.slice=E.sliceImpl);var rb=(c.DataView||F,c.Uint8Array||G._new);!function(a,b){function c(a){return o[n]=d.apply(b,a),n++}function d(a){var c=[].slice.call(arguments,1);return function(){"function"==typeof a?a.apply(b,c):new Function(""+a)()}}function e(a){if(p)setTimeout(d(e,a),0);else{var b=o[a];if(b){p=!0;try{b()}finally{f(a),p=!1}}}}function f(a){delete o[a]}function g(){m=function(){var a=c(arguments);return process.nextTick(d(e,a)),a}}function h(){if(a.postMessage&&!a.importScripts){var b=!0,c=a.onmessage;return a.onmessage=function(){b=!1},a.postMessage("","*"),a.onmessage=c,b}}function i(){var b="setImmediate$"+Math.random()+"$",d=function(c){c.source===a&&"string"==typeof c.data&&0===c.data.indexOf(b)&&e(+c.data.slice(b.length))};a.addEventListener?a.addEventListener("message",d,!1):a.attachEvent("onmessage",d),m=function(){var d=c(arguments);return a.postMessage(b+d,"*"),d}}function j(){var a=new MessageChannel;a.port1.onmessage=function(a){var b=a.data;e(b)},m=function(){var b=c(arguments);return a.port2.postMessage(b),b}}function k(){var a=q.documentElement;m=function(){var b=c(arguments),d=q.createElement("script");return d.onreadystatechange=function(){e(b),d.onreadystatechange=null,a.removeChild(d),d=null},a.appendChild(d),b}}function l(){m=function(){var a=c(arguments);return setTimeout(d(e,a),0),a}}if(!a.setImmediate){var m,n=1,o={},p=!1,q=a.document,r=Object.getPrototypeOf&&Object.getPrototypeOf(a);r=r&&r.setTimeout?r:a,"[object process]"==={}.toString.call(a.process)?g():h()?i():a.MessageChannel?j():q&&"onreadystatechange"in q.createElement("script")?k():l(),r.setImmediate=m,r.clearImmediate=f}}(new Function("return this")()),t.USE_CACHE=!1,t.USE_ENUM_INDEX=!1,t.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",u.DEFAULT_RESOLVER=q,u.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",w.count=0,B.i64tmp=function(a){var b,c=new s(0,0);return b=c}(this),D.__toStr={}.toString,G.BYTES_PER_ELEMENT=1,M.queue=new k,Q.memo=new v,S.TOLERANCE=1e-6,S.EPSILON=1e-10,S.VERSION="2.0.0",Da.Tvalues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],
Da.Cvalues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],Pa.THREADS=1,Pa._init=!1,Qa.basePath="",Ra.uuid=0,O.main()}("undefined"!=typeof console?console:{log:function(){}},a,"undefined"!=typeof e?e:"undefined"!=typeof b?b:"undefined"!=typeof self?self:this),a});
/* axios v0.18.0 | (c) 2018 by Matt Zabriskie */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.axios=t():e.axios=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";function r(e){var t=new s(e),n=i(s.prototype.request,t);return o.extend(n,s.prototype,t),o.extend(n,t),n}var o=n(2),i=n(3),s=n(5),u=n(6),a=r(u);a.Axios=s,a.create=function(e){return r(o.merge(u,e))},a.Cancel=n(23),a.CancelToken=n(24),a.isCancel=n(20),a.all=function(e){return Promise.all(e)},a.spread=n(25),e.exports=a,e.exports.default=a},function(e,t,n){"use strict";function r(e){return"[object Array]"===R.call(e)}function o(e){return"[object ArrayBuffer]"===R.call(e)}function i(e){return"undefined"!=typeof FormData&&e instanceof FormData}function s(e){var t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer}function u(e){return"string"==typeof e}function a(e){return"number"==typeof e}function c(e){return"undefined"==typeof e}function f(e){return null!==e&&"object"==typeof e}function p(e){return"[object Date]"===R.call(e)}function d(e){return"[object File]"===R.call(e)}function l(e){return"[object Blob]"===R.call(e)}function h(e){return"[object Function]"===R.call(e)}function m(e){return f(e)&&h(e.pipe)}function y(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}function w(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}function g(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)}function v(e,t){if(null!==e&&"undefined"!=typeof e)if("object"!=typeof e&&(e=[e]),r(e))for(var n=0,o=e.length;n<o;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}function x(){function e(e,n){"object"==typeof t[n]&&"object"==typeof e?t[n]=x(t[n],e):t[n]=e}for(var t={},n=0,r=arguments.length;n<r;n++)v(arguments[n],e);return t}function b(e,t,n){return v(t,function(t,r){n&&"function"==typeof t?e[r]=E(t,n):e[r]=t}),e}var E=n(3),C=n(4),R=Object.prototype.toString;e.exports={isArray:r,isArrayBuffer:o,isBuffer:C,isFormData:i,isArrayBufferView:s,isString:u,isNumber:a,isObject:f,isUndefined:c,isDate:p,isFile:d,isBlob:l,isFunction:h,isStream:m,isURLSearchParams:y,isStandardBrowserEnv:g,forEach:v,merge:x,extend:b,trim:w}},function(e,t){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function r(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}/*!
	 * Determine if an object is a Buffer
	 *
	 * @author   Feross Aboukhadijeh <https://feross.org>
	 * @license  MIT
	 */
e.exports=function(e){return null!=e&&(n(e)||r(e)||!!e._isBuffer)}},function(e,t,n){"use strict";function r(e){this.defaults=e,this.interceptors={request:new s,response:new s}}var o=n(6),i=n(2),s=n(17),u=n(18);r.prototype.request=function(e){"string"==typeof e&&(e=i.merge({url:arguments[0]},arguments[1])),e=i.merge(o,{method:"get"},this.defaults,e),e.method=e.method.toLowerCase();var t=[u,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)n=n.then(t.shift(),t.shift());return n},i.forEach(["delete","get","head","options"],function(e){r.prototype[e]=function(t,n){return this.request(i.merge(n||{},{method:e,url:t}))}}),i.forEach(["post","put","patch"],function(e){r.prototype[e]=function(t,n,r){return this.request(i.merge(r||{},{method:e,url:t,data:n}))}}),e.exports=r},function(e,t,n){"use strict";function r(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function o(){var e;return"undefined"!=typeof XMLHttpRequest?e=n(8):"undefined"!=typeof process&&(e=n(8)),e}var i=n(2),s=n(7),u={"Content-Type":"application/x-www-form-urlencoded"},a={adapter:o(),transformRequest:[function(e,t){return s(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(r(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)?(r(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};a.headers={common:{Accept:"application/json, text/plain, */*"}},i.forEach(["delete","get","head"],function(e){a.headers[e]={}}),i.forEach(["post","put","patch"],function(e){a.headers[e]=i.merge(u)}),e.exports=a},function(e,t,n){"use strict";var r=n(2);e.exports=function(e,t){r.forEach(e,function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])})}},function(e,t,n){"use strict";var r=n(2),o=n(9),i=n(12),s=n(13),u=n(14),a=n(10),c="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||n(15);e.exports=function(e){return new Promise(function(t,f){var p=e.data,d=e.headers;r.isFormData(p)&&delete d["Content-Type"];var l=new XMLHttpRequest,h="onreadystatechange",m=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in l||u(e.url)||(l=new window.XDomainRequest,h="onload",m=!0,l.onprogress=function(){},l.ontimeout=function(){}),e.auth){var y=e.auth.username||"",w=e.auth.password||"";d.Authorization="Basic "+c(y+":"+w)}if(l.open(e.method.toUpperCase(),i(e.url,e.params,e.paramsSerializer),!0),l.timeout=e.timeout,l[h]=function(){if(l&&(4===l.readyState||m)&&(0!==l.status||l.responseURL&&0===l.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in l?s(l.getAllResponseHeaders()):null,r=e.responseType&&"text"!==e.responseType?l.response:l.responseText,i={data:r,status:1223===l.status?204:l.status,statusText:1223===l.status?"No Content":l.statusText,headers:n,config:e,request:l};o(t,f,i),l=null}},l.onerror=function(){f(a("Network Error",e,null,l)),l=null},l.ontimeout=function(){f(a("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",l)),l=null},r.isStandardBrowserEnv()){var g=n(16),v=(e.withCredentials||u(e.url))&&e.xsrfCookieName?g.read(e.xsrfCookieName):void 0;v&&(d[e.xsrfHeaderName]=v)}if("setRequestHeader"in l&&r.forEach(d,function(e,t){"undefined"==typeof p&&"content-type"===t.toLowerCase()?delete d[t]:l.setRequestHeader(t,e)}),e.withCredentials&&(l.withCredentials=!0),e.responseType)try{l.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&l.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&l.upload&&l.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){l&&(l.abort(),f(e),l=null)}),void 0===p&&(p=null),l.send(p)})}},function(e,t,n){"use strict";var r=n(10);e.exports=function(e,t,n){var o=n.config.validateStatus;n.status&&o&&!o(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";var r=n(11);e.exports=function(e,t,n,o,i){var s=new Error(e);return r(s,t,n,o,i)}},function(e,t){"use strict";e.exports=function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e}},function(e,t,n){"use strict";function r(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var o=n(2);e.exports=function(e,t,n){if(!t)return e;var i;if(n)i=n(t);else if(o.isURLSearchParams(t))i=t.toString();else{var s=[];o.forEach(t,function(e,t){null!==e&&"undefined"!=typeof e&&(o.isArray(e)?t+="[]":e=[e],o.forEach(e,function(e){o.isDate(e)?e=e.toISOString():o.isObject(e)&&(e=JSON.stringify(e)),s.push(r(t)+"="+r(e))}))}),i=s.join("&")}return i&&(e+=(e.indexOf("?")===-1?"?":"&")+i),e}},function(e,t,n){"use strict";var r=n(2),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,i,s={};return e?(r.forEach(e.split("\n"),function(e){if(i=e.indexOf(":"),t=r.trim(e.substr(0,i)).toLowerCase(),n=r.trim(e.substr(i+1)),t){if(s[t]&&o.indexOf(t)>=0)return;"set-cookie"===t?s[t]=(s[t]?s[t]:[]).concat([n]):s[t]=s[t]?s[t]+", "+n:n}}),s):s}},function(e,t,n){"use strict";var r=n(2);e.exports=r.isStandardBrowserEnv()?function(){function e(e){var t=e;return n&&(o.setAttribute("href",t),t=o.href),o.setAttribute("href",t),{href:o.href,protocol:o.protocol?o.protocol.replace(/:$/,""):"",host:o.host,search:o.search?o.search.replace(/^\?/,""):"",hash:o.hash?o.hash.replace(/^#/,""):"",hostname:o.hostname,port:o.port,pathname:"/"===o.pathname.charAt(0)?o.pathname:"/"+o.pathname}}var t,n=/(msie|trident)/i.test(navigator.userAgent),o=document.createElement("a");return t=e(window.location.href),function(n){var o=r.isString(n)?e(n):n;return o.protocol===t.protocol&&o.host===t.host}}():function(){return function(){return!0}}()},function(e,t){"use strict";function n(){this.message="String contains an invalid character"}function r(e){for(var t,r,i=String(e),s="",u=0,a=o;i.charAt(0|u)||(a="=",u%1);s+=a.charAt(63&t>>8-u%1*8)){if(r=i.charCodeAt(u+=.75),r>255)throw new n;t=t<<8|r}return s}var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.prototype=new Error,n.prototype.code=5,n.prototype.name="InvalidCharacterError",e.exports=r},function(e,t,n){"use strict";var r=n(2);e.exports=r.isStandardBrowserEnv()?function(){return{write:function(e,t,n,o,i,s){var u=[];u.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&u.push("expires="+new Date(n).toGMTString()),r.isString(o)&&u.push("path="+o),r.isString(i)&&u.push("domain="+i),s===!0&&u.push("secure"),document.cookie=u.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},function(e,t,n){"use strict";function r(){this.handlers=[]}var o=n(2);r.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},r.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},r.prototype.forEach=function(e){o.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=r},function(e,t,n){"use strict";function r(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var o=n(2),i=n(19),s=n(20),u=n(6),a=n(21),c=n(22);e.exports=function(e){r(e),e.baseURL&&!a(e.url)&&(e.url=c(e.baseURL,e.url)),e.headers=e.headers||{},e.data=i(e.data,e.headers,e.transformRequest),e.headers=o.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),o.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]});var t=e.adapter||u.adapter;return t(e).then(function(t){return r(e),t.data=i(t.data,t.headers,e.transformResponse),t},function(t){return s(t)||(r(e),t&&t.response&&(t.response.data=i(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,n){"use strict";var r=n(2);e.exports=function(e,t,n){return r.forEach(n,function(n){e=n(e,t)}),e}},function(e,t){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t){"use strict";function n(e){this.message=e}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,e.exports=n},function(e,t,n){"use strict";function r(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var n=this;e(function(e){n.reason||(n.reason=new o(e),t(n.reason))})}var o=n(23);r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var e,t=new r(function(t){e=t});return{token:t,cancel:e}},e.exports=r},function(e,t){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}}])});

'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var b=function(){};b.prototype=a;return new b};
$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(c){}return!1};$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;
$jscomp.inherits=function(a,b){a.prototype=$jscomp.objectCreate(b.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var c=$jscomp.setPrototypeOf;c(a,b)}else for(c in b)if("prototype"!=c)if(Object.defineProperties){var g=Object.getOwnPropertyDescriptor(b,c);g&&Object.defineProperty(a,c,g)}else a[c]=b[c];a.superClass_=b.prototype};$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};
$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};
$jscomp.polyfill=function(a,b,c,g){if(b){c=$jscomp.global;a=a.split(".");for(g=0;g<a.length-1;g++){var d=a[g];d in c||(c[d]={});c=c[d]}a=a[a.length-1];g=c[a];b=b(g);b!=g&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("String.prototype.repeat",function(a){return a?a:function(a){var b=$jscomp.checkStringArgs(this,null,"repeat");if(0>a||1342177279<a)throw new RangeError("Invalid count value");a|=0;for(var g="";a;)if(a&1&&(g+=b),a>>>=1)b+=b;return g}},"es6","es3");$jscomp.stringPadding=function(a,b){a=void 0!==a?String(a):" ";return 0<b&&a?a.repeat(Math.ceil(b/a.length)).substring(0,b):""};
$jscomp.polyfill("String.prototype.padStart",function(a){return a?a:function(a,c){var b=$jscomp.checkStringArgs(this,null,"padStart");return $jscomp.stringPadding(c,a-b.length)+b}},"es8","es3");$jscomp.polyfill("String.prototype.padEnd",function(a){return a?a:function(a,c){var b=$jscomp.checkStringArgs(this,null,"padStart");return b+$jscomp.stringPadding(c,a-b.length)}},"es8","es3");
$jscomp.polyfill("Math.clz32",function(a){return a?a:function(a){a=Number(a)>>>0;if(0===a)return 32;var b=0;0===(a&4294901760)&&(a<<=16,b+=16);0===(a&4278190080)&&(a<<=8,b+=8);0===(a&4026531840)&&(a<<=4,b+=4);0===(a&3221225472)&&(a<<=2,b+=2);0===(a&2147483648)&&b++;return b}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(a){return a?a:function(a,c){var b=$jscomp.checkStringArgs(this,a,"endsWith");a+="";void 0===c&&(c=b.length);c=Math.max(0,Math.min(c|0,b.length));for(var d=a.length;0<d&&0<c;)if(b[--c]!=a[--d])return!1;return 0>=d}},"es6","es3");$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var g=a.length,d=0;d<g;d++){var f=a[d];if(b.call(c,f,d,a))return{i:d,v:f}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.findIndex",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).i}},"es6","es3");$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,g={next:function(){if(c<a.length){var d=c++;return{value:b(d,a[d]),done:!1}}g.next=function(){return{done:!0,value:void 0}};return g.next()}};g[Symbol.iterator]=function(){return g};return g};
$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");$jscomp.polyfill("Number.isNaN",function(a){return a?a:function(a){return"number"===typeof a&&isNaN(a)}},"es6","es3");$jscomp.polyfill("Object.is",function(a){return a?a:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,c){var b=this;b instanceof String&&(b=String(b));var d=b.length;c=c||0;for(0>c&&(c=Math.max(c+d,0));c<d;c++){var f=b[c];if(f===a||Object.is(f,a))return!0}return!1}},"es7","es3");$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,c){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,c||0)}},"es6","es3");$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function c(a){return a instanceof d?a:new d(function(b,c){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};b.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var g=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){g(a,
0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(h){this.asyncThrow_(h)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var d=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(m){b.reject(m)}};d.prototype.createResolveAndReject_=
function(){function a(a){return function(f){c||(c=!0,a.call(b,f))}}var b=this,c=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};d.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof d)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};d.prototype.resolveToNonPromiseObj_=function(a){var b=
void 0;try{b=a.then}catch(m){this.reject_(m);return}"function"==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};d.prototype.reject_=function(a){this.settle_(2,a)};d.prototype.fulfill_=function(a){this.settle_(1,a)};d.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};d.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
0;a<this.onSettledCallbacks_.length;++a)f.asyncExecute(this.onSettledCallbacks_[a]);this.onSettledCallbacks_=null}};var f=new b;d.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};d.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(h){c.reject(h)}};d.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{f(a(b))}catch(l){e(l)}}:
b}var f,e,q=new d(function(a,b){f=a;e=b});this.callWhenSettled_(c(a,f),c(b,e));return q};d.prototype.catch=function(a){return this.then(void 0,a)};d.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(c)};d.resolve=c;d.reject=function(a){return new d(function(b,c){c(a)})};d.race=function(a){return new d(function(b,
f){for(var d=$jscomp.makeIterator(a),e=d.next();!e.done;e=d.next())c(e.value).callWhenSettled_(b,f)})};d.all=function(a){var b=$jscomp.makeIterator(a),f=b.next();return f.done?c([]):new d(function(a,d){function e(b){return function(c){r[b]=c;h--;0==h&&a(r)}}var r=[],h=0;do r.push(void 0),h++,c(f.value).callWhenSettled_(e(r.length-1),d),f=b.next();while(!f.done)})};return d},"es6","es3");
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(a,c){var b=$jscomp.checkStringArgs(this,a,"startsWith");a+="";var d=b.length,f=a.length;c=Math.max(0,Math.min(c|0,b.length));for(var p=0;p<f&&c<d;)if(b[c++]!=a[p++])return!1;return p>=f}},"es6","es3");$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};
$jscomp.assign="function"==typeof Object.assign?Object.assign:function(a,b){for(var c=1;c<arguments.length;c++){var g=arguments[c];if(g)for(var d in g)$jscomp.owns(g,d)&&(a[d]=g[d])}return a};$jscomp.polyfill("Object.assign",function(a){return a||$jscomp.assign},"es6","es3");$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");$jscomp.polyfill("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991},"es6","es3");
$jscomp.polyfill("Number.MIN_SAFE_INTEGER",function(){return-9007199254740991},"es6","es3");$jscomp.polyfill("Promise.prototype.finally",function(a){return a?a:function(a){return this.then(function(b){return Promise.resolve(a()).then(function(){return b})},function(b){return Promise.resolve(a()).then(function(){throw b;})})}},"es8","es3");$jscomp.polyfill("Math.sign",function(a){return a?a:function(a){a=Number(a);return 0===a||isNaN(a)?a:0<a?1:-1}},"es6","es3");
$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,c){return c})}},"es8","es3");var module$src$polyfills$CustomEvent={default:{}};
(function(){function a(a,c){c=c||{bubbles:!1,cancelable:!1,detail:void 0};var b=document.createEvent("CustomEvent");b.initCustomEvent(a,c.bubbles,c.cancelable,c.detail);return b}if("function"===typeof window.CustomEvent)return!1;window.Event&&"function"===typeof window.Event&&(a.prototype=window.Event.prototype);window.CustomEvent=a})();var module$node_modules$tinycolor2$tinycolor={default:function(a,b){a=a?a:"";b=b||{};if(a instanceof module$node_modules$tinycolor2$tinycolor.default)return a;if(!(this instanceof module$node_modules$tinycolor2$tinycolor.default))return new module$node_modules$tinycolor2$tinycolor.default(a,b);var c=inputToRGB$$module$node_modules$tinycolor2$tinycolor(a);this._originalInput=a;this._r=c.r;this._g=c.g;this._b=c.b;this._a=c.a;this._roundA=mathRound$$module$node_modules$tinycolor2$tinycolor(100*this._a)/
100;this._format=b.format||c.format;this._gradientType=b.gradientType;1>this._r&&(this._r=mathRound$$module$node_modules$tinycolor2$tinycolor(this._r));1>this._g&&(this._g=mathRound$$module$node_modules$tinycolor2$tinycolor(this._g));1>this._b&&(this._b=mathRound$$module$node_modules$tinycolor2$tinycolor(this._b));this._ok=c.ok;this._tc_id=tinyCounter$$module$node_modules$tinycolor2$tinycolor++}},Math$$module$node_modules$tinycolor2$tinycolor=Math,trimLeft$$module$node_modules$tinycolor2$tinycolor=
/^\s+/,trimRight$$module$node_modules$tinycolor2$tinycolor=/\s+$/,tinyCounter$$module$node_modules$tinycolor2$tinycolor=0,mathRound$$module$node_modules$tinycolor2$tinycolor=Math$$module$node_modules$tinycolor2$tinycolor.round,mathMin$$module$node_modules$tinycolor2$tinycolor=Math$$module$node_modules$tinycolor2$tinycolor.min,mathMax$$module$node_modules$tinycolor2$tinycolor=Math$$module$node_modules$tinycolor2$tinycolor.max,mathRandom$$module$node_modules$tinycolor2$tinycolor=Math$$module$node_modules$tinycolor2$tinycolor.random;
module$node_modules$tinycolor2$tinycolor.default.prototype={isDark:function(){return 128>this.getBrightness()},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var a=this.toRgb();return(299*a.r+587*a.g+114*a.b)/1E3},getLuminance:function(){var a=this.toRgb();var b=a.r/255;var c=a.g/255;a=a.b/255;b=.03928>=b?b/12.92:
Math$$module$node_modules$tinycolor2$tinycolor.pow((b+.055)/1.055,2.4);c=.03928>=c?c/12.92:Math$$module$node_modules$tinycolor2$tinycolor.pow((c+.055)/1.055,2.4);a=.03928>=a?a/12.92:Math$$module$node_modules$tinycolor2$tinycolor.pow((a+.055)/1.055,2.4);return.2126*b+.7152*c+.0722*a},setAlpha:function(a){this._a=boundAlpha$$module$node_modules$tinycolor2$tinycolor(a);this._roundA=mathRound$$module$node_modules$tinycolor2$tinycolor(100*this._a)/100;return this},toHsv:function(){var a=rgbToHsv$$module$node_modules$tinycolor2$tinycolor(this._r,
this._g,this._b);return{h:360*a.h,s:a.s,v:a.v,a:this._a}},toHsvString:function(){var a=rgbToHsv$$module$node_modules$tinycolor2$tinycolor(this._r,this._g,this._b),b=mathRound$$module$node_modules$tinycolor2$tinycolor(360*a.h),c=mathRound$$module$node_modules$tinycolor2$tinycolor(100*a.s);a=mathRound$$module$node_modules$tinycolor2$tinycolor(100*a.v);return 1==this._a?"hsv("+b+", "+c+"%, "+a+"%)":"hsva("+b+", "+c+"%, "+a+"%, "+this._roundA+")"},toHsl:function(){var a=rgbToHsl$$module$node_modules$tinycolor2$tinycolor(this._r,
this._g,this._b);return{h:360*a.h,s:a.s,l:a.l,a:this._a}},toHslString:function(){var a=rgbToHsl$$module$node_modules$tinycolor2$tinycolor(this._r,this._g,this._b),b=mathRound$$module$node_modules$tinycolor2$tinycolor(360*a.h),c=mathRound$$module$node_modules$tinycolor2$tinycolor(100*a.s);a=mathRound$$module$node_modules$tinycolor2$tinycolor(100*a.l);return 1==this._a?"hsl("+b+", "+c+"%, "+a+"%)":"hsla("+b+", "+c+"%, "+a+"%, "+this._roundA+")"},toHex:function(a){return rgbToHex$$module$node_modules$tinycolor2$tinycolor(this._r,
this._g,this._b,a)},toHexString:function(a){return"#"+this.toHex(a)},toHex8:function(a){return rgbaToHex$$module$node_modules$tinycolor2$tinycolor(this._r,this._g,this._b,this._a,a)},toHex8String:function(a){return"#"+this.toHex8(a)},toRgb:function(){return{r:mathRound$$module$node_modules$tinycolor2$tinycolor(this._r),g:mathRound$$module$node_modules$tinycolor2$tinycolor(this._g),b:mathRound$$module$node_modules$tinycolor2$tinycolor(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+
mathRound$$module$node_modules$tinycolor2$tinycolor(this._r)+", "+mathRound$$module$node_modules$tinycolor2$tinycolor(this._g)+", "+mathRound$$module$node_modules$tinycolor2$tinycolor(this._b)+")":"rgba("+mathRound$$module$node_modules$tinycolor2$tinycolor(this._r)+", "+mathRound$$module$node_modules$tinycolor2$tinycolor(this._g)+", "+mathRound$$module$node_modules$tinycolor2$tinycolor(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:mathRound$$module$node_modules$tinycolor2$tinycolor(100*
bound01$$module$node_modules$tinycolor2$tinycolor(this._r,255))+"%",g:mathRound$$module$node_modules$tinycolor2$tinycolor(100*bound01$$module$node_modules$tinycolor2$tinycolor(this._g,255))+"%",b:mathRound$$module$node_modules$tinycolor2$tinycolor(100*bound01$$module$node_modules$tinycolor2$tinycolor(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+mathRound$$module$node_modules$tinycolor2$tinycolor(100*bound01$$module$node_modules$tinycolor2$tinycolor(this._r,
255))+"%, "+mathRound$$module$node_modules$tinycolor2$tinycolor(100*bound01$$module$node_modules$tinycolor2$tinycolor(this._g,255))+"%, "+mathRound$$module$node_modules$tinycolor2$tinycolor(100*bound01$$module$node_modules$tinycolor2$tinycolor(this._b,255))+"%)":"rgba("+mathRound$$module$node_modules$tinycolor2$tinycolor(100*bound01$$module$node_modules$tinycolor2$tinycolor(this._r,255))+"%, "+mathRound$$module$node_modules$tinycolor2$tinycolor(100*bound01$$module$node_modules$tinycolor2$tinycolor(this._g,
255))+"%, "+mathRound$$module$node_modules$tinycolor2$tinycolor(100*bound01$$module$node_modules$tinycolor2$tinycolor(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":1>this._a?!1:hexNames$$module$node_modules$tinycolor2$tinycolor[rgbToHex$$module$node_modules$tinycolor2$tinycolor(this._r,this._g,this._b,!0)]||!1},toFilter:function(a){var b="#"+rgbaToArgbHex$$module$node_modules$tinycolor2$tinycolor(this._r,this._g,this._b,this._a),c=b,g=this._gradientType?
"GradientType = 1, ":"";a&&(a=(0,module$node_modules$tinycolor2$tinycolor.default)(a),c="#"+rgbaToArgbHex$$module$node_modules$tinycolor2$tinycolor(a._r,a._g,a._b,a._a));return"progid:DXImageTransform.Microsoft.gradient("+g+"startColorstr="+b+",endColorstr="+c+")"},toString:function(a){var b=!!a;a=a||this._format;var c=!1,g=1>this._a&&0<=this._a;if(!b&&g&&("hex"===a||"hex6"===a||"hex3"===a||"hex4"===a||"hex8"===a||"name"===a))return"name"===a&&0===this._a?this.toName():this.toRgbString();"rgb"===
a&&(c=this.toRgbString());"prgb"===a&&(c=this.toPercentageRgbString());if("hex"===a||"hex6"===a)c=this.toHexString();"hex3"===a&&(c=this.toHexString(!0));"hex4"===a&&(c=this.toHex8String(!0));"hex8"===a&&(c=this.toHex8String());"name"===a&&(c=this.toName());"hsl"===a&&(c=this.toHslString());"hsv"===a&&(c=this.toHsvString());return c||this.toHexString()},clone:function(){return(0,module$node_modules$tinycolor2$tinycolor.default)(this.toString())},_applyModification:function(a,b){a=a.apply(null,[this].concat([].slice.call(b)));
this._r=a._r;this._g=a._g;this._b=a._b;this.setAlpha(a._a);return this},lighten:function(){return this._applyModification(lighten$$module$node_modules$tinycolor2$tinycolor,arguments)},brighten:function(){return this._applyModification(brighten$$module$node_modules$tinycolor2$tinycolor,arguments)},darken:function(){return this._applyModification(darken$$module$node_modules$tinycolor2$tinycolor,arguments)},desaturate:function(){return this._applyModification(desaturate$$module$node_modules$tinycolor2$tinycolor,
arguments)},saturate:function(){return this._applyModification(saturate$$module$node_modules$tinycolor2$tinycolor,arguments)},greyscale:function(){return this._applyModification(greyscale$$module$node_modules$tinycolor2$tinycolor,arguments)},spin:function(){return this._applyModification(spin$$module$node_modules$tinycolor2$tinycolor,arguments)},_applyCombination:function(a,b){return a.apply(null,[this].concat([].slice.call(b)))},analogous:function(){return this._applyCombination(analogous$$module$node_modules$tinycolor2$tinycolor,
arguments)},complement:function(){return this._applyCombination(complement$$module$node_modules$tinycolor2$tinycolor,arguments)},monochromatic:function(){return this._applyCombination(monochromatic$$module$node_modules$tinycolor2$tinycolor,arguments)},splitcomplement:function(){return this._applyCombination(splitcomplement$$module$node_modules$tinycolor2$tinycolor,arguments)},triad:function(){return this._applyCombination(triad$$module$node_modules$tinycolor2$tinycolor,arguments)},tetrad:function(){return this._applyCombination(tetrad$$module$node_modules$tinycolor2$tinycolor,
arguments)}};module$node_modules$tinycolor2$tinycolor.default.fromRatio=function(a,b){if("object"==typeof a){var c={},g;for(g in a)a.hasOwnProperty(g)&&(c[g]="a"===g?a[g]:convertToPercentage$$module$node_modules$tinycolor2$tinycolor(a[g]));a=c}return(0,module$node_modules$tinycolor2$tinycolor.default)(a,b)};
function inputToRGB$$module$node_modules$tinycolor2$tinycolor(a){var b={r:0,g:0,b:0},c=1,g,d=g=!1;"string"==typeof a&&(a=stringInputToObject$$module$node_modules$tinycolor2$tinycolor(a));"object"==typeof a&&(isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(a.r)&&isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(a.g)&&isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(a.b)?(b=rgbToRgb$$module$node_modules$tinycolor2$tinycolor(a.r,a.g,a.b),g=!0,d="%"===String(a.r).substr(-1)?"prgb":
"rgb"):isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(a.h)&&isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(a.s)&&isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(a.v)?(b=convertToPercentage$$module$node_modules$tinycolor2$tinycolor(a.s),g=convertToPercentage$$module$node_modules$tinycolor2$tinycolor(a.v),b=hsvToRgb$$module$node_modules$tinycolor2$tinycolor(a.h,b,g),g=!0,d="hsv"):isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(a.h)&&isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(a.s)&&
isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(a.l)&&(b=convertToPercentage$$module$node_modules$tinycolor2$tinycolor(a.s),g=convertToPercentage$$module$node_modules$tinycolor2$tinycolor(a.l),b=hslToRgb$$module$node_modules$tinycolor2$tinycolor(a.h,b,g),g=!0,d="hsl"),a.hasOwnProperty("a")&&(c=a.a));c=boundAlpha$$module$node_modules$tinycolor2$tinycolor(c);return{ok:g,format:a.format||d,r:mathMin$$module$node_modules$tinycolor2$tinycolor(255,mathMax$$module$node_modules$tinycolor2$tinycolor(b.r,
0)),g:mathMin$$module$node_modules$tinycolor2$tinycolor(255,mathMax$$module$node_modules$tinycolor2$tinycolor(b.g,0)),b:mathMin$$module$node_modules$tinycolor2$tinycolor(255,mathMax$$module$node_modules$tinycolor2$tinycolor(b.b,0)),a:c}}
function rgbToRgb$$module$node_modules$tinycolor2$tinycolor(a,b,c){return{r:255*bound01$$module$node_modules$tinycolor2$tinycolor(a,255),g:255*bound01$$module$node_modules$tinycolor2$tinycolor(b,255),b:255*bound01$$module$node_modules$tinycolor2$tinycolor(c,255)}}
function rgbToHsl$$module$node_modules$tinycolor2$tinycolor(a,b,c){a=bound01$$module$node_modules$tinycolor2$tinycolor(a,255);b=bound01$$module$node_modules$tinycolor2$tinycolor(b,255);c=bound01$$module$node_modules$tinycolor2$tinycolor(c,255);var g=mathMax$$module$node_modules$tinycolor2$tinycolor(a,b,c),d=mathMin$$module$node_modules$tinycolor2$tinycolor(a,b,c),f=(g+d)/2;if(g==d)var p=d=0;else{var e=g-d;d=.5<f?e/(2-g-d):e/(g+d);switch(g){case a:p=(b-c)/e+(b<c?6:0);break;case b:p=(c-a)/e+2;break;
case c:p=(a-b)/e+4}p/=6}return{h:p,s:d,l:f}}
function hslToRgb$$module$node_modules$tinycolor2$tinycolor(a,b,c){function g(a,b,c){0>c&&(c+=1);1<c&&--c;return c<1/6?a+6*(b-a)*c:.5>c?b:c<2/3?a+(b-a)*(2/3-c)*6:a}a=bound01$$module$node_modules$tinycolor2$tinycolor(a,360);b=bound01$$module$node_modules$tinycolor2$tinycolor(b,100);c=bound01$$module$node_modules$tinycolor2$tinycolor(c,100);if(0===b)c=b=a=c;else{var d=.5>c?c*(1+b):c+b-c*b,f=2*c-d;c=g(f,d,a+1/3);b=g(f,d,a);a=g(f,d,a-1/3)}return{r:255*c,g:255*b,b:255*a}}
function rgbToHsv$$module$node_modules$tinycolor2$tinycolor(a,b,c){a=bound01$$module$node_modules$tinycolor2$tinycolor(a,255);b=bound01$$module$node_modules$tinycolor2$tinycolor(b,255);c=bound01$$module$node_modules$tinycolor2$tinycolor(c,255);var g=mathMax$$module$node_modules$tinycolor2$tinycolor(a,b,c),d=mathMin$$module$node_modules$tinycolor2$tinycolor(a,b,c),f=g-d;if(g==d)var p=0;else{switch(g){case a:p=(b-c)/f+(b<c?6:0);break;case b:p=(c-a)/f+2;break;case c:p=(a-b)/f+4}p/=6}return{h:p,s:0===
g?0:f/g,v:g}}function hsvToRgb$$module$node_modules$tinycolor2$tinycolor(a,b,c){a=6*bound01$$module$node_modules$tinycolor2$tinycolor(a,360);b=bound01$$module$node_modules$tinycolor2$tinycolor(b,100);c=bound01$$module$node_modules$tinycolor2$tinycolor(c,100);var g=Math$$module$node_modules$tinycolor2$tinycolor.floor(a),d=a-g;a=c*(1-b);var f=c*(1-d*b);b=c*(1-(1-d)*b);g%=6;return{r:255*[c,f,a,a,b,c][g],g:255*[b,c,c,f,a,a][g],b:255*[a,a,b,c,c,f][g]}}
function rgbToHex$$module$node_modules$tinycolor2$tinycolor(a,b,c,g){a=[pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(a).toString(16)),pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(b).toString(16)),pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(c).toString(16))];return g&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==
a[2].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0):a.join("")}
function rgbaToHex$$module$node_modules$tinycolor2$tinycolor(a,b,c,g,d){a=[pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(a).toString(16)),pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(b).toString(16)),pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(c).toString(16)),pad2$$module$node_modules$tinycolor2$tinycolor(convertDecimalToHex$$module$node_modules$tinycolor2$tinycolor(g))];return d&&
a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}
function rgbaToArgbHex$$module$node_modules$tinycolor2$tinycolor(a,b,c,g){return[pad2$$module$node_modules$tinycolor2$tinycolor(convertDecimalToHex$$module$node_modules$tinycolor2$tinycolor(g)),pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(a).toString(16)),pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(b).toString(16)),pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(c).toString(16))].join("")}
module$node_modules$tinycolor2$tinycolor.default.equals=function(a,b){return a&&b?(0,module$node_modules$tinycolor2$tinycolor.default)(a).toRgbString()==(0,module$node_modules$tinycolor2$tinycolor.default)(b).toRgbString():!1};module$node_modules$tinycolor2$tinycolor.default.random=function(){return module$node_modules$tinycolor2$tinycolor.default.fromRatio({r:mathRandom$$module$node_modules$tinycolor2$tinycolor(),g:mathRandom$$module$node_modules$tinycolor2$tinycolor(),b:mathRandom$$module$node_modules$tinycolor2$tinycolor()})};
function desaturate$$module$node_modules$tinycolor2$tinycolor(a,b){b=0===b?0:b||10;a=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toHsl();a.s-=b/100;a.s=clamp01$$module$node_modules$tinycolor2$tinycolor(a.s);return(0,module$node_modules$tinycolor2$tinycolor.default)(a)}
function saturate$$module$node_modules$tinycolor2$tinycolor(a,b){b=0===b?0:b||10;a=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toHsl();a.s+=b/100;a.s=clamp01$$module$node_modules$tinycolor2$tinycolor(a.s);return(0,module$node_modules$tinycolor2$tinycolor.default)(a)}function greyscale$$module$node_modules$tinycolor2$tinycolor(a){return(0,module$node_modules$tinycolor2$tinycolor.default)(a).desaturate(100)}
function lighten$$module$node_modules$tinycolor2$tinycolor(a,b){b=0===b?0:b||10;a=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toHsl();a.l+=b/100;a.l=clamp01$$module$node_modules$tinycolor2$tinycolor(a.l);return(0,module$node_modules$tinycolor2$tinycolor.default)(a)}
function brighten$$module$node_modules$tinycolor2$tinycolor(a,b){b=0===b?0:b||10;a=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toRgb();a.r=mathMax$$module$node_modules$tinycolor2$tinycolor(0,mathMin$$module$node_modules$tinycolor2$tinycolor(255,a.r-mathRound$$module$node_modules$tinycolor2$tinycolor(255*-(b/100))));a.g=mathMax$$module$node_modules$tinycolor2$tinycolor(0,mathMin$$module$node_modules$tinycolor2$tinycolor(255,a.g-mathRound$$module$node_modules$tinycolor2$tinycolor(255*-(b/
100))));a.b=mathMax$$module$node_modules$tinycolor2$tinycolor(0,mathMin$$module$node_modules$tinycolor2$tinycolor(255,a.b-mathRound$$module$node_modules$tinycolor2$tinycolor(255*-(b/100))));return(0,module$node_modules$tinycolor2$tinycolor.default)(a)}
function darken$$module$node_modules$tinycolor2$tinycolor(a,b){b=0===b?0:b||10;a=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toHsl();a.l-=b/100;a.l=clamp01$$module$node_modules$tinycolor2$tinycolor(a.l);return(0,module$node_modules$tinycolor2$tinycolor.default)(a)}function spin$$module$node_modules$tinycolor2$tinycolor(a,b){a=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toHsl();b=(a.h+b)%360;a.h=0>b?360+b:b;return(0,module$node_modules$tinycolor2$tinycolor.default)(a)}
function complement$$module$node_modules$tinycolor2$tinycolor(a){a=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toHsl();a.h=(a.h+180)%360;return(0,module$node_modules$tinycolor2$tinycolor.default)(a)}
function triad$$module$node_modules$tinycolor2$tinycolor(a){var b=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toHsl(),c=b.h;return[(0,module$node_modules$tinycolor2$tinycolor.default)(a),(0,module$node_modules$tinycolor2$tinycolor.default)({h:(c+120)%360,s:b.s,l:b.l}),(0,module$node_modules$tinycolor2$tinycolor.default)({h:(c+240)%360,s:b.s,l:b.l})]}
function tetrad$$module$node_modules$tinycolor2$tinycolor(a){var b=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toHsl(),c=b.h;return[(0,module$node_modules$tinycolor2$tinycolor.default)(a),(0,module$node_modules$tinycolor2$tinycolor.default)({h:(c+90)%360,s:b.s,l:b.l}),(0,module$node_modules$tinycolor2$tinycolor.default)({h:(c+180)%360,s:b.s,l:b.l}),(0,module$node_modules$tinycolor2$tinycolor.default)({h:(c+270)%360,s:b.s,l:b.l})]}
function splitcomplement$$module$node_modules$tinycolor2$tinycolor(a){var b=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toHsl(),c=b.h;return[(0,module$node_modules$tinycolor2$tinycolor.default)(a),(0,module$node_modules$tinycolor2$tinycolor.default)({h:(c+72)%360,s:b.s,l:b.l}),(0,module$node_modules$tinycolor2$tinycolor.default)({h:(c+216)%360,s:b.s,l:b.l})]}
function analogous$$module$node_modules$tinycolor2$tinycolor(a,b,c){b=b||6;c=c||30;var g=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toHsl();c=360/c;a=[(0,module$node_modules$tinycolor2$tinycolor.default)(a)];for(g.h=(g.h-(c*b>>1)+720)%360;--b;)g.h=(g.h+c)%360,a.push((0,module$node_modules$tinycolor2$tinycolor.default)(g));return a}
function monochromatic$$module$node_modules$tinycolor2$tinycolor(a,b){b=b||6;var c=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toHsv();a=c.h;var g=c.s;c=c.v;for(var d=[],f=1/b;b--;)d.push((0,module$node_modules$tinycolor2$tinycolor.default)({h:a,s:g,v:c})),c=(c+f)%1;return d}
module$node_modules$tinycolor2$tinycolor.default.mix=function(a,b,c){c=0===c?0:c||50;a=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toRgb();b=(0,module$node_modules$tinycolor2$tinycolor.default)(b).toRgb();c/=100;return(0,module$node_modules$tinycolor2$tinycolor.default)({r:(b.r-a.r)*c+a.r,g:(b.g-a.g)*c+a.g,b:(b.b-a.b)*c+a.b,a:(b.a-a.a)*c+a.a})};
module$node_modules$tinycolor2$tinycolor.default.readability=function(a,b){a=(0,module$node_modules$tinycolor2$tinycolor.default)(a);b=(0,module$node_modules$tinycolor2$tinycolor.default)(b);return(Math$$module$node_modules$tinycolor2$tinycolor.max(a.getLuminance(),b.getLuminance())+.05)/(Math$$module$node_modules$tinycolor2$tinycolor.min(a.getLuminance(),b.getLuminance())+.05)};
module$node_modules$tinycolor2$tinycolor.default.isReadable=function(a,b,c){a=module$node_modules$tinycolor2$tinycolor.default.readability(a,b);b=!1;c=validateWCAG2Parms$$module$node_modules$tinycolor2$tinycolor(c);switch(c.level+c.size){case "AAsmall":case "AAAlarge":b=4.5<=a;break;case "AAlarge":b=3<=a;break;case "AAAsmall":b=7<=a}return b};
module$node_modules$tinycolor2$tinycolor.default.mostReadable=function(a,b,c){var g=null,d=0;c=c||{};var f=c.includeFallbackColors;var p=c.level;var e=c.size;for(var m=0;m<b.length;m++){var h=module$node_modules$tinycolor2$tinycolor.default.readability(a,b[m]);h>d&&(d=h,g=(0,module$node_modules$tinycolor2$tinycolor.default)(b[m]))}if(module$node_modules$tinycolor2$tinycolor.default.isReadable(a,g,{level:p,size:e})||!f)return g;c.includeFallbackColors=!1;return module$node_modules$tinycolor2$tinycolor.default.mostReadable(a,
["#fff","#000"],c)};
var names$$module$node_modules$tinycolor2$tinycolor=module$node_modules$tinycolor2$tinycolor.default.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",
darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",
forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",
lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",
moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",
seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},hexNames$$module$node_modules$tinycolor2$tinycolor=module$node_modules$tinycolor2$tinycolor.default.hexNames=flip$$module$node_modules$tinycolor2$tinycolor(names$$module$node_modules$tinycolor2$tinycolor);
function flip$$module$node_modules$tinycolor2$tinycolor(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&(b[a[c]]=c);return b}function boundAlpha$$module$node_modules$tinycolor2$tinycolor(a){a=parseFloat(a);if(isNaN(a)||0>a||1<a)a=1;return a}
function bound01$$module$node_modules$tinycolor2$tinycolor(a,b){isOnePointZero$$module$node_modules$tinycolor2$tinycolor(a)&&(a="100%");var c=isPercentage$$module$node_modules$tinycolor2$tinycolor(a);a=mathMin$$module$node_modules$tinycolor2$tinycolor(b,mathMax$$module$node_modules$tinycolor2$tinycolor(0,parseFloat(a)));c&&(a=parseInt(a*b,10)/100);return 1E-6>Math$$module$node_modules$tinycolor2$tinycolor.abs(a-b)?1:a%b/parseFloat(b)}
function clamp01$$module$node_modules$tinycolor2$tinycolor(a){return mathMin$$module$node_modules$tinycolor2$tinycolor(1,mathMax$$module$node_modules$tinycolor2$tinycolor(0,a))}function parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(a){return parseInt(a,16)}function isOnePointZero$$module$node_modules$tinycolor2$tinycolor(a){return"string"==typeof a&&-1!=a.indexOf(".")&&1===parseFloat(a)}
function isPercentage$$module$node_modules$tinycolor2$tinycolor(a){return"string"===typeof a&&-1!=a.indexOf("%")}function pad2$$module$node_modules$tinycolor2$tinycolor(a){return 1==a.length?"0"+a:""+a}function convertToPercentage$$module$node_modules$tinycolor2$tinycolor(a){1>=a&&(a=100*a+"%");return a}function convertDecimalToHex$$module$node_modules$tinycolor2$tinycolor(a){return Math$$module$node_modules$tinycolor2$tinycolor.round(255*parseFloat(a)).toString(16)}
function convertHexToDecimal$$module$node_modules$tinycolor2$tinycolor(a){return parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(a)/255}
var matchers$$module$node_modules$tinycolor2$tinycolor=function(){return{CSS_UNIT:/(?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?)/,rgb:/rgb[\s|\(]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))\s*\)?/,rgba:/rgba[\s|\(]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))\s*\)?/,hsl:/hsl[\s|\(]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))\s*\)?/,
hsla:/hsla[\s|\(]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))\s*\)?/,hsv:/hsv[\s|\(]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))\s*\)?/,hsva:/hsva[\s|\(]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))\s*\)?/,
hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(a){return!!matchers$$module$node_modules$tinycolor2$tinycolor.CSS_UNIT.exec(a)}
function stringInputToObject$$module$node_modules$tinycolor2$tinycolor(a){a=a.replace(trimLeft$$module$node_modules$tinycolor2$tinycolor,"").replace(trimRight$$module$node_modules$tinycolor2$tinycolor,"").toLowerCase();var b=!1;if(names$$module$node_modules$tinycolor2$tinycolor[a])a=names$$module$node_modules$tinycolor2$tinycolor[a],b=!0;else if("transparent"==a)return{r:0,g:0,b:0,a:0,format:"name"};var c;return(c=matchers$$module$node_modules$tinycolor2$tinycolor.rgb.exec(a))?{r:c[1],g:c[2],b:c[3]}:
(c=matchers$$module$node_modules$tinycolor2$tinycolor.rgba.exec(a))?{r:c[1],g:c[2],b:c[3],a:c[4]}:(c=matchers$$module$node_modules$tinycolor2$tinycolor.hsl.exec(a))?{h:c[1],s:c[2],l:c[3]}:(c=matchers$$module$node_modules$tinycolor2$tinycolor.hsla.exec(a))?{h:c[1],s:c[2],l:c[3],a:c[4]}:(c=matchers$$module$node_modules$tinycolor2$tinycolor.hsv.exec(a))?{h:c[1],s:c[2],v:c[3]}:(c=matchers$$module$node_modules$tinycolor2$tinycolor.hsva.exec(a))?{h:c[1],s:c[2],v:c[3],a:c[4]}:(c=matchers$$module$node_modules$tinycolor2$tinycolor.hex8.exec(a))?
{r:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[1]),g:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[2]),b:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[3]),a:convertHexToDecimal$$module$node_modules$tinycolor2$tinycolor(c[4]),format:b?"name":"hex8"}:(c=matchers$$module$node_modules$tinycolor2$tinycolor.hex6.exec(a))?{r:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[1]),g:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[2]),b:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[3]),
format:b?"name":"hex"}:(c=matchers$$module$node_modules$tinycolor2$tinycolor.hex4.exec(a))?{r:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[1]+""+c[1]),g:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[2]+""+c[2]),b:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[3]+""+c[3]),a:convertHexToDecimal$$module$node_modules$tinycolor2$tinycolor(c[4]+""+c[4]),format:b?"name":"hex8"}:(c=matchers$$module$node_modules$tinycolor2$tinycolor.hex3.exec(a))?{r:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[1]+
""+c[1]),g:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[2]+""+c[2]),b:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[3]+""+c[3]),format:b?"name":"hex"}:!1}function validateWCAG2Parms$$module$node_modules$tinycolor2$tinycolor(a){a=a||{level:"AA",size:"small"};var b=(a.level||"AA").toUpperCase();a=(a.size||"small").toLowerCase();"AA"!==b&&"AAA"!==b&&(b="AA");"small"!==a&&"large"!==a&&(a="small");return{level:b,size:a}};var module$src$externals$three={};try{module$src$externals$three.default=eval("THREE")}catch(a){"function"===typeof require&&(module$src$externals$three.default=eval("require('three')"))};var module$src$polyfills$padStart={default:{}};String.prototype.padStart||(String.prototype.padStart=function(a,b){a>>=0;b=String("undefined"!==typeof b?b:" ");if(this.length>a)return String(this);a-=this.length;a>b.length&&(b+=b.repeat(a/b.length));return b.slice(0,a)+String(this)});var module$src$polyfills$padEnd={default:{}};String.prototype.padEnd||(String.prototype.padEnd=function(a,b){a>>=0;b=String("undefined"!==typeof b?b:" ");if(this.length>a)return String(this);a-=this.length;a>b.length&&(b+=b.repeat(a/b.length));return String(this)+b.slice(0,a)});var module$src$shared$util$toTinyColor={},tinycolor$$module$src$shared$util$toTinyColor=module$node_modules$tinycolor2$tinycolor.default;
if(void 0===module$node_modules$tinycolor2$tinycolor.default.prototype.toThreeColor){var THREE$$module$src$shared$util$toTinyColor=module$src$externals$three.default;module$node_modules$tinycolor2$tinycolor.default.prototype.toThreeColor=function(){return new module$src$externals$three.default.Color(this.toRgbString())};module$node_modules$tinycolor2$tinycolor.default.prototype.toArray=function(){return[this._r,this._g,this._b,255*this._a]}}
module$src$shared$util$toTinyColor.default=function(a,b){if(a.hasOwnProperty("getOriginalInput"))return a;var c=null;b&&(c=(0,module$node_modules$tinycolor2$tinycolor.default)(b));if("number"===typeof a)return a=a.toString(16),b=a.length,3>b?a=a.padStart(3,0):6>b?a=a.padStart(6,0):8>b&&(a=a.padEnd(8,0)),a=(0,module$node_modules$tinycolor2$tinycolor.default)(a),a.isValid()?a:c;if(a.isColor&&"function"==typeof a.getHexString)return a=(0,module$node_modules$tinycolor2$tinycolor.default)(a.getHexString()),
a.isValid()?a:c;if(Array.isArray(a)&&(3==a.length||4==a.length)){b=!0;for(var g=0;3>g;++g)a[g]=parseFloat(a[g]),isNaN(a[g])&&(b=!1);if(!b)return c;b=(0,module$node_modules$tinycolor2$tinycolor.default)({r:Math.max(0,Math.min(a[0],255)),g:Math.max(0,Math.min(a[1],255)),b:Math.max(0,Math.min(a[2],255))});4==a.length&&(a=parseFloat(a[3]),isNaN(a)||b.setAlpha(Math.max(0,Math.min(a,255))/255));return b.isValid()?b:c}if("string"!==typeof a)return a=(0,module$node_modules$tinycolor2$tinycolor.default)(a),
a.isValid()?a:c;a=a.replace("0x","#");if(null!==a.match(/^#[a-f0-9]{6}$/i))return a=(0,module$node_modules$tinycolor2$tinycolor.default)(a+"ff"),a.isValid()?a:c;if(null!==a.match(/^#[a-f0-9]{8}$/i))return a=(0,module$node_modules$tinycolor2$tinycolor.default)(a),a.isValid()?a:c;if(null!==a.match(/^#[a-f0-9]{7}$/i))return a=(0,module$node_modules$tinycolor2$tinycolor.default)(a.slice(0,7)+"0"+a.slice(-1)),a.isValid()?a:c;a=(0,module$node_modules$tinycolor2$tinycolor.default)(a);return a.isValid()?
a:c};var module$src$shared$util$atobtoa={default:{}};module$src$shared$util$atobtoa.default.btoaUTF8=function(a,b){return originalBtoa$$module$src$shared$util$atobtoa((b?"\u00ef\u00bb\u00bf":"")+a.replace(/[\x80-\uD7ff\uDC00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]?/g,btoaReplacer$$module$src$shared$util$atobtoa))};
module$src$shared$util$atobtoa.default.atobUTF8=function(a,b){b||"\u00ef\u00bb\u00bf"!==a.substring(0,3)||(a=a.substring(3));return originalAtob$$module$src$shared$util$atobtoa(a).replace(/[\xc0-\xff][\x80-\xbf]*/g,atobReplacer$$module$src$shared$util$atobtoa)};
var log$$module$src$shared$util$atobtoa=Math.log,LN2$$module$src$shared$util$atobtoa=Math.LN2,clz32$$module$src$shared$util$atobtoa=Math.clz32||function(a){return 31-log$$module$src$shared$util$atobtoa(a>>>0)/LN2$$module$src$shared$util$atobtoa|0},fromCharCode$$module$src$shared$util$atobtoa=String.fromCharCode,originalAtob$$module$src$shared$util$atobtoa=atob,originalBtoa$$module$src$shared$util$atobtoa=btoa;
function btoaReplacer$$module$src$shared$util$atobtoa(a){var b=a.charCodeAt(0);if(55296<=b&&56319>=b){var c=a.charCodeAt(1);if(c===c&&56320<=c&&57343>=c){if(b=1024*(b-55296)+c-56320+65536,65535<b)return fromCharCode$$module$src$shared$util$atobtoa(240|b>>>18,128|b>>>12&63,128|b>>>6&63,128|b&63)}else return fromCharCode$$module$src$shared$util$atobtoa(239,191,189)}return 127>=b?a:2047>=b?fromCharCode$$module$src$shared$util$atobtoa(192|b>>>6,128|b&63):fromCharCode$$module$src$shared$util$atobtoa(224|
b>>>12,128|b>>>6&63,128|b&63)}function atobReplacer$$module$src$shared$util$atobtoa(a){var b=a.charCodeAt(0)<<24,c=clz32$$module$src$shared$util$atobtoa(~b),g=0,d=a.length,f="";if(5>c&&d>=c){b=b<<c>>>24+c;for(g=1;g<c;++g)b=b<<6|a.charCodeAt(g)&63;65535>=b?f+=fromCharCode$$module$src$shared$util$atobtoa(b):1114111>=b?(b-=65536,f+=fromCharCode$$module$src$shared$util$atobtoa((b>>10)+55296,(b&1023)+56320)):g=0}for(;g<d;++g)f+="\ufffd";return f};var module$src$shared$util$GlobalUtils={},TOTINYCOLOR$$module$src$shared$util$GlobalUtils=module$src$shared$util$toTinyColor.default,THREE$$module$src$shared$util$GlobalUtils=module$src$externals$three.default,ATOBTOA$$module$src$shared$util$GlobalUtils=module$src$shared$util$atobtoa.default,GlobalUtils$$module$src$shared$util$GlobalUtils=function(){var a=this,b="undefined"!==typeof window&&window.navigator&&-1<window.navigator.userAgent.indexOf("Trident"),c=b||"undefined"!==typeof document&&"function"===
typeof document.getElementById&&window&&"function"===typeof window.Event,g=!1;var d=c?(g=parent!==window)?document.referrer:window.location.origin:"direct";this.runningInIE=function(){return b};this.runningInBrowser=function(){return c};this.runningInIframe=function(){return g};this.embeddingOrigin=function(){return d+""};this.getNodeAttribute=function(a,b,d){return c&&a&&!Array.isArray(a)&&"function"===typeof a.hasAttribute&&a.hasAttribute(b)?a.getAttribute(b):d};this.getBooleanNodeAttribute=function(a,
b,d){return c&&a&&!Array.isArray(a)&&"function"===typeof a.hasAttribute&&a.hasAttribute(b)?this.toBoolean(a.getAttribute(b),d):d};this.parseQueryString=function(a,b){b=void 0===b?!1:b;a=a.split("&");for(var c={},f=0;f<a.length;f++){var d=a[f].split("="),r=decodeURIComponent(d[0]);d=decodeURIComponent(d[1]);"undefined"===typeof c[r]?c[r]=d:b&&("string"===typeof c[r]?c[r]=[c[r],d]:c[r].push(d))}return c};this.guessMimeTypeFromFilename=function(a){a=a.toLowerCase();var b="";a.endsWith(".dxf")?b="application/dxf":
a.endsWith(".obj")?b="application/wavefront-obj":a.endsWith(".csv")&&(b="text/csv");return b};this.storageAvailable=function(a){try{var b=window[a];b.setItem("__storage_test__","__storage_test__");b.removeItem("__storage_test__");return!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&0!==b.length}};this.isArrayOfType=function(a,b){return Array.isArray(a)?-1===a.findIndex(function(a){return typeof a!==
b}):!1};this.deepCopyReplacer=function(a,b){return"number"===typeof b&&isNaN(b)?"___NaN___":b===Number.POSITIVE_INFINITY?"___PosInfinity___":b===Number.NEGATIVE_INFINITY?"___NegInfinity___":b};this.deepCopyReviver=function(a,b){if("string"===typeof b){if("___NaN___"===b)return Number.NaN;if("___PosInfinity___"===b)return Number.POSITIVE_INFINITY;if("___NegInfinity___"===b)return Number.NEGATIVE_INFINITY}return b};this.deepCopy=function(b,c){if(void 0!==b){if(c){Array.isArray(c)||(c=[c]);var f=[];
if(a.getPaths(b,f,"",c)||0===f.length)return a.deepCopy(b);var d={},h={};f=$jscomp.makeIterator(f);for(var r=f.next();!r.done;h={p:h.p},r=f.next()){h.p=r.value;r=a.getAtPath(b,h.p);if(c.every(function(a){return function(b){return a.p===b||a.p.endsWith("."+b)?!1:!0}}(h)))if(Array.isArray(r)){var q=r;r=[];q=$jscomp.makeIterator(q);for(var g=q.next();!g.done;g=q.next())r.push(a.deepCopy(g.value,c))}else r=a.deepCopy(r);a.forceAtPath(d,h.p,r)}return d}return JSON.parse(JSON.stringify(b,a.deepCopyReplacer),
a.deepCopyReviver)}};this.setIfUndefined=function(a,b){return"undefined"===typeof a?b:a};this.inject=function(a,b,c){void 0===c&&(c=!0);Object.keys(a).forEach(function(f){if(c||!b.hasOwnProperty(f))b[f]=a[f]});return b};this.defineHiddenProperty=function(a,b){Object.defineProperty(this,a,{enumerable:!1,configurable:!1,writable:!0,value:b})};this.defineConstantProperty=function(a,b){Object.defineProperty(this,a,{enumerable:!0,configurable:!1,writable:!1,value:b})};this.stringChecksum=function(a){var b=
0,c=a.length,f;if(0===c)return b;for(f=0;f<c;f++){var d=a.charCodeAt(f);b=(b<<5)-b+d;b&=b}return b};this.toNumber=function(a,b){a=Number(a);Number.isNaN(a)&&(a=b);return a};this.toBoolean=function(a,b){"boolean"!==typeof b&&(b=!1);return"boolean"===typeof a?a:"string"===typeof a?(a=a.toLowerCase(),b?"false"===a||"0"===a?!1:!0:"true"===a||"1"===a?!0:!1):!!a};this.createRandomId=function(){return Math.random().toString(36).substring(2,15)};this.getAt=function(a,b){return b.reduce(function(a,b){return a&&
void 0!==a[b]?a[b]:void 0},a)};this.getAtPath=function(b,c){c=c.replace(/\]$/,"").split(/[.[\]]+/);return a.getAt(b,c)};this.setAt=function(a,b,c,d){var f=b.pop();if("string"===typeof f&&(0<b.length&&(a=b.reduce(function(a,b){return a&&void 0!==a[b]?a[b]:void 0},a)),a&&(void 0!==a[f]||d)))return a[f]=c};this.setAtPath=function(b,c,d,g){c=c.replace(/\]$/,"").split(/[.[\]]+/);return a.setAt(b,c,d,g)};this.forceAt=function(a,b,c){if(void 0!==a&&"object"===typeof a){var f=b.pop();if("string"===typeof f)return 0<
b.length&&(a=b.reduce(function(a,b){return a&&void 0!==a[b]&&"object"===typeof a[b]?a[b]:a[b]={}},a)),a[f]=c}};this.forceAtPath=function(b,c,d){c=c.replace(/\]$/,"").split(/[.[\]]+/);return a.forceAt(b,c,d)};this.deleteAt=function(a,b){var c=b.pop();if("string"===typeof c&&(0<b.length&&(a=b.reduce(function(a,b){return a&&void 0!==a[b]?a[b]:void 0},a)),a))return b=a[c],delete a[c],b};this.deleteAtPath=function(b,c){c=c.replace(/\]$/,"").split(/[.[\]]+/);return a.deleteAt(b,c)};this.getPaths=function(b,
c,d,g,h){Array.isArray(c)||(c=[]);"string"!==typeof d&&(d="");Array.isArray(g)||(g=[]);"boolean"!==typeof h&&(h=!1);if(void 0===b||null===b||"object"!==typeof b||Array.isArray(b))return!0;if(h){var f=[];for(var e in b)f.push(e)}else f=Object.keys(b);if(0===f.length)return!0;f.forEach(function(f){var r=0===d.length?f:d+"."+f;g.includes(f)?c.push(r):a.getPaths(b[f],c,r,g,h)&&c.push(r)});return!1};this.defaults=function(b,c,d){if(Array.isArray(c))return c.reduce(function(b,c){return a.defaults(b,c,d)},
b);for(var f in c)b.hasOwnProperty(f)?Array.isArray(b[f])||"object"!==typeof b[f]||"object"!==typeof c[f]?d&&(b[f]=a.deepCopy(c[f])):a.defaults(b[f],c[f],d):b[f]=a.deepCopy(c[f]);return b};this.cartesianToPolar=function(a,b,c){var d=Math.sqrt(Math.pow(a,2)+Math.pow(b,2)+Math.pow(c,2));return[d,Math.acos(c/d),Math.atan2(b,a)]};this.polarToCartesian=function(a,b,c){return[a*Math.sin(b)*Math.cos(c),a*Math.sin(b)*Math.sin(c),a*Math.cos(b)]};this.check={string:function(a){return"string"===typeof a||a instanceof
String},number:function(a){return("number"===typeof a||a instanceof Number)&&!isNaN(a)},float:function(a){return("number"===typeof a||a instanceof Number)&&!isNaN(a)},notnegative:function(a){return("number"===typeof a||a instanceof Number)&&0<=a},notpositive:function(a){return("number"===typeof a||a instanceof Number)&&0>=a},factor:function(a){return("number"===typeof a||a instanceof Number)&&0<=a&&1>=a},color:function(a){return null!==(0,module$src$shared$util$toTinyColor.default)(a)},integer:function(a){return("number"===
typeof a||a instanceof Number)&&!isNaN(a)&&a===parseInt(a,10)},boolean:function(a){return"boolean"===typeof a||a instanceof Boolean},object:function(a){return void 0!==a&&"object"===typeof a},function:function(a){return void 0!==a&&"function"===typeof a},hexadecimal:function(b){if(a.typeCheck(b,"string")){b=b.replace("#","");var c=parseInt(b,16);return!(!b.endsWith(c.toString(16))||0>c||16777215<c)}return a.typeCheck(b,"number")?!(0>b||16777215<b):!1},vector2obj:function(b){return!b.x&&0!==b.x||!b.y&&
0!==b.y?!1:a.typeCheck(b.x,"number")&&a.typeCheck(b.y,"number")?!0:!1},vector2arr:function(b){return Array.isArray(b)&&2<=b.length?a.typeCheck(b[0],"number")&&a.typeCheck(b[1],"number")?!0:!1:!1},vector2any:function(b){return a.typeCheck(b,"vector2arr")||a.typeCheck(b,"vector2obj")?!0:!1},vector3obj:function(b){return!b.x&&0!==b.x||!b.y&&0!==b.y||!b.z&&0!==b.z?!1:a.typeCheck(b.x,"number")&&a.typeCheck(b.y,"number")&&a.typeCheck(b.z,"number")?!0:!1},vector3arr:function(b){return Array.isArray(b)&&
3<=b.length?a.typeCheck(b[0],"number")&&a.typeCheck(b[1],"number")&&a.typeCheck(b[2],"number")?!0:!1:!1},vector3any:function(b){return a.typeCheck(b,"vector3arr")||a.typeCheck(b,"vector3obj")?!0:!1},matrix4x4obj:function(b){return!b.a&&0!==b.a||!b.b&&0!==b.b||!b.c&&0!==b.c||!b.d&&0!==b.d||!b.e&&0!==b.e||!b.f&&0!==b.f||!b.g&&0!==b.g||!b.h&&0!==b.h||!b.i&&0!==b.i||!b.j&&0!==b.j||!b.k&&0!==b.k||!b.l&&0!==b.l||!b.m&&0!==b.m||!b.n&&0!==b.n||!b.o&&0!==b.o||!b.p&&0!==b.p?!1:a.typeCheck(b.a,"number")&&a.typeCheck(b.b,
"number")&&a.typeCheck(b.c,"number")&&a.typeCheck(b.d,"number")&&a.typeCheck(b.e,"number")&&a.typeCheck(b.f,"number")&&a.typeCheck(b.g,"number")&&a.typeCheck(b.h,"number")&&a.typeCheck(b.i,"number")&&a.typeCheck(b.j,"number")&&a.typeCheck(b.k,"number")&&a.typeCheck(b.l,"number")&&a.typeCheck(b.m,"number")&&a.typeCheck(b.n,"number")&&a.typeCheck(b.o,"number")&&a.typeCheck(b.p,"number")?!0:!1},matrix4x4arr:function(b){return Array.isArray(b)&&16<=b.length?a.typeCheck(b[0],"number")&&a.typeCheck(b[1],
"number")&&a.typeCheck(b[2],"number")&&a.typeCheck(b[3],"number")&&a.typeCheck(b[4],"number")&&a.typeCheck(b[5],"number")&&a.typeCheck(b[6],"number")&&a.typeCheck(b[7],"number")&&a.typeCheck(b[8],"number")&&a.typeCheck(b[9],"number")&&a.typeCheck(b[10],"number")&&a.typeCheck(b[11],"number")&&a.typeCheck(b[12],"number")&&a.typeCheck(b[13],"number")&&a.typeCheck(b[14],"number")&&a.typeCheck(b[15],"number")?!0:!1:!1},matrix4x4any:function(b){return a.typeCheck(b,"matrix4x4arr")||a.typeCheck(b,"matrix4x4obj")?
!0:!1}};this.typeCheck=function(a,b,c,d,h){for(var r=[],e=4;e<arguments.length;++e)r[e-4]=arguments[e];if(void 0===a){e="The given input is undefined.";var g=!1}else null===a?(e="The given input is null.",g=!1):(b=b.toLowerCase(),this.check[b]?e=(g=this.check[b](a))?"":"Value "+a+" is not a "+b:(e="No type check available for type "+b+". The possible types are ["+Object.getOwnPropertyNames(this.check).map(function(a){return" "+a})+" ]. Choose one of them.",g=!1));"function"===typeof c&&!1===g&&(d?
c.apply(null,[d,e].concat($jscomp.arrayFromIterable(r))):c.apply(null,[e].concat($jscomp.arrayFromIterable(r))));return g};this.waitForTimeout=function(a){return new Promise(function(b){setInterval(b,a)})};this.toVector3=function(a){if(a.isVector3)return a;if(Array.isArray(a)&&2<=a.length){var b=new module$src$externals$three.default.Vector3;b.fromArray(a);return b}return new module$src$externals$three.default.Vector3(a.x,a.y,a.z)};this.ArrayToObject=function(a){if(!Array.isArray(a))return null;var b,
c=a.length,d={};for(b=0;b<c;b++)d[""+b]=a[b];return d};this.ObjectToArray=function(a){if(null===a||"object"!==typeof a)return null;var b,c=[];for(b=0;;b++){var d=""+b;if(!a.hasOwnProperty(d))break;c.push(a[d])}return c};this.toTinyColor=module$src$shared$util$toTinyColor.default;this.atobUTF8=module$src$shared$util$atobtoa.default.atobUTF8;this.btoaUTF8=module$src$shared$util$atobtoa.default.btoaUTF8;return this};module$src$shared$util$GlobalUtils.default=new GlobalUtils$$module$src$shared$util$GlobalUtils;var module$build$build_data={default:{}};module$build$build_data.default.build_version="2.13.0";module$build$build_data.default.build_date="2019-07-03T09:09:41.128Z";module$build$build_data.default.build_branch="heads/2.13.0";module$build$build_data.default.build_commit="a14e55e59679bbf875d294bbd74ef7b2100b3611";var module$src$api$v2$ApiReflectorV2_1={},GLOBAL_UTILS$$module$src$api$v2$ApiReflectorV2_1=module$src$shared$util$GlobalUtils.default,FUNCTION_PREFIX$$module$src$api$v2$ApiReflectorV2_1="___fn_",INCLUDE_PROTOTYPE$$module$src$api$v2$ApiReflectorV2_1=!1;
module$src$api$v2$ApiReflectorV2_1.default=function(a,b,c,g){if(b.startsWith("http://")){var d=b.substring(7);var f="http://"}else b.startsWith("https://")?(d=b.substring(8),f="https://"):d=null;d&&(b=d.indexOf("/"),0<=b&&(d=d.substring(0,b)),d=f+d);g=g||"sdv-iframe";var p={},e={};"boolean"!==typeof c&&(c=!1);var m=function(b){b.iframeId=g;c&&console.log("POSTING MSG",b);d&&a.postMessage(b,d)},h=function(a){c&&console.log("RECEIVING MSG",a);if(d){var b=a.origin;if(b!==d)c&&console.log("ORIGIN MISMATCH",
b,d);else{var l=a.data;if(l&&"object"===typeof l&&"string"===typeof l.id&&l.iframeId===g&&l.token)if(l.restore)t(l.restore,l.id)?m({id:l.id,token:l.token,result:!0}):m({id:l.id,token:l.token,error:"Restoring object failed"});else if(p.hasOwnProperty(l.id))if(b=p[l.id],l.command){a=module$src$shared$util$GlobalUtils.default.getAtPath(b,l.command);if("function"!==typeof a&&(l.command.endsWith("Async")&&(a=module$src$shared$util$GlobalUtils.default.getAtPath(b,l.command.slice(0,-5))),"function"!==typeof a)){c&&
console.log("Could not find function "+l.id);return}b=Array.isArray(l.arguments)?l.arguments:null;null===b&&"string"===typeof l.arguments_id&&p.hasOwnProperty(l.arguments_id)&&(b=module$src$shared$util$GlobalUtils.default.ObjectToArray(p[l.arguments_id]));c&&console.log("Calling function with arguments",a,b);a=a.apply(null,b);a instanceof Promise?a.then(function(a){a.err&&a.err instanceof Error?m({id:l.id,token:l.token,error:a.err.message}):m({id:l.id,token:l.token,result:a})},function(a){a instanceof
Error?m({id:l.id,token:l.token,error:a.message}):m({id:l.id,token:l.token,error:a})}):m({id:l.id,token:l.token,result:a})}else l.hasOwnProperty("result")?e.hasOwnProperty(l.token)&&(e[l.token].resolve(l.result),delete e[l.token]):l.error&&e.hasOwnProperty(l.token)&&(e[l.token].reject({err:Error(l.error)}),delete e[l.token]);else c&&console.log("Could not find object "+l.id)}}else c&&console.log("NO TARGET ORIGIN TO CHECK AGAINST")},r=function(a,b,c){var d=[],l={};module$src$shared$util$GlobalUtils.default.getPaths(a,
d,"",[],INCLUDE_PROTOTYPE$$module$src$api$v2$ApiReflectorV2_1);c="boolean"===typeof c?c:!1;d.forEach(function(b){var d=module$src$shared$util$GlobalUtils.default.getAtPath(a,b);"function"===typeof d?b.endsWith("Async")||c?module$src$shared$util$GlobalUtils.default.forceAtPath(l,b,FUNCTION_PREFIX$$module$src$api$v2$ApiReflectorV2_1+b):b.endsWith("removeEventListener")||module$src$shared$util$GlobalUtils.default.forceAtPath(l,b+"Async",FUNCTION_PREFIX$$module$src$api$v2$ApiReflectorV2_1+b+"Async"):
module$src$shared$util$GlobalUtils.default.forceAtPath(l,b,d)});p[b]=a;return u({id:b,restore:l})},q=function(a){var b=[];module$src$shared$util$GlobalUtils.default.getPaths(a,b,"",[],INCLUDE_PROTOTYPE$$module$src$api$v2$ApiReflectorV2_1);return!b.every(function(b){return"function"===typeof module$src$shared$util$GlobalUtils.default.getAtPath(a,b)?!1:!0})},t=function(a,b){if(p.hasOwnProperty(b))return null;var c=[],d={};module$src$shared$util$GlobalUtils.default.getPaths(a,c,"",[],INCLUDE_PROTOTYPE$$module$src$api$v2$ApiReflectorV2_1);
c.forEach(function(c){var l=module$src$shared$util$GlobalUtils.default.getAtPath(a,c);"string"===typeof l?l.startsWith(FUNCTION_PREFIX$$module$src$api$v2$ApiReflectorV2_1)?module$src$shared$util$GlobalUtils.default.forceAtPath(d,c,n(b,c)):module$src$shared$util$GlobalUtils.default.forceAtPath(d,c,l):module$src$shared$util$GlobalUtils.default.forceAtPath(d,c,l)});return p[b]=d},u=function(a){var b=module$src$shared$util$GlobalUtils.default.createRandomId();a.token=b;m(a);return new Promise(function(a,
c){e[b]={resolve:a,reject:c}})},n=function(a,b){return function(){var c=Array.prototype.slice.call(arguments),d=module$src$shared$util$GlobalUtils.default.ArrayToObject(c);if(q(d)){console.log("argsobj needs reflection:",d);var l=module$src$shared$util$GlobalUtils.default.createRandomId();return r(d,l,!0).then(function(){return u({id:a,command:b,arguments_id:l})})}return u({id:a,command:b,arguments:c})}};window.addEventListener("message",h,!1);f=function(){};f.prototype.reflect=function(a,b){return r(a,
b)};f.prototype.get=function(a){return p.hasOwnProperty(a)?p[a]:null};f.prototype.destroy=function(){window.removeEventListener("message",h,!1)};f.prototype.receiveMessage=function(a){h(a)};return new f};var module$src$shared$constants$LoggingConstants={},loggingLevels$$module$src$shared$constants$LoggingConstants={NONE:-1,ERROR:0,WARN:1,INFO:2,DEBUG:3,LVLBITS:3,LOG_TO_SERVER:8,ERROR_S:8,WARN_S:9,INFO_S:10,DEBUG_S:11},defaultSettings$$module$src$shared$constants$LoggingConstants={loggingLevel:loggingLevels$$module$src$shared$constants$LoggingConstants.NONE},loggingConstants$$module$src$shared$constants$LoggingConstants={loggingLevels:loggingLevels$$module$src$shared$constants$LoggingConstants,defaultSettings:defaultSettings$$module$src$shared$constants$LoggingConstants},
GlobalUtils$$module$src$shared$constants$LoggingConstants=module$src$shared$util$GlobalUtils.default;module$src$shared$constants$LoggingConstants.default=module$src$shared$util$GlobalUtils.default.deepCopy(loggingConstants$$module$src$shared$constants$LoggingConstants);var module$src$shared$constants$MessagingConstants={},GlobalUtils$$module$src$shared$constants$MessagingConstants=module$src$shared$util$GlobalUtils.default,messageTopics$$module$src$shared$constants$MessagingConstants={AR:"ar",DATA:"data",EXPORT:"export",EXPORT_AVAILABLE:"export.available",EXPORT_REGISTER:"export.register",EXPORT_REGISTERED:"export.registered",EXPORT_UPDATE:"export.update",EXPORT_STATUS:"export.status",PARAMETER:"parameter",PARAMETER_REGISTER:"parameter.register",PARAMETER_REGISTERED:"parameter.registered",
PARAMETER_UPDATE:"parameter.update",PARAMETER_VALUE_UPDATE:"parameter.value.update",PLUGIN:"plugin",PLUGIN_ACTIVE:"plugin.active",PLUGIN_FAILED:"plugin.failed",PLUGIN_LOADED:"plugin.loaded",PLUGIN_REGISTERED:"plugin.registered",PLUGIN_UNLOADED:"plugin.unloaded",PROCESS:"process",SETTINGS:"settings",SETTINGS_REGISTER:"settings.register",SETTINGS_UPDATE:"settings.update",SETTINGS_REGISTERED:"settings.registered",SCENE:"scene",SCENE_ANCHOR:"scene.anchor",SCENE_ANCHOR_ADD:"scene.anchor.add",SCENE_ANCHOR_REMOVE:"scene.anchor.remove",
SCENE_DRAG:"scene.drag",SCENE_DRAG_START:"scene.drag.start",SCENE_DRAG_MOVE:"scene.drag.move",SCENE_DRAG_END:"scene.drag.end",SCENE_HOVER:"scene.hover",SCENE_HOVER_ON:"scene.hover.on",SCENE_HOVER_OVER:"scene.hover.over",SCENE_HOVER_OFF:"scene.hover.off",SCENE_RENDER:"scene.render",SCENE_RENDER_BEAUTY:"scene.render.beauty",SCENE_RENDER_BEAUTY_START:"scene.render.beauty.start",SCENE_RENDER_BEAUTY_CANCEL:"scene.render.beauty.cancel",SCENE_RENDER_BEAUTY_END:"scene.render.beauty.end",SCENE_SELECT:"scene.select",
SCENE_SELECT_ON:"scene.select.on",SCENE_SELECT_OFF:"scene.select.off",SCENE_SUBSCENE:"scene.subscene",SCENE_SUBSCENE_INIT:"scene.subscene.init",SCENE_SUBSCENE_OUTPUTVERSION:"scene.subscene.outputversion",SCENE_SUBSCENE_READY:"scene.subscene.ready",SCENE_SUBSCENE_PUBLISHED:"scene.subscene.published",SCENE_VISIBILITY:"scene.visibility",SCENE_VISIBILITY_ON:"scene.visibility.on",SCENE_VISIBILITY_OFF:"scene.visibility.off",STATUS:"status",STATUS_BUSY:"status.busy",STATUS_IDLE:"status.idle",STATUS_MESSAGE:"status.message",
STATUS_FAILED:"status.failed"},messageDataTypes$$module$src$shared$constants$MessagingConstants={GENERIC:"generic",ANCHOR_CREATE_IMAGE:"anchor.create.image",ANCHOR_UPDATE:"anchor.update",APP_SETTINGS:"app.settings",APP_STATUS:"app.status",DATA:"data",EXPORT_DEFINITION:"export.definition",EXPORT_RESULT:"export.result",EXPORT_STATUS:"export.status",PARAMETER_DEFINITION:"parameter.definition",PARAMETER_UPDATE:"parameter.update",PLUGIN_RUNTIME_ID:"plugin.runtimeId",PROCESS_ERROR:"process.error",PROCESS_ABORT:"process.abort",
PROCESS_FORK:"process.fork",PROCESS_STATUS:"process.status",PROCESS_SUCCESS:"process.success",STATUS_TRACKING:"status.tracking",STATUS_MAPPING:"status.mapping",SCENE_INTERACTION:"scene.interaction",SCENE_ANCHORDATA:"scene.anchordata",SETTINGS_UPDATE:"settings.update",SUBSCENE_UPDATE:"subscene.update",SUBSCENE_OUTPUTVERSION_JSON:"subscene.outputversion.json",SUBSCENE_OUTPUTVERSION_OBJ:"subscene.outputversion.obj",SUBSCENE_INIT:"subscene.init",STATUS_MESSAGE:"status.message"},makeMessageToken$$module$src$shared$constants$MessagingConstants=
function(a,b){var c={};"string"===typeof a?c.id=a+"":null!==a&&"object"===typeof a&&("string"===typeof a.id&&(c.id=a.id+""),"string"===typeof a.creator&&(c.creator=a.creator+""),"number"===typeof a.serial&&(c.serial=a.serial+""),c.payload=a.payload,c.attributes=a.attributes);if("string"!==typeof c.id||0===c.id.length)c.id=module$src$shared$util$GlobalUtils.default.createRandomId();"string"!==typeof c.creator&&"string"===typeof b&&(c.creator=b+"");"number"!==typeof c.serial&&(c.serial=Date.now());
return c},loggingConstants$$module$src$shared$constants$MessagingConstants=module$src$shared$constants$LoggingConstants.default,loggingLevels$$module$src$shared$constants$MessagingConstants=module$src$shared$constants$LoggingConstants.default.loggingLevels,defaultSettings$$module$src$shared$constants$MessagingConstants={messageLoggingLevel:loggingLevels$$module$src$shared$constants$MessagingConstants.NONE},messagingConstants$$module$src$shared$constants$MessagingConstants={messageTopics:messageTopics$$module$src$shared$constants$MessagingConstants,
messageDataTypes:messageDataTypes$$module$src$shared$constants$MessagingConstants,defaultSettings:defaultSettings$$module$src$shared$constants$MessagingConstants};module$src$shared$constants$MessagingConstants.default=module$src$shared$util$GlobalUtils.default.deepCopy(messagingConstants$$module$src$shared$constants$MessagingConstants);module$src$shared$constants$MessagingConstants.default.makeMessageToken=makeMessageToken$$module$src$shared$constants$MessagingConstants;var module$src$app$ViewerAppConstants={},loggingConstants$$module$src$app$ViewerAppConstants=module$src$shared$constants$LoggingConstants.default,loggingLevels$$module$src$app$ViewerAppConstants=module$src$shared$constants$LoggingConstants.default.loggingLevels,messagingConstants$$module$src$app$ViewerAppConstants=module$src$shared$constants$MessagingConstants.default,messageTopics$$module$src$app$ViewerAppConstants=module$src$shared$constants$MessagingConstants.default.messageTopics,messageDataTypes$$module$src$app$ViewerAppConstants=
module$src$shared$constants$MessagingConstants.default.messageDataTypes,DEFAULT_MATERIAL$$module$src$app$ViewerAppConstants={name:"Default material",version:"2.0",bumpAmplitude:1,color:[211,211,211,255],metalness:0,roughness:1},showSceneModes$$module$src$app$ViewerAppConstants={INSTANT:0,ON_SHOW:1,ON_FIRST_PLUGIN:2,ON_ALL_PLUGINS:3},defaultSettings$$module$src$app$ViewerAppConstants={blurSceneWhenBusy:!0,defaultMaterial:DEFAULT_MATERIAL$$module$src$app$ViewerAppConstants,ignoreSuperseded:!0,hasRestoredSettings:!1,
loggingLevel:loggingLevels$$module$src$app$ViewerAppConstants.NONE,messageLoggingLevel:loggingLevels$$module$src$app$ViewerAppConstants.NONE,showMessages:!0,commitParameters:!1,commitSettings:!1,showScene:!1,showSceneMode:showSceneModes$$module$src$app$ViewerAppConstants.ON_FIRST_PLUGIN,showSceneTransition:"1s",strictMode:!1,ar:{enableCameraSync:!1,enableLightingEstimation:!0,enableTouchControls:!0,enableTouchControlRotation:!0,enableAutomaticPlacement:!0,defaultHitTestType:"existingPlaneUsingGeometry"}},
viewerAppConstants$$module$src$app$ViewerAppConstants={loggingLevels:loggingLevels$$module$src$app$ViewerAppConstants,messageTopics:messageTopics$$module$src$app$ViewerAppConstants,messageDataTypes:messageDataTypes$$module$src$app$ViewerAppConstants,showSceneModes:showSceneModes$$module$src$app$ViewerAppConstants,defaultSettings:defaultSettings$$module$src$app$ViewerAppConstants},GlobalUtils$$module$src$app$ViewerAppConstants=module$src$shared$util$GlobalUtils.default;
module$src$app$ViewerAppConstants.default=module$src$shared$util$GlobalUtils.default.deepCopy(viewerAppConstants$$module$src$app$ViewerAppConstants);var module$src$externals$axios={};try{module$src$externals$axios.default=eval("axios")}catch(a){"function"===typeof require&&(module$src$externals$axios.default=eval("require('axios')"))};var module$src$plugins$comm$CommPluginConstants={},baseUrl$$module$src$plugins$comm$CommPluginConstants="https://model-view.shapediver.com:443",defaultSettings$$module$src$plugins$comm$CommPluginConstants={modelViewUrl:baseUrl$$module$src$plugins$comm$CommPluginConstants,ajaxTimeout:3E4,ignoreSuperseded:!0},commPluginConstants$$module$src$plugins$comm$CommPluginConstants={defaultSettings:defaultSettings$$module$src$plugins$comm$CommPluginConstants},GlobalUtils$$module$src$plugins$comm$CommPluginConstants=
module$src$shared$util$GlobalUtils.default;module$src$plugins$comm$CommPluginConstants.default=module$src$shared$util$GlobalUtils.default.deepCopy(commPluginConstants$$module$src$plugins$comm$CommPluginConstants);var module$src$shared$constants$PluginConstantsGlobal={},pluginCapabilities$$module$src$shared$constants$PluginConstantsGlobal={NONE:0,SHAPEDIVER_MODEL_VIEW:1,INTERACTIVE:2,DRAGANDDROP:3,MESSAGECALLBACKS:4,LOGGING:5,SETTINGS:6,DEFAULTPARAM:7},pluginStatuses$$module$src$shared$constants$PluginConstantsGlobal={NONE:"none",READY:"ready",FAILED:"failed",LOADED:"loaded",ACTIVE:"active",UNLOADED:"unloaded"},setParameterResults$$module$src$shared$constants$PluginConstantsGlobal={PARAM_NOT_FOUND:"param_not_found",
NO_VALUE:"no_value",VALUE_REJECT:"value_reject",VALUE_EXISTS:"value_exists",VALUE_OK:"value_ok",PLUGIN_NOT_FOUND:"plugin_not_found",UPLOAD_FAILED:"upload_failed",ERROR:"error",LIVE:"live",CACHE:"cache",LOAD:"load",ABORT:"abort"},requestExportResults$$module$src$shared$constants$PluginConstantsGlobal={EXPORT_NOT_FOUND:"export_not_found",PLUGIN_NOT_FOUND:"plugin_not_found",ERROR:"error",CACHE:"cache",LOAD:"load",ABORT:"abort"},pluginConstants$$module$src$shared$constants$PluginConstantsGlobal={pluginCapabilities:pluginCapabilities$$module$src$shared$constants$PluginConstantsGlobal,
pluginStatuses:pluginStatuses$$module$src$shared$constants$PluginConstantsGlobal,setParameterResults:setParameterResults$$module$src$shared$constants$PluginConstantsGlobal,requestExportResults:requestExportResults$$module$src$shared$constants$PluginConstantsGlobal},GlobalUtils$$module$src$shared$constants$PluginConstantsGlobal=module$src$shared$util$GlobalUtils.default;module$src$shared$constants$PluginConstantsGlobal.default=module$src$shared$util$GlobalUtils.default.deepCopy(pluginConstants$$module$src$shared$constants$PluginConstantsGlobal);var module$src$plugins$PluginConstants={},loggingConstants$$module$src$plugins$PluginConstants=module$src$shared$constants$LoggingConstants.default,loggingLevels$$module$src$plugins$PluginConstants=module$src$shared$constants$LoggingConstants.default.loggingLevels,messagingConstants$$module$src$plugins$PluginConstants=module$src$shared$constants$MessagingConstants.default,messageTopics$$module$src$plugins$PluginConstants=module$src$shared$constants$MessagingConstants.default.messageTopics,messageDataTypes$$module$src$plugins$PluginConstants=
module$src$shared$constants$MessagingConstants.default.messageDataTypes,pluginConstantsGlobal$$module$src$plugins$PluginConstants=module$src$shared$constants$PluginConstantsGlobal.default,defaultSettings$$module$src$plugins$PluginConstants={loggingLevel:loggingLevels$$module$src$plugins$PluginConstants.NONE},pluginConstants$$module$src$plugins$PluginConstants={loggingLevels:loggingLevels$$module$src$plugins$PluginConstants,messageTopics:messageTopics$$module$src$plugins$PluginConstants,messageDataTypes:messageDataTypes$$module$src$plugins$PluginConstants,
pluginCapabilities:module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities,pluginStatuses:module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses,setParameterResults:module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults,requestExportResults:module$src$shared$constants$PluginConstantsGlobal.default.requestExportResults,defaultSettings:defaultSettings$$module$src$plugins$PluginConstants},GlobalUtils$$module$src$plugins$PluginConstants=module$src$shared$util$GlobalUtils.default;
module$src$plugins$PluginConstants.default=module$src$shared$util$GlobalUtils.default.deepCopy(pluginConstants$$module$src$plugins$PluginConstants);var module$src$shared$mixins$GlobalMixin={default:function(){this.jsify=function(a){return JSON.stringify(a,null,0)};return this}};var module$src$shared$messages$MessagePrototype={},GlobalUtils$$module$src$shared$messages$MessagePrototype=module$src$shared$util$GlobalUtils.default;
module$src$shared$messages$MessagePrototype.default=function(a,b,c){var g=this;this.origin={};this.parts=[];this.addPart=function(a,b){void 0!==a&&g.parts.push({type:a,data:b})};this.addPart(a,b);this.getPartsByType=function(a){return g.parts.filter(function(b){return b.type===a})};this.getUniquePartByType=function(a){a=g.getPartsByType(a);if(1===a.length)return a[0]};this.token={};"string"===typeof c&&0<c.length?this.token={id:c}:null!==c&&"object"===typeof c&&"string"===typeof c.id&&0<c.id.length?
this.token=c:this.token.id=module$src$shared$util$GlobalUtils.default.createRandomId();if(void 0===this.token.serial||"number"!==typeof this.token.serial)this.token.serial=Date.now();this.date=Date.now();return this};var module$src$shared$mixins$SettingsMixin={},GlobalUtils$$module$src$shared$mixins$SettingsMixin=module$src$shared$util$GlobalUtils.default,MessagePrototype$$module$src$shared$mixins$SettingsMixin=module$src$shared$messages$MessagePrototype.default,messagingConstants$$module$src$shared$mixins$SettingsMixin=module$src$shared$constants$MessagingConstants.default;
module$src$shared$mixins$SettingsMixin.default=function(a,b,c){var g=this,d="function"===typeof g.warn?g.warn:function(){};if(void 0===a||"object"!==typeof a)a={};if(void 0===b||"object"!==typeof b)b={};var f=module$src$shared$util$GlobalUtils.default.deepCopy(a);module$src$shared$util$GlobalUtils.default.defaults(f,b);this.getSettings=function(a){if(void 0===a||!Array.isArray(a))return module$src$shared$util$GlobalUtils.default.deepCopy(f);var b={};a.forEach(function(a){g.hasSetting(a)&&module$src$shared$util$GlobalUtils.default.forceAtPath(b,
a,g.getSetting(a))});return b};this.getSetting=function(a){return module$src$shared$util$GlobalUtils.default.deepCopy(module$src$shared$util$GlobalUtils.default.getAtPath(f,a))};this.getSettingShallow=function(a){return module$src$shared$util$GlobalUtils.default.getAtPath(f,a)};this.hasSetting=function(a){return void 0!==module$src$shared$util$GlobalUtils.default.getAtPath(f,a)};var p={},e=0;this.registerHook=function(a,b){a||(a=".*");if("string"===typeof a)a.startsWith("^")||(a="^"+a),a.endsWith("$")||
(a+="$"),a=RegExp(a);else if(!(a instanceof RegExp))return;if("function"===typeof b){var c=e;p[e++]={r:a,cb:b};return c}};this.deregisterHook=function(a){if(!p.hasOwnProperty(a))return!1;delete p[a];return!0};this.deregisterAllHooks=function(){for(var a in p)delete p[a];return!0};var m={},h=0;this.registerNotifier=function(a,b){a||(a=".*");if("string"===typeof a)a.startsWith("^")||(a="^"+a),a.endsWith("$")||(a+="$"),a=RegExp(a);else if(!(a instanceof RegExp))return;if("function"===typeof b){var c=
h;m[h++]={r:a,cb:b};return c}};this.deregisterNotifier=function(a){if(!m.hasOwnProperty(a))return!1;delete m[a];return!0};this.deregisterAllNotifiers=function(){for(var a in m)delete m[a];return!0};this.updateSetting=function(a,b){if(!Object.keys(p).every(function(c){c=p[c];if(!c.r.test(a))return!0;c=c.cb(b,a);c instanceof Promise&&d("SettingsMixin.updateSetting","A hook for "+a+" returned a Promise, which is always a truthy value, use SettingsMixin.updateSettingAsync instead for updates to this key");
return c}))return!1;var c=g.getSetting(a);module$src$shared$util$GlobalUtils.default.forceAtPath(f,a,module$src$shared$util$GlobalUtils.default.deepCopy(b));Object.keys(m).forEach(function(e){e=m[e];if(e.r.test(a))try{e.cb(a,c,b)}catch(n){d("SettingsMixin.updateSetting","A notifier for setting "+e.r.toString()+" threw an exception",n)}});return!0};this.updateSettingAsync=function(a,b){var c=[];return Object.keys(p).every(function(d){d=p[d];if(!d.r.test(a))return!0;d=d.cb(b,a);return d instanceof Promise?
(c.push(d),!0):d})?Promise.all(c).then(function(c){if(c.every(function(a){return a})){var n=g.getSetting(a);module$src$shared$util$GlobalUtils.default.forceAtPath(f,a,module$src$shared$util$GlobalUtils.default.deepCopy(b));Object.keys(m).forEach(function(c){c=m[c];if(c.r.test(a))try{c.cb(a,n,b)}catch(v){d("SettingsMixin.updateSettingAsync","A notifier for setting "+c.r.toString()+" threw an exception",v)}});return!0}return!1},function(){return!1}):Promise.resolve(!1)};this.updateSettings=function(a,
b){"boolean"!==typeof b&&(b=!1);var c=!0;if(void 0===a||"object"!==typeof a)return c;var d=[];module$src$shared$util$GlobalUtils.default.getPaths(a,d);d.forEach(function(d){b&&g.hasSetting(d)||g.updateSetting(d,module$src$shared$util$GlobalUtils.default.getAtPath(a,d))||(c=!1)});return c};this.updateSettingsAsync=function(){d("SettingsMixin.updateSettingsAsync","to be implemented");return Promise.reject(Error("SettingsMixin.updateSettingsAsyncto be implemented"))};this.isSettingPersistent=function(){return!1};
this.getSection=function(a){var b=g.getSettingShallow(a);return void 0===b||"object"!==typeof b?!1:{getSettings:function(b){if(void 0===b||!Array.isArray(b))return b=g.getSettings([a]),module$src$shared$util$GlobalUtils.default.getAtPath(b,a);b=module$src$shared$util$GlobalUtils.default.deepCopy(b);for(var c=0;c<b.length;c++)b[c]=a+"."+b[c];return g.getSettings(b)},getSetting:function(b){return g.getSetting(a+"."+b)},getSettingShallow:function(b){return g.getSettingShallow(a+"."+b)},hasSetting:function(b){return g.hasSetting(a+
"."+b)},registerHook:function(b,c){if("string"!==typeof b)return!1;b.startsWith("^")&&(b=b.substring(1));var d=a.length+1;return g.registerHook(a+"."+b,function(a,b){return c(a,b.substring(d))})},deregisterHook:function(a){return g.deregisterHook(a)},registerNotifier:function(b,c){if("string"!==typeof b)return!1;b.startsWith("^")&&(b=b.substring(1));var d=a.length+1;return g.registerNotifier(a+"."+b,function(a,b,n){return c(a.substring(d),b,n)})},deregisterNotifier:function(a){return g.deregisterNotifier(a)},
updateSetting:function(b,c){return g.updateSetting(a+"."+b,c)},updateSettingAsync:function(b,c){return g.updateSettingAsync(a+"."+b,c)},updateSettings:function(b,c){"boolean"!==typeof c&&(c=!1);var d=!0;if(void 0===b||"object"!==typeof b)return d;var l=[];module$src$shared$util$GlobalUtils.default.getPaths(b,l);l.forEach(function(l){var n=a+"."+l;c&&g.hasSetting(n)||g.updateSetting(n,module$src$shared$util$GlobalUtils.default.getAtPath(b,l))||(d=!1)});return d},updateSettingsAsync:function(){d("SettingsMixin.updateSettingsAsync",
"to be implemented");return Promise.reject(Error("SettingsMixin.updateSettingsAsyncto be implemented"))},isSettingPersistent:function(b){return g.isSettingPersistent(a+"."+b)},getSection:function(b){return g.getSection(a+"."+b)}}};module$src$shared$util$GlobalUtils.default.typeCheck(c,"string")&&g.registerNotifier("",function(a,b,d){a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SETTINGS_UPDATE,{key:a,valueNew:d,valueOld:b,
namespace:c});g.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SETTINGS_UPDATE,a)});return this};var module$src$shared$mixins$LoggingMixin={},loggingConstants$$module$src$shared$mixins$LoggingMixin=module$src$shared$constants$LoggingConstants.default;
module$src$shared$mixins$LoggingMixin.default=function(){var a=this;this.getLoggingLevelName=function(a){var b=a.toString();Object.keys(module$src$shared$constants$LoggingConstants.default.loggingLevels).every(function(c){return module$src$shared$constants$LoggingConstants.default.loggingLevels[c]===a?(b=c,!1):!0});return b};this.logToConsole=function(){var a=1===arguments.length?[arguments[0]]:Array.apply(null,arguments),c=a[0]&module$src$shared$constants$LoggingConstants.default.loggingLevels.LVLBITS,
g=a[1];a=a.slice(2);c===module$src$shared$constants$LoggingConstants.default.loggingLevels.ERROR?console.error.apply(console,["ERROR."+g,":"].concat($jscomp.arrayFromIterable(a))):c===module$src$shared$constants$LoggingConstants.default.loggingLevels.WARN?console.warn.apply(console,["WARN."+g,":"].concat($jscomp.arrayFromIterable(a))):c===module$src$shared$constants$LoggingConstants.default.loggingLevels.INFO?console.log.apply(console,["INFO."+g,":"].concat($jscomp.arrayFromIterable(a))):c===module$src$shared$constants$LoggingConstants.default.loggingLevels.DEBUG?
console.log.apply(console,["DEBUG."+g,":"].concat($jscomp.arrayFromIterable(a))):console.log.apply(console,["UNKNOWN."+g,":"].concat($jscomp.arrayFromIterable(a)))};this.log=function(){(arguments[0]&module$src$shared$constants$LoggingConstants.default.loggingLevels.LVLBITS)<=a.getLoggingLevel()&&a.logToConsole.apply(a,arguments)};this.error=function(){a.log.apply(a,[module$src$shared$constants$LoggingConstants.default.loggingLevels.ERROR].concat($jscomp.arrayFromIterable(arguments)))};this.warn=function(){a.log.apply(a,
[module$src$shared$constants$LoggingConstants.default.loggingLevels.WARN].concat($jscomp.arrayFromIterable(arguments)))};this.info=function(){a.log.apply(a,[module$src$shared$constants$LoggingConstants.default.loggingLevels.INFO].concat($jscomp.arrayFromIterable(arguments)))};this.debug=function(){a.log.apply(a,[module$src$shared$constants$LoggingConstants.default.loggingLevels.DEBUG].concat($jscomp.arrayFromIterable(arguments)))};this.setLoggingLevel=function(b){return a.updateSetting("loggingLevel",
b)};this.getLoggingLevel=function(){return a.getSetting("loggingLevel")};return this};var module$src$shared$mixins$MessagingMixin={},messagingConstants$$module$src$shared$mixins$MessagingMixin=module$src$shared$constants$MessagingConstants.default,loggingConstants$$module$src$shared$mixins$MessagingMixin=module$src$shared$constants$LoggingConstants.default;
module$src$shared$mixins$MessagingMixin.default=function(){var a=this;this.messageToLog=function(b,c){var g=a.getSetting("messageLoggingLevel");g!==module$src$shared$constants$LoggingConstants.default.loggingLevels.NONE&&a.log(g,b,c)};this.messageToPubSub=function(a,c,g,d){d&&"string"===typeof d.prefix&&(a=d.prefix.concat(".",a));d&&"string"===typeof d.postfix&&(a=a.concat(".",d.postfix));g.publish(a,c)};this.message=function(b,c){a.messageToLog(b,c)};this.hasSetting("messageLoggingLevel")||a.updateSetting("messageLoggingLevel",
module$src$shared$constants$MessagingConstants.default.defaultSettings.messageLoggingLevel);return this};var module$src$externals$expo_three={default:null};var module$src$externals$expo_asset_utils={default:null};var module$src$shared$util$stringChecksum={default:function(a){var b=0,c=a.length,g;if(0===c)return b;for(g=0;g<c;g++){var d=a.charCodeAt(g);b=(b<<5)-b+d;b&=b}return b}};var module$src$shared$util$getImageBase64={},AXIOS$$module$src$shared$util$getImageBase64=module$src$externals$axios.default,_converterEngine$$module$src$shared$util$getImageBase64=function(a){a=new Uint8Array(a);for(var b=a.length,c=[];b--;)c[b]=String.fromCharCode(a[b]);return window.btoa(c.join(""))};
module$src$shared$util$getImageBase64.default=function(a){return(0,module$src$externals$axios.default)({method:"GET",url:a,responseType:"arraybuffer"}).then(function(a){var b=_converterEngine$$module$src$shared$util$getImageBase64(a.data);return Promise.resolve({data:b,contentType:a.headers["content-type"]})})};var module$src$shared$singletons$TextureLoader={},AXIOS$$module$src$shared$singletons$TextureLoader=module$src$externals$axios.default,THREE$$module$src$shared$singletons$TextureLoader=module$src$externals$three.default,EXPOTHREE$$module$src$shared$singletons$TextureLoader=module$src$externals$expo_three.default,EXPOASSETUTILS$$module$src$shared$singletons$TextureLoader=module$src$externals$expo_asset_utils.default,ATOBTOA$$module$src$shared$singletons$TextureLoader=module$src$shared$util$atobtoa.default,
textureCache$$module$src$shared$singletons$TextureLoader={},TextureLoader$$module$src$shared$singletons$TextureLoader=function(){this.loadTexture=function(b,c){return window&&window.navigator&&-1!==window.navigator.userAgent.indexOf("Safari")&&-1===window.navigator.userAgent.indexOf("Chrome")?a(b,c).then(function(){return a(b,c)}):a(b,c)};var a=function(a,c){c=c||{};var b=function(a){a.wrapS=module$src$externals$three.default.RepeatWrapping;a.wrapT=module$src$externals$three.default.RepeatWrapping;
var b=c.offset||[0,0];a.offset=new module$src$externals$three.default.Vector2(b[0],b[1]);b=c.repeat||[1,1];a.repeat=new module$src$externals$three.default.Vector2(b[0],b[1]);a.rotation=c.rotation||0;b=c.center||[0,0];a.center=new module$src$externals$three.default.Vector2(b[0],b[1]);a.uvTransform=new module$src$externals$three.default.Matrix3;a.uvTransform.identity().translate(-a.center.x,-a.center.y).rotate(a.rotation).scale(a.repeat.x,a.repeat.y).translate(a.center.x,a.center.y).translate(a.offset.x,
a.offset.y);a.needsUpdate=!0;return a};if("object"===typeof a&&null!==a&&1===a.nodeType&&"string"===typeof a.nodeName&&"CANVAS"===a.nodeName.toUpperCase()){var d=new module$src$externals$three.default.Texture(a);d.SDCanvasTexture=!0;"function"!==typeof a._addTexture&&function(){var b=[];a._addTexture=function(a){return b.push(a)};Object.defineProperty(a,"needsUpdate",{set:function(a){return a&&b.forEach(function(a){return a.needsUpdate=!0})}})}();a._addTexture(d);return Promise.resolve(b(d))}if("string"!==
typeof a)return Promise.reject(Error("Input is not a string"));var f="_"+(0,module$src$shared$util$stringChecksum.default)(a);if(textureCache$$module$src$shared$singletons$TextureLoader.hasOwnProperty(f))return textureCache$$module$src$shared$singletons$TextureLoader[f].then(function(a){var c=a.clone();module$src$externals$expo_three.default&&module$src$externals$expo_asset_utils.default&&a.isDataTexture&&!c.isDataTexture&&(c.isDataTexture=!0);return b(c)});var p=null,e=null,m=null,h=null;textureCache$$module$src$shared$singletons$TextureLoader[f]=
Promise.resolve().then(function(){if("data:"==a.substring(0,5))return h=!0,p=a.substring(a.indexOf(":")+1,a.indexOf(";")),m=-1!==a.indexOf("base64"),e=a.substring(a.indexOf(",")+1),Promise.resolve();h=!1;return module$src$externals$axios.default.get(a).then(function(a){p=a.headers["content-type"];-1<p.indexOf(";")&&(p=p.substr(0,p.indexOf(";")));e=a.data;m=!1;return Promise.resolve()},function(a){a.scope="TextureLoader._loadTexture";a.msg=a.response?"Loading texture failed with HTTP status code "+
a.response.status:a.request?"Loading texture failed, no response from the server":"Loading texture failed, unknown error";return Promise.reject(a)})}).then(function(){var b,c;if(["image/jpeg","image/png","image/gif","image/bmp"].includes(p))return new Promise(function(b,c){if(module$src$externals$expo_three.default&&module$src$externals$expo_asset_utils.default){var d=p.split("/")[1].replace("e","");module$src$externals$expo_asset_utils.default.resolveAsync(a,{fileName:"H"+f.toString()+"."+d}).then(function(a){module$src$externals$expo_three.default.loadTextureAsync({asset:a}).then(function(a){a.minFilter=
module$src$externals$three.default.LinearFilter;b(a)},function(a){a.scope="TextureLoader._loadTexture";a.msg="EXPOTHREE.loadAsync failed";c(a)})},function(a){a.scope="TextureLoader._loadTexture";a.msg="EXPOASSETUTILS.resolveAsync failed";c(a)})}else(new module$src$externals$three.default.TextureLoader).load(a,function(a){b(a)},function(){},function(a){a.scope="TextureLoader._loadTexture";a.msg="Texture file loading failed";c(a)})});if("image/svg+xml"===p){if(window&&window.navigator&&window.navigator.userAgent&&
0<window.navigator.userAgent.indexOf("Trident/")){var d=Error("SVG textures not supported by Internet Explorer 11. Skipping the texture.");d.scope="TextureLoader._loadTexture";return Promise.reject(d)}var g=null;h?m?g=module$src$shared$util$atobtoa.default.atobUTF8(e):(g=e,g=(" "+g).slice(1)):g=e;d=document.createElement("DIV");d.id="svgc";d.innerHTML=g;var n=d.getElementsByTagName("svg"),l=[],v=[];for(d=0;d<n.length;++d){for(b=0;2>b;++b){var x=n[d].getElementsByTagName(["image","img"][b]);for(c=
0;c<x.length;++c)"data:"!=x[c].href.baseVal.substring(0,5)&&l.push(x[c].href.baseVal)}c=n[d].getElementsByTagName("style");for(b=0;b<c.length;++b){x=/@import\x20url\(\s*(.*?)\s*\);/g;for(var w=void 0;null!==(w=x.exec(c[b].innerHTML));)v.push(w[1]);v=v.filter(function(a,b,c){return c.indexOf(a)===b})}}n=[];x=function(a){return new Promise(function(b,c){0<l[a].length?(0,module$src$shared$util$getImageBase64.default)(l[a]).then(function(c){g=g.replace(l[a],"data:"+c.contentType+";base64,"+c.data);b()}).catch(function(a){c(a)}):
b()})};for(d=0;d<l.length;++d)c=x(d),n.push(c);x=function(c){return new Promise(function(d,l){module$src$externals$axios.default.get(c).then(function(a){return a.data}).then(function(n){for(var e=[],h=/url\(\s*(.*?)\s*\)/g,f;null!==(f=h.exec(n));)e.push(f[1]);h=[];f=function(a){return new Promise(function(b,c){(0,module$src$shared$util$getImageBase64.default)(a).then(function(c){c="data:"+c.contentType+";base64,"+c.data;0<a.length&&(n=n.replace(a,c));b()}).catch(function(){c(Error("Error converting "+
a+" to base64"))})})};for(b=0;b<e.length;++b)h.push(f(e[b]));return Promise.all(h).then(function(){return n}).then(function(b){0<a.length&&(g=g.replace("@import url("+c+");",b));d()}).catch(function(){l(Error("Error converting CSS string."))})})})};for(d=0;d<v.length;++d)c=x(v[d]),n.push(c);return Promise.all(n).then(function(){return new Promise(function(a,b){var c="data:image/svg+xml,"+encodeURIComponent(g),d=document.createElement("canvas");d.width=2048;d.height=2048;var l=d.getContext("2d"),n=
new Image;n.onload=function(){l.drawImage(n,0,0,2048,2048);var b=new module$src$externals$three.default.Texture(d);a(b)};n.onerror=function(a){b(a)};n.crossOrigin="Anonymous";n.src=c})})}return Promise.reject(Error("Unkonwn content-type "+p+" when downloading "+a))});return textureCache$$module$src$shared$singletons$TextureLoader[f].then(function(a){var c=a.clone();module$src$externals$expo_three.default&&module$src$externals$expo_asset_utils.default&&a.isDataTexture&&!c.isDataTexture&&(c.isDataTexture=
!0);return b(c)})}};module$src$shared$singletons$TextureLoader.default=new TextureLoader$$module$src$shared$singletons$TextureLoader;var module$src$plugins$PluginPrototype={},pluginConstants$$module$src$plugins$PluginPrototype=module$src$plugins$PluginConstants.default,GlobalUtils$$module$src$plugins$PluginPrototype=module$src$shared$util$GlobalUtils.default,GlobalMixin$$module$src$plugins$PluginPrototype=module$src$shared$mixins$GlobalMixin.default,SettingsMixin$$module$src$plugins$PluginPrototype=module$src$shared$mixins$SettingsMixin.default,LoggingMixin$$module$src$plugins$PluginPrototype=module$src$shared$mixins$LoggingMixin.default,
MessagingMixin$$module$src$plugins$PluginPrototype=module$src$shared$mixins$MessagingMixin.default,MessagePrototype$$module$src$plugins$PluginPrototype=module$src$shared$messages$MessagePrototype.default,TextureLoader$$module$src$plugins$PluginPrototype=module$src$shared$singletons$TextureLoader.default,THREE$$module$src$plugins$PluginPrototype=module$src$externals$three.default;
module$src$plugins$PluginPrototype.default=function(a){var b=this;this.pluginConstants=module$src$plugins$PluginConstants.default;this.GlobalUtils=module$src$shared$util$GlobalUtils.default;this.MessagePrototype=module$src$shared$messages$MessagePrototype.default;b.TextureLoader=module$src$shared$singletons$TextureLoader.default;b.THREE=module$src$externals$three.default;module$src$shared$mixins$GlobalMixin.default.call(this);if(void 0===a.runtimeId||"string"!==typeof a.runtimeId)a.runtimeId=module$src$shared$util$GlobalUtils.default.createRandomId();
module$src$shared$mixins$SettingsMixin.default.call(this,a,b.pluginConstants.defaultSettings);this.registerHook("runtimeId",function(){return!1});module$src$shared$mixins$LoggingMixin.default.call(this);module$src$shared$mixins$MessagingMixin.default.call(this);this.getRuntimeId=function(){return b.getSetting("runtimeId")};this.load=function(a){b.updateSettings(a);return!0};this.getStatus=function(){};this.setStatus=function(){};(function(){var a=b.pluginConstants.pluginStatuses.READY;b.getStatus=
function(){return module$src$shared$util$GlobalUtils.default.deepCopy(a)};b.setStatus=function(c){if(a!==c){var d=b.pluginConstants.messageTopics.PLUGIN_FAILED;c===b.pluginConstants.pluginStatuses.FAILED?d=b.pluginConstants.messageTopics.PLUGIN_FAILED:c===b.pluginConstants.pluginStatuses.LOADED?d=b.pluginConstants.messageTopics.PLUGIN_LOADED:c===b.pluginConstants.pluginStatuses.ACTIVE?d=b.pluginConstants.messageTopics.PLUGIN_ACTIVE:c===b.pluginConstants.pluginStatuses.UNLOADED&&(d=b.pluginConstants.messageTopics.PLUGIN_UNLOADED);
var g=new module$src$shared$messages$MessagePrototype.default(b.pluginConstants.messageDataTypes.PLUGIN_RUNTIME_ID,b.getRuntimeId());b.message(d,g);a=c}}}).call(this);this.getStatusDescription=function(){return{id:b.getRuntimeId(),status:b.getStatus(),name:b.getName(),shortName:b.getShortName()}};return this};var module$src$plugins$comm$CommPlugin={},axios$$module$src$plugins$comm$CommPlugin=module$src$externals$axios.default,commPluginConstants$$module$src$plugins$comm$CommPlugin=module$src$plugins$comm$CommPluginConstants.default,pluginConstantsGlobal$$module$src$plugins$comm$CommPlugin=module$src$shared$constants$PluginConstantsGlobal.default,pluginPrototype$$module$src$plugins$comm$CommPlugin=module$src$plugins$PluginPrototype.default,messagingConstants$$module$src$plugins$comm$CommPlugin=module$src$shared$constants$MessagingConstants.default,
loggingConstants$$module$src$plugins$comm$CommPlugin=module$src$shared$constants$LoggingConstants.default,GlobalUtils$$module$src$plugins$comm$CommPlugin=module$src$shared$util$GlobalUtils.default,MessagePrototype$$module$src$plugins$comm$CommPlugin=module$src$shared$messages$MessagePrototype.default;
module$src$plugins$comm$CommPlugin.default=function(a){var b=this;"string"===typeof a.modelViewUrl&&0<a.modelViewUrl.length&&("eu-central-1"===a.modelViewUrl?a.modelViewUrl="https://sdeuc1.eu-central-1.shapediver.com":"us-east-1"===a.modelViewUrl?a.modelViewUrl="https://model-view.shapediver.com":"us-east-1-test"===a.modelViewUrl?a.modelViewUrl="https://sdtest.us-east-1.shapediver.com":a.modelViewUrl.startsWith("http")||(a.modelViewUrl="https://"+a.modelViewUrl));module$src$plugins$PluginPrototype.default.call(this,
module$src$shared$util$GlobalUtils.default.inject(module$src$plugins$comm$CommPluginConstants.default.defaultSettings,module$src$shared$util$GlobalUtils.default.deepCopy(a),!1));var c=module$src$externals$axios.default.create({timeout:b.getSettingShallow("ajaxTimeout")});b.getSettingShallow("authorization")&&(c.defaults.headers.common.Authorization=b.getSetting("authorization"));if(this.hasSetting("ticket")){var g={},d=[module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities.SHAPEDIVER_MODEL_VIEW],
f={},p=function(a,c){return(new l(a)).then(function(a){if(a.hasOwnProperty("msg")){var d=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE,{message:a.msg,scope:"Customization reply",messageLevel:module$src$shared$constants$LoggingConstants.default.loggingLevels.ERROR});b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_MESSAGE,d)}if(!a.hasOwnProperty("outputs"))return Promise.reject("Invalid customization reply");
var l=Object.keys(a.outputs);d=[];var n=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_INIT,l.length,c);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_INIT,n);n=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{state:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_INIT,
progress:.25},c);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,n);n={};l=$jscomp.makeIterator(l);for(var e=l.next();!e.done;n={outputId:n.outputId},e=l.next())n.outputId=e.value,e=(new Promise(function(d){return function(l,n){var e=a.outputs[d.outputId];if(e.hasOwnProperty("content"))l(e);else{var h=e.version;f[d.outputId]=h;var g=function(){return t(d.outputId,h).then(function(a){if(b.getSettingShallow("ignoreSuperseded")&&f[d.outputId]!==h)a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT,
"Subscene obsolete because of newer request",c),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,a),l();else{if(a.hasOwnProperty("msg")){var e=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE,{message:a.msg,scope:"Cache reply",messageLevel:module$src$shared$constants$LoggingConstants.default.loggingLevels.WARN});b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_MESSAGE,
e)}a.hasOwnProperty("outputs")&&a.outputs.hasOwnProperty(d.outputId)?(a=a.outputs[d.outputId],a.hasOwnProperty("version")&&a.version===h?a.hasOwnProperty("delay")?setTimeout(function(){g()},Math.max(100,parseInt(a.delay))):a.hasOwnProperty("content")?(a.id=d.outputId,l(a)):n(Error("No content nor delay in cache reply")):n(Error("Invalid cache reply"))):n(Error("Invalid cache reply"))}})};g()}}}(n))).then(function(a){return function(d){if(d){d.id=a.outputId;if(d.hasOwnProperty("msg")){var l=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE,
{message:d.msg,scope:"Output",messageLevel:module$src$shared$constants$LoggingConstants.default.loggingLevels.WARN});b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_MESSAGE,l)}l=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_OUTPUTVERSION_JSON,d,c);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_OUTPUTVERSION,l);return d}}}(n)),
d.push(e);return Promise.all(d)})},e=function(a,c,d){var l=function(c){if(!c.hasOwnProperty("exports")||!c.exports.hasOwnProperty(a))return Promise.reject("Unexpected reply to export request");var e=c.exports[a];if(!e.hasOwnProperty("delay"))return e;c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{data:e},d);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,c);c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_STATUS,
e,d);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_STATUS,c);return module$src$shared$util$GlobalUtils.default.waitForTimeout(Math.max(1E3,parseInt(e.delay))).then(function(){return n(a,e.version).then(l)})};return u(a,c).then(l)},m=function(){return q().then(function(a){b.debug("CommPlugin.initSession","Received session init reply",a);if(a.hasOwnProperty("msg")){var c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE,
{message:a.msg,scope:"Session init",messageLevel:module$src$shared$constants$LoggingConstants.default.loggingLevels.ERROR});b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_MESSAGE,c)}a.hasOwnProperty("config")&&(c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.APP_SETTINGS,a.config),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SETTINGS_REGISTER,c));
a.hasOwnProperty("parameters")&&(c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_DEFINITION,a.parameters),a.hasOwnProperty("config")&&c.addPart(module$src$shared$constants$MessagingConstants.default.messageDataTypes.APP_SETTINGS,a.config),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PARAMETER_REGISTER,c));a.hasOwnProperty("exports")&&(c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_DEFINITION,
a.exports),a.hasOwnProperty("config")&&c.addPart(module$src$shared$constants$MessagingConstants.default.messageDataTypes.APP_SETTINGS,a.config),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_REGISTER,c));b.getStatus()!==module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.ACTIVE&&b.setStatus(module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.ACTIVE)}).catch(function(a){b.error("CommPlugin.initSession","Session init failed",
a);b.setStatus(module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.FAILED);a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE,{messageScope:a.serverMessage||"Session initialisation failed"});b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_FAILED,a)})},h=null,r=function(a,d,l,n){var e={method:d,url:a,headers:{}};l&&(e.data=l);e.headers["X-ShapeDiver-Origin"]=
module$src$shared$util$GlobalUtils.default.embeddingOrigin();n&&(e.headers["Content-Type"]=n);b.getSettingShallow("authorization")&&(e.headers.Authorization=b.getSetting("authorization"));return c(e).then(function(a){a=a.data;if(a.hasOwnProperty("actions")){a.actions.forEach(function(a){a.hasOwnProperty("method")&&a.hasOwnProperty("href")&&a.hasOwnProperty("name")&&(g[a.name]=a)});if(g.hasOwnProperty("default")){var c=g.default.href.replace("/default","");c!==h&&(h=c,b.debug("CommPlugin.modelViewAjax",
"Setting base URL to",h))}delete a.actions}a.hasOwnProperty("templates")&&delete a.templates;return a},function(c){if(c.response){var e="",g="",f=c.response.data;switch(c.response.status){case 400:e="Bad request";break;case 401:e="Unauthorized";break;case 403:e="Forbidden";break;case 410:return g=module$src$shared$util$GlobalUtils.default.deepCopy(h),q().then(function(){var b=a.replace(g,h);return r(b,d,l,n)},function(a){b.setStatus(module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.FAILED);
var c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE,{messageScope:a.serverMessage||"Session initialisation failed"});b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_FAILED,c);return Promise.reject(a)});case 413:e="Payload too large";break;case 500:e="Internal server error";break;default:e="Communication failed with HTTP status"}var m="Request error: "+e+" ("+c.response.status+
")";e=Error(e);f&&f.message&&(e.serverMessage=f.message,m+=", "+f.message);b.error("CommPlugin.modelViewAjax",m,c);return Promise.reject(e)}if(c.request)return b.error("CommPlugin.modelViewAjax","Request error (no response)",c),Promise.reject(Error("Request error (no response)"));b.error("CommPlugin.modelViewAjax","Request error (unknown)",c);return Promise.reject(Error("Request error (unknown)"))})},q=function(){var a=b.getSettingShallow("modelViewUrl");return a?r(a+"/ticket/"+b.getSettingShallow("ticket"),
"POST"):Promise.reject(Error("Base url not defined."))},t=function(a,b){return new Promise(function(c,d){g.hasOwnProperty("cache")&&g.cache.hasOwnProperty("method")&&g.cache.hasOwnProperty("href")?(d={},d[a]=b,c(r(g.cache.href,g.cache.method,d,"application/json"))):d(Error('Action "cache" is missing'))})},u=function(a,b){return new Promise(function(c,d){g.hasOwnProperty("export")&&g.export.hasOwnProperty("method")&&g.export.hasOwnProperty("href")||d(Error('Action "export" is missing'));c(r(g.export.href,
g.export.method,{exports:{id:a},parameters:b},"application/json"))})},n=function(a,b){return new Promise(function(c,d){g.hasOwnProperty("export-cache")&&g["export-cache"].hasOwnProperty("method")&&g["export-cache"].hasOwnProperty("href")?(d={},d[a]=b,c(r(g["export-cache"].href,g["export-cache"].method,d,"application/json"))):d(Error('Action "export-cache" is missing'))})},l=function(a){return new Promise(function(b,c){g.hasOwnProperty("customize")&&g.customize.hasOwnProperty("method")&&g.customize.hasOwnProperty("href")||
c(Error('Action "customize" is missing'));b(r(g.customize.href,g.customize.method,a,"application/json"))})};this.getName=function(){return"ShapeDiver Communications Plugin"};this.getShortName=function(){return"CommPlugin"};this.getCapabilities=function(){var a=module$src$shared$util$GlobalUtils.default.deepCopy(d);g.hasOwnProperty("log")&&a.push(module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities.LOGGING);g.hasOwnProperty("configure")&&a.push(module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities.SETTINGS);
g.hasOwnProperty("defaultparam")&&a.push(module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities.DEFAULTPARAM);return a};this.getMessageCallbacks=function(){return{}};this.load=function(a){b.updateSettings(a);m();b.debug("CommPlugin.load",'Loaded plugin "'+b.getName()+'" with capabilities '+JSON.stringify(b.getCapabilities())+" and runtime id "+b.getRuntimeId());b.setStatus(module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.LOADED);return!0};this.logToServer=
function(){var a=1===arguments.length?[arguments[0]]:Array.apply(null,arguments),c=a[0]&module$src$shared$constants$LoggingConstants.default.loggingLevels.LVLBITS,d=a[1],l=a.slice(2);0<l.length&&"string"===typeof l[0]&&(d+=": "+l[0],l=l.slice(1));return new Promise(function(a,n){g.hasOwnProperty("log")&&g.log.hasOwnProperty("method")&&g.log.hasOwnProperty("href")||n(Error("CommPlugin.logToServer: Session did not provide log action"));var e={level:2-Math.max(Math.min(c,2),0),message:d};1===l.length?
e.err=l[0]:1<l.length&&(e.err={messages:l});r(g.log.href,g.log.method,e,"application/json").then(function(b){a(b)},function(a){a="CommPlugin.logToServer: Log message rejected by server "+b.jsify(a);n(Error(a))})})};this.setParameterValue=function(){b.warn("CommPlugin.setParameterValue","Not supported");return module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.ERROR};this.setMultipleParameterValues=function(){b.warn("CommPlugin.setMultipleParameterValues","Not supported");
return module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.ERROR};this.setAllParameterValues=function(a,c){if(b.getStatus()!==module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.ACTIVE)return a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,"Plugin not active",c),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,a),module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.ERROR;
p(a,c).catch(function(a){a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,a,c);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,a)});return module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.LOAD};this.fileUpload=function(a){if(!g.hasOwnProperty("upload"))throw Error("CommPlugin.fileUpload: no upload action");return r(g.upload.href,g.upload.method,
a.request,"application/json").then(function(b){var d={},l=[],n;for(n in a.data){var e=b[n];if(!e||!module$src$shared$util$GlobalUtils.default.typeCheck(e.id,"string")||!module$src$shared$util$GlobalUtils.default.typeCheck(e.href,"string"))throw Error("CommPlugin.fileUpload: invalid response");d[n]=e.id;e={method:"PUT",url:e.href,data:a.data[n],headers:{},transformRequest:[function(a,b){delete b.common.Authorization;delete b.Authorization;return a}]};e.headers["Content-Type"]=a.request[n].format;l.push(c(e))}return Promise.all(l).then(function(){return d})})};
this.requestExport=function(a,c,d){if(b.getStatus()!==module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.ACTIVE)return a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,"Plugin not active",d),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,a),module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.ERROR;e(a,c,d).then(function(a){var c=
new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_RESULT,a,d);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_AVAILABLE,c);c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS,"Export available",d);c.addPart(module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_RESULT,
a);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,c)},function(a){a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,a,d);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,a)});b.debug("CommPlugin.requestExport","Called with export "+a+", kvps "+b.jsify(c)+", token "+b.jsify(d));return b.pluginConstants.requestExportResults.LOAD};
this.saveSettings=function(a){return g.hasOwnProperty("configure")?r(g.configure.href,g.configure.method,a,"application/json"):Promise.resolve(!1)};this.saveDefaultParameterValues=function(a){return g.hasOwnProperty("defaultparam")?r(g.defaultparam.href,g.defaultparam.method,a,"application/json").then(function(){return!0}):Promise.resolve(!1)};this.registerHook("modelViewUrl",function(){return!1});this.registerHook("ticket",function(){return!1});this.setStatus(module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.READY)}else b.error("CommPlugin.CommPlugin",
"Plugin was initialized without a ticket."),b.setStatus(module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.FAILED)};var module$src$api$apps$sd_controls$constants$sd_controls_constants_types={default:{}};module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.SLIDER="slider";module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.STRING="string";module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.BOOLEAN="boolean";module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.COLOR="color";
module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.BUTTON="button";module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.DROPDOWN="dropdown";module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.CHECKLIST="form";module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.FILE="file";module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.MULTIPLE="multiple";var module$src$api$apps$sd_controls$settings$sd_controls_settings={default:function(a){var b={"render.shadows":{defval:a.getSetting("render.shadows"),id:0,order:0,groupId:2,setting:"render.shadows",name:"Shadows",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.BOOLEAN},"render.ambientOcclusion":{defval:a.getSetting("render.ambientOcclusion"),id:1,order:1,groupId:2,setting:"render.ambientOcclusion",name:"Ambient Occlusion",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.BOOLEAN},
"scene.lights.light1":{defval:a.getSetting("scene.lights.light1").properties.intensity,id:2,order:2,groupId:2,max:5.000001,setting:"scene.lights.light1",name:"Ambient Light Intensity",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.SLIDER,decimalplaces:3,valueConversion:{update:"value",f:function(b,g){b=a.getSetting("scene.lights.light1");b.properties.intensity=parseFloat(g.value);return b},i:function(a,b){return b.properties.intensity}}},"scene.lights.light2":{defval:a.getSetting("scene.lights.light2").properties.intensity,
id:3,order:3,groupId:2,max:5.000001,setting:"scene.lights.light2",name:"Spot Light Intensity",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.SLIDER,decimalplaces:3,valueConversion:{update:"value",f:function(b,g){b=a.getSetting("scene.lights.light2");b.properties.intensity=parseFloat(g.value);return b},i:function(a,b){return b.properties.intensity}}},bumpAmplitude:{defval:a.getSetting("defaultMaterial.bumpAmplitude"),id:4,order:4,groupId:2,max:1.000001,setting:"defaultMaterial.bumpAmplitude",
name:"Bump Amplitude",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.SLIDER,decimalplaces:3,valueConversion:function(a,b){return parseFloat(b.value)}},defaultMaterialColor:{defval:a.getSetting("defaultMaterial.color"),id:5,order:3,groupId:1,setting:"defaultMaterial.color",name:"Default Material Color",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.COLOR,valueConversion:{update:"value",f:function(a,b){b=(0,module$src$shared$util$toTinyColor.default)(b.value);
if("color"===a.inputComponent.type)return b.toHexString();$("#"+this.slugId+"-color").spectrum("set",b.toRgbString());return b.toRgbString()}}},groundPlane:{defval:a.getSetting("groundPlaneVisibility"),id:6,order:1,groupId:1,setting:"groundPlaneVisibility",name:"Ground Plane",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.BOOLEAN},grid:{defval:a.getSetting("gridVisibility"),id:7,order:2,groupId:1,setting:"gridVisibility",name:"Grid",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.BOOLEAN},
"render.clearColor":{defval:a.getSetting("render.clearColor"),id:8,order:5,groupId:1,setting:"render.clearColor",name:"Background Color",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.COLOR,valueConversion:{update:"value",f:function(a,b){b=(0,module$src$shared$util$toTinyColor.default)(b.value);if("color"===a.inputComponent.type)return b.toHexString();$("#"+this.slugId+"-color").spectrum("set",b.toRgbString());return b.toRgbString()}}},"render.clearAlpha":{defval:a.getSetting("render.clearAlpha"),
id:9,order:6,groupId:1,setting:"render.clearAlpha",name:"Background Alpha",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.SLIDER,min:0,max:1,decimalplaces:2,valueConversion:function(a,b){return parseFloat(b.value)}},"material.environmentMapAsBackground":{defval:a.getSetting("material.environmentMapAsBackground"),id:10,order:3,groupId:3,setting:"material.environmentMapAsBackground",name:"Environment",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.BOOLEAN},
"material.environmentMap1":{defval:a.getSetting("material.environmentMap"),choices:"none default default_bw blurred_lights georgentor georgentor_blur georgentor_blue_blur georgentor_bw_blur levelsets lythwood_field mountains ocean piazza_san_marco residential_garden room_abstract_1 sky storage_room storm subway_entrance subway_entrance_bw_blur white yokohama".split(" "),id:11,order:4,groupId:3,setting:"material.environmentMap",name:"Choose Environment",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.DROPDOWN,
valueConversion:{update:"selectedIndex",f:function(a,b){return b.options[b.selectedIndex].innerHTML},i:function(a,b){return a.choiceValues.indexOf(b.toLowerCase())}}},"material.environmentMapResolution":{defval:a.getSetting("material.environmentMapResolution"),choices:["256","512","1024","2048"],id:12,order:5,groupId:3,setting:"material.environmentMapResolution",name:"Environment resolution",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.DROPDOWN,valueConversion:{update:"selectedIndex",
f:function(a,b){return b.options[b.selectedIndex].innerHTML},i:function(a,b){return a.choiceValues.indexOf(b)}}},"material.environmentMap2":{defval:a.getSetting("material.environmentMap"),max:500,id:13,order:6,groupId:3,setting:"material.environmentMap",name:"Custom Environment",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.STRING},pointSize:{defval:a.getSetting("render.pointSize"),id:14,order:4,groupId:1,setting:"render.pointSize",name:"Point Size",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.SLIDER,
min:.001,max:100.000001,decimalplaces:3,valueConversion:function(a,b){return parseFloat(b.value)}},topView:{defval:a.getSetting("camera.type"),id:15,order:1,groupId:4,setting:"camera.type",name:"Top View",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.BOOLEAN,valueConversion:{update:"value",f:function(a,b){return b.checked?1:0},i:function(a,b){return 1===b?!0:!1}}},enableZoom:{defval:!a.getSetting("camera.enableZoom"),id:16,order:3,groupId:4,setting:"camera.enableZoom",
name:"Disable Zoom",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.BOOLEAN,valueConversion:{update:"value",f:function(a,b){return!b.checked},i:function(a,b){return!b}}},"camera.zoomSpeed":{defval:a.getSetting("camera.zoomSpeed"),id:17,order:3,groupId:4,setting:"camera.zoomSpeed",name:"Zoom Speed",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.SLIDER,min:0,max:1.000001,decimalplaces:2,valueConversion:function(a,b){return parseFloat(b.value)}},
enablePan:{defval:!a.getSetting("camera.enablePan"),id:18,order:4,groupId:4,setting:"camera.enablePan",name:"Disable Pan",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.BOOLEAN,valueConversion:{update:"value",f:function(a,b){return!b.checked},i:function(a,b){return!b}}},"camera.panSpeed":{defval:a.getSetting("camera.panSpeed"),id:19,order:5,groupId:4,setting:"camera.panSpeed",name:"Pan Speed",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.SLIDER,
min:0,max:1.000001,decimalplaces:2,valueConversion:function(a,b){return parseFloat(b.value)}},enableRotation:{defval:!a.getSetting("camera.enableRotation"),id:20,order:6,groupId:4,setting:"camera.enableRotation",name:"Disable Rotation",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.BOOLEAN,valueConversion:{update:"value",f:function(a,b){return!b.checked},i:function(a,b){return!b}}},"camera.rotationSpeed":{defval:a.getSetting("camera.rotationSpeed"),id:21,order:7,
groupId:4,setting:"camera.rotationSpeed",name:"Rotation Speed",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.SLIDER,min:0,max:1.000001,decimalplaces:2,valueConversion:function(a,b){return parseFloat(b.value)}},"camera.autoRotationSpeed":{defval:a.getSetting("camera.autoRotationSpeed"),id:22,order:8,groupId:4,setting:"camera.autoRotationSpeed",name:"Auto Rotation",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.SLIDER,min:-10,
max:10.000001,decimalplaces:2,valueConversion:function(a,b){return parseFloat(b.value)}},"camera.damping":{defval:a.getSetting("camera.damping"),id:23,order:9,groupId:4,setting:"camera.damping",name:"Damping Factor",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.SLIDER,min:0,max:10.000001,decimalplaces:2,valueConversion:function(a,b){return parseFloat(b.value)}},"camera.fov":{defval:a.getSetting("camera.fov"),id:24,order:2,groupId:4,setting:"camera.fov",name:"Field of View",
type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.SLIDER,min:10,max:90,decimalplaces:0,valueConversion:function(a,b){return parseFloat(b.value)}},"camera.zoomExtentsFactor":{defval:a.getSetting("camera.zoomExtentsFactor"),id:25,order:11,groupId:4,setting:"camera.zoomExtentsFactor",name:"Zoom Factor",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.SLIDER,min:.1,max:10.000001,decimalplaces:2,valueConversion:function(a,b){return parseFloat(b.value)}},
"camera.cameraMovementDuration":{defval:a.getSetting("camera.cameraMovementDuration"),id:26,order:12,groupId:4,setting:"camera.cameraMovementDuration",name:"Movement duration [msec]",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.SLIDER,min:0,max:2500,decimalplaces:0,valueConversion:function(a,b){return parseFloat(b.value)}},"camera.autoAdjust":{defval:a.getSetting("camera.autoAdjust"),id:27,order:13,groupId:4,setting:"camera.autoAdjust",name:"Camera adjust",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.BOOLEAN},
"camera.revertAtMouseUp":{defval:a.getSetting("camera.revertAtMouseUp"),id:28,order:14,groupId:4,setting:"camera.revertAtMouseUp",name:"Camera revert",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.BOOLEAN},"camera.revertAtMouseUpDuration":{defval:a.getSetting("camera.revertAtMouseUpDuration"),id:29,order:15,groupId:4,setting:"camera.revertAtMouseUpDuration",name:"Revert duration [msec]",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.SLIDER,
min:0,max:2500,decimalplaces:0,valueConversion:function(a,b){return parseFloat(b.value)}},commitParameters:{defval:a.getSetting("commitParameters"),id:31,order:8,groupId:1,setting:"commitParameters",name:"Parameter validation",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.BOOLEAN}};Object.assign(this,b)}},TYPES$$module$src$api$apps$sd_controls$settings$sd_controls_settings=module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default,TO_TINY_COLOR$$module$src$api$apps$sd_controls$settings$sd_controls_settings=
module$src$shared$util$toTinyColor.default;var module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util={default:{}};
module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement=function(a,b){a=document.createElement(a);var c,g,d;for(c in b){var f=b[c];if("classList"===c)if(Array.isArray(f)){var p=0;for(d=f.length;p<d;p++)a.classList.add(f[p])}else a.classList.add(f);else if("parent"===c)f.appendChild(a);else if("attributes"===c)for(g in f)a.setAttribute(g,f[g]);else void 0!==f&&null!==f&&(a[c]=f)}return a};
module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener=function(a,b,c,g,d,f,p,e){var m,h=p||0,r,q;p=function(d){a||_destroy();c.valueConversion.update&&c.valueConversion.f?(r=g[c.valueConversion.update],q=c.valueConversion.f(c,g)):r="string"===typeof c.valueConversion?q=g[c.valueConversion]:q=c.valueConversion(c,g);f(r,d)&&(clearTimeout(m),m=setTimeout(function(){var h=!0;if("function"===typeof e&&r&&q){var n={val1:r,val2:q};h=e(n,d);
r=n.val1;q=n.val2}h&&(!0===c.parameter?c.parametersQueue&&c.parametersQueue.use?c.parametersQueue.add(c,b,q):(a.parameters.updateAsync({id:b,value:q}),c.setStackToLast()):!0===c.export?a.exports.requestAsync({id:b}):c.settingsQueue&&c.settingsQueue.use&&"commitSettings"!==b?c.settingsQueue.add(c,b,q):(a.updateSettingAsync(b,q),c.setStackToLast()))},h))};g.addEventListener(d,p);return p};
module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.isMobileDevice=function(){var a=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||
/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,
4)))_isMobile$$module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util=!0;return _isMobile$$module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util};
module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.isMobileOrTabletDevice=function(){var a=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,
4)))_isMobileOrTable$$module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util=!0;return _isMobileOrTable$$module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util};module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.isIPadOrIPhone=function(){var a=window.navigator.userAgent;return a.match(/iPad/i)||a.match(/iPhone/i)};
module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.isEventSupported=function(a,b){var c={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};b=document.createElement(b||c||"div");a="on"+a;c=a in b;c||(b.setAttribute(a,"return;"),c="function"==typeof b[a]);return c};
module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.domSupportsHtml5Color=function(){try{return colorInput=document.createElement("input"),colorInput.type="color",colorInput.value="!","color"===colorInput.type&&"!"!==colorInput.value}catch(a){return!1}};var _isMobile$$module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util=!1,_isMobileOrTable$$module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util=!1;var module$src$api$apps$sd_controls$components$util$sd_controls_components_util_util={default:{}};module$src$api$apps$sd_controls$components$util$sd_controls_components_util_util.default.hide=function(a,b){return b?a.classList.add("sdv-hidden"):a.classList.remove("sdv-hidden")};var module$src$api$apps$sd_controls$components$base$sd_controls_components_base={default:function(a,b,c,g){this.id=b.id;this.plugin=b.plugin;this.groupId=b.groupId?b.groupId:null;this.isMobileDevice=IS_MOBILE_DEVICE$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base;this.isMobileOrTabletDevice=IS_MOBILE_OR_TABLET_DEVICE$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base;this.isIPadOrIPhone=IS_IPAD_OR_IPHONE$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base;
this.order=b.order;this.type=a;this.name=b.name;this.newName=null;this.hidden=this.inContentEditMode=this.wasEdited=!1;this.setting=c.options&&c.options.settings?b.setting:null;this.slugId=c.runtimeId+"_"+_slugify$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base(b.id);this.controlsContext=c;this.parametersQueue=c.parametersQueue;this.settingsQueue=c.settingsQueue;this.inputComponent=null;this._previousValues=[];this._currentValue=null;this.isChanged=!1;-1===c.plugins.indexOf(b.plugin)&&
c.plugins.push(b.plugin);this.createRow(a,b,g)}},controlsUtil$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base=module$src$api$apps$sd_controls$components$util$sd_controls_components_util_util.default,createDOMElement$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement,IS_MOBILE_DEVICE$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base=
module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.isMobileDevice(),IS_MOBILE_OR_TABLET_DEVICE$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.isMobileOrTabletDevice(),IS_IPAD_OR_IPHONE$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.isIPadOrIPhone(),
MAX_NAME_LENGTH$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base=30,_slugify$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base=function(){function a(a,g){"string"!==typeof a&&(a+="");g="string"===typeof g?{replacement:g}:g||{};a=a.split("").reduce(function(a,c){return a+(b[c]||c).replace(g.remove||/[^\w\s$*_+~.()''!\-:@]/g,"")},"").replace(/^\s+|\s+$/g,"").replace(/[-\s]+/g,g.replacement||"-").replace("#{replacement}$","");return g.lower?a.toLowerCase():
a}var b=JSON.parse('{"$":"dollar","&":"and","<":"less",">":"greater","|":"or","\u00a2":"cent","\u00a3":"pound","\u00a4":"currency","\u00a5":"yen","\u00a9":"(c)","\u00aa":"a","\u00ae":"(r)","\u00ba":"o","\u00c0":"A","\u00c1":"A","\u00c2":"A","\u00c3":"A","\u00c4":"A","\u00c5":"A","\u00c6":"AE","\u00c7":"C","\u00c8":"E","\u00c9":"E","\u00ca":"E","\u00cb":"E","\u00cc":"I","\u00cd":"I","\u00ce":"I","\u00cf":"I","\u00d0":"D","\u00d1":"N","\u00d2":"O","\u00d3":"O","\u00d4":"O","\u00d5":"O","\u00d6":"O","\u00d8":"O","\u00d9":"U","\u00da":"U","\u00db":"U","\u00dc":"U","\u00dd":"Y","\u00de":"TH","\u00df":"ss","\u00e0":"a","\u00e1":"a","\u00e2":"a","\u00e3":"a","\u00e4":"a","\u00e5":"a","\u00e6":"ae","\u00e7":"c","\u00e8":"e","\u00e9":"e","\u00ea":"e","\u00eb":"e","\u00ec":"i","\u00ed":"i","\u00ee":"i","\u00ef":"i","\u00f0":"d","\u00f1":"n","\u00f2":"o","\u00f3":"o","\u00f4":"o","\u00f5":"o","\u00f6":"o","\u00f8":"o","\u00f9":"u","\u00fa":"u","\u00fb":"u","\u00fc":"u","\u00fd":"y","\u00fe":"th","\u00ff":"y","\u0100":"A","\u0101":"a","\u0102":"A","\u0103":"a","\u0104":"A","\u0105":"a","\u0106":"C","\u0107":"c","\u010c":"C","\u010d":"c","\u010e":"D","\u010f":"d","\u0110":"DJ","\u0111":"dj","\u0112":"E","\u0113":"e","\u0116":"E","\u0117":"e","\u0118":"e","\u0119":"e","\u011a":"E","\u011b":"e","\u011e":"G","\u011f":"g","\u0122":"G","\u0123":"g","\u0128":"I","\u0129":"i","\u012a":"i","\u012b":"i","\u012e":"I","\u012f":"i","\u0130":"I","\u0131":"i","\u0136":"k","\u0137":"k","\u013b":"L","\u013c":"l","\u0141":"L","\u0142":"l","\u0143":"N","\u0144":"n","\u0145":"N","\u0146":"n","\u0147":"N","\u0148":"n","\u0150":"O","\u0151":"o","\u0152":"OE","\u0153":"oe","\u0158":"R","\u0159":"r","\u015a":"S","\u015b":"s","\u015e":"S","\u015f":"s","\u0160":"S","\u0161":"s","\u0162":"T","\u0163":"t","\u0164":"T","\u0165":"t","\u0168":"U","\u0169":"u","\u016a":"u","\u016b":"u","\u016e":"U","\u016f":"u","\u0170":"U","\u0171":"u","\u0172":"U","\u0173":"u","\u0179":"Z","\u017a":"z","\u017b":"Z","\u017c":"z","\u017d":"Z","\u017e":"z","\u0192":"f","\u01a0":"O","\u01a1":"o","\u01af":"U","\u01b0":"u","\u01c8":"LJ","\u01c9":"lj","\u01cb":"NJ","\u01cc":"nj","\u0218":"S","\u0219":"s","\u021a":"T","\u021b":"t","\u02da":"o","\u0386":"A","\u0388":"E","\u0389":"H","\u038a":"I","\u038c":"O","\u038e":"Y","\u038f":"W","\u0390":"i","\u0391":"A","\u0392":"B","\u0393":"G","\u0394":"D","\u0395":"E","\u0396":"Z","\u0397":"H","\u0398":"8","\u0399":"I","\u039a":"K","\u039b":"L","\u039c":"M","\u039d":"N","\u039e":"3","\u039f":"O","\u03a0":"P","\u03a1":"R","\u03a3":"S","\u03a4":"T","\u03a5":"Y","\u03a6":"F","\u03a7":"X","\u03a8":"PS","\u03a9":"W","\u03aa":"I","\u03ab":"Y","\u03ac":"a","\u03ad":"e","\u03ae":"h","\u03af":"i","\u03b0":"y","\u03b1":"a","\u03b2":"b","\u03b3":"g","\u03b4":"d","\u03b5":"e","\u03b6":"z","\u03b7":"h","\u03b8":"8","\u03b9":"i","\u03ba":"k","\u03bb":"l","\u03bc":"m","\u03bd":"n","\u03be":"3","\u03bf":"o","\u03c0":"p","\u03c1":"r","\u03c2":"s","\u03c3":"s","\u03c4":"t","\u03c5":"y","\u03c6":"f","\u03c7":"x","\u03c8":"ps","\u03c9":"w","\u03ca":"i","\u03cb":"y","\u03cc":"o","\u03cd":"y","\u03ce":"w","\u0401":"Yo","\u0402":"DJ","\u0404":"Ye","\u0406":"I","\u0407":"Yi","\u0408":"J","\u0409":"LJ","\u040a":"NJ","\u040b":"C","\u040f":"DZ","\u0410":"A","\u0411":"B","\u0412":"V","\u0413":"G","\u0414":"D","\u0415":"E","\u0416":"Zh","\u0417":"Z","\u0418":"I","\u0419":"J","\u041a":"K","\u041b":"L","\u041c":"M","\u041d":"N","\u041e":"O","\u041f":"P","\u0420":"R","\u0421":"S","\u0422":"T","\u0423":"U","\u0424":"F","\u0425":"H","\u0426":"C","\u0427":"Ch","\u0428":"Sh","\u0429":"Sh","\u042a":"U","\u042b":"Y","\u042c":"","\u042d":"E","\u042e":"Yu","\u042f":"Ya","\u0430":"a","\u0431":"b","\u0432":"v","\u0433":"g","\u0434":"d","\u0435":"e","\u0436":"zh","\u0437":"z","\u0438":"i","\u0439":"j","\u043a":"k","\u043b":"l","\u043c":"m","\u043d":"n","\u043e":"o","\u043f":"p","\u0440":"r","\u0441":"s","\u0442":"t","\u0443":"u","\u0444":"f","\u0445":"h","\u0446":"c","\u0447":"ch","\u0448":"sh","\u0449":"sh","\u044a":"u","\u044b":"y","\u044c":"","\u044d":"e","\u044e":"yu","\u044f":"ya","\u0451":"yo","\u0452":"dj","\u0454":"ye","\u0456":"i","\u0457":"yi","\u0458":"j","\u0459":"lj","\u045a":"nj","\u045b":"c","\u045f":"dz","\u0490":"G","\u0491":"g","\u0e3f":"baht","\u10d0":"a","\u10d1":"b","\u10d2":"g","\u10d3":"d","\u10d4":"e","\u10d5":"v","\u10d6":"z","\u10d7":"t","\u10d8":"i","\u10d9":"k","\u10da":"l","\u10db":"m","\u10dc":"n","\u10dd":"o","\u10de":"p","\u10df":"zh","\u10e0":"r","\u10e1":"s","\u10e2":"t","\u10e3":"u","\u10e4":"f","\u10e5":"k","\u10e6":"gh","\u10e7":"q","\u10e8":"sh","\u10e9":"ch","\u10ea":"ts","\u10eb":"dz","\u10ec":"ts","\u10ed":"ch","\u10ee":"kh","\u10ef":"j","\u10f0":"h","\u1e9e":"SS","\u1ea0":"A","\u1ea1":"a","\u1ea2":"A","\u1ea3":"a","\u1ea4":"A","\u1ea5":"a","\u1ea6":"A","\u1ea7":"a","\u1ea8":"A","\u1ea9":"a","\u1eaa":"A","\u1eab":"a","\u1eac":"A","\u1ead":"a","\u1eae":"A","\u1eaf":"a","\u1eb0":"A","\u1eb1":"a","\u1eb2":"A","\u1eb3":"a","\u1eb4":"A","\u1eb5":"a","\u1eb6":"A","\u1eb7":"a","\u1eb8":"E","\u1eb9":"e","\u1eba":"E","\u1ebb":"e","\u1ebc":"E","\u1ebd":"e","\u1ebe":"E","\u1ebf":"e","\u1ec0":"E","\u1ec1":"e","\u1ec2":"E","\u1ec3":"e","\u1ec4":"E","\u1ec5":"e","\u1ec6":"E","\u1ec7":"e","\u1ec8":"I","\u1ec9":"i","\u1eca":"I","\u1ecb":"i","\u1ecc":"O","\u1ecd":"o","\u1ece":"O","\u1ecf":"o","\u1ed0":"O","\u1ed1":"o","\u1ed2":"O","\u1ed3":"o","\u1ed4":"O","\u1ed5":"o","\u1ed6":"O","\u1ed7":"o","\u1ed8":"O","\u1ed9":"o","\u1eda":"O","\u1edb":"o","\u1edc":"O","\u1edd":"o","\u1ede":"O","\u1edf":"o","\u1ee0":"O","\u1ee1":"o","\u1ee2":"O","\u1ee3":"o","\u1ee4":"U","\u1ee5":"u","\u1ee6":"U","\u1ee7":"u","\u1ee8":"U","\u1ee9":"u","\u1eea":"U","\u1eeb":"u","\u1eec":"U","\u1eed":"u","\u1eee":"U","\u1eef":"u","\u1ef0":"U","\u1ef1":"u","\u1ef2":"Y","\u1ef3":"y","\u1ef4":"Y","\u1ef5":"y","\u1ef6":"Y","\u1ef7":"y","\u1ef8":"Y","\u1ef9":"y","\u2018":"\'","\u2019":"\'","\u201c":"\\"","\u201d":"\\"","\u2020":"+","\u2022":"*","\u2026":"...","\u20a0":"ecu","\u20a2":"cruzeiro","\u20a3":"french franc","\u20a4":"lira","\u20a5":"mill","\u20a6":"naira","\u20a7":"peseta","\u20a8":"rupee","\u20a9":"won","\u20aa":"new shequel","\u20ab":"dong","\u20ac":"euro","\u20ad":"kip","\u20ae":"tugrik","\u20af":"drachma","\u20b0":"penny","\u20b1":"peso","\u20b2":"guarani","\u20b3":"austral","\u20b4":"hryvnia","\u20b5":"cedi","\u20b9":"indian rupee","\u20bd":"russian ruble","\u2120":"sm","\u2122":"tm","\u2202":"d","\u2206":"delta","\u2211":"sum","\u221e":"infinity","\u2665":"love","\u5143":"yuan","\u5186":"yen","\ufdfc":"rial"}');
a.extend=function(a){for(var c in a)b[c]=a[c]};return a}();module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.prototype.pushToValueStack=function(a){this._previousValues.push(a)};module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.prototype.clearStack=function(){this._previousValues=[]};
module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.prototype.setStackToLast=function(){var a=this._previousValues.pop();void 0!==a?(this._previousValues=[a],this._currentValue=a):this._previousValues=[]};module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.prototype.setToInitalValue=function(){var a=this._previousValues[0];void 0!==a&&this.update(a)};
module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.prototype.isCurrentValueSameAsInital=function(){return this._currentValue===this._previousValues[0]};module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.prototype.update=function(a){if(this.inputComponent)return this._currentValue=this.inputComponent.value=a,this.pushToValueStack(a),!0;throw Error("Input component not defined. Type of: "+this.type);};
module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.prototype.createRow=function(a,b,c){this.row=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("div",{id:this.slugId+"-controlmenu-row",name:this.slugId+"-controlmenu-row",parent:c||this.controlsContext.container,classList:["uk-padding-small","uk-margin-remove","sdv-control-panel-row-border"],attributes:{"uk-grid":'margin: "";'}});c=b.name;c.length>MAX_NAME_LENGTH$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base-
3&&c.substring(0,MAX_NAME_LENGTH$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base-3);this.label=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("label",{id:this.slugId+"-label",parent:this.row,innerHTML:b.name,classList:"uk-width-expand uk-form-label uk-text-small uk-margin-small-bottom uk-padding-remove uk-text-uppercase uk-text-truncate".split(" "),attributes:{"for":"slider"===this.slugId+"-"+a?"range":a,
"param-id":b.id,title:b.name}});this.controlsContext.options&&this.controlsContext.options.editMode&&this.label.classList.add("sdv-edit-mode");this.inputContainer=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("div",{classList:["uk-width-1-1","uk-padding-remove"],parent:this.row})};
module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.prototype.hide=function(a){this.hidden=a;this.inputComponent&&module$src$api$apps$sd_controls$components$util$sd_controls_components_util_util.default.hide(this.inputComponent,a)};module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.prototype.toggleHide=function(){this.hide(!this.hidden)};
module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.prototype.disable=function(a){a?this.inputComponent.setAttribute("disabled",!0):this.inputComponent.removeAttribute("disabled")};module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.prototype.onSettingUpdate=function(a){this.inputComponent.value=a};
module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.prototype.setEditable=function(a){a?(this.label.addEventListener("input",function(a){this.wasEdited=!0;this.newName=a.target.innerText}.bind(this)),this.label.contentEditable=!0):this.label.contentEditable=!1;this.inContentEditMode=a};var module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider={default:function(a,b,c,g,d){module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.call(this,b,c,g,d);b=c.min;d=c.max;var f=c.defval,p=null==c.decimalplaces?0:"Even"==c.type||"Odd"==c.type?2:"Int"==c.type||"Odd"==c.type||"Even"==c.type?1:Math.pow(.1,c.decimalplaces);this._minVal=Number(b);this._maxVal=Number(d);this.decimalPlaces=c.decimalplaces?Number(c.decimalplaces):0;this.pushToValueStack(f);
this._previousValue=this._currentValue=f;this.cInputRange=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("input",{attributes:{type:"range",name:this.slugId+"-range",min:b,max:d,step:p,value:f,tabIndex:-1},id:this.slugId+"-range",parent:this.inputContainer,value:f,classList:["uk-range","uk-width-2-3","uk-form-small","sd-input-range"]});this.isMobileOrTabletDevice&&this.cInputRange.classList.add("sd-input-range-mobile");this.isIPadOrIPhone?
this.cInputRange.classList.add("ios-padding-left"):this.cInputRange.classList.add("uk-padding-remove-left");this.cInputNumber=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("input",{id:this.slugId+"-number",parent:this.inputContainer,value:f,classList:["uk-input","uk-width-1-3","uk-form-small","sd-input-number"],attributes:{type:"number",name:this.slugId+"-number",min:b,max:d,step:p}});this.valueConversion=c.valueConversion?c.valueConversion:
"value";(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener)(g.api,a,this,this.cInputRange,"change",this.update.bind(this));c=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.isEventSupported)("input","input")?"input":"change";(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener)(g.api,a,this,this.cInputNumber,c,this.update.bind(this),
1E3,this.parameterValidation.bind(this));(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener)(g.api,a,this,this.cInputNumber,"focusout",this.update.bind(this),10,this.parameterValidation.bind(this));(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener)(g.api,a,this,this.cInputNumber,"keyup",this.updateKeyUp.bind(this),10,this.parameterValidation.bind(this));this.cInputRange.addEventListener("input",
function(){this.cInputNumber.value=this.cInputRange.value}.bind(this))}},createDOMElement$$module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement,setDomElementEventListener$$module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener,
isEventSupported$$module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.isEventSupported,controlsUtil$$module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider=module$src$api$apps$sd_controls$components$util$sd_controls_components_util_util.default,MenuComponent$$module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider=
module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default;module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider.default.prototype=Object.create(module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.prototype);
module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider.default.prototype.hide=function(a){module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.prototype.hide.call(this,a);module$src$api$apps$sd_controls$components$util$sd_controls_components_util_util.default.hide(this.cInputRange,a);module$src$api$apps$sd_controls$components$util$sd_controls_components_util_util.default.hide(this.cInputNumber,a)};
module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider.default.prototype.formatValue=function(a){return Number(Number(a).toFixed(this.decimalPlaces))};module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider.default.prototype.update=function(a){if(isNaN(a))return!1;if(a)return a=this.formatValue(a),this.pushToValueStack(a),this._currentValue=a,!0};
module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider.default.prototype.onSettingUpdate=function(a){this.cInputRange.value=a;this.cInputNumber.value=a};module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider.default.prototype.updateKeyUp=function(a,b){if(b.which||b.keyCode)return 13==b.which||13==b.keyCode};
module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider.default.prototype.parameterValidation=function(a){var b=a.val1;b<this._minVal?b=this._minVal:b>this._maxVal&&(b=this._maxVal);b=this.formatValue(b);this.cInputRange.value=b;this.cInputNumber.value=b;if(this._previousValue==this._currentValue)return!1;a.val1=b;a.val2=b;this._previousValue=this._currentValue;return!0};var module$src$api$apps$sd_controls$components$component_string$sd_controls_components_string_input={default:function(a,b,c,g,d){module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.call(this,b,c,g,d);b=c.defval;d=parseInt(c.max);this.inputComponent=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("input",{id:this.slugId+"-text",parent:this.inputContainer,maxLength:d,value:b,classList:["uk-input","uk-form-small"],
attributes:{type:"text",name:this.slugId+"-text"}});this.valueConversion=c.valueConversion?c.valueConversion:"value";(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener)(g.api,a,this,this.inputComponent,"input",this.update.bind(this),1E3)}},createDOMElement$$module$src$api$apps$sd_controls$components$component_string$sd_controls_components_string_input=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement,
setDomElementEventListener$$module$src$api$apps$sd_controls$components$component_string$sd_controls_components_string_input=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener,MenuComponent$$module$src$api$apps$sd_controls$components$component_string$sd_controls_components_string_input=module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default;
module$src$api$apps$sd_controls$components$component_string$sd_controls_components_string_input.default.prototype=Object.create(module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.prototype);var module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input={default:function(a,b,c,g,d){module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.call(this,b,c,g,d);this.disableIds=c.disableIds;this.disableOn=c.disableOn;b=void 0==c.strue?null:c.strue;d=void 0==c.sfalse?null:c.sfalse;var f=1==c.defval;this.events=[];null==b?(this.container=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("label",
{id:this.slugId+"_-checkbox-label",parent:this.inputContainer,classList:"sdv-control-panel-control",className:"sdv-control-panel-boolean-input-checkbox-label",attributes:{"for":this.slugId+"-checkbox"}}),this.cInputCheckbox=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("input",{id:this.slugId+"-checkbox",parent:this.container,checked:f,classList:["shapediver-viewer-element","sdv-control-panel-boolean-input-checkbox","sdv-control-panel-control"],
attributes:{type:"checkbox",name:this.slugId+"-checkbox"}}),this.cInputCheckboxContainer=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("div",{id:this.slugId+"-checkbox-helper",parent:this.container,classList:"sdv-control-panel-boolean-input-boxhelper",attributes:{"for":this.slugId+"-checkbox"}}),this.valueConversion=c.valueConversion?c.valueConversion:"checked",(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener)(g.api,
a,this,this.cInputCheckbox,"change",this.update.bind(this))):(this.container=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("form",{id:this.slugId+"-form",parent:this.inputContainer,classList:["sdv-control-panel-boolean-input-form","sdv-control-panel-control"]}),this.label.setAttribute("for",this.slugId+"-form"),(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("label",{id:this.slugId+
"-label-true",parent:this.container,innerHTML:b,classList:"sdv-control-panel-boolean-input-radio-label"}),this.cInputCheckboxTrue=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("input",{id:this.slugId+"-radio-true",parent:this.container,innerHTML:b,checked:f,value:"true",classList:"sdv-control-panel-boolean-input-radio",attributes:{type:"radio",name:this.slugId+"-radio-true"}}),(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("label",
{id:this.slugId+"-label-false",parent:this.container,innerHTML:d,classList:"sdv-control-panel-boolean-input-radio-label"}),this.cInputCheckboxFalse=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("input",{id:this.slugId+"-radio-false",parent:this.container,innerHTML:d,checked:!f,value:"true",classList:"sdv-control-panel-boolean-input-radio",attributes:{type:"radio",name:this.slugId+"-radio-false"}}),this.valueConversion=c.valueConversion?
c.valueConversion:"checked",(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener)(a,this,this.cInputCheckboxTrue,"change",this.update.bind(this)),this.cInputCheckboxFalse.onchange=function(){this.cInputCheckboxTrue.checked=!this.cInputCheckboxFalse.checked;if(this.cInputCheckboxFalse.checked)this.cInputCheckboxTrue.onchange(!0)},this.container.appendChild((0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("br")))}},
MenuComponent$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input=module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default,createDOMElement$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement,setDomElementEventListener$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input=
module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener,controlsUtil$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input=module$src$api$apps$sd_controls$components$util$sd_controls_components_util_util.default;module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default.prototype=Object.create(module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.prototype);
module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default.prototype.update=function(a){var b=this;this.pushToValueStack(a);this._currentValue=a;this.cInputCheckbox&&(this.cInputCheckbox.checked=a);this.cInputCheckboxTrue&&(this.cInputCheckboxTrue.checked=a);this.cInputCheckboxFalse&&(this.cInputCheckboxFalse.checked=!a);this.disableIds&&0<this.disableIds.length&&this.controlsContext.controls.filter(function(a){return b.disableIds.includes(a.id)},this).forEach(function(c){return c.disable(a===
b.disableOn)},this);return!0};module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default.prototype.onSettingUpdate=function(a){this.cInputCheckbox&&(this.cInputCheckbox.checked=a);this.cInputCheckboxTrue&&(this.cInputCheckboxTrue.checked=a);this.cInputCheckboxFalse&&(this.cInputCheckboxFalse.checked=!a)};
module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default.prototype.hide=function(a){module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.prototype.hide.call(this,a);this.cInputCheckbox&&module$src$api$apps$sd_controls$components$util$sd_controls_components_util_util.default.hide(this.cInputCheckbox,a);this.cInputCheckboxContainer&&module$src$api$apps$sd_controls$components$util$sd_controls_components_util_util.default.hide(this.cInputCheckboxContainer,
a);this.cInputCheckboxTrue&&module$src$api$apps$sd_controls$components$util$sd_controls_components_util_util.default.hide(this.cInputCheckboxFalse,a);this.cInputCheckboxFalse&&module$src$api$apps$sd_controls$components$util$sd_controls_components_util_util.default.hide(this.cInputCheckboxTrue,a)};var module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input={default:function(a,b,c,g,d){var f=this;module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.call(this,b,c,g,d);b=c.defval;b=(0,module$src$shared$util$toTinyColor.default)(b);g.useSpectrum?(this.inputComponent=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("input",{id:this.slugId+"-color",parent:this.inputContainer,
classList:["uk-hidden"],attributes:{name:this.slugId+"-color"}}),this.inputComponent.setAttribute("type","text"),this.pushToValueStack(b.toRgbString()),$("#"+this.slugId+"-color").spectrum({color:b.toRgbString(),replacerClassName:"uk-padding-remove",showInput:!0,showInitial:!0,preferredFormat:"rgb",change:function(a){f.inputComponent.setAttribute("value",a.toHexString());a=document.createEvent("Event");a.initEvent("change",!1,!0);f.inputComponent.dispatchEvent(a)}}),this.colorPicker=this.row.getElementsByClassName("sp-replacer")[0]):
(this.inputComponent=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("input",{id:this.slugId+"-color",parent:this.inputContainer,classList:["uk-input","uk-form-small","uk-form-width-xsmall"],attributes:{name:this.slugId+"-color"}}),this.inputComponent.setAttribute("type","color"),this.inputComponent.value=b.toHexString(),this.pushToValueStack(this.inputComponent.value),this.colorPicker=this.inputComponent);this.valueConversion=c.valueConversion?
c.valueConversion:"value";(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener)(g.api,a,this,this.inputComponent,"change",this.update.bind(this))}},createDOMElement$$module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement,setDomElementEventListener$$module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input=
module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener,TO_TINY_COLOR$$module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input=module$src$shared$util$toTinyColor.default,controlsUtil$$module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input=module$src$api$apps$sd_controls$components$util$sd_controls_components_util_util.default,MenuComponent$$module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input=
module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default;module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input.default.prototype=Object.create(module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.prototype);
module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input.default.prototype.hide=function(a){module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.prototype.hide.call(this,a);this.colorPicker&&module$src$api$apps$sd_controls$components$util$sd_controls_components_util_util.default.hide(this.colorPicker,a)};
module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input.default.prototype.update=function(a){a=(0,module$src$shared$util$toTinyColor.default)(a);"color"===this.inputComponent.type?(this.inputComponent.value=a.toHexString(),this.pushToValueStack(this.inputComponent.value),this._currentValue=this.inputComponent.value):(a=a.toRgbString(),this.pushToValueStack(a),this._currentValue=a,$("#"+this.slugId+"-color").spectrum("set",a));return!0};
module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input.default.prototype.onSettingUpdate=function(a){a=(0,module$src$shared$util$toTinyColor.default)(a);"color"===this.inputComponent.type?this.inputComponent.value=a.toHexString():(a=a.toRgbString(),$("#"+this.slugId+"-color").spectrum("set",a))};var module$src$api$apps$sd_controls$components$component_button$sd_controls_components_button_input={default:function(a,b,c,g,d){module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.call(this,b,c,g,d);b=c.name;this.row.removeChild(this.label);this.inputComponent=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("button",{id:this.slugId+"_button",parent:this.inputContainer,innerHTML:b,classList:"uk-button uk-button-default uk-button-small uk-width-expand text-transform-none uk-padding-remove sd-control-button".split(" "),
attributes:{type:"button",name:this.slugId+"_button"}});this.valueConversion=c.valueConversion?c.valueConversion:"none";(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener)(g.api,a,this,this.inputComponent,"click",this.update.bind(this))}},MenuComponent$$module$src$api$apps$sd_controls$components$component_button$sd_controls_components_button_input=module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default,
createDOMElement$$module$src$api$apps$sd_controls$components$component_button$sd_controls_components_button_input=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement,setDomElementEventListener$$module$src$api$apps$sd_controls$components$component_button$sd_controls_components_button_input=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener;
module$src$api$apps$sd_controls$components$component_button$sd_controls_components_button_input.default.prototype=Object.create(module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.prototype);module$src$api$apps$sd_controls$components$component_button$sd_controls_components_button_input.default.prototype.update=function(){return this.inContentEditMode?!1:!0};
module$src$api$apps$sd_controls$components$component_button$sd_controls_components_button_input.default.prototype.setEditable=function(a){a?(this.inputComponent.contentEditable=!0,this.inputComponent.addEventListener("input",function(a){this.wasEdited=!0;this.newName=a.target.innerText}.bind(this))):this.inputComponent.removeAttribute("disabled");this.inContentEditMode=a};var module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input={default:function(a,b,c,g,d){module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.call(this,b,c,g,d);b=c.choices;d=c.defval;var f;this.inputComponent=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("select",{id:this.slugId+"-form",parent:this.inputContainer,classList:["uk-select","uk-form-small","uk-width-expand"]});
this.choices=b.length;this.choiceValues=b;for(f=0;f<b.length;f++)this["cOption"+f]=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("option",{id:this.slugId+"-option-"+f,parent:this.inputComponent,innerHTML:b[f],value:f,classList:[],attributes:{name:this.slugId+"-option-"+f}}),f===d&&(this["cOption"+f].selected=!0);this.valueConversion=c.valueConversion?c.valueConversion:"selectedIndex";(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener)(g.api,
a,this,this.inputComponent,"change",this.update.bind(this))}},createDOMElement$$module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement,setDomElementEventListener$$module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener,
MenuComponent$$module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input=module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default;module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input.default.prototype=Object.create(module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.prototype);
module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input.default.prototype.update=function(a){this.pushToValueStack(a);this._currentValue=this.inputComponent.value=a;for(var b=0;b<this.choices;b++)this["cOption"+b].selected=b===a?!0:!1;return!0};
module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input.default.prototype.onSettingUpdate=function(a){this.inputComponent.value=a;for(var b=0;b<this.choices;b++)this["cOption"+b].selected=b===a?!0:!1;return!0};var module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu={default:function(a,b,c,g,d){module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.call(this,b,c,g,d);b=c.choices;d=c.defval;var f,p;this.pushToValueStack(d);this.cForm=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("form",{id:this.slugId+"-form",parent:this.inputContainer,classList:[STRING_SDVCP$$module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu+
"dropdown-input-form",STRING_SDVCPC$$module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu]});this.inputComponent=[];var e=0;for(p=b.length;e<p;++e){var m=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("div",{parent:this.cForm});m=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("label",{id:this.slugId+"-label-"+e,parent:m,innerHTML:b[e],
classList:[STRING_SDVCP$$module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu+"checklist-input-checkbox-label"]});var h=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("input",{id:this.slugId+"-checkbox-"+e,parent:m,innerHTML:b[e],value:e,attributes:{type:"checkbox",name:this.slugId+"-checkbox-"+e}});(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("div",
{id:this.slugId+"-checkbox-helper",parent:m,classList:STRING_SDVCP$$module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu+"checklist-input-boxhelper",attributes:{"for":this.slugId+"-checkbox-"+e}});h.checked=d.includes(e);this.inputComponent.push(h);this.valueConversion=c.valueConversion?c.valueConversion:function(){var a=[];for(f=0;f<this.inputComponent.length;++f)this.inputComponent[f].checked&&a.push(f);return a};(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener)(g.api,
a,this,h,"change",this.update.bind(this))}}},createDOMElement$$module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement,setDomElementEventListener$$module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener,
controlsUtil$$module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu=module$src$api$apps$sd_controls$components$util$sd_controls_components_util_util.default,MenuComponent$$module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu=module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default,STRING_SDVCP$$module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu=
"sdv-control-panel-",STRING_SDVCPC$$module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu="sdv-control-panel-control";module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu.default.prototype=Object.create(module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.prototype);
module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu.default.prototype.hide=function(a){this.hidden=a;module$src$api$apps$sd_controls$components$util$sd_controls_components_util_util.default.hide(this.cForm,a)};
module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu.default.prototype.update=function(a){this.pushToValueStack(a);this._currentValue=a;for(var b=0,c=this.inputComponent.length;b<c;++b)this.inputComponent[b].checked=a.includes(b);return!0};
module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu.default.prototype.onSettingUpdate=function(a){for(var b=0,c=this.inputComponent.length;b<c;++b)this.inputComponent[b].checked=a.includes(b)};var module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file={default:function(a,b,c,g,d){module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.call(this,b,c,g,d);log$$module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file.showMessage=g.options&&g.options.showMessage?g.options.showMessage:function(){};b=c.name;var f=null;this.label.innerHTML="Select file\u2026";this.inputComponent=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("button",
{id:this.slugId+"_button",parent:this.inputContainer,innerHTML:b,classList:"uk-button uk-button-default uk-button-small uk-width-expand text-transform-none uk-padding-remove sd-control-button".split(" "),attributes:{type:"button",name:this.slugId+"_button"}});this.fileinput=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("input",{id:this.slugId+"_fileinput",parent:this.inputContainer,style:"display:none",accept:c.format.join(","),attributes:{type:"file",
name:this.slugId+"_fileinput"}});this.fileinput.style.display="none";this.inputComponent.addEventListener("click",function(){this.fileinput.click()}.bind(this));this.valueConversion=function(a,b){return f&&0<f.length?(a=f[0],f=null,a):0<b.files.length?b.files[0]:""};this.checkMimeType=function(a){return c.format.includes(a)};this.getParamDef=function(){return c};this.checkSize=function(a){return a<=c.max};this.clear=function(){f=null;this.pushToValueStack(null);this._currentValue=null;0<this.fileinput.files.length?
this.fileinput.value=null:this.change_handler()};this.change_handler=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener)(g.api,a,this,this.fileinput,"change",this.update.bind(this));a=function(a){a.stopPropagation();a.preventDefault()};this.inputComponent.addEventListener("dragenter",a,!1);this.inputComponent.addEventListener("dragover",a,!1);this.inputComponent.addEventListener("drop",function(a){a.stopPropagation();a.preventDefault();
a.dataTransfer&&(f=a.dataTransfer.files);this.change_handler()},!1)}},createDOMElement$$module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement,setDomElementEventListener$$module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener,
GLOBAL_UTILS$$module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file=module$src$shared$util$GlobalUtils.default,MenuComponent$$module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file=module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default,log$$module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file={showMessage:function(){}};
module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file.default.prototype=Object.create(module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.prototype);module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file.default.prototype.uploadError=function(){this.label.innerHTML="upload failed";this.label.classList.add("uk-text-danger")};
module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file.default.prototype.removeUploadError=function(){this.label.innerHTML="";this.label.classList.remove("uk-text-danger")};
module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file.default.prototype.update=function(a){var b=this;if(this.inContentEditMode)return!1;this.pushToValueStack(a);this._currentValue=a;if(a instanceof File){a._type=0<a.type.length?a.type:module$src$shared$util$GlobalUtils.default.guessMimeTypeFromFilename(a.name);if(!this.checkMimeType(a._type))return this.uploadError(),log$$module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file.showMessage("warning",
"Allowed file types: "+this.getParamDef().format.join(", ")),!1;if(!this.checkSize(a.size))return this.uploadError(),log$$module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file.showMessage("warning","Maximum file size: "+this.getParamDef().max+" bytes"),!1;this.removeUploadError();this.label.innerHTML='<div uk-spinner="ratio: 0.5"></div>';this.fileName=a.name}else"string"===typeof a&&0<a.length?(this.label.innerHTML=this.fileName?this.fileName+"  \u274c":"Saved file  \u274c",
this.label.onclick=function(){b.clear()}):(this.label.innerHTML="Select file\u2026",this.label.onclick=null);return!0};module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file.default.prototype.setEditable=function(a){a?(this.inputComponent.contentEditable=!0,this.inputComponent.addEventListener("input",function(a){this.wasEdited=!0;this.newName=a.target.innerText}.bind(this))):this.inputComponent.contentEditable=!1;this.inContentEditMode=a};var module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion={default:function(a,b,c,g){var d=this;module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.call(this,b,c,g);this.rows=[];Object.keys(c.settings).forEach(function(a){a=(0,module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory.default)(c.settings[a].type,c.settings[a],g,d.accordionContent);d.rows.push(a);a.label.classList.add("uk-margin-small-left");
a.label.classList.remove("uk-text-uppercase");a.inputComponent?a.inputComponent.classList.add("uk-margin-small-left"):a.container?a.container.classList.add("uk-margin-small-left"):a.inputContainer&&a.inputContainer.classList.add("uk-margin-small-left")})}},createDOMElement$$module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement,MenuComponent$$module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion=
module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default;
module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion.default.prototype.createRow=function(a,b,c){this.row=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("div",{id:this.slugId+"-controlmenu-row",name:this.slugId+"-controlmenu-row",parent:c||this.controlsContext.container,classList:["uk-margin-remove"],attributes:{"uk-grid":'margin: "";'}});c=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("ul",
{parent:this.row,attributes:{"uk-accordion":"multiple: false"},classList:["uk-width-1-1"]});this.parametersEl=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("li",{parent:c});this.label=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("a",{id:this.slugId+"-a",parent:this.parametersEl,innerHTML:b.name,classList:"uk-accordion-title uk-width-1-1 uk-form-label uk-text-uppercase uk-text-small uk-padding-small sdv-control-panel-row-border".split(" "),
attributes:{"for":"slider"===this.slugId+"-"+a?"range":a,"param-id":b.id}});this.accordionContent=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("div",{parent:this.parametersEl,classList:["uk-accordion-content","uk-margin-remove"],attributes:{"uk-grid":""}});this.controlsContext.options&&this.controlsContext.options.editMode&&this.label.classList.add("sdv-edit-mode")};var module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory={default:function(a,b,c,g){if(!c.api)throw Error("Controls context needs to have api property.");if(!c.container)throw Error("Controls context needs to have container property.");if(!c.plugins)throw Error("Controls context needs to have plugins property.");if(!c.runtimeId)throw Error("Controls context needs to have runtimeId property.");a=new MenuElementConstructors$$module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory[a](c.options&&
c.options.settings?b.setting:b.id,a,b,c,g);c.controls.push(a);return a}},MenuElementConstructors$$module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory={slider:module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider.default,string:module$src$api$apps$sd_controls$components$component_string$sd_controls_components_string_input.default,boolean:module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default,
color:module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input.default,button:module$src$api$apps$sd_controls$components$component_button$sd_controls_components_button_input.default,dropdown:module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input.default,form:module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu.default,file:module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file.default,
multiple:module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion.default};var module$src$api$apps$sd_controls$settings$sd_controls_settings_groups={},createDomElement$$module$src$api$apps$sd_controls$settings$sd_controls_settings_groups=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement,groupSettings$$module$src$api$apps$sd_controls$settings$sd_controls_settings_groups=[{groupId:1,icon:"world"},{groupId:2,icon:"bell"},{groupId:3,icon:"image"},{groupId:4,icon:"video-camera"}];
module$src$api$apps$sd_controls$settings$sd_controls_settings_groups.default=function(a){var b=this,c=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("ul",{parent:a,classList:["uk-margin-remove","uk-width-1-1","sdv-control-panel-row-border","shapediver-settings-tabs"],attributes:{"uk-tab":"swiping: false;"}}),g=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("ul",{parent:a,
classList:["uk-switcher","uk-width-1-1","uk-margin-remove-top"]});this.groups={};groupSettings$$module$src$api$apps$sd_controls$settings$sd_controls_settings_groups.forEach(function(a){(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("li",{parent:c,classList:["uk-padding-remove","uk-width-1-4"],innerHTML:'<a><span uk-icon="'+a.icon+'"></span></a>'});var d=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("li",
{parent:g,attributes:{"uk-grid":""},classList:["uk-width-1-1","uk-margin-remove"]});b.groups[a.groupId]={contentEl:d}})};module$src$api$apps$sd_controls$settings$sd_controls_settings_groups.default.prototype.getGroup=function(a){return this.groups[a].contentEl};/*
 MIT
*/
var module$src$shared$util$Sortable={};
module$src$shared$util$Sortable.default=function(){function a(a,b){if(!a||!a.nodeType||1!==a.nodeType)throw"Sortable: `el` must be HTMLElement, and not "+{}.toString.call(a);this.el=a;this.options=b=l({},b);a[R]=this;var c={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(a.nodeName)?"li":">*",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",ignore:"a, img",filter:null,animation:0,setData:function(a,b){a.setData("Text",
b.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1},d;for(d in c)d in b||(b[d]=c[d]);V(b);for(var n in this)"_"===n.charAt(0)&&(this[n]=this[n].bind(this));this.nativeDraggable=b.forceFallback?!1:X;g(a,"mousedown",this._onTapStart);g(a,"touchstart",this._onTapStart);this.nativeDraggable&&(g(a,"dragover",this),g(a,"dragenter",this));P.push(this._onDragOver);b.store&&this.sort(b.store.get(this))}function b(a){y&&
y.state!==a&&(p(y,"display",a?"none":""),!a&&y.state&&z.insertBefore(y,v),y.state=a)}function c(a,b,c){if(a){c=c||K;b=b.split(".");var d=b.shift().toUpperCase(),l=new RegExp("\\s("+b.join("|")+")(?=\\s)","g");do if(">*"===d&&a.parentNode===c||!(""!==d&&a.nodeName.toUpperCase()!=d||b.length&&((" "+a.className+" ").match(l)||[]).length!=b.length))return a;while(a!==c&&(a=a.parentNode))}return null}function g(a,b,c){a.addEventListener(b,c,!1)}function d(a,b,c){a.removeEventListener(b,c,!1)}function f(a,
b,c){if(a)if(a.classList)a.classList[c?"add":"remove"](b);else{var d=(" "+a.className+" ").replace(W," ").replace(" "+b+" "," ");a.className=(d+(c?" "+b:"")).replace(W," ")}}function p(a,b,c){var d=a&&a.style;if(d){if(void 0===c)return K.defaultView&&K.defaultView.getComputedStyle?c=K.defaultView.getComputedStyle(a,""):a.currentStyle&&(c=a.currentStyle),void 0===b?c:c[b];b in d||(b="-webkit-"+b);d[b]=c+("string"===typeof c?"":"px")}}function e(a,b,c){if(a){a=a.getElementsByTagName(b);b=0;var d=a.length;
if(c)for(;b<d;b++)c(a[b],b);return a}return[]}function m(a,b,c,d,l,n,e){var h=K.createEvent("Event"),m=(a||b[R]).options,f="on"+c.charAt(0).toUpperCase()+c.substr(1);h.initEvent(c,!0,!0);h.to=b;h.from=l||b;h.item=d||b;h.clone=y;h.oldIndex=n;h.newIndex=e;b.dispatchEvent(h);m[f]&&m[f].call(a,h)}function h(a,b,c,d,l,n){var e=a[R],h=e.options.onMove,m;var f=K.createEvent("Event");f.initEvent("move",!0,!0);f.to=b;f.from=a;f.dragged=c;f.draggedRect=d;f.related=l||b;f.relatedRect=n||b.getBoundingClientRect();
a.dispatchEvent(f);h&&(m=h.call(e,f));return m}function r(a){a.draggable=!1}function q(){U=!1}function t(a){a=a.tagName+a.className+a.src+a.href+a.textContent;for(var b=a.length,c=0;b--;)c+=a.charCodeAt(b);return c.toString(36)}function u(a){var b=0;if(!a||!a.parentNode)return-1;for(;a&&(a=a.previousElementSibling);)"TEMPLATE"!==a.nodeName.toUpperCase()&&b++;return b}function n(a,b){var c,d;return function(){void 0===c&&(c=arguments,d=this,setTimeout(function(){1===c.length?a.call(d,c[0]):a.apply(d,
c);c=void 0},b))}}function l(a,b){if(a&&b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}var v,x,w,y,z,B,A,D,H,G,E,J,F,C,I={},M,N,Q,W=/\s+/g,R="Sortable"+(new Date).getTime(),O=window,K=O.document,Z=O.parseInt,X=!!("draggable"in K.createElement("div")),S=function(a){a=K.createElement("x");a.style.cssText="pointer-events:auto";return"auto"===a.style.pointerEvents}(),U=!1,T=Math.abs,P=[],Y=n(function(a,b,c){if(c&&b.scroll){var d=b.scrollSensitivity,l=b.scrollSpeed,n=a.clientX;a=a.clientY;
var e=window.innerWidth,h=window.innerHeight;if(D!==c&&(A=b.scroll,D=c,!0===A)){A=c;do if(A.offsetWidth<A.scrollWidth||A.offsetHeight<A.scrollHeight)break;while(A=A.parentNode)}if(A){var f=A;b=A.getBoundingClientRect();var m=(T(b.right-n)<=d)-(T(b.left-n)<=d);var q=(T(b.bottom-a)<=d)-(T(b.top-a)<=d)}m||q||(m=(e-n<=d)-(n<=d),q=(h-a<=d)-(a<=d),(m||q)&&(f=O));if(I.vx!==m||I.vy!==q||I.el!==f)I.el=f,I.vx=m,I.vy=q,clearInterval(I.pid),f&&(I.pid=setInterval(function(){f===O?O.scrollTo(O.pageXOffset+m*l,
O.pageYOffset+q*l):(q&&(f.scrollTop+=q*l),m&&(f.scrollLeft+=m*l))},24))}},30),V=function(a){var b=a.group;b&&"object"==typeof b||(b=a.group={name:b});["pull","put"].forEach(function(a){a in b||(b[a]=!0)});a.groups=" "+b.name+(b.put.join?" "+b.put.join(" "):"")+" "};a.prototype={constructor:a,_onTapStart:function(a){var b=this,d=this.el,l=this.options,n=a.touches&&a.touches[0],e=(n||a).target,h=e,f=l.filter;if(!("mousedown"===a.type&&0!==a.button||l.disabled)&&(e=c(e,l.draggable,d))){J=u(e);if("function"===
typeof f){if(f.call(this,a,e,this)){m(b,h,"filter",e,d,J);a.preventDefault();return}}else if(f&&(f=f.split(",").some(function(a){if(a=c(h,a.trim(),d))return m(b,a,"filter",e,d,J),!0}))){a.preventDefault();return}l.handle&&!c(h,l.handle,d)||this._prepareDragStart(a,n,e)}},_prepareDragStart:function(a,b,c){var d=this,l=d.el,n=d.options,h=l.ownerDocument;c&&!v&&c.parentNode===l&&(M=a,z=l,v=c,x=v.parentNode,B=v.nextSibling,C=n.group,a=function(){d._disableDelayedDrag();v.draggable=!0;f(v,d.options.chosenClass,
!0);d._triggerDragStart(b)},n.ignore.split(",").forEach(function(a){e(v,a.trim(),r)}),g(h,"mouseup",d._onDrop),g(h,"touchend",d._onDrop),g(h,"touchcancel",d._onDrop),n.delay?(g(h,"mouseup",d._disableDelayedDrag),g(h,"touchend",d._disableDelayedDrag),g(h,"touchcancel",d._disableDelayedDrag),g(h,"mousemove",d._disableDelayedDrag),g(h,"touchmove",d._disableDelayedDrag),d._dragStartTimer=setTimeout(a,n.delay)):a())},_disableDelayedDrag:function(){var a=this.el.ownerDocument;clearTimeout(this._dragStartTimer);
d(a,"mouseup",this._disableDelayedDrag);d(a,"touchend",this._disableDelayedDrag);d(a,"touchcancel",this._disableDelayedDrag);d(a,"mousemove",this._disableDelayedDrag);d(a,"touchmove",this._disableDelayedDrag)},_triggerDragStart:function(a){a?(M={target:v,clientX:a.clientX,clientY:a.clientY},this._onDragStart(M,"touch")):this.nativeDraggable?(g(v,"dragend",this),g(z,"dragstart",this._onDragStart)):this._onDragStart(M,!0);try{K.selection?K.selection.empty():window.getSelection().removeAllRanges()}catch(L){}},
_dragStarted:function(){z&&v&&(f(v,this.options.ghostClass,!0),a.active=this,m(this,z,"start",v,z,J))},_emulateDragOver:function(){if(N&&(this._lastX!==N.clientX||this._lastY!==N.clientY)){this._lastX=N.clientX;this._lastY=N.clientY;S||p(w,"display","none");var a=K.elementFromPoint(N.clientX,N.clientY),b=a,c=" "+this.options.group.name,d=P.length;if(b){do{if(b[R]&&-1<b[R].options.groups.indexOf(c)){for(;d--;)P[d]({clientX:N.clientX,clientY:N.clientY,target:a,rootEl:b});break}a=b}while(b=b.parentNode)
}S||p(w,"display","")}},_onTouchMove:function(b){if(M){a.active||this._dragStarted();this._appendGhost();var c=b.touches?b.touches[0]:b,d=c.clientX-M.clientX,l=c.clientY-M.clientY;d=b.touches?"translate3d("+d+"px,"+l+"px,0)":"translate("+d+"px,"+l+"px)";Q=!0;N=c;p(w,"webkitTransform",d);p(w,"mozTransform",d);p(w,"msTransform",d);p(w,"transform",d);b.preventDefault()}},_appendGhost:function(){if(!w){var a=v.getBoundingClientRect(),b=p(v),c=this.options;w=v.cloneNode(!0);f(w,c.ghostClass,!1);f(w,c.fallbackClass,
!0);p(w,"top",a.top-Z(b.marginTop,10));p(w,"left",a.left-Z(b.marginLeft,10));p(w,"width",a.width);p(w,"height",a.height);p(w,"opacity","0.8");p(w,"position","fixed");p(w,"zIndex","100000");p(w,"pointerEvents","none");c.fallbackOnBody&&K.body.appendChild(w)||z.appendChild(w);b=w.getBoundingClientRect();p(w,"width",2*a.width-b.width);p(w,"height",2*a.height-b.height)}},_onDragStart:function(a,b){a=a.dataTransfer;var c=this.options;this._offUpEvents();"clone"==C.pull&&(y=v.cloneNode(!0),p(y,"display",
"none"),z.insertBefore(y,v));b?("touch"===b?(g(K,"touchmove",this._onTouchMove),g(K,"touchend",this._onDrop),g(K,"touchcancel",this._onDrop)):(g(K,"mousemove",this._onTouchMove),g(K,"mouseup",this._onDrop)),this._loopId=setInterval(this._emulateDragOver,50)):(a&&(a.effectAllowed="move",c.setData&&c.setData.call(this,a,v)),g(K,"drop",this),setTimeout(this._dragStarted,0))},_onDragOver:function(a){var d=this.el,l;var n=this.options;var e=n.group;var f=e.put,m=C===e,g=n.sort;void 0!==a.preventDefault&&
(a.preventDefault(),!n.dragoverBubble&&a.stopPropagation());Q=!0;if(C&&!n.disabled&&(m?g||(l=!z.contains(v)):C.pull&&f&&(C.name===e.name||f.indexOf&&~f.indexOf(C.name)))&&(void 0===a.rootEl||a.rootEl===this.el)&&(Y(a,n,this.el),!U))if(e=c(a.target,n.draggable,d),n=v.getBoundingClientRect(),l)b(!0),y||B?z.insertBefore(v,y||B):g||z.appendChild(v);else if(!(l=0===d.children.length||d.children[0]===w)&&(l=d===a.target)&&(e=d.lastElementChild,l=e.getBoundingClientRect(),l=e=(5<a.clientY-(l.top+l.height)||
5<a.clientX-(l.right+l.width))&&e),l){if(e){if(e.animated)return;r=e.getBoundingClientRect()}b(m);!1!==h(z,d,v,n,e,r)&&(v.contains(d)||(d.appendChild(v),x=d),this._animate(n,v),e&&this._animate(r,e))}else if(e&&!e.animated&&e!==v&&void 0!==e.parentNode[R]){H!==e&&(H=e,G=p(e),E=p(e.parentNode));var r=e.getBoundingClientRect(),t=r.right-r.left,u=r.bottom-r.top;g=/left|right|inline/.test(G.cssFloat+G.display)||"flex"==E.display&&0===E["flex-direction"].indexOf("row");l=e.offsetWidth>v.offsetWidth;f=
e.offsetHeight>v.offsetHeight;t=.5<(g?(a.clientX-r.left)/t:(a.clientY-r.top)/u);a=e.nextElementSibling;u=h(z,d,v,n,e,r);!1!==u&&(U=!0,setTimeout(q,30),b(m),1===u||-1===u?m=1===u:g?(m=v.offsetTop,g=e.offsetTop,m=m===g?e.previousElementSibling===v&&!l||t&&l:g>m):m=a!==v&&!f||t&&f,v.contains(d)||(m&&!a?d.appendChild(v):e.parentNode.insertBefore(v,m?a:e)),x=v.parentNode,this._animate(n,v),this._animate(r,e))}},_animate:function(a,b){var c=this.options.animation;if(c){var d=b.getBoundingClientRect();p(b,
"transition","none");p(b,"transform","translate3d("+(a.left-d.left)+"px,"+(a.top-d.top)+"px,0)");p(b,"transition","all "+c+"ms");p(b,"transform","translate3d(0,0,0)");clearTimeout(b.animated);b.animated=setTimeout(function(){p(b,"transition","");p(b,"transform","");b.animated=!1},c)}},_offUpEvents:function(){var a=this.el.ownerDocument;d(K,"touchmove",this._onTouchMove);d(a,"mouseup",this._onDrop);d(a,"touchend",this._onDrop);d(a,"touchcancel",this._onDrop)},_onDrop:function(b){var c=this.el,l=this.options;
clearInterval(this._loopId);clearInterval(I.pid);clearTimeout(this._dragStartTimer);d(K,"mousemove",this._onTouchMove);this.nativeDraggable&&(d(K,"drop",this),d(c,"dragstart",this._onDragStart));this._offUpEvents();if(b){Q&&(b.preventDefault(),!l.dropBubble&&b.stopPropagation());w&&w.parentNode.removeChild(w);if(v&&(this.nativeDraggable&&d(v,"dragend",this),r(v),f(v,this.options.ghostClass,!1),f(v,this.options.chosenClass,!1),z!==x?(F=u(v),0<=F&&(m(null,x,"sort",v,z,J,F),m(this,z,"sort",v,z,J,F),
m(null,x,"add",v,z,J,F),m(this,z,"remove",v,z,J,F))):(y&&y.parentNode.removeChild(y),v.nextSibling!==B&&(F=u(v),0<=F&&(m(this,z,"update",v,z,J,F),m(this,z,"sort",v,z,J,F)))),a.active)){if(null===F||-1===F)F=J;m(this,z,"end",v,z,J,F);this.save()}z=v=x=w=B=y=A=D=M=N=Q=F=H=G=C=a.active=null}},handleEvent:function(a){var b=a.type;"dragover"===b||"dragenter"===b?v&&(this._onDragOver(a),a.dataTransfer&&(a.dataTransfer.dropEffect="move"),a.preventDefault()):"drop"!==b&&"dragend"!==b||this._onDrop(a)},toArray:function(){for(var a=
[],b,d=this.el.children,l=0,n=d.length,e=this.options;l<n;l++)b=d[l],c(b,e.draggable,this.el)&&a.push(b.getAttribute(e.dataIdAttr)||t(b));return a},sort:function(a){var b={},d=this.el;this.toArray().forEach(function(a,l){l=d.children[l];c(l,this.options.draggable,d)&&(b[a]=l)},this);a.forEach(function(a){b[a]&&(d.removeChild(b[a]),d.appendChild(b[a]))})},save:function(){var a=this.options.store;a&&a.set(this)},closest:function(a,b){return c(a,b||this.options.draggable,this.el)},option:function(a,
b){var c=this.options;if(void 0===b)return c[a];c[a]=b;"group"===a&&V(c)},destroy:function(){var a=this.el;a[R]=null;d(a,"mousedown",this._onTapStart);d(a,"touchstart",this._onTapStart);this.nativeDraggable&&(d(a,"dragover",this),d(a,"dragenter",this));Array.prototype.forEach.call(a.querySelectorAll("[draggable]"),function(a){a.removeAttribute("draggable")});P.splice(P.indexOf(this._onDragOver),1);this._onDrop();this.el=a=null}};a.utils={on:g,off:d,css:p,find:e,is:function(a,b){return!!c(a,b,a)},
extend:l,throttle:n,closest:c,toggleClass:f,index:u};a.create=function(b,c){return new a(b,c)};a.version="1.4.2";return a}();var module$src$api$apps$sd_controls$commit_queues$SDCommitQueue={default:function(a,b,c){this.use=c&&(c.defval||1==c);this._queue={};this._api=a;this._numOfElementsForCommit=0;this.container=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("div",{parent:b,classList:["sd-commit-container","uk-margin-remove"],attributes:{"uk-grid":""}});a="uk-button uk-button-default uk-button-small uk-width-1-2 sd-commit-button uk-padding-remove".split(" ");
this._commitBtn=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("button",{parent:this.container,innerHTML:"Apply",classList:a});this._cancelBtn=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("button",{parent:this.container,innerHTML:"cancel",classList:a});this._commitBtn.onclick=function(){this.execute()}.bind(this);this._cancelBtn.onclick=function(){for(id in this._queue)this._queue[id].menuEl.setToInitalValue();
this.clear()}.bind(this);this.setUse(this.use);this.enableDisableCommitButtons()}},createDOMElement$$module$src$api$apps$sd_controls$commit_queues$SDCommitQueue=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement;
module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default.prototype.add=function(a,b,c){this._queue[b]={menuEl:a,val:c};a.isCurrentValueSameAsInital()?(this.removeCommitClass(a),!0===a.isChanged&&(this._numOfElementsForCommit--,a.isChanged=!1)):(this.addCommitClass(a),!1===a.isChanged&&(a.isChanged=!0,this._numOfElementsForCommit++));this.enableDisableCommitButtons()};
module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default.prototype.clear=function(){for(id in this._queue){var a=this._queue[id].menuEl;a.isChanged=!1;this.removeCommitClass(a)}this._queue={};this._numOfElementsForCommit=0;this.enableDisableCommitButtons()};
module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default.prototype.enableDisableCommitButtons=function(){0<this._numOfElementsForCommit?(this._commitBtn.removeAttribute("disabled"),this._cancelBtn.removeAttribute("disabled")):(this._commitBtn.setAttribute("disabled",!0),this._cancelBtn.setAttribute("disabled",!0))};module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default.prototype.addCommitClass=function(a){a.row.classList.add("sd-commit")};
module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default.prototype.removeCommitClass=function(a){a.row.classList.remove("sd-commit")};module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default.prototype.execute=function(){throw new Exception("Needs to be overriden");};module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default.prototype.setUse=function(a){a?(this.container.removeAttribute("hidden"),this.use=!0):(this.container.setAttribute("hidden",!0),this.use=!1)};var module$src$api$apps$sd_controls$commit_queues$SDCommitParametersQueue={default:function(a,b,c){module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default.call(this,a,b,c);a.addEventListener(a.EVENTTYPE.SETTINGS_UPDATE,function(a){if("commitParameters"===a.settings.key&&(this.setUse(a.settings.valueNew),!this.use)){for(id in this._queue)this._queue[id].menuEl.setToInitalValue();this.clear()}}.bind(this))}},SDCommitQueue$$module$src$api$apps$sd_controls$commit_queues$SDCommitParametersQueue=
module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default;module$src$api$apps$sd_controls$commit_queues$SDCommitParametersQueue.default.prototype=Object.create(module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default.prototype);module$src$api$apps$sd_controls$commit_queues$SDCommitParametersQueue.default.prototype.execute=function(){var a=[];for(id in this._queue){var b=this._queue[id];a.push({id:id,value:b.val});b.menuEl.setStackToLast()}this._api.parameters.updateAsync(a);this.clear()};var module$src$api$apps$sd_controls$commit_queues$SDCommitSettingsQueue={default:function(a,b,c){module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default.call(this,a,b,c);a.addEventListener(a.EVENTTYPE.SETTINGS_UPDATE,function(a){if("commitSettings"===a.settings.key&&(this.setUse(a.settings.valueNew),!this.use)){for(id in this._queue)this._queue[id].menuEl.setToInitalValue();this.clear()}}.bind(this))}},SDCommitQueue$$module$src$api$apps$sd_controls$commit_queues$SDCommitSettingsQueue=
module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default;module$src$api$apps$sd_controls$commit_queues$SDCommitSettingsQueue.default.prototype=Object.create(module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default.prototype);module$src$api$apps$sd_controls$commit_queues$SDCommitSettingsQueue.default.prototype.execute=function(){for(id in this._queue)this._api.updateSettingAsync(id,this._queue[id].val);this.clear()};var module$src$api$apps$SDControls={},SDControlsSettings$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$settings$sd_controls_settings.default,domUtil$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default,createMenuElement$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory.default,GroupSettings$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$settings$sd_controls_settings_groups.default,
SORTABLE$$module$src$api$apps$SDControls=module$src$shared$util$Sortable.default,SDParametersQueue$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$commit_queues$SDCommitParametersQueue.default,SDSettingsQueue$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$commit_queues$SDCommitSettingsQueue.default;
module$src$api$apps$SDControls.default=function(a,b,c,g){function d(a){var b="landscape"===a.detail.mode||u.isMobileDevice&&window.innerWidth<window.innerHeight;a={};var d=(a[module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.SLIDER]=2,a[module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.STRING]=2,a[module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.BOOLEAN]=1,a[module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.COLOR]=
1,a[module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.BUTTON]=1,a[module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.DROPDOWN]=2,a[module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.CHECKLIST]=2,a[module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.FILE]=1,a[module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.MULTIPLE]=4,a),l=["uk-width-1-1","uk-width-1-2","uk-width-1-4",
"uk-width-expand"],n=function(a){for(var e=0,h=[],f=function(){var a=0,b=function(b,c){h.filter(function(a){return a.spaceReq===b}).forEach(function(b){l.forEach(function(a){return b.domEl.classList.remove(a)});b.domEl.classList.add("uk-width-1-"+c);a+=b.spaceReq})};b(4,1);b(2,2);b(1,4);4>a&&(b=h.find(function(a){return a.domEl.classList.contains("uk-width-1-4")})||h.find(function(a){return a.domEl.classList.contains("uk-width-1-2")}))&&(b=b.domEl.classList,b.contains("uk-width-1-2")&&!b.contains("uk-width-1-4")&&
(b.remove("uk-width-1-2"),b.add("uk-width-expand")),b.contains("uk-width-1-4")&&b.remove("uk-width-1-4"),b.add(2<a?"uk-width-1-2":"uk-width-expand"));for(;0<h.length;)h.pop();e=0},m={},q=0;q<a.length;q++){var g=a[q],r="defaultKey";g.groupId&&(r=g.groupId);m[r]||(m[r]=[]);m[r].push(g)}Object.keys(m).forEach(function(a){a=m[a];for(var q=a.length,g={},r=0;r<q;g={domEl:g.domEl},r++){var v=a[r];if(!v.hidden||c.editMode){g.domEl=v.row;if(b)l.forEach(function(a){return function(b){a.domEl.classList.remove(b);
a.domEl.classList.add("uk-width-1-1")}}(g));else{var t=d[v.type];e+=t;4>=e?(h.push({domEl:g.domEl,spaceReq:t}),r===q-1&&f()):4<e&&(f(),h.push({domEl:g.domEl,spaceReq:t}),e=t,r===q-1&&f())}v.rows&&n(v.rows)}}})};n(w);A.setAttribute("uk-height-match","")}function f(){for(;v.firstChild;)v.removeChild(v.firstChild);x.length=0;w.length=0;y.length=0}function p(){var a=l("i",{classList:["sdv-control-brand-color","uk-margin-left"],attributes:{"uk-icon":"icon: file-edit; ratio: 0.7;"}});a.edit=!0;B.firstChild.appendChild(a);
a.onclick=function(){if(a.edit){a.edit=!a.edit;a.setAttribute("uk-icon","icon: check; ratio: 0.7;");for(var b=0,c=w.length;b<c;b++)w[b].setEditable(!0)}else for(a.edit=!a.edit,a.setAttribute("uk-icon","icon: file-edit; ratio: 0.7;"),b=0,c=w.length;b<c;b++)w[b].setEditable(!1)};module$src$shared$util$Sortable.default.create(A,{handle:".jq-sdv-sort-bars",onEnd:function(a){var b=a.oldIndex;a=a.newIndex;null!=b&&null!=a&&b!=a&&w.splice(a,0,w.splice(b,1)[0])}})}function e(){var a;var b=0;for(a=w.length;b<
a;b++)w[b].row.parentNode===A&&A.removeChild(w[b].row);w.sort(function(a,b){return a.order-b.order});b=0;for(a=w.length;b<a;b++)(c&&c.editMode||!w[b].hidden)&&A.appendChild(w[b].row)}function m(a,b){if(a[b]){var d=Object.keys(a[b])[0],n=a[b][d];if(x.includes(d))h(a,b);else if((a=TYPE_CONVERSION[b+"."+n.type+"."+n.visualization])||(a=TYPE_CONVERSION[b+"."+n.type]),a||(a=TYPE_CONVERSION[b]),a){n.menuElementType=a;n.hidden=void 0===n.hidden?!1:n.hidden;n.order=void 0===n.order?Number.MAX_SAFE_INTEGER:
n.order;n.isParameter="parameter"===b;var f=(0,module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory.default)(n.menuElementType,n,u);f[b]=!0;w.push(f);x.push(d);c&&c.editMode&&(f.hideIcon=l("i",{id:f.slugId+"-hide-icon",attributes:{"uk-icon":"icon: ban; ratio: 0.6;"},classList:["uk-float-right","uk-margin-remove","uk-padding-remove-right","sdv-control-brand-color"]}),f.sortIcon=l("i",{id:f.slugId+"-sort-icon",attributes:{"uk-icon":"icon: move; ratio: 0.8;"},classList:["sdv-control-brand-color",
"uk-padding-remove-left","uk-margin-small-right","jq-sdv-sort-bars","uk-width-auto"]}),f.hideIcon.onclick=function(){f.toggleHide()},f.inputContainer.classList.remove("uk-width-1-1"),f.inputContainer.classList.add("uk-width-expand"),f.type===module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.BUTTON?(b=l("div",{classList:"uk-width-1-1"}),b.appendChild(f.hideIcon),f.row.insertBefore(b,f.row.childNodes[0])):(b=l("div",{classList:"uk-width-1-1"}),b.appendChild(f.hideIcon),f.row.insertBefore(b,
f.label)),f.row.insertBefore(f.sortIcon,f.inputContainer),v.classList.add("sdv-control-panel-edit-mode"));e()}}}function h(a,b){if(a[b]){var c=Object.keys(a[b])[0],d=a[b][c];if(x.includes(c)){a=0;for(b=w.length;a<b;a++){var l=w[a];if(l.id===c){void 0!==d.hidden&&l.hide(d.hidden);void 0!==d.order&&(l.order=d.order);void 0!==d.name&&l.name!==d.name&&(l.name=d.name,l.type===module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.BUTTON||l.type===module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.FILE?
l.inputComponent.innerHTML="<span>"+l.name+"</span>":l.label.innerHTML=l.name);break}}e()}else m(a,b)}}function r(a){var b,c,d,l;if(a.parameter){var n=0;for(d=y.length;n<d;n++){var e=y[n];if(b=a.parameter[e])for(c in b){var h=0;for(l=w.length;h<l;h++){var f=w[h];f.plugin===e&&f.id===c&&f.update(b[c])}}}}}function q(){if(g&&"function"===typeof g.onElementCreated)g.onElementCreated()}function t(){return u.useSpectrum?new Promise(function(a,b){var c=function(){var b=document.getElementById("sdv-spectrum");
null==b?(b=document.createElement("script"),b.setAttribute("id","sdv-spectrum"),b.src="https://viewer.shapediver.com/external/spectrum.js",b.addEventListener("load",function(){b.setAttribute("loaded",!0);a()}),document.head.appendChild(b)):"true"==b.getAttribute("loaded")?a():b.addEventListener("load",function(){a()})},d=document.getElementById("sdv-jquery");null==d?(d=document.createElement("script"),d.setAttribute("id","sdv-jquery"),d.setAttribute("integrity","sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="),
d.setAttribute("crossorigin","anonymous"),d.src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js",d.addEventListener("load",function(){d.setAttribute("loaded",!0);c()}),document.head.appendChild(d)):"true"==d.getAttribute("loaded")?c():d.addEventListener("load",function(){c()})}):new Promise(function(a){return a()})}var u={useSpectrum:!(module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.domSupportsHtml5Color()&&module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.isMobileDevice()),
isMobileDevice:module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.isMobileDevice(),controls:[]},n={"uk-grid":"","uk-height-match":""},l=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement;b.addEventListener("viewer-resized",function(a){d(a)});var v=b;TYPE_CONVERSION={"parameter.Int":"slider","parameter.Odd":"slider","parameter.Even":"slider","parameter.Float":"slider","parameter.String":"string","parameter.Bool":"boolean",
"parameter.Color":"color","parameter.StringList.checklist":"form","parameter.StringList.sequence":"dropdown","parameter.StringList.cycle":"dropdown","parameter.StringList.dropdown":"dropdown","parameter.File":"file","export":"button"};SETTINGS_LIST=new module$src$api$apps$sd_controls$settings$sd_controls_settings.default(a);var x=[],w=[],y=[],z=a.getRuntimeId(),B;var A=document.createElement("div");Object.keys(n).forEach(function(a){A.setAttribute(a,n[a])});["sdv-control-panel-row-container","uk-child-width-1-1",
"uk-margin-remove"].forEach(function(a){A.classList.add(a)});u.api=a;u.container=A;u.plugins=y;u.runtimeId=z;u.options=c;(function(){if(c&&c.settings)a.addEventListener("settings.update",function(a){if(a.settings){var b,c=a.settings.key,d=a.settings.valueNew;a=0;for(b=w.length;a<b;a++){var l=w[a];if(l.setting===c)if(l.valueConversion&&l.valueConversion.i)l.onSettingUpdate(l.valueConversion.i(l,d));else l.onSettingUpdate(d)}}}),B=l("button",{id:z+"_sd-control-panel-main-accordion-settings",parent:v,
classList:"sd-control-panel-accordion"}),l("div",{id:z+"_settings-text",parent:B,innerHTML:"VIEWER SETTINGS",classList:["shapediver-viewer-element","sd-control-panel-accordion-text"]}),v.appendChild(A),a.addEventListener&&a.addEventListener(a.EVENTTYPE.DESTROYED,function(a){"destroyed"===a.type&&f()}),t().then(function(){for(var b=new module$src$api$apps$sd_controls$settings$sd_controls_settings_groups.default(u.container),c={},d=$jscomp.makeIterator(Object.keys(SETTINGS_LIST)),l=d.next();!l.done;l=
d.next())s=l.value,setting=SETTINGS_LIST[s],c[setting.groupId]||(c[setting.groupId]=[]),c[setting.groupId].push(setting);d=$jscomp.makeIterator(Object.keys(c));for(l=d.next();!l.done;l=d.next())k=l.value,c[k].sort(function(a,b){return a.order-b.order}).forEach(function(c){void 0!==a.getSetting(c.setting)&&w.push((0,module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory.default)(c.type,c,u,b.getGroup(c.groupId)))});q()});else{B=l("button",{id:z+"_sd-control-panel-main-accordion-parameters",
parent:v,classList:"sd-control-panel-accordion"});var b=l("div",{id:z+"_settings-text",parent:B,innerHTML:"MODEL PARAMETERS",classList:["shapediver-viewer-element","sd-control-panel-accordion-text"]});v.appendChild(A);c&&c.editMode&&(b.style.width="80%");c&&c.editMode&&p();u.parametersQueue=new module$src$api$apps$sd_controls$commit_queues$SDCommitParametersQueue.default(a,v,c.commitParameters);var d=a.parameters.get().data.length+a.exports.get().data.length;a.parameters.addEventListener(a.parameters.EVENTTYPE.REGISTERED,
function(a){t().then(function(){m(a,"parameter");d--;0>=d&&q()})});a.parameters.addEventListener(a.parameters.EVENTTYPE.UPDATE,function(a){t().then(function(){h(a,"parameter")})});a.parameters.addEventListener(a.parameters.EVENTTYPE.VALUE_UPDATE,r);a.exports.addEventListener(a.exports.EVENTTYPE.REGISTERED,function(a){t().then(function(){m(a,"export");d--;0>=d&&q()})});a.exports.addEventListener(a.exports.EVENTTYPE.UPDATE,function(a){t().then(function(){h(a,"export")})});a.exports.addEventListener(a.exports.EVENTTYPE.VALUE_UPDATE,
r)}})();return{destroy:f,save:function(){if(c&&!0===c.editMode)for(var b=0,d=w.length;b<d;b++){var l=w[b],n={id:l.id,hidden:l.hidden};l.wasEdited&&null!==l.newName&&l.newName!==l.name&&(n.name=l.newName);l.order!==b&&(n.order=b);1<Object.keys(n).length&&(!0===l.parameter?a.parameters.updateProperties(n):!0===l.export&&a.exports.updateProperties(n));l.name=l.label.innerHTML;l.order=b}}}};var module$src$api$apps$DomElementManager={default:function(a){var b={},c={};a.scene.addEventListener(a.scene.EVENTTYPE.ANCHOR_ADD,function(a){if(a.anchors)for(var b=0,c=a.anchors.length;b<c;b++)g(a.anchors[b])});a.scene.addEventListener(a.scene.EVENTTYPE.ANCHOR_REMOVE,function(a){if(a.anchors)for(var b=0,c=a.anchors.length;b<c;b++)d(a.anchors[b])});var g=function(d){if(b[d.runtimeId]||!d.format)return null;var e=document.getElementById(d.viewport+"-shapediver-domElements");e||(e=document.createElement("div"),
e.id=d.viewport+"-shapediver-domElements",e.classList.add("shapediver-domElements"),a.viewports.get(d.viewport).getContainer().appendChild(e));var f=c[d.format];e=f.add(e,d);b[d.runtimeId]=e;d.updateFunction(f.update);return e};var d=function(a){if(!b[a.runtimeId]||!a.format)return null;c[a.format].remove(a)};var f=function(b,c){var d=c.data,e=(0,module$src$shared$util$toTinyColor.default)(d.color,"black");var h=document.createElement("div");h.type="text/css";h.style.display="none";h.classList.add("shapediver-domElement");
b.appendChild(h);b=document.createElement("span");b.style.color=e.toHexString();b.style.opacity=e.getAlpha();b.innerHTML=d.text;b.classList.add("shapediver-domElement-span");h.appendChild(b);if(d.textAlign)var f=d.textAlign;b.style.textAlign="right"===f||"center"===f?f:"left";return{domElement:h,api:a.viewports.get(c.viewport)}};var p=function(a){var c=b[a.runtimeId].domElement,d=a.data;if(a.hidden&&!1!==d.hidden)c.style.display="none";else{c.style.display="";if(d.positioning){var e=d.positioning.horizontal;
var f=d.positioning.vertical}d="right"===e?a.containerX-c.offsetWidth:"left"===e?a.containerX:a.containerX-c.offsetWidth/2;a="bottom"===f?a.containerY-c.offsetHeight:"top"===f?a.containerY:a.containerY-c.offsetHeight/2;c.style.left=d+"px";c.style.top=a+"px"}};var e=function(a){var c=b[a.runtimeId].domElement;c.style.display="none";document.getElementById(b[a.runtimeId].api.getRuntimeId()+"-shapediver-domElements").removeChild(c)};c={tag2d:{add:f,remove:e,update:p},text:{add:f,remove:e,update:p},image:{add:function(b,
c){var d=c.data;var e=document.createElement("div");e.type="text/css";e.style.display="none";e.classList.add("shapediver-domElement");b.appendChild(e);b=document.createElement("img");e.appendChild(b);b.src=d.src;d.height&&(b.height=d.height);d.width&&(b.width=d.width);d.alt&&(b.alt=d.alt);return{domElement:e,api:a.viewports.get(c.viewport)}},remove:function(a){var c=b[a.runtimeId].domElement;c.style.display="none";document.getElementById(b[a.runtimeId].api.getRuntimeId()+"-shapediver-domElements").removeChild(c)},
update:function(a){var c=b[a.runtimeId].domElement,d=a.data;if(a.hidden&&!1!==d.hidden)c.style.display="none";else{c.style.display="";if(d.positioning){var e=d.positioning.horizontal;var f=d.positioning.vertical}d="right"===e?a.containerX-c.offsetWidth:"left"===e?a.containerX:a.containerX-c.offsetWidth/2;a="bottom"===f?a.containerY-c.offsetHeight:"top"===f?a.containerY:a.containerY-c.offsetHeight/2;c.style.left=d+"px";c.style.top=a+"px"}}}}}};var module$src$api$apps$UIkitViewportOverlays={},GLOBAL_UTILS$$module$src$api$apps$UIkitViewportOverlays=module$src$shared$util$GlobalUtils.default;
module$src$api$apps$UIkitViewportOverlays.default=function(a,b){if(!window.UIkit)return null;b=b||{};b.domElementIdPrefix=b.domElementIdPrefix||"sdv-container";b.hasOwnProperty("containerViewport")||(b.containerViewport=document.getElementById(b.domElementIdPrefix+"-viewport"));if(!b.containerViewport)return null;b.hasOwnProperty("containerControls")||(b.containerControls=document.getElementById(b.domElementIdPrefix+"-controls"));b.hasOwnProperty("containerSettings")||(b.containerSettings=document.getElementById(b.domElementIdPrefix+
"-settings"));b.resizeHandler=b.resizeHandler||function(){};var c={},g=b.containerViewport,d=b.containerControls,f=b.containerSettings,p=[];"brandedMode createButtons showControlsButton showSettingsButton showZoomButton showFullscreenButton showInitialSpinner showBusySpinner".split(" ").forEach(function(a){"boolean"!==typeof b[a]&&(b[a]=module$src$shared$util$GlobalUtils.default.getBooleanNodeAttribute(b.container,a.toLowerCase(),!0))});var e=document.createElement("ul");e.classList.add("uk-iconnav");
e.classList.add("shapediver-iconnav");var m=document.createElement("div");m.appendChild(e);g.appendChild(m);if(b.createButtons){var h=function(a,b,c){var d=document.createElement("li"),l=document.createElement("a");l.href="#";l.setAttribute("uk-icon","icon: "+a);"function"===typeof c&&(l.onclick=c);b||(d.style.display="none");d.appendChild(l);e.appendChild(d);return{li:d,a:l,onclick:c}};f&&(c.settings=h("pencil",b.showSettingsButton,function(c){"function"===typeof c.preventDefault&&c.preventDefault();
var d="none"===f.style.display?"":"none";f.style.display="boolean"===typeof c?c?"":"none":d;a&&a.scene&&"function"===typeof a.scene.render&&a.scene.render();b.resizeHandler()}),b.showSettingsInitial&&(f.style.display="",b.resizeHandler()));d&&(c.controls=h("settings",b.showControlsButton,function(c){"function"===typeof c.preventDefault&&c.preventDefault();var l="none"===d.style.display?"":"none";d.style.display="boolean"===typeof c?c?"":"none":l;a&&a.scene&&"function"===typeof a.scene.render&&a.scene.render();
b.resizeHandler()}),b.showControlsInitial&&(d.style.display="",b.resizeHandler()));if(a&&a.scene&&a.scene.camera&&"function"===typeof a.scene.camera.resetAsync){var r=0;c.zoom=h("camera",b.showZoomButton,function(c){"function"===typeof c.preventDefault&&c.preventDefault();b.zoomButtonResetsCamera?a.scene.camera.resetAsync({coordinates:"spherical"}):0!==r?(a.scene.camera.resetAsync({coordinates:"spherical"}),clearTimeout(r),r=0):(a.scene.camera.zoomAsync(),r=setTimeout(function(){r=0},500))});0===
a.getSetting("scene.camera.cameraMovementDuration")&&a.updateSettingAsync("scene.camera.cameraMovementDuration",1E3)}if(a&&"function"===typeof a.getSetting&&"function"===typeof a.updateSettingAsync){c.fullscreen=h("expand",b.showFullscreenButton,function(b){"function"===typeof b.preventDefault&&b.preventDefault();b=a.getSetting("scene.fullscreen");a.updateSettingAsync("scene.fullscreen",!b)});var q=function(){document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||
document.mozFullScreenElement?c.fullscreen.a.setAttribute("uk-icon","icon: shrink"):c.fullscreen.a.setAttribute("uk-icon","icon: expand")};document.addEventListener("webkitfullscreenchange",q);document.addEventListener("mozfullscreenchange",q);document.addEventListener("fullscreenchange",q)}}var t=function(a){a.style.position="absolute";a.style.top="50%";a.style.left="50%";a.style.transform="translateX(-50%) translateY(-50%)";a.style["-webkit-transform"]=a.style.transform};if(a&&a.scene&&b.showInitialSpinner){if(b.brandedMode){var u=
document.createElement("img");u.style.maxWidth="66%";u.style.maxHeight="66%";u.style.backgroundColor="none";u.src="https://viewer.shapediver.com/v2/img/logo_color.png"}else u=document.createElement("div"),u.setAttribute("uk-spinner","ratio: 2");t(u);g.parentNode.appendChild(u);var n=function(){u&&(g.parentNode.removeChild(u),u=null);l&&(a.scene.removeEventListener(l.data),l=null)};var l=a.scene.addEventListener(a.scene.EVENTTYPE.VISIBILITY_ON,n)}if(a&&a.state&&b.showBusySpinner){var v=function(a){a.classList.add("shapediver-spinner-busy");
a.setAttribute("uk-spinner","ratio: 1")},x;var w=document.createElement("div");v(w);m.appendChild(w);h=a.state.addEventListener(a.state.EVENTTYPE.BUSY,function(){w.style.display=""});h.data&&p.push(h.data);h=a.state.addEventListener(a.state.EVENTTYPE.IDLE,function(){w.style.display="none"});h.data&&p.push(h.data);var y=function(a,b){x?w.removeChild(x):(w.removeAttribute("uk-spinner"),w.classList.remove("uk-spinner","uk-icon"));a?(x=document.createElement("img"),x.src=a,b&&(b=Array.isArray(b)||[b],
b.forEach(function(a){w.classList.add(a)})),t(w),w.appendChild(x)):v(w)};var z=function(){}}var B=function(a,b){window.UIkit.notification({message:b,status:a||"primary",pos:"top-center"})};h=a.state.addEventListener(a.state.EVENTTYPE.MESSAGE,function(b){if(a.getSetting("showMessages")&&b.message){var c,d=b.messageLevel;"number"===typeof d&&(d&=7,d===window.SDVApp.constants.loggingLevels.WARN?c="warning":d>window.SDVApp.constants.loggingLevels.WARN?c="danger":d<window.SDVApp.constants.loggingLevels.WARN&&
(c="primary"));B(c,b.message)}});h.data&&p.push(h.data);h=function(b){"function"===typeof n&&n();a.updateSettingAsync("scene.show",!1);var c=document.createElement("div");t(c);c.classList.add("uk-text-middle");c.classList.add("uk-text-break");c.classList.add("uk-text-center");g.parentNode.appendChild(c);var d='<h1 class="uk-text-lead">We are sorry</h1>';b.messageScope&&(d+=b.messageScope);c.innerHTML=d};var A=a.state.get().data.failedStatusMessages;0<A.length?h(A[0]):(h=a.state.addEventListener(a.state.EVENTTYPE.FAILED,
h),h.data&&p.push(h.data));return{destroy:function(){m&&(g.removeChild(m),m=null);"function"===typeof n&&n();q&&(document.removeEventListener("webkitfullscreenchange",q),document.removeEventListener("mozfullscreenchange",q),document.removeEventListener("fullscreenchange",q));p.forEach(function(b){return a.removeEventListener(b)});m=null},toggleVisibility:function(a,b){c[a]&&(c[a].li.style.display=b?"":"none")},buttonOnClick:function(a,b){if(c[a])c[a].onclick(b)},setBusyGraphic:y,setBusyGraphicPosition:z,
showMessage:B}};var module$src$api$apps$UIkitExportModal={default:function(a,b){if(!a)return null;b=b||{};b.domElementIdPrefix||(b.domElementIdPrefix="sdv-container-modal-export");b.parentElement||(b.parentElement=document.getElementById("sdv-container")?document.getElementById("sdv-container"):document.body);b.UIkitOpts||(b.UIkitOpts={escClose:!0,bgClose:!1,container:document.getElementById("sdv-container")?"#sdv-container":!1});if(!window.UIkit)return null;var c,g,d,f,p,e=0,m,h=[],r,q=!1,t=b.parentElement,u=b.domElementIdPrefix,
n=[];(function(a){c=document.createElement("div");c.id=a;var b=document.createElement("div");b.classList.add("uk-modal-dialog");b.classList.add("uk-modal-body");c.appendChild(b);g=document.createElement("h2");g.id=a+"-title";g.classList.add("uk-modal-title");b.appendChild(g);d=document.createElement("p");d.id=a+"-prompt";b.appendChild(d);var l=document.createElement("p");l.classList.add("uk-text-right");b.appendChild(l);f=document.createElement("h2");f.id=a+"-button-cancel";f.type="button";f.classList.add("uk-button");
f.classList.add("uk-button-default");f.classList.add("uk-modal-close");l.appendChild(f);p=document.createElement("h2");p.id=a+"-button-ok";p.type="button";p.classList.add("uk-button");p.classList.add("uk-button-primary");l.appendChild(p);t.appendChild(c);return c})(u);var l=window.UIkit.modal("#"+u,b.UIkitOpts);var v=function(a){if(!a.export)return!1;var b=a.export;if(!a.token||!a.token.id||h.includes(a.token.id)||a.token.attributes&&a.token.attributes.silent||q&&m!==a.token.id)return!1;m=a.token.id;
g.innerHTML=b.name?'Export "'+b.name+'"':"Export";if(b.content||b.result)"download"===b.type?(d.innerHTML=b.filename&&0<b.content.length&&b.content[0].href?'File "'+b.filename+'" is available for download.':b.msg?b.msg:"File is available for download.",b.content&&0<b.content.length&&(a=b.content[0],a.size&&(d.innerHTML+="<br/>Download size: "+a.size+" bytes"),a.format&&(d.innerHTML+="<br/>File format: "+a.format))):d.innerHTML="email"===b.type?b.result.err?b.result.err:b.result.msg?b.result.msg:"Export has been finished.":
"shapeways"===b.type?b.result.err?b.result.err:b.result.msg?b.result.msg:"Export to ShapeWays has been finished.":"Export has been finished.";else{a="Processing, please wait...";b.msg&&(a=b.msg);for(var c=1;c<=e;c++)a+=".";d.innerHTML=a;e=(e+1)%4}b.content||b.result?(f.innerHTML="Cancel","download"===b.type?0<b.content.length&&b.content[0].href&&(p.innerHTML="Download",r=b.content[0].href):"shapeways"===b.type?b.result.err?p.innerHTML="Ok":b.result.href&&(p.innerHTML="Go to ShapeWays",r=b.result.href):
p.innerHTML="Ok",p.hidden=!(p.innerHTML&&0<p.innerHTML.length)):(f.innerHTML="Cancel",r="",p.innerHTML="",p.hidden=!0);return!0};b=a.exports.addEventListener(a.exports.EVENTTYPE.STATUS,function(a){v(a)&&(l.show(),q=!0)});b.data&&n.push(b.data);b=a.exports.addEventListener(a.exports.EVENTTYPE.AVAILABLE,function(a){v(a)&&(l.show(),q=!0)});b.data&&n.push(b.data);f.onclick=function(){m&&h.push(m);m=null;l.hide();q=!1};p.onclick=function(){m&&h.push(m);m=null;r&&(window.open(r,"_blank"),r="");l.hide();
q=!1};return{destroy:function(){p.onclick=null;f.onclick=null;t.removeChild(c);n.forEach(function(b){return a.export.removeEventListener(b)})}}}};var module$src$shared$pubsub$PubSub={default:function(a){function b(a){for(var b in a)if(a.hasOwnProperty(b))return!0;return!1}function c(a){return function(){throw a;}}function g(a,b,d){try{a(b,d)}catch(n){setTimeout(c(n),0)}}function d(a,b,c){a(b,c)}function f(a,b,c,e){var l=m[b];e=e?d:g;var n;if(m.hasOwnProperty(b))for(n in l)l.hasOwnProperty(n)&&e(l[n],a,c)}function p(a,b,c){return function(){var d=String(a),l=d.lastIndexOf(".");for(f(a,a,b,c);-1!==l;)d=d.substr(0,l),l=d.lastIndexOf("."),f(a,
d,b,c)}}function e(a,c,d,e){c=p(a,c,e);a=String(a);e=!(!m.hasOwnProperty(a)||!b(m[a]));for(var l=a.lastIndexOf(".");!e&&-1!==l;)a=a.substr(0,l),l=a.lastIndexOf("."),e=!(!m.hasOwnProperty(a)||!b(m[a]));if(!e)return!1;!0===d?c():setTimeout(c,0);return!0}var m={},h=-1,r=this;a=a||{};"boolean"!==typeof a.immediateExceptions&&(a.immediateExceptions=!1);r.publish=function(b,c){return e(b,c,!1,a.immediateExceptions)};r.publishSync=function(b,c){return e(b,c,!0,a.immediateExceptions)};r.subscribe=function(a,
b){if("function"!==typeof b)return!1;m.hasOwnProperty(a)||(m[a]={});var c="uid_"+String(++h);m[a][c]=b;return c};r.subscribeOnce=function(a,b){var c=r.subscribe(a,function(){r.unsubscribe(c);b.apply(this,arguments)});return r};r.clearAllSubscriptions=function(){m={}};r.clearSubscriptions=function(a){for(var b in m)m.hasOwnProperty(b)&&0===b.indexOf(a)&&delete m[b]};r.unsubscribe=function(a){var b;if((b="string"===typeof a)&&!(b=m.hasOwnProperty(a)))a:{for(var c in m)if(m.hasOwnProperty(c)&&0===c.indexOf(a)){b=
!0;break a}b=!1}var d=b;c=!d&&"string"===typeof a;b="function"===typeof a;var l=!1,e,f;if(d)r.clearSubscriptions(a);else{for(e in m)if(m.hasOwnProperty(e)){d=m[e];if(c&&d[a]){delete d[a];l=a;break}if(b)for(f in d)d.hasOwnProperty(f)&&d[f]===a&&(delete d[f],l=!0)}return l}}}};var module$src$app$partials$ViewerAppLoggingPartial={},VIEWERAPPCONSTANTS$$module$src$app$partials$ViewerAppLoggingPartial=module$src$app$ViewerAppConstants.default,PUBSUB$$module$src$app$partials$ViewerAppLoggingPartial=module$src$shared$pubsub$PubSub.default;
module$src$app$partials$ViewerAppLoggingPartial.default=function(){var a=this,b=new module$src$shared$pubsub$PubSub.default;this.subscribeToLogStream=function(a,c,g){if(!Array.isArray(a)){for(var d=[],f=0;f<=a;f++)d.push(f);a=d}Array.isArray(c)||(c=[c]);var h=[];a.forEach(function(a){c.forEach(function(c){var d=a.toString();0<c.length&&(d+="."+c);h.push(b.subscribe(d,g))})});return h};this.unsubscribeFromLogStream=function(a){a.forEach(function(a){b.unsubscribe(a)})};var c=function(b,c){var d=Number(b.slice(0,
1));b=b.slice(2);a.logToConsole.apply(a,[d,b].concat($jscomp.arrayFromIterable(c)))},g=this.subscribeToLogStream(a.getSetting("loggingLevel"),"",c);this.log=function(){var a=1===arguments.length?[arguments[0]]:Array.apply(null,arguments),c=a[0],g=a[1];a=a.slice(2);c=c.toString();"string"===typeof g&&0<g.length&&(c+="."+g);b.publish(c,[].concat($jscomp.arrayFromIterable(a)))};this.registerHook("loggingLevel",function(b){a.unsubscribeFromLogStream(g);g=a.subscribeToLogStream(b,"",c);a.log(module$src$app$ViewerAppConstants.default.loggingLevels.DEBUG,
"ViewerApp.loggingLevelUpdateHook","loggingLevel set from "+a.getLoggingLevelName(a.getSetting("loggingLevel"))+" to "+a.getLoggingLevelName(b));return!0})};var module$src$app$partials$ViewerAppMessagingPartial={},GLOBALUTILS$$module$src$app$partials$ViewerAppMessagingPartial=module$src$shared$util$GlobalUtils.default,MESSAGINGCONSTANTS$$module$src$app$partials$ViewerAppMessagingPartial=module$src$shared$constants$MessagingConstants.default,PUBSUB$$module$src$app$partials$ViewerAppMessagingPartial=module$src$shared$pubsub$PubSub.default;
module$src$app$partials$ViewerAppMessagingPartial.default=function(){var a=this,b=new module$src$shared$pubsub$PubSub.default;this.message=function(c,d){c=c===module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS&&d.token&&d.token.id?c+"."+d.token.id:c;a.messageToPubSub(c,d,b,{});a.messageToLog(c,d)};this.subscribeToMessageStream=function(a,c){Array.isArray(a)||(a=[a]);var d=[];a.forEach(function(a){d.push(b.subscribe(a,c))});return d};this.unsubscribeFromMessageStream=function(a){Array.isArray(a)||
(a=[a]);var c=!0;a.forEach(function(a){b.unsubscribe(a)||(c=!1)});return c};this.setupDispatching=function(b){var c=[];Object.keys(b).forEach(function(d){var f=b[d].partListeners;d=a.subscribeToMessageStream(d,function(b,c){Array.isArray(c.parts)||(c.parts=[],a.warn("ViewerAppMessagingPartial.setupDispatching","Message without data parts: "+JSON.stringify(c,null,0)));c.parts.forEach(function(d){f.forEach(function(e){if(d.type===e.type){var f=e.cb;"string"===typeof f&&0<f.length&&(f=module$src$shared$util$GlobalUtils.default.getAt(a,
f.split(".")));if("function"===typeof f){var h=[];h=Array.isArray(e.params)?e.params.map(function(a){if("type"===a)return d.type;if("data"===a)return d.data;if("token"===a)return c.token;if("origin"===a)return c.origin;if("topic"===a)return b;if("plugin"===a)return c.origin.plugin}):[c.token,d.data,d.type,c.origin];f=Promise.resolve(f.apply(a,h));f.then(function(b){!1===b&&a.debug("ViewerAppMessagingPartial.setupDispatching","Message callback returned false",e,h)});f.catch(function(b){a.error("ViewerAppMessagingPartial.setupDispatching",
"Error in message callback: "+b.message,b,e,h)})}}})})});c=c.concat(d)});return c};var c=[];this.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_FAILED,function(a,b){(a=b.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE))&&a.data&&c.push(a.data)});this.getFailedStatusMessages=function(){return c}};var module$src$app$partials$ViewerAppPluginManager={},pluginConstants$$module$src$app$partials$ViewerAppPluginManager=module$src$plugins$PluginConstants.default,MessagePrototype$$module$src$app$partials$ViewerAppPluginManager=module$src$shared$messages$MessagePrototype.default;
module$src$app$partials$ViewerAppPluginManager.default=function(){var a=this,b={},c=[],g=[];b.getStatusDescription=function(){var a=[];c.forEach(function(b){a.push(b.getStatusDescription())});return a};b.registerPlugin=function(d){if(d.getStatus()!==module$src$plugins$PluginConstants.default.pluginStatuses.READY)a.error("ViewerAppPluginManager.registerPlugin","Unexpected plugin status before loading: "+d.getStatus());else{var e=d.getRuntimeId();if(void 0!==b.getPluginByRuntimeId(e))a.error("ViewerAppPluginManager.registerPlugin",
"Plugin with runtime id "+e+" already loaded");else{d.log=function(){var b=1===arguments.length?[arguments[0]]:Array.apply(null,arguments),c=b[0],l=b[1];b=b.slice(2);l=d.getShortName()+"."+e+"."+l;a.log.apply(a,[c,l].concat($jscomp.arrayFromIterable(b)))};d.message=function(b,c){if(void 0===c.origin||"object"!==typeof c.origin)c.origin={};c.origin.plugin=e;void 0!==c.token&&"object"===typeof c.token&&void 0===c.token.creator&&(c.token.creator={plugin:e});a.message(b,c)};d.app={api:a.api};d.app.getContainer=
a.getContainer;var f=d.getCapabilities();f.includes(module$src$plugins$PluginConstants.default.pluginCapabilities.INTERACTIVE)&&(d.app.sceneGeometryManager=a.sceneGeometryManager,d.app.viewportManager=a.viewportManager);f.includes(module$src$plugins$PluginConstants.default.pluginCapabilities.DRAGANDDROP)&&(d.app.sceneGeometryManager=a.sceneGeometryManager,d.app.viewportManager=a.viewportManager);var r=[];if(f.includes(module$src$plugins$PluginConstants.default.pluginCapabilities.MESSAGECALLBACKS)&&
a.subscribeToMessageStream){f=d.getMessageCallbacks();for(var q in f){var p=a.subscribeToMessageStream(q,f[q]);r=r.concat(p)}}if(d.load({loggingLevel:a.getSetting("loggingLevel")}))if(d.getStatus()!==module$src$plugins$PluginConstants.default.pluginStatuses.LOADED&&d.getStatus()!==module$src$plugins$PluginConstants.default.pluginStatuses.ACTIVE)a.error("ViewerAppPluginManager.registerPlugin","Unexpected plugin status after loading: "+d.getStatus());else return a.message(module$src$plugins$PluginConstants.default.messageTopics.PLUGIN_REGISTERED,
new module$src$shared$messages$MessagePrototype.default(module$src$plugins$PluginConstants.default.messageDataTypes.PLUGIN_RUNTIME_ID,e)),a.info("ViewerAppPluginManager.registerPlugin",'Registered plugin "'+d.getName()+'" with capabilities '+JSON.stringify(d.getCapabilities())+" and runtime id "+d.getRuntimeId()),c.push(d),g.push(r),e;else a.error("ViewerAppPluginManager.registerPlugin",'Failed to load plugin "'+d.getName()+'" with runtime id '+e)}}};b.deregisterPlugin=function(b){var d=c.findIndex(function(a){return a.getRuntimeId()===
b});if(-1===d)return a.error("ViewerAppPluginManager.deregisterPlugin","Plugin with runtimeId "+b+" not found"),!1;a.unsubscribeFromMessageStream&&a.unsubscribeFromMessageStream(g[d]);var e=c.splice(d,1)[0];g.splice(d,1);a.info("ViewerAppPluginManager.deregisterPlugin",'Deregistered plugin "'+e.getName()+'" with capabilities '+JSON.stringify(e.getCapabilities())+" and runtime id "+e.getRuntimeId());return!0};b.getRuntimeIds=function(){for(var a=c.length,b=Array(c.length),d=0;d<a;d++)b[d]=c[d].getRuntimeId();
return b};b.getPluginByRuntimeId=function(a){return c.find(function(b){return b.getRuntimeId()===a})};b.getPluginByName=function(a){return c.find(function(b){return b.getName()===a})};b.getPluginByShortName=function(a){return c.find(function(b){return b.getShortName()===a})};b.getPluginByCapabilities=function(a){a||(a=[]);Array.isArray(a)||(a=[a]);return c.find(function(b){var c=b.getCapabilities();return a.every(function(a){return c.includes(a)})})};var d=999,f=Promise.resolve(),p=function(b,g){var e=
b.indexOf("."),r=Number(b.slice(0,e))&module$src$plugins$PluginConstants.default.loggingLevels.LVLBITS,q=b.slice(e+1),m=c.find(function(a){return a.getCapabilities().includes(module$src$plugins$PluginConstants.default.pluginCapabilities.LOGGING)});m?f=f.finally(function(){a.debug("ViewerAppPluginManager._logToServer","Logging to server",{loggingLevel:r,scope:q,data:g});Array.isArray(g)||(g=[g]);m.logToServer.apply(m,[r,q].concat($jscomp.arrayFromIterable(g))).catch(function(b){a.warn("ViewerAppPluginManager._logToServer",
b)});d=999}).finally(function(){return new Promise(function(a){setTimeout(a,9999)})}):(a.debug("ViewerAppPluginManager._logToServer","Delaying logging to server by "+d+"msec",{loggingLevel:r,scope:q,data:g}),setTimeout(p,d,b,g),d*=2)};"function"===typeof a.subscribeToLogStream&&a.subscribeToLogStream([module$src$plugins$PluginConstants.default.loggingLevels.ERROR_S,module$src$plugins$PluginConstants.default.loggingLevels.WARN_S,module$src$plugins$PluginConstants.default.loggingLevels.INFO_S,module$src$plugins$PluginConstants.default.loggingLevels.DEBUG_S],
"",p);return b};var module$src$shared$exceptions$MissingImplementationException={default:function(){}};module$src$shared$exceptions$MissingImplementationException.default.prototype.toString=function(){return"Missing implementation"};var module$src$shared$interfaces$ParameterInterface={},MissingImplementationException$$module$src$shared$interfaces$ParameterInterface=module$src$shared$exceptions$MissingImplementationException.default;
module$src$shared$interfaces$ParameterInterface.default=function(){this.setValue=function(){throw new module$src$shared$exceptions$MissingImplementationException.default;};this.parseValue=function(){throw new module$src$shared$exceptions$MissingImplementationException.default;};this.getValue=function(){throw new module$src$shared$exceptions$MissingImplementationException.default;};this.getValueString=function(){throw new module$src$shared$exceptions$MissingImplementationException.default;};this.checkValue=
function(){throw new module$src$shared$exceptions$MissingImplementationException.default;};this.isValid=function(){throw new module$src$shared$exceptions$MissingImplementationException.default;};this.getDefinition=function(){throw new module$src$shared$exceptions$MissingImplementationException.default;}};var module$src$shared$types$ShapeDiverParameters={default:{}},GlobalUtils$$module$src$shared$types$ShapeDiverParameters=module$src$shared$util$GlobalUtils.default,toTinyColor$$module$src$shared$types$ShapeDiverParameters=module$src$shared$util$toTinyColor.default,uuidv4Regex$$module$src$shared$types$ShapeDiverParameters=/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,defaultSettings$$module$src$shared$types$ShapeDiverParameters={strictMode:!0},CommonParameter$$module$src$shared$types$ShapeDiverParameters=
function(a){var b=this;module$src$shared$mixins$GlobalMixin.default.call(this);module$src$shared$interfaces$ParameterInterface.default.call(this);var c=function(a,b){return Array.isArray(a)&&"array"===b||typeof a===b?!0:!1};void 0===a||"object"!==typeof a?a=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(a=module$src$shared$util$GlobalUtils.default.deepCopy(a),module$src$shared$util$GlobalUtils.default.defaults(a,defaultSettings$$module$src$shared$types$ShapeDiverParameters));void 0===
a.isValid&&(a.isValid=!0);if(void 0===a.name||"string"!==typeof a.name||0===a.name.length)a.name="Generic parameter";if(void 0===a.valuetype||"string"!==typeof a.valuetype||0===a.valuetype.length)void 0!==a.defval?Array.isArray(a.defval)?a.valuetype="array":a.valuetype=typeof a.defval:(a.valuetype="number",a.isValid=!1);void 0!==a.defval&&c(a.defval,a.valuetype)||(a.defval=0,a.isValid=!1);void 0===a.value?a.value=a.defval:c(a.value,a.valuetype)||(a.isValid=!1);module$src$shared$mixins$SettingsMixin.default.call(this,
a);this.registerHook("valuetype",function(){return!1});this.registerHook("defval",function(a){return b.checkValue(a)});this.registerHook("value",function(a){return b.checkValue(a)});this.registerHook("isValid",function(){return!1});module$src$shared$mixins$LoggingMixin.default.call(this);this.isValid=function(){return b.getSetting("isValid")};this.checkValue=function(a){return c(a,b.getSettingShallow("valuetype"))};this.setValue=function(a){return b.updateSetting("value",a)};this.getValue=function(){return b.getSetting("value")};
this.getValueString=function(){return b.getValue().toString()};this.parseValue=function(a){if("string"!==typeof a)return!1;var c=b.getSettingShallow("valuetype");if("string"===c)return b.setValue(a);if("number"===c)return b.setValue(parseFloat(a));if("boolean"===c)return"false"===a.toLowerCase()?b.setValue(!1):b.setValue(!!a);if("object"===c||"array"===c)try{return b.setValue(JSON.Parse(a))}catch(f){return b.debug("CommonParameter.parseValue",f),!1}else return!1};this.isValueDifferent=function(a){var c=
b.getSettingShallow("valuetype"),f=b.getSettingShallow("value");return"array"===c||"object"===c?(c=JSON.stringify(f,null,0),a=JSON.stringify(a,null,0),c!==a):f!==a};b.toString=function(){var a='Parameter "'+b.getSetting("name")+'"';return a+="\n\tsettings: "+JSON.stringify(b.getSettings(),null,0)};this.acceptsBlobs=function(){return!1};this.checkBlob=function(a){if(!(b.acceptsBlobs()&&a instanceof Blob)||a.size>b.getSettingShallow("max"))return!1;a._type=0<a.type.length?a.type:module$src$shared$util$GlobalUtils.default.guessMimeTypeFromFilename(a.name);
return b.getSettingShallow("format").includes(a._type)?!0:!1};return this};module$src$shared$types$ShapeDiverParameters.default.CommonParameter=CommonParameter$$module$src$shared$types$ShapeDiverParameters;
var FloatParameter$$module$src$shared$types$ShapeDiverParameters=function(a){var b=this;void 0===a||"object"!==typeof a?a=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(a=module$src$shared$util$GlobalUtils.default.deepCopy(a),module$src$shared$util$GlobalUtils.default.defaults(a,defaultSettings$$module$src$shared$types$ShapeDiverParameters));void 0===a.isValid&&(a.isValid=!0);"boolean"!==typeof a.strictMode||a.strictMode||(["decimalplaces"].forEach(function(b){"string"===typeof a[b]&&
(a[b]=parseInt(a[b]))}),["min","max","defval","value"].forEach(function(b){"string"===typeof a[b]&&(a[b]=parseFloat(a[b]))}));if(void 0===a.name||"string"!==typeof a.name||0===a.name.length)a.name="Float parameter";a.valuetype="number";if(void 0===a.decimalplaces||"number"!==typeof a.decimalplaces||0>a.decimalplaces)a.decimalplaces=20;if(void 0===a.min||"number"!==typeof a.min)a.min=-Number.MAX_VALUE;if(void 0===a.max||"number"!==typeof a.max)a.max=Number.MAX_VALUE;a.min>a.max&&(a.min=a.max,a.isValid=
!1);if(void 0===a.defval||"number"!==typeof a.defval||a.defval<a.min||a.defval>a.max)a.defval=a.min,a.isValid=!1;if(void 0===a.value||"number"!==typeof a.value||a.value<a.min||a.value>a.max)a.value=a.defval;CommonParameter$$module$src$shared$types$ShapeDiverParameters.call(this,a);this.registerHook("decimalplaces",function(){return!1});this.registerHook("min",function(a){return b.getSettingShallow("value")>=a?!0:!1});this.registerHook("max",function(a){return b.getSettingShallow("value")<=a?!0:!1});
var c=this.setValue;this.setValue=function(a){"string"!==typeof a||b.getSettingShallow("strictMode")||(a=parseFloat(a));if("number"!==typeof a)return!1;var d=a,g=b.getSettingShallow("decimalplaces");g<Number.MAX_SAFE_INTEGER&&(d=parseFloat(a.toFixed(g)));return c(d)};this.getValueString=function(){var a=b.getSettingShallow("decimalplaces");return a<Number.MAX_SAFE_INTEGER?b.getValue().toFixed(a):b.getValue()};var g=this.checkValue;this.checkValue=function(a){"string"!==typeof a||b.getSettingShallow("strictMode")||
(a=parseFloat(a));return g(a)?a>=b.getSettingShallow("min")&&a<=b.getSettingShallow("max"):!1};this.getDefinition=function(){return b.getSettings("id name plugin note type decimalplaces defval group max min visualization _name order hidden".split(" "))};return this};module$src$shared$types$ShapeDiverParameters.default.FloatParameter=FloatParameter$$module$src$shared$types$ShapeDiverParameters;
var IntegerParameter$$module$src$shared$types$ShapeDiverParameters=function(a){void 0===a||"object"!==typeof a?a=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(a=module$src$shared$util$GlobalUtils.default.deepCopy(a),module$src$shared$util$GlobalUtils.default.defaults(a,defaultSettings$$module$src$shared$types$ShapeDiverParameters));void 0===a.isValid&&(a.isValid=!0);"boolean"!==typeof a.strictMode||a.strictMode||["decimalplaces","min","max","defval","value"].forEach(function(b){"string"===
typeof a[b]&&(a[b]=parseInt(a[b]))});if(void 0===a.name||"string"!==typeof a.name||0===a.name.length)a.name="Integer parameter";void 0===a.decimalplaces&&(a.decimalplaces=0);if("number"!==typeof a.decimalplaces||0!==a.decimalplaces)a.decimalplaces=0,a.isValid=!1;if(void 0===a.min||"number"!==typeof a.min)a.min=Number.MIN_SAFE_INTEGER;if(void 0===a.max||"number"!==typeof a.max)a.max=Number.MAX_SAFE_INTEGER;a.min>a.max&&(a.min=a.max,a.isValid=!1);if(void 0===a.defval||"number"!==typeof a.defval||a.defval<
a.min||a.defval>a.max||Math.round(a.defval)!==a.defval)a.defval=a.min,a.isValid=!1;if(void 0===a.value||"number"!==typeof a.value||a.value<a.min||a.value>a.max||Math.round(a.value)!==a.value)a.value=a.defval;FloatParameter$$module$src$shared$types$ShapeDiverParameters.call(this,a);return this};module$src$shared$types$ShapeDiverParameters.default.IntegerParameter=IntegerParameter$$module$src$shared$types$ShapeDiverParameters;
var EvenIntegerParameter$$module$src$shared$types$ShapeDiverParameters=function(a){void 0===a||"object"!==typeof a?a=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(a=module$src$shared$util$GlobalUtils.default.deepCopy(a),module$src$shared$util$GlobalUtils.default.defaults(a,defaultSettings$$module$src$shared$types$ShapeDiverParameters));void 0===a.isValid&&(a.isValid=!0);"boolean"!==typeof a.strictMode||a.strictMode||["decimalplaces","min","max","defval","value"].forEach(function(b){"string"===
typeof a[b]&&(a[b]=parseInt(a[b]))});if(void 0===a.name||"string"!==typeof a.name||0===a.name.length)a.name="Even integer parameter";if(void 0===a.min||"number"!==typeof a.min)a.min=Number.MIN_SAFE_INTEGER;if(void 0===a.max||"number"!==typeof a.max)a.max=Number.MAX_SAFE_INTEGER;a.min>a.max&&(a.min=a.max,a.isValid=!1);if(void 0===a.defval||"number"!==typeof a.defval||a.defval<a.min||a.defval>a.max||0!==a.defval%2)a.defval=a.min,a.isValid=!1;if(void 0===a.value||"number"!==typeof a.value||a.value<a.min||
a.value>a.max||0!==a.value%2)a.value=a.defval;IntegerParameter$$module$src$shared$types$ShapeDiverParameters.call(this,a);var b=this.checkValue;this.checkValue=function(a){return b(a)?0===a%2:!1};return this};module$src$shared$types$ShapeDiverParameters.default.EvenIntegerParameter=EvenIntegerParameter$$module$src$shared$types$ShapeDiverParameters;
var OddIntegerParameter$$module$src$shared$types$ShapeDiverParameters=function(a){void 0===a||"object"!==typeof a?a=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(a=module$src$shared$util$GlobalUtils.default.deepCopy(a),module$src$shared$util$GlobalUtils.default.defaults(a,defaultSettings$$module$src$shared$types$ShapeDiverParameters));void 0===a.isValid&&(a.isValid=!0);"boolean"!==typeof a.strictMode||a.strictMode||["decimalplaces","min","max","defval","value"].forEach(function(b){"string"===
typeof a[b]&&(a[b]=parseInt(a[b]))});if(void 0===a.name||"string"!==typeof a.name||0===a.name.length)a.name="Even integer parameter";if(void 0===a.min||"number"!==typeof a.min)a.min=Number.MIN_SAFE_INTEGER;if(void 0===a.max||"number"!==typeof a.max)a.max=Number.MAX_SAFE_INTEGER;a.min>a.max&&(a.min=a.max,a.isValid=!1);if(void 0===a.defval||"number"!==typeof a.defval||a.defval<a.min||a.defval>a.max||1!==Math.abs(a.defval%2))a.defval=a.min,a.isValid=!1;if(void 0===a.value||"number"!==typeof a.value||
a.value<a.min||a.value>a.max||1!==Math.abs(a.value%2))a.value=a.defval;IntegerParameter$$module$src$shared$types$ShapeDiverParameters.call(this,a);var b=this.checkValue;this.checkValue=function(a){return b(a)?1===Math.abs(a%2):!1};return this};module$src$shared$types$ShapeDiverParameters.default.OddIntegerParameter=OddIntegerParameter$$module$src$shared$types$ShapeDiverParameters;
var ValueListParameter$$module$src$shared$types$ShapeDiverParameters=function(a){var b=this;void 0===a||"object"!==typeof a?a=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(a=module$src$shared$util$GlobalUtils.default.deepCopy(a),module$src$shared$util$GlobalUtils.default.defaults(a,defaultSettings$$module$src$shared$types$ShapeDiverParameters));void 0===a.isValid&&(a.isValid=!0);"boolean"!==typeof a.strictMode||a.strictMode||["defval"].forEach(function(b){"string"===typeof a[b]&&
(a[b]=parseInt(a[b]))});if(void 0===a.name||"string"!==typeof a.name||0===a.name.length)a.name="Value list parameter";void 0!==a.choices&&Array.isArray(a.choices)||(a.choices=[],a.isValid=!1);a.min=0;a.max=a.choices.length-1;if(void 0===a.defval||"number"!==typeof a.defval||a.defval<a.min||a.defval>a.max)a.defval=a.min,a.isValid=!1;IntegerParameter$$module$src$shared$types$ShapeDiverParameters.call(this,a);this.registerHook("min",function(){return!1});this.registerHook("max",function(){return!1});
this.registerHook("choices",function(){return!1});this.getChoices=function(){return b.getSetting("choices")};this.getSelectedChoice=function(){return b.getSetting("choices")[b.getSettingShallow("value")]};this.getDefinition=function(){return b.getSettings("id name plugin note type choices defval group visualization _name order hidden".split(" "))};return this};module$src$shared$types$ShapeDiverParameters.default.ValueListParameter=ValueListParameter$$module$src$shared$types$ShapeDiverParameters;
var MultipleChoiceParameter$$module$src$shared$types$ShapeDiverParameters=function(a){var b=this,c=function(a,c,d){void 0===d&&(d=!0);if("string"===typeof a&&!d)if(!a.startsWith("[")&&a.includes(","))try{a=JSON.parse("["+a+"]")}catch(h){b.debug("MultipleChoiceParameter._checkValue",h);return}else if(a=parseInt(a),isNaN(a))return;if("number"===typeof a){if(0<=a&&a<=c)return[a]}else if(Array.isArray(a)){var e=[];if(a.every(function(b,f){if("string"===typeof b&&!d){b=parseInt(b);if(!isNaN(b))return!1;
a[f]=b}return"number"===typeof b&&0<=b&&b<=c&&-1===e.indexOf(b)?(e.push(b),!0):!1}))return e}};void 0===a||"object"!==typeof a?a=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(a=module$src$shared$util$GlobalUtils.default.deepCopy(a),module$src$shared$util$GlobalUtils.default.defaults(a,defaultSettings$$module$src$shared$types$ShapeDiverParameters));void 0===a.isValid&&(a.isValid=!0);var g=!0;"boolean"!==typeof a.strictMode||a.strictMode||(g=!1);if(void 0===a.name||"string"!==typeof a.name||
0===a.name.length)a.name="Multiple value list parameter";void 0!==a.choices&&Array.isArray(a.choices)||(a.choices=[],a.isValid=!1);a.min=0;a.max=a.choices.length-1;"string"===typeof a.defval&&!g||void 0!==a.defval&&("number"===typeof a.defval||Array.isArray(a.defval))?(a.defval=c(a.defval,a.max,g),void 0===a.defval&&(a.defval=[],a.isValid=!1)):(a.defval=[],a.isValid=!1);void 0===a.value&&(a.value=a.defval);"number"===typeof a.value||Array.isArray(a.value)?(a.value=c(a.value,a.max,g),void 0===a.value&&
(a.value=a.defval,a.isValid=!1)):(a.value=a.defval,a.isValid=!1);CommonParameter$$module$src$shared$types$ShapeDiverParameters.call(this,a);this.registerHook("min",function(){return!1});this.registerHook("max",function(){return!1});this.registerHook("choices",function(){return!1});this.getChoices=function(){return b.getSetting("choices")};this.getSelectedChoices=function(){var a=b.getSetting("choices"),c=[];b.getSettingShallow("value").forEach(function(b){c.push(a[b])});return c};this.checkValue=
function(a){return void 0!==c(a,b.getSettingShallow("max"),b.getSettingShallow("strictMode"))};this.getValueString=function(){var a=JSON.stringify(b.getValue(),null,0);a=a.replace("[","");return a=a.replace("]","")};var d=this.setValue;this.setValue=function(a){a=c(a,b.getSettingShallow("max"),b.getSettingShallow("strictMode"));return void 0===a?!1:d(a)};this.parseValue=function(a){a=c(a,b.getSettingShallow("max"),!1);return b.setValue(a)};this.getDefinition=function(){return b.getSettings("id name plugin note type choices defval group visualization _name order hidden".split(" "))};
return this};module$src$shared$types$ShapeDiverParameters.default.MultipleChoiceParameter=MultipleChoiceParameter$$module$src$shared$types$ShapeDiverParameters;
var StringParameter$$module$src$shared$types$ShapeDiverParameters=function(a){var b=this;void 0===a||"object"!==typeof a?a=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(a=module$src$shared$util$GlobalUtils.default.deepCopy(a),module$src$shared$util$GlobalUtils.default.defaults(a,defaultSettings$$module$src$shared$types$ShapeDiverParameters));a.valuetype="string";void 0===a.isValid&&(a.isValid=!0);"boolean"!==typeof a.strictMode||a.strictMode||["max"].forEach(function(b){"string"===
typeof a[b]&&(a[b]=parseInt(a[b]))});if(void 0===a.name||"string"!==typeof a.name||0===a.name.length)a.name="String parameter";if(void 0===a.max||"number"!==typeof a.max)a.max=Number.MAX_SAFE_INTEGER,a.isValid=!1;if(void 0===a.defval||"string"!==typeof a.defval)a.defval="",a.isValid=!1;a.defval.length>a.max&&(a.defval=a.defval.slice(0,a.max),a.isValid=!1);void 0!==a.value&&"string"!==typeof a.value&&(a.value=a.defval,a.isValid=!1);void 0!==a.value&&a.value.length>a.max&&(a.value=a.value.slice(0,a.max),
a.isValid=!1);CommonParameter$$module$src$shared$types$ShapeDiverParameters.call(this,a);var c=this.checkValue;this.checkValue=function(a){return c(a)?a.length<=b.getSettingShallow("max"):!1};this.getDefinition=function(){return b.getSettings("id name plugin note type defval group max _name order hidden".split(" "))};return this};module$src$shared$types$ShapeDiverParameters.default.StringParameter=StringParameter$$module$src$shared$types$ShapeDiverParameters;
var BooleanParameter$$module$src$shared$types$ShapeDiverParameters=function(a){var b=this;void 0===a||"object"!==typeof a?a=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(a=module$src$shared$util$GlobalUtils.default.deepCopy(a),module$src$shared$util$GlobalUtils.default.defaults(a,defaultSettings$$module$src$shared$types$ShapeDiverParameters));a.valuetype="boolean";void 0===a.isValid&&(a.isValid=!0);"boolean"!==typeof a.strictMode||a.strictMode||"string"!==typeof a.defval||("false"===
a.defval.toLowerCase()?a.defval=!1:"true"===a.defval.toLowerCase()?a.defval=!0:0>=parseInt(a.defval)?a.defval=!1:0<parseInt(a.defval)&&(a.defval=!0));if(void 0===a.name||"string"!==typeof a.name||0===a.name.length)a.name="Boolean parameter";if(void 0===a.defval||"boolean"!==typeof a.defval)a.defval=!1,a.isValid=!1;CommonParameter$$module$src$shared$types$ShapeDiverParameters.call(this,a);var c=this.checkValue;this.checkValue=function(a){if("string"===typeof a&&!b.getSettingShallow("strictMode"))if("true"===
a.toLowerCase())a=!0;else if("false"===a.toLowerCase())a=!1;else return!1;return c(a)};var g=this.setValue;this.setValue=function(a){if("string"===typeof a&&!b.getSettingShallow("strictMode"))if("true"===a.toLowerCase())a=!0;else if("false"===a.toLowerCase())a=!1;else return!1;return g(a)};this.getDefinition=function(){return b.getSettings("id name plugin note type defval group _name order hidden".split(" "))};return this};module$src$shared$types$ShapeDiverParameters.default.BooleanParameter=BooleanParameter$$module$src$shared$types$ShapeDiverParameters;
var ColorParameter$$module$src$shared$types$ShapeDiverParameters=function(a){var b=this,c=function(a){return a.toString("hex8").replace("#","0x")};void 0===a||"object"!==typeof a?a=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(a=module$src$shared$util$GlobalUtils.default.deepCopy(a),module$src$shared$util$GlobalUtils.default.defaults(a,defaultSettings$$module$src$shared$types$ShapeDiverParameters));a.max=Number.MAX_SAFE_INTEGER;void 0===a.isValid&&(a.isValid=!0);if(void 0===a.name||
"string"!==typeof a.name||0===a.name.length)a.name="Color parameter";void 0===a.defval&&(a.defval="white");var g=(0,module$src$shared$util$toTinyColor.default)(a.defval);null===g?(a.defval=(0,module$src$shared$util$toTinyColor.default)("white"),a.isValid=!1):a.defval=g;a.defval=c(a.defval);void 0===a.value?a.value=a.defval:(g=(0,module$src$shared$util$toTinyColor.default)(a.defval),null===g?(a.value=(0,module$src$shared$util$toTinyColor.default)("white"),a.isValid=!1):a.value=g);a.value=c(a.value);
StringParameter$$module$src$shared$types$ShapeDiverParameters.call(this,a);var d=this.setValue;this.setValue=function(a){a=(0,module$src$shared$util$toTinyColor.default)(a);return null===a?!1:d(c(a))};this.getValue=function(){return c((0,module$src$shared$util$toTinyColor.default)(b.getSettingShallow("value")))};this.getValueTinyColor=function(){return(0,module$src$shared$util$toTinyColor.default)(b.getSettingShallow("value"))};this.getValueString=function(){return b.getValue()};this.parseValue=function(a){return b.setValue(a)};
this.getDefinition=function(){return b.getSettings("id name plugin note type defval group _name order hidden".split(" "))};return this};module$src$shared$types$ShapeDiverParameters.default.ColorParameter=ColorParameter$$module$src$shared$types$ShapeDiverParameters;
var FileParameter$$module$src$shared$types$ShapeDiverParameters=function(a){var b=this;void 0===a||"object"!==typeof a?a=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(a=module$src$shared$util$GlobalUtils.default.deepCopy(a),module$src$shared$util$GlobalUtils.default.defaults(a,defaultSettings$$module$src$shared$types$ShapeDiverParameters));void 0===a.isValid&&(a.isValid=!0);if(void 0===a.name||"string"!==typeof a.name||0===a.name.length)a.name="File parameter";"boolean"!==typeof a.strictMode||
a.strictMode||["max"].forEach(function(b){"string"===typeof a[b]&&(a[b]=parseInt(a[b]))});void 0===a.defval&&(a.defval="");"string"!==typeof a.defval&&(a.defval="",a.isValid=!1);void 0===a.value&&(a.value=a.defval);"string"!==typeof a.value&&(a.value="",a.isValid=!1);if(void 0===a.max||"number"!==typeof a.max)a.max=0,a.isValid=!1;module$src$shared$util$GlobalUtils.default.isArrayOfType(a.format,"string")||(a.format=[],a.isValid=!1);StringParameter$$module$src$shared$types$ShapeDiverParameters.call(this,
a);var c=function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")?""===a||uuidv4Regex$$module$src$shared$types$ShapeDiverParameters.test(a)||a.startsWith("http://")||a.startsWith("https://")?!0:!1:!1};this.checkValue=function(a){return c(a)};var g=this.setValue;this.setValue=function(a){return c(a)?g(a):!1};this.acceptsBlobs=function(){return!0};this.getDefinition=function(){return b.getSettings("id name plugin note type defval group _name order hidden max format".split(" "))};
return this};module$src$shared$types$ShapeDiverParameters.default.FileParameter=FileParameter$$module$src$shared$types$ShapeDiverParameters;
var ParameterFactory$$module$src$shared$types$ShapeDiverParameters=function(a){var b=this;module$src$shared$mixins$GlobalMixin.default.call(this);module$src$shared$mixins$SettingsMixin.default.call(this,a);module$src$shared$mixins$LoggingMixin.default.call(this);var c=module$src$shared$util$GlobalUtils.default.deepCopy(a),g={"float":FloatParameter$$module$src$shared$types$ShapeDiverParameters,"int":IntegerParameter$$module$src$shared$types$ShapeDiverParameters,even:EvenIntegerParameter$$module$src$shared$types$ShapeDiverParameters,
odd:OddIntegerParameter$$module$src$shared$types$ShapeDiverParameters,string:StringParameter$$module$src$shared$types$ShapeDiverParameters,color:ColorParameter$$module$src$shared$types$ShapeDiverParameters,"stringlist:sequence":ValueListParameter$$module$src$shared$types$ShapeDiverParameters,"stringlist:cycle":ValueListParameter$$module$src$shared$types$ShapeDiverParameters,"stringlist:dropdown":ValueListParameter$$module$src$shared$types$ShapeDiverParameters,"stringlist:checklist":MultipleChoiceParameter$$module$src$shared$types$ShapeDiverParameters,
bool:BooleanParameter$$module$src$shared$types$ShapeDiverParameters,file:FileParameter$$module$src$shared$types$ShapeDiverParameters};this.produce=function(a){a=module$src$shared$util$GlobalUtils.default.deepCopy(a);if(void 0===a.type||"string"!==typeof a.type)b.debug("ShapeDiverParameters~factory","type not defined");else{var d=g[(a.type+":"+a.visualization).toLowerCase()];if(void 0===d&&(d=g[a.type.toLowerCase()],void 0===d)){b.debug("ShapeDiverParameters~factory","type not known: "+a.type.toLowerCase());
return}try{a.hasOwnProperty("hidden")||(a.hidden=!1);module$src$shared$util$GlobalUtils.default.inject(c,a);var p=new d(a);if(p.isValid())return p;b.debug("ShapeDiverParameters~factory","created parameter not valid for "+b.jsify(a)+": "+b.jsify(p.getSettings())+", try to set strictMode to false")}catch(e){b.debug("ShapeDiverParameters~factory","exception creating parameter",a,e)}}};return this};module$src$shared$types$ShapeDiverParameters.default.ParameterFactory=ParameterFactory$$module$src$shared$types$ShapeDiverParameters;var module$src$app$partials$ViewerAppParameterManager={},GlobalUtils$$module$src$app$partials$ViewerAppParameterManager=module$src$shared$util$GlobalUtils.default,pluginConstants$$module$src$app$partials$ViewerAppParameterManager=module$src$shared$constants$PluginConstantsGlobal.default,messagingConstants$$module$src$app$partials$ViewerAppParameterManager=module$src$shared$constants$MessagingConstants.default,MessagePrototype$$module$src$app$partials$ViewerAppParameterManager=module$src$shared$messages$MessagePrototype.default;
module$src$app$partials$ViewerAppParameterManager.default=function(a){var b=this,c={},g=[],d=new module$src$shared$types$ShapeDiverParameters.default.ParameterFactory(b.getSettings());if(a&&a.hasOwnProperty("pluginManager")&&a.pluginManager.hasOwnProperty("getPluginByRuntimeId"))var f=a.pluginManager;var p=[],e=[],m=function(a){if(p.length!==e.length){for(var b=[],d=[],l=e.length,f=Math.max(0,l-50),h=f;h<l;h++)b.push(p[e[h]]),d.push(h-f);e=d;p=b}a||(a=c.getParameterState());p.push(a);e.push(p.length-
1)};c.canGoBackInHistory=function(){return 0>=p.length||0>=e[e.length-1]?!1:!0};c.canGoForwardInHistory=function(){return 0>=p.length||e[e.length-1]>=p.length-1?!1:!0};c.goBackInHistory=function(a){if(!c.canGoBackInHistory())return!1;var b=e[e.length-1]-1;e.push(b);c.setMultipleParameterValues(p[b],a,!1,!0);return!0};c.goForwardInHistory=function(a){if(!c.canGoForwardInHistory())return!1;var b=e[e.length-1]+1;e.push(b);c.setMultipleParameterValues(p[b],a,!1,!0);return!0};c.registerMultipleParameters=
function(a,b){var d=[];Object.keys(a).forEach(function(l){var e=module$src$shared$util$GlobalUtils.default.deepCopy(a[l]);e.id=l;"time"!==e.type.toLowerCase()&&(l=c.registerParameter(e,b),void 0!==l&&d.push(l))});return d};c.registerParameter=function(a,e){if(void 0===e||"string"!==typeof e)b.debug("ViewerAppParameterManager.registerParameter","No plugin specified");else if(a&&"object"===typeof a){a.plugin=e;if(void 0===a.id||"string"!==typeof a.id)a.id=module$src$shared$util$GlobalUtils.default.createRandomId(),
b.debug("ViewerAppParameterManager.registerParameter","No id was specified, using "+a.id);if(void 0!==c.getUniqueParameterBySettings({id:a.id,plugin:e}))b.debug("ViewerAppParameterManager.registerParameter","Parameter with id "+a.id+" and plugin "+e+" already exists");else if(e=d.produce(a),void 0===e)b.debug("ViewerAppParameterManager.registerParameter","Parameter factory failed for definition",a);else return g.push(e),e={},e[a.id]=a,b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PARAMETER_REGISTERED,
new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_DEFINITION,e)),a.id}else b.debug("ViewerAppParameterManager.registerParameter","Definition of parameter missing")};c.updateParameter=function(a){if(!a||"object"!==typeof a)return b.debug("ViewerAppParameterManager.updateParameter","Definition of parameter missing"),!1;var c=q(a);if(void 0===c)return b.debug("ViewerAppParameterManager.updateParameter","Parameter not found",
a),!1;c=g[c];var d=c.getSetting("name");"string"===typeof a.name&&0<a.name.length&&a.name!==d&&(c.getSetting("_name")||c.updateSetting("_name",d),c.updateSetting("name",a.name));"number"===typeof a.order&&c.updateSetting("order",a.order);"boolean"===typeof a.hidden&&c.updateSetting("hidden",a.hidden);c.getDefinition();b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PARAMETER_UPDATE,new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_DEFINITION,
c.getDefinition()));return!0};c.updateMultipleParameters=function(a){Array.isArray(a)||(a=[a]);return a.every(function(a){return c.updateParameter(a)})};c.registerConfig=function(a,d){var e={};if(a.controlNames&&"object"===typeof a.controlNames){var l=a.controlNames;Object.keys(l).forEach(function(a){var b=c.getUniqueParameterBySettings({id:a,plugin:d});b&&(b.getSetting("_name")||b.updateSetting("_name",b.getSetting("name")),b.updateSetting("name",l[a]),e[b.getSettingShallow("id")]=b)})}if(a.controlOrder&&
Array.isArray(a.controlOrder))for(var h=a.controlOrder,f=0;f<h.length;f++){var g=c.getUniqueParameterBySettings({id:h[f],plugin:d});g&&(g.updateSetting("order",f),e[g.getSettingShallow("id")]=g)}if(a.parametersHidden&&Array.isArray(a.parametersHidden))for(a=a.parametersHidden,h=0;h<a.length;h++)if(f=c.getUniqueParameterBySettings({id:a[h],plugin:d}))f.updateSetting("hidden",!0),e[f.getSettingShallow("id")]=f;Object.keys(e).forEach(function(a){a=e[a].getDefinition();var c={};c[a.id]=a;b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PARAMETER_UPDATE,
new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_DEFINITION,c))});return!0};c.getConfig=function(a){a=c.getParameterDefinitionsAndValues({plugin:a});if(Array.isArray(a)){if(0===a.length)return{};var b={};a.forEach(function(a){module$src$shared$util$GlobalUtils.default.typeCheck(a.name,"string")&&module$src$shared$util$GlobalUtils.default.typeCheck(a._name,"string")&&(b.controlNames=b.controlNames||[],b.controlNames.push({id:a.id,
name:a.name}));module$src$shared$util$GlobalUtils.default.typeCheck(a.hidden,"boolean")&&a.hidden&&(b.parametersHidden=b.parametersHidden||[],b.parametersHidden.push(a.id));module$src$shared$util$GlobalUtils.default.typeCheck(a.order,"number")&&(b.controlOrder=b.controlOrder||[],b.controlOrder.push({id:a.id,order:a.order}))});return b}};c.deregisterParameter=function(a,c){var d={};d.id=a;void 0!==c&&(d.plugin=c);d=r(d);if(void 0===d)return b.error("ViewerAppParameterManager.deregisterParameter","Parameter with id "+
a+" and plugin "+c+" not found"),!1;c=g.splice(d,1)[0];b.info("ViewerAppParameterManager.deregisterParameter",'Deregistered parameter "'+c.getSetting("name")+'" with id '+a);return!0};c.getParameterById=function(a,b){var d={};d.id=a;void 0!==b&&(d.plugin=b);return c.getUniqueParameterBySettings(d)};c.getParameterByName=function(a,b){var d={};d.name=a;void 0!==b&&(d.plugin=b);return c.getUniqueParameterBySettings(d)};c.getParameterByIdOrName=function(a,b){var d={};d.id=a;void 0!==b&&(d.plugin=b);b=
c.getUniqueParameterBySettings(d);if(void 0!==b)return b;delete d.id;d.name=a;return c.getUniqueParameterBySettings(d)};c.getParametersBySettings=function(a){return g.filter(function(b){return Object.keys(a).every(function(c){return b.hasSetting(c)&&b.getSettingShallow(c)===a[c]?!0:!1})})};c.idsUnique=function(){var a=[];return g.every(function(b){b=b.getSetting("id");if(a.includes(b))return!1;a.push(b);return!0})};c.namesUnique=function(){var a=[];return g.every(function(b){b=b.getSetting("name");
if(a.includes(b))return!1;a.push(b);return!0})};var h=function(a){var b=[];g.forEach(function(c,d){Object.keys(a).every(function(b){return c.hasSetting(b)&&c.getSettingShallow(b)===a[b]?!0:!1})&&b.push(d)});return b},r=function(a){a=h(a);if(1===a.length)return a[0]};c.getUniqueParameterBySettings=function(a){a=c.getParametersBySettings(a);if(1===a.length)return a[0]};c.getParameterDefinitions=function(a){var d={};(void 0!==a&&"object"===typeof a?c.getParametersBySettings(a):g).forEach(function(a,
l){var e=a.getDefinition();e&&"object"===typeof e?(l=a.getSetting("id"),1<c.getParametersBySettings({id:l}).length&&(l=l+"__"+a.getSetting("plugin")),d[l]=e):b.debug("ViewerAppParameterManager.getParameterDefinitions","Could not get definition of parameter "+l)});return d};c.getParameterDefinitionsAndValues=function(a){a=void 0!==a&&"object"===typeof a?c.getParametersBySettings(a):g;var d=[];a.forEach(function(a,c){var l=a.getDefinition();l&&"object"===typeof l?(l.value=a.getValue(),d.push(l)):b.debug("ViewerAppParameterManager.getParameterDefinitionsAndValues",
"Could not get definition of parameter "+c)});d.sort(function(a,b){var c=a.plugin;var d=b.plugin;"number"===typeof a.order&&"number"===typeof b.order?(c+=Math.floor(1E3*a.order).toString().padStart(8,"0"),d+=Math.floor(1E3*b.order).toString().padStart(8,"0")):(c+=a.name,d+=b.name);return c<d?-1:c>d?1:0});return d};var q=function(a){if(a&&"object"===typeof a){var b={};void 0!==a.plugin&&"string"===typeof a.plugin&&(b.plugin=a.plugin);if(void 0!==a.id&&"string"===typeof a.id){b.id=a.id;var c=r(b);if(void 0!==
c)return c;delete b.id}if(void 0!==a.idOrName&&"string"===typeof a.idOrName){b.id=a.idOrName;c=r(b);if(void 0!==c)return c;delete b.id;b.name=a.idOrName;c=r(b);if(void 0!==c)return c;delete b.name}if(void 0!==a._name&&"string"===typeof a._name&&(b._name=a._name,c=r(b),void 0!==c)||void 0!==a.name&&"string"===typeof a.name&&(b.name=a.name,c=r(b),void 0!==c))return c}};c.updateRequiresPriorUpload=function(a){Array.isArray(a)||(a=[a]);for(var b=!1,c=0,d=a.length;c<d;c++){var e=a[c];if(e.value instanceof
Blob){e=q(e);if(void 0===e)return;g[e].acceptsBlobs()&&(b=!0)}}return b};c.priorUpload=function(a){var c={params:[],plugins:{}},d=function(a,b,d){c.err||(c.err=[]);c.err.push({code:a,msg:b,data:d})};if(!Array.isArray(a))return d(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.ERROR,"Not an array"),Promise.resolve(c);if(void 0===f)return d(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,"Plugin functionality not found"),b.debug("ViewerAppParameterManager.priorUpload",
"Plugin functionality not found"),Promise.resolve(c);for(var l={},e=0,h=a.length;e<h;e++){var r=a[e];if(r.value instanceof Blob){var m=q(r);if(void 0===m)return d(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PARAM_NOT_FOUND,"Could not find parameter",r),b.debug("ViewerAppParameterManager.priorUpload","Could not find parameter",r),Promise.resolve(c);m=g[m];r.id=m.getSetting("id");r.plugin=m.getSetting("plugin");if(!m.checkBlob(r.value))return d(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_REJECT,
"Blob size or type rejected",r),c.params.push({id:r.id,plugin:r.plugin,result:module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_REJECT}),b.debug("ViewerAppParameterManager.priorUpload","Blob size or type rejected"),Promise.resolve(c);l.hasOwnProperty(r.plugin)||(l[r.plugin]={request:{},data:{}});l[r.plugin].request[r.id]={format:r.value._type,size:r.value.size};l[r.plugin].data[r.id]=r.value;c.params.push({id:r.id,plugin:r.plugin,result:module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_OK})}}e=
[];var p=[],t;for(t in l){h=f.getPluginByRuntimeId(t);if(!h)return d(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,"Plugin not found",t),b.debug("ViewerAppParameterManager.priorUpload","Plugin "+t+" not found"),c.plugins[t]=module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,Promise.resolve(c);e.push(h.fileUpload(l[t]));p.push(t)}return Promise.all(e).then(function(b){for(var d={},l=0,e=b.length;l<e;d={plugin$121:d.plugin$121},
l++){d.plugin$121=p[l];var n=b[l],h={},f;for(f in n){h.id$122=f;var r=a.find(function(a,b){return function(c){return c.plugin===a.plugin$121&&c.id===b.id$122}}(d,h));if(!r)throw Error("ViewerAppParameterManager.priorUpload: internal error, parameter not found");r.value=n[h.id$122];h={id$122:h.id$122}}}return c},function(a){d(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.UPLOAD_FAILED,"Upload failed",a);return c})};c.setParameterValue=function(a,b){return c.setMultipleParameterValues([a],
b)};c.setMultipleParameterValues=function(a,d,n,l){void 0===n&&(n=!1);var h=c.getParameterState(),r={params:[],plugins:{}};d=module$src$shared$constants$MessagingConstants.default.makeMessageToken(d);r.token=d;var p=function(a,b,c){r.err||(r.err=[]);r.err.push({code:a,msg:b,data:c})},t=function(a,b,c){r.warn||(r.warn=[]);r.warn.push({code:a,msg:b,data:c})},u=[];a.forEach(function(a){var c=q(a);void 0===c?(p(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PARAM_NOT_FOUND,
"Could not find parameter",a),b.debug("ViewerAppParameterManager.setMultipleParameterValues","Could not find parameter",a)):(a.idx=c,c=g[c],a.id=c.getSetting("id"),a.plugin=c.getSetting("plugin"),u.includes(a.plugin)||u.push(a.plugin),void 0===a.value?(p(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.NO_VALUE,"Parameter value not set",a.value),r.params.push({id:a.id,plugin:a.plugin,result:module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.NO_VALUE}),
b.debug("ViewerAppParameterManager.setMultipleParameterValues","Parameter value not set",a,c)):c.checkValue(a.value)||(p(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_REJECT,"Parameter value rejected",a.value),r.params.push({id:a.id,plugin:a.plugin,result:module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_REJECT}),b.debug("ViewerAppParameterManager.setMultipleParameterValues","Parameter value rejected",a,c)))});if(r.err||r.warn)return r;
var B=!0,A=[];a.forEach(function(a){var c=g[a.idx];c.isValueDifferent(a.value)?(A.includes(a.plugin)||A.push(a.plugin),B=!1,c.setValue(a.value)?r.params.push({id:a.id,plugin:a.plugin,result:module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_OK}):(p(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_REJECT,"Parameter value rejected",a.value),r.params.push({id:a.id,plugin:a.plugin,result:module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_REJECT}),
b.debug("ViewerAppParameterManager.setMultipleParameterValues","Parameter value rejected",a,c))):r.params.push({id:a.id,plugin:a.plugin,result:module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_EXISTS})});if(r.err)return n=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,r.err,d),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,n),r;n&&
(A=u);A.forEach(function(){var a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{busy:!1,progress:0},d);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,a)});if(B&&!n)return n=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS,"All parameter values up to date",d),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,
n),r;0===e.length&&m(h);l||B||m();n=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{busy:!0,progress:0},d);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,n);var D={};if(1<A.length){n=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_FORK,[],d);l=(A.length+"").length;for(h=0;h<A.length;h++){var H=
module$src$shared$util$GlobalUtils.default.deepCopy(d);H.id=d.id+"."+(Array(l).join("0")+h).slice(-l);D[A[h]]=H;n.parts[0].data.push(H.id)}b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,n)}else A.forEach(function(a){D[a]=module$src$shared$util$GlobalUtils.default.deepCopy(d)});var G={};A.forEach(function(c){var d=a.filter(function(a){return a.plugin===c});G[c]={};var l=G[c];d.forEach(function(a){l[a.id]=g[a.idx].getValue()});var e;if(void 0===f)t(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,
"Plugin functionality not found",c),b.warn("ViewerAppParameterManager.setMultipleParameterValues","Plugin functionality not found"),r.plugins[c]=module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND;else if(e=f.getPluginByRuntimeId(c)){var n={};e.getCapabilities().includes(module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities.PARTIAL_UPDATES)?(d.forEach(function(a){n[a.id]=g[a.idx].getValueString()}),d=e.setMultipleParameterValues(n,
D[c]),r.plugins[c]=d):(d.forEach(function(a){n[a.id]=g[a.idx].getValueString()}),g.forEach(function(a){var b=a.getSetting("id");c!==a.getSetting("plugin")||n.hasOwnProperty(b)||(n[b]=a.getValueString())}),d=e.setAllParameterValues(n,D[c]),r.plugins[c]=d)}else p(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,"Plugin not found",c),b.debug("ViewerAppParameterManager.setMultipleParameterValues","Plugin "+c+" not found"),r.plugins[c]=module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND});
n=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_UPDATE,G,d);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PARAMETER_VALUE_UPDATE,n);if(r.err||r.warn)n=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,r.err,d),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,
n);return r};c.getParameterValuesForPlugin=function(a,b){var d={};c.getParametersBySettings({plugin:a}).forEach(function(a){b?d[a.getSetting("id")]=a.getValueString():d[a.getSetting("id")]=a.getSetting("value")});return d};c.refreshPluginInitial=function(a,b){var d={plugins:{}};b=module$src$shared$constants$MessagingConstants.default.makeMessageToken(b);d.token=b;var l=function(a,b,c){d.err||(d.err=[]);d.err.push({code:a,msg:b,data:c})};if(void 0===f)return l(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,
"Plugin functionality not found",a),d.plugins[a]=module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,d;var e=f.getPluginByRuntimeId(a);return e?e.hasSetting("deferGeometryLoading")&&e.getSettingShallow("deferGeometryLoading")?(d.plugins[a]=module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.ABORT,d):c.refreshPlugin(a,b):(l(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,"Plugin not found",
a),d.plugins[a]=module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,d)};c.refreshPlugin=function(a,d){var e={plugins:{}};d=module$src$shared$constants$MessagingConstants.default.makeMessageToken(d);e.token=d;var l=function(a,b,c){e.err||(e.err=[]);e.err.push({code:a,msg:b,data:c})},h=[];c.getParametersBySettings({plugin:a}).forEach(function(b){h.push({id:b.getSetting("id"),value:b.getSetting("value"),plugin:a})});if(0>=h.length&&f){var r=f.getPluginByRuntimeId(a);
if(!r)return l(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,"Plugin not found",a),e.plugins[a]=module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,e;l=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{busy:!0,progress:0},d);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,l);
e.plugins[a]=r.setAllParameterValues({},d);return e}return c.setMultipleParameterValues(h,d,!0)};c.getParameterValuesCompat=function(){var a={};g.forEach(function(b){a[b.getSettingShallow("id")]=b.getSetting("value")});return a};c.getParameterState=function(){var a=[];g.forEach(function(b){a.push({id:b.getSettingShallow("id"),plugin:b.getSettingShallow("plugin"),value:b.getSettingShallow("value")})});return a};return c};var module$src$app$partials$ViewerAppExportManager={},GlobalUtils$$module$src$app$partials$ViewerAppExportManager=module$src$shared$util$GlobalUtils.default,pluginConstants$$module$src$app$partials$ViewerAppExportManager=module$src$shared$constants$PluginConstantsGlobal.default,messagingConstants$$module$src$app$partials$ViewerAppExportManager=module$src$shared$constants$MessagingConstants.default,MessagePrototype$$module$src$app$partials$ViewerAppExportManager=module$src$shared$messages$MessagePrototype.default;
module$src$app$partials$ViewerAppExportManager.default=function(a){var b=this,c=a.pluginManager,g=a.parameterManager,d={},f=[];d.registerMultipleExports=function(a,b){Object.keys(a).forEach(function(c){var e=module$src$shared$util$GlobalUtils.default.deepCopy(a[c]);e.id=c;d.registerExport(e,b)});return[]};d.registerExport=function(a,c){if(void 0!==c&&module$src$shared$util$GlobalUtils.default.typeCheck(c,"string"))if(void 0===a||"object"!==typeof a)b.debug("ViewerAppExportManager.registerExport",
"Definition of export missing");else if(a.plugin=c,void 0!==a.id&&module$src$shared$util$GlobalUtils.default.typeCheck(a.id,"string")||(a.id=module$src$shared$util$GlobalUtils.default.createRandomId(),b.debug("ViewerAppExportManager.registerExport","No id was specified, using "+a.id)),void 0!==d.getUniqueExportByProperties({id:a.id,plugin:c}))b.debug("ViewerAppExportManager.registerExport","Export with id "+a.id+" and plugin "+c+" already exists");else return a.hasOwnProperty("hidden")||(a.hidden=
!1),void 0===a.name&&b.warn("ViewerAppExportManager.registerExport","Export without name:",a),f.push(a),c={},c[a.id]=module$src$shared$util$GlobalUtils.default.deepCopy(a),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_REGISTERED,new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_DEFINITION,c)),a.id;else b.debug("ViewerAppExportManager.registerExport","No plugin specified")};
d.registerConfig=function(a,c){var e={};if(void 0!==a.controlNames&&"object"===typeof a.controlNames){var f=a.controlNames;Object.keys(f).forEach(function(a){var b=d.getUniqueExportByProperties({id:a,plugin:c});b&&(void 0===b._name&&(b._name=module$src$shared$util$GlobalUtils.default.deepCopy(b.name)),b.name=module$src$shared$util$GlobalUtils.default.deepCopy(f[a]),e[b.id]=b)})}if(void 0!==a.controlOrder&&Array.isArray(a.controlOrder))for(var h=a.controlOrder,n=0;n<h.length;n++){var l=d.getUniqueExportByProperties({id:h[n],
plugin:c});l&&(l.order=n,e[l.id]=l)}if(void 0!==a.parametersHidden&&Array.isArray(a.parametersHidden))for(a=a.parametersHidden,h=0;h<a.length;h++)if(n=d.getUniqueExportByProperties({id:a[h],plugin:c}))n.hidden=!0,e[n.id]=n;Object.keys(e).forEach(function(a){a=module$src$shared$util$GlobalUtils.default.deepCopy(e[a]);var c={};c[a.id]=a;b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_UPDATE,new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_DEFINITION,
c))});return!0};d.getConfig=function(a){var b=d.getExportDefinitions();if(Array.isArray(b)){b=b.filter(function(b){return void 0===b.plugin||b.plugin===a});if(0===b.length)return{};var c={};b.forEach(function(a){module$src$shared$util$GlobalUtils.default.typeCheck(a.name,"string")&&module$src$shared$util$GlobalUtils.default.typeCheck(a._name,"string")&&(c.controlNames=c.controlNames||[],c.controlNames.push({id:a.id,name:a.name}));module$src$shared$util$GlobalUtils.default.typeCheck(a.hidden,"boolean")&&
a.hidden&&(c.parametersHidden=c.parametersHidden||[],c.parametersHidden.push(a.id));module$src$shared$util$GlobalUtils.default.typeCheck(a.order,"number")&&(c.controlOrder=c.controlOrder||[],c.controlOrder.push({id:a.id,order:a.order}))});return c}};d.updateExport=function(a){if(!a||"object"!==typeof a)return b.debug("ViewerAppExportManager.updateExport","Definition of export missing"),!1;var c=m(a);if(void 0===c)return b.debug("ViewerAppExportManager.updateExport","Export not found",a),!1;c=f[c];
"string"===typeof a.name&&0<a.name.length&&a.name!==c.name&&(void 0===c._name&&(c._name=module$src$shared$util$GlobalUtils.default.deepCopy(c.name)),c.name=module$src$shared$util$GlobalUtils.default.deepCopy(a.name));"number"===typeof a.order&&(c.order=a.order);"boolean"===typeof a.hidden&&(c.hidden=a.hidden);a=module$src$shared$util$GlobalUtils.default.deepCopy(c);c={};c[a.id]=a;b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_UPDATE,new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_DEFINITION,
c));return!0};d.updateMultipleExports=function(a){Array.isArray(a)||(a=[a]);return a.every(function(a){return d.updateExport(a)})};d.deregisterExport=function(a,c){var d={};d.id=a;void 0!==c&&(d.plugin=c);d=e(d);if(void 0===d)return b.error("ViewerAppExportManager.deregisterExport","Export with id "+a+" and plugin "+c+" not found"),!1;c=f.splice(d,1)[0];b.info("ViewerAppExportManager.deregisterExport",'Deregistered export "'+c.name+'" with id '+a);return!0};d.getExportById=function(a,b){var c={};
c.id=a;void 0!==b&&(c.plugin=b);return d.getUniqueExportByProperties(c)};d.getExportByName=function(a,b){var c={};c.name=a;void 0!==b&&(c.plugin=b);return d.getUniqueExportByProperties(c)};d.getExportByIdOrName=function(a,b){var c={};c.id=a;void 0!==b&&(c.plugin=b);b=d.getUniqueExportByProperties(c);if(void 0!==b)return b;delete c.id;c.name=a;return d.getUniqueExportByProperties(c)};d.getExportsByProperties=function(a){return f.filter(function(b){return Object.keys(a).every(function(c){return b.hasOwnProperty(c)&&
b[c]===a[c]?!0:!1})})};var p=function(a){var b=[];f.forEach(function(c,d){Object.keys(a).every(function(b){return c.hasOwnProperty(b)&&c[b]===a[b]?!0:!1})&&b.push(d)});return b},e=function(a){a=p(a);if(1===a.length)return a[0]};d.getUniqueExportByProperties=function(a){a=d.getExportsByProperties(a);if(1===a.length)return a[0]};d.getExportDefinitions=function(){var a=[];f.forEach(function(b){b=module$src$shared$util$GlobalUtils.default.deepCopy({id:b.id,name:b.name,type:b.type,plugin:b.plugin,group:b.group,
hidden:b.hidden,order:b.order,_name:b._name});a.push(b)});a.sort(function(a,b){var c=a.plugin;var d=b.plugin;"number"===typeof a.order&&"number"===typeof b.order?(c+=Math.floor(1E3*a.order).toString().padStart(8,"0"),d+=Math.floor(1E3*b.order).toString().padStart(8,"0")):(c+=a.name,d+=b.name);return c<d?-1:c>d?1:0});return a};var m=function(a){if(void 0!==a&&"object"===typeof a){var b={};void 0!==a.plugin&&"string"===typeof a.plugin&&(b.plugin=a.plugin);if(void 0!==a.id&&"string"===typeof a.id){b.id=
a.id;var c=e(b);if(void 0!==c)return c;delete b.id}if(void 0!==a.idOrName&&"string"===typeof a.idOrName){b.id=a.idOrName;c=e(b);if(void 0!==c)return c;delete b.id;b.name=a.idOrName;c=e(b);if(void 0!==c)return c;delete b.name}if(void 0!==a._name&&"string"===typeof a._name&&(b._name=a._name,c=e(b),void 0!==c)||void 0!==a.name&&"string"===typeof a.name&&(b.name=a.name,c=e(b),void 0!==c))return c}};d.getUniqueExportByRequestObject=function(a){a=m(a);if(void 0!==a)return module$src$shared$util$GlobalUtils.default.deepCopy(f[a])};
d.requestExport=function(a,d){d=module$src$shared$constants$MessagingConstants.default.makeMessageToken(d);var e=function(a,c){d&&(c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,c,d),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,c));return a},h=m(a);if(void 0===h)return b.error("ViewerAppExportManager.requestExport","Export not found",a),e(module$src$shared$constants$PluginConstantsGlobal.default.requestExportResults.EXPORT_NOT_FOUND,
"Export not found");a=f[h];h=g.getParameterValuesForPlugin(a.plugin,!0);if(void 0===c||void 0===c.getPluginByRuntimeId)return b.error("ViewerAppExportManager.requestExport","Plugin manager not found"),e(module$src$shared$constants$PluginConstantsGlobal.default.requestExportResults.PLUGIN_NOT_FOUND,"Plugin manager not found");var r=c.getPluginByRuntimeId(a.plugin);if(!r)return a="Plugin "+a.plugin+" not found",b.error("ViewerAppExportManager.requestExport",a),e(module$src$shared$constants$PluginConstantsGlobal.default.requestExportResults.PLUGIN_NOT_FOUND,
a);d&&(e=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{progress:0},d),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,e),e=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_STATUS,a,d),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_STATUS,e));
return r.requestExport(a.id,h,d)};return d};var module$src$3d$viewports$default$defaults$DefaultHighlights={default:[{apply:function(a,b){a.material&&(a.material.opacity*=b.opacity,a.material.transparent=!0)},remove:function(a,b){a.material&&(a.material.opacity*=1/b.opacity,a.material.transparent=!1)}},{apply:function(a,b){a.material&&(a.material.color.r+=b.color.r,a.material.color.g+=b.color.g,a.material.color.b+=b.color.b)},remove:function(a,b){a.material&&(a.material.color.r-=b.color.r,a.material.color.g-=b.color.g,a.material.color.b-=b.color.b)}}]};var module$src$3d$InteractionGroupManager={default:function(){var a,b=[],c=function(){a=this};c.prototype.InteractionGroup=function(a){var b={},c=a.name,g=a.selectable||!1,e=a.draggable||!1,m=a.hoverable||!1,h=a.selectionMode||"single",r=function(a){if(!a)return null;if("function"===typeof a.apply&&"function"===typeof a.remove)return a;a.name||(a.name="opacityHighlight");"opacityHighlight"==a.name?(a.apply=module$src$3d$viewports$default$defaults$DefaultHighlights.default[0].apply,a.remove=module$src$3d$viewports$default$defaults$DefaultHighlights.default[0].remove,
a.options)?a.options.opacity||(a.options.opacity=.5):a.options={opacity:.5}:"colorHighlight"==a.name&&(a.apply=module$src$3d$viewports$default$defaults$DefaultHighlights.default[1].apply,a.remove=module$src$3d$viewports$default$defaults$DefaultHighlights.default[1].remove,a.options?a.options.color=a.options.color?(0,module$src$shared$util$toTinyColor.default)(a.options.color,"red").toThreeColor():new module$src$externals$three.default.Color(1,0,0):a.options={color:new module$src$externals$three.default.Color(1,
0,0)});return a.apply&&a.remove?a:null},q={active:a.selectableHighlight&&a.selectableHighlight.active?r(a.selectableHighlight.active):null,passive:a.selectableHighlight&&a.selectableHighlight.passive?r(a.selectableHighlight.passive):null},t={active:a.draggableHighlight&&a.draggableHighlight.active?r(a.draggableHighlight.active):null,passive:a.draggableHighlight&&a.draggableHighlight.passive?r(a.draggableHighlight.passive):null},u={active:a.hoverableHighlight&&a.hoverableHighlight.active?r(a.hoverableHighlight.active):
null,passive:a.hoverableHighlight&&a.hoverableHighlight.passive?r(a.hoverableHighlight.passive):null};b.getName=function(){return c};b.isSelectable=function(){return g};b.isDraggable=function(){return e};b.isHoverable=function(){return m};b.getSelectionMode=function(){return h};b.getSelectableHighlight=function(){return q};b.getDraggableHighlight=function(){return t};b.getHoverableHighlight=function(){return u};return b};c.prototype.addInteractionGroup=function(c){return c.name&&!a.isInteractionGroup(c.name)?
(b.push(new a.InteractionGroup(c)),!0):!1};c.prototype.addOrReplaceInteractionGroup=function(c){b=b.filter(function(a){return a.getName()!==c.name});return a.addInteractionGroup(c)};c.prototype.isInteractionGroup=function(b){return null==a.getGroup(b)?!1:!0};c.prototype.getGroup=function(a){for(var c=0,f=b.length;c<f;c++)if(b[c].getName()==a)return b[c];return null};c.prototype.getGroups=function(){return b};return new c}};var module$src$3d$interfaces$ThreeDManagerInterface={default:function(a){this.lightHandler=this.materialHandler=this.cameraHandler=this.renderingHandler=null;this.success=!0;module$src$shared$mixins$GlobalMixin.default.call(this);module$src$shared$util$GlobalUtils.default.inject(a.loggingHandler,this);module$src$shared$util$GlobalUtils.default.inject(a.messagingHandler,this)}};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.init=function(a){};
module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.adjustScene=function(){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.computeBoundingBox=function(a){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.pause=function(){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.resume=function(){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.destroy=function(){};
module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.addMesh=function(a,b,c){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.removeMesh=function(a){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.addAnchor=function(a,b){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.removeAnchor=function(a){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.fadeIn=function(a,b){};
module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.fadeOut=function(a,b){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.setLiveTransformation=function(a,b,c,g,d){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.updateInteractions=function(a,b){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.removeFromInteractions=function(a){};var module$src$3d$viewports$simple$ThreeDManagerConstants={},threeDManagerConstants$$module$src$3d$viewports$simple$ThreeDManagerConstants,_convert=function(a,b){for(var c in a){if("value"===c)return _hasSubValue(a[c])?_convert(a[c],b):a[c];"setting"!==c&&"desc"!==c&&"type"!==c&&(b[c]={},b[c]=_convert(a[c],b[c]))}return b},_hasSubValue=function(a){if("object"===typeof a)for(var b in a)if("value"===b||_hasSubValue(a[b]))return!0;return!1},GLOBAL_UTILS=module$src$shared$util$GlobalUtils.default,LOGGING_CONSTANTS=
module$src$shared$constants$LoggingConstants.default,LOGGING_LEVELS=module$src$shared$constants$LoggingConstants.default.loggingLevels,_settingsDefinition={show:{value:!1,setting:"show",desc:"Show / hide the scene",type:"boolean"},showTransition:{value:"1s"},groundPlaneVisibility:{value:!0,setting:"groundPlaneVisibility",desc:"Show / hide the ground plane",type:"boolean"},render:{devicePixelRatio:{value:1},clearColor:{value:"#ffffff",setting:"render.clearColor",desc:"Set background color",type:function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,
"color")?!0:!1}}},camera:{far:{value:100},fov:{value:45,setting:"camera.fov",desc:"Camera frustum vertical field of view angle, unit degree",type:function(a){return"number"===typeof a&&0<a&&180>a?!0:!1}},near:{value:.01}},material:{defaultColor:{value:"#00aaaa",setting:"material.defaultColor",desc:"The default color of the material",type:function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"color")?!0:!1}}}},_defaultSettings={};_convert(_settingsDefinition,_defaultSettings);
threeDManagerConstants$$module$src$3d$viewports$simple$ThreeDManagerConstants={settingsDefinition:_settingsDefinition,defaultSettings:_defaultSettings,loggingLevels:LOGGING_LEVELS};module$src$3d$viewports$simple$ThreeDManagerConstants.default=module$src$shared$util$GlobalUtils.default.deepCopy(threeDManagerConstants$$module$src$3d$viewports$simple$ThreeDManagerConstants);var module$node_modules$$tweenjs$tween_js$src$Tween={},_Group$$module$node_modules$$tweenjs$tween_js$src$Tween=function(){this._tweens={};this._tweensAddedDuringUpdate={}};
_Group$$module$node_modules$$tweenjs$tween_js$src$Tween.prototype={getAll:function(){return Object.keys(this._tweens).map(function(a){return this._tweens[a]}.bind(this))},removeAll:function(){this._tweens={}},add:function(a){this._tweens[a.getId()]=a;this._tweensAddedDuringUpdate[a.getId()]=a},remove:function(a){delete this._tweens[a.getId()];delete this._tweensAddedDuringUpdate[a.getId()]},update:function(a,b){var c=Object.keys(this._tweens);if(0===c.length)return!1;for(a=void 0!==a?a:module$node_modules$$tweenjs$tween_js$src$Tween.default.now();0<
c.length;){this._tweensAddedDuringUpdate={};for(var g=0;g<c.length;g++){var d=this._tweens[c[g]];d&&!1===d.update(a)&&(d._isPlaying=!1,b||delete this._tweens[c[g]])}c=Object.keys(this._tweensAddedDuringUpdate)}return!0}};module$node_modules$$tweenjs$tween_js$src$Tween.default=new _Group$$module$node_modules$$tweenjs$tween_js$src$Tween;module$node_modules$$tweenjs$tween_js$src$Tween.default.Group=_Group$$module$node_modules$$tweenjs$tween_js$src$Tween;
module$node_modules$$tweenjs$tween_js$src$Tween.default._nextId=0;module$node_modules$$tweenjs$tween_js$src$Tween.default.nextId=function(){return module$node_modules$$tweenjs$tween_js$src$Tween.default._nextId++};
module$node_modules$$tweenjs$tween_js$src$Tween.default.now="undefined"===typeof window&&"undefined"!==typeof process?function(){var a=process.hrtime();return 1E3*a[0]+a[1]/1E6}:"undefined"!==typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now.bind(window.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()};
module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween=function(a,b){this._object=a;this._valuesStart={};this._valuesEnd={};this._valuesStartRepeat={};this._duration=1E3;this._repeat=0;this._repeatDelayTime=void 0;this._reversed=this._isPlaying=this._yoyo=!1;this._delayTime=0;this._startTime=null;this._easingFunction=module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Linear.None;this._interpolationFunction=module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation.Linear;
this._chainedTweens=[];this._onStartCallback=null;this._onStartCallbackFired=!1;this._onStopCallback=this._onCompleteCallback=this._onUpdateCallback=null;this._group=b||module$node_modules$$tweenjs$tween_js$src$Tween.default;this._id=module$node_modules$$tweenjs$tween_js$src$Tween.default.nextId()};
module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},to:function(a,b){this._valuesEnd=a;void 0!==b&&(this._duration=b);return this},start:function(a){this._group.add(this);this._isPlaying=!0;this._onStartCallbackFired=!1;this._startTime=void 0!==a?"string"===typeof a?module$node_modules$$tweenjs$tween_js$src$Tween.default.now()+parseFloat(a):a:module$node_modules$$tweenjs$tween_js$src$Tween.default.now();
this._startTime+=this._delayTime;for(var b in this._valuesEnd){if(this._valuesEnd[b]instanceof Array){if(0===this._valuesEnd[b].length)continue;this._valuesEnd[b]=[this._object[b]].concat(this._valuesEnd[b])}void 0!==this._object[b]&&(this._valuesStart[b]=this._object[b],!1===this._valuesStart[b]instanceof Array&&(this._valuesStart[b]*=1),this._valuesStartRepeat[b]=this._valuesStart[b]||0)}return this},stop:function(){if(!this._isPlaying)return this;this._group.remove(this);this._isPlaying=!1;null!==
this._onStopCallback&&this._onStopCallback(this._object);this.stopChainedTweens();return this},end:function(){this.update(this._startTime+this._duration);return this},stopChainedTweens:function(){for(var a=0,b=this._chainedTweens.length;a<b;a++)this._chainedTweens[a].stop()},group:function a(a){this._group=a;return this},delay:function(a){this._delayTime=a;return this},repeat:function(a){this._repeat=a;return this},repeatDelay:function(a){this._repeatDelayTime=a;return this},yoyo:function(a){this._yoyo=
a;return this},easing:function(a){this._easingFunction=a;return this},interpolation:function(a){this._interpolationFunction=a;return this},chain:function(){this._chainedTweens=arguments;return this},onStart:function(a){this._onStartCallback=a;return this},onUpdate:function(a){this._onUpdateCallback=a;return this},onComplete:function(a){this._onCompleteCallback=a;return this},onStop:function(a){this._onStopCallback=a;return this},update:function(a){var b;if(a<this._startTime)return!0;!1===this._onStartCallbackFired&&
(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0);var c=(a-this._startTime)/this._duration;c=0===this._duration||1<c?1:c;var g=this._easingFunction(c);for(b in this._valuesEnd)if(void 0!==this._valuesStart[b]){var d=this._valuesStart[b]||0,f=this._valuesEnd[b];f instanceof Array?this._object[b]=this._interpolationFunction(f,g):("string"===typeof f&&(f="+"===f.charAt(0)||"-"===f.charAt(0)?d+parseFloat(f):parseFloat(f)),"number"===typeof f&&(this._object[b]=
d+(f-d)*g))}null!==this._onUpdateCallback&&this._onUpdateCallback(this._object);if(1===c)if(0<this._repeat){isFinite(this._repeat)&&this._repeat--;for(b in this._valuesStartRepeat)"string"===typeof this._valuesEnd[b]&&(this._valuesStartRepeat[b]+=parseFloat(this._valuesEnd[b])),this._yoyo&&(c=this._valuesStartRepeat[b],this._valuesStartRepeat[b]=this._valuesEnd[b],this._valuesEnd[b]=c),this._valuesStart[b]=this._valuesStartRepeat[b];this._yoyo&&(this._reversed=!this._reversed);this._startTime=void 0!==
this._repeatDelayTime?a+this._repeatDelayTime:a+this._delayTime}else{null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);a=0;for(b=this._chainedTweens.length;a<b;a++)this._chainedTweens[a].start(this._startTime+this._duration);return!1}return!0}};
module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing={Linear:{None:function(a){return a}},Quadratic:{In:function(a){return a*a},Out:function(a){return a*(2-a)},InOut:function(a){return 1>(a*=2)?.5*a*a:-.5*(--a*(a-2)-1)}},Cubic:{In:function(a){return a*a*a},Out:function(a){return--a*a*a+1},InOut:function(a){return 1>(a*=2)?.5*a*a*a:.5*((a-=2)*a*a+2)}},Quartic:{In:function(a){return a*a*a*a},Out:function(a){return 1- --a*a*a*a},InOut:function(a){return 1>(a*=2)?.5*a*a*a*a:-.5*((a-=2)*a*a*
a-2)}},Quintic:{In:function(a){return a*a*a*a*a},Out:function(a){return--a*a*a*a*a+1},InOut:function(a){return 1>(a*=2)?.5*a*a*a*a*a:.5*((a-=2)*a*a*a*a+2)}},Sinusoidal:{In:function(a){return 1-Math.cos(a*Math.PI/2)},Out:function(a){return Math.sin(a*Math.PI/2)},InOut:function(a){return.5*(1-Math.cos(Math.PI*a))}},Exponential:{In:function(a){return 0===a?0:Math.pow(1024,a-1)},Out:function(a){return 1===a?1:1-Math.pow(2,-10*a)},InOut:function(a){return 0===a?0:1===a?1:1>(a*=2)?.5*Math.pow(1024,a-1):
.5*(-Math.pow(2,-10*(a-1))+2)}},Circular:{In:function(a){return 1-Math.sqrt(1-a*a)},Out:function(a){return Math.sqrt(1- --a*a)},InOut:function(a){return 1>(a*=2)?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)}},Elastic:{In:function(a){return 0===a?0:1===a?1:-Math.pow(2,10*(a-1))*Math.sin(5*(a-1.1)*Math.PI)},Out:function(a){return 0===a?0:1===a?1:Math.pow(2,-10*a)*Math.sin(5*(a-.1)*Math.PI)+1},InOut:function(a){if(0===a)return 0;if(1===a)return 1;a*=2;return 1>a?-.5*Math.pow(2,10*(a-1))*Math.sin(5*
(a-1.1)*Math.PI):.5*Math.pow(2,-10*(a-1))*Math.sin(5*(a-1.1)*Math.PI)+1}},Back:{In:function(a){return a*a*(2.70158*a-1.70158)},Out:function(a){return--a*a*(2.70158*a+1.70158)+1},InOut:function(a){return 1>(a*=2)?.5*a*a*(3.5949095*a-2.5949095):.5*((a-=2)*a*(3.5949095*a+2.5949095)+2)}},Bounce:{In:function(a){return 1-module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Bounce.Out(1-a)},Out:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/
2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},InOut:function(a){return.5>a?.5*module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Bounce.In(2*a):.5*module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Bounce.Out(2*a-1)+.5}}};
module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation={Linear:function(a,b){var c=a.length-1,g=c*b,d=Math.floor(g),f=module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation.Utils.Linear;return 0>b?f(a[0],a[1],g):1<b?f(a[c],a[c-1],c-g):f(a[d],a[d+1>c?c:d+1],g-d)},Bezier:function(a,b){for(var c=0,g=a.length-1,d=Math.pow,f=module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation.Utils.Bernstein,p=0;p<=g;p++)c+=d(1-b,g-p)*d(b,p)*a[p]*f(g,p);return c},CatmullRom:function(a,
b){var c=a.length-1,g=c*b,d=Math.floor(g),f=module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation.Utils.CatmullRom;return a[0]===a[c]?(0>b&&(d=Math.floor(g=c*(1+b))),f(a[(d-1+c)%c],a[d],a[(d+1)%c],a[(d+2)%c],g-d)):0>b?a[0]-(f(a[0],a[0],a[1],a[1],-g)-a[0]):1<b?a[c]-(f(a[c],a[c],a[c-1],a[c-1],g-c)-a[c]):f(a[d?d-1:0],a[d],a[c<d+1?c:d+1],a[c<d+2?c:d+2],g-d)},Utils:{Linear:function(a,b,c){return(b-a)*c+a},Bernstein:function(a,b){var c=module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation.Utils.Factorial;
return c(a)/c(b)/c(a-b)},Factorial:function(){var a=[1];return function(b){var c=1;if(a[b])return a[b];for(var g=b;1<g;g--)c*=g;return a[b]=c}}(),CatmullRom:function(a,b,c,g,d){a=.5*(c-a);g=.5*(g-b);var f=d*d;return(2*b-2*c+a+g)*d*f+(-3*b+3*c-2*a-g)*f+a*d+b}}};var module$src$3d$helpers$ThreeDManagerHelpers={default:function(a,b){var c=a.pathUtils,g=a.scene,d=a.geometryNode,f,p=new module$src$externals$three.default.Object3D,e=new module$src$externals$three.default.Object3D,m=[],h=[],r=[],q=[],t=!1,u=!0,n=!0,l=!0;a=function(){f=this;p.visible=!1;g.add(p);e.visible=!1;g.add(e)};a.prototype._createTransformationObject=function(a,b){b.pivot=b.pivot?new module$src$externals$three.default.Vector3(b.pivot.x,b.pivot.y,b.pivot.z):null;if("rotation"===b.type){var l=
{degree:0},e=(new module$src$externals$three.default.Vector3(b.rotationAxis.x,b.rotationAxis.y,b.rotationAxis.z)).normalize();var n=(new module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween(l,a)).to({degree:b.rotationDegree*Math.PI/180},b.duration);if(b.parent&&b.pivot)n.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4,f=new module$src$externals$three.default.Matrix4,h=new module$src$externals$three.default.Matrix4,g=c.getPathObject(d,b.parent);g&&(g.updateMatrix(!0),
g.updateMatrixWorld(!0),f=g.matrixWorld);h.makeTranslation(b.pivot.x,b.pivot.y,b.pivot.z);a.multiply(h);a.multiply((new module$src$externals$three.default.Matrix4).makeRotationAxis(e,l.degree));a.multiply((new module$src$externals$three.default.Matrix4).getInverse(h));n.transformationMatrix=f.multiply(a)});else if(b.parent)n.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4,f=new module$src$externals$three.default.Matrix4,h=c.getPathObject(d,b.parent);h&&(h.updateMatrix(!0),
h.updateMatrixWorld(!0),f=h.matrixWorld);a.multiply((new module$src$externals$three.default.Matrix4).makeRotationAxis(e,l.degree));n.transformationMatrix=f.multiply(a)});else if(b.pivot)n.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4,c=new module$src$externals$three.default.Matrix4;c.makeTranslation(b.pivot.x,b.pivot.y,b.pivot.z);a.multiply(c);a.multiply((new module$src$externals$three.default.Matrix4).makeRotationAxis(e,l.degree));a.multiply((new module$src$externals$three.default.Matrix4).getInverse(c));
n.transformationMatrix=a});else n.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4;a.multiply((new module$src$externals$three.default.Matrix4).makeRotationAxis(e,l.degree));n.transformationMatrix=a})}else if("translation"===b.type){var f={x:0,y:0,z:0};n=(new module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween(f,a)).to({x:b.translationVector.x,y:b.translationVector.y,z:b.translationVector.z},b.duration);if(b.parent)n.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4,
l=new module$src$externals$three.default.Matrix4,e=c.getPathObject(d,b.parent);e&&(e.updateMatrix(!0),e.updateMatrixWorld(!0),l=e.matrixWorld);a.makeTranslation(f.x,f.y,f.z);n.transformationMatrix=l.multiply(a)});else n.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4;a.makeTranslation(f.x,f.y,f.z);n.transformationMatrix=a})}else if("scaling"===b.type){var h={x:1,y:1,z:1};n=(new module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween(h,a)).to({x:b.scalingVector.x,y:b.scalingVector.y,
z:b.scalingVector.z},b.duration);if(b.parent&&b.pivot)n.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4,l=new module$src$externals$three.default.Matrix4,e=new module$src$externals$three.default.Matrix4,f=c.getPathObject(d,b.parent);f&&(f.updateMatrix(!0),f.updateMatrixWorld(!0),l=f.matrixWorld);e.makeTranslation(b.pivot.x,b.pivot.y,b.pivot.z);a.multiply(e);a.multiply((new module$src$externals$three.default.Matrix4).makeScale(h.x,h.y,h.z));a.multiply((new module$src$externals$three.default.Matrix4).getInverse(e));
n.transformationMatrix=l.multiply(a)});else if(b.parent)n.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4,l=new module$src$externals$three.default.Matrix4,e=c.getPathObject(d,b.parent);e&&(e.updateMatrix(!0),e.updateMatrixWorld(!0),l=e.matrixWorld);a.multiply((new module$src$externals$three.default.Matrix4).makeScale(h.x,h.y,h.z));n.transformationMatrix=l.multiply(a)});else if(b.pivot)n.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4,c=new module$src$externals$three.default.Matrix4;
c.makeTranslation(b.pivot.x,b.pivot.y,b.pivot.z);a.multiply(c);a.multiply((new module$src$externals$three.default.Matrix4).makeScale(h.x,h.y,h.z));a.multiply((new module$src$externals$three.default.Matrix4).getInverse(c));n.transformationMatrix=a});else n.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4;a.multiply((new module$src$externals$three.default.Matrix4).makeScale(h.x,h.y,h.z));n.transformationMatrix=a})}n.transformationMatrix=new module$src$externals$three.default.Matrix4;
n.hasParent=!1;b.parent&&(n.hasParent=!0);n.gloablDuration=b.delay+b.duration;b.repeat&&(n.gloablDuration+=n.gloablDuration*b.repeat);b.repeat&&n.repeat(b.repeat);b.repeat&&b.yoyo&&n.yoyo(!0);n.onComplete(function(){n.stop()});n.delay(b.delay);n.easing(b.easing);return n};a.prototype.dispatchEvent=function(a){for(var c=new CustomEvent(a.type),d=$jscomp.makeIterator(a),l=d.next();!l.done;l=d.next())l=l.value,c[l]=a[l];b.renderingHandler.getDomElement().dispatchEvent(c);return c};a.prototype.initialize=
function(){t=!0};a.prototype.isInitialized=function(){return t};a.prototype.addMesh=function(a,b,c){h.push(a);r.push(b);m.push({mesh:a,material:b,properties:c})};a.prototype.removeMesh=function(a){for(var b={},c=0,d=m.length;c<d;b={mat:b.mat},c++)if(a===m[c].mesh){b.mat=r[c];h.splice(c,1);r.splice(c,1);m.splice(c,1);b.mat&&("alphaMap aoMap bumpMap displacementMap emissiveMap lightMap map metalnessMap normalMap roughnessMap rgbMap additionalMaps0 additionalMaps1 additionalMaps2 additionalMaps3 additionalMaps4 reflectionNormalMap dispersionMap reflectionMap".split(" ").forEach(function(a){return function(b){a.mat[b]&&
a.mat[b].dispose&&a.mat[b].dispose()}}(b)),b.mat.dispose());break}};a.prototype.addAnchor=function(a,c){var d={object:a,properties:Object.assign({lastPos:new module$src$externals$three.default.Vector2,runtimeId:module$src$shared$util$GlobalUtils.default.createRandomId()},c)};q.push(d);var l={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_ANCHOR_ADD,anchors:[]},e=b.renderingHandler.getSize().width,n=b.renderingHandler.getSize().height,h=b.cameraHandler.getCamera(),
m=b.renderingHandler.getCanvas().getBoundingClientRect(),r=!1,v=new module$src$externals$three.default.Vector3,p=new module$src$externals$three.default.Vector3,t=new module$src$externals$three.default.Raycaster;a.updateMatrixWorld(!0);v.setFromMatrixPosition(a.matrixWorld);p.set(v.x,v.y,v.z);p.project(h);p.x=e/2*p.x+e/2;p.y=-(n/2*p.y)+n/2;p.x=0>p.x?Math.ceil(p.x):Math.floor(p.x);p.y=0>p.y?Math.ceil(p.y):Math.floor(p.y);if(1>=p.x||p.x>=e-1||1>=p.y||p.y>=n-1)r=!0;p.xPixel=p.x/devicePixelRatio;p.yPixel=
p.y/devicePixelRatio;t.ray.direction.copy(v);t.ray.origin.set(0,0,0);h.localToWorld(t.ray.origin);t.ray.direction.sub(t.ray.origin);var u=t.ray.direction.length();t.ray.direction.normalize();var x=Number.MAX_VALUE;g.traverseVisible(function(a){a instanceof module$src$externals$three.default.Mesh&&(a=t.intersectObject(a),a.length&&a[0].distance<x&&(x=a[0].distance))});h.getWorldDirection(v);h=t.ray.direction.dot(v);l.anchors.push(Object.assign({location:{x:a.position.x,y:a.position.y,z:a.position.z},
containerX:p.xPixel,containerY:p.yPixel,containerWidth:e/devicePixelRatio,containerHeight:n/devicePixelRatio,clientX:p.xPixel+m.left,clientY:p.yPixel+m.top,pageX:p.xPixel+m.left+window.pageXOffset,pageY:p.yPixel+m.top+window.pageYOffset,viewport:b.threeDManager.runtimeId,hidden:x<u,overflow:r,distance:u,viewingAngle:h,scenePath:c.path,format:c.format,data:c.data,runtimeId:d.properties.runtimeId},{updateFunction:function(a){return d.properties.update=a}}));a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_ANCHORDATA,
l);b.threeDManager.message(l.type,a);f.dispatchEvent(l)};a.prototype.removeAnchor=function(a){var c,d={},l=0;for(c=q.length;l<c;d={raycaster:d.raycaster,closestIntersectionDistance:d.closestIntersectionDistance},l++)if(a===q[l].object){c=q[l];var e=c.properties;c={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_ANCHOR_REMOVE,anchors:[]};var n=b.renderingHandler.getSize().width,h=b.renderingHandler.getSize().height,m=b.cameraHandler.getCamera(),r=b.renderingHandler.getCanvas().getBoundingClientRect(),
v=!1,p=new module$src$externals$three.default.Vector3,t=new module$src$externals$three.default.Vector3;d.raycaster=new module$src$externals$three.default.Raycaster;a.updateMatrixWorld(!0);p.setFromMatrixPosition(a.matrixWorld);t.set(p.x,p.y,p.z);t.project(m);t.x=n/2*t.x+n/2;t.y=-(h/2*t.y)+h/2;t.x=0>t.x?Math.ceil(t.x):Math.floor(t.x);t.y=0>t.y?Math.ceil(t.y):Math.floor(t.y);if(1>=t.x||t.x>=n-1||1>=t.y||t.y>=h-1)v=!0;t.xPixel=t.x/devicePixelRatio;t.yPixel=t.y/devicePixelRatio;d.raycaster.ray.direction.copy(p);
d.raycaster.ray.origin.set(0,0,0);m.localToWorld(d.raycaster.ray.origin);d.raycaster.ray.direction.sub(d.raycaster.ray.origin);var u=d.raycaster.ray.direction.length();d.raycaster.ray.direction.normalize();d.closestIntersectionDistance=Number.MAX_VALUE;g.traverseVisible(function(a){return function(b){b instanceof module$src$externals$three.default.Mesh&&(b=a.raycaster.intersectObject(b),b.length&&b[0].distance<a.closestIntersectionDistance&&(a.closestIntersectionDistance=b[0].distance))}}(d));m.getWorldDirection(p);
m=d.raycaster.ray.direction.dot(p);c.anchors.push({location:{x:a.position.x,y:a.position.y,z:a.position.z},containerX:t.xPixel,containerY:t.yPixel,containerWidth:n/devicePixelRatio,containerHeight:h/devicePixelRatio,clientX:t.xPixel+r.left,clientY:t.yPixel+r.top,pageX:t.xPixel+r.left+window.pageXOffset,pageY:t.yPixel+r.top+window.pageYOffset,viewport:b.threeDManager.runtimeId,hidden:d.closestIntersectionDistance<u,overflow:v,distance:u,viewingAngle:m,scenePath:e.path,format:e.format,data:e.data,runtimeId:e.runtimeId});
a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_ANCHORDATA,c);b.threeDManager.message(c.type,a);f.dispatchEvent(c);q.splice(l,1);break}};a.prototype.getMeshes=function(){return h};a.prototype.getMaterials=function(){return r};a.prototype.getMeshMaterialObjects=function(){return m};a.prototype.getAnchors=function(){return q};a.prototype.toggleMeshes=function(a){for(var b=0,c=m.length;b<c;b++)a&&(m[b].mesh.material=
m[b].material)};a.prototype.toggleGeometry=function(a){l=a};a.prototype.addSceneObject=function(a){p.add(a)};a.prototype.removeSceneObject=function(a){p.remove(a)};a.prototype.setLiveTransformation=function(a,l,e,n,h){var g={};g.reset=n;g.duration=h;n=[];h=0;for(var m=l.length;h<m;h++){var r=c.getPathObject(d,l[h]);n.push(r)}g.sceneObjects=n;g.sceneObjectPaths=l;var q=[];g.maxDuration=0;g.hasParent=!1;l=0;for(n=e.length;l<n;l++)h=f._createTransformationObject(a,e[l]),g.maxDuration=Math.max(g.maxDuration,
h.gloablDuration),g.hasParent=g.hasParent||h.hasParent,q.push(h);g.maxDuration===g.duration&&(g.duration=Infinity);g.tweens=q;g.start=function(){for(var a=0,b=q.length;a<b;a++)q[a].start()};g.prev=new module$src$externals$three.default.Matrix4;g.promise=new Promise(function(a,c){g.stopTransformation=function(){b.renderingHandler.unregisterForContinuousRendering("liveTransformationEvent");for(var c=b.renderingHandler.containsContinuousRendering("liveTransformationEvent"),d=!1,l=0,e=c.length;l<e;l++)!0===
c[l]&&(d=!0);!1===d&&(b.renderingHandler.stopUpdatingShadowMap(),b.renderingHandler.updateShadowMap());g.stopped=!0;a(!0)}});g.stopCalled=!1;g.stopAndReset=!1;g.stop=function(a){g.stopCalled=!0;g.stopAndReset=a};b.renderingHandler.keepUpdatingShadowMap();b.renderingHandler.registerForContinuousRendering("liveTransformationEvent");b.threeDManager.transformationGroups.push(g);return g};a.prototype.toggleSceneObjects=function(a){u=a;a||(p.visible=a)};a.prototype.addViewportObject=function(a){e.add(a)};
a.prototype.removeViewportObject=function(a){e.remove(a)};a.prototype.toggleViewportObjects=function(a){n=a;a||(e.visible=a)};a.prototype.toggleSceneBackground=function(a){b.materialHandler.getSceneBackground&&(g.background=a?b.materialHandler.getSceneBackground():null)};a.prototype.toggleViewportMatrix=function(a){d.applyMatrix(a?b.threeDManager.transformationMatrix:(new module$src$externals$three.default.Matrix4).getInverse(b.threeDManager.transformationMatrix,!0));e.applyMatrix(a?b.threeDManager.transformationMatrix:
(new module$src$externals$three.default.Matrix4).getInverse(b.threeDManager.transformationMatrix,!0))};a.prototype.toggleLiveTransformations=function(a,l){var e=[];if(a)for(var n=0;n<b.threeDManager.transformationGroups.length;n++){var f=b.threeDManager.transformationGroups[n];if(!f.stopped){f.initTime||(f.initTime=l);var h=f.tweens,g=f.sceneObjects,m=new module$src$externals$three.default.Matrix4,r=!1,q=0;for(a=h.length;q<a;q++){var p=h[q];p.update(l);m.multiply(p.transformationMatrix);p.isPlaying()&&
(r=!0)}f.active=!f.stopCalled&&r&&!(l>f.duration+f.initTime);h=0;for(a=g.length;h<a;h++)g[h]&&(g[h].parent||(r=c.getPathObject(d,f.sceneObjectPaths[h]),g[h]=r),g[h].applyMatrix(m),e.includes(g[h])||e.push(g[h]));f.prev.getInverse(m)}}else for(n=0;n<b.threeDManager.transformationGroups.length;n++)if(f=b.threeDManager.transformationGroups[n],!f.stopped){g=f.sceneObjects;a=!1;if(!1===f.active)for(m=0;m<b.threeDManager.transformationGroups.length;m++)b.threeDManager.transformationGroups[m].maxDuration===
f.maxDuration&&b.threeDManager.transformationGroups[m].initTime===f.initTime&&m<n&&!0!==b.threeDManager.transformationGroups[m].stopped&&(a=!0);if(!1===f.active&&!1===a){if(l>f.duration+f.initTime||f.stopCalled)for(m=f.tweens,h=0,a=m.length;h<a;h++)m[h].stop();m=0;for(a=g.length;m<a;m++)if(g[m]){h=new module$src$externals$three.default.Matrix4;if(!0===f.reset&&!0!==f.stopCalled||!0===f.stopAndReset)g[m].applyMatrix(f.prev);else{g[m].updateMatrix(!0);g[m].updateMatrixWorld(!0);r=!0;for(q=0;16>q;q++)h.elements[q]-
.001<g[m].matrix.elements[q]&&g[m].matrix.elements[q]<h.elements[q]+.001||(r=!1);r&&(g[m].matrix.identity(),g[m].matrixWorld.identity(),g[m].updateMatrix(!0),g[m].updateMatrixWorld(!0))}e.includes(g[m])||e.push(g[m])}f.stopTransformation()}else for(m=0,a=g.length;m<a;m++)g[m]&&(g[m].applyMatrix(f.prev),e.includes(g[m])||e.push(g[m]))}return e};a.prototype.toggleViewport=function(a,b){l||(d.visible=!a);n&&(e.visible=a);u&&(p.visible=a);this.toggleMeshes(a);this.toggleSceneBackground(a);this.toggleViewportMatrix(a);
var c=[];b&&(c=this.toggleLiveTransformations(a,b));0<c.length&&this.updateLights(c)};a.prototype.updateLights=function(a){if(b.lightHandler&&b.lightHandler.adjustToBoundingSphere){for(var c=new module$src$externals$three.default.Box3,l=new module$src$externals$three.default.Sphere,e=new module$src$externals$three.default.Sphere,n=0,f=a.length;n<f;n++)c.union((new module$src$externals$three.default.Box3).setFromObject(a[n]));a=d.computeSceneBoundingBox();c.union(a);c.getBoundingSphere(l);a.getBoundingSphere(e);
c=l.center-e.center;c=new module$src$externals$three.default.Vector3(Math.abs(c.x),Math.abs(c.y),Math.abs(c.z));c=Math.max(c.x,Math.max(c.y,c.z));l.center=e.center;l.radius+=c;b.lightHandler.adjustShadowRadius(l)}};a.prototype.destroyViewport=function(){h.length=0;r.length=0;m.length=0;q.length=0;g.remove(p);g.remove(e)};return new a}};var module$src$3d$interfaces$handlers$RenderingHandlerInterface={default:function(){}};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.render=function(a){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.renderHidden=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.onResize=function(a,b){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.getSize=function(){};
module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.pause=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.resume=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.destroy=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.getScreenshot=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.getDomElement=function(){};
module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.getCanvas=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.getRendererInfo=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.setBlur=function(a,b){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.registerForNoRendering=function(a,b){};
module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.unregisterForNoRendering=function(a){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.registerForRestrictedRendering=function(a,b){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.unregisterForRestrictedRendering=function(a){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.registerForContinuousRendering=function(a,b){};
module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.unregisterForContinuousRendering=function(a){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.containsContinuousRendering=function(a){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.updateShadowMap=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.keepUpdatingShadowMap=function(){};
module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.stopUpdatingShadowMap=function(){};var module$src$3d$helpers$handlers$RenderingHandlerHelpers={default:function(a){var b,c,g,d,f,p,e,m,h=function(){b=this;p=new module$src$externals$three.default.Vector3;e=new module$src$externals$three.default.Vector3;m=new module$src$externals$three.default.Raycaster};h.prototype.createWebGLRenderer=function(a,e){var h={success:!0,message:"",messageLevel:module$src$shared$constants$LoggingConstants.default.loggingLevels.INFO};f=Object.assign({},e);g=a;try{var m=f.canvas;m||(m=document.createElementNS("http://www.w3.org/1999/xhtml",
"canvas"),m.id=("string"===typeof g.id&&0<g.id.length?g.id:"sdv-container-viewport")+"-canvas",g.appendChild(m),f.canvas=m);h.containerId=g.id;m.addEventListener("webglcontextlost",b.onContextLost,!1);m.addEventListener("webglcontextrestored",b.onContextRestore,!1);var n={alpha:f.alpha,depth:f.depth,stencil:f.stencil,antialias:f.antialias,premultipliedAlpha:f.premultipliedAlpha,preserveDrawingBuffer:f.preserveDrawingBuffer,powerPreference:f.powerPreference};c=m.getContext("webgl",n)||m.getContext("experimental-webgl",
n);if(null===c)if(c=m.getContext("webgl")||m.getContext("experimental-webgl"),null!==c)h.message="We were unable to get a WebGL context using the requested attributes, falling back to default attributes.",h.messageLevel=module$src$shared$constants$LoggingConstants.default.loggingLevels.WARN;else throw Error("We were unable to get a WebGL context.");void 0===c.getShaderPrecisionFormat&&(c.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}});f.context=c;d=new module$src$externals$three.default.WebGLRenderer(f);
h.renderer=d}catch(l){f.canvas&&((a=f.canvas.parentNode)&&a.removeChild(f.canvas),delete f.canvas),h.success=!1,h.message=l.message,h.messageLevel=module$src$shared$constants$LoggingConstants.default.loggingLevels.ERROR}return h};h.prototype.getWebGLContext=function(){return c};h.prototype.handleCreateWebGLRendererResponse=function(b,c,d,e){if(d=!0===c.success?d:e)c.messageScope=d;!1===c.success&&(e=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE,
c),a.threeDManager.message(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_FAILED,e));a.threeDManager.log(c.messageLevel,b,d,c.message);a.threeDManager.log(c.messageLevel|module$src$shared$constants$LoggingConstants.default.loggingLevels.LOG_TO_SERVER,b,{success:c.success,message:c.message,messageLevel:c.messageLevel,messageScope:c.messageScope,webglreport:c.webglreport});return!0===c.success};h.prototype.onContextLost=function(c){c.preventDefault();c.stopImmediatePropagation();
a.threeDManager&&(f.canvas&&(f.canvas.removeEventListener("webglcontextlost",b.onContextLost,!1),f.canvas.removeEventListener("webglcontextrestored",b.onContextRestore,!1),(c=f.canvas.parentNode)&&c.removeChild(f.canvas),delete f.canvas),c=b.createWebGLRenderer(g,f),b.handleCreateWebGLRendererResponse("onContextLost",c,"WebGL context was lost and could be restored","WebGL context was lost and could not be restored"),!1!==c.success&&a.threeDManager.api.reload())};h.prototype.onContextRestore=function(a){a.preventDefault();
a.stopImmediatePropagation()};h.prototype.processAnchors=function(b,c,d,f){var n,l=window.devicePixelRatio;if(0<f.length){var h=b.context.canvas;var g=h.width;var r=h.height}var q={};b=0;for(n=f.length;b<n;q={closestIntersectionDistance:q.closestIntersectionDistance},b++){var t=f[b];var u=t.object;t=t.properties;if(t.update){u.updateMatrixWorld(!0);p.setFromMatrixPosition(u.matrixWorld);e.set(p.x,p.y,p.z);e.project(d);e.x=g/2*e.x+g/2;e.y=-(r/2*e.y)+r/2;e.x=0>e.x?Math.ceil(e.x):Math.floor(e.x);e.y=
0>e.y?Math.ceil(e.y):Math.floor(e.y);var A=h.getBoundingClientRect(),D=!1;if(1>=e.x||e.x>=g-1||1>=e.y||e.y>=r-1)D=!0;e.xPixel=e.x/l;e.yPixel=e.y/l;m.ray.direction.copy(p);m.ray.origin.set(0,0,0);d.localToWorld(m.ray.origin);m.ray.direction.sub(m.ray.origin);var H=m.ray.direction.length();m.ray.direction.normalize();q.closestIntersectionDistance=Number.MAX_VALUE;c.traverseVisible(function(a){return function(b){b instanceof module$src$externals$three.default.Mesh&&(b=m.intersectObject(b),b.length&&
b[0].distance<a.closestIntersectionDistance&&(a.closestIntersectionDistance=b[0].distance))}}(q));d.getWorldDirection(p);var G=m.ray.direction.dot(p);u={location:{x:u.position.x,y:u.position.y,z:u.position.z},containerX:e.xPixel,containerY:e.yPixel,containerWidth:g/l,containerHeight:r/l,clientX:e.xPixel+A.left,clientY:e.yPixel+A.top,pageX:e.xPixel+A.left+window.pageXOffset,pageY:e.yPixel+A.top+window.pageYOffset,viewport:a.threeDManager.runtimeId,hidden:q.closestIntersectionDistance<H,overflow:D,
distance:H,viewingAngle:G,scenePath:t.path,format:t.format,data:t.data,runtimeId:t.runtimeId};t.lastPos.x=e.x;t.lastPos.y=e.y;t.update(u)}}};return new h}};var module$src$3d$viewports$simple$handlers$RenderingHandler={default:function(a,b){var c=a.settings,g=a.scene,d=a.container,f,p=d.offsetWidth,e=d.offsetHeight,m,h,r,q=!0,t=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"color",b.threeDManager.warn,"RenderingHandler.Hook->clearColor"))return!1;h.setClearColor((0,module$src$shared$util$toTinyColor.default)(a).toThreeColor());f.render();return!0};a=function(){module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.call(this);
f=this;m=new module$src$3d$helpers$handlers$RenderingHandlerHelpers.default(b);var a=m.createWebGLRenderer(d,{antialias:!0,alpha:!0,preserveDrawingBuffer:!0});b.threeDManager.success=a.success;if(!1===a.success)return b.threeDManager.warn(a.message),b.threeDManager.errorResponse=a,null;""!==a.message&&b.threeDManager.warn(a.message);h=a.renderer;h.setPixelRatio(window.devicePixelRatio);h.setSize(p,e,!1);h.setClearColor((0,module$src$shared$util$toTinyColor.default)(c.getSetting("clearColor"),"white").toThreeColor(),
1);r=new module$src$externals$three.default.WebGLRenderTarget(p,e,{minFilter:module$src$externals$three.default.LinearFilter,magFilter:module$src$externals$three.default.LinearFilter,format:module$src$externals$three.default.RGBAFormat,stencilBuffer:!1});r.texture.name="hidden.rt";c.registerHook("clearColor",t)};$jscomp.inherits(a,module$src$3d$interfaces$handlers$RenderingHandlerInterface.default);a.prototype._beforeRender=function(){if(document.fullscreenElement||document.webkitFullscreenElement||
document.msFullscreenElement||document.mozFullScreenElement){var a=screen.width;var c=screen.height}else a=d.offsetWidth,c=d.offsetHeight;if(a!==p||c!==e)p=a,e=c,h.setSize(p,e,!1),b.cameraHandler.onResize(p,e)};a.prototype.render=function(){h&&b.threeDManager&&requestAnimationFrame(f.render);b.threeDManager&&q&&!1!==b.threeDManager.getSetting("show")&&b.cameraHandler&&b.cameraHandler.getCamera()&&(f._beforeRender(),b.threeDManager.helpers.toggleViewport(!0),h.render(g,b.cameraHandler.getCamera()),
m.processAnchors(h,g,b.cameraHandler.getCamera(),b.threeDManager.helpers.getAnchors()),b.threeDManager.helpers.toggleViewport(!1))};a.prototype.renderHidden=function(){b.threeDManager&&b.cameraHandler&&b.cameraHandler.getCamera()&&(b.threeDManager.helpers.toggleViewport(!0),h.render(g,b.cameraHandler.getCamera(),r),b.threeDManager.helpers.toggleViewport(!1))};a.prototype.onResize=function(a,b){h.setSize(a,b)};a.prototype.getSize=function(){return h.getSize()};a.prototype.pause=function(){q=!1};a.prototype.resume=
function(){q=!0};a.prototype.destroy=function(){h.dispose();try{h.forceContextLoss()}catch(u){}};a.prototype.getScreenshot=function(){return h.domElement.toDataURL("image/png")};a.prototype.getDomElement=function(){return h.domElement};a.prototype.getCanvas=function(){return h.context.canvas};a.prototype.getRendererInfo=function(){return h.info};a.prototype.setBlur=function(a,c){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.registerForNoRendering=function(a,
c){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.unregisterForNoRendering=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.registerForRestrictedRendering=function(a,c){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.unregisterForRestrictedRendering=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.registerForContinuousRendering=
function(a,c){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.unregisterForContinuousRendering=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.containsContinuousRendering=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.updateShadowMap=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.keepUpdatingShadowMap=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};
a.prototype.stopUpdatingShadowMap=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};return new a}};var module$src$3d$interfaces$handlers$MaterialHandlerInterface={default:function(){}};module$src$3d$interfaces$handlers$MaterialHandlerInterface.default.prototype.pause=function(){};module$src$3d$interfaces$handlers$MaterialHandlerInterface.default.prototype.resume=function(){};module$src$3d$interfaces$handlers$MaterialHandlerInterface.default.prototype.destroy=function(){};module$src$3d$interfaces$handlers$MaterialHandlerInterface.default.prototype.getMaterial=function(a){};
module$src$3d$interfaces$handlers$MaterialHandlerInterface.default.prototype.getSimpleMaterial=function(a){};module$src$3d$interfaces$handlers$MaterialHandlerInterface.default.prototype.compile=function(){};module$src$3d$interfaces$handlers$MaterialHandlerInterface.default.prototype.adjustToBoundingSphere=function(a){};module$src$3d$interfaces$handlers$MaterialHandlerInterface.default.prototype.getEnvironmentMap=function(){};
module$src$3d$interfaces$handlers$MaterialHandlerInterface.default.prototype.setSceneBackground=function(a){};module$src$3d$interfaces$handlers$MaterialHandlerInterface.default.prototype.getSceneBackground=function(){};var module$src$3d$helpers$handlers$MaterialHandlerHelpers={default:function(a,b){var c=b.nameSimple;b=function(){};b.prototype.checkMaterials=function(){var b=a.renderingHandler.getRendererInfo();if(b&&b.programs){b=b.programs;for(var d=0,f=b.length;d<f;d++){var p=b[d];if(p.diagnostics&&!1===p.diagnostics.runnable){if(p.name===c){var e={message:p,messageLevel:module$src$shared$constants$LoggingConstants.default.loggingLevels.ERROR,messageScope:"Shader program could not be created"},m=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE,
e);a.threeDManager.message(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_FAILED,m);a.threeDManager.log(e.messageLevel,e.messageScope,e);a.threeDManager.log(e.messageLevel|module$src$shared$constants$LoggingConstants.default.loggingLevels.LOG_TO_SERVER,e.messageScope,e);a.renderingHandler.api.destroy()}else{e=a.threeDManager.helpers.getMeshMaterialObjects();for(var h=0,r=e.length;h<r;h++)if(m=e[h],m.material.program&&m.material.program.id===p.id){m.material=a.materialHandler.getSimpleMaterial(m.properties);
break}}delete p.diagnostics}}}};return new b}};var module$src$3d$viewports$simple$handlers$MaterialHandler={default:function(a,b){var c;a=function(){module$src$3d$interfaces$handlers$MaterialHandlerInterface.default.call(this);c=new module$src$3d$helpers$handlers$MaterialHandlerHelpers.default(b,{nameStandard:"MeshPhongMaterial",nameSimple:"MeshBasicMaterial"})};$jscomp.inherits(a,module$src$3d$interfaces$handlers$MaterialHandlerInterface.default);a.prototype.pause=function(){};a.prototype.resume=function(){};a.prototype.destroy=function(){};
a.prototype.getMaterial=function(a){return new module$src$externals$three.default.MeshPhongMaterial(Object.assign({shininess:a.metalness?128*a.metalness:0},a))};a.prototype.getSimpleMaterial=function(a){return new module$src$externals$three.default.MeshBasicMaterial(a)};a.prototype.compile=function(){b.renderingHandler.renderHidden();c.checkMaterials()};a.prototype.adjustToBoundingSphere=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.getEnvironmentMap=
function(){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.setSceneBackground=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.getSceneBackground=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};return new a}};var module$src$3d$interfaces$handlers$CameraHandlerInterface={default:function(){}};module$src$3d$interfaces$handlers$CameraHandlerInterface.default.prototype.pause=function(){};module$src$3d$interfaces$handlers$CameraHandlerInterface.default.prototype.resume=function(){};module$src$3d$interfaces$handlers$CameraHandlerInterface.default.prototype.destroy=function(){};module$src$3d$interfaces$handlers$CameraHandlerInterface.default.prototype.setPosition=function(a){};
module$src$3d$interfaces$handlers$CameraHandlerInterface.default.prototype.resetPosition=function(){};module$src$3d$interfaces$handlers$CameraHandlerInterface.default.prototype.getPosition=function(){};module$src$3d$interfaces$handlers$CameraHandlerInterface.default.prototype.setTarget=function(a){};module$src$3d$interfaces$handlers$CameraHandlerInterface.default.prototype.resetTarget=function(){};module$src$3d$interfaces$handlers$CameraHandlerInterface.default.prototype.getTarget=function(){};
module$src$3d$interfaces$handlers$CameraHandlerInterface.default.prototype.setPositionAndTarget=function(a,b,c){};module$src$3d$interfaces$handlers$CameraHandlerInterface.default.prototype.resetPositionAndTarget=function(a){};module$src$3d$interfaces$handlers$CameraHandlerInterface.default.prototype.getPositionAndTarget=function(){};module$src$3d$interfaces$handlers$CameraHandlerInterface.default.prototype.setViewAndProjectionMatrix=function(){};
module$src$3d$interfaces$handlers$CameraHandlerInterface.default.prototype.zoomExtents=function(a,b){};module$src$3d$interfaces$handlers$CameraHandlerInterface.default.prototype.setCameraPath=function(a,b,c){};module$src$3d$interfaces$handlers$CameraHandlerInterface.default.prototype.getCamera=function(){};module$src$3d$interfaces$handlers$CameraHandlerInterface.default.prototype.isCameraMoving=function(){};
module$src$3d$interfaces$handlers$CameraHandlerInterface.default.prototype.updateOrbitControls=function(){};module$src$3d$interfaces$handlers$CameraHandlerInterface.default.prototype.adjustToBoundingSphere=function(a){};module$src$3d$interfaces$handlers$CameraHandlerInterface.default.prototype.onResize=function(a,b){};var module$src$3d$interfaces$OrbitControlsProxyInterface={default:function(){}};module$src$3d$interfaces$OrbitControlsProxyInterface.default.prototype.getClientSize=function(){};module$src$3d$interfaces$OrbitControlsProxyInterface.default.prototype.onStateChange=function(){};module$src$3d$interfaces$OrbitControlsProxyInterface.default.prototype.onStateChangeNone=function(){};module$src$3d$interfaces$OrbitControlsProxyInterface.default.prototype.dispose=function(){};
module$src$3d$interfaces$OrbitControlsProxyInterface.default.prototype.initialize=function(){};module$src$3d$interfaces$OrbitControlsProxyInterface.default.prototype.onContextMenu=function(){};module$src$3d$interfaces$OrbitControlsProxyInterface.default.prototype.onMouseDown=function(){};module$src$3d$interfaces$OrbitControlsProxyInterface.default.prototype.onMouseWheel=function(){};module$src$3d$interfaces$OrbitControlsProxyInterface.default.prototype.onTouchStart=function(){};
module$src$3d$interfaces$OrbitControlsProxyInterface.default.prototype.onTouchEnd=function(){};module$src$3d$interfaces$OrbitControlsProxyInterface.default.prototype.onTouchMove=function(){};module$src$3d$interfaces$OrbitControlsProxyInterface.default.prototype.onMouseMove=function(){};module$src$3d$interfaces$OrbitControlsProxyInterface.default.prototype.onMouseUp=function(){};module$src$3d$interfaces$OrbitControlsProxyInterface.default.prototype.onKeyDown=function(){};var module$src$3d$helpers$OrbitControlsProxyStandardImplementation={default:function(a){var b,c=function(){module$src$3d$interfaces$OrbitControlsProxyInterface.default.call(this);b=this};$jscomp.inherits(c,module$src$3d$interfaces$OrbitControlsProxyInterface.default);c.prototype.getClientSize=function(){return{width:a.renderingHandler.getDomElement().clientWidth,height:a.renderingHandler.getDomElement().clientHeight}};c.prototype.onStateChange=function(){document.addEventListener("mousemove",b.onMouseMove,
{passive:!1},!1);document.addEventListener("mouseup",b.onMouseUp,{passive:!1},!1);document.addEventListener("mouseout",b.onMouseUp,{passive:!1},!1)};c.prototype.onStateChangeNone=function(){document.removeEventListener("mousemove",b.onMouseMove,!1);document.removeEventListener("mouseup",b.onMouseUp,!1);document.removeEventListener("mouseout",b.onMouseUp,!1)};c.prototype.dispose=function(){a.renderingHandler.getDomElement().removeEventListener("contextmenu",b.onContextMenu,!1);a.renderingHandler.getDomElement().removeEventListener("mousedown",
b.onMouseDown,!1);a.renderingHandler.getDomElement().removeEventListener("mousewheel",b.onMouseWheel,!1);a.renderingHandler.getDomElement().removeEventListener("MozMousePixelScroll",b.onMouseWheel,!1);a.renderingHandler.getDomElement().removeEventListener("touchstart",b.onTouchStart,!1);a.renderingHandler.getDomElement().removeEventListener("touchend",b.onTouchEnd,!1);a.renderingHandler.getDomElement().removeEventListener("touchmove",b.onTouchMove,!1);document.removeEventListener("mousemove",b.onMouseMove,
!1);document.removeEventListener("mouseup",b.onMouseUp,!1);document.removeEventListener("mouseout",b.onMouseUp,!1);window.removeEventListener("keydown",b.onKeyDown,!1)};c.prototype.initialize=function(){a.renderingHandler.getDomElement().addEventListener("contextmenu",b.onContextMenu,{passive:!1},!1);a.renderingHandler.getDomElement().addEventListener("mousedown",b.onMouseDown,{passive:!1},!1);a.renderingHandler.getDomElement().addEventListener("mousewheel",b.onMouseWheel,{passive:!1},!1);a.renderingHandler.getDomElement().addEventListener("MozMousePixelScroll",
b.onMouseWheel,{passive:!1},!1);a.renderingHandler.getDomElement().addEventListener("touchstart",b.onTouchStart,{passive:!1},!1);a.renderingHandler.getDomElement().addEventListener("touchend",b.onTouchEnd,{passive:!1},!1);a.renderingHandler.getDomElement().addEventListener("touchmove",b.onTouchMove,{passive:!1},!1);window.addEventListener("keydown",b.onKeyDown,{passive:!1},!1)};return new c}};var module$src$3d$viewports$simple$handlers$CameraHandler={default:function(a,b){var c=a.settings,g=a.container,d,f,p;a=function(){module$src$3d$interfaces$handlers$CameraHandlerInterface.default.call(this);d=this;f=new module$src$externals$three.default.PerspectiveCamera(c.getSetting("fov"),g.offsetWidth/g.offsetHeight,c.getSetting("near"),c.getSetting("far"));f.position.set(5,5,5);f.up.set(0,0,1);b.threeDManager.helpers.addSceneObject(f);var a=new module$src$3d$helpers$OrbitControlsProxyStandardImplementation.default(b);
p=new module$src$externals$three.default.OrbitControls(f,a);a.initialize();p.target.set(0,0,0)};$jscomp.inherits(a,module$src$3d$interfaces$handlers$CameraHandlerInterface.default);a.prototype.pause=function(){p.enabled=!1;p.resetState()};a.prototype.resume=function(){p.enabled=!0};a.prototype.destroy=function(){};a.prototype.setPosition=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.resetPosition=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};
a.prototype.getPosition=function(){return module$src$shared$util$GlobalUtils.default.deepCopy(p.object.position)};a.prototype.setTarget=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.resetTarget=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.getTarget=function(){return module$src$shared$util$GlobalUtils.default.deepCopy(p.target)};a.prototype.setPositionAndTarget=function(a,c,d){b.threeDManager.debug("This method is not implemented in this viewport.")};
a.prototype.resetPositionAndTarget=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.getPositionAndTarget=function(){return{position:d.getPosition(),target:d.getTarget()}};a.prototype.zoomExtents=function(a,c){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.setCameraPath=function(a,c,d){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.getCamera=function(){return f};a.prototype.isCameraMoving=
function(){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.updateOrbitControls=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.adjustToBoundingSphere=function(a){f.far=100*a.radius;f.near=.01*a.radius;f.updateProjectionMatrix()};a.prototype.onResize=function(a,b){f.aspect=a/b;f.setViewOffset(a,b,0,0,a,b);f.updateProjectionMatrix()};return new a}};var module$src$3d$interfaces$handlers$LightHandlerInterface={default:function(){}};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.pause=function(){};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.resume=function(){};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.destroy=function(){};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.adjustToBoundingSphere=function(a){};
module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.setToggleLightShadows=function(a){};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.toggleLights=function(a){};var module$src$3d$viewports$simple$handlers$LightHandler={default:function(a,b){var c;a=function(){module$src$3d$interfaces$handlers$LightHandlerInterface.default.call(this);c=new module$src$externals$three.default.Object3D;c.add(new module$src$externals$three.default.AmbientLight(16777215,1));b.threeDManager.helpers.addSceneObject(c)};$jscomp.inherits(a,module$src$3d$interfaces$handlers$LightHandlerInterface.default);a.prototype.pause=function(){};a.prototype.resume=function(){};a.prototype.destroy=
function(){};a.prototype.adjustToBoundingSphere=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.setToggleLightShadows=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.toggleLights=function(a){c.visible=a};return new a}};var module$src$3d$viewports$simple$ThreeDManager={default:function(a,b){var c=b.pathUtils,g=b.settings,d=b.scene,f=b.geometryNode,p=b.container,e={},m,h,r,q=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean"))return!1;p&&(p.style.opacity=a?1:0);return!0},t=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string"))return!1;p&&(p.style.transition=0<a.length?"opacity "+a:"none");return!0},u=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,
"boolean",m.warn,"ThreeDManager.Hook->groundPlaneVisibility"))return!1;r&&(r.visible=a);e.renderingHandler.render();return!0},n=function(a,b){module$src$3d$interfaces$ThreeDManagerInterface.default.call(this,b,module$src$shared$util$GlobalUtils.default);m=this;m.constants=module$src$3d$viewports$simple$ThreeDManagerConstants.default;e.threeDManager=m;m.viewerApi=a;h=new module$src$3d$helpers$ThreeDManagerHelpers.default({scene:d,geometryNode:f,pathUtils:c},e);e.threeDManager.helpers=h;module$src$shared$mixins$SettingsMixin.default.call(m,
g,module$src$3d$viewports$simple$ThreeDManagerConstants.default.defaultSettings,b.runtimeId);this.renderingHandler=new module$src$3d$viewports$simple$handlers$RenderingHandler.default({settings:m.getSection("render"),scene:d,container:p},e);e.renderingHandler=this.renderingHandler;!1!==m.success&&(this.materialHandler=new module$src$3d$viewports$simple$handlers$MaterialHandler.default({settings:m.getSection("material")},e),e.materialHandler=this.materialHandler,!1!==m.success&&(this.cameraHandler=
new module$src$3d$viewports$simple$handlers$CameraHandler.default({settings:m.getSection("camera"),container:p},e),e.cameraHandler=this.cameraHandler,!1!==m.success&&(this.lightHandler=new module$src$3d$viewports$simple$handlers$LightHandler.default({settings:m.getSection("lights"),container:p},e),e.lightHandler=this.lightHandler,!1!==m.success&&(this.registerHook("show",q),this.registerHook("showTransition",t),this.registerHook("groundPlaneVisibility",u)))))};$jscomp.inherits(n,module$src$3d$interfaces$ThreeDManagerInterface.default);
n.prototype.init=function(a){var b=a.min.distanceTo(a.max);if(1<b)a=parseInt(b),a=a.toString(),a=a.length,a=Math.pow(10,a-1),b=Math.max(Math.ceil(b/a)*a,1);else{a=1-Math.floor(Math.log(b)/Math.log(10))-2;b=b.toFixed(a+1);var c=parseInt(b.substr(b.length-1))+1;b="0.";for(var d=0;d<a;++d)b+="0";b=parseFloat(b+c)}a=new module$src$externals$three.default.PlaneGeometry(2*b,2*b,2,2);r=new module$src$externals$three.default.Mesh(a,e.materialHandler.getMaterial({color:13882323,side:module$src$externals$three.default.FrontSide,
roughness:1,metalness:0}));r.receiveShadow=!0;r.visible=m.getSetting("groundPlaneVisibility");a=new module$src$externals$three.default.Object3D;a.SDLocalPath="groundplane";a.add(r);h.addSceneObject(a);h.initialize();m.adjustScene()};n.prototype.adjustScene=function(){if(h.isInitialized()){var a=f.computeSceneBoundingBox(),b=new module$src$externals$three.default.Sphere;a.getBoundingSphere(b);r.position.set(0,0,a.min.z);e.cameraHandler.adjustToBoundingSphere(b);e.materialHandler.compile()}};n.prototype.computeBoundingBox=
function(a){return f.computeBoundingBox(a)};n.prototype.pause=function(){e.renderingHandler.pause();e.cameraHandler.pause();e.lightHandler.pause();e.materialHandler.pause()};n.prototype.resume=function(){e.renderingHandler.resume();e.cameraHandler.resume();e.lightHandler.resume();e.materialHandler.resume()};n.prototype.destroy=function(){delete e.threeDManager;h.destroyViewport();e.renderingHandler&&e.renderingHandler.destroy();e.cameraHandler&&e.cameraHandler.destroy();e.lightHandler&&e.lightHandler.destroy();
e.materialHandler&&e.materialHandler.destroy();m.deregisterAllHooks();for(m.deregisterAllNotifiers();p.firstChild;)p.removeChild(p.firstChild);for(var a in e)delete e[a]};n.prototype.addMesh=function(a,b,c){h.addMesh(a,b,c)};n.prototype.removeMesh=function(a){h.removeMesh(a)};n.prototype.addAnchor=function(a,b){h.addAnchor(a,b)};n.prototype.removeAnchor=function(a){h.removeAnchor(a)};n.prototype.fadeIn=function(a,b){m.debug("This method is not implemented in this viewport.")};n.prototype.fadeOut=
function(a,b){m.debug("This method is not implemented in this viewport.")};n.prototype.setLiveTransformation=function(a,b,c,d,e){m.debug("This method is not implemented in this viewport.")};n.prototype.updateInteractions=function(a,b){m.debug("This method is not implemented in this viewport.")};n.prototype.removeFromInteractions=function(a){m.debug("This method is not implemented in this viewport.")};return new n(a,b)}};var module$src$3d$interfaces$api$ViewportApiInterface={default:function(){this.lights=this.camera=null}};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getRuntimeId=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getContainer=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getScreenshot=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.render=function(){};
module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.convertTo2D=function(a){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.onResize=function(a,b){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getSize=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.pause=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.resume=function(){};
module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.reload=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.destroy=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.addEventListener=function(a,b){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.removeEventListener=function(a){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getSettingDefinitions=function(){};
module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getSettings=function(a){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getSetting=function(a){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.updateSettingAsync=function(a,b){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.updateSettingsAsync=function(a){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.setTransformation=function(a){};
module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getTransformation=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.applyTransformation=function(a){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.resetTransformation=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.setLiveTransformation=function(a,b){};
module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.updateSelected=function(a,b){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getSelected=function(){};var module$src$3d$interfaces$api$CameraApiInterface={default:function(){}};module$src$3d$interfaces$api$CameraApiInterface.default.prototype.get=function(){};module$src$3d$interfaces$api$CameraApiInterface.default.prototype.updateAsync=function(a,b){};module$src$3d$interfaces$api$CameraApiInterface.default.prototype.animateAsync=function(a,b){};module$src$3d$interfaces$api$CameraApiInterface.default.prototype.zoomAsync=function(a,b){};
module$src$3d$interfaces$api$CameraApiInterface.default.prototype.resetAsync=function(a){};module$src$3d$interfaces$api$CameraApiInterface.default.prototype.updateMatrices=function(){};var module$src$3d$viewports$simple$api$CameraApi={default:function(a,b){var c=b.threeDManager,g=b.apiResponse;a=function(){module$src$3d$interfaces$api$CameraApiInterface.default.call(this);this.get=this.get.bind(this);this.updateAsync=this.updateAsync.bind(this);this.animateAsync=this.animateAsync.bind(this);this.zoomAsync=this.zoomAsync.bind(this);this.resetAsync=this.resetAsync.bind(this)};$jscomp.inherits(a,module$src$3d$interfaces$api$CameraApiInterface.default);a.prototype.get=function(){return g(null,
c.cameraHandler.getPositionAndTarget())};a.prototype.updateAsync=function(a,b){throw Error("This API function is not implemented by this viewport.");};a.prototype.animateAsync=function(a,b){throw Error("This API function is not implemented by this viewport.");};a.prototype.zoomAsync=function(a,b){throw Error("This API function is not implemented by this viewport.");};a.prototype.resetAsync=function(a){throw Error("This API function is not implemented by this viewport.");};return new a}};var module$src$3d$interfaces$api$LightApiInterface={default:function(){}};var module$src$3d$viewports$simple$api$LightApi={default:function(a,b){a=function(){module$src$3d$interfaces$api$LightApiInterface.default.call(this)};$jscomp.inherits(a,module$src$3d$interfaces$api$LightApiInterface.default);return new a}};var module$src$3d$helpers$api$ViewportApiHelpers={};
module$src$3d$helpers$api$ViewportApiHelpers.default=function(){var a=function(a){return function(b){return[b.slice(0,a),b.slice(a+1)]}},b,c,g,d,f,p,e,m,h,r,q=new module$src$externals$three.default.Matrix4,t=new module$src$externals$three.default.Matrix4,u=[],n=function(){m=function(a){c=a.THREE_D_MANAGER_CONSTANTS;g=a.EVENTTYPE;d=a.threeDManager;f=a.viewportManager;p=a.apiResponse;e=a.listeners};h=function(a,b,c){c||(c="");if("object"===typeof a)for(var d in a){var e=a[d];if(e.desc){var l={description:e.desc};
e.type&&(l.type=e.type);l=module$src$shared$util$GlobalUtils.default.deepCopy(l);b[c.split(".value").join("")+d]=l}h(e,b,c+d+".")}};r=function(b,c){if(-1!==c.indexOf(".")){var d=$jscomp.makeIterator(a(c.indexOf("."))(c));c=d.next().value;d=d.next().value;if(b=b[c])return b.value&&(b=b.value),r(b,d)}else return b[c]}};n.prototype.convertTo2D=function(a,b){m(a);a=new module$src$externals$three.default.Object3D;var c=new module$src$externals$three.default.Vector3,e=d.renderingHandler.getDomElement(),
l=e.getBoundingClientRect(),n=e.width;e=e.height;a.position.set(b.x,b.y,b.z);a.updateMatrixWorld();c.setFromMatrixPosition(a.matrixWorld);c.project(d.cameraHandler.getCamera());c.x=n/2*c.x+n/2;c.y=-(e/2*c.y)+e/2;c.xPixel=c.x/devicePixelRatio;c.yPixel=c.y/devicePixelRatio;return{containerX:c.xPixel,containerY:c.yPixel,clientX:c.xPixel+l.left,clientY:c.yPixel+l.top,pageX:c.xPixel+l.left+window.pageXOffset,pageY:c.yPixel+l.top+window.pageYOffset}};n.prototype.reload=function(a){m(a);return f.reloadThreeDManager(d.runtimeId)};
n.prototype.destroy=function(a){m(a);a=g.DESTROYED;var b=f.removeThreeDManager(d.runtimeId),c;for(c in e){var l=new CustomEvent(a);e[c](l)}return b};n.prototype.addEventListener=function(a,b,c){m(a);if(!Object.keys(g).find(function(a){return g[a]===b}))return p("Unsupported event type");a=module$src$shared$util$GlobalUtils.default.createRandomId();e[a]=c;return p(null,a)};n.prototype.removeEventListener=function(a,b){m(a);return e[b]?(delete e[b],!0):!1};n.prototype.getSettingDefinitions=function(a){m(a);
a={};h(c.settingsDefinition,a,"");return a};n.prototype.getSettings=function(a,b){m(a);Array.isArray(b)||(b=Object.keys(this.getSettingDefinitions(a)));var c={};b.forEach(function(a){if(d.hasSetting(a)){var b=d.getSetting(a);module$src$shared$util$GlobalUtils.default.forceAtPath(c,a,b)}});return c};n.prototype.getSetting=function(a,b){m(a);if(d.hasSetting(b))return d.getSetting(b)};n.prototype.updateSettingAsync=function(a,b,e){m(a);a=r(c.settingsDefinition,b);if(void 0===a)return Promise.resolve(p("Setting does not exist",
!1));if(void 0!==a.type&&null!==a.type)if(module$src$shared$util$GlobalUtils.default.typeCheck(a.type,"string")){if(module$src$shared$util$GlobalUtils.default.typeCheck(e,"m.type"))return Promise.resolve(p("Setting has wrong value type",!1))}else if("function"===typeof a.type&&!a.type(e))return Promise.resolve(p("Setting has wrong value type",!1));a.hasOwnProperty("transform")&&"function"===typeof a.transform&&(e=a.transform(e));return d.updateSettingAsync(b,e).then(function(a){return a?Promise.resolve(p(null,
!0)):Promise.resolve(p("Update of setting failed",!1))},function(){return Promise.resolve(p("Update of setting failed",!1))})};n.prototype.updateSettingsAsync=function(a,b){m(a);var c=[];module$src$shared$util$GlobalUtils.default.getPaths(b,c);var d={},e=Promise.resolve(),l={};c=$jscomp.makeIterator(c);for(var n=c.next();!n.done;l={path:l.path},n=c.next())l.path=n.value,e=e.then(function(c){return function(){return this.updateSettingAsync(a,c.path,module$src$shared$util$GlobalUtils.default.getAtPath(b,
c.path))}}(l)),e=e.then(function(a){return function(b){b.err?module$src$shared$util$GlobalUtils.default.forceAtPath(d,a.path,!1):module$src$shared$util$GlobalUtils.default.forceAtPath(d,a.path,!0)}}(l),function(a){return function(){module$src$shared$util$GlobalUtils.default.forceAtPath(d,a.path,!1)}}(l));return e.then(function(){return p(null,d)})};n.prototype.setTransformation=function(a,b){m(a);d.transformationMatrices||(d.transformationMatrices=[]);if(!Array.isArray(b[0])&&null!==b[0]||b.isMatrix4)b=
[b];q.identity();a=0;for(var c=b.length>d.transformationMatrices.length?b.length:d.transformationMatrices.length;a<c;a++){if(b[a]){var e;d.transformationMatrices[a]=b[a].isMatrix4?b[a]:(e=t.clone()).set.apply(e,$jscomp.arrayFromIterable(b[a]))}else d.transformationMatrices[a]||(d.transformationMatrices[a]=t.clone());q.premultiply(d.transformationMatrices[a])}d.transformationMatrix.identity();d.transformationMatrix.multiply(q);d.renderingHandler.updateShadowMap();d.renderingHandler.render();return p(null,
!0)};n.prototype.applyTransformation=function(a,b){m(a);d.transformationMatrices||(d.transformationMatrices=[]);if(!Array.isArray(b[0])&&null!==b[0]||b.isMatrix4)b=[b];q.identity();a=0;for(var c=b.length>d.transformationMatrices.length?b.length:d.transformationMatrices.length;a<c;a++){if(null!=b[a]){var e;u[a]=b[a].isMatrix4?b[a]:(e=t.clone()).set.apply(e,$jscomp.arrayFromIterable(b[a]))}d.transformationMatrices[a]?b[a]&&d.transformationMatrices[a].multiply(u[a]):d.transformationMatrices[a]=b[a]?
u[a]:t.clone();q.premultiply(d.transformationMatrices[a])}d.transformationMatrix.identity();d.transformationMatrix.premultiply(q);d.renderingHandler.updateShadowMap();d.renderingHandler.render();return p(null,!0)};n.prototype.resetTransformation=function(a){m(a);d.transformationMatrix=t.clone();d.transformationMatrices=[];d.renderingHandler.updateShadowMap();d.renderingHandler.render();return p(null,!0)};n.prototype.getTransformation=function(a){m(a);if(d.transformationMatrices&&0<d.transformationMatrices.length){a=
[];for(var b=0,c=d.transformationMatrices.length;b<c;b++)a[b]=d.transformationMatrices[b].clone();return a}return[d.transformationMatrix.clone()]};n.prototype.setLiveTransformation=function(a,b,c){m(a);var e=new module$node_modules$$tweenjs$tween_js$src$Tween.default.Group;a=[];for(var l=0,n=b.length;l<n;l++)a.push(d.setLiveTransformation(e,b[l].scenePaths,b[l].transformations,b[l].reset,c));b=0;for(n=a.length;b<n;b++)a[b].start();return a};return{getInstance:function(){b||(b=new n);return b}}}();var module$src$3d$viewports$simple$api$ViewportApi={default:function(a,b){var c=b.threeDManager,g=b.viewportManager,d,f,p={};b=function(){module$src$3d$interfaces$api$ViewportApiInterface.default.call(this);this.utils=a.utils;this.EVENTTYPE=a.viewports.EVENTTYPE;this.camera=new module$src$3d$viewports$simple$api$CameraApi.default(a,{threeDManager:c,viewportManager:g,apiResponse:this.utils.APIResponse});this.lights=new module$src$3d$viewports$simple$api$LightApi.default(a,{threeDManager:c,apiResponse:this.utils.APIResponse});
d=module$src$3d$helpers$api$ViewportApiHelpers.default.getInstance();f={THREE_D_MANAGER_CONSTANTS:module$src$3d$viewports$simple$ThreeDManagerConstants.default,EVENTTYPE:this.EVENTTYPE,threeDManager:c,viewportManager:g,apiResponse:this.utils.APIResponse,listeners:p};this.getRuntimeId=this.getRuntimeId.bind(this);this.getContainer=this.getContainer.bind(this);this.getScreenshot=this.getScreenshot.bind(this);this.render=this.render.bind(this);this.convertTo2D=this.convertTo2D.bind(this);this.onResize=
this.onResize.bind(this);this.getSize=this.getSize.bind(this);this.pause=this.pause.bind(this);this.resume=this.resume.bind(this);this.reload=this.reload.bind(this);this.destroy=this.destroy.bind(this);this.addEventListener=this.addEventListener.bind(this);this.removeEventListener=this.removeEventListener.bind(this);this.getSettingDefinitions=this.getSettingDefinitions.bind(this);this.getSettings=this.getSettings.bind(this);this.getSetting=this.getSetting.bind(this);this.updateSettingAsync=this.updateSettingAsync.bind(this);
this.updateSettingsAsync=this.updateSettingsAsync.bind(this);this.setTransformation=this.setTransformation.bind(this);this.getTransformation=this.getTransformation.bind(this);this.applyTransformation=this.applyTransformation.bind(this);this.resetTransformation=this.resetTransformation.bind(this);this.setLiveTransformation=this.setLiveTransformation.bind(this);this.updateSelected=this.updateSelected.bind(this);this.getSelected=this.getSelected.bind(this)};$jscomp.inherits(b,module$src$3d$interfaces$api$ViewportApiInterface.default);
b.prototype.getRuntimeId=function(){return c.runtimeId};b.prototype.getContainer=function(){return c.container};b.prototype.getScreenshot=function(){return c.renderingHandler.getScreenshot()};b.prototype.render=function(){c.renderingHandler.render()};b.prototype.convertTo2D=function(a){return d.convertTo2D(f,a)};b.prototype.onResize=function(a,b){c.cameraHandler.onResize(a,b);c.renderingHandler.onResize(a,b)};b.prototype.getSize=function(){return c.renderingHandler.getSize()};b.prototype.pause=function(){c.pause()};
b.prototype.resume=function(){c.resume()};b.prototype.reload=function(){return d.reload(f)};b.prototype.destroy=function(){return d.destroy(f)};b.prototype.addEventListener=function(a,b){return d.addEventListener(f,a,b)};b.prototype.removeEventListener=function(a){return d.removeEventListener(f,a)};b.prototype.getSettingDefinitions=function(){return d.getSettingDefinitions(f)};b.prototype.getSettings=function(a){return d.getSettings(f,a)};b.prototype.getSetting=function(a){return d.getSetting(f,a)};
b.prototype.updateSettingAsync=function(a,b){return d.updateSettingAsync(f,a,b)};b.prototype.updateSettingsAsync=function(a){return d.updateSettingsAsync(f,a)};b.prototype.setTransformation=function(a){return d.setTransformation(f,a)};b.prototype.getTransformation=function(){return c.transformationMatrix.clone()};b.prototype.applyTransformation=function(a){return d.applyTransformation(f,a)};b.prototype.resetTransformation=function(){return d.getTransformation(f)};b.prototype.setLiveTransformation=
function(a,b){return d.setLiveTransformation(f,a,b)};b.prototype.updateSelected=function(a,b){throw Error("This API function is not implemented by this viewport.");};b.prototype.getSelected=function(){throw Error("This API function is not implemented by this viewport.");};return new b}};var module$src$3d$viewports$expo$default$ThreeDManagerConstants={},threeDManagerConstants$$module$src$3d$viewports$expo$default$ThreeDManagerConstants,_convert$153=function(a,b){for(var c in a){if("value"===c)return _hasSubValue$154(a[c])?_convert$153(a[c],b):a[c];"setting"!==c&&"desc"!==c&&"type"!==c&&(b[c]={},b[c]=_convert$153(a[c],b[c]))}return b},_hasSubValue$154=function(a){if("object"===typeof a)for(var b in a)if("value"===b||_hasSubValue$154(a[b]))return!0;return!1},GLOBAL_UTILS$155=module$src$shared$util$GlobalUtils.default,
LOGGING_CONSTANTS$156=module$src$shared$constants$LoggingConstants.default,LOGGING_LEVELS$157=module$src$shared$constants$LoggingConstants.default.loggingLevels,_settingsDefinition$158={show:{value:!1,setting:"show",desc:"Show / hide the scene",type:"boolean"},showTransition:{value:"1s"},gridVisibility:{value:!0,setting:"gridVisibility",desc:"Show / hide the grid",type:"boolean"},groundPlaneVisibility:{value:!0,setting:"groundPlaneVisibility",desc:"Show / hide the ground plane",type:"boolean"},render:{clearColor:{value:"#ffffff",
setting:"render.clearColor",desc:"Set background color",type:function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"color")?!0:!1}},clearAlpha:{value:1,setting:"render.clearAlpha",desc:"Set background alpha value",type:function(a){return"number"===typeof a&&0<=a&&1>=a?!0:!1}},devicePixelRatio:{value:1},shadows:{value:!0,setting:"render.shadows",desc:"Enable / disable shadows for rendering",type:"boolean"}},camera:{autoRotationSpeed:{value:0,setting:"camera.autoRotationSpeed",desc:"Speed of autoration, can be negative, also refer to enableAutoRotation",
type:"number"},cameraMovementDuration:{value:0,setting:"camera.cameraMovementDuration",desc:"Default duration of camera movements",type:"notnegative"},damping:{value:.1,setting:"camera.damping",desc:"How much to damp camera movements by the user",type:"notnegative"},defaults:{perspective:{value:{position:{value:{x:5,y:5,z:5},setting:"camera.defaults.perspective.position",desc:"Default position for the perspective camera",type:"vector3any",transform:function(a){return module$src$shared$util$GlobalUtils.default.toVector3(a)}},
target:{value:{x:0,y:0,z:0},setting:"camera.defaults.perspective.target",desc:"Default target for the perspective camera",type:"vector3any",transform:function(a){return module$src$shared$util$GlobalUtils.default.toVector3(a)}}},setting:"camera.defaults.perspective",desc:"Default position and target for the perspective camera",type:function(a){return a&&module$src$shared$util$GlobalUtils.default.typeCheck(a.position,"vector3obj")&&module$src$shared$util$GlobalUtils.default.typeCheck(a.target,"vector3obj")}}},
enableAutoRotation:{value:!1,setting:"camera.enableAutoRotation",desc:"Enable / disable automatic rotation of the camera, also refer to autoRotationSpeed",type:"boolean"},enableKeyPan:{value:!1,setting:"camera.enableKeyPan",desc:"Enable / disable panning using the keyboard, also refer to enablePan",type:"boolean"},enableOrbitControls:{value:!0,setting:"camera.enableOrbitControls",desc:"Enable / disable orbit controls",type:"boolean"},enablePan:{value:!0,setting:"camera.enablePan",desc:"Enable / disable panning in general, also refer to enableKeyPan",
type:"boolean"},enableRotation:{value:!0,setting:"camera.enableRotation",desc:"Enable / disable camera rotation",type:"boolean"},enableZoom:{value:!0,setting:"camera.enableZoom",desc:"Enable / disable zooming",type:"boolean"},far:{value:100},fov:{value:45,setting:"camera.fov",desc:"Camera frustum vertical field of view angle, unit degree, interval [0,180]",type:function(a){return"number"===typeof a&&0<a&&180>a?!0:!1}},keyPanSpeed:{value:1,setting:"camera.keyPanSpeed",desc:"Speed of panning when using the keyboard",
type:"number"},near:{value:.01},restrictions:{position:{cube:{value:{min:{value:{x:-Infinity,y:-Infinity,z:-Infinity},setting:"camera.restrictions.position.cube.min",desc:"Restriction of the camera position inside a cube, minimum corner of the cube",type:"vector3any"},max:{value:{x:Infinity,y:Infinity,z:Infinity},setting:"camera.restrictions.position.cube.max",desc:"Restriction of the camera position inside a cube, maximum corner of the cube",type:"vector3any"}},setting:"camera.restrictions.position.cube",
desc:"Restriction of the camera position inside a cube, minimum and maximum corner of the cube"},sphere:{value:{center:{value:{x:0,y:0,z:0},setting:"camera.restrictions.position.sphere.center",desc:"Restriction of the camera position inside a sphere, center of the sphere",type:"vector3any"},radius:{value:Infinity,setting:"camera.restrictions.position.sphere.radius",desc:"Restriction of the camera position inside a sphere, radius of the sphere",type:"notnegative"}},setting:"camera.restrictions.position.sphere",
desc:"Restriction of the camera position inside a sphere, center and radius of the sphere"}},target:{cube:{value:{min:{value:{x:-Infinity,y:-Infinity,z:-Infinity},setting:"camera.restrictions.target.cube.min",desc:"Restriction of the camera target inside a cube, minimum corner of the cube",type:"vector3any"},max:{value:{x:Infinity,y:Infinity,z:Infinity},setting:"camera.restrictions.target.cube.max",desc:"Restriction of the camera target inside a cube, maximum corner of the cube",type:"vector3any"}},
setting:"camera.restrictions.target.cube",desc:"Restriction of the camera target inside a cube, minimum and maximum corner of the cube"},sphere:{value:{center:{value:{x:0,y:0,z:0},setting:"camera.restrictions.target.sphere.center",desc:"Restriction of the camera target inside a sphere, center of the sphere",type:"vector3any"},radius:{value:Infinity,setting:"camera.restrictions.target.sphere.radius",desc:"Restriction of the camera target inside a sphere, radius of the sphere",type:"notnegative"}},
setting:"camera.restrictions.target.sphere",desc:"Restriction of the camera target inside a sphere, center and radius of the sphere"}},rotation:{value:{minPolarAngle:{value:0,setting:"camera.restrictions.rotation.minPolarAngle",desc:"Minimum polar angle of the camera position with respect to the camera target, unit degree, interval [0,180]",type:function(a){return"number"===typeof a&&0<=a&&180>=a?!0:!1}},maxPolarAngle:{value:180,setting:"camera.restrictions.rotation.maxPolarAngle",desc:"Maximum polar angle of the camera position with respect to the camera target, unit degree, interval [0,180]",
type:function(a){return"number"===typeof a&&0<=a&&180>=a?!0:!1}},minAzimuthAngle:{value:-Infinity,setting:"camera.restrictions.rotation.minAzimuthAngle",desc:"Minimum azimuth angle of the camera position with respect to the camera target, unit degree, interval [-180,180]",type:"number"},maxAzimuthAngle:{value:Infinity,setting:"camera.restrictions.rotation.maxAzimuthAngle",desc:"Maximum azimuth angle of the camera position with respect to the camera target, unit degree, interval [-180,180]",type:"number"}},
setting:"camera.restrictions.rotation",desc:"Minimum and maximum polar and azimuth angle of the camera position with respect to the camera target, unit degree",type:function(a){return a&&Object.keys(a).every(function(b){return"number"===typeof a[b]})}},zoom:{value:{minDistance:{value:0,setting:"camera.restrictions.zoom.minDistance",desc:"Minimum distance between camera position and target",type:"notnegative"},maxDistance:{value:Infinity,setting:"camera.restrictions.zoom.maxDistance",desc:"Maximum distance between camera position and target",
type:"notnegative"}},setting:"camera.restrictions.zoom",desc:"Minimum and maximum distance between camera position and target",type:function(a){return a&&module$src$shared$util$GlobalUtils.default.typeCheck(a.minDistance,"notnegative")&&module$src$shared$util$GlobalUtils.default.typeCheck(a.maxDistance,"notnegative")}}},rotationSpeed:{value:.25,setting:"camera.rotationSpeed",desc:"Speed of camera rotation",type:"number"},panSpeed:{value:.5,setting:"camera.panSpeed",desc:"Speed of panning",type:"number"},
zoomExtentsFactor:{value:1,setting:"camera.zoomExtentsFactor",desc:"Factor to apply to the bounding box before zooming to extents",type:"number"},zoomSpeed:{value:1,setting:"camera.zoomSpeed",desc:"Speed of zooming",type:"notnegative"}},material:{environmentMapAsBackground:{value:!1,setting:"material.environmentMapAsBackground",desc:"Show / hide the environment map in the background",type:"boolean"},environmentMap:{value:"default",setting:"material.environmentMap",desc:"Name of the environment map to use, or an array of 6 URLs making up the cube mapped environment map (px, nx, pz, nz, py, ny)",
type:function(a){return"string"===typeof a||module$src$shared$util$GlobalUtils.default.isArrayOfType(a,"string")&&6===a.length}}}},_defaultSettings$159={};_convert$153(_settingsDefinition$158,_defaultSettings$159);threeDManagerConstants$$module$src$3d$viewports$expo$default$ThreeDManagerConstants={settingsDefinition:_settingsDefinition$158,defaultSettings:_defaultSettings$159,loggingLevels:LOGGING_LEVELS$157};module$src$3d$viewports$expo$default$ThreeDManagerConstants.default=module$src$shared$util$GlobalUtils.default.deepCopy(threeDManagerConstants$$module$src$3d$viewports$expo$default$ThreeDManagerConstants);var module$src$3d$viewports$expo$default$handlers$RenderingHandler={default:function(a,b){var c=a.externalLibraries.ExpoTHREE,g=a.settings,d=a.scene,f=a.container,p=f.width,e=f.height,m,h=!0,r,q=!0,t=null,u=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",b.threeDManager.warn,"RenderingHandler.Hook->shadows"))return!1;b.lightHandler.setToggleLightShadows(a);return!0},n=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"color",b.threeDManager.warn,
"RenderingHandler.Hook->clearColor"))return!1;a=(0,module$src$shared$util$toTinyColor.default)(a);null!==t?m.setClearColor(a.toThreeColor(),t):m.setClearColor(a.toThreeColor());return!0},l=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"notnegative",b.threeDManager.warn,"RenderingHandler.Hook->clearAlpha"))return!1;t=a;m.setClearAlpha(a);return!0};a=function(){module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.call(this);m=new c.Renderer({gl:f.gl,pixelRatio:f.pixelRatio,
width:f.width,height:f.height});d.background=null;m.setSize(p,e);m.setPixelRatio(window.devicePixelRatio);m.setClearColor((0,module$src$shared$util$toTinyColor.default)(g.getSetting("clearColor"),"white").toThreeColor(),g.getSetting("clearAlpha"));m.gammaInput=!0;m.gammaOutput=!0;m.shadowMap.enabled=!0;m.shadowMap.autoUpdate=!1;m.shadowMap.needsUpdate=!0;m.physicallyCorrectLights=!0;m.toneMapping=module$src$externals$three.default.ReinhardToneMapping;m.setClearColor(new module$src$externals$three.default.Color(16711935));
r=new module$src$externals$three.default.WebGLRenderTarget(p,e,{minFilter:module$src$externals$three.default.LinearFilter,magFilter:module$src$externals$three.default.LinearFilter,format:module$src$externals$three.default.RGBAFormat,stencilBuffer:!1});r.texture.name="hidden.rt";g.registerHook("shadows",u);g.registerHook("clearColor",n);g.registerHook("clearAlpha",l)};$jscomp.inherits(a,module$src$3d$interfaces$handlers$RenderingHandlerInterface.default);a.prototype.render=function(a){h&&"expoRenderCall"===
a&&b.threeDManager&&!1!==b.threeDManager.getSettingShallow("show")&&b.cameraHandler&&b.cameraHandler.getCamera()&&(1==q&&(q=!1,m.shadowMap.needsUpdate=!0),b.cameraHandler.updateOrbitControls(),b.threeDManager.helpers.toggleViewport(!0),m.render(d,b.cameraHandler.getCamera()),b.threeDManager.helpers.toggleViewport(!1))};a.prototype.renderHidden=function(){b.threeDManager&&b.cameraHandler&&b.cameraHandler.getCamera()&&(1==q&&(q=!1,m.shadowMap.needsUpdate=!0),b.cameraHandler.updateOrbitControls(),b.threeDManager.helpers.toggleViewport(!0),
m.render(d,b.cameraHandler.getCamera(),r),b.threeDManager.helpers.toggleViewport(!1))};a.prototype.onResize=function(a,b,c){m.setPixelRatio(c);m.setSize(a,b)};a.prototype.getSize=function(){return{width:p,height:e}};a.prototype.pause=function(){h=!1};a.prototype.resume=function(){h=!0};a.prototype.destroy=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.getScreenshot=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};
a.prototype.getDomElement=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.getCanvas=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.getRendererInfo=function(){return m.info};a.prototype.setBlur=function(a,c){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.registerForNoRendering=function(a,c){b.threeDManager.debug("This method is not implemented in this viewport.")};
a.prototype.unregisterForNoRendering=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.registerForRestrictedRendering=function(a,c){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.unregisterForRestrictedRendering=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.registerForContinuousRendering=function(a,c){b.threeDManager.debug("This method is not implemented in this viewport.")};
a.prototype.unregisterForContinuousRendering=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.containsContinuousRendering=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.updateShadowMap=function(){q=!0};a.prototype.keepUpdatingShadowMap=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.stopUpdatingShadowMap=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};
return new a}};var module$src$3d$viewports$expo$default$handlers$MaterialHandler={default:function(a,b){var c=a.externalLibraries.ExpoTHREE,g="default default_bw blurred_lights georgentor georgentor_blur georgentor_blue_blur georgentor_bw_blur levelsets lythwood_field mountains ocean piazza_san_marco residential_garden room_abstract_1 sky storage_room storm subway_entrance subway_entrance_bw_blur white yokohama".split(" "),d=[],f="px nx pz nz py ny".split(" "),p=a.settings,e,m,h,r=null,q=[],t=new module$src$externals$three.default.MeshStandardMaterial,
u=function(a){if(void 0===a)return b.threeDManager.warn("MaterialHandler.setEnvironmentMap","No input was provided, the environment map was not set."),Promise.resolve(!1);if(module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")&&a.startsWith('["https')&&a.endsWith('"]')){var c=a;try{a=JSON.parse(c)}catch(z){a=c}}if(module$src$shared$util$GlobalUtils.default.typeCheck(a,"string"))var l=a.toLowerCase().replace(/ /g,"_");else if(Array.isArray(a)){var n=a;if(6!==n.length)return b.threeDManager.warn("MaterialHandler.setEnvironmentMap",
"The number of URLs was not 6, the environment map was not set."),Promise.resolve(!1);l=JSON.stringify(n,null,0)}c=$jscomp.makeIterator(q);for(var h=c.next();!h.done;h=c.next())if(h=h.value,h.name===l)return e._assignEnvironmentMap(h),Promise.resolve(!0);if(void 0===n)if(n=[],0<=g.indexOf(l))for(c=0;c<f.length;c++)n.push("https://viewer.shapediver.com/v2/envmaps/"+l+"/"+f[c]+".jpg");else if(0<=d.indexOf(l))for(c=0;c<f.length;c++)n.push("https://viewer.shapediver.com/v2/envmaps/"+l+"/"+f[c]+".png");
else if(a.startsWith("https://")||a.startsWith("http://"))for(a.endsWith("/")||(a+="/"),c=0;c<f.length;c++)n.push(a+f[c]+".jpg");else return b.threeDManager.warn("MaterialHandler.setEnvironmentMap","Environment map name not found, and not a base URL"),Promise.resolve(!1);return e._loadEnvironmentMap(l,n).then(function(a){q.push(a);e._assignEnvironmentMap(a);return!0},function(){b.threeDManager.warn("MaterialHandler.setEnvironmentMap","Was not able to load the environment map, the environment map was not set.");
return!1})},n=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",b.threeDManager.warn,"MaterialHandler.Hook->environmentMapAsBackground"))return!1;if(b.threeDManager.getSetting("groundPlaneReflectionVisibility")&&a)return b.threeDManager.warn("MaterialHandler.Hook->environmentMapAsBackground","The ground plane reflection and the environment as background do not work together right now."),!1;h=a?r:null;return!0};a=function(){module$src$3d$interfaces$handlers$MaterialHandlerInterface.default.call(this);
e=this;m=new module$src$3d$helpers$handlers$MaterialHandlerHelpers.default(b,{nameStandard:"MeshStandardMaterial",nameSimple:"MeshPhongMaterial"});p.registerHook("environmentMap",u);p.updateSettingAsync("environmentMap",p.getSetting("environmentMap"));p.registerHook("environmentMapAsBackground",n)};$jscomp.inherits(a,module$src$3d$interfaces$handlers$MaterialHandlerInterface.default);a.prototype._loadEnvironmentMap=function(a,b){var d={px:b[0],nx:b[1],pz:b[2],nz:b[3],py:b[4],ny:b[5]};b=[];var e={},
l;for(l in d)e.x=l,e.opt={fileName:"envMap"+e.x+".jpg"},b.push(new Promise(function(a){return function(b,c){module$src$externals$expo_asset_utils.default.resolveAsync(d[a.x],a.opt).then(function(c){d[a.x]=c.localUri;b(c)},function(a){c(a)})}}(e))),e={x:e.x,opt:e.opt};return Promise.all(b).then(function(){return c.loadCubeTextureAsync({assetForDirection:d,directions:"px nx pz nz py ny".split(" ")}).then(function(b){return{name:a,map:b}})})};a.prototype._assignEnvironmentMap=function(a){r=a.map;p.getSetting("environmentMapAsBackground")&&
(h=r);a=b.threeDManager.helpers.getMaterials();for(var c=0,d=a.length;c<d;c++){var e=a[c];"MeshStandardMaterial"==e.type&&e.envMap&&(e.envMap=r)}};a.prototype.pause=function(){};a.prototype.resume=function(){};a.prototype.destroy=function(){};a.prototype.getMaterial=function(a){var b={};a=Object.assign({envMap:r},a);for(var c in a)t.hasOwnProperty(c)&&(b[c]=a[c]);return new module$src$externals$three.default.MeshStandardMaterial(b)};a.prototype.getSimpleMaterial=function(a){return new module$src$externals$three.default.MeshPhongMaterial(a)};
a.prototype.compile=function(){b.renderingHandler.renderHidden();m.checkMaterials()};a.prototype.adjustToBoundingSphere=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.getEnvironmentMap=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.setSceneBackground=function(a){h=a};a.prototype.getSceneBackground=function(){return h};return new a}};var module$src$3d$viewports$expo$default$helpers$OrbitControlsProxyExpoImplementation={default:function(a){var b;a=function(){module$src$3d$interfaces$OrbitControlsProxyInterface.default.call(this);b=this;this.height=this.width=0};$jscomp.inherits(a,module$src$3d$interfaces$OrbitControlsProxyInterface.default);a.prototype.setClientSize=function(a,g){b.width=a;b.height=g};a.prototype.getClientSize=function(){return{width:b.width,height:b.height}};a.prototype.onStateChange=function(){};a.prototype.onStateChangeNone=
function(){};a.prototype.dispose=function(){};a.prototype.initialize=function(){};a.prototype.onTouchesBegan=function(a){b.onTouchStart(a)};a.prototype.onTouchesMoved=function(a){b.onTouchMove(a)};a.prototype.onTouchesEnded=function(a){b.onTouchEnd(a)};return new a}};var module$src$3d$viewports$expo$default$handlers$CameraHandler={default:function(a,b){var c=a.settings,g=a.container,d=a.geometryNode,f,p,e,m,h=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"notnegative",b.threeDManager.warn,"CameraHandler.Hook->fov"))return!1;10<p.fov&&10>a?(p.near=100*p.near*a,p.far=100*p.far*a):10>p.fov&&10<a&&(p.near/=100*p.fov,p.far/=100*p.fov);p.fov=a;p.updateProjectionMatrix();return!0},r=function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a.position,
"vector3obj",b.threeDManager.warn,"CameraHandler.Hook->defaults.perspective")&&module$src$shared$util$GlobalUtils.default.typeCheck(a.target,"vector3obj",b.threeDManager.warn,"CameraHandler.Hook->defaults.perspective")?p instanceof module$src$externals$three.default.PerspectiveCamera?f.setPositionAndTarget(a.position,a.target,{duration:c.getSetting("cameraMovementDuration")}):Promise.resolve(!0):Promise.resolve(!1)},q=function(a){return a.perspective&&module$src$shared$util$GlobalUtils.default.typeCheck(a.perspective.position,
"vector3obj",b.threeDManager.warn,"CameraHandler.Hook->defaults")&&module$src$shared$util$GlobalUtils.default.typeCheck(a.perspective.target,"vector3obj",b.threeDManager.warn,"CameraHandler.Hook->defaults")?Promise.resolve(!0):Promise.resolve(!1)},t=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",b.threeDManager.warn,"CameraHandler.Hook->enableOrbitControls"))return!1;e.enabled=a;return!0},u=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"notnegative",
b.threeDManager.warn,"CameraHandler.Hook->damping"))return!1;a=Math.min(Math.max(.05,a),.25);e.dampingFactor=a;e.panDampingFactor=a;e.zoomDampingFactor=a;e.rotateDampingFactor=a;return!0},n=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",b.threeDManager.warn,"CameraHandler.Hook->enableRotation"))return!1;e.enableRotation=a;return!0},l=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"float",b.threeDManager.warn,"CameraHandler.Hook->rotationSpeed"))return!1;
e.rotationSpeed=a;return!0},v=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",b.threeDManager.warn,"CameraHandler.Hook->enableAutoRotation"))return!1;e.enableAutoRotation=a;return!0},x=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"float",b.threeDManager.warn,"CameraHandler.Hook->autoRotationSpeed"))return!1;e.autoRotationSpeed=a;0!==a?c.updateSetting("enableAutoRotation",!0):c.updateSetting("enableAutoRotation",!1);return!0},w=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,
"boolean",b.threeDManager.warn,"CameraHandler.Hook->enableZoom"))return!1;e.enableZoom=a;return!0},y=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"notnegative",b.threeDManager.warn,"CameraHandler.Hook->zoomSpeed"))return!1;e.zoomSpeed=a;return!0},z=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",b.threeDManager.warn,"CameraHandler.Hook->enablePan"))return!1;e.enablePan=a;return!0},B=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,
"number",b.threeDManager.warn,"CameraHandler.Hook->panSpeed"))return!1;e.panSpeed=a;return!0},A=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",b.threeDManager.warn,"CameraHandler.Hook->enableKeyPan"))return!1;e.enableKeyPan=a;return!0},D=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"number",b.threeDManager.warn,"CameraHandler.Hook->keyPanSpeed"))return!1;e.keyPanSpeed=7*a;return!0},H=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a.min,
"vector3any",b.threeDManager.warn,"CameraHandler.Hook->restrictions.position.cube")||!module$src$shared$util$GlobalUtils.default.typeCheck(a.max,"vector3any",b.threeDManager.warn,"CameraHandler.Hook->restrictions.position.cube"))return!1;e.minPosition=module$src$shared$util$GlobalUtils.default.toVector3(a.min);e.maxPosition=module$src$shared$util$GlobalUtils.default.toVector3(a.max);return!0},G=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a.center,"vector3any",b.threeDManager.warn,
"CameraHandler.Hook->restrictions.position.sphere")||!module$src$shared$util$GlobalUtils.default.typeCheck(a.radius,"notnegative",b.threeDManager.warn,"CameraHandler.Hook->restrictions.position.sphere"))return!1;e.positionSphereCenter=module$src$shared$util$GlobalUtils.default.toVector3(a.center);e.positionSphereRadius=a.radius;return!0},E=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a.min,"vector3any",b.threeDManager.warn,"CameraHandler.Hook->restrictions.target.cube")||!module$src$shared$util$GlobalUtils.default.typeCheck(a.max,
"vector3any",b.threeDManager.warn,"CameraHandler.Hook->restrictions.target.cube"))return!1;e.minTarget=module$src$shared$util$GlobalUtils.default.toVector3(a.min);e.maxTarget=module$src$shared$util$GlobalUtils.default.toVector3(a.max);return!0},J=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a.center,"vector3any",b.threeDManager.warn,"CameraHandler.Hook->restrictions.target.sphere")||!module$src$shared$util$GlobalUtils.default.typeCheck(a.radius,"notnegative",b.threeDManager.warn,
"CameraHandler.Hook->restrictions.target.sphere"))return!1;e.targetSphereCenter=module$src$shared$util$GlobalUtils.default.toVector3(a.center);e.targetSphereRadius=a.radius;return!0},F=function(a){if(!(module$src$shared$util$GlobalUtils.default.typeCheck(a.minPolarAngle,"number",b.threeDManager.warn,"CameraHandler.Hook->restrictions.rotation")&&module$src$shared$util$GlobalUtils.default.typeCheck(a.maxPolarAngle,"number",b.threeDManager.warn,"CameraHandler.Hook->restrictions.rotation")&&module$src$shared$util$GlobalUtils.default.typeCheck(a.minAzimuthAngle,
"number",b.threeDManager.warn,"CameraHandler.Hook->restrictions.rotation")&&module$src$shared$util$GlobalUtils.default.typeCheck(a.maxAzimuthAngle,"number",b.threeDManager.warn,"CameraHandler.Hook->restrictions.rotation")))return!1;e.minPolarAngle=a.minPolarAngle*Math.PI/180;e.maxPolarAngle=a.maxPolarAngle*Math.PI/180;e.minAzimuthAngle=a.minAzimuthAngle*Math.PI/180;e.maxAzimuthAngle=a.maxAzimuthAngle*Math.PI/180;return!0},C=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a.minDistance,
"number",b.threeDManager.warn,"CameraHandler.Hook->restrictions.zoom")||!module$src$shared$util$GlobalUtils.default.typeCheck(a.maxDistance,"number",b.threeDManager.warn,"CameraHandler.Hook->restrictions.zoom"))return!1;e.minDistance=a.minDistance;e.maxDistance=a.maxDistance;return!0},I=function(){f.zoomExtents()};a=function(){module$src$3d$interfaces$handlers$CameraHandlerInterface.default.call(this);f=this;p=new module$src$externals$three.default.PerspectiveCamera(45,g.width/g.height,.01,1E3);var a=
c.getSetting("defaults.perspective.position");p.position.set(a.x,a.y,a.z);p.up.set(0,0,1);b.threeDManager.helpers.addSceneObject(p);m=new module$src$3d$viewports$expo$default$helpers$OrbitControlsProxyExpoImplementation.default(b);e=new module$src$externals$three.default.OrbitControls(p,m);m.initialize();e.enableDamping=!0;e.dampingFactor=c.getSetting("damping");e.panDampingFactor=c.getSetting("damping");e.zoomDampingFactor=c.getSetting("damping");e.rotateDampingFactor=c.getSetting("damping");e.enableRotation=
c.getSetting("enableRotation");e.rotationSpeed=c.getSetting("rotationSpeed");e.enableAutoRotation=c.getSetting("enableAutoRotation");e.autoRotationSpeed=c.getSetting("autoRotationSpeed");e.enableZoom=c.getSetting("enableZoom");e.zoomSpeed=c.getSetting("zoomSpeed");e.enablePan=c.getSetting("enablePan");e.panSpeed=c.getSetting("panSpeed");e.enableKeyPan=c.getSetting("enableKeyPan");e.keyPanSpeed=7*c.getSetting("keyPanSpeed");a=c.getSetting("defaults.perspective.target");e.target.set(a.x,a.y,a.z);c.registerHook("fov",
h);c.registerHook("defaults.perspective",r);c.registerHook("defaults",q);c.registerHook("enableOrbitControls",t);c.registerHook("damping",u);c.registerHook("enableRotation",n);c.registerHook("rotationSpeed",l);c.registerHook("enableAutoRotation",v);c.registerHook("autoRotationSpeed",x);c.registerHook("enableZoom",w);c.registerHook("zoomSpeed",y);c.registerHook("enablePan",z);c.registerHook("panSpeed",B);c.registerHook("enableKeyPan",A);c.registerHook("keyPanSpeed",D);c.registerHook("restrictions.position.cube",
H);c.registerHook("restrictions.position.cube.min",function(a){var b=c.getSetting("restrictions.position.cube");b.min=a;return H(b)});c.registerHook("restrictions.position.cube.max",function(a){var b=c.getSetting("restrictions.position.cube");b.max=a;return H(b)});c.registerHook("restrictions.position.sphere",G);c.registerHook("restrictions.position.sphere.center",function(a){var b=c.getSetting("restrictions.position.sphere");b.center=a;return G(b)});c.registerHook("restrictions.position.sphere.radius",
function(a){var b=c.getSetting("restrictions.position.sphere");b.radius=a;return G(b)});c.registerHook("restrictions.target.cube",E);c.registerHook("restrictions.target.cube.min",function(a){var b=c.getSetting("restrictions.target.cube");b.min=a;return E(b)});c.registerHook("restrictions.target.cube.max",function(a){var b=c.getSetting("restrictions.target.cube");b.max=a;return E(b)});c.registerHook("restrictions.target.sphere",J);c.registerHook("restrictions.target.sphere.center",function(a){var b=
c.getSetting("restrictions.target.sphere");b.center=a;return J(b)});c.registerHook("restrictions.target.sphere.radius",function(a){var b=c.getSetting("restrictions.target.sphere");b.radius=a;return J(b)});c.registerHook("restrictions.rotation",F);c.registerHook("restrictions.rotation.minPolarAngle",function(a){var b=c.getSetting("restrictions.rotation");b.minPolarAngle=a;return F(b)});c.registerHook("restrictions.rotation.maxPolarAngle",function(a){var b=c.getSetting("restrictions.rotation");b.maxPolarAngle=
a;return F(b)});c.registerHook("restrictions.rotation.minAzimuthAngle",function(a){var b=c.getSetting("restrictions.rotation");b.minAzimuthAngle=a;return F(b)});c.registerHook("restrictions.rotation.maxAzimuthAngle",function(a){var b=c.getSetting("restrictions.rotation");b.maxAzimuthAngle=a;return F(b)});c.registerHook("restrictions.zoom",C);c.registerHook("restrictions.zoom.minDistance",function(a){var b=c.getSetting("restrictions.zoom");b.minDistance=a;return C(b)});c.registerHook("restrictions.zoom.maxDistance",
function(a){var b=c.getSetting("restrictions.zoom");b.maxDistance=a;return C(b)});c.registerNotifier("zoomExtentsFactor",I)};$jscomp.inherits(a,module$src$3d$interfaces$handlers$CameraHandlerInterface.default);a.prototype._onTouchesBegan=function(a){m.onTouchesBegan(a)};a.prototype._onTouchesMoved=function(a){m.onTouchesMoved(a)};a.prototype._onTouchesEnded=function(a){m.onTouchesEnded(a)};a.prototype.pause=function(){e.enabled=!1;e.resetState()};a.prototype.resume=function(){e.enabled=!0};a.prototype.destroy=
function(){};a.prototype.setPosition=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"vector3obj",b.threeDManager.warn,"CameraHandler.setPosition"))return!1;e.object.position.set(a.x,a.y,a.z);return!0};a.prototype.resetPosition=function(){return f.setPosition(c.getSetting("defaults.perspective.position"))};a.prototype.getPosition=function(){return module$src$shared$util$GlobalUtils.default.deepCopy(e.object.position)};a.prototype.setTarget=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,
"vector3obj",b.threeDManager.warn,"CameraHandler.setTarget"))return!1;e.target.set(a.x,a.y,a.z);return!0};a.prototype.resetTarget=function(){return f.setTarget(c.getSetting("defaults.perspective.target"))};a.prototype.getTarget=function(){return module$src$shared$util$GlobalUtils.default.deepCopy(e.target)};a.prototype.setPositionAndTarget=function(a,c,d){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"vector3any",b.threeDManager.warn,"CameraHandler.setPositionAndTarget")||!module$src$shared$util$GlobalUtils.default.typeCheck(c,
"vector3any",b.threeDManager.warn,"CameraHandler.setPositionAndTarget"))return Promise.resolve(!1);e.object.position.copy(module$src$shared$util$GlobalUtils.default.toVector3(a));e.target.copy(module$src$shared$util$GlobalUtils.default.toVector3(c));b.renderingHandler.renderHidden();return Promise.resolve(!0)};a.prototype.resetPositionAndTarget=function(a){return f.setPositionAndTarget(c.getSetting("defaults.perspective.position"),c.getSetting("defaults.perspective.target"),a)};a.prototype.getPositionAndTarget=
function(){return{position:f.getPosition(),target:f.getTarget()}};a.prototype.zoomExtents=function(a,b){if(!(b&&b instanceof module$src$externals$three.default.Box3)&&(b=d.computeSceneBoundingBox(),0==b.min.distanceTo(b.max))){var l=Number.MIN_VALUE;b=new module$src$externals$three.default.Box3(new module$src$externals$three.default.Vector3(-l,-l,-l),new module$src$externals$three.default.Vector3(l,l,l))}l=new module$src$externals$three.default.Vector3;b.getCenter(l);if(c.hasSetting("zoomExtentsFactor")){var n=
new module$src$externals$three.default.Vector3;n.subVectors(b.max,l);n.multiplyScalar(c.getSetting("zoomExtentsFactor"));b=new module$src$externals$three.default.Box3((new module$src$externals$three.default.Vector3).subVectors(l,n),(new module$src$externals$three.default.Vector3).addVectors(l,n))}n=[];n.push(b.min);n.push(b.max);n.push(new module$src$externals$three.default.Vector3(b.max.x,b.min.y,b.min.z));n.push(new module$src$externals$three.default.Vector3(b.max.x,b.max.y,b.min.z));n.push(new module$src$externals$three.default.Vector3(b.max.x,
b.min.y,b.max.z));n.push(new module$src$externals$three.default.Vector3(b.min.x,b.max.y,b.max.z));n.push(new module$src$externals$three.default.Vector3(b.min.x,b.min.y,b.max.z));n.push(new module$src$externals$three.default.Vector3(b.min.x,b.max.y,b.min.z));var h=0;b=new module$src$externals$three.default.Vector3;e.object.getWorldDirection(b);b.normalize();var g=new module$src$externals$three.default.Line3(l.clone().addScaledVector(b,-100),l.clone()),m=new module$src$externals$three.default.Vector3;
m.crossVectors(b,e.object.up);m.normalize();var r=new module$src$externals$three.default.Vector3;r.crossVectors(m,b);r.normalize();for(var q=0,p=n.length;q<p;q++){var t=new module$src$externals$three.default.Vector3;g.closestPointToPoint(n[q],!1,t);var v=n[q].clone();v.sub(t);var u=v.dot(m);v=v.dot(r);var E=Math.tan(Math.PI/180*e.object.fov*.5);u=Math.max(Math.abs(u/(e.object.aspect*E)),Math.abs(v/E));t=t.clone().sub(l).dot(b);h=Math.max(h,u-t)}b.multiplyScalar(-1*h);n=new module$src$externals$three.default.Vector3;
n.addVectors(l,b);return f.setPositionAndTarget(n,l,a)};a.prototype.setCameraPath=function(a,c,d){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.getCamera=function(){return p};a.prototype.isCameraMoving=function(){return e.isMoving};a.prototype.updateOrbitControls=function(){e.update()};a.prototype.adjustToBoundingSphere=function(a){p.far=100*a.radius;p.near=.01*a.radius;p.updateProjectionMatrix()};a.prototype.onResize=function(a,b){m.setClientSize(a,b);p.aspect=
a/b;p.setViewOffset(a,b,0,0,a,b);p.updateProjectionMatrix()};return new a}};var module$src$3d$viewports$expo$default$handlers$LightHandler={default:function(a,b){var c,g=new module$src$externals$three.default.Sphere,d,f,p,e,m;a=function(){module$src$3d$interfaces$handlers$LightHandlerInterface.default.call(this);c=new module$src$externals$three.default.Object3D;b.threeDManager.helpers.addViewportObject(c);d=new module$src$externals$three.default.AmbientLight(4210752);c.add(d);f=new module$src$externals$three.default.DirectionalLight(16777215,1);c.add(f);f.direction={x:.5774,
y:-.5774,z:.5774};f.castShadow=!0;f.shadow.mapSize.width=1024;f.shadow.mapSize.height=1024;f.shadow.camera.near=.1;f.shadow.camera.far=8*g.radius;f.shadow.camera.right=1.5*g.radius;f.shadow.camera.left=-1.5*g.radius;f.shadow.camera.top=1.5*g.radius;f.shadow.camera.bottom=-1.5*g.radius;f.shadow.radius=2;f.shadow.bias=-1.75E-4;f.shadow.camera.updateProjectionMatrix();p=new module$src$externals$three.default.Object3D;c.add(p);f.target=p;f.position.set(g.center.x+2.35*g.radius*f.direction.x,g.center.y+
2.35*g.radius*f.direction.y,g.center.z+2.35*g.radius*f.direction.z);f.target.position.set(g.center.x,g.center.y,g.center.x);e=new module$src$externals$three.default.DirectionalLight(16777215,1);c.add(e);e.direction={x:.5774,y:.5774,z:.5774};m=new module$src$externals$three.default.Object3D;c.add(m);e.target=m;e.position.set(g.center.x+2.35*g.radius*e.direction.x,g.center.y+2.35*g.radius*e.direction.y,g.center.z+2.35*g.radius*e.direction.z);e.target.position.set(g.center.x,g.center.y,g.center.x)};
$jscomp.inherits(a,module$src$3d$interfaces$handlers$LightHandlerInterface.default);a.prototype.pause=function(){};a.prototype.resume=function(){};a.prototype.destroy=function(){};a.prototype.adjustToBoundingSphere=function(a){g=a.clone();c&&(f.position.set(g.center.x+2.35*g.radius*f.direction.x,g.center.y+2.35*g.radius*f.direction.y,g.center.z+2.35*g.radius*f.direction.z),f.target.position.set(g.center.x,g.center.y,g.center.x),f.shadow.camera.far=8*a.radius,f.shadow.camera.right=1.5*a.radius,f.shadow.camera.left=
-1.5*a.radius,f.shadow.camera.top=1.5*a.radius,f.shadow.camera.bottom=-1.5*a.radius,f.shadow.camera.updateProjectionMatrix(),e.position.set(g.center.x+2.35*g.radius*e.direction.x,g.center.y+2.35*g.radius*e.direction.y,g.center.z+2.35*g.radius*e.direction.z),e.target.position.set(g.center.x,g.center.y,g.center.x))};a.prototype.setToggleLightShadows=function(a){f.castShadow=a};a.prototype.toggleLights=function(a){f.visible=a;e.visible=a};return new a}};var module$src$3d$viewports$expo$default$ThreeDManager={default:function(a,b){var c=b.pathUtils,g=b.ExpoTHREE,d=b.settings,f=b.scene,p=b.geometryNode,e=b.container,m={},h,r,q,t,u=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",h.warn,"ThreeDManager.Hook->groundPlaneVisibility"))return!1;q&&(q.visible=a);return!0},n=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",h.warn,"ThreeDManager.Hook->gridVisibility"))return!1;t&&(t.visible=a);
return!0},l=function(a,b){module$src$3d$interfaces$ThreeDManagerInterface.default.call(this,b,module$src$shared$util$GlobalUtils.default);h=this;h.constants=module$src$3d$viewports$expo$default$ThreeDManagerConstants.default;m.threeDManager=h;h.viewerApi=a;r=new module$src$3d$helpers$ThreeDManagerHelpers.default({scene:f,geometryNode:p,pathUtils:c},m);m.threeDManager.helpers=r;module$src$shared$mixins$SettingsMixin.default.call(h,d,module$src$3d$viewports$expo$default$ThreeDManagerConstants.default.defaultSettings,
b.runtimeId);this.renderingHandler=new module$src$3d$viewports$expo$default$handlers$RenderingHandler.default({settings:h.getSection("render"),scene:f,container:e,externalLibraries:{ExpoTHREE:g}},m);m.renderingHandler=this.renderingHandler;!1!==h.success&&(this.materialHandler=new module$src$3d$viewports$expo$default$handlers$MaterialHandler.default({settings:h.getSection("material"),externalLibraries:{ExpoTHREE:g}},m),m.materialHandler=this.materialHandler,!1!==h.success&&(this.cameraHandler=new module$src$3d$viewports$expo$default$handlers$CameraHandler.default({settings:h.getSection("camera"),
container:e,geometryNode:p,externalLibraries:{ExpoTHREE:g}},m),m.cameraHandler=this.cameraHandler,!1!==h.success&&(this.lightHandler=new module$src$3d$viewports$expo$default$handlers$LightHandler.default({externalLibraries:{ExpoTHREE:g}},m),m.lightHandler=this.lightHandler,!1!==h.success&&(this.registerHook("groundPlaneVisibility",u),this.registerHook("gridVisibility",n)))))};$jscomp.inherits(l,module$src$3d$interfaces$ThreeDManagerInterface.default);l.prototype.init=function(a){var b=a.min.distanceTo(a.max);
if(1<b){var c=parseInt(b);c=c.toString();c=c.length;c=Math.pow(10,c-1);b=Math.max(Math.ceil(b/c)*c,1);c=b/(c/10)}else{c=1-Math.floor(Math.log(b)/Math.log(10))-2;b=b.toFixed(c+1);var d=parseInt(b.substr(b.length-1))+1;b="0.";for(var e=0;e<c;++e)b+="0";b=parseFloat(b+d);c=10*d}t=new module$src$externals$three.default.GridHelper(2*b,c);t.material.opacity=.15;t.material.transparent=!0;t.isSelectable=!1;t.rotateX(Math.PI/2);t.visible=h.getSetting("gridVisibility");t.position.set(0,0,a.min.z-.005);r.addViewportObject(t);
b=new module$src$externals$three.default.PlaneGeometry(2*b,2*b,2,2);q=new module$src$externals$three.default.Mesh(b,m.materialHandler.getMaterial({color:13882323,side:module$src$externals$three.default.FrontSide,roughness:1,metalness:0}));q.receiveShadow=!0;q.visible=h.getSetting("groundPlaneVisibility");q.position.set(0,0,a.min.z-.005);r.addViewportObject(q);r.initialize();h.adjustScene();m.renderingHandler.render()};l.prototype.adjustScene=function(){if(r.isInitialized()){var a=p.computeSceneBoundingBox(),
b=new module$src$externals$three.default.Sphere;a.getBoundingSphere(b);t.position.set(0,0,a.min.z-.005);q.position.set(0,0,a.min.z-.005);m.lightHandler.adjustToBoundingSphere(b);m.cameraHandler.adjustToBoundingSphere(b);m.renderingHandler.updateShadowMap();m.materialHandler.compile()}};l.prototype.computeBoundingBox=function(a){return p.computeBoundingBox(a)};l.prototype.pause=function(){m.renderingHandler.pause();m.cameraHandler.pause();m.lightHandler.pause();m.materialHandler.pause()};l.prototype.resume=
function(){m.renderingHandler.resume();m.cameraHandler.resume();m.lightHandler.resume();m.materialHandler.resume()};l.prototype.destroy=function(){r.destroyViewport();m.renderingHandler&&m.renderingHandler.destroy();m.cameraHandler&&m.cameraHandler.destroy();m.lightHandler&&m.lightHandler.destroy();m.materialHandler&&m.materialHandler.destroy();h.deregisterAllHooks();h.deregisterAllNotifiers();for(var a in m)delete m[a];for(var b in h)h[b]=void 0};l.prototype.addMesh=function(a,b,c){r.addMesh(a,b,
c)};l.prototype.removeMesh=function(a){r.removeMesh(a)};l.prototype.addAnchor=function(a,b){h.debug("This method is not implemented in this viewport.")};l.prototype.removeAnchor=function(a){h.debug("This method is not implemented in this viewport.")};l.prototype.fadeIn=function(a,b){h.debug("This method is not implemented in this viewport.")};l.prototype.fadeOut=function(a,b){h.debug("This method is not implemented in this viewport.")};l.prototype.setLiveTransformation=function(a,b,c,d,e){h.debug("This method is not implemented in this viewport.")};
l.prototype.updateInteractions=function(a,b){h.debug("This method is not implemented in this viewport.")};l.prototype.removeFromInteractions=function(a){h.debug("This method is not implemented in this viewport.")};return new l(a,b)}};var module$src$3d$viewports$expo$default$api$CameraApi={default:function(a,b){var c=b.threeDManager,g=b.apiResponse;a=function(){module$src$3d$interfaces$api$CameraApiInterface.default.call(this);this.get=this.get.bind(this);this.updateAsync=this.updateAsync.bind(this);this.animateAsync=this.animateAsync.bind(this);this.zoomAsync=this.zoomAsync.bind(this);this.resetAsync=this.resetAsync.bind(this)};$jscomp.inherits(a,module$src$3d$interfaces$api$CameraApiInterface.default);a.prototype.get=function(){return g(null,
c.cameraHandler.getPositionAndTarget())};a.prototype.updateAsync=function(a,b){return c.cameraHandler.setPositionAndTarget(a.position,a.target,b).then(function(a){return a?g(null,c.cameraHandler.getPositionAndTarget()):g("Setting new camera target and position failed",c.cameraHandler.getPositionAndTarget())})};a.prototype.animateAsync=function(a,b){if(!Array.isArray(a))return Promise.resolve(g("First parameter must be an array of CameraDefinitions"));var d=[],e=[];a.forEach(function(a){d.push(a.position);
e.push(a.target)});return c.cameraHandler.setCameraPath(d,e,b).then(function(a){return a?g(null,c.cameraHandler.getPositionAndTarget()):g("Camera path animation failed",c.cameraHandler.getPositionAndTarget())})};a.prototype.zoomAsync=function(a,b){return c.cameraHandler.zoomExtents(b,c.computeBoundingBox(a)).then(function(a){return a?g(null,c.cameraHandler.getPositionAndTarget()):g("Zooming to extents failed",c.cameraHandler.getPositionAndTarget())})};a.prototype.resetAsync=function(a){return c.cameraHandler.resetPositionAndTarget(a).then(function(a){return a?
g(null,c.cameraHandler.getPositionAndTarget()):g("Resetting camera position or target failed",c.cameraHandler.getPositionAndTarget())})};return new a}};var module$src$3d$viewports$expo$default$api$LightApi={default:function(a,b){a=function(){module$src$3d$interfaces$api$LightApiInterface.default.call(this)};$jscomp.inherits(a,module$src$3d$interfaces$api$LightApiInterface.default);return new a}};var module$src$3d$viewports$expo$default$api$ViewportApi={default:function(a,b){var c=b.threeDManager,g=b.viewportManager,d,f,p={};b=function(){module$src$3d$interfaces$api$ViewportApiInterface.default.call(this);this.utils=a.utils;this.EVENTTYPE=a.viewports.EVENTTYPE;this.camera=new module$src$3d$viewports$expo$default$api$CameraApi.default(a,{threeDManager:c,viewportManager:g,apiResponse:this.utils.APIResponse});this.lights=new module$src$3d$viewports$expo$default$api$LightApi.default(a,{threeDManager:c,
apiResponse:this.utils.APIResponse});d=module$src$3d$helpers$api$ViewportApiHelpers.default.getInstance();f={THREE_D_MANAGER_CONSTANTS:module$src$3d$viewports$expo$default$ThreeDManagerConstants.default,EVENTTYPE:this.EVENTTYPE,threeDManager:c,viewportManager:g,apiResponse:this.utils.APIResponse,listeners:p};this.onTouchesBegan=this.onTouchesBegan.bind(this);this.onTouchesMoved=this.onTouchesMoved.bind(this);this.onTouchesEnded=this.onTouchesEnded.bind(this);this.getRuntimeId=this.getRuntimeId.bind(this);
this.getContainer=this.getContainer.bind(this);this.getScreenshot=this.getScreenshot.bind(this);this.render=this.render.bind(this);this.convertTo2D=this.convertTo2D.bind(this);this.onResize=this.onResize.bind(this);this.getSize=this.getSize.bind(this);this.pause=this.pause.bind(this);this.resume=this.resume.bind(this);this.reload=this.reload.bind(this);this.destroy=this.destroy.bind(this);this.addEventListener=this.addEventListener.bind(this);this.removeEventListener=this.removeEventListener.bind(this);
this.getSettingDefinitions=this.getSettingDefinitions.bind(this);this.getSettings=this.getSettings.bind(this);this.getSetting=this.getSetting.bind(this);this.updateSettingAsync=this.updateSettingAsync.bind(this);this.updateSettingsAsync=this.updateSettingsAsync.bind(this);this.setTransformation=this.setTransformation.bind(this);this.getTransformation=this.getTransformation.bind(this);this.applyTransformation=this.applyTransformation.bind(this);this.resetTransformation=this.resetTransformation.bind(this);
this.setLiveTransformation=this.setLiveTransformation.bind(this);this.updateSelected=this.updateSelected.bind(this);this.getSelected=this.getSelected.bind(this)};$jscomp.inherits(b,module$src$3d$interfaces$api$ViewportApiInterface.default);b.prototype.onTouchesBegan=function(a){c.cameraHandler._onTouchesBegan(a)};b.prototype.onTouchesMoved=function(a){c.cameraHandler._onTouchesMoved(a)};b.prototype.onTouchesEnded=function(a){c.cameraHandler._onTouchesEnded(a)};b.prototype.getRuntimeId=function(){return c.runtimeId};
b.prototype.getContainer=function(){throw Error("This API function is not implemented by this viewport.");};b.prototype.getScreenshot=function(){return c.renderingHandler.getScreenshot()};b.prototype.render=function(a){c.renderingHandler.render(a)};b.prototype.convertTo2D=function(a){throw Error("This API function is not implemented by this viewport.");};b.prototype.onResize=function(a,b,d,f,g){c.cameraHandler.onResize(f,g);c.renderingHandler.onResize(f,g,d)};b.prototype.getSize=function(){return c.renderingHandler.getSize()};
b.prototype.pause=function(){c.pause()};b.prototype.resume=function(){c.resume()};b.prototype.reload=function(){return d.reload(f)};b.prototype.destroy=function(){return d.destroy(f)};b.prototype.addEventListener=function(a,b){return d.addEventListener(f,a,b)};b.prototype.removeEventListener=function(a){return d.removeEventListener(f,a)};b.prototype.getSettingDefinitions=function(){return d.getSettingDefinitions(f)};b.prototype.getSettings=function(a){return d.getSettings(f,a)};b.prototype.getSetting=
function(a){return d.getSetting(f,a)};b.prototype.updateSettingAsync=function(a,b){return d.updateSettingAsync(f,a,b)};b.prototype.updateSettingsAsync=function(a){return d.updateSettingsAsync(f,a)};b.prototype.setTransformation=function(a){return d.setTransformation(f,a)};b.prototype.getTransformation=function(){return d.getTransformation(f)};b.prototype.applyTransformation=function(a){return d.applyTransformation(f,a)};b.prototype.resetTransformation=function(){return d.resetTransformation(f)};b.prototype.setLiveTransformation=
function(a,b){return d.setLiveTransformation(f,a,b)};b.prototype.updateSelected=function(a,b){throw Error("This API function is not implemented by this viewport.");};b.prototype.getSelected=function(){throw Error("This API function is not implemented by this viewport.");};return new b}};var module$src$3d$viewports$expo$ar$ThreeDManagerConstants={},threeDManagerConstants$$module$src$3d$viewports$expo$ar$ThreeDManagerConstants,_convert$162=function(a,b){for(var c in a){if("value"===c)return _hasSubValue$163(a[c])?_convert$162(a[c],b):a[c];"setting"!==c&&"desc"!==c&&"type"!==c&&(b[c]={},b[c]=_convert$162(a[c],b[c]))}return b},_hasSubValue$163=function(a){if("object"===typeof a)for(var b in a)if("value"===b||_hasSubValue$163(a[b]))return!0;return!1},GLOBAL_UTILS$164=module$src$shared$util$GlobalUtils.default,
LOGGING_CONSTANTS$165=module$src$shared$constants$LoggingConstants.default,LOGGING_LEVELS$166=module$src$shared$constants$LoggingConstants.default.loggingLevels,_settingsDefinition$167={show:{value:!1,setting:"show",desc:"Show / hide the scene",type:"boolean"},showTransition:{value:"1s"},groundPlaneVisibility:{value:!1,setting:"groundPlaneVisibility",desc:"Show / hide the ground plane",type:"boolean"},render:{devicePixelRatio:{value:1},shadows:{value:!1,setting:"render.shadows",desc:"Enable / disable shadows for rendering",
type:"boolean"}},camera:{far:{value:100},fov:{value:45},near:{value:.01}},material:{environmentMap:{value:"default",setting:"material.environmentMap",desc:"Name of the environment map to use, or an array of 6 URLs making up the cube mapped environment map (px, nx, pz, nz, py, ny)",type:function(a){return"string"===typeof a||module$src$shared$util$GlobalUtils.default.isArrayOfType(a,"string")&&6===a.length}}}},_defaultSettings$168={};_convert$162(_settingsDefinition$167,_defaultSettings$168);
threeDManagerConstants$$module$src$3d$viewports$expo$ar$ThreeDManagerConstants={settingsDefinition:_settingsDefinition$167,defaultSettings:_defaultSettings$168,loggingLevels:LOGGING_LEVELS$166};module$src$3d$viewports$expo$ar$ThreeDManagerConstants.default=module$src$shared$util$GlobalUtils.default.deepCopy(threeDManagerConstants$$module$src$3d$viewports$expo$ar$ThreeDManagerConstants);var module$src$3d$viewports$expo$ar$handlers$RenderingHandler={default:function(a,b){var c=a.externalLibraries.ExpoTHREE,g=a.settings,d=a.scene,f=a.container,p=f.width,e=f.height,m,h=!0,r,q=!0,t=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",b.threeDManager.warn,"RenderingHandler.Hook->shadows"))return!1;b.lightHandler.setToggleLightShadows(a);return!0};a=function(){module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.call(this);m=new c.Renderer({gl:f.gl,
pixelRatio:f.pixelRatio,width:f.width,height:f.height});m.setSize(p,e);m.setPixelRatio(window.devicePixelRatio);m.gammaInput=!0;m.gammaOutput=!0;m.shadowMap.enabled=!0;m.shadowMap.autoUpdate=!1;m.shadowMap.needsUpdate=!0;m.physicallyCorrectLights=!0;m.toneMapping=module$src$externals$three.default.ReinhardToneMapping;r=new module$src$externals$three.default.WebGLRenderTarget(p,e,{minFilter:module$src$externals$three.default.LinearFilter,magFilter:module$src$externals$three.default.LinearFilter,format:module$src$externals$three.default.RGBAFormat,
stencilBuffer:!1});r.texture.name="hidden.rt";g.registerHook("shadows",t)};$jscomp.inherits(a,module$src$3d$interfaces$handlers$RenderingHandlerInterface.default);a.prototype._getRenderer=function(){return m};a.prototype.render=function(a){h&&"expoRenderCall"===a&&b.threeDManager&&!1!==b.threeDManager.getSettingShallow("show")&&b.cameraHandler&&b.cameraHandler.getCamera()&&(1==q&&(q=!1,m.shadowMap.needsUpdate=!0),b.threeDManager.helpers.toggleViewport(!0),b.interactionHandler.update(),m.render(d,
b.cameraHandler.getCamera()),b.threeDManager.helpers.toggleViewport(!1))};a.prototype.renderHidden=function(){b.threeDManager&&b.cameraHandler&&b.cameraHandler.getCamera()&&(1==q&&(q=!1,m.shadowMap.needsUpdate=!0),b.threeDManager.helpers.toggleViewport(!0),b.interactionHandler.isInitialized()||(b.threeDManager.helpers.toggleGeometry(!0),b.threeDManager.helpers.toggleViewportObjects(!0)),m.render(d,b.cameraHandler.getCamera(),r),b.interactionHandler.isInitialized()||(b.threeDManager.helpers.toggleGeometry(!1),
b.threeDManager.helpers.toggleViewportObjects(!1)),b.threeDManager.helpers.toggleViewport(!1))};a.prototype.onResize=function(a,b,c){m.setPixelRatio(c);m.setSize(a,b)};a.prototype.getSize=function(){return m.getSize()};a.prototype.pause=function(){h=!1};a.prototype.resume=function(){h=!0};a.prototype.destroy=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.getScreenshot=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};
a.prototype.getDomElement=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.getCanvas=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.getRendererInfo=function(){return m.info};a.prototype.setBlur=function(a,c){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.registerForNoRendering=function(a,c){b.threeDManager.debug("This method is not implemented in this viewport.")};
a.prototype.unregisterForNoRendering=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.registerForRestrictedRendering=function(a,c){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.unregisterForRestrictedRendering=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.registerForContinuousRendering=function(a,c){b.threeDManager.debug("This method is not implemented in this viewport.")};
a.prototype.unregisterForContinuousRendering=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.containsContinuousRendering=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.updateShadowMap=function(){q=!0};a.prototype.keepUpdatingShadowMap=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.stopUpdatingShadowMap=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};
return new a}};var module$src$3d$viewports$expo$ar$handlers$MaterialHandler={default:function(a,b){var c=a.externalLibraries.ExpoTHREE,g="default default_bw blurred_lights georgentor georgentor_blur georgentor_blue_blur georgentor_bw_blur levelsets lythwood_field mountains ocean piazza_san_marco residential_garden room_abstract_1 sky storage_room storm subway_entrance subway_entrance_bw_blur white yokohama".split(" "),d=[],f="px nx pz nz py ny".split(" "),p=a.settings,e,m,h=null,r=null,q=[],t=new module$src$externals$three.default.MeshStandardMaterial,
u=function(a){if(void 0===a)return b.threeDManager.warn("MaterialHandler.setEnvironmentMap","No input was provided, the environment map was not set."),Promise.resolve(!1);if(module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")&&a.startsWith('["https')&&a.endsWith('"]')){var c=a;try{a=JSON.parse(c)}catch(y){a=c}}if(module$src$shared$util$GlobalUtils.default.typeCheck(a,"string"))var n=a.toLowerCase().replace(/ /g,"_");else if(Array.isArray(a)){var h=a;if(6!==h.length)return b.threeDManager.warn("MaterialHandler.setEnvironmentMap",
"The number of URLs was not 6, the environment map was not set."),Promise.resolve(!1);n=JSON.stringify(h,null,0)}c=$jscomp.makeIterator(q);for(var m=c.next();!m.done;m=c.next())if(m=m.value,m.name===n)return e._assignEnvironmentMap(m),Promise.resolve(!0);if(void 0===h)if(h=[],0<=g.indexOf(n))for(c=0;c<f.length;c++)h.push("https://viewer.shapediver.com/v2/envmaps/"+n+"/"+f[c]+".jpg");else if(0<=d.indexOf(n))for(c=0;c<f.length;c++)h.push("https://viewer.shapediver.com/v2/envmaps/"+n+"/"+f[c]+".png");
else if(a.startsWith("https://")||a.startsWith("http://"))for(a.endsWith("/")||(a+="/"),c=0;c<f.length;c++)h.push(a+f[c]+".jpg");else return b.threeDManager.warn("MaterialHandler.setEnvironmentMap","Environment map name not found, and not a base URL"),Promise.resolve(!1);return e._loadEnvironmentMap(n,h).then(function(a){q.push(a);e._assignEnvironmentMap(a);return!0},function(){b.threeDManager.warn("MaterialHandler.setEnvironmentMap","Was not able to load the environment map, the environment map was not set.");
return!1})};a=function(){module$src$3d$interfaces$handlers$MaterialHandlerInterface.default.call(this);e=this;m=new module$src$3d$helpers$handlers$MaterialHandlerHelpers.default(b,{nameStandard:"MeshStandardMaterial",nameSimple:"MeshPhongMaterial"});p.registerHook("environmentMap",u);p.updateSettingAsync("environmentMap",p.getSetting("environmentMap"));h=new c.AR.BackgroundTexture(b.renderingHandler._getRenderer())};$jscomp.inherits(a,module$src$3d$interfaces$handlers$MaterialHandlerInterface.default);
a.prototype._loadEnvironmentMap=function(a,b){var d={px:b[0],nx:b[1],pz:b[2],nz:b[3],py:b[4],ny:b[5]};b=[];var e={},l;for(l in d)e.x=l,e.opt={fileName:"envMap"+e.x+".jpg"},b.push(new Promise(function(a){return function(b,c){module$src$externals$expo_asset_utils.default.resolveAsync(d[a.x],a.opt).then(function(c){d[a.x]=c.localUri;b(c)},function(a){c(a)})}}(e))),e={x:e.x,opt:e.opt};return Promise.all(b).then(function(){return c.loadCubeTextureAsync({assetForDirection:d,directions:"px nx pz nz py ny".split(" ")}).then(function(b){return{name:a,
map:b}})})};a.prototype._assignEnvironmentMap=function(a){r=a.map;a=b.threeDManager.helpers.getMaterials();for(var c=0,d=a.length;c<d;c++){var e=a[c];"MeshStandardMaterial"==e.type&&e.envMap&&(e.envMap=r)}};a.prototype.pause=function(){};a.prototype.resume=function(){};a.prototype.destroy=function(){};a.prototype.getMaterial=function(a){var b={};a=Object.assign({envMap:r},a);for(var c in a)t.hasOwnProperty(c)&&(b[c]=a[c]);return new module$src$externals$three.default.MeshStandardMaterial(b)};a.prototype.getSimpleMaterial=
function(a){return new module$src$externals$three.default.MeshPhongMaterial(a)};a.prototype.compile=function(){b.renderingHandler.renderHidden();m.checkMaterials()};a.prototype.adjustToBoundingSphere=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.getEnvironmentMap=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.setSceneBackground=function(a){h=a};a.prototype.getSceneBackground=function(){return h};
return new a}};var module$src$3d$viewports$expo$ar$handlers$CameraHandler={default:function(a,b){var c=a.externalLibraries.ExpoTHREE,g=a.container,d,f;a=function(){module$src$3d$interfaces$handlers$CameraHandlerInterface.default.call(this);d=this;f=new c.AR.Camera(g.width,g.height,.01,1E3);b.threeDManager.helpers.addSceneObject(f)};$jscomp.inherits(a,module$src$3d$interfaces$handlers$CameraHandlerInterface.default);a.prototype.pause=function(){(void 0).resetState()};a.prototype.resume=function(){};a.prototype.destroy=
function(){};a.prototype.setPosition=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.resetPosition=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.getPosition=function(){return module$src$shared$util$GlobalUtils.default.deepCopy(f.position)};a.prototype.setTarget=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.resetTarget=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};
a.prototype.getTarget=function(){return module$src$shared$util$GlobalUtils.default.deepCopy((void 0).target)};a.prototype.setPositionAndTarget=function(a,c,d){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.resetPositionAndTarget=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.getPositionAndTarget=function(){return{position:d.getPosition(),target:d.getTarget()}};a.prototype.zoomExtents=function(a,c){b.threeDManager.debug("This method is not implemented in this viewport.")};
a.prototype.setCameraPath=function(a,c,d){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.getCamera=function(){return f};a.prototype.isCameraMoving=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.updateOrbitControls=function(){b.threeDManager.debug("This method is not implemented in this viewport.")};a.prototype.adjustToBoundingSphere=function(a){b.threeDManager.debug("This method is not implemented in this viewport.")};
a.prototype.onResize=function(a,b){f.aspect=a/b;f.setViewOffset(a,b,0,0,a,b);f.updateProjectionMatrix()};return new a}};var module$src$3d$viewports$expo$ar$handlers$InteractionHandler={default:function(a,b){var c=a.externalLibraries.ExpoTHREE,g=a.externalLibraries.AR,d,f=0,p=null,e,m=!1,h=new module$src$externals$three.default.Matrix4,r=new module$src$externals$three.default.Matrix4,q=new module$src$externals$three.default.Matrix4,t,u;a=function(){d=this;t=new c.AR.Planes;b.threeDManager.helpers.addSceneObject(t);u=new c.AR.Points;b.threeDManager.helpers.addSceneObject(u);h.makeRotationX(Math.PI/180*-90);b.threeDManager.helpers.toggleGeometry(!1);
b.threeDManager.helpers.toggleViewportObjects(!1)};a.prototype._updateViewportMatrix=function(){if(m){var a=new module$src$externals$three.default.Matrix4;a.multiply(r);a.multiply(q);a.multiply(h);b.threeDManager.api.resetTransformation();b.threeDManager.api.applyTransformation(a);b.renderingHandler.updateShadowMap()}};a.prototype.update=function(){m||(t.update(),u.update())};a.prototype.isInitialized=function(){return m};a.prototype.onTouchesBegan=function(a){var c=b.renderingHandler.getSize();if(1==
a.touches.length)for(p=null,a=g.performHitTest({x:a.locationX/c.width,y:a.locationY/c.height},g.HitTestResultTypes.HorizontalPlane).hitTest,a=$jscomp.makeIterator(a),c=a.next();!c.done;c=a.next()){e=c=c.value;if(m)break;r.fromArray(c.worldTransform);m=!0;d._updateViewportMatrix();b.threeDManager.helpers.toggleGeometry(!0);b.threeDManager.helpers.toggleViewportObjects(!0);b.threeDManager.helpers.removeSceneObject(t);b.threeDManager.helpers.removeSceneObject(u)}else 2==a.touches.length&&(p=Math.atan2(a.touches[1].locationY/
c.height-a.touches[0].locationY/c.height,a.touches[1].locationX/c.width-a.touches[0].locationX/c.width))};a.prototype.onTouchesMoved=function(a){var c=b.renderingHandler.getSize();if(1==a.touches.length){if(2==f)return;c=g.performHitTest({x:a.locationX/c.width,y:a.locationY/c.height},g.HitTestResultTypes.HorizontalPlane).hitTest;c=$jscomp.makeIterator(c);for(var n=c.next();!n.done;n=c.next()){n=n.value;var h=e.worldTransform,m=new module$src$externals$three.default.Matrix4;m.fromArray(h);h=n.worldTransform;
var t=new module$src$externals$three.default.Matrix4;t.fromArray(h);h=new module$src$externals$three.default.Vector3;h.setFromMatrixPosition(m);m=new module$src$externals$three.default.Vector3;m.setFromMatrixPosition(t);t=m.sub(h);m=new module$src$externals$three.default.Matrix4;m.makeTranslation(t.x,0,t.z);r.multiply(m);d._updateViewportMatrix();e=n}}else 2==a.touches.length&&(n=Math.atan2(a.touches[1].locationY/c.height-a.touches[0].locationY/c.height,a.touches[1].locationX/c.width-a.touches[0].locationX/
c.width),null===p&&(p=n),c=n-p,p=n,n=new module$src$externals$three.default.Matrix4,n.makeRotationY(-c),q.multiply(n),d._updateViewportMatrix());f=a.touches.length};a.prototype.onTouchesEnded=function(a){f=0};return new a}};var module$src$3d$viewports$expo$ar$handlers$LightHandler={default:function(a,b){var c,g=new module$src$externals$three.default.Sphere,d,f,p,e,m;a=function(){module$src$3d$interfaces$handlers$LightHandlerInterface.default.call(this);c=new module$src$externals$three.default.Object3D;b.threeDManager.helpers.addViewportObject(c);d=new module$src$externals$three.default.AmbientLight(4210752);c.add(d);f=new module$src$externals$three.default.DirectionalLight(16777215,1);c.add(f);f.direction={x:.5774,y:-.5774,
z:.5774};f.castShadow=!0;f.shadow.mapSize.width=1024;f.shadow.mapSize.height=1024;f.shadow.camera.near=.1;f.shadow.camera.far=8*g.radius;f.shadow.camera.right=1.5*g.radius;f.shadow.camera.left=-1.5*g.radius;f.shadow.camera.top=1.5*g.radius;f.shadow.camera.bottom=-1.5*g.radius;f.shadow.radius=2;f.shadow.bias=-1.75E-4;f.shadow.camera.updateProjectionMatrix();p=new module$src$externals$three.default.Object3D;c.add(p);f.target=p;f.position.set(g.center.x+2.35*g.radius*f.direction.x,g.center.y+2.35*g.radius*
f.direction.y,g.center.z+2.35*g.radius*f.direction.z);f.target.position.set(g.center.x,g.center.y,g.center.x);e=new module$src$externals$three.default.DirectionalLight(16777215,1);c.add(e);e.direction={x:.5774,y:.5774,z:.5774};m=new module$src$externals$three.default.Object3D;c.add(m);e.target=m;e.position.set(g.center.x+2.35*g.radius*e.direction.x,g.center.y+2.35*g.radius*e.direction.y,g.center.z+2.35*g.radius*e.direction.z);e.target.position.set(g.center.x,g.center.y,g.center.x)};$jscomp.inherits(a,
module$src$3d$interfaces$handlers$LightHandlerInterface.default);a.prototype.pause=function(){};a.prototype.resume=function(){};a.prototype.destroy=function(){};a.prototype.adjustToBoundingSphere=function(a){g=a.clone();c&&(f.position.set(g.center.x+2.35*g.radius*f.direction.x,g.center.y+2.35*g.radius*f.direction.y,g.center.z+2.35*g.radius*f.direction.z),f.target.position.set(g.center.x,g.center.y,g.center.x),f.shadow.camera.far=8*a.radius,f.shadow.camera.right=1.5*a.radius,f.shadow.camera.left=-1.5*
a.radius,f.shadow.camera.top=1.5*a.radius,f.shadow.camera.bottom=-1.5*a.radius,f.shadow.camera.updateProjectionMatrix(),e.position.set(g.center.x+2.35*g.radius*e.direction.x,g.center.y+2.35*g.radius*e.direction.y,g.center.z+2.35*g.radius*e.direction.z),e.target.position.set(g.center.x,g.center.y,g.center.x))};a.prototype.setToggleLightShadows=function(a){f.castShadow=a};a.prototype.toggleLights=function(a){f.visible=a;e.visible=a};return new a}};var module$src$3d$viewports$expo$ar$ThreeDManager={default:function(a,b){var c=b.pathUtils,g=b.ExpoTHREE,d=b.AR,f=b.settings,p=b.scene,e=b.geometryNode,m=b.container,h={},r,q,t,u=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",r.warn,"ThreeDManager.Hook->groundPlaneVisibility"))return!1;t&&(t.visible=a);return!0},n=function(a,b){module$src$3d$interfaces$ThreeDManagerInterface.default.call(this,b,module$src$shared$util$GlobalUtils.default);r=this;r.constants=module$src$3d$viewports$expo$ar$ThreeDManagerConstants.default;
h.threeDManager=r;r.viewerApi=a;q=new module$src$3d$helpers$ThreeDManagerHelpers.default({scene:p,geometryNode:e,pathUtils:c},h);h.threeDManager.helpers=q;module$src$shared$mixins$SettingsMixin.default.call(r,f,module$src$3d$viewports$expo$ar$ThreeDManagerConstants.default.defaultSettings,b.runtimeId);this.renderingHandler=new module$src$3d$viewports$expo$ar$handlers$RenderingHandler.default({settings:r.getSection("render"),scene:p,container:m,externalLibraries:{ExpoTHREE:g,AR:d}},h);h.renderingHandler=
this.renderingHandler;!1!==r.success&&(this.materialHandler=new module$src$3d$viewports$expo$ar$handlers$MaterialHandler.default({settings:r.getSection("material"),externalLibraries:{ExpoTHREE:g,AR:d}},h),h.materialHandler=this.materialHandler,!1!==r.success&&(this.cameraHandler=new module$src$3d$viewports$expo$ar$handlers$CameraHandler.default({settings:r.getSection("camera"),container:m,externalLibraries:{ExpoTHREE:g,AR:d}},h),h.cameraHandler=this.cameraHandler,!1!==r.success&&(this.interactionHandler=
new module$src$3d$viewports$expo$ar$handlers$InteractionHandler.default({geometryNode:e,externalLibraries:{ExpoTHREE:g,AR:d}},h),h.interactionHandler=this.interactionHandler,!1!==r.success&&(this.lightHandler=new module$src$3d$viewports$expo$ar$handlers$LightHandler.default({externalLibraries:{ExpoTHREE:g,AR:d}},h),h.lightHandler=this.lightHandler,!1!==r.success&&this.registerHook("groundPlaneVisibility",u)))))};$jscomp.inherits(n,module$src$3d$interfaces$ThreeDManagerInterface.default);n.prototype.init=
function(a){var b=a.min.distanceTo(a.max);if(1<b){var c=parseInt(b);c=c.toString();c=c.length;c=Math.pow(10,c-1);b=Math.max(Math.ceil(b/c)*c,1)}else{c=1-Math.floor(Math.log(b)/Math.log(10))-2;b=b.toFixed(c+1);var e=parseInt(b.substr(b.length-1))+1;b="0.";for(var l=0;l<c;++l)b+="0";b=parseFloat(b+e)}c=new module$src$externals$three.default.PlaneGeometry(2*b,2*b,2,2);b=new module$src$externals$three.default.ShadowMaterial;b.opacity=.5;t=new module$src$externals$three.default.Mesh(c,b);t.receiveShadow=
!0;t.visible=r.getSetting("groundPlaneVisibility");t.position.set(0,0,a.min.z-.005);q.addViewportObject(t);q.initialize();r.adjustScene();d.setPlaneDetection(d.PlaneDetectionTypes.Horizontal);h.interactionHandler._updateViewportMatrix()};n.prototype.adjustScene=function(){if(q.isInitialized()){var a=e.computeSceneBoundingBox(),b=new module$src$externals$three.default.Sphere;a.getBoundingSphere(b);t.position.set(0,0,a.min.z-.005);h.lightHandler.adjustToBoundingSphere(b);h.cameraHandler.adjustToBoundingSphere(b);
h.renderingHandler.updateShadowMap();h.materialHandler.compile()}};n.prototype.computeBoundingBox=function(a){return e.computeBoundingBox(a)};n.prototype.pause=function(){h.renderingHandler.pause();h.cameraHandler.pause();h.lightHandler.pause();h.materialHandler.pause();d.pause()};n.prototype.resume=function(){h.renderingHandler.resume();h.cameraHandler.resume();h.lightHandler.resume();h.materialHandler.resume();d.resume()};n.prototype.destroy=function(){q.destroyViewport();h.renderingHandler&&h.renderingHandler.destroy();
h.cameraHandler&&h.cameraHandler.destroy();h.lightHandler&&h.lightHandler.destroy();h.materialHandler&&h.materialHandler.destroy();r.deregisterAllHooks();r.deregisterAllNotifiers();for(var a in h)delete h[a];for(var b in r)r[b]=void 0};n.prototype.addMesh=function(a,b,c){q.addMesh(a,b,c)};n.prototype.removeMesh=function(a){q.removeMesh(a)};n.prototype.addAnchor=function(a,b){r.debug("This method is not implemented in this viewport.")};n.prototype.removeAnchor=function(a){r.debug("This method is not implemented in this viewport.")};
n.prototype.fadeIn=function(a,b){r.debug("This method is not implemented in this viewport.")};n.prototype.fadeOut=function(a,b){r.debug("This method is not implemented in this viewport.")};n.prototype.setLiveTransformation=function(a,b,c,d,e){r.debug("This method is not implemented in this viewport.")};n.prototype.updateInteractions=function(a,b){r.debug("This method is not implemented in this viewport.")};n.prototype.removeFromInteractions=function(a){r.debug("This method is not implemented in this viewport.")};
return new n(a,b)}};var module$src$3d$viewports$expo$ar$api$CameraApi={default:function(a,b){var c=b.threeDManager,g=b.apiResponse;a=function(){module$src$3d$interfaces$api$CameraApiInterface.default.call(this);this.get=this.get.bind(this);this.updateAsync=this.updateAsync.bind(this);this.animateAsync=this.animateAsync.bind(this);this.zoomAsync=this.zoomAsync.bind(this);this.resetAsync=this.resetAsync.bind(this)};$jscomp.inherits(a,module$src$3d$interfaces$api$CameraApiInterface.default);a.prototype.get=function(){return g(null,
c.cameraHandler.getPositionAndTarget())};a.prototype.updateAsync=function(a,b){throw Error("This API function is not implemented by this viewport.");};a.prototype.animateAsync=function(a,b){throw Error("This API function is not implemented by this viewport.");};a.prototype.zoomAsync=function(a,b){throw Error("This API function is not implemented by this viewport.");};a.prototype.resetAsync=function(a){throw Error("This API function is not implemented by this viewport.");};return new a}};var module$src$3d$viewports$expo$ar$api$LightApi={default:function(a,b){a=function(){module$src$3d$interfaces$api$LightApiInterface.default.call(this)};$jscomp.inherits(a,module$src$3d$interfaces$api$LightApiInterface.default);return new a}};var module$src$3d$viewports$expo$ar$api$ViewportApi={default:function(a,b){var c=b.threeDManager,g=b.viewportManager,d,f,p={};b=function(){module$src$3d$interfaces$api$ViewportApiInterface.default.call(this);this.utils=a.utils;this.EVENTTYPE=a.viewports.EVENTTYPE;this.camera=new module$src$3d$viewports$expo$ar$api$CameraApi.default(a,{threeDManager:c,viewportManager:g,apiResponse:this.utils.APIResponse});this.lights=new module$src$3d$viewports$expo$ar$api$LightApi.default(a,{threeDManager:c,apiResponse:this.utils.APIResponse});
d=module$src$3d$helpers$api$ViewportApiHelpers.default.getInstance();f={THREE_D_MANAGER_CONSTANTS:module$src$3d$viewports$expo$ar$ThreeDManagerConstants.default,EVENTTYPE:this.EVENTTYPE,threeDManager:c,viewportManager:g,apiResponse:this.utils.APIResponse,listeners:p};this.onTouchesBegan=this.onTouchesBegan.bind(this);this.onTouchesMoved=this.onTouchesMoved.bind(this);this.onTouchesEnded=this.onTouchesEnded.bind(this);this.getRuntimeId=this.getRuntimeId.bind(this);this.getContainer=this.getContainer.bind(this);
this.getScreenshot=this.getScreenshot.bind(this);this.render=this.render.bind(this);this.convertTo2D=this.convertTo2D.bind(this);this.onResize=this.onResize.bind(this);this.getSize=this.getSize.bind(this);this.pause=this.pause.bind(this);this.resume=this.resume.bind(this);this.reload=this.reload.bind(this);this.destroy=this.destroy.bind(this);this.addEventListener=this.addEventListener.bind(this);this.removeEventListener=this.removeEventListener.bind(this);this.getSettingDefinitions=this.getSettingDefinitions.bind(this);
this.getSettings=this.getSettings.bind(this);this.getSetting=this.getSetting.bind(this);this.updateSettingAsync=this.updateSettingAsync.bind(this);this.updateSettingsAsync=this.updateSettingsAsync.bind(this);this.setTransformation=this.setTransformation.bind(this);this.getTransformation=this.getTransformation.bind(this);this.applyTransformation=this.applyTransformation.bind(this);this.resetTransformation=this.resetTransformation.bind(this);this.setLiveTransformation=this.setLiveTransformation.bind(this);
this.updateSelected=this.updateSelected.bind(this);this.getSelected=this.getSelected.bind(this)};$jscomp.inherits(b,module$src$3d$interfaces$api$ViewportApiInterface.default);b.prototype.onTouchesBegan=function(a){c.cameraHandler._onTouchesBegan(a)};b.prototype.onTouchesMoved=function(a){c.cameraHandler._onTouchesMoved(a)};b.prototype.onTouchesEnded=function(a){c.cameraHandler._onTouchesEnded(a)};b.prototype.getRuntimeId=function(){return c.runtimeId};b.prototype.getContainer=function(){throw Error("This API function is not implemented by this viewport.");
};b.prototype.getScreenshot=function(){return c.renderingHandler.getScreenshot()};b.prototype.render=function(a){c.renderingHandler.render(a)};b.prototype.convertTo2D=function(a){throw Error("This API function is not implemented by this viewport.");};b.prototype.onResize=function(a,b,d,f,g){c.cameraHandler.onResize(f,g);c.renderingHandler.onResize(f,g,d)};b.prototype.getSize=function(){return c.renderingHandler.getSize()};b.prototype.pause=function(){c.pause()};b.prototype.resume=function(){c.resume()};
b.prototype.reload=function(){return d.reload(f)};b.prototype.destroy=function(){return d.destroy(f)};b.prototype.addEventListener=function(a,b){return d.addEventListener(f,a,b)};b.prototype.removeEventListener=function(a){return d.removeEventListener(f,a)};b.prototype.getSettingDefinitions=function(){return d.getSettingDefinitions(f)};b.prototype.getSettings=function(a){return d.getSettings(f,a)};b.prototype.getSetting=function(a){return d.getSetting(f,a)};b.prototype.updateSettingAsync=function(a,
b){return d.updateSettingAsync(f,a,b)};b.prototype.updateSettingsAsync=function(a){return d.updateSettingsAsync(f,a)};b.prototype.setTransformation=function(a){return d.setTransformation(f,a)};b.prototype.getTransformation=function(){return d.getTransformation(f)};b.prototype.applyTransformation=function(a){return d.applyTransformation(f,a)};b.prototype.resetTransformation=function(){return d.resetTransformation(f)};b.prototype.setLiveTransformation=function(a,b){return d.setLiveTransformation(f,
a,b)};b.prototype.updateSelected=function(a,b){throw Error("This API function is not implemented by this viewport.");};b.prototype.getSelected=function(){throw Error("This API function is not implemented by this viewport.");};return new b}};var module$src$3d$viewports$default$ThreeDManagerConstants={},threeDManagerConstants$$module$src$3d$viewports$default$ThreeDManagerConstants,_convert$171=function(a,b){for(var c in a){if("value"===c)return _hasSubValue$172(a[c])?_convert$171(a[c],b):a[c];"desc"!==c&&(b[c]={},b[c]=_convert$171(a[c],b[c]))}return b},_hasSubValue$172=function(a){if("object"===typeof a)for(var b in a)if("value"===b||_hasSubValue$172(a[b]))return!0;return!1},GLOBAL_UTILS$173=module$src$shared$util$GlobalUtils.default,
LOGGING_CONSTANTS$174=module$src$shared$constants$LoggingConstants.default,LOGGING_LEVELS$175=module$src$shared$constants$LoggingConstants.default.loggingLevels,cameraViewTypes={MIN:0,PERSPECTIVE:0,TOP:1,BOTTOM:2,RIGHT:3,LEFT:4,BACK:5,FRONT:6,AR:7,MAX:7},settingsDefinition={show:{value:!1,setting:"show",desc:"Show / hide the scene",type:"boolean"},showTransition:{value:"1s"},duration:{value:0,setting:"duration",desc:"Set fade in / fade out duration",type:"number"},fullscreen:{value:!1,setting:"fullscreen",
desc:"Enable / disable fullscreen mode",type:"boolean"},gridVisibility:{value:!0,setting:"gridVisibility",desc:"Show / hide the grid",type:"boolean"},groundPlaneVisibility:{value:!0,setting:"groundPlaneVisibility",desc:"Show / hide the ground plane",type:"boolean"},groundPlaneReflectionVisibility:{value:!1,setting:"groundPlaneReflectionVisibility",desc:"Enable / disable the reflectivity of the groundplane ",type:"boolean"},groundPlaneReflectionThreshold:{value:.01,setting:"groundPlaneReflectionThreshold",
desc:"Allows to control the distance to objects that are still reflected by the groundplane ",type:function(a){return"number"===typeof a&&0<=a}},ignorePointerEvents:{value:!1,setting:"ignorePointerEvents",desc:"Ignore pointer events",type:"boolean"},render:{ambientOcclusion:{value:!0,setting:"render.ambientOcclusion",desc:"Enable / disable ambient occlusion for rendering",type:"boolean"},beautyRenderDelay:{value:50,setting:"beautyRenderDelay",desc:"Amount of which the beauty rendering is delayed",
type:"number"},clearColor:{value:"#ffffff",setting:"render.clearColor",desc:"Set background color",type:function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"color")?!0:!1}},clearAlpha:{value:1,setting:"render.clearAlpha",desc:"Set background alpha value",type:function(a){return"number"===typeof a&&0<=a&&1>=a?!0:!1}},devicePixelRatio:{value:1},pointSize:{value:1,setting:"render.pointSize",desc:"Set size of point objects",type:function(a){return"number"===typeof a&&0<=a?!0:!1}},
sao:{samples:{value:8},intensity:{value:.1},kernelRadius:{value:8},standardDev:{value:25}},shadows:{value:!0,setting:"render.shadows",desc:"Enable / disable shadows for rendering",type:"boolean"}},camera:{autoAdjust:{value:!1,setting:"camera.autoAdjust",desc:"Enable / disable that the camera adjusts to geometry updates",type:"boolean"},autoRotationSpeed:{value:0,setting:"camera.autoRotationSpeed",desc:"Speed of autoration, can be negative, also refer to enableAutoRotation",type:"number"},cameraMovementDuration:{value:0,
setting:"camera.cameraMovementDuration",desc:"Default duration of camera movements",type:"notnegative"},damping:{value:.1,setting:"camera.damping",desc:"How much to damp camera movements by the user",type:"notnegative"},defaults:{perspective:{value:{position:{value:{x:5,y:5,z:5},setting:"camera.defaults.perspective.position",desc:"Default position for the perspective camera",type:"vector3any",transform:function(a){return module$src$shared$util$GlobalUtils.default.toVector3(a)}},target:{value:{x:0,
y:0,z:0},setting:"camera.defaults.perspective.target",desc:"Default target for the perspective camera",type:"vector3any",transform:function(a){return module$src$shared$util$GlobalUtils.default.toVector3(a)}}},setting:"camera.defaults.perspective",desc:"Default position and target for the perspective camera",type:function(a){return a&&module$src$shared$util$GlobalUtils.default.typeCheck(a.position,"vector3obj")&&module$src$shared$util$GlobalUtils.default.typeCheck(a.target,"vector3obj")}},orthographic:{value:{position:{value:{x:5,
y:5,z:5},setting:"camera.defaults.orthographic.position",desc:"Default position for the orthographic camera",type:"vector3any",transform:function(a){return module$src$shared$util$GlobalUtils.default.toVector3(a)}},target:{value:{x:0,y:0,z:0},setting:"camera.defaults.orthographic.target",desc:"Default target for the orthographic camera",type:"vector3any",transform:function(a){return module$src$shared$util$GlobalUtils.default.toVector3(a)}}},setting:"camera.defaults.orthographic",desc:"Default position and target for the orthographic camera",
type:function(a){return a&&module$src$shared$util$GlobalUtils.default.typeCheck(a.position,"vector3obj")&&module$src$shared$util$GlobalUtils.default.typeCheck(a.target,"vector3obj")}}},enableAutoRotation:{value:!1,setting:"camera.enableAutoRotation",desc:"Enable / disable automatic rotation of the camera, also refer to autoRotationSpeed",type:"boolean"},enableKeyPan:{value:!1,setting:"camera.enableKeyPan",desc:"Enable / disable panning using the keyboard, also refer to enablePan",type:"boolean"},
enableOrbitControls:{value:!0,setting:"camera.enableOrbitControls",desc:"Enable / disable orbit controls",type:"boolean"},enablePan:{value:!0,setting:"camera.enablePan",desc:"Enable / disable panning in general, also refer to enableKeyPan",type:"boolean"},enableRotation:{value:!0,setting:"camera.enableRotation",desc:"Enable / disable camera rotation",type:"boolean"},enableZoom:{value:!0,setting:"camera.enableZoom",desc:"Enable / disable zooming",type:"boolean"},far:{value:100},fov:{value:45,setting:"camera.fov",
desc:"Camera frustum vertical field of view angle, unit degree, interval [0,180]",type:function(a){return"number"===typeof a&&0<a&&180>a?!0:!1}},keyPanSpeed:{value:1,setting:"camera.keyPanSpeed",desc:"Speed of panning when using the keyboard",type:"number"},near:{value:.01},restrictions:{position:{cube:{value:{min:{value:{x:-Infinity,y:-Infinity,z:-Infinity},setting:"camera.restrictions.position.cube.min",desc:"Restriction of the camera position inside a cube, minimum corner of the cube",type:"vector3any"},
max:{value:{x:Infinity,y:Infinity,z:Infinity},setting:"camera.restrictions.position.cube.max",desc:"Restriction of the camera position inside a cube, maximum corner of the cube",type:"vector3any"}},setting:"camera.restrictions.position.cube",desc:"Restriction of the camera position inside a cube, minimum and maximum corner of the cube"},sphere:{value:{center:{value:{x:0,y:0,z:0},setting:"camera.restrictions.position.sphere.center",desc:"Restriction of the camera position inside a sphere, center of the sphere",
type:"vector3any"},radius:{value:Infinity,setting:"camera.restrictions.position.sphere.radius",desc:"Restriction of the camera position inside a sphere, radius of the sphere",type:"notnegative"}},setting:"camera.restrictions.position.sphere",desc:"Restriction of the camera position inside a sphere, center and radius of the sphere"}},target:{cube:{value:{min:{value:{x:-Infinity,y:-Infinity,z:-Infinity},setting:"camera.restrictions.target.cube.min",desc:"Restriction of the camera target inside a cube, minimum corner of the cube",
type:"vector3any"},max:{value:{x:Infinity,y:Infinity,z:Infinity},setting:"camera.restrictions.target.cube.max",desc:"Restriction of the camera target inside a cube, maximum corner of the cube",type:"vector3any"}},setting:"camera.restrictions.target.cube",desc:"Restriction of the camera target inside a cube, minimum and maximum corner of the cube"},sphere:{value:{center:{value:{x:0,y:0,z:0},setting:"camera.restrictions.target.sphere.center",desc:"Restriction of the camera target inside a sphere, center of the sphere",
type:"vector3any"},radius:{value:Infinity,setting:"camera.restrictions.target.sphere.radius",desc:"Restriction of the camera target inside a sphere, radius of the sphere",type:"notnegative"}},setting:"camera.restrictions.target.sphere",desc:"Restriction of the camera target inside a sphere, center and radius of the sphere"}},rotation:{value:{minPolarAngle:{value:0,setting:"camera.restrictions.rotation.minPolarAngle",desc:"Minimum polar angle of the camera position with respect to the camera target, unit degree, interval [0,180]",
type:function(a){return"number"===typeof a&&0<=a&&180>=a?!0:!1}},maxPolarAngle:{value:180,setting:"camera.restrictions.rotation.maxPolarAngle",desc:"Maximum polar angle of the camera position with respect to the camera target, unit degree, interval [0,180]",type:function(a){return"number"===typeof a&&0<=a&&180>=a?!0:!1}},minAzimuthAngle:{value:-Infinity,setting:"camera.restrictions.rotation.minAzimuthAngle",desc:"Minimum azimuth angle of the camera position with respect to the camera target, unit degree, interval [-180,180]",
type:"number"},maxAzimuthAngle:{value:Infinity,setting:"camera.restrictions.rotation.maxAzimuthAngle",desc:"Maximum azimuth angle of the camera position with respect to the camera target, unit degree, interval [-180,180]",type:"number"}},setting:"camera.restrictions.rotation",desc:"Minimum and maximum polar and azimuth angle of the camera position with respect to the camera target, unit degree",type:function(a){return a&&Object.keys(a).every(function(b){return"number"===typeof a[b]})}},zoom:{value:{minDistance:{value:0,
setting:"camera.restrictions.zoom.minDistance",desc:"Minimum distance between camera position and target",type:"notnegative"},maxDistance:{value:Infinity,setting:"camera.restrictions.zoom.maxDistance",desc:"Maximum distance between camera position and target",type:"notnegative"}},setting:"camera.restrictions.zoom",desc:"Minimum and maximum distance between camera position and target",type:function(a){return a&&module$src$shared$util$GlobalUtils.default.typeCheck(a.minDistance,"notnegative")&&module$src$shared$util$GlobalUtils.default.typeCheck(a.maxDistance,
"notnegative")}}},revertAtMouseUp:{value:!1,setting:"camera.revertAtMouseUp ",desc:"Enable / disable if the mouse should reset on mouse up",type:"boolean"},revertAtMouseUpDuration:{value:800,setting:"camera.revertAtMouseUpDuration",desc:"The duration of the transition of the revertAtMouseUp",type:"notnegative"},rotationSpeed:{value:.25,setting:"camera.rotationSpeed",desc:"Speed of camera rotation",type:"number"},panSpeed:{value:.5,setting:"camera.panSpeed",desc:"Speed of panning",type:"number"},type:{value:cameraViewTypes.PERSPECTIVE,
setting:"camera.type",desc:"Set camera type",type:function(a){return"number"===typeof a&&a>=cameraViewTypes.PERSPECTIVE&&a<=cameraViewTypes.AR?!0:!1}},zoomExtentsFactor:{value:1,setting:"camera.zoomExtentsFactor",desc:"Factor to apply to the bounding box before zooming to extents",type:"number"},zoomSpeed:{value:1,setting:"camera.zoomSpeed",desc:"Speed of zooming",type:"notnegative"}},lights:{light0:{value:{type:999,properties:{}}},light1:{value:{type:0,properties:{color:6579300,intensity:1}}},light2:{value:{type:1,
properties:{direction:{x:.5774,y:-.5774,z:.5774},shadows:!0,intensity:1}}},light3:{value:{}},light4:{value:{}},light5:{value:{}},light6:{value:{}},light7:{value:{}},light8:{value:{}},light9:{value:{}}},material:{environmentMapAsBackground:{value:!1,setting:"material.environmentMapAsBackground",desc:"Show / hide the environment map in the background",type:"boolean"},environmentMap:{value:"none",setting:"material.environmentMap",desc:"Name of the environment map to use, or an array of 6 image URLs making up the cube mapped environment map (px, nx, pz, nz, py, ny)",
type:function(a){return"string"===typeof a||module$src$shared$util$GlobalUtils.default.isArrayOfType(a,"string")&&6===a.length}},environmentMapResolution:{value:"1024",setting:"material.environmentMapResolution",desc:"Image resolution to be used for the named environment maps (available resolutions: 256, 512, 1024)",type:function(a){return["256","512","1024","2048"].includes(a)}}}},defaultSettings={};_convert$171(settingsDefinition,defaultSettings);
threeDManagerConstants$$module$src$3d$viewports$default$ThreeDManagerConstants={settingsDefinition:settingsDefinition,defaultSettings:defaultSettings,loggingLevels:LOGGING_LEVELS$175,cameraViewTypes:cameraViewTypes};module$src$3d$viewports$default$ThreeDManagerConstants.default=module$src$shared$util$GlobalUtils.default.deepCopy(threeDManagerConstants$$module$src$3d$viewports$default$ThreeDManagerConstants);var module$src$3d$viewports$default$shaders$ShaderFile={default:{}};module$src$3d$viewports$default$shaders$ShaderFile.default.basic_vert="\nvarying vec2 vUv;\n\nvoid main() {\n\tvUv = uv;\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n\n";module$src$3d$viewports$default$shaders$ShaderFile.default.blend_frag="\nuniform sampler2D tStandard;\nuniform sampler2D tBeauty;\t\t\nuniform vec2 size;\nuniform float amount;\n\nvarying vec2 vUv;\n\nvoid main() {\n\tgl_FragColor =  texture2D(tStandard, vUv) * (1.0-amount) + texture2D(tBeauty, vUv) * amount;\n}\n\n";
module$src$3d$viewports$default$shaders$ShaderFile.default.blur_frag="\n#include <common>\n#include <packing>\n\nuniform sampler2D tAO;\nuniform sampler2D tDiffuse;\n\nuniform sampler2D tDepth;\n\nuniform float cameraNear;\nuniform float cameraFar;\nuniform vec2 size;\nuniform int orientation;\n\nuniform float sampleWeights[ KERNEL_RADIUS + 1 ];\n\nvarying vec2 vUv;\n\t\t\nconst float depthCutoff = 1.0;\n\nvoid main() {\n\tfloat depth = unpackRGBAToDepth( texture2D( tDepth, vUv ) );\n\tif( depth >= ( 1.0 - EPSILON ) ) {\n\t\tgl_FragColor = texture2D(tDiffuse, vUv);\n\t\treturn;\n\t}\n\n\tfloat centerViewZ = -perspectiveDepthToViewZ( depth, cameraNear, cameraFar );\n\tvec2 size = 1.0 / size;\n\n\tfloat weightSum = sampleWeights[0];\n\tvec4 sum = texture2D(tAO, vUv) * sampleWeights[0];\n\n\tvec2 position;\n\tfor(int i = 1; i <= KERNEL_RADIUS; i++){\n\t\tif(orientation == 0){\n\t\t\tposition = vec2(vUv.x - size.x*float(i), vUv.y);\n\t\t}else if(orientation == 1){\n\t\t\tposition = vec2(vUv.x, vUv.y - size.y*float(i));\n\t\t}\n\t\tfloat positionDepth = unpackRGBAToDepth( texture2D( tDepth, position ) );\n\t\tfloat viewZ = -perspectiveDepthToViewZ( positionDepth, cameraNear, cameraFar );\n\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) break;\n\t\tfloat weight = sampleWeights[i];\n\t\tsum += texture2D( tAO, position ) * weight;\n\t\tweightSum += weight;\n\t}\n\n\tfor(int i = 1; i <= KERNEL_RADIUS; i++){\n\t\tif(orientation == 0){\n\t\t\tposition = vec2(vUv.x + size.x*float(i), vUv.y);\n\t\t}else if(orientation == 1){\n\t\t\tposition = vec2(vUv.x, vUv.y + size.y*float(i));\n\t\t}\n\t\tfloat positionDepth = unpackRGBAToDepth( texture2D( tDepth, position ) );\n\t\tfloat viewZ = -perspectiveDepthToViewZ( positionDepth, cameraNear, cameraFar );\n\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) break;\n\t\tfloat weight = sampleWeights[i];\n\t\tsum += texture2D( tAO, position ) * weight;\n\t\tweightSum += weight;\n\t}\n\n\tif(orientation == 1){\n\t\tvec4 texel = texture2D(tDiffuse, vUv);\n\t\tgl_FragColor = (sum / weightSum) * texel;\n\t}else{\n\t\tgl_FragColor = (sum / weightSum);\n\t}\n}\n\n";
module$src$3d$viewports$default$shaders$ShaderFile.default.copy_frag="\nuniform float opacity;\nuniform sampler2D tDiffuse;\n\nvarying vec2 vUv;\n\nvoid main() {\nvec4 texel = texture2D( tDiffuse, vUv );\ngl_FragColor = opacity * texel;\n}\n\n";module$src$3d$viewports$default$shaders$ShaderFile.default.gem_frag="#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvarying vec4 initialPosition;\nvarying vec3 initialNormal;\n\nvarying vec3 frag_position;\nvarying vec3 frag_normal;\n\nuniform vec3 center;\nuniform float radius;\nuniform samplerCube sphericalNormalMap;\nuniform mat3 normalMatrix;\nuniform mat4 modelMatrix;\nuniform mat4 inverseModelMatrix;\nuniform mat3 inverseTransposeModelMatrix;\n\nuniform samplerCube impurityMap;\nuniform float impurityScale;\nuniform vec3 colorTransferBegin;\nuniform vec3 colorTransferEnd;\nuniform float refractionIndex;\nuniform float gamma;\nuniform float contrast;\nuniform float brightness;\nuniform float dispersion;\nuniform float tracingOpacity;\n\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradianceTemp( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * geometry.normal.x, geometry.normal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * geometry.normal.x, geometry.normal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevelTemp( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadianceTemp( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\tfloat specularMIPLevel = getSpecularMIPLevelTemp( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n\nvec3 calculateReflectedLight(vec3 position, vec3 normal, vec3 viewDir, PhysicalMaterial material, int depth) {\n\t\n\tGeometricContext currentGeometry;\n\tcurrentGeometry.position = (modelMatrix * vec4(position, 1.0)).xyz;\n\tcurrentGeometry.normal = normalize(inverseTransposeModelMatrix * normal);\n\tcurrentGeometry.viewDir = normalize(inverseTransposeModelMatrix * -viewDir);\n\n\tReflectedLight rLight;\n\tIncidentLight dLight;\n\n\tfloat temp = material.specularRoughness;\n\tmaterial.specularRoughness = 0.5;\n\n\t#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\t\tPointLight pointLight;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\t\tpointLight = pointLights[ i ];\n\t\t\tgetPointDirectLightIrradiance( pointLight, currentGeometry, dLight );\n\t\t\t#ifdef USE_SHADOWMAP\n\t\t\tdLight.color *= all( bvec2( pointLight.shadow, dLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t\t#endif\n\t\t\tRE_Direct( dLight, currentGeometry, material, rLight );\n\t\t}\n\t#endif\n\t#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\t\tSpotLight spotLight;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\t\tspotLight = spotLights[ i ];\n\t\t\tgetSpotDirectLightIrradiance( spotLight, currentGeometry, dLight );\n\t\t\t#ifdef USE_SHADOWMAP\n\t\t\tdLight.color *= all( bvec2( spotLight.shadow, dLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t\t#endif\n\t\t\tRE_Direct( dLight, currentGeometry, material, rLight );\n\t\t}\n\t#endif\n\t#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\t\tDirectionalLight directionalLight;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\t\tdirectionalLight = directionalLights[ i ];\n\t\t\tgetDirectionalDirectLightIrradiance( directionalLight, currentGeometry, dLight );\n\t\t\t#ifdef USE_SHADOWMAP\n\t\t\tdLight.color *= all( bvec2( directionalLight.shadow, dLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t\t#endif\n\t\t\tRE_Direct( dLight, currentGeometry, material, rLight );\n\t\t}\n\t#endif\n\tmaterial.specularRoughness = temp;\n\t\n\t#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\t\tRectAreaLight rectAreaLight;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\t\trectAreaLight = rectAreaLights[ i ];\n\t\t\tRE_Direct_RectArea( rectAreaLight, currentGeometry, material, rLight );\n\t\t}\n\t#endif\n\n\t#if defined( RE_IndirectDiffuse )\n\t\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t\t#pragma unroll_loop\n\t\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], currentGeometry );\n\t\t\t}\n\t\t#endif\n\t#endif\n\t#if defined( RE_IndirectSpecular )\n\t\tvec3 radiance = vec3( 0.0 );\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\n\n\t#if defined( RE_IndirectDiffuse )\n\t\t#ifdef USE_LIGHTMAP\n\t\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\t\tlightMapIrradiance *= PI;\n\t\t\t#endif\n\t\t\tirradiance += lightMapIrradiance;\n\t\t#endif\n\t\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tirradiance += getLightProbeIndirectIrradianceTemp( currentGeometry, maxMipLevel );\n\t\t#endif\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t\tradiance += getLightProbeIndirectRadianceTemp( currentGeometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t\t#ifndef STANDARD\n\t\t\tclearCoatRadiance += getLightProbeIndirectRadianceTemp( currentGeometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t\t#endif\n\t#endif\n\n\n\n\t#if defined( RE_IndirectDiffuse )\n\t\tRE_IndirectDiffuse( irradiance, currentGeometry, material, rLight );\n\t#endif\n\t#if defined( RE_IndirectSpecular )\n\t\tRE_IndirectSpecular( radiance, clearCoatRadiance, currentGeometry, material, rLight );\n\t#endif\n\n\tif(depth >= 0) {\n\t\tfloat frac = float(depth) / float(DEPTH);\n\t\trLight.indirectSpecular *= (1.0-frac) * colorTransferBegin + frac * colorTransferEnd;\n\t}\n\n\tvec3 color = rLight.indirectSpecular + rLight.directSpecular + rLight.indirectDiffuse + rLight.directDiffuse;\n\tcolor = pow(color, vec3(1.0/gamma)); // gamma\n\tcolor.rgb = ((color.rgb - 0.5) * max(contrast, 0.0)) + 0.5; // contrast\n\tcolor += vec3(brightness, brightness, brightness); // brightness\n\treturn color;\n}\n\nvec3 normalLookUp(vec3 dir) {\n\tvec4 s = textureCube(sphericalNormalMap, dir);\n\tif(s.a < 1.0/256.0) {\n\t\treturn normalize(vec3(-s.x, -s.y, -s.z));\n\t} else if(s.a < 3.0/256.0) {\n\t\treturn normalize(vec3(-s.x, -s.y, s.z));\n\t} else if(s.a < 5.0/256.0) {\n\t\treturn normalize(vec3(-s.x, s.y, -s.z));\n\t} else if(s.a < 7.0/256.0) {\n\t\treturn normalize(vec3(s.x, -s.y, -s.z));\n\t} else if(s.a < 9.0/256.0) {\n\t\treturn normalize(vec3(-s.x, s.y, s.z));\n\t} else if(s.a < 11.0/256.0) {\n\t\treturn normalize(vec3(s.x, -s.y, s.z));\n\t} else if(s.a < 13.0/256.0) {\n\t\treturn normalize(vec3(s.x, s.y, -s.z));\n\t} else {\n\t\treturn normalize(s.xyz);\n\t}\n}\n\n#ifdef USE_IMPURITY_MAP\n\tfloat impurityLookUp(vec3 dir) {\n\t\tvec3 c = textureCube(impurityMap, dir).rgb;\n\t\treturn (c.x + c.y + c.z) / 3.0;\n\t}\n#endif\n\nvec3 raySphereIntersection(vec3 o, vec3 d) {\n\n\tvec3 oc = o - center;\nfloat a = dot(d, d);\nfloat b = 2.0 * dot(oc, d);\nfloat c = dot(oc,oc) - radius*radius;\nfloat discriminant = b*b - 4.0*a*c;\nif(discriminant < 0.0){\nreturn vec3(0.0);\n}\nelse{\nreturn o +( (-b + sqrt(discriminant)) / (2.0*a)) * d;\n}\n}\n\nvec3 hueToSaturatedColor(float hue) {\nfloat r,g,b;\nif (hue < 0.25){\n\t\tfloat t = 1.0 - (hue / 0.25);\nr = 1.0;\ng = 1.0;\nb = t;\n\t} else if (hue < 0.5){\n\tfloat t = 1.0 - (hue - 0.25 / 0.25);\n\t\tr = 1.0;\ng = t;\nb = 0.0;\n\t} else if (hue < 0.75){\n\tfloat t = 1.0 - (hue - 0.5 / 0.25);\n\t\tr = t;\ng = 0.0;\nb = 1.0 - t;\n} else {\n\tfloat t = hue - 0.75 / 0.25;\nr = t;\ng = t;\nb = 1.0;\n}\nreturn vec3(r, g, b) / 0.5 + 0.5;\n}\n\nvoid main() {\n\tvec3 frag_normal_normalized = frag_normal;\n\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\n\tvec3 initialDirection = normalize( frag_position - (inverseModelMatrix*vec4(cameraPosition,1.0)).xyz );\n\n\n\tvec4 outgoingLight;\n\tfloat r_0 = (1.0-refractionIndex)/(1.0+refractionIndex);\n\tr_0 = r_0*r_0;\n\n\tfloat cos_theta_0 = -dot(initialDirection, frag_normal_normalized);\n\tfloat r_0_outside = (refractionIndex-1.0)/(refractionIndex+1.0);\n\tr_0_outside = r_0_outside*r_0_outside;\n\tfloat initialProbability = r_0_outside + (1.0 - r_0_outside)*pow(1.0 - cos_theta_0, 5.0);\n\n\t\t\t\t\n\toutgoingLight = vec4(calculateReflectedLight(frag_position, frag_normal_normalized, initialDirection, material, -1), 1.0);\n\tif(DEPTH > 0)\n\t\toutgoingLight *= initialProbability;\n\t\t\n\tvec3 tempColor;\n\n\t#ifdef DISPERSION\n\t\tconst int loop = 3;\n\t\tvec3 dispersionColor;\n\t#else\n\t\tconst int loop = 1;\n\t#endif\n\t\tfor(int j = 0; j < loop; j++){\n\t\t\tvec3 refractedDirection = refract(initialDirection, frag_normal_normalized, 1.0/refractionIndex + float(j)*dispersion);\n\t\t\tvec3 newPosition = raySphereIntersection(frag_position, refractedDirection);\n\t\t\tvec3 lookUpVector = normalize(newPosition - center);\n\t\t\tvec3 newNormal = normalLookUp(lookUpVector);\n\t\t\tvec3 newDirection = reflect(refractedDirection, newNormal);\n\n\t\t\tfloat currentProbability = 1.0;\n\n\t\t\t#ifdef USE_IMPURITY_MAP\n\t\t\t\tfloat impurityProbability = impurityLookUp(lookUpVector);\n\t\t\t\tcurrentProbability -= impurityProbability * impurityScale;\n\t\t\t\t//gl_FragColor = vec4(vec3(impurityProbability), 1.0);\n\t\t\t\t//return;\n\t\t\t#endif\n\t\t\t\n\t\t\t// if(0 == DEPTH) {\n\t\t\t// \tgl_FragColor = vec4(0.5 * newNormal + 0.5, 1.0);\n\t\t\t// \treturn;\n\t\t\t// }\n\n\t\t\ttempColor = vec3(0.0);\n\t\t\tfor(int i = 0; i < DEPTH; i++) {\n\t\t\t\t// small position correction to avoid artefacts\n\t\t\t\tnewPosition = newPosition - lookUpVector * 1e-6;\n\t\t\t\tnewPosition = raySphereIntersection(newPosition, newDirection);\n\t\t\t\tlookUpVector = normalize(newPosition - center);\n\t\t\t\tnewNormal = normalLookUp(lookUpVector);\n\t\t\t\n\t\t\t\tfloat cos_theta = dot(newDirection, newNormal);\n\t\t\t\tfloat ratio;\n\t\t\t\tif(cos_theta > 0.0) {\n\t\t\t\t\tratio = refractionIndex;\n\t\t\t\t} else {\n\t\t\t\t\tcos_theta = -cos_theta;\n\t\t\t\t\tratio = 1.0 / refractionIndex;\n\t\t\t\t}\n\t\t\t\tfloat cos_theta_2 = 1.0 - ratio*ratio * (1.0 - cos_theta*cos_theta);\n\t\t\t\tfloat probability = r_0 + (1.0 - r_0)*pow(1.0 - cos_theta, 5.0);\n\t\t\t\tif(cos_theta_2 < 0.0) probability = 0.0;\n\n\t\t\t\tvec3 refracted = refract(newDirection, newNormal*-1.0, 1.0/refractionIndex);\n\t\t\t\ttempColor += probability * currentProbability * calculateReflectedLight(newPosition, newNormal*-1.0, reflect(refracted, newNormal), material, i);\n\t\t\t\tif(i+1 == DEPTH)\n\t\t\t\t\ttempColor += (1.0 - probability) * currentProbability * calculateReflectedLight(newPosition, newNormal, newDirection, material, i);\n\n\t\t\t\tnewDirection = reflect(newDirection, newNormal);\n\n\t\t\t\t// if(i+1 == DEPTH) {\n\t\t\t\t// \tgl_FragColor = vec4(0.5 * newNormal + 0.5, 1.0);\n\t\t\t\t// \treturn;\n\t\t\t\t// }\n\n\t\t\t\tcurrentProbability *= (1.0 - probability);\n\t\t\t}\n\n\t\t\t#ifdef DISPERSION\n\t\t\t\tif(j == 0) {\n\t\t\t\t\tdispersionColor.r = tempColor.r;\t\n\t\t\t\t} else if(j == 1) {\n\t\t\t\t\tdispersionColor.g = tempColor.g;\t\n\t\t\t\t} else if(j == 2) {\n\t\t\t\t\tdispersionColor.b = tempColor.b;\t\n\t\t\t\t}\n\t\t\t\ttempColor = dispersionColor;\n\t\t\t#endif\n\t\t}\t\n\n\tif(DEPTH > 0)\n\t\toutgoingLight.rgb += (1.0 - initialProbability) * tempColor;\n\n\tfloat alpha = (1.0 - initialProbability) + initialProbability*tracingOpacity;\n\tgl_FragColor = vec4(outgoingLight.rgb, alpha*diffuseColor.a);\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n\n";
module$src$3d$viewports$default$shaders$ShaderFile.default.gem_vert="#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\nvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvarying vec3 frag_position;\nvarying vec3 frag_normal;\n\nvoid main() {\n#include <uv_vertex>\n#include <uv2_vertex>\n#include <color_vertex>\n#include <beginnormal_vertex>\n#include <morphnormal_vertex>\n#include <skinbase_vertex>\n#include <skinnormal_vertex>\n#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\nvNormal = normalize( transformedNormal );\n#endif\n#include <begin_vertex>\n#include <morphtarget_vertex>\n#include <skinning_vertex>\n#include <displacementmap_vertex>\n#include <project_vertex>\n#include <logdepthbuf_vertex>\n#include <clipping_planes_vertex>\nvViewPosition = - mvPosition.xyz;\nvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#include <shadowmap_vertex>\n#include <fog_vertex>\n\nfrag_position = position;\nfrag_normal = objectNormal;\n}\n\n";
module$src$3d$viewports$default$shaders$ShaderFile.default.normal_frag="varying highp vec3 vNormal;\n\nfloat decodeFloat(float f) {\n\tfloat r = mod(f, 1.0/255.0);\n\treturn /*r > 0.5/256.0 ? f + (1.0/256.0) - r : */f - r;\n}\n\nvec3 decodeVec3(vec3 v) {\n\treturn vec3(decodeFloat(v.x), decodeFloat(v.y), decodeFloat(v.z));\n}\n\nfloat signEncoding(vec3 v) {\n\tfloat code = 1.0;\n\t if(v.x < 0.0 && v.y < 0.0 && v.z < 0.0) {\n\t\tcode = 0.0;\n\t} else if (v.x < 0.0 && v.y < 0.0) {\n\t\tcode = 2.0/256.0;\n\t} else if (v.x < 0.0 && v.z < 0.0) {\n\t\tcode = 4.0/256.0;\n\t} else if (v.y < 0.0 && v.z < 0.0) {\n\t\tcode = 6.0/256.0;\n\t} else if (v.x < 0.0) {\n\t\tcode = 8.0/256.0;\n\t} else if (v.y < 0.0) {\n\t\tcode = 10.0/256.0;\n\t} else if (v.z < 0.0) {\n\t\tcode = 12.0/256.0;\n\t}\n\treturn code;\n}\n\nvoid main() {\n\tvec3 n = normalize(vNormal);\n\tgl_FragColor = vec4(decodeVec3(abs(n)), signEncoding(n));\n}\n\n";
module$src$3d$viewports$default$shaders$ShaderFile.default.normal_vert="varying vec3 vNormal;\n\nvoid main() {\nvNormal = normal;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n\n";module$src$3d$viewports$default$shaders$ShaderFile.default.refl_frag="uniform vec3 color;\nuniform sampler2D tDiffuse;\nuniform sampler2D tDepth;\nuniform vec3 worldPosition;\nuniform float far;\nuniform mat4 viewMatrixInv;\nvarying vec4 vUv;\nuniform float threshold;\n\nfloat blendOverlay( float base, float blend ) {\nreturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );\n}\n\nvec3 blendOverlay( vec3 base, vec3 blend ) {\nreturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );\n}\n\nfloat decompress(float a){\nreturn a < .5 ? -a * (far * 2.0) : (a-.5) * (far * 2.0);\n}\n\nvoid main() {\nfloat depth = ((decompress(texture2DProj(tDepth, vUv).a) - worldPosition.z) / far) * (1.0/threshold);\ngl_FragColor = vec4( blendOverlay( texture2DProj( tDiffuse, vUv ).rgb, color ), 1.0 - max(0.0, min(1.0, depth)) );\n}\n\n";
module$src$3d$viewports$default$shaders$ShaderFile.default.refl_vert="uniform mat4 textureMatrix;\nvarying vec4 vUv;\n\nvoid main() {\n\tvUv = textureMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n\n";module$src$3d$viewports$default$shaders$ShaderFile.default.sao_frag="\n#include <common>\n#include <packing>\n\nvarying vec2 vUv;\n\nuniform sampler2D tDepth;\nuniform sampler2D tNormal;\n\nuniform float cameraNear;\nuniform float cameraFar;\nuniform mat4 cameraProjectionMatrix;\nuniform mat4 cameraInverseProjectionMatrix;\n\nuniform vec2 size;\nuniform float intensity;\nuniform float scale;\nuniform float kernelRadius;\n\nvec3 getViewPosition(const in vec2 screenPosition, const in float depth, const in float viewZ) {\n\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];\n\tvec4 clipPosition = vec4((vec3(screenPosition, depth) - 0.5) * 2.0, 1.0);\n\tclipPosition *= clipW; // unprojection\n\n\treturn (cameraInverseProjectionMatrix * clipPosition).xyz;\n}\n\nfloat getOcclusion(const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition) {\n\tvec3 viewDelta = sampleViewPosition - centerViewPosition;\n\tfloat viewDistance = length(viewDelta);\n\tfloat scaledScreenDistance = scale * viewDistance;\n\treturn max(0.0, (dot(centerViewNormal, viewDelta))/scaledScreenDistance)/(1.0 + pow2(scaledScreenDistance));\n}\n\nfloat getAmbientOcclusion(const in vec3 centerViewPosition) {\n\tvec3 centerViewNormal = unpackRGBToNormal(texture2D(tNormal, vUv).xyz);\n\n\tfloat angle = rand(vUv) * PI2;\n\tvec2 radius = vec2(kernelRadius * (1.0/float(SAMPLES)))/size;\n\tvec2 radiusStep = radius;\n\tfloat occlusionSum = 0.0;\n\tfloat weightSum = 0.0;\n\tfloat angleStep = PI2 * 3.0/float(SAMPLES);\n\n\tfor(int i = 0; i < SAMPLES; i ++) {\n\t\tvec2 sampleUv = vUv + vec2(cos(angle), sin(angle)) * radius;\n\t\tradius += radiusStep;\n\t\tangle += PI2 * 3.0/float(SAMPLES);\n\n\t\tfloat sampleDepth = unpackRGBAToDepth(texture2D(tDepth, sampleUv));\n\t\tif(sampleDepth >= (1.0 - EPSILON)) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tfloat sampleViewZ = perspectiveDepthToViewZ(sampleDepth, cameraNear, cameraFar);\n\t\tvec3 sampleViewPosition = getViewPosition(sampleUv, sampleDepth, sampleViewZ);\n\t\tocclusionSum += getOcclusion(centerViewPosition, centerViewNormal, sampleViewPosition);\n\t\tweightSum += 1.0;\n\t}\n\n\tif(weightSum == 0.0) discard;\n\n\treturn occlusionSum * (intensity/weightSum);\n}\n\nvoid main() {\n\tfloat centerDepth = unpackRGBAToDepth(texture2D(tDepth, vUv));\n\tif(centerDepth >= (1.0 - EPSILON)) {\n\t\tdiscard;\n\t}\n\tfloat centerViewZ = perspectiveDepthToViewZ(centerDepth, cameraNear, cameraFar);\n\tvec3 viewPosition = getViewPosition(vUv, centerDepth, centerViewZ);\n\tfloat ao = 1.0 - getAmbientOcclusion(viewPosition);\n\tgl_FragColor = vec4(ao, ao, ao, 1);\n}\n\n";
module$src$3d$viewports$default$shaders$ShaderFile.default.simple_blur_frag="\nuniform sampler2D tDiffuse;\nuniform sampler2D tAO;\t\t\nuniform vec2 size;\nuniform int orientation;\n\nvarying vec2 vUv;\n\nvoid main() {\n\tvec4 sum = vec4( 0.0 );\n\tvec2 or = vec2(0,0);\n\n\tif(orientation==0){\n\t\tor = vec2(1,0);\n\t}else{\n\t\tor = vec2(0,1);\n\t}\n\tvec2 off = vec2(3.2307692308) * or;\n\tsum += texture2D(tAO, vUv) * 0.29411764705882354;\n\tsum += texture2D(tAO, vUv + (off / size)) * 0.35294117647058826;\n\tsum += texture2D(tAO, vUv - (off / size)) * 0.35294117647058826;\n\t\n\tif(orientation == 1){\n\t\tgl_FragColor =  texture2D( tDiffuse, vUv );\n\t\tgl_FragColor.xyz *= sum.x;\n\t}else{\n\t\tgl_FragColor = sum;\n\t}\n}\n\n";
module$src$3d$viewports$default$shaders$ShaderFile.default.standard_frag="#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\nuniform float clearCoat;\nuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\nvarying vec3 vNormal;\n#endif\nvarying vec4 worldPos;\n\nuniform float shadowOpacity;\nuniform float lightReflectivity;\n\nuniform float threeDNoiseScale;\nuniform float threeDNoiseDistanceFade;\nuniform float threeDNoiseOpacity;\nfloat threeDAmbient = 1.0;\n\n#if NUM_ADD_MAPS > 0\nuniform int mapsSize;\nuniform sampler2D additionalMaps0;\n#if NUM_ADD_MAPS > 1\nuniform sampler2D additionalMaps1;\n#endif\n#if NUM_ADD_MAPS > 2\nuniform sampler2D additionalMaps2;\n#endif\n#if NUM_ADD_MAPS > 3\nuniform sampler2D additionalMaps3;\n#endif\n#if NUM_ADD_MAPS > 4\nuniform sampler2D additionalMaps4;\n#endif\nuniform int mapPropertyType[NUM_ADD_MAPS];\nuniform vec3 mapPropertyColor[NUM_ADD_MAPS];\nuniform mat3 uvTransformAddMap[NUM_ADD_MAPS];\nvarying vec2 vUvOriginal;\n#endif\n\n#ifdef USE_RGBMAP\nuniform sampler2D rgbMap;\n#endif\n\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#if defined( USE_MAP )\nvarying vec2 vUvMap;\n#endif\n#if defined( USE_BUMPMAP )\nvarying vec2 vUvBumpMap;\n#endif\n#if defined( USE_NORMALMAP )\nvarying vec2 vUvNormalMap;\n#endif\n#if defined( USE_SPECULARMAP )\nvarying vec2 vUvSpecularMap;\n#endif\n#if defined( USE_ALPHAMAP )\nvarying vec2 vUvAlphaMap;\n#endif\n#if defined( USE_EMISSIVEMAP )\nvarying vec2 vUvEmissiveMap;\n#endif\n#if defined( USE_ROUGHNESSMAP )\nvarying vec2 vUvRoughnessMap;\n#endif\n#if defined( USE_METALNESSMAP )\nvarying vec2 vUvMetalnessMap;\n#endif\n\n\n\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\nvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\nvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n#ifdef ENVMAP_TYPE_CUBE\nvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n#ifdef LOD_BLACK_LIST\nvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n#else\n#ifdef TEXTURE_LOD_EXT\nvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n#else\nvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n#endif\n#endif\nenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\nvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\nvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n#else\nvec4 envMapColor = vec4( 0.0 );\n#endif\nreturn PI * envMapColor.rgb * envMapIntensity;\n}\nfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\nfloat maxMIPLevelScalar = float( maxMIPLevel );\nfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\nreturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n}\nvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n#ifdef ENVMAP_MODE_REFLECTION\nvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n#else\nvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n#endif\nreflectVec = inverseTransformDirection( reflectVec, viewMatrix );\nfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n#ifdef ENVMAP_TYPE_CUBE\nvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n#ifdef LOD_BLACK_LIST\nvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n#else\n#ifdef TEXTURE_LOD_EXT\nvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n#else\nvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n#endif\n#endif\nenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\nvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\nvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n#elif defined( ENVMAP_TYPE_EQUIREC )\nvec2 sampleUV;\nsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\nsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n#ifdef LOD_BLACK_LIST\nvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n#else\n#ifdef TEXTURE_LOD_EXT\nvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n#else\nvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n#endif\n#endif\n\nenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n#elif defined( ENVMAP_TYPE_SPHERE )\nvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n#ifdef LOD_BLACK_LIST\nvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n#else\n#ifdef TEXTURE_LOD_EXT\nvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n#else\nvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n#endif\n#endif\nenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n#endif\nreturn envMapColor.rgb * envMapIntensity;\n}\n#endif\n\n\n\n#include <fog_pars_fragment>\n#ifdef USE_3D_NOISE\n\tvec3 random3(vec3 c) {\n\t\tfloat j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));\n\t\tvec3 r;\n\t\tr.z = fract(512.0*j);\n\t\tj *= .125;\n\t\tr.x = fract(512.0*j);\n\t\tj *= .125;\n\t\tr.y = fract(512.0*j);\n\t\treturn r-0.5;\n\t}\n\n\tconst float F3 =  0.3333333;\n\tconst float G3 =  0.1666667;\n\tfloat snoise(vec3 p) {\n\t\tvec3 s = floor(p + dot(p, vec3(F3)));\n\t\tvec3 x = p - s + dot(s, vec3(G3));\n\t\t\n\t\tvec3 e = step(vec3(0.0), x - x.yzx);\n\t\tvec3 i1 = e*(1.0 - e.zxy);\n\t\tvec3 i2 = 1.0 - e.zxy*(1.0 - e);\n\t\t\t\n\t\tvec3 x1 = x - i1 + G3;\n\t\tvec3 x2 = x - i2 + 2.0*G3;\n\t\tvec3 x3 = x - 1.0 + 3.0*G3;\n\n\t\tvec4 w = vec4(dot(x, x), dot(x1, x1), dot(x2, x2), dot(x3, x3));\t\t\n\t\tw = max(0.6 - w, 0.0);\n\t\tw = w*w*w;\n\n\t\tvec4 d = vec4(dot(random3(s), x), dot(random3(s + i1), x1), dot(random3(s + i2), x2), dot(random3(s + 1.0), x3)) * w;\n\t\treturn dot(d, vec4(52.0));\n\t}\n#endif\n\n#ifdef USE_3D_NOISE_F999\n\tvec3 noise(vec3 m) { return vec3(0); }\n#endif\n\n#ifdef USE_3D_NOISE_F0\n\tvec3 noise(vec3 m) {\n\t\tvec3 i, n;\n\t\ti = m.xzx + m.y;\n\t\tn.x = snoise(i);\n\t\ti = m.yzy + m.x;\n\t\tn.y = snoise(i);\n\t\ti = m.zxy;\n\t\tn.z = snoise(i);\n\t\treturn normalize(n);\n\t}\n#endif\n\n#ifdef USE_3D_NOISE_F1\n\tvec3 noise(vec3 m) {\n\t\tvec3 i = m;\n\t\tm.x = snoise(i);\n\t\ti = vec3(m.yzx);\n\t\tm.y = snoise(i);\n\t\tm.z = cos(m.z*5.0);\n\t\treturn normalize(m);\n\t}\n#endif\n\n#ifdef USE_3D_NOISE_F2\n\tvec3 noise(vec3 m) {\n\t\tm.x = 0.3333333* cos(m.z);\n\t\tm.y = 0.3333333* sin(m.z)+snoise(vec3(m.z));\n\t\tm.z = 0.3333333* cos(m.z*5.0);\n\t\treturn normalize(m);\n\t}\n#endif\n\n#ifdef USE_3D_NOISE_F3\n\tvec3 noise(vec3 m) {\n\t\tvec3 i = vec3( m.z);\n\t\tm.x = 0.1333333* snoise(4.0*i);\n\t\ti = vec3(m.yzx);\n\t\tm.y = 0.05333333* snoise(4.0*i);\n\t\ti = vec3(m.zxy);\n\t\tm.z = 0.1333333* snoise(4.0*i);\n\t\treturn normalize(m);\n\t}\n#endif\n\n\n\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\nuniform float lightWorldSize;\nuniform float lightFrustum;\n\n#if defined(USE_SHADOWMAP)\n#ifdef USE_PCSS_SHADOW\n#define softShadowSamples 20\n#define near 25.0\nvec2 poissonDisk[softShadowSamples];\n\nvoid initPoissonSamples(const in vec2 randomSeed) {\nfloat angleStep = PI2 * 11.0/float(softShadowSamples);\nfloat angle = rand(randomSeed) * PI2;\nfloat radius = 1.0/float(softShadowSamples);\n\nfor(int i = 0; i < softShadowSamples; i ++) {\npoissonDisk[i] = vec2(cos(angle), sin(angle)) * pow(radius, 0.75);\nradius += 1.0/float(softShadowSamples);\nangle += angleStep;\n}\n}\n\nfloat penumbraSize(const in float zReceiver, const in float zBlocker) {\nreturn (zReceiver - zBlocker)/zBlocker;\n}\n\nfloat findBlocker(sampler2D shadowMap, const in vec2 uv, const in float zReceiver) {\nfloat searchRadius = (lightWorldSize/lightFrustum) * (zReceiver - near)/zReceiver;\nfloat blockerDepthSum = 0.0;\nint numBlockers = 0;\n\nfor(int i = 0; i < softShadowSamples; i++) {\nfloat shadowMapDepth = unpackRGBAToDepth(texture2D(shadowMap, uv + poissonDisk[i] * searchRadius));\nif (shadowMapDepth < zReceiver) {\nblockerDepthSum += shadowMapDepth;\nnumBlockers ++;\n}\n}\n\nif(numBlockers == 0) return -1.0;\nreturn blockerDepthSum/float(numBlockers);\n}\n\nfloat PCF_Filter(sampler2D shadowMap, vec2 uv, float zReceiver, float filterRadius) {\nfloat sum = 0.0;\nfor(int i = 0; i < softShadowSamples; i ++) {\nfloat depth = unpackRGBAToDepth(texture2D(shadowMap, uv + poissonDisk[ i ] * filterRadius));\nif(zReceiver <= depth) sum += 1.0;\n}\nfor(int i = 0; i < softShadowSamples; i ++) {\nfloat depth = unpackRGBAToDepth(texture2D(shadowMap, uv + -poissonDisk[ i ].yx * filterRadius));\nif(zReceiver <= depth) sum += 1.0;\n}\nreturn sum/(2.0 * float(softShadowSamples));\n}\n\nfloat PCSS (sampler2D shadowMap, vec4 coords) {\nvec2 uv = coords.xy;\nfloat zReceiver = coords.z;\n\ninitPoissonSamples(uv);\nfloat avgBlockerDepth = findBlocker(shadowMap, uv, zReceiver);\n\nif(avgBlockerDepth == -1.0) return 1.0;\n\nfloat penumbraRatio = penumbraSize(zReceiver, avgBlockerDepth);\nfloat filterRadius = penumbraRatio * (lightWorldSize/lightFrustum) * near/zReceiver;\n\nreturn PCF_Filter(shadowMap, uv, zReceiver, filterRadius);\n}\n#endif\n\n#if NUM_DIR_LIGHTS > 0\nuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\nvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n#endif\n\n\nfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\nreturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n}\nfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\nconst vec2 offset = vec2( 0.0, 1.0 );\nvec2 texelSize = vec2( 1.0 ) / size;\nvec2 centroidUV = floor( uv * size + 0.5 ) / size;\nfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\nfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\nfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\nfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\nvec2 f = fract( uv * size + 0.5 );\nfloat a = mix( lb, lt, f.y );\nfloat b = mix( rb, rt, f.y );\nfloat c = mix( a, b, f.x );\nreturn c;\n}\nfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\nshadowCoord.xyz /= shadowCoord.w;\nshadowCoord.z += shadowBias;\nbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\nbool inFrustum = all( inFrustumVec );\nbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\nbool frustumTest = all( frustumTestVec );\nif ( frustumTest ) {\n#if defined(USE_PCSS_SHADOW)\nreturn PCSS(shadowMap, shadowCoord);\n#elif defined( SHADOWMAP_TYPE_PCF )\nvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\nfloat dx0 = - texelSize.x * shadowRadius;\nfloat dy0 = - texelSize.y * shadowRadius;\nfloat dx1 = + texelSize.x * shadowRadius;\nfloat dy1 = + texelSize.y * shadowRadius;\nreturn (\ntexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\ntexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\ntexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\ntexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\ntexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\ntexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\ntexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\ntexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\ntexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n) * ( 1.0 / 9.0 );\n#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\nvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\nfloat dx0 = - texelSize.x * shadowRadius;\nfloat dy0 = - texelSize.y * shadowRadius;\nfloat dx1 = + texelSize.x * shadowRadius;\nfloat dy1 = + texelSize.y * shadowRadius;\nreturn (\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n) * ( 1.0 / 9.0 );\n#else\nreturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n#endif\n}\nreturn 1.0;\n}\nvec2 cubeToUV( vec3 v, float texelSizeY ) {\nvec3 absV = abs( v );\nfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\nabsV *= scaleToCube;\nv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\nvec2 planar = v.xy;\nfloat almostATexel = 1.5 * texelSizeY;\nfloat almostOne = 1.0 - almostATexel;\nif ( absV.z >= almostOne ) {\nif ( v.z > 0.0 )\nplanar.x = 4.0 - v.x;\n} else if ( absV.x >= almostOne ) {\nfloat signX = sign( v.x );\nplanar.x = v.z * signX + 2.0 * signX;\n} else if ( absV.y >= almostOne ) {\nfloat signY = sign( v.y );\nplanar.x = v.x + 2.0 * signY + 2.0;\nplanar.y = v.z * signY - 2.0;\n}\nreturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n}\nfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\nvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\nvec3 lightToPosition = shadowCoord.xyz;\nvec3 bd3D = normalize( lightToPosition );\nfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\nvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\nreturn (\ntexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\ntexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\ntexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\ntexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\ntexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\ntexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\ntexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\ntexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\ntexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n) * ( 1.0 / 9.0 );\n#else\nreturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n#endif\n}\n#endif\n\n\n#ifdef USE_BUMPMAP\nuniform sampler2D bumpMap;\nuniform float bumpScale;\nvec2 dHdxy_fwd() {\nvec2 dSTdx = dFdx( vUvBumpMap );\nvec2 dSTdy = dFdy( vUvBumpMap );\nfloat Hll = bumpScale * texture2D( bumpMap, vUvBumpMap ).x;\nfloat dBx = bumpScale * texture2D( bumpMap, vUvBumpMap + dSTdx ).x - Hll;\nfloat dBy = bumpScale * texture2D( bumpMap, vUvBumpMap + dSTdy ).x - Hll;\nreturn vec2( dBx, dBy );\n}\nvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\nvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\nvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\nvec3 vN = surf_norm;\nvec3 R1 = cross( vSigmaY, vN );\nvec3 R2 = cross( vN, vSigmaX );\nfloat fDet = dot( vSigmaX, R1 );\nvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\nreturn normalize( abs( fDet ) * surf_norm - vGrad );\n}\n#endif\n\n\n#ifdef USE_NORMALMAP\nuniform sampler2D normalMap;\nuniform vec2 normalScale;\nvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\nvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\nvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\nvec2 st0 = dFdx( vUvNormalMap.st );\nvec2 st1 = dFdy( vUvNormalMap.st );\nvec3 S = normalize( q0 * st1.t - q1 * st0.t );\nvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\nvec3 N = normalize( surf_norm );\nvec3 mapN = texture2D( normalMap, vUvNormalMap ).xyz * 2.0 - 1.0;\nmapN.xy = normalScale * mapN.xy;\nmat3 tsn = mat3( S, T, N );\nreturn normalize( tsn * mapN );\n}\n#endif\n\n\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n#ifdef USE_COLOR\ndiffuseColor.rgb = vColor;\n#endif\n\n\n\n#if NUM_ADD_MAPS > 0\nvec4 texelColorAdd = texture2D( additionalMaps0, (uvTransformAddMap[0] * vec3(vUvOriginal, 1.0)).xy);\ntexelColorAdd = mapTexelToLinear( texelColorAdd );\n\nif(mapPropertyType[0] == 0){\ndiffuseColor = texelColorAdd.a * vec4(texelColorAdd.rgb, 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}else if(mapPropertyType[0] == 1){\ndiffuseColor = texelColorAdd.a * vec4(mapPropertyColor[0], 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}\n#endif\n#if NUM_ADD_MAPS > 1\n\ntexelColorAdd = texture2D( additionalMaps1, (uvTransformAddMap[1] * vec3(vUvOriginal, 1.0)).xy);\ntexelColorAdd = mapTexelToLinear( texelColorAdd );\n\nif(mapPropertyType[1] == 0){\ndiffuseColor = texelColorAdd.a * vec4(texelColorAdd.rgb, 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}else if(mapPropertyType[1] == 1){\ndiffuseColor = texelColorAdd.a * vec4(mapPropertyColor[1], 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}\n\n#endif\n#if NUM_ADD_MAPS > 2\n\ntexelColorAdd = texture2D( additionalMaps2, (uvTransformAddMap[2] * vec3(vUvOriginal, 1.0)).xy);\ntexelColorAdd = mapTexelToLinear( texelColorAdd );\n\nif(mapPropertyType[2] == 0){\ndiffuseColor = texelColorAdd.a * vec4(texelColorAdd.rgb, 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}else if(mapPropertyType[2] == 1){\ndiffuseColor = texelColorAdd.a * vec4(mapPropertyColor[2], 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}\n\n#endif\n#if NUM_ADD_MAPS > 3\n\ntexelColorAdd = texture2D( additionalMaps3, (uvTransformAddMap[3] * vec3(vUvOriginal, 1.0)).xy);\ntexelColorAdd = mapTexelToLinear( texelColorAdd );\n\nif(mapPropertyType[3] == 0){\ndiffuseColor = texelColorAdd.a * vec4(texelColorAdd.rgb, 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}else if(mapPropertyType[3] == 1){\ndiffuseColor = texelColorAdd.a * vec4(mapPropertyColor[3], 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}\n\n#endif\n#if NUM_ADD_MAPS > 4\n\ntexelColorAdd = texture2D( additionalMaps4, (uvTransformAddMap[4] * vec3(vUvOriginal, 1.0)).xy);\ntexelColorAdd = mapTexelToLinear( texelColorAdd );\n\nif(mapPropertyType[4] == 0){\ndiffuseColor = texelColorAdd.a * vec4(texelColorAdd.rgb, 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}else if(mapPropertyType[4] == 1){\ndiffuseColor = texelColorAdd.a * vec4(mapPropertyColor[4], 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}\n\n#endif\n\n#ifdef USE_MAP\nvec4 texelColor = texture2D( map, vUvMap );\ntexelColor = mapTexelToLinear( texelColor );\n\ndiffuseColor *= texelColor;\n#endif\n\n\n#ifdef USE_ALPHAMAP\ndiffuseColor.a *= texture2D( alphaMap, vUvAlphaMap ).g;\n#endif\n\n\n\t#include <alphatest_fragment>\nfloat roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n#ifdef USE_RGBMAP\nvec4 texelRoughness = texture2D( rgbMap, vUvRoughnessMap );\n#else\nvec4 texelRoughness = texture2D( roughnessMap, vUvRoughnessMap );\n#endif\nroughnessFactor *= texelRoughness.g;\n#endif\n\n\nfloat metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n#ifdef USE_RGBMAP\nvec4 texelMetalness = texture2D( rgbMap, vUvMetalnessMap );\n#else\nvec4 texelMetalness = texture2D( metalnessMap, vUvMetalnessMap );\n#endif\nmetalnessFactor *= texelMetalness.b;\n#endif\n\n\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n#ifdef USE_3D_NOISE\nvec3 threeDNoise = noise(worldPos.xyz / threeDNoiseScale);\nfloat op = threeDNoiseOpacity * (1.0 / (1.0 + vViewPosition.z * threeDNoiseDistanceFade));\nfloat dotP = dot(normal, threeDNoise);\nif(dotP < 0.0) threeDNoise *= -1.0;\n\ndotP = abs(dotP);\n\nnormal = (1.0 - op) * normal + op * threeDNoise;\nroughnessFactor += ((1.0 - roughnessFactor) * (1.0 - dotP)) * op;\nmetalnessFactor *= (1.0 - dotP * op);\n\nthreeDAmbient = min(1.0, (1.0 - op) + dotP * op);\ndiffuseColor.rgb *= min(1.0, (1.0 - op) + dotP * op);\n#endif\n\n\n\t#include <lights_physical_fragment>\n\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\nfloat invShadowAmount;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t// #ifdef USE_SHADOWMAP\n\t        // directLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t// #endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t//#ifdef USE_SHADOWMAP\n\t\t//#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\ninvShadowAmount = all(bvec2(directionalLight.shadow, directLight.visible)) ? getShadow(directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ]) : 1.0;\ndirectLight.color *= min((invShadowAmount + (1.0 - shadowOpacity)), 1.0);\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif\n\n\n\n#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#else\nvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\nreflectVec = inverseTransformDirection( reflectVec, viewMatrix );\nradiance += (vec3((reflectVec.z + 1.0) / 2.0) + 0.5) / 1.5;\n#endif\n\n\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\n\t#ifdef USE_3D_NOISE\n\t\treflectedLight.indirectDiffuse *= threeDAmbient;\n#endif\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular * lightReflectivity + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n\n\n";
module$src$3d$viewports$default$shaders$ShaderFile.default.standard_vert="#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nvarying vec4 worldPos;\n#include <common>\n#if defined( USE_MAP )\nvarying vec2 vUvMap;\nuniform mat3 uvTransformMap;\n#endif\n#if defined( USE_BUMPMAP )\nvarying vec2 vUvBumpMap;\nuniform mat3 uvTransformBumpMap;\n#endif\n#if defined( USE_NORMALMAP )\nvarying vec2 vUvNormalMap;\nuniform mat3 uvTransformNormalMap;\n#endif\n#if defined( USE_SPECULARMAP )\nvarying vec2 vUvSpecularMap;\nuniform mat3 uvTransformSpecularMap;\n#endif\n#if defined( USE_ALPHAMAP )\nvarying vec2 vUvAlphaMap;\nuniform mat3 uvTransformAlphaMap;\n#endif\n#if defined( USE_EMISSIVEMAP )\nvarying vec2 vUvEmissiveMap;\nuniform mat3 uvTransformEmissiveMap;\n#endif\n#if defined( USE_ROUGHNESSMAP )\nvarying vec2 vUvRoughnessMap;\nuniform mat3 uvTransformRoughnessMap;\n#endif\n#if defined( USE_METALNESSMAP )\nvarying vec2 vUvMetalnessMap;\nuniform mat3 uvTransformMetalnessMap;\n#endif\n\n#if NUM_ADD_MAPS > 0\nvarying vec2 vUvOriginal;\nuniform int mapsSize;\n#endif\n\n\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t// #if NUM_SPOT_LIGHTS > 0\n\t// \tuniform mat4 spotShadowMatrix[ 0 ];\n\t// \tvarying vec4 vSpotShadowCoord[ 0 ];\n\t// #endif\n\t// #if NUM_POINT_LIGHTS > 0\n\t// \tuniform mat4 pointShadowMatrix[ 0 ];\n\t// \tvarying vec4 vPointShadowCoord[ 0 ];\n\t// #endif\n#endif\n\n\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n#if defined( USE_MAP )\n\tvUvMap = (uvTransformMap * vec3(uv, 1)).xy;\n#endif\n#if defined( USE_BUMPMAP )\nvUvBumpMap = (uvTransformBumpMap * vec3(uv, 1)).xy;\n#endif\n#if defined( USE_NORMALMAP )\nvUvNormalMap = (uvTransformNormalMap * vec3(uv, 1)).xy;\n#endif\n#if defined( USE_SPECULARMAP )\n\tvUvSpecularMap = (uvTransformSpecularMap * vec3(uv, 1)).xy;\n#endif\n#if defined( USE_ALPHAMAP )\n\tvUvAlphaMap = (uvTransformAlphaMap * vec3(uv, 1)).xy;\n#endif\n#if defined( USE_EMISSIVEMAP )\n\tvUvEmissiveMap = (uvTransformEmissiveMap * vec3(uv, 1)).xy;\n#endif\n#if defined( USE_ROUGHNESSMAP )\n\tvUvRoughnessMap = (uvTransformRoughnessMap * vec3(uv, 1)).xy;\n#endif\n#if defined( USE_METALNESSMAP )\n\tvUvMetalnessMap = (uvTransformMetalnessMap * vec3(uv, 1)).xy;\n#endif\n\n#if NUM_ADD_MAPS > 0\n\tvUvOriginal = uv;\n#endif\n\n\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t// #if NUM_SPOT_LIGHTS > 0\n\t// #pragma unroll_loop\n\t// for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t// \tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t// }\n\t// #endif\n\t// #if NUM_POINT_LIGHTS > 0\n\t// #pragma unroll_loop\n\t// for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t// \tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t// }\n\t// #endif\n#endif\n\n\n\tworldPos = worldPosition;\n}\n\n";
module$src$3d$viewports$default$shaders$ShaderFile.default.world_z_frag="varying vec4 position_VS;\nuniform float far;\n\nfloat compress(float a){\nreturn a < 0.0 ? -a / (2.0 * far) : a / (2.0 * far) + .5;\n}\n\nvoid main() {\n\tgl_FragColor = vec4(1,1,1, compress(position_VS.z));\n}\n\n";module$src$3d$viewports$default$shaders$ShaderFile.default.world_z_vert="varying vec4 position_VS;\n\nvoid main() {\nposition_VS = modelMatrix * vec4( position, 1.0 );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n\n";var module$src$3d$viewports$default$materials$Reflector={},THREE$$module$src$3d$viewports$default$materials$Reflector=module$src$externals$three.default,Shaders$$module$src$3d$viewports$default$materials$Reflector=module$src$3d$viewports$default$shaders$ShaderFile.default;module$src$externals$three.default=module$src$externals$three.default;
module$src$externals$three.default.Reflector=function(a,b){module$src$externals$three.default.Mesh.call(this,a);this.type="Reflector";var c=this;b=b||{};a=void 0!==b.color?new module$src$externals$three.default.Color(b.color):new module$src$externals$three.default.Color(8355711);var g=b.textureWidth||512,d=b.textureHeight||512,f=b.clipBias||0,p=void 0!==b.recursion?b.recursion:0,e=new module$src$externals$three.default.Plane,m=new module$src$externals$three.default.Vector3,h=new module$src$externals$three.default.Vector3,
r=new module$src$externals$three.default.Vector3,q=new module$src$externals$three.default.Matrix4,t=new module$src$externals$three.default.Vector3(0,0,-1),u=new module$src$externals$three.default.Vector4,n=new module$src$externals$three.default.Vector4,l=new module$src$externals$three.default.Vector3,v=new module$src$externals$three.default.Vector3,x=new module$src$externals$three.default.Vector4,w=new module$src$externals$three.default.Matrix4,y=new module$src$externals$three.default.PerspectiveCamera,
z=new module$src$externals$three.default.WebGLRenderTarget(g,d,{minFilter:module$src$externals$three.default.LinearFilter,magFilter:module$src$externals$three.default.LinearFilter,format:module$src$externals$three.default.RGBFormat,stencilBuffer:!1});module$src$externals$three.default.Math.isPowerOfTwo(g)&&module$src$externals$three.default.Math.isPowerOfTwo(d)||(z.texture.generateMipmaps=!1);b={uniforms:{color:{type:"c",value:null},tDiffuse:{type:"t",value:null},tDepth:{type:"t",value:null},textureMatrix:{type:"m4",
value:null},worldPosition:{type:"v3",value:new module$src$externals$three.default.Vector3(0,0,0)},far:{type:"f",value:1},threshold:{type:"f",value:100}},fragmentShader:module$src$3d$viewports$default$shaders$ShaderFile.default.refl_frag,vertexShader:module$src$3d$viewports$default$shaders$ShaderFile.default.refl_vert};var B=new module$src$externals$three.default.ShaderMaterial(b),A=new module$src$externals$three.default.ShaderMaterial({uniforms:{far:{type:"f",value:1}},vertexShader:module$src$3d$viewports$default$shaders$ShaderFile.default.world_z_vert,
fragmentShader:module$src$3d$viewports$default$shaders$ShaderFile.default.world_z_frag}),D=new module$src$externals$three.default.WebGLRenderTarget(g,d,{minFilter:module$src$externals$three.default.NearestFilter,magFilter:module$src$externals$three.default.NearestFilter,format:module$src$externals$three.default.RGBAFormat,type:module$src$externals$three.default.FloatType});B.uniforms.tDiffuse.value=z.texture;B.uniforms.tDepth.value=D.texture;B.uniforms.color.value=a;B.uniforms.textureMatrix.value=
w;B.uniforms.worldPosition.value=h;B.uniforms.threshold.value=c.threshold=.01;this.material=B;this.material.transparent=!0;this.onBeforeRender=function(a,b,d){if("recursion"in d.userData){if(d.userData.recursion===p)return;d.userData.recursion++}B.uniforms.threshold.value=c.threshold;A.uniforms.far.value=d.far;B.uniforms.far.value=d.far;h.setFromMatrixPosition(c.matrixWorld);r.setFromMatrixPosition(d.matrixWorld);q.extractRotation(c.matrixWorld);m.set(0,0,1);m.applyMatrix4(q);l.subVectors(h,r);if(!(0<
l.dot(m))){l.reflect(m).negate();l.add(h);q.extractRotation(d.matrixWorld);t.set(0,0,-1);t.applyMatrix4(q);t.add(r);v.subVectors(h,t);v.reflect(m).negate();v.add(h);y.position.copy(l);y.up.set(0,1,0);y.up.applyMatrix4(q);y.up.reflect(m);y.lookAt(v);y.far=d.far;y.updateMatrixWorld();y.projectionMatrix.copy(d.projectionMatrix);y.userData.recursion=0;w.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);w.multiply(y.projectionMatrix);w.multiply(y.matrixWorldInverse);w.multiply(c.matrixWorld);e.setFromNormalAndCoplanarPoint(m,
h);e.applyMatrix4(y.matrixWorldInverse);u.set(e.normal.x,e.normal.y,e.normal.z,e.constant);var g=y.projectionMatrix;x.x=(Math.sign(u.x)+g.elements[8])/g.elements[0];x.y=(Math.sign(u.y)+g.elements[9])/g.elements[5];x.z=-1;x.w=(1+g.elements[10])/g.elements[14];u.multiplyScalar(2/u.dot(x));g.elements[2]=u.x;g.elements[6]=u.y;g.elements[10]=u.z+1-f;g.elements[14]=u.w;c.visible=!1;g=b.background;b.background=null;var E=a.getRenderTarget(),H=a.vr.enabled,I=a.shadowMap.autoUpdate,G=a.getClearColor().getHex(),
N=a.getClearAlpha();a.vr.enabled=!1;a.shadowMap.autoUpdate=!1;a.render(b,y,z,!0);a.setClearColor(16777215,1);b.overrideMaterial=A;a.render(b,y,D,!0);a.vr.enabled=H;a.shadowMap.autoUpdate=I;a.setClearColor(G,N);b.overrideMaterial=null;a.setRenderTarget(E);b.background=g;b=d.bounds;void 0!==b&&(d=a.getSize(),g=a.getPixelRatio(),n.x=b.x*d.width*g,n.y=b.y*d.height*g,n.z=b.z*d.width*g,n.w=b.w*d.height*g,a.state.viewport(n));c.visible=!0}};this.getRenderTarget=function(){return z}};
module$src$externals$three.default.Reflector.prototype=Object.create(module$src$externals$three.default.Mesh.prototype);module$src$externals$three.default.Reflector.prototype.constructor=module$src$externals$three.default.Reflector;var module$src$3d$viewports$default$passes$SSAAPass={},THREE$$module$src$3d$viewports$default$passes$SSAAPass=module$src$externals$three.default,Shaders$$module$src$3d$viewports$default$passes$SSAAPass=module$src$3d$viewports$default$shaders$ShaderFile.default;
module$src$3d$viewports$default$passes$SSAAPass.default=function(a){var b=new module$src$externals$three.default.ShaderMaterial({uniforms:{tDiffuse:{value:null},opacity:{value:1}},attributes:["position","uv"],vertexShader:module$src$3d$viewports$default$shaders$ShaderFile.default.basic_vert,fragmentShader:module$src$3d$viewports$default$shaders$ShaderFile.default.copy_frag});b.premultipliedAlpha=!0;b.transparent=!0;b.blending=module$src$externals$three.default.AdditiveBlending;b.depthTest=!1;b.depthWrite=
!1;var c=new module$src$externals$three.default.OrthographicCamera(-1,1,1,-1,0,1),g=new module$src$externals$three.default.Scene,d=new module$src$externals$three.default.Mesh(new module$src$externals$three.default.PlaneGeometry(2,2),b);d.frustumCulled=!1;g.add(d);var f=new module$src$externals$three.default.WebGLRenderTarget(a.width,a.height,{minFilter:module$src$externals$three.default.LinearFilter,magFilter:module$src$externals$three.default.LinearFilter,format:module$src$externals$three.default.RGBAFormat});
f.texture.name="SSAAPass.sample";var p=[[[0,0]],[[4,4],[-4,-4]],[[-2,-6],[6,-2],[-6,2],[2,6]],[[1,-3],[-1,3],[5,1],[-3,-5],[-5,5],[-7,-1],[3,7],[7,-7]],[[1,1],[-1,-3],[-3,2],[4,-1],[-5,-2],[2,5],[5,3],[3,-5],[-2,6],[0,-7],[-4,-6],[-6,4],[-8,0],[7,-4],[6,7],[-7,-8]],[[-4,-7],[-7,-5],[-3,-5],[-5,-4],[-1,-4],[-2,-2],[-6,-1],[-4,0],[-7,1],[-1,2],[-6,3],[-3,3],[-7,6],[-3,6],[-5,7],[-1,7],[5,-7],[1,-6],[6,-5],[4,-4],[2,-3],[7,-2],[1,-1],[4,-1],[2,1],[6,2],[0,4],[4,4],[2,5],[7,5],[5,6],[3,7]]];this.render=
function(a,m,h,r,q){d=new module$src$externals$three.default.Mesh(new module$src$externals$three.default.PlaneGeometry(2,2),b);d.frustumCulled=!1;g.children.length=0;g.add(d);var e=p[Math.max(0,Math.min(q,5))];q=a.autoClear;a.autoClear=!1;var u=a.getClearColor().getHex(),n=a.getClearAlpha(),l=1/e.length;b.uniforms.tDiffuse.value=f.texture;e.forEach(function(d,q){var p=l;h.setViewOffset&&h.setViewOffset(r.width,r.height,.0625*d[0],.0625*d[1],r.width,r.height);p+=.03125*(-.5+(q+.5)/e.length);b.uniforms.opacity.value=
p;a.setClearColor(u,n);a.render(m,h,f,!0);0===q&&a.setClearColor(0,0);a.render(g,c,r,0===q)});g.remove(d);d.geometry.dispose();d=void 0;h.clearViewOffset&&h.clearViewOffset();a.autoClear=q;a.setClearColor(u,n)};this.dispose=function(){f&&(f.dispose(),f=null)};this.setSize=function(a,b){f.setSize(a,b)}};var module$src$3d$viewports$default$passes$SaoPass={},THREE$$module$src$3d$viewports$default$passes$SaoPass=module$src$externals$three.default,Shaders$$module$src$3d$viewports$default$passes$SaoPass=module$src$3d$viewports$default$shaders$ShaderFile.default;
module$src$3d$viewports$default$passes$SaoPass.default=function(a){function b(a,b){for(var c=[],d=0;d<=b;d++)c.push(Math.exp(-(d*d)/(2*a*a))/(Math.sqrt(2*Math.PI)*a));return c}function c(a){q.uniforms.cameraNear.value=a.near;q.uniforms.cameraFar.value=a.far;q.uniforms.cameraProjectionMatrix.value=a.projectionMatrix;q.uniforms.cameraInverseProjectionMatrix.value.getInverse(a.projectionMatrix,!0);n.uniforms.cameraNear.value=a.near;n.uniforms.cameraFar.value=a.far;l.uniforms.cameraNear.value=a.near;
l.uniforms.cameraFar.value=a.far}var g=a.settings,d=new module$src$externals$three.default.MeshDepthMaterial;d.depthPacking=module$src$externals$three.default.RGBADepthPacking;d.blending=module$src$externals$three.default.NoBlending;d.side=module$src$externals$three.default.DoubleSide;var f=new module$src$externals$three.default.MeshNormalMaterial;f.blending=module$src$externals$three.default.NoBlending;f.side=module$src$externals$three.default.DoubleSide;var p=new module$src$externals$three.default.WebGLRenderTarget(a.width,
a.height,{minFilter:module$src$externals$three.default.NearestFilter,magFilter:module$src$externals$three.default.NearestFilter,format:module$src$externals$three.default.RGBAFormat}),e=p.clone(),m=p.clone(),h=p.clone(),r={defines:{SAMPLES:g.getSetting("samples")},uniforms:{tDepth:{type:"t",value:null},tNormal:{type:"t",value:null},cameraNear:{type:"f",value:1},cameraFar:{type:"f",value:100},cameraProjectionMatrix:{type:"m4",value:new module$src$externals$three.default.Matrix4},cameraInverseProjectionMatrix:{type:"m4",
value:new module$src$externals$three.default.Matrix4},scale:{type:"f",value:.1},kernelRadius:{type:"f",value:g.getSetting("kernelRadius")},size:{type:"v2",value:new module$src$externals$three.default.Vector2(a.width,a.height)},intensity:{type:"f",value:g.getSetting("intensity")}},attributes:["position","uv"],vertexShader:module$src$3d$viewports$default$shaders$ShaderFile.default.basic_vert,fragmentShader:module$src$3d$viewports$default$shaders$ShaderFile.default.sao_frag},q=new module$src$externals$three.default.ShaderMaterial(r);
q.uniforms.tDepth.value=e.texture;q.uniforms.tNormal.value=m.texture;q.needsUpdate=!1;r={KERNEL_RADIUS:g.getSetting("kernelRadius")};a={tAO:{type:"t",value:null},tDiffuse:{type:"t",value:null},tDepth:{type:"t",value:null},size:{type:"v2",value:new module$src$externals$three.default.Vector2(a.width,a.height)},sampleWeights:{type:"1fv",value:b(g.getSetting("standardDev"),g.getSetting("kernelRadius"))},orientation:{type:"i",value:0},cameraNear:{type:"f",value:10},cameraFar:{type:"f",value:1E3}};var t=
module$src$3d$viewports$default$shaders$ShaderFile.default.basic_vert,u=module$src$3d$viewports$default$shaders$ShaderFile.default.blur_frag,n=new module$src$externals$three.default.ShaderMaterial({uniforms:module$src$externals$three.default.UniformsUtils.clone(a),defines:r,vertexShader:t,fragmentShader:u});n.uniforms.tAO.value=p.texture;n.uniforms.tDepth.value=e.texture;n.uniforms.orientation.value=0;var l=new module$src$externals$three.default.ShaderMaterial({uniforms:module$src$externals$three.default.UniformsUtils.clone(a),
defines:r,vertexShader:t,fragmentShader:u});l.uniforms.tAO.value=h.texture;l.uniforms.tDepth.value=e.texture;l.uniforms.orientation.value=1;var v=new module$src$externals$three.default.OrthographicCamera(-1,1,1,-1,0,1),x=new module$src$externals$three.default.Scene,w=new module$src$externals$three.default.Mesh(new module$src$externals$three.default.PlaneGeometry(2,2),null);x.add(w);this.render=function(a,b,g,r,t){c(g);b.traverse(function(a){a.material&&!a.material.renderAO&&(a.wasItVisible=a.visible,
a.visible=!1)});l.uniforms.tDiffuse.value=r.texture;r=b.background;b.background=null;var u=a.getClearColor().getHex(),A=a.getClearAlpha();a.setClearColor(16777215);b.overrideMaterial=d;a.render(b,g,e,!0);a.setClearColor(7829503);b.overrideMaterial=f;a.render(b,g,m,!0);a.setClearColor(u,A);w.material=q;a.render(x,v,p,!0);w.material=n;a.render(x,v,h,!0);w.material=l;a.render(x,v,t,!0);b.overrideMaterial=null;b.background=r;b.traverse(function(a){a.material&&!a.material.renderAO&&(a.visible=a.wasItVisible)})};
g.registerHook("samples",function(a){q.defines.samples=a;q.needsUpdate=!0});g.registerHook("intensity",function(a){q.uniforms.intensity.value=a});g.registerHook("kernelRadius",function(a){n.defines.KERNEL_RADIUS=a;l.defines.KERNEL_RADIUS=a;n.uniforms.sampleWeights.value=b(g.getSetting("standardDev"),a);l.uniforms.sampleWeights.value=b(g.getSetting("standardDev"),a);n.needsUpdate=!0;l.needsUpdate=!0});g.registerHook("standardDev",function(a){n.uniforms.sampleWeights.value=b(a,g.getSetting("kernelRadius"));
l.uniforms.sampleWeights.value=b(a,g.getSetting("kernelRadius"))});this.setSize=function(a,b){q.uniforms.size.value.set(a,b);n.uniforms.size.value.set(a,b);l.uniforms.size.value.set(a,b);p.setSize(a,b);e.setSize(a,b);m.setSize(a,b);h.setSize(a,b)}};var module$src$3d$viewports$default$handlers$BeautyRenderHandler={default:function(a,b){var c=a.settings,g=a.scene,d=a.renderer,f,p=d.getPixelRatio(),e=d.getSize().width*p,m=d.getSize().height*p,h=!1,r=!1,q,t,u,n,l,v,x,w,y,z=0,B,A,D;p=function(){f=this;/(android)/i.test(navigator.userAgent)&&-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&(h=!0);r=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;q=new module$src$3d$viewports$default$passes$SSAAPass.default({width:e,height:m});
t=new module$src$3d$viewports$default$passes$SaoPass.default({settings:c.getSection("sao"),width:e,height:m});u=new module$src$externals$three.default.WebGLRenderTarget(e,m,{minFilter:module$src$externals$three.default.LinearFilter,magFilter:module$src$externals$three.default.LinearFilter,format:module$src$externals$three.default.RGBAFormat,stencilBuffer:!1});u.texture.name="hidden.rt";n=u.clone();n.texture.name="standard.rt";l=u.clone();l.texture.name="ssaa.rt";v=u.clone();v.texture.name="ao.rt";
x=new module$src$externals$three.default.ShaderMaterial({uniforms:{tStandard:{value:null},tBeauty:{value:null},size:{type:"v2",value:new module$src$externals$three.default.Vector2(512,512)},amount:{type:"f",value:0}},attributes:["position","uv"],vertexShader:module$src$3d$viewports$default$shaders$ShaderFile.default.basic_vert,fragmentShader:module$src$3d$viewports$default$shaders$ShaderFile.default.blend_frag});x.uniforms.tStandard.value=n.texture;x.uniforms.tBeauty.value=l.texture;x.uniforms.size.value.set(e,
m);x.uniforms.amount.value=0;B=new module$src$externals$three.default.OrthographicCamera(-1,1,1,-1,0,1);A=new module$src$externals$three.default.Scene;D=new module$src$externals$three.default.Mesh(new module$src$externals$three.default.PlaneGeometry(2,2),x);A.add(D)};p.prototype._setToggleSoftShadows=function(a){for(var c=b.threeDManager.helpers.getMeshMaterialObjects(),d=b.threeDManager._getExchangeMeshMaterialObjects(),e=0,l=c.length;e<l;e++){var n=c[e].mesh,f=c[e].material,h=void 0;if("ShapeDiverStandardMaterial"===
f.type&&n.geometry&&"TextGeometry"!==n.geometry.type){for(var g=-1,m=0,r=d.length;m<r;m++)if(d[m].mesh===n){g=m;h=d[m].material;break}-1===g&&(h=b.materialHandler.getMaterial(),h.deepCopy(f),h.defines.USE_PCSS_SHADOW="",h.softShadow=!0,g=d.length,d.push({mesh:n,material:h}));if(f.softShadow!==a){c[e].material=h;d[g].material=f;n.material=h;for(var q in f)"uuid"!==q&&"defines"!==q&&"vertexShader"!==q&&"fragmentShader"!==q&&"softShadow"!==q&&n.material[q]!==f[q]&&(n.material[q]=f[q]);for(var p in n.material.defines)"USE_PCSS_SHADOW"===
p||n.material.defines[p]&&f.defines[p]||(delete n.material.defines[p],n.material.needsUpdate=!0);for(var t in f.defines)"USE_PCSS_SHADOW"===t||n.material.defines[t]&&f.defines[t]||(n.material.defines[t]=f.defines[t],n.material.needsUpdate=!0)}}}};p.prototype._startBlending=function(a,e){b.renderingHandler.registerForContinuousRendering("beautyRenderBlending");w=performance.now();z=0;x.uniforms.tStandard.value=a.texture;x.uniforms.tBeauty.value=e.texture;c.getSetting("shadows")&&f._setToggleSoftShadows(!1);
d.render(g,b.cameraHandler.getCamera(),u,!0)};p.prototype.renderStandard=function(){d.render(g,b.cameraHandler.getCamera())};p.prototype.renderBeauty=function(a){var e=c.getSetting("shadows"),h=c.getSetting("ambientOcclusion");d.render(g,b.cameraHandler.getCamera());q.render(d,g,b.cameraHandler.getCamera(),n,2);e&&f._setToggleSoftShadows(!0);h&&!r?(e=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC),b.threeDManager.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_RENDER_BEAUTY_START,
e),q.render(d,g,b.cameraHandler.getCamera(),l,2),t.render(d,g,b.cameraHandler.getCamera(),l,v),a&&d.render(g,b.cameraHandler.getCamera(),u,!0),f._startBlending(n,v)):e?(e=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC),b.threeDManager.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_RENDER_BEAUTY_START,e),q.render(d,g,b.cameraHandler.getCamera(),l,2),a&&d.render(g,b.cameraHandler.getCamera(),
u,!0),f._startBlending(n,l)):d.render(g,b.cameraHandler.getCamera())};p.prototype.renderBlending=function(){x.uniforms.amount.value=z;d.render(A,B,null,!0);y=performance.now();var a=(y-w)/1E3;w=y;z+=Math.min(a/1.5,.1);1<=z&&(z=0,b.renderingHandler.unregisterForContinuousRendering("beautyRenderBlending"),a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC),b.threeDManager.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_RENDER_BEAUTY_END,
a))};p.prototype.renderHidden=function(){b.threeDManager&&b.cameraHandler&&b.cameraHandler.getCamera()&&(b.threeDManager.helpers.toggleViewport(!0),d.render(g,b.cameraHandler.getCamera(),u),b.threeDManager.helpers.toggleViewport(!1))};p.prototype.updateCustomUniforms=function(){g.traverse(function(a){if(a.material)if("ShapeDiverStandardMaterial"===a.material.type){a.material.uniforms.lightWorldSize.value=a.material.lightWorldSize;a.material.uniforms.lightFrustum.value=a.material.lightFrustum;a.material.uniforms.shadowOpacity.value=
a.material.shadowOpacity;a.material.uniforms.lightReflectivity.value=a.material.lightReflectivity;a.material.uniforms.rgbMap.value=a.material.rgbMap;a.material.uniforms.threeDNoiseOpacity.value=a.material.threeDNoiseOpacity;a.material.uniforms.threeDNoiseID.value=a.material.threeDNoiseID;a.material.uniforms.threeDNoiseScale.value=a.material.threeDNoiseScale;a.material.uniforms.threeDNoiseDistanceFade.value=a.material.threeDNoiseDistanceFade;if(0<a.material.threeDNoiseOpacity&&""!==a.material.defines["USE_3D_NOISE_F"+
a.material.threeDNoiseID]&&(0<=a.material.threeDNoiseID&&3>=a.material.threeDNoiseID||999===a.material.threeDNoiseID)){for(var b in a.material.defines)0===b.indexOf("USE_3D_NOISE_F")&&delete a.material.defines[b];a.material.defines["USE_3D_NOISE_F"+a.material.threeDNoiseID]="";a.material.needsUpdate=!0}if(0<a.material.threeDNoiseOpacity&&""!==a.material.defines.USE_3D_NOISE)a.material.defines.USE_3D_NOISE="",a.material.needsUpdate=!0,-1===a.material.threeDNoiseID&&(a.material.threeDNoiseID=0,a.material.uniforms.threeDNoiseID.value=
a.material.threeDNoiseID,a.material.defines.USE_3D_NOISE_F0="");else if(0>=a.material.threeDNoiseOpacity&&""===a.material.defines.USE_3D_NOISE){for(var c in a.material.defines)0===c.indexOf("USE_3D_NOISE_F")&&delete a.material.defines[c];delete a.material.defines.USE_3D_NOISE;a.material.needsUpdate=!0}a.material.map&&(a.material.uniforms.uvTransformMap.value=a.material.map.uvTransform,a.material.map.matrix.identity());a.material.specularMap&&(a.material.uniforms.uvTransformSpecularMap.value=a.material.specularMap.uvTransform,
a.material.specularMap.matrix.identity());a.material.normalMap&&(a.material.uniforms.uvTransformNormalMap.value=a.material.normalMap.uvTransform,a.material.normalMap.matrix.identity());a.material.bumpMap&&(a.material.uniforms.uvTransformBumpMap.value=a.material.bumpMap.uvTransform,a.material.bumpMap.matrix.identity());a.material.roughnessMap&&(a.material.uniforms.uvTransformRoughnessMap.value=a.material.roughnessMap.uvTransform,a.material.roughnessMap.matrix=new module$src$externals$three.default.Matrix3);
a.material.metalnessMap&&(a.material.uniforms.uvTransformMetalnessMap.value=a.material.metalnessMap.uvTransform,a.material.metalnessMap.matrix=new module$src$externals$three.default.Matrix3);a.material.alphaMap&&(a.material.uniforms.uvTransformAlphaMap.value=a.material.alphaMap.uvTransform,a.material.alphaMap.matrix.identity());a.material.emissiveMap&&(a.material.uniforms.uvTransformEmissiveMap.value=a.material.emissiveMap.uvTransform,a.material.emissiveMap.matrix.identity());if(0!==a.material.mapsSize){a.material.uniforms.mapsSize.value=
a.material.mapsSize;0<a.material.mapsSize&&a.material.defines.NUM_ADD_MAPS!==a.material.mapsSize&&(a.material.defines.NUM_ADD_MAPS=a.material.mapsSize,a.material.needsUpdate=!0);for(;5>a.material.mapPropertyType.length;)a.material.mapPropertyType.push(-1);for(;5>a.material.mapPropertyColor.length;)a.material.mapPropertyColor.push(new module$src$externals$three.default.Color(0));for(;5>a.material.uvTransformAddMap.length;)a.material.uvTransformAddMap.push((new module$src$externals$three.default.Matrix3).identity());
a.material.uniforms.mapPropertyType.value=a.material.mapPropertyType;a.material.uniforms.mapPropertyColor.value=a.material.mapPropertyColor;a.material.uniforms.uvTransformAddMap.value=a.material.uvTransformAddMap;b=0;for(c=a.material.mapsSize;b<c;b++)0===b&&(a.material.uniforms.additionalMaps0.value=a.material.additionalMaps0),1===b&&(a.material.uniforms.additionalMaps1.value=a.material.additionalMaps1),2===b&&(a.material.uniforms.additionalMaps2.value=a.material.additionalMaps2),3===b&&(a.material.uniforms.additionalMaps3.value=
a.material.additionalMaps3),4===b&&(a.material.uniforms.additionalMaps4.value=a.material.additionalMaps4)}else a.material.uniforms.mapsSize.value=0,0!==a.material.defines.NUM_ADD_MAPS&&(a.material.defines.NUM_ADD_MAPS=0,a.material.needsUpdate=!0);h&&""!==a.material.defines.LOD_BLACK_LIST&&(a.material.defines.LOD_BLACK_LIST="",a.material.needsUpdate=!0)}else"ShapeDiverGemMaterial"===a.material.type&&(a.material.uniforms.refractionIndex.value=a.material.refractionIndex,a.material.uniforms.center.value=
a.material.center,a.material.uniforms.radius.value=a.material.radius,a.material.uniforms.sphericalNormalMap.value=a.material.sphericalNormalMap,a.material.uniforms.dispersion.value=a.material.dispersion,a.material.uniforms.contrast.value=a.material.contrast,a.material.uniforms.gamma.value=a.material.gamma,a.material.uniforms.brightness.value=a.material.brightness,a.material.uniforms.tracingOpacity.value=a.material.tracingOpacity,a.material.uniforms.impurityMap.value=a.material.impurityMap,a.material.uniforms.impurityScale.value=
a.material.impurityScale,a.material.uniforms.colorTransferBegin.value=a.material.colorTransferBegin,a.material.uniforms.colorTransferEnd.value=a.material.colorTransferEnd,a.material.inverseModelMatrix=(new module$src$externals$three.default.Matrix4).getInverse(a.matrixWorld),a.material.uniforms.inverseModelMatrix.value=a.material.inverseModelMatrix,a.material.inverseTransposeModelMatrix=(new module$src$externals$three.default.Matrix3).getNormalMatrix((new module$src$externals$three.default.Matrix4).getInverse(a.matrixWorld).transpose()),
a.material.uniforms.inverseTransposeModelMatrix.value=a.material.inverseTransposeModelMatrix,a.material.defines.DEPTH!=a.material.depth&&(a.material.defines.DEPTH=a.material.depth,a.material.needsUpdate=!0),""===a.material.defines.DISPERSION&&0===a.material.dispersion&&(delete a.material.defines.DISPERSION,a.material.needsUpdate=!0),""!==a.material.defines.DISPERSION&&0!==a.material.dispersion&&(a.material.defines.DISPERSION="",a.material.needsUpdate=!0),""===a.material.defines.USE_IMPURITY_MAP&&
null===a.material.impurityMap&&(delete a.material.defines.USE_IMPURITY_MAP,a.material.needsUpdate=!0),""!==a.material.defines.USE_IMPURITY_MAP&&null!==a.material.impurityMap&&(a.material.defines.USE_IMPURITY_MAP="",a.material.needsUpdate=!0))})};p.prototype.setSize=function(a,b){var c=d.getPixelRatio();a*=c;b*=c;t.setSize(a,b);q.setSize(a,b);u.setSize(a,b);n.setSize(a,b);l.setSize(a,b);v.setSize(a,b);x.uniforms.size.value.set(a,b)};return new p(a)}};var module$src$3d$viewports$default$handlers$RenderingHandler={default:function(a,b){var c=a.settings,g=a.scene,d=a.geometryNode,f=a.container,p=["startUpId"],e=[],m=[],h,r=f.offsetWidth,q=f.offsetHeight,t=0,u=!1,n,l,v=!1,x=!1,w=-1,y=null,z=null,B=!0,A=!1,D=function(a,b,c){b!==c&&h.render()},H=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",b.threeDManager.warn,"RenderingHandler.Hook->shadows"))return!1;b.lightHandler.setToggleLightShadows(a);return!0},G=function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,
"boolean",b.threeDManager.warn,"RenderingHandler.Hook->ambientOcclusion")?!0:!1},E=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"color",b.threeDManager.warn,"RenderingHandler.Hook->clearColor"))return!1;a=(0,module$src$shared$util$toTinyColor.default)(a);null!==z?l.setClearColor(a.toThreeColor(),z):l.setClearColor(a.toThreeColor());h.render();return!0},J=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"notnegative",b.threeDManager.warn,"RenderingHandler.Hook->clearAlpha"))return!1;
z=a;l.setClearAlpha(a);h.render();return!0},F=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"notnegative",b.threeDManager.warn,"RenderingHandler.Hook->pointSize"))return!1;g.traverse(function(b){b.hasOwnProperty("material")&&b instanceof module$src$externals$three.default.Points&&(b.material.size=a)});h.render();return!0},C=function(){module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.call(this);h=this;n=new module$src$3d$helpers$handlers$RenderingHandlerHelpers.default(b);
var a=n.createWebGLRenderer(f,{antialias:!0,alpha:!0,preserveDrawingBuffer:!0});b.threeDManager.success=a.success;n.handleCreateWebGLRendererResponse("RenderingHandler",a,"WebGL context was created","WebGL context could not be created");if(!1===a.success)return null;l=a.renderer;l.setPixelRatio(window.devicePixelRatio);l.setSize(r,q,!0);l.setClearColor((0,module$src$shared$util$toTinyColor.default)(c.getSetting("clearColor"),"white").toThreeColor(),c.getSetting("clearAlpha"));l.shadowMap.enabled=
!0;l.shadowMap.autoUpdate=!1;l.shadowMap.needsUpdate=!0;l.shadowMap.type=module$src$externals$three.default.PCFShadowMap;l.gammaFactor=1;l.gammaInput=!1;l.gammaOutput=!0;l.textureUnitCount=a.renderer.context.getParameter(a.renderer.context.MAX_TEXTURE_IMAGE_UNITS);l.textureUnitCount||(l.textureUnitCount=8);l.depth=!1;window.onresize=function(){-1===w&&h.registerForContinuousRendering("registeredResizeEvent");clearTimeout(w);w=setTimeout(function(){w=-1;h.unregisterForContinuousRendering("registeredResizeEvent");
h.render()},250)};b.beautyRenderHandler=new module$src$3d$viewports$default$handlers$BeautyRenderHandler.default({settings:c,scene:g,geometryNode:d,renderer:l},b);b.threeDManager.beautyRenderHandler=b.beautyRenderHandler;b.threeDManager.viewerApi.state.addEventListener(b.threeDManager.viewerApi.state.EVENTTYPE.BUSY,function(){-1===m.indexOf("busyMode")&&h.registerForContinuousRendering("busyMode")});b.threeDManager.viewerApi.state.addEventListener(b.threeDManager.viewerApi.state.EVENTTYPE.IDLE,function(){h.unregisterForContinuousRendering("busyMode")});
requestAnimationFrame(h._tweenAnimate);c.registerNotifier("shadows",D);c.registerNotifier("ambientOcclusion",D);c.registerHook("shadows",H);c.registerHook("ambientOcclusion",G);c.registerHook("clearColor",E);c.registerHook("clearAlpha",J);c.registerHook("pointSize",F)};$jscomp.inherits(C,module$src$3d$interfaces$handlers$RenderingHandlerInterface.default);C.prototype._resizeEvent=function(){h.registerForContinuousRendering("unregisteredResizeEvent",!1);setTimeout(function(){h.unregisterForContinuousRendering("unregisteredResizeEvent")},
100)};C.prototype._beforeRender=function(){l.clear();if(document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||document.mozFullScreenElement){var a=!0;if("true"==l.domElement.getAttribute("sdv-fullscreen")||null==l.domElement.parentNode){var c=screen.width;var d=screen.height}else c=l.domElement.parentNode.offsetWidth,d=l.domElement.parentNode.offsetHeight}else a=!1,c=l.domElement.parentNode.offsetWidth,d=l.domElement.parentNode.offsetHeight;if(c!==r||d!==q||!1!==
a)h._resizeEvent(),r=c,q=d,l.setSize(r,q,!0),b.cameraHandler.onResize(r,q),b.beautyRenderHandler.setSize(r,q);b.beautyRenderHandler.updateCustomUniforms();if(!0===v||!0===x)v=!1,l.shadowMap.needsUpdate=!0};C.prototype._evaluateCurrentRenderMode=function(a){0===e.length&&1===m.length&&a&&-1!==m.indexOf("beautyRenderBlending")?t=2:0===e.length&&0===m.length?!0===A?(t=1,A=!1):(t=0,h.registerForContinuousRendering("beautyRenderDelay",!1),setTimeout(function(){A=!0;h.unregisterForContinuousRendering("beautyRenderDelay")},
c.getSetting("beautyRenderDelay"))):t=0};C.prototype._tweenAnimate=function(a){requestAnimationFrame(h._tweenAnimate);module$node_modules$$tweenjs$tween_js$src$Tween.default.update(a)};C.prototype._processContinuousRenderingList=function(a){!b.cameraHandler||!a&&u||(b.cameraHandler.updateOrbitControls(),0<m.length||0==t?(u=!0,h.render(!0,"continuous"),requestAnimationFrame(function(){h._processContinuousRenderingList(!0)})):u=!1)};C.prototype._getExtension=function(a){return l.extensions.get(a)};
C.prototype._getTextureUnitCount=function(){return l.textureUnitCount};C.prototype.render=function(a,c){!(b.threeDManager&&l.domElement&&!1!==b.threeDManager.getSetting("show")&&b.cameraHandler&&B&&0==p.length)||a&&0!=e.length||u&&"continuous"!==c||(h._evaluateCurrentRenderMode(a),0==t?(requestAnimationFrame(function(a){b.threeDManager&&(h._beforeRender(a),b.threeDManager.helpers.toggleViewport(!0,a),b.beautyRenderHandler.renderStandard(),n.processAnchors(l,g,b.cameraHandler.getCamera(),b.threeDManager.helpers.getAnchors()),
b.threeDManager.helpers.toggleViewport(!1,a))}),-1!==m.indexOf("beautyRenderBlending")&&(h.unregisterForContinuousRendering("beautyRenderBlending"),c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC),b.threeDManager.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_RENDER_BEAUTY_CANCEL,c))):2==t?requestAnimationFrame(function(a){b.threeDManager&&(h._beforeRender(a),b.threeDManager.helpers.toggleViewport(!0,
a),b.beautyRenderHandler.renderBlending(),b.threeDManager.helpers.toggleViewport(!1,a))}):1==t&&requestAnimationFrame(function(c){!b.threeDManager||0<m.length||(h._beforeRender(c),b.threeDManager.helpers.toggleViewport(!0,c),b.beautyRenderHandler.renderBeauty(!a),n.processAnchors(l,g,b.cameraHandler.getCamera(),b.threeDManager.helpers.getAnchors()),b.threeDManager.helpers.toggleViewport(!1,c))}))};C.prototype.renderHidden=function(){b.beautyRenderHandler.renderHidden()};C.prototype.onResize=function(a,
b){l.setSize(a,b)};C.prototype.getSize=function(){return l.getSize()};C.prototype.pause=function(){B=!1};C.prototype.resume=function(){B=!0};C.prototype.destroy=function(){l.dispose();try{l.forceContextLoss()}catch(I){}};C.prototype.getScreenshot=function(){return l.domElement.toDataURL("image/png")};C.prototype.getDomElement=function(){return l.domElement};C.prototype.getCanvas=function(){return l.context.canvas};C.prototype.getRendererInfo=function(){return l.info};C.prototype.setBlur=function(a,
b){null!=b&&b.hasOwnProperty("duration")?(y=y||Promise.resolve(),y=y.then(function(){var c={r:a?0:3};return new Promise(function(d){(new module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween(c)).to({r:a?3:1},b.duration).onUpdate(function(){l.domElement.style.filter="blur("+c.r+"px)"}).onComplete(function(){l.domElement.style.filter=a?"blur(3px)":"";d()}).start()})})):y=(y||Promise.resolve()).then(function(){l.domElement.style.filter=a?"blur(3px)":""})};C.prototype.registerForNoRendering=function(a,
b){void 0!==a&&(void 0===b&&(b=!1),b&&h.render(),p.push(a))};C.prototype.unregisterForNoRendering=function(a){a=p.indexOf(a);-1<a&&p.splice(a,1);0==p.length&&h.render()};C.prototype.registerForRestrictedRendering=function(a,b){void 0!==a&&(void 0===b&&(b=!1),e.push(a),b&&h.render())};C.prototype.unregisterForRestrictedRendering=function(a){a=e.indexOf(a);-1<a&&e.splice(a,1)};C.prototype.registerForContinuousRendering=function(a,b){void 0!==a&&(void 0===b&&(b=!0),m.includes("cameraMoving")&&"cameraMoving"===
a||(m.push(a),b&&h._processContinuousRenderingList()))};C.prototype.unregisterForContinuousRendering=function(a){a=m.indexOf(a);-1<a&&m.splice(a,1)};C.prototype.containsContinuousRendering=function(a){return-1===m.indexOf(a)?!1:!0};C.prototype.updateShadowMap=function(){v=!0};C.prototype.keepUpdatingShadowMap=function(){x=!0};C.prototype.stopUpdatingShadowMap=function(){x=!1};C.prototype.getRenderer=function(){return l};return new C(a)}};var module$src$shared$materials$MaterialPresetsDbFallback={default:{}};module$src$shared$materials$MaterialPresetsDbFallback.default["00"]={"00":{name:"Default material",color:[211,211,211,255],metalness:0,roughness:1},properties:{name:"Default materials"}};module$src$shared$materials$MaterialPresetsDbFallback.default["01"]={"01":{name:"Default groundplane material",color:[211,211,211,255],metalness:0,roughness:1},properties:{name:"Groundplane materials"}};
module$src$shared$materials$MaterialPresetsDbFallback.default["02"]={"00":{name:"Default plastic material",color:[211,211,211,255],metalness:0,roughness:1,normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},properties:{name:"Plastic materials"}};
module$src$shared$materials$MaterialPresetsDbFallback.default["03"]={10:{name:"Gold material",color:[230,207,92,255],roughness:1},11:{name:"Used gold material",color:[230,207,92,255],roughness:0,roughnesstexture:"roughnessMap.jpg"},21:{name:"Hammered metal material",color:[205,205,205,255],roughness:1,normaltexture:"normalMap.jpg"},"00":{name:"Default metal material",color:[205,205,205,255],roughness:.25},"01":{name:"Used metal material 1",color:[205,205,205,255],roughness:1,roughnesstexture:"roughnessMap.jpg"},
"02":{name:"Used metal material 2",color:[205,205,205,255],roughness:1,roughnesstexture:"roughnessMap.jpg"},"03":{name:"Used metal material 3",color:[205,205,205,255],roughness:1,roughnesstexture:"roughnessMap.jpg"},properties:{name:"Metal materials",metalness:1}};module$src$shared$materials$MaterialPresetsDbFallback.default["04"]={"00":{name:"Default glass material",color:[211,211,211,255],metalness:1,roughness:0,transparency:.75},properties:{name:"Glass materials"}};
module$src$shared$materials$MaterialPresetsDbFallback.default["05"]={10:{bitmaptexture:"map.jpg",name:"Natural oak material",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},11:{bitmaptexture:"map.jpg",name:"Premium oak material",roughnesstexture:"roughnessMap.jpg"},"00":{bitmaptexture:"map.jpg",name:"Default wood material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},"01":{bitmaptexture:"map.jpg",name:"Wood floor material",
metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},properties:{name:"Wood materials",color:[211,211,211,255],metalness:0,roughness:1}};
module$src$shared$materials$MaterialPresetsDbFallback.default["06"]={10:{bitmaptexture:"map.jpg",name:"Worn leather material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},"00":{bitmaptexture:"map.jpg",name:"Default leather material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},"01":{bitmaptexture:"map.jpg",name:"Dark brown leather material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",
roughnesstexture:"roughnessMap.jpg"},"02":{bitmaptexture:"map.jpg",name:"Black leather material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},properties:{name:"Leather materials",metalness:0,roughness:1}};
module$src$shared$materials$MaterialPresetsDbFallback.default["07"]={"00":{bitmaptexture:"map.jpg",name:"Default fabric material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},"01":{bitmaptexture:"map.jpg",name:"Grey fabric material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},properties:{name:"Fabric materials",metalness:1,roughness:1}};var module$src$shared$materials$MaterialPresets={},GLOBAL_UTILS$$module$src$shared$materials$MaterialPresets=module$src$shared$util$GlobalUtils.default,AXIOS$$module$src$shared$materials$MaterialPresets=module$src$externals$axios.default,VIEWERAPPCONSTANTS$$module$src$shared$materials$MaterialPresets=module$src$app$ViewerAppConstants.default,TEXTURE_PATH$$module$src$shared$materials$MaterialPresets="https://viewer.shapediver.com/v2/materials/",MATERIAL_PRESETS_URL$$module$src$shared$materials$MaterialPresets=
"https://viewer.shapediver.com/v2/materials/db.json",MATERIAL_PRESETS_DB_FALLBACK$$module$src$shared$materials$MaterialPresets=module$src$shared$materials$MaterialPresetsDbFallback.default,RESOLUTIONS$$module$src$shared$materials$MaterialPresets=["256","512","1024","2048"],DEFAULTRESOLUTION$$module$src$shared$materials$MaterialPresets="1024",MaterialPresets$$module$src$shared$materials$MaterialPresets=function(){var a=this,b={},c=function(a){var b=/^\d+$/;Object.keys(a).forEach(function(c){Object.keys(a[c]).forEach(function(d){b.test(c)&&
b.test(d)&&f(c,d,a[c],a[c][d])})})},g=module$src$externals$axios.default.get(MATERIAL_PRESETS_URL$$module$src$shared$materials$MaterialPresets).then(function(a){c(a.data)},function(){c(module$src$shared$materials$MaterialPresetsDbFallback.default)}),d=function(a){"string"!==typeof a&&(a=String(a));return a.padStart(2,"0").slice(0,2)},f=function(a,c,f,h){a=d(a);c=d(c);var e={};Object.keys(f.properties).forEach(function(a){e[a]=f.properties[a]});Object.keys(h).forEach(function(a){e[a]=h[a]});e.version=
e.version||"2.0";b.hasOwnProperty(a)||(b[a]={});b[a][c]={name:e.name,mat:e}};a.hasMaterial=function(a,c){a=d(a);c=d(c);return b.hasOwnProperty(a)&&b[a].hasOwnProperty(c)?!0:!1};a.getMaterial=function(a,c,f){a=d(a);c=d(c);f=f||DEFAULTRESOLUTION$$module$src$shared$materials$MaterialPresets;var e=module$src$shared$util$GlobalUtils.default.deepCopy(b[a][c].mat),g=TEXTURE_PATH$$module$src$shared$materials$MaterialPresets+f+"/"+a+"/"+c+"/";"bitmap metalness roughness bump normal transparency".split(" ").forEach(function(a){a+=
"texture";e.hasOwnProperty(a)&&(e[a]=g+e[a])});return e};a.fromId=function(b){return new Promise(function(c,d){g.then(function(){var d;if("string"===typeof b){var e=b.split("@");b=e[0];1<e.length&&(d=e[1])}RESOLUTIONS$$module$src$shared$materials$MaterialPresets.includes(d)||(d=DEFAULTRESOLUTION$$module$src$shared$materials$MaterialPresets);b=Number(b);100>b&&0==b%10&&(b/=10);10>b&&(b*=100);e=Math.floor(b/100);var f=b-100*e;a.hasMaterial(e,f)?c(a.getMaterial(e,f,d)):a.hasMaterial(e,0)?c(a.getMaterial(e,
0,d)):a.hasMaterial(0,0)?c(a.getMaterial(0,0,d)):c(module$src$app$ViewerAppConstants.default.defaultSettings.defaultMaterial)},function(a){d(a)})})};return a};module$src$shared$materials$MaterialPresets.default=new MaterialPresets$$module$src$shared$materials$MaterialPresets;var module$src$shared$materials$MaterialPropertiesStandard={},THREE$$module$src$shared$materials$MaterialPropertiesStandard=module$src$externals$three.default,toTinyColor$$module$src$shared$materials$MaterialPropertiesStandard=module$src$shared$util$toTinyColor.default;
module$src$shared$materials$MaterialPropertiesStandard.default=function(){var a=this;a.alphaMap=null;a.additionalMaps=[];a.mapPropertyType=[];a.mapPropertyColor=[];a.uvTransformAddMap=[];a.bumpMap=null;a.bumpScale=1;a.color=(0,module$src$shared$util$toTinyColor.default)("ffffffff").toThreeColor();a.flatShading=!1;a.lightReflectivity=1;a.map=null;a.metalness=0;a.metalnessMap=null;a.normalMap=null;a.opacity=1;a.roughness=.5;a.roughnessMap=null;a.shadowOpacity=1;a.side=module$src$externals$three.default.DoubleSide;
a.threeDNoiseOpacity=0;a.threeDNoiseID=0;a.threeDNoiseScale=1;a.threeDNoiseDistanceFade=0;a.transparent=!1;a.clone=function(){var b=new module$src$shared$materials$MaterialPropertiesStandard.default;b.alphaMap=a.alphaMap;b.additionalMaps=a.additionalMaps;b.mapPropertyType=a.mapPropertyType;b.mapPropertyColor=a.mapPropertyColor;b.uvTransformAddMap=a.uvTransformAddMap;b.bumpMap=a.bumpMap;b.bumpScale=a.bumpScale;b.color=a.color;b.flatShading=a.flatShading;b.lightReflectivity=a.lightReflectivity;b.map=
a.map;b.metalness=a.metalness;b.metalnessMap=a.metalnessMap;b.normalMap=a.normalMap;b.opacity=a.opacity;b.roughness=a.roughness;b.roughnessMap=a.roughnessMap;b.shadowOpacity=a.shadowOpacity;b.side=a.side;b.threeDNoiseOpacity=a.threeDNoiseOpacity;b.threeDNoiseID=a.threeDNoiseID;b.threeDNoiseScale=a.threeDNoiseScale;b.threeDNoiseDistanceFade=a.threeDNoiseDistanceFade;b.transparent=a.transparent;return b}};var module$src$shared$materials$MaterialPropertiesGem={},toTinyColor$$module$src$shared$materials$MaterialPropertiesGem=module$src$shared$util$toTinyColor.default;
module$src$shared$materials$MaterialPropertiesGem.default=function(){var a=this;a.materialType="gem";a.colorTransferBegin=(0,module$src$shared$util$toTinyColor.default)("ffffffff").toThreeColor();a.colorTransferEnd=(0,module$src$shared$util$toTinyColor.default)("ffffffff").toThreeColor();a.environmentMap=null;a.impurityMap=null;a.impurityScale=1;a.opacity=1;a.tracingOpacity=1;a.depth=8;a.refractionIndex=2.4;a.dispersion=0;a.gamma=1;a.contrast=1;a.brightness=0;a.resolution=1024;a.clone=function(){var b=
new module$src$shared$materials$MaterialPropertiesGem.default;b.materialType="gem";b.colorTransferBegin=a.colorTransferBegin;b.colorTransferEnd=a.colorTransferEnd;b.environmentMap=a.environmentMap;b.impurityMap=a.impurityMap;b.impurityScale=a.impurityScale;b.opacity=a.opacity;b.tracingOpacity=a.tracingOpacity;b.depth=a.depth;b.refractionIndex=a.refractionIndex;b.dispersion=a.dispersion;b.gamma=a.gamma;b.contrast=a.contrast;b.brightness=a.brightness;b.resolution=a.resolution;return b}};var module$src$shared$materials$MaterialParser={},THREE$$module$src$shared$materials$MaterialParser=module$src$externals$three.default,MATERIAL_PRESETS$$module$src$shared$materials$MaterialParser=module$src$shared$materials$MaterialPresets.default,toTinyColor$$module$src$shared$materials$MaterialParser=module$src$shared$util$toTinyColor.default,loadTexture$$module$src$shared$materials$MaterialParser=module$src$shared$singletons$TextureLoader.default.loadTexture,GlobalUtils$$module$src$shared$materials$MaterialParser=
module$src$shared$util$GlobalUtils.default,MaterialPropertiesStandard$$module$src$shared$materials$MaterialParser=module$src$shared$materials$MaterialPropertiesStandard.default,MaterialPropertiesGem$$module$src$shared$materials$MaterialParser=module$src$shared$materials$MaterialPropertiesGem.default;
module$src$shared$materials$MaterialParser.default=function(){var a=function(a){"string"===typeof a&&(a={href:a});if(!a.hasOwnProperty("href")&&!a.hasOwnProperty("canvas"))return Promise.reject(Error("Input object is not a valid JSON texture definition."));var b={};b.offset=a.offset||[0,0];b.repeat=a.repeat||[1,1];b.rotation=a.rotation||0;b.center=a.center||[0,0];b.color=a.color||null;return(0,module$src$shared$singletons$TextureLoader.default.loadTexture)(a.href||a.canvas,b).then(function(a){if(b.color){var c=
(0,module$src$shared$util$toTinyColor.default)(b.color);c&&c.isValid()&&(a.SDColor=c)}return a},function(a){return Promise.reject(a)})},b=function(a){if(void 0===a)return Promise.reject(Error("Input object is not a valid JSON cube texture definition."));if("string"===typeof a||Array.isArray(a))a={href:a};var b="px nx pz nz py ny".split(" ");if(module$src$shared$util$GlobalUtils.default.typeCheck(a.href,"string")&&a.href.startsWith('["https')&&a.href.endsWith('"]')){var c=a.href;try{a.href=JSON.parse(c)}catch(m){a.href=
c}}if(Array.isArray(a.href)){var d=a.href;if(6!==d.length)return Promise.reject(Error("Input object is not a valid JSON cube texture definition."))}if(void 0===d)if(d=[],a.href.startsWith("https://")||a.href.startsWith("http://"))for(a.href.endsWith("/")||(a.href+="/"),c=0;c<b.length;c++)d.push(a.href+b[c]+".jpg");else return Promise.reject(Error("Input object is not a valid JSON cube texture definition."));return new Promise(function(a,b){(new module$src$externals$three.default.CubeTextureLoader).load(d,
function(b){a(b)},null,function(){b(Error("Input object is not a valid JSON cube texture definition."))})})},c=function(b,c){if(-1==["1.0","2.0","3.0"].indexOf(c))return Promise.reject(Error("Material definition has unknown version."));var d=new module$src$shared$materials$MaterialPropertiesStandard.default;"1.0"===c&&(null!=b.shine&&(b.metalness=Math.min(1,b.shine)),null!=b.shine&&(b.roughness=1-Math.min(1,b.shine)),b.hasOwnProperty("diffuse")&&!b.hasOwnProperty("color")&&(b.color=b.diffuse));"metalness roughness alphaThreshold shadowOpacity lightReflectivity transparency bumpAmplitude".split(" ").forEach(function(a){if(b.hasOwnProperty(a)){var c=
parseFloat(b[a]);if(!isNaN(c)&&isFinite(c))switch(a){case "transparency":d.opacity=1-c;d.transparent=0<c;break;case "bumpAmplitude":d.bumpScale=c;break;default:d[a]=c}}});["color"].forEach(function(a){if(b.hasOwnProperty(a)){var c=(0,module$src$shared$util$toTinyColor.default)(b[a]);c&&c.isValid()&&(d[a]=c.toThreeColor())}});b.hasOwnProperty("threeDNoise")&&(d.threeDNoiseOpacity=b.threeDNoise.opacity||0,d.threeDNoiseID=b.threeDNoise.noiseID||0,d.threeDNoiseScale=b.threeDNoise.scale||1,d.threeDNoiseDistanceFade=
b.threeDNoise.distance||0);var e=[];if(b.hasOwnProperty("bitmaptexture"))if(Array.isArray(b.bitmaptexture)){if(0===b.bitmaptexture.length)return Promise.resolve(null);c=[];for(var f=$jscomp.makeIterator(b.bitmaptexture),h=f.next();!h.done;h=f.next())c.push(a(h.value));e.push(Promise.all(c).then(function(a){if(1<a.length){d.additionalMaps=[];d.mapPropertyType=[];d.mapPropertyColor=[];d.uvTransformAddMap=[];for(var b=1,c=a.length;b<c;++b){var e=a[b];d.additionalMaps.push(e);d.mapPropertyType.push(e.hasOwnProperty("SDColor")?
1:0);var n=e.hasOwnProperty("SDColor")&&e.SDColor?e.SDColor.toThreeColor():new module$src$externals$three.default.Color;d.mapPropertyColor.push(n);d.uvTransformAddMap.push(e.uvTransform)}}return d.map=a[0]}))}else e.push(a(b.bitmaptexture).then(function(a){return d.map=a}));["metalness","roughness","bump","normal","transparency"].forEach(function(c){b.hasOwnProperty(c+"texture")&&e.push(a(b[c+"texture"]).then(function(a){"transparency"===c?(d.alphaMap=a,d.transparent=!0):d[c+"Map"]=a}))});return Promise.all(e).then(function(){d._json=
b;return d})},g=function(a){var c=new module$src$shared$materials$MaterialPropertiesGem.default;["depth","resolution"].forEach(function(b){if(a.hasOwnProperty(b)){var d=parseInt(a[b]);!isNaN(d)&&isFinite(d)&&("resolution"===b?d&d-1||(c[b]=d):c[b]=d)}});"impurityScale tracingTransparency transparency dispersion refractionIndex gamma contrast brightness".split(" ").forEach(function(b){if(a.hasOwnProperty(b)){var d=parseFloat(a[b]);if(!isNaN(d)&&isFinite(d))switch(b){case "tracingTransparency":c.tracingOpacity=
1-d;break;case "transparency":c.opacity=1-d;break;default:c[b]=d}}});["colorTransferBegin","colorTransferEnd"].forEach(function(b){if(a.hasOwnProperty(b)){var d=(0,module$src$shared$util$toTinyColor.default)(a[b]);d&&d.isValid()&&(c[b]=d.toThreeColor())}});var d=[];["impurity","environment"].forEach(function(e){a.hasOwnProperty(e+"texture")&&d.push(b(a[e+"texture"]).then(function(a){c[e+"Map"]=a}))});return Promise.all(d).then(function(){c._json=a;return c})};this.fromJSONMaterialObject=function(a){var b=
"standard";a.hasOwnProperty("materialType")&&(b=a.materialType);return"gem"===b?(a.hasOwnProperty("version")||(a.version="1.0"),g(a)):a.hasOwnProperty("version")?a.hasOwnProperty("materialpreset")?new Promise(function(b,d){module$src$shared$materials$MaterialPresets.default.fromId(a.materialpreset).then(function(d){d=module$src$shared$util$GlobalUtils.default.deepCopy(d);!a.hasOwnProperty("color")||255===parseInt(a.color[0])&&255===parseInt(a.color[1])&&255===parseInt(a.color[2])||(d.color=a.color);
a.hasOwnProperty("bitmaptexture")&&(d.bitmaptexture=a.bitmaptexture);a.hasOwnProperty("bumptexture")&&(d.bumptexture=a.bumptexture);b(c(d,"2.0"))},function(a){d(a)})}):c(a,a.version):Promise.reject(Error("Material definition did not have version number defined"))}};var module$src$3d$viewports$default$handlers$MaterialHandler={default:function(a,b){var c=a.pathUtils,g="default default_bw blurred_lights georgentor georgentor_blur georgentor_blue_blur georgentor_bw_blur levelsets lythwood_field mountains ocean piazza_san_marco residential_garden room_abstract_1 sky storage_room storm subway_entrance subway_entrance_bw_blur white yokohama".split(" "),d=[],f="px nx pz nz py ny".split(" "),p=a.settings,e,m,h,r=null,q=[],t=!1,u=.005,n=6.5,l=0,v,x={},w=function(a,c){if(void 0===
a)return b.threeDManager.warn("MaterialHandler.setEnvironmentMap","No input was provided, the environment map was not set."),Promise.resolve(!1);if("none"===a)return e._assignEnvironmentMap({name:"none",map:null}),Promise.resolve(!0);if(module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")&&a.startsWith('["https')&&a.endsWith('"]')){var l=a;try{a=JSON.parse(l)}catch(C){a=l}}c=c||p.getSetting("environmentMapResolution");if(module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")){var n=
a.toLowerCase().replace(/ /g,"_");var h=n+c}else if(Array.isArray(a)){var m=a;if(6!==m.length)return b.threeDManager.warn("MaterialHandler.setEnvironmentMap","The number of URLs was not 6, the environment map was not set."),Promise.resolve(!1);h=n=JSON.stringify(m,null,0)}l=$jscomp.makeIterator(q);for(var r=l.next();!r.done;r=l.next())if(r=r.value,r.name===h)return e._assignEnvironmentMap(r),Promise.resolve(!0);if(void 0===m)if(m=[],0<=g.indexOf(n))for(l=0;l<f.length;l++)m.push("https://viewer.shapediver.com/v2/envmaps/"+
c+"/"+n+"/"+f[l]+".jpg");else if(0<=d.indexOf(n))for(l=0;l<f.length;l++)m.push("https://viewer.shapediver.com/v2/envmaps/"+c+"/"+n+"/"+f[l]+".png");else if(a.startsWith("https://")||a.startsWith("http://"))for(a.endsWith("/")||(a+="/"),l=0;l<f.length;l++)m.push(a+f[l]+".jpg");else return"none"!==a&&b.threeDManager.warn("MaterialHandler.setEnvironmentMap","Environment map name not found, and not a base URL",a),Promise.resolve(!1);return e._loadEnvironmentMap(h,m).then(function(a){q.push(a);e._assignEnvironmentMap(a);
return!0},function(){b.threeDManager.warn("MaterialHandler.setEnvironmentMap","Was not able to load the environment map, the environment map was not set.");return!1})},y=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",b.threeDManager.warn,"MaterialHandler.Hook->environmentMapAsBackground"))return!1;if(b.threeDManager.getSetting("groundPlaneReflectionVisibility")&&a)return b.threeDManager.warn("MaterialHandler.Hook->environmentMapAsBackground","The ground plane reflection and the environment as background do not work together right now."),
!1;h=a?r:null;b.renderingHandler.render();return!0},z=function(a){if(!["256","512","1024","2048"].includes(a))return b.threeDManager.warn("MaterialHandler.setEnvironmentMapResolution","No valid input was provided, the environment map was not changed."),Promise.resolve(!1);var c=p.getSetting("environmentMap");return"none"===c?!0:w(c,a)},B=function(){module$src$3d$interfaces$handlers$MaterialHandlerInterface.default.call(this);e=this;m=new module$src$3d$helpers$handlers$MaterialHandlerHelpers.default(b,
{nameStandard:"ShapeDiverStandardMaterial",nameSimple:"MeshPhongMaterial"});b.renderingHandler._getExtension("EXT_shader_texture_lod")||(t=!0);l=b.renderingHandler._getTextureUnitCount();p.registerHook("environmentMap",function(a){return w(a)});p.updateSettingAsync("environmentMap",p.getSetting("environmentMap"));p.registerHook("environmentMapAsBackground",y);p.registerHook("environmentMapResolution",z)};$jscomp.inherits(B,module$src$3d$interfaces$handlers$MaterialHandlerInterface.default);B.prototype._loadEnvironmentMap=
function(a,b){return new Promise(function(c,d){(new module$src$externals$three.default.CubeTextureLoader).load(b,function(b){b.format=module$src$externals$three.default.RGBFormat;b.mapping=module$src$externals$three.default.CubeReflectionMapping;t&&(b.generateMipmaps=!1,b.minFilter=module$src$externals$three.default.LinearFilter,b.magFilter=module$src$externals$three.default.LinearFilter);c({name:a,map:b})},null,function(a){d(a)})})};B.prototype._assignEnvironmentMap=function(a){p.getSetting("environmentMapAsBackground")&&
(h=a.map);for(var c=b.threeDManager.helpers.getMaterials(),d=0,e=c.length;d<e;d++){var l=c[d];"ShapeDiverStandardMaterial"==l.type?l.envMap=a.map:"ShapeDiverGemMaterial"!=l.type||l.customEnvMap||(l.envMap=a.map)}r=a.map;b.renderingHandler.render()};B.prototype._changeNoiseFunction=function(a){var c=b.threeDManager.helpers.getMeshMaterialObjects(),d;var e=0;for(d=c.length;e<d;e++){var l=c[e].material;l.fragmentShader=module$src$3d$viewports$default$shaders$ShaderFile.default.standard_frag.replace("vec3 noise(vec3 m) { return vec3(0); }",
a);l.needsUpdate=!0}c=b.threeDManager.getExchangeMaterials();e=0;for(d=c.length;e<d;e++)l=c[e].material,l.fragmentShader=module$src$3d$viewports$default$shaders$ShaderFile.default.standard_frag.replace("vec3 noise(vec3 m) { return vec3(0); }",a),l.needsUpdate=!0;b.renderingHandler.render()};B.prototype.pause=function(){};B.prototype.resume=function(){};B.prototype.destroy=function(){};B.prototype._getTransformationPath=function(a){a=c.getObjectPath(a);return a.substring(0,a.indexOf(".",a.indexOf("transformation_")))};
B.prototype._createCubeNormalMap=function(a,c,d){c=e._getTransformationPath(a)+c;if(x[c+"_"+d])return x[c+"_"+d];var l=new module$src$externals$three.default.Scene,n=new module$src$externals$three.default.CubeCamera(.001,1E4,d);n.renderTarget.texture.generateMipmaps=!1;n.renderTarget.texture.minFilter=module$src$externals$three.default.NearestFilter;n.renderTarget.texture.magFilter=module$src$externals$three.default.NearestFilter;n.renderTarget.texture.format=module$src$externals$three.default.RGBAFormat;
l.add(n);if(!v){var f=module$src$externals$three.default.UniformsUtils.merge([module$src$externals$three.default.UniformsLib.common,{emissive:{value:new module$src$externals$three.default.Color(0)},roughness:{value:.5},metalness:{value:0},envMapIntensity:{value:1}}]),h=module$src$3d$viewports$default$shaders$ShaderFile.default.normal_vert,g=module$src$3d$viewports$default$shaders$ShaderFile.default.normal_frag;v=new module$src$externals$three.default.ShaderMaterial({uniforms:module$src$externals$three.default.UniformsUtils.clone(f),
defines:{STANDARD:""},vertexShader:h,fragmentShader:g});v.blending=module$src$externals$three.default.NoBlending;v.side=module$src$externals$three.default.DoubleSide;l.overrideMaterial=v}a=new module$src$externals$three.default.Mesh(a.geometry.clone(),v);a.geometry.center();l.add(a);n.update(b.renderingHandler.getRenderer(),l);l.remove(a);x[c+"_"+d]=n.renderTarget.texture;return x[c+"_"+d]};B.prototype.getMaterial=function(a,c,d,f,h){null==a&&(a={});!a.attributes&&c&&c.geometry&&c.geometry.attributes&&
(a.attributes=Object.keys(c.geometry.attributes));"gem"===a.materialType?(f=e._createCubeNormalMap(c,d,a.resolution),c.geometry.boundingSphere||c.geometry.computeBoundingSphere(),h=c.geometry.boundingSphere.center,d=c.geometry.boundingSphere.radius,a.side=module$src$externals$three.default.FrontSide,a=Object.assign({inverseModelMatrix:(new module$src$externals$three.default.Matrix4).getInverse(c.matrixWorld),inverseTransposeModelMatrix:(new module$src$externals$three.default.Matrix3).getNormalMatrix((new module$src$externals$three.default.Matrix4).getInverse(c.matrixWorld).transpose()),
center:h,radius:d,sphericalNormalMap:f,envMap:a.environmentMap?a.environmentMap:r,customEnvMap:!!a.environmentMap},a),a=new module$src$externals$three.default.ShapeDiverGemMaterial(a)):(a=new module$src$externals$three.default.ShapeDiverStandardMaterial(Object.assign({textureUnitCount:l,lightWorldSize:u,lightFrustum:n,envMap:r,renderAO:!0},a)),f&&a.color.set(f.toRgbString()),h&&(a.vertexColors=module$src$externals$three.default.VertexColors),b.lightHandler.reevaluateNumberOfShadowMaps(a.availableTextures));
return a};B.prototype.getSimpleMaterial=function(a){return new module$src$externals$three.default.MeshPhongMaterial(Object.assign({shininess:a.metalness?128*a.metalness:0},a))};B.prototype.compile=function(){b.beautyRenderHandler.renderHidden();m.checkMaterials()};B.prototype.adjustToBoundingSphere=function(a){u=a.radius/25*.005;n=a.radius/25*6.5;a=b.threeDManager.helpers.getMaterials();for(var c=0,d=a.length;c<d;c++){var e=a[c];"ShapeDiverStandardMaterial"==e.type&&(e.lightWorldSize=u,e.lightFrustum=
n)}};B.prototype.getEnvironmentMap=function(){return r};B.prototype.setSceneBackground=function(a){h=a};B.prototype.getSceneBackground=function(){return h};return new B(a)}};var module$node_modules$detect_hover$lib$index={default:{}};Object.defineProperty(module$node_modules$detect_hover$lib$index.default,"__esModule",{value:!0});
module$node_modules$detect_hover$lib$index.default.default={update:function(){"undefined"!==typeof window&&"function"===typeof window.matchMedia&&(module$node_modules$detect_hover$lib$index.default.default.hover=window.matchMedia("(hover: hover)").matches,module$node_modules$detect_hover$lib$index.default.default.none=window.matchMedia("(hover: none)").matches||window.matchMedia("(hover: on-demand)").matches,module$node_modules$detect_hover$lib$index.default.default.anyHover=window.matchMedia("(any-hover: hover)").matches,
module$node_modules$detect_hover$lib$index.default.default.anyNone=window.matchMedia("(any-hover: none)").matches||window.matchMedia("(any-hover: on-demand)").matches)}};module$node_modules$detect_hover$lib$index.default.default.update();var module$node_modules$detect_pointer$lib$index={default:{}};Object.defineProperty(module$node_modules$detect_pointer$lib$index.default,"__esModule",{value:!0});
module$node_modules$detect_pointer$lib$index.default.default={update:function(){"undefined"!==typeof window&&"function"===typeof window.matchMedia&&(module$node_modules$detect_pointer$lib$index.default.default.fine=window.matchMedia("(pointer: fine)").matches,module$node_modules$detect_pointer$lib$index.default.default.coarse=window.matchMedia("(pointer: coarse)").matches,module$node_modules$detect_pointer$lib$index.default.default.none=window.matchMedia("(pointer: none)").matches,module$node_modules$detect_pointer$lib$index.default.default.anyFine=
window.matchMedia("(any-pointer: fine)").matches,module$node_modules$detect_pointer$lib$index.default.default.anyCoarse=window.matchMedia("(any-pointer: coarse)").matches,module$node_modules$detect_pointer$lib$index.default.default.anyNone=window.matchMedia("(any-pointer: none)").matches)}};module$node_modules$detect_pointer$lib$index.default.default.update();var module$node_modules$detect_touch_events$lib$index={default:{}};Object.defineProperty(module$node_modules$detect_touch_events$lib$index.default,"__esModule",{value:!0});module$node_modules$detect_touch_events$lib$index.default.default={update:function(){"undefined"!==typeof window&&(module$node_modules$detect_touch_events$lib$index.default.default.hasSupport="ontouchstart"in window,module$node_modules$detect_touch_events$lib$index.default.default.browserSupportsApi=!!window.TouchEvent)}};module$node_modules$detect_touch_events$lib$index.default.default.update();var module$node_modules$detect_passive_events$lib$index={default:{}};Object.defineProperty(module$node_modules$detect_passive_events$lib$index.default,"__esModule",{value:!0});
module$node_modules$detect_passive_events$lib$index.default.default={update:function(){if("undefined"!==typeof window&&"function"===typeof window.addEventListener){var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}}),c=function(){};window.addEventListener("testPassiveEventSupport",c,b);window.removeEventListener("testPassiveEventSupport",c,b);module$node_modules$detect_passive_events$lib$index.default.default.hasSupport=a}}};module$node_modules$detect_passive_events$lib$index.default.default.update();var module$node_modules$detect_it$lib$index={default:{}};Object.defineProperty(module$node_modules$detect_it$lib$index.default,"__esModule",{value:!0});
var _detectHover$$module$node_modules$detect_it$lib$index=module$node_modules$detect_hover$lib$index.default,_detectHover2$$module$node_modules$detect_it$lib$index=_interopRequireDefault$$module$node_modules$detect_it$lib$index(module$node_modules$detect_hover$lib$index.default),_detectPointer$$module$node_modules$detect_it$lib$index=module$node_modules$detect_pointer$lib$index.default,_detectPointer2$$module$node_modules$detect_it$lib$index=_interopRequireDefault$$module$node_modules$detect_it$lib$index(module$node_modules$detect_pointer$lib$index.default),
_detectTouchEvents$$module$node_modules$detect_it$lib$index=module$node_modules$detect_touch_events$lib$index.default,_detectTouchEvents2$$module$node_modules$detect_it$lib$index=_interopRequireDefault$$module$node_modules$detect_it$lib$index(module$node_modules$detect_touch_events$lib$index.default),_detectPassiveEvents$$module$node_modules$detect_it$lib$index=module$node_modules$detect_passive_events$lib$index.default,_detectPassiveEvents2$$module$node_modules$detect_it$lib$index=_interopRequireDefault$$module$node_modules$detect_it$lib$index(module$node_modules$detect_passive_events$lib$index.default);
function _interopRequireDefault$$module$node_modules$detect_it$lib$index(a){return a&&a.__esModule?a:{default:a}}
function determineDeviceType$$module$node_modules$detect_it$lib$index(a,b,c,g){return a&&(b||c)?"hybrid":a&&Object.keys(g.detectHover).filter(function(a){return"update"!==a}).every(function(a){return!1===g.detectHover[a]})&&Object.keys(g.detectPointer).filter(function(a){return"update"!==a}).every(function(a){return!1===g.detectPointer[a]})?window.navigator&&/android/.test(window.navigator.userAgent.toLowerCase())?"touchOnly":"hybrid":a?"touchOnly":"mouseOnly"}
module$node_modules$detect_it$lib$index.default.default={state:{detectHover:_detectHover2$$module$node_modules$detect_it$lib$index.default,detectPointer:_detectPointer2$$module$node_modules$detect_it$lib$index.default,detectTouchEvents:_detectTouchEvents2$$module$node_modules$detect_it$lib$index.default,detectPassiveEvents:_detectPassiveEvents2$$module$node_modules$detect_it$lib$index.default},update:function(){module$node_modules$detect_it$lib$index.default.default.state.detectHover.update();module$node_modules$detect_it$lib$index.default.default.state.detectPointer.update();
module$node_modules$detect_it$lib$index.default.default.state.detectTouchEvents.update();module$node_modules$detect_it$lib$index.default.default.state.detectPassiveEvents.update();module$node_modules$detect_it$lib$index.default.default.updateOnlyOwnProperties()},updateOnlyOwnProperties:function(){if("undefined"!==typeof window){module$node_modules$detect_it$lib$index.default.default.passiveEvents=module$node_modules$detect_it$lib$index.default.default.state.detectPassiveEvents.hasSupport||!1;module$node_modules$detect_it$lib$index.default.default.hasTouch=
module$node_modules$detect_it$lib$index.default.default.state.detectTouchEvents.hasSupport||!1;module$node_modules$detect_it$lib$index.default.default.deviceType=determineDeviceType$$module$node_modules$detect_it$lib$index(module$node_modules$detect_it$lib$index.default.default.hasTouch,module$node_modules$detect_it$lib$index.default.default.state.detectHover.anyHover,module$node_modules$detect_it$lib$index.default.default.state.detectPointer.anyFine,module$node_modules$detect_it$lib$index.default.default.state);
module$node_modules$detect_it$lib$index.default.default.hasMouse="touchOnly"!==module$node_modules$detect_it$lib$index.default.default.deviceType;module$node_modules$detect_it$lib$index.default.default.primaryInput="mouseOnly"===module$node_modules$detect_it$lib$index.default.default.deviceType&&"mouse"||"touchOnly"===module$node_modules$detect_it$lib$index.default.default.deviceType&&"touch"||module$node_modules$detect_it$lib$index.default.default.state.detectPointer.fine&&"mouse"||module$node_modules$detect_it$lib$index.default.default.state.detectPointer.coarse&&
"touch"||"mouse";var a;if(a=/windows/.test(window.navigator.userAgent.toLowerCase())&&/chrome/.test(window.navigator.userAgent.toLowerCase()))a=parseInt(/Chrome\/([0-9.]+)/.exec(navigator.userAgent)[1],10),a=59<=a&&62>a;a&&module$node_modules$detect_it$lib$index.default.default.hasTouch&&(module$node_modules$detect_it$lib$index.default.default.deviceType="hybrid",module$node_modules$detect_it$lib$index.default.default.hasMouse=!0,module$node_modules$detect_it$lib$index.default.default.primaryInput=
"mouse")}}};module$node_modules$detect_it$lib$index.default.default.updateOnlyOwnProperties();var module$src$3d$viewports$default$handlers$CameraHandler={default:function(a,b){var c=a.settings,g=a.geometryNode,d=a.container,f,p,e,m,h,r,q,t,u,n=new module$src$externals$three.default.Sphere,l=new module$src$externals$three.default.Matrix4,v=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"notnegative",b.threeDManager.warn,"CameraHandler.Hook->fov"))return!1;10<r.fov&&10>a?(r.near=100*r.near*a,r.far=100*r.far*a):10>r.fov&&10<a&&(r.near/=100*r.fov,r.far/=100*r.fov);r.fov=
a;r.updateProjectionMatrix();b.renderingHandler.render();return!0},x=function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"vector3obj",b.threeDManager.warn,"CameraHandler.Hook->defaults.perspective.position")?Promise.resolve(!0):Promise.resolve(!1)},w=function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"vector3obj",b.threeDManager.warn,"CameraHandler.Hook->defaults.perspective.target")?Promise.resolve(!0):Promise.resolve(!1)},y=function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a.position,
"vector3obj",b.threeDManager.warn,"CameraHandler.Hook->defaults.perspective")&&module$src$shared$util$GlobalUtils.default.typeCheck(a.target,"vector3obj",b.threeDManager.warn,"CameraHandler.Hook->defaults.perspective")?p instanceof module$src$externals$three.default.PerspectiveCamera?f.setPositionAndTarget(a.position,a.target,{duration:0}):Promise.resolve(!0):Promise.resolve(!1)},z=function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"vector3obj",b.threeDManager.warn,"CameraHandler.Hook->defaults.orthographic.position")?
Promise.resolve(!0):Promise.resolve(!1)},B=function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"vector3obj",b.threeDManager.warn,"CameraHandler.Hook->defaults.orthographic.target")?Promise.resolve(!0):Promise.resolve(!1)},A=function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a.position,"vector3obj",b.threeDManager.warn,"CameraHandler.Hook->defaults.orthographic")&&module$src$shared$util$GlobalUtils.default.typeCheck(a.target,"vector3obj",b.threeDManager.warn,
"CameraHandler.Hook->defaults.orthographic")?p instanceof module$src$externals$three.default.OrthographicCamera?f.setPositionAndTarget(a.position,a.target,{duration:c.getSetting("cameraMovementDuration")}):Promise.resolve(!0):Promise.resolve(!1)},D=function(a){return a.perspective&&module$src$shared$util$GlobalUtils.default.typeCheck(a.perspective.position,"vector3obj",b.threeDManager.warn,"CameraHandler.Hook->defaults")&&module$src$shared$util$GlobalUtils.default.typeCheck(a.perspective.target,"vector3obj",
b.threeDManager.warn,"CameraHandler.Hook->defaults")&&a.orthographic&&module$src$shared$util$GlobalUtils.default.typeCheck(a.orthographic.position,"vector3obj",b.threeDManager.warn,"CameraHandler.Hook->defaults")&&module$src$shared$util$GlobalUtils.default.typeCheck(a.orthographic.target,"vector3obj",b.threeDManager.warn,"CameraHandler.Hook->defaults")?Promise.resolve(!0):Promise.resolve(!1)},H=function(a){if("number"!==typeof a||a<module$src$3d$viewports$default$ThreeDManagerConstants.default.cameraViewTypes.MIN||
a>module$src$3d$viewports$default$ThreeDManagerConstants.default.cameraViewTypes.MAX)return!1;if(a===module$src$3d$viewports$default$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE)p=r,e=q,q.enabled=!0,u.enabled=!1,c.getSetting("environmentMapAsBackground")&&b.materialHandler.setSceneBackground(b.materialHandler.getEnvironmentMap());else{p=t;t.far=1E3*n.radius;t.near=n.radius;e=u;q.enabled=!1;u.enabled=!0;switch(a){case module$src$3d$viewports$default$ThreeDManagerConstants.default.cameraViewTypes.TOP:u.object.position.set(n.center.x,
n.center.y,n.center.z+2*n.radius);u.target.set(n.center.x,n.center.y,n.center.z-n.radius);break;case module$src$3d$viewports$default$ThreeDManagerConstants.default.cameraViewTypes.BOTTOM:u.object.position.set(n.center.x,n.center.y,n.center.z-2*n.radius);u.target.set(n.center.x,n.center.y,n.center.z+n.radius);break;case module$src$3d$viewports$default$ThreeDManagerConstants.default.cameraViewTypes.RIGHT:u.object.position.set(n.center.x+2*n.radius,n.center.y,n.center.z);u.target.set(n.center.x-n.radius,
n.center.y,n.center.z);break;case module$src$3d$viewports$default$ThreeDManagerConstants.default.cameraViewTypes.LEFT:u.object.position.set(n.center.x-2*n.radius,n.center.y,n.center.z);u.target.set(n.center.x+n.radius,n.center.y,n.center.z);break;case module$src$3d$viewports$default$ThreeDManagerConstants.default.cameraViewTypes.BACK:u.object.position.set(n.center.x,n.center.y+2*n.radius,n.center.z);u.target.set(n.center.x,n.center.y-n.radius,n.center.z);break;case module$src$3d$viewports$default$ThreeDManagerConstants.default.cameraViewTypes.FRONT:u.object.position.set(n.center.x,
n.center.y-2*n.radius,n.center.z),u.target.set(n.center.x,n.center.y+n.radius,n.center.z)}e.target.set(n.center.x,n.center.y,n.center.z);b.materialHandler.setSceneBackground(null)}b.lightHandler.adaptLightingToCameraType(a);b.renderingHandler.render();return!0},G=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",b.threeDManager.warn,"CameraHandler.Hook->enableOrbitControls"))return!1;e.enabled=a;e.resetState();return!0},E=null,J=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,
"boolean",b.threeDManager.warn,"CameraHandler.Hook->autoAdjust"))return!1;a&&!E&&(E=b.threeDManager.viewerApi.scene.addEventListener(b.threeDManager.viewerApi.scene.EVENTTYPE.SUBSCENE_PUBLISHED,function(){c.getSetting("autoAdjust")&&b.threeDManager.getSetting("show")&&f.zoomExtents({default:!0})}));return!0},F=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"notnegative",b.threeDManager.warn,"CameraHandler.Hook->damping"))return!1;a=Math.min(Math.max(.05,a),.25);e.dampingFactor=
a;e.panDampingFactor=a;e.zoomDampingFactor=a;e.rotateDampingFactor=a;return!0},C=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",b.threeDManager.warn,"CameraHandler.Hook->enableRotation"))return!1;e.enableRotation=a;return!0},I=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"float",b.threeDManager.warn,"CameraHandler.Hook->rotationSpeed"))return!1;e.rotationSpeed=a;return!0},M=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,
"boolean",b.threeDManager.warn,"CameraHandler.Hook->enableAutoRotation"))return!1;(e.enableAutoRotation=a)&&b.renderingHandler.render();return!0},N=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"float",b.threeDManager.warn,"CameraHandler.Hook->autoRotationSpeed"))return!1;e.autoRotationSpeed=a;0!==a?c.updateSetting("enableAutoRotation",!0):c.updateSetting("enableAutoRotation",!1);return!0},Q=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",
b.threeDManager.warn,"CameraHandler.Hook->enableZoom"))return!1;e.enableZoom=a;return!0},W=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"notnegative",b.threeDManager.warn,"CameraHandler.Hook->zoomSpeed"))return!1;e.zoomSpeed=a;return!0},R=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",b.threeDManager.warn,"CameraHandler.Hook->enablePan"))return!1;e.enablePan=a;return!0},O=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,
"number",b.threeDManager.warn,"CameraHandler.Hook->panSpeed"))return!1;e.panSpeed=a;return!0},K=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",b.threeDManager.warn,"CameraHandler.Hook->enableKeyPan"))return!1;e.enableKeyPan=a;return!0},Z=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"number",b.threeDManager.warn,"CameraHandler.Hook->keyPanSpeed"))return!1;e.keyPanSpeed=7*a;return!0},X=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a.min,
"vector3any",b.threeDManager.warn,"CameraHandler.Hook->restrictions.position.cube")||!module$src$shared$util$GlobalUtils.default.typeCheck(a.max,"vector3any",b.threeDManager.warn,"CameraHandler.Hook->restrictions.position.cube"))return!1;e.minPosition=module$src$shared$util$GlobalUtils.default.toVector3(a.min);e.maxPosition=module$src$shared$util$GlobalUtils.default.toVector3(a.max);b.renderingHandler.render();return!0},S=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a.center,
"vector3any",b.threeDManager.warn,"CameraHandler.Hook->restrictions.position.sphere")||!module$src$shared$util$GlobalUtils.default.typeCheck(a.radius,"notnegative",b.threeDManager.warn,"CameraHandler.Hook->restrictions.position.sphere"))return!1;e.positionSphereCenter=module$src$shared$util$GlobalUtils.default.toVector3(a.center);e.positionSphereRadius=a.radius;b.renderingHandler.render();return!0},U=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a.min,"vector3any",b.threeDManager.warn,
"CameraHandler.Hook->restrictions.target.cube")||!module$src$shared$util$GlobalUtils.default.typeCheck(a.max,"vector3any",b.threeDManager.warn,"CameraHandler.Hook->restrictions.target.cube"))return!1;e.minTarget=module$src$shared$util$GlobalUtils.default.toVector3(a.min);e.maxTarget=module$src$shared$util$GlobalUtils.default.toVector3(a.max);b.renderingHandler.render();return!0},T=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a.center,"vector3any",b.threeDManager.warn,"CameraHandler.Hook->restrictions.target.sphere")||
!module$src$shared$util$GlobalUtils.default.typeCheck(a.radius,"notnegative",b.threeDManager.warn,"CameraHandler.Hook->restrictions.target.sphere"))return!1;e.targetSphereCenter=module$src$shared$util$GlobalUtils.default.toVector3(a.center);e.targetSphereRadius=a.radius;b.renderingHandler.render();return!0},P=function(a){if(!(module$src$shared$util$GlobalUtils.default.typeCheck(a.minPolarAngle,"number",b.threeDManager.warn,"CameraHandler.Hook->restrictions.rotation")&&module$src$shared$util$GlobalUtils.default.typeCheck(a.maxPolarAngle,
"number",b.threeDManager.warn,"CameraHandler.Hook->restrictions.rotation")&&module$src$shared$util$GlobalUtils.default.typeCheck(a.minAzimuthAngle,"number",b.threeDManager.warn,"CameraHandler.Hook->restrictions.rotation")&&module$src$shared$util$GlobalUtils.default.typeCheck(a.maxAzimuthAngle,"number",b.threeDManager.warn,"CameraHandler.Hook->restrictions.rotation")))return!1;e.minPolarAngle=a.minPolarAngle*Math.PI/180;e.maxPolarAngle=a.maxPolarAngle*Math.PI/180;e.minAzimuthAngle=a.minAzimuthAngle*
Math.PI/180;e.maxAzimuthAngle=a.maxAzimuthAngle*Math.PI/180;b.renderingHandler.render();return!0},Y=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a.minDistance,"number",b.threeDManager.warn,"CameraHandler.Hook->restrictions.zoom")||!module$src$shared$util$GlobalUtils.default.typeCheck(a.maxDistance,"number",b.threeDManager.warn,"CameraHandler.Hook->restrictions.zoom"))return!1;e.minDistance=a.minDistance;e.maxDistance=a.maxDistance;b.renderingHandler.render();return!0},V=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,
"boolean",b.threeDManager.warn,"CameraHandler.Hook->revertAtMouseUp"))return!1;a=!1;!0===module$node_modules$detect_it$lib$index.default.default.passiveEvents&&(a={capture:!1,passive:!0});var d=b.renderingHandler.getDomElement();d.addEventListener("mouseup",function(){c.getSetting("revertAtMouseUp")&&f.resetPositionAndTarget({duration:c.getSetting("revertAtMouseUpDuration")})},a);d.addEventListener("touchend",function(){c.getSetting("revertAtMouseUp")&&f.resetPositionAndTarget({duration:c.getSetting("revertAtMouseUpDuration")})},
a);var e=0,l=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";d.addEventListener(l,function(){clearTimeout(e);c.getSetting("revertAtMouseUp")&&(e=setTimeout(function(){f.resetPositionAndTarget({duration:c.getSetting("revertAtMouseUpDuration")})},300))},a);return!0},aa=function(){f.zoomExtents()},L=function(a){module$src$3d$interfaces$handlers$CameraHandlerInterface.default.call(this,a);f=this;r=new module$src$externals$three.default.PerspectiveCamera(c.getSetting("fov"),d.offsetWidth/
d.offsetHeight,c.getSetting("near"),c.getSetting("far"));m=c.getSetting("defaults.perspective.position");r.position.set(m.x,m.y,m.z);r.up.set(0,0,1);b.threeDManager.helpers.addSceneObject(r);a=new module$src$3d$helpers$OrbitControlsProxyStandardImplementation.default(b);q=new module$src$externals$three.default.OrbitControls(r,a);a.initialize();q.enableDamping=!0;q.dampingFactor=c.getSetting("damping");q.panDampingFactor=c.getSetting("damping");q.zoomDampingFactor=c.getSetting("damping");q.rotateDampingFactor=
c.getSetting("damping");q.enableRotation=c.getSetting("enableRotation");q.rotationSpeed=c.getSetting("rotationSpeed");q.enableAutoRotation=c.getSetting("enableAutoRotation");q.autoRotationSpeed=c.getSetting("autoRotationSpeed");q.enableZoom=c.getSetting("enableZoom");q.zoomSpeed=c.getSetting("zoomSpeed");q.enablePan=c.getSetting("enablePan");q.panSpeed=c.getSetting("panSpeed");q.enableKeyPan=c.getSetting("enableKeyPan");q.keyPanSpeed=7*c.getSetting("keyPanSpeed");h=c.getSetting("defaults.perspective.target");
q.target.set(h.x,h.y,h.z);q.addEventListener("change",function(){e==q&&e.isMoving&&b.renderingHandler.registerForContinuousRendering("cameraMoving")});t=new module$src$externals$three.default.OrthographicCamera(-25,25,25,-25,.01,1E4);m=c.getSetting("defaults.orthographic.position");t.position.set(m.x,m.y,m.z);t.up.set(0,0,1);a=new module$src$3d$helpers$OrbitControlsProxyStandardImplementation.default(b);u=new module$src$externals$three.default.OrbitControls(t,a);a.initialize();u.enableDamping=!0;
u.dampingFactor=c.getSetting("damping");u.panDampingFactor=c.getSetting("damping");u.zoomDampingFactor=c.getSetting("damping");u.rotateDampingFactor=c.getSetting("damping");u.enableRotation=!1;u.enableAutoRotation=!1;u.enablePan=!0;u.enableKeyPan=!0;u.enableZoom=c.getSetting("enableZoom");u.zoomSpeed=c.getSetting("zoomSpeed");u.addEventListener("change",function(){e==u&&e.isMoving&&b.renderingHandler.registerForContinuousRendering("cameraMoving")});h=c.getSetting("defaults.orthographic.target");u.target.set(h.x,
h.y,h.z);p=r;e=q;q.enabled=!0;u.enabled=!1;n.radius=25;c.registerHook("autoAdjust",J);c.registerHook("fov",v);c.registerHook("defaults.perspective.position",x);c.registerHook("defaults.perspective.target",w);c.registerHook("defaults.perspective",y);c.registerHook("defaults.orthographic.position",z);c.registerHook("defaults.orthographic.target",B);c.registerHook("defaults.orthographic",A);c.registerHook("defaults",D);c.registerHook("type",H);c.registerHook("enableOrbitControls",G);c.registerHook("damping",
F);c.registerHook("enableRotation",C);c.registerHook("rotationSpeed",I);c.registerHook("enableAutoRotation",M);c.registerHook("autoRotationSpeed",N);c.registerHook("enableZoom",Q);c.registerHook("zoomSpeed",W);c.registerHook("enablePan",R);c.registerHook("panSpeed",O);c.registerHook("enableKeyPan",K);c.registerHook("keyPanSpeed",Z);c.registerHook("restrictions.position.cube",X);c.registerHook("restrictions.position.cube.min",function(a){var b=c.getSetting("restrictions.position.cube");b.min=a;return X(b)});
c.registerHook("restrictions.position.cube.max",function(a){var b=c.getSetting("restrictions.position.cube");b.max=a;return X(b)});c.registerHook("restrictions.position.sphere",S);c.registerHook("restrictions.position.sphere.center",function(a){var b=c.getSetting("restrictions.position.sphere");b.center=a;return S(b)});c.registerHook("restrictions.position.sphere.radius",function(a){var b=c.getSetting("restrictions.position.sphere");b.radius=a;return S(b)});c.registerHook("restrictions.target.cube",
U);c.registerHook("restrictions.target.cube.min",function(a){var b=c.getSetting("restrictions.target.cube");b.min=a;return U(b)});c.registerHook("restrictions.target.cube.max",function(a){var b=c.getSetting("restrictions.target.cube");b.max=a;return U(b)});c.registerHook("restrictions.target.sphere",T);c.registerHook("restrictions.target.sphere.center",function(a){var b=c.getSetting("restrictions.target.sphere");b.center=a;return T(b)});c.registerHook("restrictions.target.sphere.radius",function(a){var b=
c.getSetting("restrictions.target.sphere");b.radius=a;return T(b)});c.registerHook("restrictions.rotation",P);c.registerHook("restrictions.rotation.minPolarAngle",function(a){var b=c.getSetting("restrictions.rotation");b.minPolarAngle=a;return P(b)});c.registerHook("restrictions.rotation.maxPolarAngle",function(a){var b=c.getSetting("restrictions.rotation");b.maxPolarAngle=a;return P(b)});c.registerHook("restrictions.rotation.minAzimuthAngle",function(a){var b=c.getSetting("restrictions.rotation");
b.minAzimuthAngle=a;return P(b)});c.registerHook("restrictions.rotation.maxAzimuthAngle",function(a){var b=c.getSetting("restrictions.rotation");b.maxAzimuthAngle=a;return P(b)});c.registerHook("restrictions.zoom",Y);c.registerHook("restrictions.zoom.minDistance",function(a){var b=c.getSetting("restrictions.zoom");b.minDistance=a;return Y(b)});c.registerHook("restrictions.zoom.maxDistance",function(a){var b=c.getSetting("restrictions.zoom");b.maxDistance=a;return Y(b)});c.registerHook("revertAtMouseUp",
V);c.registerNotifier("zoomExtentsFactor",aa)};$jscomp.inherits(L,module$src$3d$interfaces$handlers$CameraHandlerInterface.default);L.prototype._transitionDefaults=function(a){var b={};module$src$shared$util$GlobalUtils.default.typeCheck(a.duration,"notnegative")?b.duration=a.duration:b.duration=c.getSetting("cameraMovementDuration");module$src$shared$util$GlobalUtils.default.typeCheck(a.coordinates,"string")&&(b.coordinates=a.coordinates);"spherical"!==b.coordinates&&"cylindrical"!==b.coordinates&&
(b.coordinates="cylindrical");b.easing=null;void 0!==a.easing&&(module$src$shared$util$GlobalUtils.default.typeCheck(a.easing,"string")?b.easing=module$src$shared$util$GlobalUtils.default.getAtPath(module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing,a.easing):"function"===typeof a.easing&&(b.easing=a.easing));b.easing=b.easing||module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Quartic.InOut;b.interpolation=null;void 0!==a.interpolation&&(module$src$shared$util$GlobalUtils.default.typeCheck(a.interpolation,
"string")?b.interpolation=module$src$shared$util$GlobalUtils.default.getAtPath(module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation,a.interpolation):"function"===typeof a.interpolation&&(b.interpolation=a.interpolation));b.interpolation=b.interpolation||module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation.CatmullRom;"boolean"!==typeof b.default&&(b.default=!1);return b};L.prototype._isOrthographicCameraType=function(){return"OrthographicCamera"===e.object.type};L.prototype._isPerspectiveCameraType=
function(){return"PerspectiveCamera"===e.object.type};L.prototype.pause=function(){e.enabled=!1;e.resetState()};L.prototype.resume=function(){r.updateProjectionMatrix();e.enabled=c.getSetting("enableOrbitControls")};L.prototype.setViewAndProjectionMatrix=function(a,b){l.getInverse(a);l.decompose(p.position,p.quaternion,p.scale);p.projectionMatrix.copy(b)};L.prototype.destroy=function(){};L.prototype.setPosition=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"vector3obj",b.threeDManager.warn,
"CameraHandler.setPosition"))return!1;e.object.position.set(a.x,a.y,a.z);b.renderingHandler.render();return!0};L.prototype.resetPosition=function(){return p instanceof module$src$externals$three.default.PerspectiveCamera?f.setPosition(c.getSetting("defaults.perspective.position")):f.setPosition(c.getSetting("defaults.orthographic.position"))};L.prototype.getPosition=function(){return module$src$shared$util$GlobalUtils.default.deepCopy(e.object.position)};L.prototype.setTarget=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,
"vector3obj",b.threeDManager.warn,"CameraHandler.setTarget"))return!1;e.target.set(a.x,a.y,a.z);b.renderingHandler.render();return!0};L.prototype.resetTarget=function(){return p instanceof module$src$externals$three.default.PerspectiveCamera?f.setTarget(c.getSetting("defaults.perspective.target")):f.setTarget(c.getSetting("defaults.orthographic.target"))};L.prototype.getTarget=function(){return module$src$shared$util$GlobalUtils.default.deepCopy(e.target)};L.prototype.setPositionAndTarget=function(a,
d,l){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"vector3any",b.threeDManager.warn,"CameraHandler.setPositionAndTarget")||!module$src$shared$util$GlobalUtils.default.typeCheck(d,"vector3any",b.threeDManager.warn,"CameraHandler.setPositionAndTarget"))return Promise.resolve(!1);var n=module$src$shared$util$GlobalUtils.default.toVector3(a),h=module$src$shared$util$GlobalUtils.default.toVector3(d);l=l||{};var g=f._transitionDefaults(l);l.default&&(a=p instanceof module$src$externals$three.default.PerspectiveCamera?
"defaults.perspective":"defaults.orthographic",c.updateSetting(a+".position",n),c.updateSetting(a+".target",h));if(module$src$shared$util$GlobalUtils.default.typeCheck(g.duration,"notnegative"))return new Promise(function(a){var c=e.object.position,l=e.target,m=c.clone().sub(l),r=n.clone().sub(h),q=m.clone().normalize();var p="cylindrical"===g.coordinates?new module$src$externals$three.default.Vector3(0,0,1):(new module$src$externals$three.default.Vector3).crossVectors(q,r);p.sub(q.clone().multiplyScalar(q.dot(p)));
p.normalize();1E-12>p.lengthSq()&&(p.set(0,0,1),p.sub(q.clone().multiplyScalar(q.dot(p))),p.normalize());1E-12>p.lengthSq()&&(p.set(0,1,0),p.sub(q.clone().multiplyScalar(q.dot(p))),p.normalize());var t=(new module$src$externals$three.default.Vector3).crossVectors(p,q),v=(new module$src$externals$three.default.Matrix4).makeBasis(q,t,p);q=new module$src$externals$three.default.Matrix4;try{q.getInverse(v,!0)}catch(da){q.identity(),v=q}m.applyMatrix4(q);r.applyMatrix4(q);m=module$src$shared$util$GlobalUtils.default.cartesianToPolar(m.x,
m.y,m.z);r=module$src$shared$util$GlobalUtils.default.cartesianToPolar(r.x,r.y,r.z);var u={dR:m[0],dTheta:m[1],dPhi:m[2],targetX:e.target.x,targetY:e.target.y,targetZ:e.target.z};r=(new module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween(u)).easing(g.easing).to({dR:r[0],dTheta:r[1],dPhi:r[2],targetX:d.x,targetY:d.y,targetZ:d.z},g.duration).onUpdate(function(){l.set(u.targetX,u.targetY,u.targetZ);var a=module$src$shared$util$GlobalUtils.default.polarToCartesian(u.dR,u.dTheta,u.dPhi);a=module$src$shared$util$GlobalUtils.default.toVector3(a);
a.applyMatrix4(v);a=l.clone().add(a);c.copy(a);f.updateOrbitControls();b.renderingHandler.render()}).onComplete(function(){c.copy(n);l.copy(h);f.updateOrbitControls();b.renderingHandler.unregisterForContinuousRendering("tweenID");a(!0)});b.renderingHandler.registerForContinuousRendering("tweenID");r.start()});e.object.position.copy(n);e.target.copy(h);b.renderingHandler.render();return Promise.resolve(!0)};L.prototype.resetPositionAndTarget=function(a){a||(a={});a.default=!1;return p instanceof module$src$externals$three.default.PerspectiveCamera?
f.setPositionAndTarget(c.getSetting("defaults.perspective.position"),c.getSetting("defaults.perspective.target"),a):f.setPositionAndTarget(c.getSetting("defaults.orthographic.position"),c.getSetting("defaults.orthographic.target"),a)};L.prototype.getPositionAndTarget=function(){return{position:f.getPosition(),target:f.getTarget()}};L.prototype.zoomExtents=function(a,d){if(!1===this._isPerspectiveCameraType())return b.threeDManager.warn("CameraHandler.zoomExtents","Not implemented for orthographic camera."),
Promise.resolve(!0);if(!(d&&d instanceof module$src$externals$three.default.Box3)&&(d=g.computeSceneBoundingBox(),0==d.min.distanceTo(d.max))){var l=Number.MIN_VALUE;d=new module$src$externals$three.default.Box3(new module$src$externals$three.default.Vector3(-l,-l,-l),new module$src$externals$three.default.Vector3(l,l,l))}l=new module$src$externals$three.default.Vector3;d.getCenter(l);if(c.hasSetting("zoomExtentsFactor")){var n=new module$src$externals$three.default.Vector3;n.subVectors(d.max,l);
n.multiplyScalar(c.getSetting("zoomExtentsFactor"));d=new module$src$externals$three.default.Box3((new module$src$externals$three.default.Vector3).subVectors(l,n),(new module$src$externals$three.default.Vector3).addVectors(l,n))}n=[];n.push(d.min);n.push(d.max);n.push(new module$src$externals$three.default.Vector3(d.max.x,d.min.y,d.min.z));n.push(new module$src$externals$three.default.Vector3(d.max.x,d.max.y,d.min.z));n.push(new module$src$externals$three.default.Vector3(d.max.x,d.min.y,d.max.z));
n.push(new module$src$externals$three.default.Vector3(d.min.x,d.max.y,d.max.z));n.push(new module$src$externals$three.default.Vector3(d.min.x,d.min.y,d.max.z));n.push(new module$src$externals$three.default.Vector3(d.min.x,d.max.y,d.min.z));var h=0;d=new module$src$externals$three.default.Vector3;e.object.getWorldDirection(d);d.normalize();var m=new module$src$externals$three.default.Line3(l.clone().addScaledVector(d,-100),l.clone()),r=new module$src$externals$three.default.Vector3;r.crossVectors(d,
e.object.up);r.normalize();var q=new module$src$externals$three.default.Vector3;q.crossVectors(r,d);q.normalize();for(var p=0,t=n.length;p<t;p++){var v=new module$src$externals$three.default.Vector3;m.closestPointToPoint(n[p],!1,v);var u=n[p].clone();u.sub(v);var E=u.dot(r);u=u.dot(q);var w=Math.tan(Math.PI/180*e.object.fov*.5);E=Math.max(Math.abs(E/(e.object.aspect*w)),Math.abs(u/w));v=v.clone().sub(l).dot(d);h=Math.max(h,E-v)}d.multiplyScalar(-1*h);n=new module$src$externals$three.default.Vector3;
n.addVectors(l,d);return f.setPositionAndTarget(n,l,a)};L.prototype.setCameraPath=function(a,d,l){var n,h;if(null==a&&null==d)return Promise.resolve(!1);a=a||[];d=d||[];var g=$jscomp.makeIterator([a,d]);for(n=g.next();!n.done;n=g.next()){var m=n.value;if(!Array.isArray(m))return Promise.resolve(!1);n=0;for(h=m.length;n<h;++n){if(!module$src$shared$util$GlobalUtils.default.typeCheck(m[n],"vector3any",b.threeDManager.warn,"CameraHandler.setCameraPath"))return Promise.resolve(!1);m[n]=module$src$shared$util$GlobalUtils.default.toVector3(m[n])}}if(0==
a.length)for(n=0,h=d.length;n<h;++n)a.push({x:e.object.position.x,y:e.object.position.y,z:e.object.position.z});if(0==d.length)for(n=0,h=a.length;n<h;++n)d.push({x:e.target.x,y:e.target.y,z:e.target.z});var r=f._transitionDefaults(l),q=module$src$shared$util$GlobalUtils.default.cartesianToPolar(e.object.position.x,e.object.position.y,e.object.position.z),t=[],v=[],u=[];a.forEach(function(a){a=module$src$shared$util$GlobalUtils.default.cartesianToPolar(a.x,a.y,a.z);t.push(a[0]);v.push(a[1]);u.push(a[2])});
var E=[],w=[],x=[];d.forEach(function(a){E.push(a.x);w.push(a.y);x.push(a.z)});return new Promise(function(n){var h={objectR:q[0],objectTheta:q[1],objectPhi:q[2],targetX:e.target.x,targetY:e.target.y,targetZ:e.target.z},g=(new module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween(h)).to({objectR:t,objectTheta:v,objectPhi:u,targetX:E,targetY:w,targetZ:x},r.duration).onUpdate(function(){var a=module$src$shared$util$GlobalUtils.default.polarToCartesian(h.objectR,h.objectTheta,h.objectPhi);e.object.position.set(a[0],
a[1],a[2]);e.target.set(h.targetX,h.targetY,h.targetZ);f.updateOrbitControls();b.renderingHandler.render()}).onComplete(function(){var h=a.length-1;e.object.position.set(a[h].x,a[h].y,a[h].z);h=d.length-1;e.target.set(d[h].x,d[h].y,d[h].z);f.updateOrbitControls();b.renderingHandler.unregisterForContinuousRendering("tweenID");if(l.default){var g=p instanceof module$src$externals$three.default.PerspectiveCamera?"defaults.perspective":"defaults.orthographic";c.updateSetting(g+".position",a[h]);c.updateSetting(g+
".target",d[h])}n(!0)});b.renderingHandler.registerForContinuousRendering("tweenID");g.easing(r.easing).interpolation(r.interpolation).start()})};L.prototype.getCamera=function(){return p};L.prototype.isCameraMoving=function(){return e.isMoving};L.prototype.updateOrbitControls=function(){e.enabled&&(e.update(),b.renderingHandler.unregisterForContinuousRendering("cameraMoving"),e.isMoving&&b.renderingHandler.registerForContinuousRendering("cameraMoving",!1))};L.prototype.adjustToBoundingSphere=function(a){n=
a;t.left=-a.radius*r.aspect;t.bottom=-a.radius;t.right=a.radius*r.aspect;t.top=a.radius;t.far=1E4*a.radius;t.near=.01*a.radius;t.updateProjectionMatrix();r.far=10>r.fov?1E4*r.fov*a.radius:100*a.radius;r.near=10>r.fov?1*r.fov*a.radius:.01*a.radius;r.updateProjectionMatrix()};L.prototype.onResize=function(a,b){r.aspect=a/b;r.setViewOffset(a,b,0,0,a,b);r.updateProjectionMatrix()};return new L(a)}};var module$src$3d$viewports$default$defaults$DefaultLights={default:{default:{light1:{type:0,properties:{color:16777215,intensity:.35}},light2:{type:1,properties:{direction:{x:.5774,y:-.5774,z:.5774},shadows:!0,intensity:.35}},light3:{type:1,properties:{direction:{x:-.25,y:1,z:1},shadows:!1,intensity:.25}}},default_legacy:{light0:{type:999,properties:{}},light1:{type:0,properties:{color:6579300}},light2:{type:1,properties:{direction:{x:.5774,y:-.5774,z:.5774},shadows:!0}}},test:{light1:{type:1,properties:{direction:{x:1,
y:1,z:1},shadows:!1,intensity:.5}},light2:{type:1,properties:{direction:{x:1,y:-1,z:1},shadows:!1,intensity:.5}},light3:{type:1,properties:{direction:{x:-1,y:-1,z:1},shadows:!1,intensity:.5}},light4:{type:1,properties:{direction:{x:-1,y:1,z:1},shadows:!1,intensity:.5}}}}};var module$src$3d$viewports$default$handlers$LightHandler={default:function(a,b){var c={color:"color",intensity:"notnegative",shadows:"boolean",position:"vector3any",target:"vector3any",direction:"vector3any",distance:"notnegative",angle:"notnegative",penumbra:"factor",decay:"notnegative",helper:"boolean"},g=a.settings,d,f=new module$src$externals$three.default.Object3D,p=new module$src$externals$three.default.Object3D,e=new module$src$externals$three.default.Object3D,m,h=new module$src$externals$three.default.Sphere,
r=!1,q=a.shadows,t=function(){module$src$3d$interfaces$handlers$LightHandlerInterface.default.call(this);d=this;b.threeDManager.helpers.addSceneObject(f);f.add(p);f.add(e);e.add(new module$src$externals$three.default.AmbientLight(16777215,1));p.visible=b.threeDManager.getSetting("camera.type")==module$src$3d$viewports$default$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE;e.visible=b.threeDManager.getSetting("camera.type")!=module$src$3d$viewports$default$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE;
m=new module$src$externals$three.default.SpotLight(16777215,.4,0,Math.PI/2,5,5);m.position.set(0,0,1);m.target=b.cameraHandler.getCamera();m.castShadow=!1;m.visible=!1;f.add(m);h.radius=25;g.registerHook("light0",function(a){if(a&&a.type&&a.properties){for(var c,e=0;e<p.children.length;e++)0==p.children[e].lightID&&(c=p.children[e]);e=g.getSetting("light0");if(e.hasOwnProperty("type")&&e.type===a.type&&c&&c.lightType===a.type){if(!d._changeLightProperties(0,a.properties))return!1}else if(999===a.type){if(!d._addLight(0,
a.type,a.properties))return!1}else return b.threeDManager.warn("LightHandler.Hook->lights.light0","Light 0 can only be of type Flashlight."),!1}else d._removeLight(0);return!0});g.updateSetting("light0",g.getSetting("light0"));for(var a={i:1};10>a.i;a={i:a.i,lightName:a.lightName},a.i++)a.lightName="light"+a.i,g.registerHook(a.lightName,function(a){return function(b){if(b.hasOwnProperty("type")&&b.hasOwnProperty("properties")){for(var c,e=0;e<p.children.length;e++)p.children[e].lightID==a.i&&(c=p.children[e]);
e=g.getSetting(a.lightName);if(e.hasOwnProperty("type")&&e.type==b.type&&c&&c.lightType==b.type){if(!d._changeLightProperties(a.i,b.properties))return!1}else if(!d._addLight(a.i,b.type,b.properties))return!1}else d._removeLight(a.i);return!0}}(a)),g.updateSetting(a.lightName,g.getSetting(a.lightName))};$jscomp.inherits(t,module$src$3d$interfaces$handlers$LightHandlerInterface.default);t.prototype._checkProperties=function(a,d){for(var e in d){if(void 0===c[e])return b.threeDManager.warn("LightHandler._checkProperties",
"Unknown property "+e),!1;if(!module$src$shared$util$GlobalUtils.default.typeCheck(d[e],c[e],b.threeDManager.warn,"LightHandler._checkProperties","Property "+e))return!1}return!0};t.prototype._changeProperties=function(a,b,c){if(!d._checkProperties(b,c))return!1;var e=a.children[0];if(0==b)for(var n in c)e.hasOwnProperty(n)&&(e[n]="color"==n?(0,module$src$shared$util$toTinyColor.default)(c[n]).toThreeColor():c[n]);else if(1==b){for(var l in c)e.hasOwnProperty(l)&&(e[l]="color"==l?(0,module$src$shared$util$toTinyColor.default)(c[l]).toThreeColor():
c[l]);c.hasOwnProperty("shadows")&&1==c.shadows?(e.shadows=!0,e.castShadow=r?!1:q,e.shadow.camera.up.set(0,0,1),e.shadow.camera.far=8*h.radius,e.shadow.camera.right=1.5*h.radius,e.shadow.camera.left=-1.5*h.radius,e.shadow.camera.top=1.5*h.radius,e.shadow.camera.bottom=-1.5*h.radius,e.shadow.mapSize.width=2048,e.shadow.mapSize.height=2048,e.shadow.radius=2,e.shadow.bias=-.00175,e.shadow.camera.updateProjectionMatrix()):c.hasOwnProperty("shadows")&&0==c.shadows&&(e.shadows=!1,e.castShadow=!1);c.hasOwnProperty("direction")?
e.direction=module$src$shared$util$GlobalUtils.default.toVector3(c.direction).normalize():c.hasOwnProperty("position")&&c.hasOwnProperty("target")?e.direction=module$src$shared$util$GlobalUtils.default.toVector3(c.target).sub(module$src$shared$util$GlobalUtils.default.toVector3(c.position)).normalize():c.hasOwnProperty("position")&&(e.direction=module$src$shared$util$GlobalUtils.default.toVector3(h.center).sub(module$src$shared$util$GlobalUtils.default.toVector3(c.position)).normalize());b=new module$src$externals$three.default.Object3D;
a.add(b);e.target=b;e.position.set(h.center.x+e.direction.x*h.radius*2.35,h.center.y+e.direction.y*h.radius*2.35,h.center.z+e.direction.z*h.radius*2.35);e.target.position.set(h.center.x,h.center.y,h.center.x);if(!c.hasOwnProperty("helper"))for(e=0;e<a.children.length;e++)1==a.children[e].helper&&a.children[e].update();else if(c.hasOwnProperty("helper")&&1==c.helper){for(c=0;c<a.children.length;c++)1==a.children[c].helper&&a.remove(a.children[c]);e=new module$src$externals$three.default.DirectionalLightHelper(e);
e.up.set(0,0,1);e.helper=!0;a.add(e)}else if(c.hasOwnProperty("helper")&&0==c.helper)for(e=0;e<a.children.length;e++)1==a.children[e].helper&&a.remove(a.children[e])}else if(2==b){for(var f in c)e.hasOwnProperty(f)&&(e[f]="color"==f?(0,module$src$shared$util$toTinyColor.default)(c[f]).toThreeColor():c[f]);b=new module$src$externals$three.default.Object3D;a.add(b);e.target=b;b=c.hasOwnProperty("position")?module$src$shared$util$GlobalUtils.default.toVector3(c.position):void 0;n=c.hasOwnProperty("target")?
module$src$shared$util$GlobalUtils.default.toVector3(c.target):void 0;l=c.hasOwnProperty("direction")?module$src$shared$util$GlobalUtils.default.toVector3(c.direction):void 0;b&&n?(e.position.copy(b),e.target.position.copy(n)):b&&l?(e.position.copy(b),e.target.position.copy(b.clone().add(l.clone().multiplyScalar(2.35*h.radius)))):b?(e.position.copy(b),e.target.position.copy(h.center)):n&&l?(e.position.copy(n.clone().add(l.clone().multiplyScalar(2.35*h.radius))),e.target.position.copy(n)):l&&(e.position.copy(h.center.clone().add(l.clone().multiplyScalar(2.35*
h.radius))),e.target.position.copy(h.center));c.hasOwnProperty("shadows")&&1==c.shadows?(e.shadows=!1,e.castShadow=!1):c.hasOwnProperty("shadows")&&0==c.shadows&&(e.shadows=!1,e.castShadow=!1);if(!c.hasOwnProperty("helper"))for(e=0;e<a.children.length;e++)1==a.children[e].helper&&a.children[e].update();else if(c.hasOwnProperty("helper")&&1==c.helper){for(c=0;c<a.children.length;c++)1==a.children[c].helper&&a.remove(a.children[c]);e=new module$src$externals$three.default.SpotLightHelper(e);e.up.set(0,
0,1);e.helper=!0;a.add(e)}else if(c.hasOwnProperty("helper")&&0==c.helper)for(e=0;e<a.children.length;e++)1==a.children[e].helper&&a.remove(a.children[e])}return!0};t.prototype._addLight=function(a,c,e){if(0===c)var l=new module$src$externals$three.default.AmbientLight(16777215,.5);else if(1===c)l=new module$src$externals$three.default.DirectionalLight(16777215,.5),l.direction=(new module$src$externals$three.default.Vector3(1,-1,1)).normalize();else if(2===c)l=new module$src$externals$three.default.SpotLight(16777215,
.5,100,Math.PI/4,.25,.1),l.up.set(0,0,1);else{if(999===c){if(0!==a)return b.threeDManager.warn("LightHandler._addLight","Invalid light type, for this id."),-1;m.visible=p.visible;b.cameraHandler.getCamera().add(m);return 0}b.threeDManager.warn("LightHandler._addLight","Invalid light type, no light was added to the scene.");return-1}d._removeLight(a);var n=new module$src$externals$three.default.Object3D;n.add(l);if(!d._changeProperties(n,c,e))return-1;n.lightID=a;n.lightType=c;p.add(n);return n.lightID};
t.prototype._removeLight=function(a){if(0==a&&m.visible)return m.visible=!1,b.renderingHandler.render(),!0;for(var c=0;c<p.children.length;c++)if(p.children[c].lightID==a)return b.renderingHandler.updateShadowMap(),p.remove(p.children[c]),b.renderingHandler.render(),!0;return!1};t.prototype._changeLightProperties=function(a,c){for(var e=0;e<p.children.length;e++)if(p.children[e].lightID==a){if(!d._changeProperties(p.children[e],p.children[e].lightType,c))break;b.renderingHandler.updateShadowMap();
b.renderingHandler.render();return!0}return!1};t.prototype.pause=function(){};t.prototype.resume=function(){};t.prototype.destroy=function(){};t.prototype.adjustToBoundingSphere=function(a){h=a;for(var b=0;b<p.children.length;b++){var c=p.children[b];1==c.lightType&&(c=c.children[0],c.position.set(a.center.x+c.direction.x*a.radius*2.35,a.center.y+c.direction.y*a.radius*2.35,a.center.z+c.direction.z*a.radius*2.35),c.target.position.set(a.center.x,a.center.y,a.center.x),c.shadows&&(c.shadow.camera.far=
8*a.radius,c.shadow.camera.right=1.5*a.radius,c.shadow.camera.left=-1.5*a.radius,c.shadow.camera.top=1.5*a.radius,c.shadow.camera.bottom=-1.5*a.radius,c.shadow.camera.updateProjectionMatrix()))}};t.prototype.adjustShadowRadius=function(a){for(var b=0;b<p.children.length;b++){var c=p.children[b];1==c.lightType&&(c=c.children[0],c.shadows&&(c.shadow.camera.far=8*a.radius,c.shadow.camera.right=1.5*a.radius,c.shadow.camera.left=-1.5*a.radius,c.shadow.camera.top=1.5*a.radius,c.shadow.camera.bottom=-1.5*
a.radius,c.shadow.camera.updateProjectionMatrix()))}};t.prototype.adaptLightingToCameraType=function(a){p.visible=a==module$src$3d$viewports$default$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE;e.visible=a!=module$src$3d$viewports$default$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE;999==g.getSetting("light0.type")&&(m.visible=a==module$src$3d$viewports$default$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE);return!0};t.prototype.setToggleLightShadows=function(a){q=
a;for(a=0;a<p.children.length;a++)p.children[a].children[0].hasOwnProperty("shadow")&&(p.children[a].children[0].castShadow=r?!1:q)};t.prototype.restoreDefaultConfiguration=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string"))return b.threeDManager.warn("LightHandler.getDefaultConfiguration","The given name is not a string."),!1;if(!module$src$3d$viewports$default$defaults$DefaultLights.default[a])return b.threeDManager.warn("LightHandler.getDefaultConfiguration","The light configuration with name "+
a+" does not exist."),!1;a=module$src$3d$viewports$default$defaults$DefaultLights.default[a];for(var c=0;10>c;c++)g.updateSetting("light"+c,{});for(var d in a)g.updateSetting(String(d),a[d]);return!0};t.prototype.shadowSettingOverride=function(a){r||(r=a);r&&(b.threeDManager.warn("LightHandler","Due to restrictions to the number of maps that can be used with this device, the shadows were disabled."),d.setToggleLightShadows())};t.prototype.reevaluateNumberOfShadowMaps=function(a){for(var c=b.threeDManager.helpers.getMaterials(),
e=0,f=c.length;e<f;e++){var h=c[e];h.availableTextures&&(a=Math.min(a,h.availableTextures))}for(e=c=0;e<p.children.length;e++)p.children[e].children[0].hasOwnProperty("shadow")&&p.children[e].children[0].castShadow&&c++;d.shadowSettingOverride(c-1>=a)};t.prototype.toggleLights=function(a){f.visible=a;m.visible=a};return new t(a)}};var module$src$3d$viewports$default$handlers$HighlightingHandler={default:function(a,b){var c=a.pathUtils,g=a.geometryNode,d,f=null,p=null,e=[],m=[],h=!1,r=!1,q=function(){d=this};q.prototype._highlight=function(a,b,d){b&&(a=c.getPathObject(g,a.interactionPath+""),a.highlighted!=d&&(a.highlighted=d,a.traverse(function(a){d?b.apply(a,b.options):b.remove(a,b.options)})))};q.prototype.setDragged=function(a){d.setToggleHighlights(!1);p=a;d.setToggleHighlights(!0);return!0};q.prototype.removeDragged=function(){d.setToggleHighlights(!1);
p=null;d.setToggleHighlights(!0);return!0};q.prototype.getDragged=function(){return p};q.prototype.toggleSelected=function(a){d.setToggleHighlights(!1);for(var b=-1,c=0;c<e.length;c++)void 0!==a.interactionPath?a.interactionPath===e[c].interactionPath&&(b=c):e[c]==a&&(b=c);c=!1;-1<b?e.splice(b,1):(e.push(a),c=!0);r=!0;d.setToggleHighlights(!0,c);return c};q.prototype.setSelected=function(a){if(!a.interactionGroup)return!1;d.setToggleHighlights(!1);for(var b=-1,c=0;c<e.length;c++)void 0!==a.interactionPath?
a.interactionPath===e[c].interactionPath&&(b=c):e[c]==a&&(b=c);-1===b&&e.push(a);r=-1===b;d.setToggleHighlights(!0);return!0};q.prototype.removeSelected=function(a){if(!a.interactionGroup)return!1;var b=!1;d.setToggleHighlights(!1);for(var c=-1,l=0;l<e.length;l++)void 0!==a.interactionPath?a.interactionPath===e[l].interactionPath&&(c=l):e[l]==a&&(c=l);-1!==c&&(e.splice(c,1),b=!0);r=-1!==c;d.setToggleHighlights(!0);return b};q.prototype.getSelected=function(){return e};q.prototype.setHovered=function(a){d.setToggleHighlights(!1);
f=a;d.setToggleHighlights(!0);return!0};q.prototype.removeHovered=function(){d.setToggleHighlights(!1);f=null;d.setToggleHighlights(!0);return!0};q.prototype.getHovered=function(){return f};q.prototype.removeObject=function(a){d.removeSelected(a);f===a&&(f=null);p===a&&(p=null);a=m.indexOf(a);-1!=a&&m.splice(a,1);return!0};q.prototype.setInteractable=function(a){if(!Array.isArray(a))return!1;d.setToggleHighlights(!1);m=a;d.setToggleHighlights(!0);return!0};q.prototype.setToggleHighlights=function(a){if("boolean"!==
typeof a)return b.threeDManager.warn("HighlightingHandler.setToggleHighlights","Not a boolean. The highlighting was not toggled."),!1;if(h==a)return!1;b.threeDManager.helpers.toggleViewport(!0);h=a;if(p){var c=b.interactionGroupManager.getGroup(p.interactionGroup);d._highlight(p,c.getDraggableHighlight().active,a)}var n=0;for(c=e.length;n<c;n++){var l=e[n],g=b.interactionGroupManager.getGroup(l.interactionGroup);d._highlight(l,g.getSelectableHighlight().active,a)}f&&!r&&(c=b.interactionGroupManager.getGroup(f.interactionGroup),
d._highlight(f,c.getHoverableHighlight().active,a));if(p)for(n=b.interactionGroupManager.getGroup(p.interactionGroup),l=0,c=m.length;l<c;l++)m[l].interactionGroup==p.interactionGroup&&m[l]!=p&&d._highlight(m[l],n.getDraggableHighlight().passive,a);if(f&&!r)for(n=b.interactionGroupManager.getGroup(f.interactionGroup),l=0,c=m.length;l<c;l++)m[l].interactionGroup==f.interactionGroup&&m[l]!=f&&d._highlight(m[l],n.getHoverableHighlight().passive,a);n=0;for(c=e.length;n<c;n++){l=e[n];g=b.interactionGroupManager.getGroup(l.interactionGroup);
for(var q={i$204:0},t=m.length;q.i$204<t;q={i$204:q.i$204},q.i$204++)m[q.i$204].interactionGroup==l.interactionGroup&&(e.includes(m[q.i$204])||(void 0!==m[q.i$204].interactionPath?0===e.filter(function(a){return function(b){return b.interactionPath===m[a.i$204].interactionPath}}(q)).length&&d._highlight(m[q.i$204],g.getSelectableHighlight().passive,a):d._highlight(m[q.i$204],g.getSelectableHighlight().passive,a)))}r&&(r=h);b.threeDManager.helpers.toggleViewport(!1);return!0};q.prototype.getToggleHighlights=
function(){return h};return new q(a)}};var module$src$3d$viewports$default$handlers$InteractionHandler={default:function(a,b){var c=a.pathUtils,g=a.settings,d=a.scene,f=a.geometryNode,p,e=[],m=b.renderingHandler.getDomElement(),h=!1,r,q=new module$src$externals$three.default.Vector3,t=new module$src$externals$three.default.Vector3,u=function(){p=this;r=new module$src$externals$three.default.DragControls(e,b.cameraHandler.getCamera(),m);r.addEventListener("dragstart",p._interactionStartEvent);r.addEventListener("drag",p._interactionEvent);
r.addEventListener("dragend",p._interactionEndEvent);r.addEventListener("hoveron",p._hoverStartEvent);r.addEventListener("hover",p._hoverEvent);r.addEventListener("hoveroff",p._hoverEndEvent);r.addEventListener("emptyclick",p._interactionEmptyClickEvent);r.addEventListener("mousedowncustom",function(){h=!0});r.addEventListener("mouseupcustom",function(){h=!1});b.highlightingHandler=new module$src$3d$viewports$default$handlers$HighlightingHandler.default({settings:g,scene:d,geometryNode:f,pathUtils:c},
b);b.threeDManager.highlightingHandler=b.highlightingHandler};u.prototype._dispatchEvent=function(a){for(var b=new CustomEvent(a.type),c=$jscomp.makeIterator(a),d=c.next();!d.done;d=c.next())d=d.value,b[d]=a[d];m.dispatchEvent(b);return b};u.prototype._interactionStartEvent=function(a){if(a.object.interactionGroup){var d=b.interactionGroupManager.getGroup(a.object.interactionGroup);if(d&&(1==d.isDraggable()||1==d.isSelectable())){var e=void 0===a.object.interactionPath||!0===a.object.parent.meshHelper&&
"global"!==a.object.parent.interactionType?a.object.parent:c.getPathObject(f,a.object.interactionPath+"");if(1==d.isDraggable()){q.copy(a.object.position);t.copy(a.object.position);b.threeDManager.updateSetting("camera.enableOrbitControls",!1);b.renderingHandler.updateShadowMap();b.highlightingHandler.setDragged(a.object);b.renderingHandler.registerForContinuousRendering("interactionInProcess");var n={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_DRAG_START,obj:e,
scenePath:c.getObjectPath(e),dragPosStart:q.clone(),clientX:a.event.clientX,clientY:a.event.clientY},h=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,n);b.threeDManager.message(n.type+"."+n.scenePath,h);p._dispatchEvent(n)}if(1==d.isSelectable()){d={clientX:a.event.clientX,clientY:a.event.clientY};if(b.highlightingHandler.toggleSelected(a.object)){if(d.type=module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SELECT_ON,
"single"===b.interactionGroupManager.getGroup(a.object.interactionGroup).getSelectionMode()){n=b.highlightingHandler.getSelected();h=0;for(var g=n.length;h<g;h++)if(n[h].interactionGroup==a.object.interactionGroup&&n[h]!=a.object){g=void 0===n[h].interactionPath||!0===n[h].parent.meshHelper&&"global"!==n[h].parent.interactionType?n[h].parent:c.getPathObject(f,n[h].interactionPath+"");b.highlightingHandler.removeSelected(n[h]);n={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SELECT_OFF,
obj:g,scenePath:c.getObjectPath(g),clientX:a.event.clientX,clientY:a.event.clientY};h=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,n);b.threeDManager.message(n.type+"."+n.scenePath,h);p._dispatchEvent(n);break}}}else d.type=module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SELECT_OFF;d.obj=e;d.scenePath=c.getObjectPath(e);d.type===module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SELECT_ON&&
(d.selectPos=a.point);a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,d);b.threeDManager.message(d.type+"."+d.scenePath,a);p._dispatchEvent(d);b.renderingHandler.render()}}}};u.prototype._interactionEvent=function(a){if(a.object.interactionGroup){var d=b.interactionGroupManager.getGroup(a.object.interactionGroup);d&&0!=d.isDraggable()&&a.position&&(d=void 0===a.object.interactionPath||!0===a.object.parent.meshHelper&&
"global"!==a.object.parent.interactionType?a.object.parent:c.getPathObject(f,a.object.interactionPath+""),d.position.add(a.position.clone().sub(t)),t.copy(a.position),a={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_DRAG_MOVE,obj:d,scenePath:c.getObjectPath(d),dragPosStart:q.clone(),dragPosAbs:t.clone(),clientX:a.event.clientX,clientY:a.event.clientY},a.dragPosRel=a.dragPosAbs.clone().sub(a.dragPosStart),d=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,
a),b.threeDManager.message(a.type+"."+a.scenePath,d),p._dispatchEvent(a),b.renderingHandler.updateShadowMap())}};u.prototype._interactionEndEvent=function(a){if(a.object.interactionGroup){var d=b.interactionGroupManager.getGroup(a.object.interactionGroup);if(d&&0!=d.isDraggable()){b.highlightingHandler.removeDragged();d={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_DRAG_END,clientX:a.event.clientX,clientY:a.event.clientY};var e=b.highlightingHandler.getHovered();
e&&(e=void 0===e.interactionPath||!0===e.parent.meshHelper&&"global"!==e.parent.interactionType?e.parent:c.getPathObject(f,e.interactionPath+""),d.hovered={obj:e,scenePath:c.getObjectPath(e)});a=void 0===a.object.interactionPath||!0===a.object.parent.meshHelper&&"global"!==a.object.parent.interactionType?a.object.parent:c.getPathObject(f,a.object.interactionPath+"");d.obj=a;d.scenePath=c.getObjectPath(a);d.dragPosStart=q.clone();d.dragPosAbs=t.clone();d.dragPosRel=d.dragPosAbs.clone().sub(d.dragPosStart);
a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,d);b.threeDManager.message(d.type+"."+d.scenePath,a);b.threeDManager.updateSetting("camera.enableOrbitControls",!0);b.renderingHandler.unregisterForContinuousRendering("interactionInProcess");p._dispatchEvent(d)}}};u.prototype._interactionEmptyClickEvent=function(){for(var a=b.highlightingHandler.getSelected(),d=!1,e=a.length;e--;)if("single"===b.interactionGroupManager.getGroup(a[e].interactionGroup).getSelectionMode()){d=
void 0===a[e].interactionPath||!0===a[e].parent.meshHelper&&"global"!==a[e].parent.interactionType?a[e].parent:c.getPathObject(f,a[e].interactionPath+"");b.highlightingHandler.removeSelected(a[e]);d={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SELECT_OFF,obj:d,scenePath:c.getObjectPath(d)};var h=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,d);b.threeDManager.message(d.type+
"."+d.scenePath,h);p._dispatchEvent(d);d=!0}1==d&&b.renderingHandler.render()};u.prototype._hoverStartEvent=function(a){if((!0!==h||b.highlightingHandler.getDragged())&&a.object.interactionGroup){var d=b.interactionGroupManager.getGroup(a.object.interactionGroup);d&&0!=d.isHoverable()&&(d=void 0===a.object.interactionPath||!0===a.object.parent.meshHelper&&"global"!==a.object.parent.interactionType?a.object.parent:c.getPathObject(f,a.object.interactionPath+""),b.highlightingHandler.setHovered(a.object),
b.renderingHandler.registerForContinuousRendering("hoverInProcess"),a={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_HOVER_ON,obj:d,scenePath:c.getObjectPath(d),hoverPos:a.point,clientX:a.event.clientX,clientY:a.event.clientY},d=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,a),b.threeDManager.message(a.type+"."+a.scenePath,d),p._dispatchEvent(a))}};u.prototype._hoverEvent=
function(a){if((!0!==h||b.highlightingHandler.getDragged())&&a.object.interactionGroup){var d=b.interactionGroupManager.getGroup(a.object.interactionGroup);if(d&&0!=d.isHoverable()){d=void 0===a.object.interactionPath||!0===a.object.parent.meshHelper&&"global"!==a.object.parent.interactionType?a.object.parent:c.getPathObject(f,a.object.interactionPath+"");if(b.highlightingHandler.getHovered()!==a.object){b.highlightingHandler.setHovered(a.object);b.renderingHandler.registerForContinuousRendering("hoverInProcess");
var e={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_HOVER_ON,obj:d,scenePath:c.getObjectPath(d),hoverPos:a.point,clientX:a.event.clientX,clientY:a.event.clientY},g=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,e);b.threeDManager.message(e.type+"."+e.scenePath,g);p._dispatchEvent(e)}a={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_HOVER_OVER,
obj:d,scenePath:c.getObjectPath(d),hoverPos:a.point,clientX:a.event.clientX,clientY:a.event.clientY};d=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,a);b.threeDManager.message(a.type+"."+a.scenePath,d);p._dispatchEvent(a)}}};u.prototype._hoverEndEvent=function(a){if(b.highlightingHandler.getHovered()&&a.object.interactionGroup){var d=b.interactionGroupManager.getGroup(a.object.interactionGroup);d&&
0!=d.isHoverable()&&(d=void 0===a.object.interactionPath||!0===a.object.parent.meshHelper&&"global"!==a.object.parent.interactionType?a.object.parent:c.getPathObject(f,a.object.interactionPath+""),b.highlightingHandler.removeHovered(),a={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_HOVER_OFF,obj:d,scenePath:c.getObjectPath(d),clientX:a.event.clientX,clientY:a.event.clientY},d=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,
a),b.threeDManager.message(a.type+"."+a.scenePath,d),b.renderingHandler.unregisterForContinuousRendering("hoverInProcess"),p._dispatchEvent(a))}};u.prototype.addToInteractionGroup=function(a,d,h,g){var l=c.getPathObject(f,a+"");if(!l)return b.threeDManager.warn("InteractionHandler.addToInteractionGroup","No valid path provided, interactivity was not set."),!1;if(!d||!b.interactionGroupManager.isInteractionGroup(d))return b.threeDManager.warn("InteractionHandler.addToInteractionGroup","No valid group provided, interactivity was not set."),
!1;var n=b.interactionGroupManager.getGroup(d);if(!n)return!1;var m=n.isSelectable(d)||n.isDraggable(d)||n.isHoverable(d);"global"===h&&(l.interactionGroup=d);l.traverse(function(b){"Mesh"==b.type&&(b.interactionGroup=d,!0===b.parent.meshHelper&&(b.parent.interactionGroup=d,b.interactionPath=c.getObjectPath(b.parent.parent),b.parent.interactionType="global"===h?"global":"sub"),"global"===h&&(b.interactionPath=a+""),m&&e.push(b))});g?p.setInteractionPlaneNormal(a,g):p.removeInteractionPlaneNormal(a);
r.setObjects(e);b.highlightingHandler.setInteractable(e);return!0};u.prototype.removeFromInteractions=function(a){a=c.getPathObject(f,a+"");if(!a)return b.threeDManager.warn("InteractionHandler.removeFromInteractionGroup","No valid path provided, interactivity was not removed."),!1;a.traverse(function(a){for(var d=b.highlightingHandler.getSelected(),f=-1,h=0;h<d.length;h++)void 0!==a.interactionPath?a.interactionPath===d[h].interactionPath&&(f=h):d[h]==a&&(f=h);-1!==f&&(b.highlightingHandler.removeObject(a),
d={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SELECT_OFF,obj:a,scenePath:c.getObjectPath(a)},f=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,d),b.threeDManager.message(d.type+"."+d.scenePath,f),p._dispatchEvent(d));a===b.highlightingHandler.getHovered()&&(b.highlightingHandler.removeHovered(),b.highlightingHandler.removeObject(a),d={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_HOVER_OFF,
obj:a,scenePath:c.getObjectPath(a)},f=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,d),b.threeDManager.message(d.type+"."+d.scenePath,f),b.renderingHandler.unregisterForContinuousRendering("hoverInProcess"),p._dispatchEvent(d));a===b.highlightingHandler.getDragged()&&(b.highlightingHandler.removeDragged(),b.highlightingHandler.removeObject(a),d=void 0!==a.interactionPath?t:a.position,d={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_DRAG_END,
obj:a,scenePath:c.getObjectPath(a),dragPosStart:q.clone(),dragPosAbs:d.clone()},d.dragPosRel=d.dragPosAbs.clone().sub(d.dragPosStart),f=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,d),b.threeDManager.message(d.type+"."+d.scenePath,f),b.threeDManager.updateSetting("camera.enableOrbitControls",!0),b.renderingHandler.unregisterForContinuousRendering("interactionInProcess"),p._dispatchEvent(d));"Mesh"==
a.type&&(delete a.interactionGroup,delete a.interactionPath,a=e.indexOf(a),-1<a&&e.splice(a,1))});r.setObjects(e);b.highlightingHandler.setInteractable(e);return!0};u.prototype.removeAllInteractivity=function(){for(var a=0,c=e.length;a<c;a++)b.highlightingHandler.removeObject(e[a]),delete e[a].interactionGroup,delete e[a].interactionPath;e=[];r.setObjects(e);b.highlightingHandler.setInteractable(e);return!0};u.prototype.setSelectedPaths=function(a,d){a=a||[];d=d||[];for(var h=p.getSelectedPaths(),
g=[],l=[],n=0,m=e.length;n<m;n++)void 0!==e[n].interactionPath?(g.push(e[n].interactionPath),l.push("global")):(g.push(c.getObjectPath(e[n])),l.push("sub"));l=0;for(m=a.length;l<m;l++){if(!0!==module$src$shared$util$GlobalUtils.default.typeCheck(a[l],"string"))return b.threeDManager.warn("InteractionHandler.setSelectedPaths","At least one path is not a string."),!1;if(!g.includes(a[l]))return b.threeDManager.warn("InteractionHandler.setSelectedPaths","At least one path is not interactable."),!1}l=
0;for(m=d.length;l<m;l++){if(!0!==module$src$shared$util$GlobalUtils.default.typeCheck(d[l],"string"))return b.threeDManager.warn("InteractionHandler.setSelectedPaths","At least one path is not a string."),!1;if(!g.includes(d[l]))return b.threeDManager.warn("InteractionHandler.setSelectedPaths","At least one path is not interactable."),!1}g=0;for(m=d.length;g<m;g++)h.includes(d[g])&&c.getPathObject(f,d[g]+"").traverse(function(a){"Mesh"==a.type&&b.highlightingHandler.removeSelected(a)});h=p.getSelectedPaths();
d=0;for(m=a.length;d<m;d++)h.includes(a[d])||c.getPathObject(f,a[d]+"").traverse(function(a){if("Mesh"==a.type){if("single"===b.interactionGroupManager.getGroup(a.interactionGroup).getSelectionMode())for(var c=b.highlightingHandler.getSelected(),d=0,e=c.length;d<e;d++)if(c[d].interactionGroup==a.interactionGroup){b.highlightingHandler.removeSelected(c[d]);break}b.highlightingHandler.setSelected(a)}});b.renderingHandler.render();return!0};u.prototype.getSelectedPaths=function(){for(var a=b.highlightingHandler.getSelected(),
d=[],e=0,f=a.length;e<f;e++)void 0!==a[e].interactionPath?d.push(a[e].interactionPath+""):d.push(c.getObjectPath(a[e]));return d};u.prototype.setInteractionPlaneNormal=function(a,d){a=c.getPathObject(f,a);if(!a)return b.threeDManager.warn("InteractionHandler.setInteractionPlaneNormal","No valid path provided, interaction plane was not set."),!1;a.traverse(function(a){"Mesh"==a.type&&(a.interactionPlaneNormal=d)});return!0};u.prototype.removeInteractionPlaneNormal=function(a){a=c.getPathObject(f,a);
if(!a)return b.threeDManager.warn("InteractionHandler.removeInteractionPlaneNormal","No valid path provided, interaction plane was not removed."),!1;a.traverse(function(a){"Mesh"==a.type&&a.hasOwnProperty("interactionPlaneNormal")&&delete a.interactionPlaneNormal});return!0};return new u(a)}};var module$src$3d$viewports$default$ThreeDManager={default:function(a,b){var c=b.pathUtils,g=b.settings,d=b.scene,f=b.geometryNode,p=b.container,e=b.interactionGroupManager,m={},h=[],r,q,t,u,n,l=0,v=p.offsetWidth,x=p.offsetHeight,w={},y=!0,z=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean"))return!1;p&&(p.style.opacity=a?1:0);return!0},B=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string"))return!1;p&&(p.style.transition=0<a.length?"opacity "+
a:"none");return!0},A=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",r.warn,"ThreeDManager.Hook->fullscreen"))return!1;var b=p;if("true"!=p.getAttribute("sdv-fullscreen"))for(var c=p.parentElement,d=!1;!d&&null!==c;)"true"==c.getAttribute("sdv-fullscreen")?(d=!0,b=c):c=c.parentElement;return a&&!r._isInFullScreen()?(b.requestFullscreen?b.requestFullscreen():b.webkitRequestFullscreen?b.webkitRequestFullscreen():b.msRequestFullscreen?b.msRequestFullscreen():b.mozRequestFullScreen&&
b.mozRequestFullScreen(),w.left=b.style.left,w.top=b.style.top,w.backgroundColor=b.style.backgroundColor,b.style.left="0%",b.style.top="0%",b.style.backgroundColor=b.style.backgroundColor||"rgba(255,255,255,1)",m.renderingHandler.render(),!0):!a&&r._isInFullScreen()?(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen&&document.mozCancelFullScreen(),module$src$shared$util$GlobalUtils.default.typeCheck(w.left,
"string")&&(b.style.left=w.left,delete w.left),module$src$shared$util$GlobalUtils.default.typeCheck(w.top,"string")&&(b.style.top=w.top,delete w.top),module$src$shared$util$GlobalUtils.default.typeCheck(w.backgroundColor,"string")&&""!==w.backgroundColor&&(b.style.backgroundColor=w.backgroundColor,delete w.backgroundColor),m.renderingHandler.render(),!0):r._isInFullScreen()===a?!0:!1},D=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",r.warn,"ThreeDManager.Hook->groundPlaneVisibility"))return!1;
u&&(u.visible=a);m.renderingHandler.render();return!0},H=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",r.warn,"ThreeDManager.Hook->groundPlaneReflectionVisibility"))return!1;n&&(n.visible=a);a&&(r.warn("ThreeDManager.Hook->groundPlaneReflectionVisibility","The ground plane reflection and the environment as background do not work together right now."),r.updateSetting("material.environmentMapAsBackground",!1),m.materialHandler.setSceneBackground(null));m.renderingHandler.render();
return!0},G=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"number",r.warn,"ThreeDManager.Hook->groundPlaneReflectionThreshold"))return!1;n&&(n.threshold=a);m.renderingHandler.render();return!0},E=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",r.warn,"ThreeDManager.Hook->gridVisibility"))return!1;t&&(t.visible=a);m.renderingHandler.render();return!0},J=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"number",r.warn,"ThreeDManager.Hook->duration"))return!1;
l=a;return!0},F=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",r.warn,"ThreeDManager.Hook->ignorePointerEvents"))return!1;m.renderingHandler.getDomElement().style.pointerEvents=a?"none":"";return!0},C=function(a,b){module$src$3d$interfaces$ThreeDManagerInterface.default.call(this,b,module$src$shared$util$GlobalUtils.default);r=this;r.constants=module$src$3d$viewports$default$ThreeDManagerConstants.default;m.threeDManager=r;r.viewerApi=a;q=new module$src$3d$helpers$ThreeDManagerHelpers.default({scene:d,
geometryNode:f,pathUtils:c},m);m.threeDManager.helpers=q;p.style.padding="0";module$src$shared$mixins$SettingsMixin.default.call(r,g,module$src$3d$viewports$default$ThreeDManagerConstants.default.defaultSettings,b.runtimeId);document.addEventListener("webkitfullscreenchange",function(){r.updateSetting("fullscreen",r._isInFullScreen())},!1);document.addEventListener("mozfullscreenchange",function(){r.updateSetting("fullscreen",r._isInFullScreen())},!1);document.addEventListener("fullscreenchange",
function(){r.updateSetting("fullscreen",r._isInFullScreen())},!1);this.renderingHandler=new module$src$3d$viewports$default$handlers$RenderingHandler.default({settings:r.getSection("render"),scene:d,geometryNode:f,container:p},m);m.renderingHandler=this.renderingHandler;!1!==r.success&&(this.materialHandler=new module$src$3d$viewports$default$handlers$MaterialHandler.default({settings:r.getSection("material"),scene:d,geometryNode:f,pathUtils:c},m),m.materialHandler=this.materialHandler,!1!==r.success&&
(this.cameraHandler=new module$src$3d$viewports$default$handlers$CameraHandler.default({settings:r.getSection("camera"),scene:d,geometryNode:f,container:p},m),m.cameraHandler=this.cameraHandler,!1!==r.success&&(this.lightHandler=new module$src$3d$viewports$default$handlers$LightHandler.default({settings:r.getSection("lights"),shadows:r.getSettingShallow("render.shadows"),scene:d,geometryNode:f},m),m.lightHandler=this.lightHandler,!1!==r.success&&(m.interactionGroupManager=e,m.threeDManager.interactionGroupManager=
e,this.interactionHandler=new module$src$3d$viewports$default$handlers$InteractionHandler.default({settings:r.getSection("interaction"),scene:d,geometryNode:f,pathUtils:c},m),m.interactionHandler=this.interactionHandler,!1!==r.success&&(this.registerHook("show",z),this.registerHook("showTransition",B),this.registerHook("fullscreen",A),this.registerHook("groundPlaneVisibility",D),this.registerHook("groundPlaneReflectionVisibility",H),this.registerHook("groundPlaneReflectionThreshold",G),this.registerHook("gridVisibility",
E),this.registerHook("duration",J),this.registerHook("ignorePointerEvents",F))))))};$jscomp.inherits(C,module$src$3d$interfaces$ThreeDManagerInterface.default);C.prototype._isInFullScreen=function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||document.mozFullScreenElement)};C.prototype._getExchangeMeshMaterialObjects=function(){return h};C.prototype.init=function(a){m.renderingHandler.unregisterForNoRendering("startUpId");var b=a.min.distanceTo(a.max);
if(1<b){var c=parseInt(b);c=c.toString();c=c.length;c=Math.pow(10,c-1);b=Math.max(Math.ceil(b/c)*c,1);c=b/(c/10)}else{c=1-Math.floor(Math.log(b)/Math.log(10))-2;b=b.toFixed(c+1);var d=parseInt(b.substr(b.length-1))+1;b="0.";for(var e=0;e<c;++e)b+="0";b=parseFloat(b+d);c=10*d}t=new module$src$externals$three.default.GridHelper(2*b,c);t.material.opacity=.15;t.material.transparent=!0;t.isSelectable=!1;t.rotateX(Math.PI/2);t.visible=r.getSetting("gridVisibility");c=new module$src$externals$three.default.Object3D;
c.SDLocalPath="grid";c.add(t);b=new module$src$externals$three.default.PlaneGeometry(2*b,2*b,2,2);d={color:13882323,side:module$src$externals$three.default.FrontSide,roughness:1,metalness:0};u=new module$src$externals$three.default.Mesh(b,m.materialHandler.getMaterial(d));u.receiveShadow=!0;u.visible=r.getSetting("groundPlaneVisibility");e=new module$src$externals$three.default.Object3D;e.SDLocalPath="groundplane";e.add(u);r.addMesh(u,u.material,d);n=new module$src$externals$three.default.Reflector(b,
{clipBias:.003,textureWidth:v*window.devicePixelRatio,textureHeight:x*window.devicePixelRatio,color:7829367,recursion:1});n.receiveShadow=!0;n.transparent=!0;n.visible=r.getSetting("groundPlaneReflectionVisibility");n.visible&&r.updateSetting("material.environmentMapAsBackground",!1);e.add(n);t.position.set(0,0,a.min.z-.005);u.position.set(0,0,a.min.z-.005);n.scale.set(1E3,1E3,1E3);n.position.set(0,0,a.min.z-.005);q.addSceneObject(c);q.addSceneObject(e);q.initialize();r.adjustScene()};C.prototype.adjustScene=
function(){if(q.isInitialized()){var a=f.computeSceneBoundingBox(),b=new module$src$externals$three.default.Sphere;a.getBoundingSphere(b);t.position.set(0,0,a.min.z-.005);u.position.set(0,0,a.min.z-.005);n.position.set(0,0,a.min.z-.005);m.materialHandler.adjustToBoundingSphere(b);m.lightHandler.adjustToBoundingSphere(b);m.cameraHandler.adjustToBoundingSphere(b);m.renderingHandler.updateShadowMap();m.materialHandler.compile()}};C.prototype.computeBoundingBox=function(a){return f.computeBoundingBox(a)};
C.prototype.pause=function(){y=!1;m.renderingHandler.pause();m.cameraHandler.pause();m.lightHandler.pause();m.materialHandler.pause()};C.prototype.resume=function(){y=!0;m.renderingHandler.resume();m.cameraHandler.resume();m.lightHandler.resume();m.materialHandler.resume()};C.prototype.destroy=function(){delete m.threeDManager;q.destroyViewport();m.renderingHandler&&m.renderingHandler.destroy();m.cameraHandler&&m.cameraHandler.destroy();m.lightHandler&&m.lightHandler.destroy();m.materialHandler&&
m.materialHandler.destroy();r.deregisterAllHooks();for(r.deregisterAllNotifiers();p.firstChild;)p.removeChild(p.firstChild);for(var a in m)delete m[a]};C.prototype.addMesh=function(a,b,c){q.addMesh(a,b,c)};C.prototype.removeMesh=function(a){for(var b=0,c=h.length;b<c;b++)if(a===h[b].mesh){h.splice(b,1);break}q.removeMesh(a)};C.prototype.addAnchor=function(a,b){q.addAnchor(a,b)};C.prototype.removeAnchor=function(a){q.removeAnchor(a)};C.prototype.fadeIn=function(a,b){var d=c.getPathObject(f,a);if(null==
d)return Promise.reject(Error("Could not fade in geometry, path not found"));y?module$src$shared$util$GlobalUtils.default.typeCheck(b,"number")||(b=l):b=0;return new Promise(function(c){q.toggleMeshes(!0);d.traverseVisible(function(a){a.SDMaterialDefinition&&a.material&&(a.material.transparent=!0,a.material.opacity=0)});q.toggleMeshes(!1);var e={opacity:0},f=(new module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween(e)).to({opacity:1},b).onUpdate(function(){q.toggleMeshes(!0);d.traverseVisible(function(a){a.SDMaterialDefinition&&
a.material&&(a.material.opacity="gem"===a.SDMaterialDefinition.materialType?a.material.side===module$src$externals$three.default.FrontSide?e.opacity*(a.SDMaterialDefinition.transparent?a.SDMaterialDefinition.opacityFront:1):e.opacity*(a.SDMaterialDefinition.transparent?a.SDMaterialDefinition.opacityBack:1):e.opacity*(a.SDMaterialDefinition.transparent?a.SDMaterialDefinition.opacity:1))});q.toggleMeshes(!1)}).onComplete(function(){q.toggleMeshes(!0);d.traverseVisible(function(a){a.SDMaterialDefinition&&
a.material&&(a.material.opacity="gem"===a.SDMaterialDefinition.materialType?a.material.side===module$src$externals$three.default.FrontSide?a.SDMaterialDefinition.opacityFront:a.SDMaterialDefinition.opacityBack:a.SDMaterialDefinition.opacity,a.material.transparent=a.SDMaterialDefinition.transparent)});q.toggleMeshes(!1);m.renderingHandler.unregisterForContinuousRendering("FADE_IN_"+a);c()});m.renderingHandler.registerForContinuousRendering("FADE_IN_"+a);f.start()})};C.prototype.fadeOut=function(a,
b){var d=c.getPathObject(f,a);if(null==d)return Promise.reject(Error("Could not fade out, geometry, path not found."));y?module$src$shared$util$GlobalUtils.default.typeCheck(b,"number")||(b=l):b=0;return new Promise(function(c){q.toggleMeshes(!0);d.traverseVisible(function(a){a.hasOwnProperty("material")&&(a.material.transparent=!0)});q.toggleMeshes(!1);var e={opacity:1},f=(new module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween(e)).to({opacity:0},b).onUpdate(function(){q.toggleMeshes(!0);
d.traverseVisible(function(a){a.SDMaterialDefinition&&a.material&&(a.material.opacity="gem"===a.SDMaterialDefinition.materialType?a.material.side===module$src$externals$three.default.FrontSide?e.opacity*a.SDMaterialDefinition.opacityFront:e.opacity*a.SDMaterialDefinition.opacityBack:e.opacity*a.SDMaterialDefinition.opacity)});q.toggleMeshes(!1)}).onComplete(function(){q.toggleMeshes(!0);d.traverseVisible(function(a){a.SDMaterialDefinition&&a.material&&(a.material.opacity=0)});q.toggleMeshes(!1);m.renderingHandler.unregisterForContinuousRendering("FADE_OUT_"+
a);c()});m.renderingHandler.registerForContinuousRendering("FADE_OUT_"+a);f.start()})};C.prototype.setLiveTransformation=function(a,b,c,d,e){return q.setLiveTransformation(a,b,c,d,e)};C.prototype.updateInteractions=function(a,b){if(b&&module$src$shared$util$GlobalUtils.default.typeCheck(b.interactionGroup,"string")){m.highlightingHandler.setToggleHighlights(!1);var c=b.interactionGroup,d="sub";module$src$shared$util$GlobalUtils.default.typeCheck(b.interactionMode,"string")&&"global"===b.interactionMode&&
(d="global");b=module$src$shared$util$GlobalUtils.default.typeCheck(b.dragPlaneNormal,"vector3any")?module$src$shared$util$GlobalUtils.default.toVector3(b.dragPlaneNormal):void 0;m.interactionHandler.addToInteractionGroup(a,c,d,b);m.highlightingHandler.setToggleHighlights(!0)}};C.prototype.removeFromInteractions=function(a){m.interactionHandler.removeFromInteractions(a)};return new C(a,b)}};var module$src$3d$viewports$default$api$CameraApi={default:function(a,b){var c=b.threeDManager,g=b.apiResponse;a=function(){module$src$3d$interfaces$api$CameraApiInterface.default.call(this);this.TYPE={PERSPECTIVE:0,TOP:1,BOTTOM:2,RIGHT:3,LEFT:4,BACK:5,FRONT:6,AR:7};this.get=this.get.bind(this);this.updateAsync=this.updateAsync.bind(this);this.animateAsync=this.animateAsync.bind(this);this.zoomAsync=this.zoomAsync.bind(this);this.resetAsync=this.resetAsync.bind(this);this.updateMatrices=this.updateMatrices.bind(this)};
$jscomp.inherits(a,module$src$3d$interfaces$api$CameraApiInterface.default);a.prototype.get=function(){return g(null,c.cameraHandler.getPositionAndTarget())};a.prototype.updateAsync=function(a,b){return c.cameraHandler.setPositionAndTarget(a.position,a.target,b).then(function(a){return a?g(null,c.cameraHandler.getPositionAndTarget()):g("Setting new camera target and position failed",c.cameraHandler.getPositionAndTarget())})};a.prototype.animateAsync=function(a,b){if(!Array.isArray(a))return Promise.resolve(g("First parameter must be an array of CameraDefinitions"));
var d=[],e=[];a.forEach(function(a){d.push(a.position);e.push(a.target)});return c.cameraHandler.setCameraPath(d,e,b).then(function(a){return a?g(null,c.cameraHandler.getPositionAndTarget()):g("Camera path animation failed",c.cameraHandler.getPositionAndTarget())})};a.prototype.zoomAsync=function(a,b){return c.cameraHandler.zoomExtents(b,c.computeBoundingBox(a)).then(function(a){return a?g(null,c.cameraHandler.getPositionAndTarget()):g("Zooming to extents failed",c.cameraHandler.getPositionAndTarget())})};
a.prototype.resetAsync=function(a){return c.cameraHandler.resetPositionAndTarget(a).then(function(a){return a?g(null,c.cameraHandler.getPositionAndTarget()):g("Resetting camera position or target failed",c.cameraHandler.getPositionAndTarget())})};a.prototype.updateMatrices=function(a,b){c.cameraHandler.setViewAndProjectionMatrix(a,b)};return new a}};var module$src$3d$viewports$default$api$LightApi={default:function(a,b){var c=b.threeDManager,g=b.apiResponse,d,f,p;a=function(){module$src$3d$interfaces$api$LightApiInterface.default.call(this);this.TYPE={AMBIENT:0,DIRECTIONAL:1,SPOT:2};this.LIGHTSCENE={DEFAULT:"default",DEFAULT_LEGACY:"default_legacy",TEST:"test"};d=function(){for(var a=[],b=1;9>=b;b++){var d=c.getSetting("lights.light"+b);d&&d.hasOwnProperty("type")&&d.hasOwnProperty("properties")&&(d.properties.id=b,d.properties.type=d.type,a.push(d.properties))}return a};
f=function(a){return!module$src$shared$util$GlobalUtils.default.typeCheck(a,"number")||1>a||9<a?!1:!0};p=function(){for(var a=1;9>=a;a++){var b=c.getSetting("lights.light"+a);if(!b||isNaN(b.type)||!b.properties)return a}return-1};this.get=this.get.bind(this);this.update=this.update.bind(this);this.remove=this.remove.bind(this);this.restore=this.restore.bind(this)};$jscomp.inherits(a,module$src$3d$interfaces$api$LightApiInterface.default);a.prototype.get=function(){return g(null,d())};a.prototype.update=
function(a){var b=this;a=a||[];Array.isArray(a)||(a=[a]);var e={};a=$jscomp.makeIterator(a);for(var r=a.next();!r.done;e={light:e.light},r=a.next()){e.light=r.value;if(!module$src$shared$util$GlobalUtils.default.typeCheck(e.light,"object"))return g("Invalid light definition");if(!Object.keys(this.TYPE).find(function(a){return function(c){return b.TYPE[c]===a.light.type}}(e)))return g("Unknown light type"+e.light.type);e.light=module$src$shared$util$GlobalUtils.default.deepCopy(e.light);r=e.light.type;
delete e.light.type;var q=void 0;if(e.light.hasOwnProperty("id")){if(!f(e.light.id))return g("Invalid light id"+e.light.id);q=e.light.id;delete e.light.id}else if(q=p(),!f(q))return g("All available light ids used");if(!c.updateSetting("lights.light"+q,{type:r,properties:e.light}))return g("Error ",d())}c.renderingHandler.updateShadowMap();c.renderingHandler.render();return this.get()};a.prototype.remove=function(a){if(!f(a))return g("Invalid light id");if(!c.updateSetting("lights.light"+a,{}))return g("Error removing light "+
a);c.renderingHandler.updateShadowMap();c.renderingHandler.render();return this.get()};a.prototype.restore=function(a){var b=this;if(!Object.keys(this.LIGHTSCENE).find(function(c){return b.LIGHTSCENE[c]===a}))return g("Unknown light scene");if(!c.lightHandler.restoreDefaultConfiguration(a))return g("Error restoring light scene");c.renderingHandler.updateShadowMap();c.renderingHandler.render();return this.get()};return new a}};var module$src$3d$viewports$default$api$ViewportApi={default:function(a,b){var c=b.threeDManager,g=b.viewportManager,d,f,p={};b=function(){module$src$3d$interfaces$api$ViewportApiInterface.default.call(this);this.utils=a.utils;this.EVENTTYPE=a.viewports.EVENTTYPE;this.camera=new module$src$3d$viewports$default$api$CameraApi.default(a,{threeDManager:c,viewportManager:g,apiResponse:this.utils.APIResponse});this.lights=new module$src$3d$viewports$default$api$LightApi.default(a,{threeDManager:c,apiResponse:this.utils.APIResponse});
d=module$src$3d$helpers$api$ViewportApiHelpers.default.getInstance();f={THREE_D_MANAGER_CONSTANTS:module$src$3d$viewports$default$ThreeDManagerConstants.default,EVENTTYPE:this.EVENTTYPE,threeDManager:c,viewportManager:g,apiResponse:this.utils.APIResponse,listeners:p};this.getRuntimeId=this.getRuntimeId.bind(this);this.getContainer=this.getContainer.bind(this);this.getScreenshot=this.getScreenshot.bind(this);this.render=this.render.bind(this);this.convertTo2D=this.convertTo2D.bind(this);this.onResize=
this.onResize.bind(this);this.getSize=this.getSize.bind(this);this.pause=this.pause.bind(this);this.resume=this.resume.bind(this);this.reload=this.reload.bind(this);this.destroy=this.destroy.bind(this);this.addEventListener=this.addEventListener.bind(this);this.removeEventListener=this.removeEventListener.bind(this);this.getSettingDefinitions=this.getSettingDefinitions.bind(this);this.getSettings=this.getSettings.bind(this);this.getSetting=this.getSetting.bind(this);this.updateSettingAsync=this.updateSettingAsync.bind(this);
this.updateSettingsAsync=this.updateSettingsAsync.bind(this);this.setTransformation=this.setTransformation.bind(this);this.getTransformation=this.getTransformation.bind(this);this.applyTransformation=this.applyTransformation.bind(this);this.resetTransformation=this.resetTransformation.bind(this);this.setLiveTransformation=this.setLiveTransformation.bind(this);this.updateSelected=this.updateSelected.bind(this);this.getSelected=this.getSelected.bind(this)};$jscomp.inherits(b,module$src$3d$interfaces$api$ViewportApiInterface.default);
b.prototype.getRuntimeId=function(){return c.runtimeId};b.prototype.getContainer=function(){return c.container};b.prototype.getScreenshot=function(){return c.renderingHandler.getScreenshot()};b.prototype.render=function(){c.renderingHandler.render()};b.prototype.convertTo2D=function(a){return d.convertTo2D(f,a)};b.prototype.onResize=function(a,b){c.cameraHandler.onResize(a,b);c.renderingHandler.onResize(a,b)};b.prototype.getSize=function(){return c.renderingHandler.getSize()};b.prototype.pause=function(){c.pause()};
b.prototype.resume=function(){c.resume()};b.prototype.reload=function(){return d.reload(f)};b.prototype.destroy=function(){return d.destroy(f)};b.prototype.addEventListener=function(a,b){return d.addEventListener(f,a,b)};b.prototype.removeEventListener=function(a){return d.removeEventListener(f,a)};b.prototype.getSettingDefinitions=function(){return d.getSettingDefinitions(f)};b.prototype.getSettings=function(a){return d.getSettings(f,a)};b.prototype.getSetting=function(a){return d.getSetting(f,a)};
b.prototype.updateSettingAsync=function(a,b){return d.updateSettingAsync(f,a,b)};b.prototype.updateSettingsAsync=function(a){return d.updateSettingsAsync(f,a)};b.prototype.setTransformation=function(a){return d.setTransformation(f,a)};b.prototype.getTransformation=function(){return d.getTransformation(f)};b.prototype.applyTransformation=function(a){return d.applyTransformation(f,a)};b.prototype.resetTransformation=function(){return d.resetTransformation(f)};b.prototype.setLiveTransformation=function(a,
b){return d.setLiveTransformation(f,a,b)};b.prototype.updateSelected=function(a,b){return c.interactionHandler.setSelectedPaths(a,b)};b.prototype.getSelected=function(){return c.interactionHandler.getSelectedPaths()};return new b}};var module$src$3d$ViewportManager={default:function(a,b){var c=[],g,d=!1,f,p,e,m,h=function(a,b){g=this;p=a;m=b;module$src$shared$util$GlobalUtils.default.inject({message:p.message,subscribeToMessageStream:p.subscribeToMessageStream,unsubscribeFromMessageStream:p.unsubscribeFromMessageStream},g);var e=g.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_VISIBILITY_ON,function(){g.unsubscribeFromMessageStream(e);f=p.sceneGeometryManager.getGeometryNode().computeSceneBoundingBox();
d=!0;for(var a=0,b=c.length;a<b;a++)p.settingsHandler.restoreSettings(c[a]),c[a].init(f),!0===p.getSetting("showScene")&&c[a].updateSetting("show",!0)})};h.prototype._convertInputObject=function(a){if(a.type&&"expo"===a.type||a.type&&"expo-ar"===a.type)return a;if(a.container){if(a.container instanceof Element)var b=a.container;else return;var d=a.type?a.type:"default";if(a=a.runtimeId){for(var e=!1,f=0,h=c.length;f<h;f++)c[f].runtimeId===a&&(e=!0);a=e?module$src$shared$util$GlobalUtils.default.createRandomId():
a}else a=module$src$shared$util$GlobalUtils.default.createRandomId()}else if(a instanceof Element)b=a,d="default",a=module$src$shared$util$GlobalUtils.default.createRandomId();else return;return{container:b,type:d,runtimeId:a}};h.prototype._createThreeDManager=function(a){e||(e=p.api({version:2}));if(!a)return null;if("simple"===a.type){var b=new module$src$3d$viewports$simple$ThreeDManager.default(e,{scene:p.sceneGeometryManager.getScene(),geometryNode:p.sceneGeometryManager.getGeometryNode(),pathUtils:p.sceneGeometryManager.getPathUtils(),
container:a.container,runtimeId:a.runtimeId,loggingHandler:m,messagingHandler:{message:p.message,subscribeToMessageStream:p.subscribeToMessageStream,unsubscribeFromMessageStream:p.unsubscribeFromMessageStream}});var c=new module$src$3d$viewports$simple$api$ViewportApi.default(e,{threeDManager:b,viewportManager:g})}else"expo"===a.type?(b=new module$src$3d$viewports$expo$default$ThreeDManager.default(e,{scene:p.sceneGeometryManager.getScene(),geometryNode:p.sceneGeometryManager.getGeometryNode(),pathUtils:p.sceneGeometryManager.getPathUtils(),
container:a.container,runtimeId:a.runtimeId,loggingHandler:m,messagingHandler:{message:p.message,subscribeToMessageStream:p.subscribeToMessageStream,unsubscribeFromMessageStream:p.unsubscribeFromMessageStream},ExpoTHREE:a.externalLibraries.ExpoTHREE,AR:a.externalLibraries.AR}),c=new module$src$3d$viewports$expo$default$api$ViewportApi.default(e,{threeDManager:b,viewportManager:g})):"expo-ar"===a.type?(b=new module$src$3d$viewports$expo$ar$ThreeDManager.default(e,{scene:p.sceneGeometryManager.getScene(),
geometryNode:p.sceneGeometryManager.getGeometryNode(),pathUtils:p.sceneGeometryManager.getPathUtils(),container:a.container,runtimeId:a.runtimeId,loggingHandler:m,messagingHandler:{message:p.message,subscribeToMessageStream:p.subscribeToMessageStream,unsubscribeFromMessageStream:p.unsubscribeFromMessageStream},ExpoTHREE:a.externalLibraries.ExpoTHREE,AR:a.externalLibraries.AR}),c=new module$src$3d$viewports$expo$ar$api$ViewportApi.default(e,{threeDManager:b,viewportManager:g})):(a.type="default",b=
new module$src$3d$viewports$default$ThreeDManager.default(e,{scene:p.sceneGeometryManager.getScene(),geometryNode:p.sceneGeometryManager.getGeometryNode(),pathUtils:p.sceneGeometryManager.getPathUtils(),container:a.container,runtimeId:a.runtimeId,loggingHandler:m,messagingHandler:{message:p.message,subscribeToMessageStream:p.subscribeToMessageStream,unsubscribeFromMessageStream:p.unsubscribeFromMessageStream},interactionGroupManager:p.interactionGroupManager}),c=new module$src$3d$viewports$default$api$ViewportApi.default(e,
{threeDManager:b,viewportManager:g}));b.type=a.type;b.runtimeId=a.runtimeId;b.container=a.container;b.api=c;b.startUpObject=a;b.transformationMatrix=new module$src$externals$three.default.Matrix4;b.transformationGroups=[];return b};h.prototype.createThreeDManager=function(a){if(!a)return null;Array.isArray(a)||(a=[a]);for(var b=[],e=0,h=a.length;e<h;e++){var n=g._convertInputObject(a[e]);n=g._createThreeDManager(n);c.push(n);if(!1===n.success)n.api.destroy();else{n.updateSetting("show",!1);n.updateSetting("showTransition",
p.getSetting("showSceneTransition"));for(var l=p.sceneGeometryManager.getMeshMaterialObjects(),m,r,w,y,z,B=0,A=l.length;B<A;B++)z=l[B],m=z.mesh,r=z.properties,w=z.hasTextureCoordinates,y=z.overrideColor,z=z.vertexColors,y=n.materialHandler.getMaterial(r,y,z),null===y||void 0===y?n.warn("The creation of a material failed."):(w||(y.map=null,y.alphaMap=null,y.aoMap=null,y.bumpMap=null,y.displacementMap=null,y.emissiveMap=null,y.normalMap=null,y.metalnessMap=null,y.roughnessMap=null),n.addMesh(m,y,r));
n&&(b.push(n.api),d&&(p.settingsHandler.restoreSettings(n),n.init(f),!0===p.getSetting("showScene")&&n.updateSetting("show",!0)))}}return b};h.prototype.removeThreeDManager=function(a){for(var b=0,d=c.length;b<d;b++)if(c[b].runtimeId===a){a=c[b];for(var e in a.api)delete a.api[e];a.destroy();c.splice(b,1);return!0}return!1};h.prototype.reloadThreeDManager=function(a){for(var b=0,d=c.length;b<d;b++)if(c[b].runtimeId===a){a=c[b];d=Object.assign({},a.startUpObject);a.destroy();c.splice(b,1);b=g.createThreeDManager(d)[d.runtimeId];
a.api.__proto__=b.__proto__;for(var e in b)a.api[e]=b[e];break}};h.prototype.getContainers=function(){for(var a=[],b=0,d=c.length;b<d;b++)a.push(c[b].container);return a};h.prototype.getDefaultThreeDManagers=function(){for(var a=[],b=0,d=c.length;b<d;b++)"default"===c[b].type&&a.push(c[b]);return a};h.prototype.getFirstDefaultThreeDManager=function(){var a=g.getDefaultThreeDManagers();return 0<a.length?a[0]:null};h.prototype.getFirstDefaultThreeDManagerApi=function(){var a=g.getDefaultThreeDManagers();
return 0<a.length?a[0].api:null};h.prototype.getApi=function(a){for(var b=null,d=0,e=c.length;d<e;d++)a===c[d].runtimeId&&(b=c[d].api);return b};h.prototype.getApis=function(){for(var a=[],b=0,d=c.length;b<d;b++)a.push(c[b].api);return a};h.prototype.getThreeDManagers=function(){return c};h.prototype.onlyOneDefault=function(){return 1===g.getDefaultThreeDManagers().length?!0:!1};h.prototype.updateSetting=function(a,b){for(var d=0,e=c.length;d<e;d++)c[d].updateSetting(a,b)};h.prototype.adjustScene=
function(){for(var a=0,b=c.length;a<b;a++)c[a].adjustScene()};h.prototype.fadeIn=function(a,b){for(var d=[],e=0,f=c.length;e<f;e++)d.push(c[e].fadeIn(a,b));return Promise.all(d)};h.prototype.fadeOut=function(a,b){for(var d=[],e=0,f=c.length;e<f;e++)d.push(c[e].fadeOut(a,b));return Promise.all(d)};h.prototype.updateInteractions=function(a,b){for(var d=0,e=c.length;d<e;d++)c[d].updateInteractions(a,b)};h.prototype.removeFromInteractions=function(a){for(var b=0,d=c.length;b<d;b++)c[b].removeFromInteractions(a)};
h.prototype.addMesh=function(a,b,d){for(var e=0,f=c.length;e<f;e++)c[e].addMesh(a,b[e],d)};h.prototype.removeMesh=function(a){for(var b=0,d=c.length;b<d;b++)c[b].removeMesh(a);a.geometry.dispose()};h.prototype.addAnchor=function(a,b){var d=[];b.viewports&&0!==b.viewports.length&&(d=b.viewports);for(var e=0,f=c.length;e<f;e++)(d.includes(c[e].runtimeId)||0===d.length)&&c[e].addAnchor(a,b)};h.prototype.removeAnchor=function(a){for(var b=0,d=c.length;b<d;b++)c[b].removeAnchor(a)};h.prototype.render=
function(){for(var a=0,b=c.length;a<b;a++)c[a].renderingHandler.render()};h.prototype.setBlur=function(a,b){for(var d=0,e=c.length;d<e;d++)c[d].renderingHandler.setBlur(a,b)};h.prototype.registerForContinuousRendering=function(a,b){for(var d=0,e=c.length;d<e;d++)c[d].renderingHandler.registerForContinuousRendering(a,b)};h.prototype.unregisterForContinuousRendering=function(a){for(var b=0,d=c.length;b<d;b++)c[b].renderingHandler.unregisterForContinuousRendering(a)};h.prototype.containsContinuousRendering=
function(a){for(var b=[],d=0,e=c.length;d<e;d++)b.push(c[d].renderingHandler.containsContinuousRendering(a));return b};h.prototype.updateShadowMap=function(){for(var a=0,b=c.length;a<b;a++)c[a].renderingHandler.updateShadowMap()};h.prototype.getMaterial=function(a,b,d,e,f){for(var h=[],g=0,n=c.length;g<n;g++)h.push(c[g].materialHandler.getMaterial(a,b,d,e,f));return h};return new h(a,b)}};var module$src$shared$util$PathUtils={default:function(){var a,b=null,c={},g=function(){a=this};g.prototype.setScene=function(a){b=a;b._sdIndexObj=c;c.obj=b};g.prototype.getChildByName=function(a,b){a=a._sdIndexObj;return null==a?null:module$src$shared$util$GlobalUtils.default.getAtPath(a,b+".obj")};g.prototype.getOrCreateChild=function(b,c){var d=b._sdIndexObj;if(null==d)return null;var e=a.getChildByName(b,c);null==e&&(e=new module$src$externals$three.default.Object3D,e.SDLocalPath=c,b.add(e),d[c]=
{obj:e},e._sdIndexObj=d[c]);return e};g.prototype.getPathObject=function(a,c){a=a||b;a=a._sdIndexObj;return null==a?null:module$src$shared$util$GlobalUtils.default.getAtPath(a,c+".obj")};g.prototype.ensurePath=function(b,c){c=c.split(".");c=$jscomp.makeIterator(c);for(var d=c.next();!d.done;d=c.next())b=a.getOrCreateChild(b,d.value);return b};g.prototype.deletePath=function(b,c){b=a.getPathObject(b,c);if(null==b)return!0;c=b.SDLocalPath;if(null==c||!module$src$shared$util$GlobalUtils.default.typeCheck(c,
"string")||""==c)return!1;var d=b.parent;if(null==d)return!1;var e=d._sdIndexObj;if(null==e)return!1;d.remove(b);delete e[c];return!0};g.prototype.getObjectPath=function(a){if(!a)return null;for(;a&&!a.hasOwnProperty("SDLocalPath");)a=a.parent;for(var b=[];a&&a.hasOwnProperty("SDLocalPath");)b.push(a.SDLocalPath),a=a.parent;b.reverse();a=b.join(".");return""===a?null:a};return new g}};var module$src$3d$controls$OrbitControls={default:{}},THREE$$module$src$3d$controls$OrbitControls=module$src$externals$three.default;
module$src$externals$three.default.OrbitControls=function(a,b){function c(){return Math.pow(.95,d.zoomSpeed)}function g(a){d.object instanceof module$src$externals$three.default.PerspectiveCamera?u=a:d.object instanceof module$src$externals$three.default.OrthographicCamera?n=a:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),d.enableZoom=!1)}this.object=a;this.isMoving=!1;this.lastMove=0;this.proxy=b;this.proxy.onContextMenu=function(a){a.preventDefault()};
this.proxy.onMouseDown=function(a){if(!1!==d.enabled){a.preventDefault();if(a.button===d.mouseButtons.ORBIT){if(!1===d.enableRotation)return;x.set(a.clientX,a.clientY);h=m.ROTATE}else if(a.button===d.mouseButtons.ZOOM){if(!1===d.enableZoom)return;D.set(a.clientX,a.clientY);h=m.DOLLY}else if(a.button===d.mouseButtons.PAN){if(!1===d.enablePan)return;z.set(a.clientX,a.clientY);h=m.PAN}h!==m.NONE&&(d.proxy.onStateChange(),d.dispatchEvent(p))}};this.proxy.onMouseWheel=function(a){if(!1!==d.enabled&&!1!==
d.enableZoom&&(h===m.NONE||h===m.ROTATE)){a.preventDefault();a.stopPropagation();var b=0;void 0!==a.wheelDelta?b=a.wheelDelta:void 0!==a.detail&&(b=-a.detail);0<b?g(-(1-c())):0>b&&g(1-c());d.update();d.dispatchEvent(p);d.dispatchEvent(e)}};this.proxy.onTouchStart=function(a){if(!1!==d.enabled){switch(a.touches.length){case 1:if(!1===d.enableRotation)return;x.set(a.touches[0].pageX,a.touches[0].pageY);h=m.TOUCH_ROTATE;break;case 2:if(!1===d.enableZoom)return;var b=a.touches[0].pageX-a.touches[1].pageX;
a=a.touches[0].pageY-a.touches[1].pageY;D.set(0,Math.sqrt(b*b+a*a));h=m.TOUCH_DOLLY;break;case 3:if(!1===d.enablePan)return;z.set(a.touches[0].pageX,a.touches[0].pageY);h=m.TOUCH_PAN;break;default:h=m.NONE}h!==m.NONE&&d.dispatchEvent(p)}};this.proxy.onTouchEnd=function(a){!1!==d.enabled&&(d.dispatchEvent(e),h=m.NONE)};this.proxy.onTouchMove=function(a){if(!1!==d.enabled)switch(a.touches.length){case 1:if(!1===d.enableRotation)break;if(h!==m.TOUCH_ROTATE)break;a.preventDefault();a.stopPropagation();
w.set(a.touches[0].pageX,a.touches[0].pageY);y.subVectors(w,x);var b=d.proxy.getClientSize();0!=b.width&&0!=b.height&&(t.theta-=2*Math.PI*y.x/b.width*d.rotationSpeed,t.phi-=2*Math.PI*y.y/b.height*d.rotationSpeed,x.copy(w),d.update());break;case 2:if(!1===d.enableZoom)break;if(h!==m.TOUCH_DOLLY)break;a.preventDefault();a.stopPropagation();b=a.touches[0].pageX-a.touches[1].pageX;a=a.touches[0].pageY-a.touches[1].pageY;H.set(0,Math.sqrt(b*b+a*a));G.subVectors(H,D);0<G.y?g(-(1-c())):0>G.y&&g(1-c());D.copy(H);
d.update();break;case 3:if(!1===d.enablePan)break;if(h!==m.TOUCH_PAN)break;a.preventDefault();a.stopPropagation();B.set(a.touches[0].pageX,a.touches[0].pageY);A.subVectors(B,z);F(A.x,A.y);z.copy(B);d.update();break;default:a.preventDefault(),a.stopPropagation(),h=m.NONE}};this.proxy.onMouseMove=function(a){!1!==d.enabled&&(a.preventDefault(),h===m.ROTATE?!1!==d.enableRotation&&(w.set(a.clientX,a.clientY),y.subVectors(w,x),a=d.proxy.getClientSize(),0!=a.width&&0!=a.height&&(t.theta-=2*Math.PI*y.x/
a.width*d.rotationSpeed,t.phi-=2*Math.PI*y.y/a.height*d.rotationSpeed,x.copy(w),d.update())):h===m.DOLLY?!1!==d.enableZoom&&(H.set(a.clientX,a.clientY),G.subVectors(H,D),0<G.y?g(c()):0>G.y&&g(-c()),D.copy(H),d.update()):h===m.PAN&&!1!==d.enablePan&&(B.set(a.clientX,a.clientY),A.subVectors(B,z),F(A.x*d.panSpeed,A.y*d.panSpeed),z.copy(B),d.update()))};this.proxy.onMouseUp=function(a){!1!==d.enabled&&(d.proxy.onStateChangeNone(),d.dispatchEvent(e),h=m.NONE)};this.proxy.onKeyDown=function(a){if(!1!==
d.enabled&&!1!==d.enableKeys&&0!=d.enableKeyPan&&!1!==d.enableKeyPan)switch(a.keyCode){case d.keys.UP:F(0,d.keyPanSpeed);d.update();break;case d.keys.BOTTOM:F(0,-d.keyPanSpeed);d.update();break;case d.keys.LEFT:F(d.keyPanSpeed,0);d.update();break;case d.keys.RIGHT:F(-d.keyPanSpeed,0),d.update()}};this.enabled=!0;this.target=new module$src$externals$three.default.Vector3;this.minDistance=0;this.maxDistance=Infinity;this.minZoom=-Infinity;this.maxZoom=Infinity;this.minPolarAngle=0;this.maxPolarAngle=
Math.PI;this.minAzimuthAngle=-Infinity;this.maxAzimuthAngle=Infinity;this.minPosition=new module$src$externals$three.default.Vector3(-Infinity,-Infinity,-Infinity);this.maxPosition=new module$src$externals$three.default.Vector3(Infinity,Infinity,Infinity);this.positionSphereCenter=new module$src$externals$three.default.Vector3(0,0,0);this.positionSphereRadius=Infinity;this.minTarget=new module$src$externals$three.default.Vector3(-Infinity,-Infinity,-Infinity);this.maxTarget=new module$src$externals$three.default.Vector3(Infinity,
Infinity,Infinity);this.targetSphereCenter=new module$src$externals$three.default.Vector3(0,0,0);this.targetSphereRadius=Infinity;this.enableDamping=!1;this.rotateDampingFactor=this.zoomDampingFactor=this.panDampingFactor=.1;this.enableZoom=!0;this.zoomSpeed=1;this.enableRotation=!0;this.rotationSpeed=1;this.enablePan=!0;this.panSpeed=1;this.enableKeyPan=!0;this.keyPanSpeed=7;this.enableAutoRotation=!1;this.autoRotationSpeed=2;this.enableKeys=!0;this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};this.mouseButtons=
{ORBIT:module$src$externals$three.default.MOUSE.LEFT,PAN:module$src$externals$three.default.MOUSE.RIGHT};this.target0=this.target.clone();this.position0=this.object.position.clone();this.zoom0=this.object.zoom;this.getPolarAngle=function(){return q.phi};this.getAzimuthalAngle=function(){return q.theta};this.reset=function(){d.target.copy(d.target0);d.object.position.copy(d.position0);d.object.zoom=d.zoom0;d.object.updateProjectionMatrix();d.dispatchEvent(f);this.isMoving=!0;this.lastMove=Date.now();
d.update();h=m.NONE};this.resetState=function(){h=m.NONE};this.update=function(){var b=new module$src$externals$three.default.Vector3,c=(new module$src$externals$three.default.Quaternion).setFromUnitVectors(a.up,new module$src$externals$three.default.Vector3(0,1,0)),e=c.clone().inverse(),g=new module$src$externals$three.default.Vector3,p=new module$src$externals$three.default.Quaternion;return function(){var a=d.object.position;b.copy(a).sub(d.target);b.applyQuaternion(c);q.setFromVector3(b);d.enableAutoRotation&&
h===m.NONE&&(t.theta=0,t.theta-=2*Math.PI/60/60*d.autoRotationSpeed);q.theta+=t.theta;q.phi+=t.phi;q.theta>Math.PI?(q.theta-=2*Math.PI,d.minAzimuthAngle>q.theta&&(q.theta+=2*Math.PI)):q.theta<-Math.PI&&(q.theta+=2*Math.PI,d.maxAzimuthAngle<q.theta&&(q.theta-=2*Math.PI));q.theta=Math.max(d.minAzimuthAngle,Math.min(d.maxAzimuthAngle,q.theta));q.phi=Math.max(d.minPolarAngle,Math.min(d.maxPolarAngle,q.phi));q.makeSafe();d.object instanceof module$src$externals$three.default.PerspectiveCamera?q.radius*=
1+u:d.object instanceof module$src$externals$three.default.OrthographicCamera&&(d.object.left*=1+n,d.object.right*=1+n,d.object.top*=1+n,d.object.bottom*=1+n,d.object.scale=module$src$externals$three.default.Vector3(1+n,1+n,1+n),d.object.updateProjectionMatrix());q.radius=Math.max(d.minDistance,Math.min(d.maxDistance,q.radius));d.target.add(l);d.target.setComponent(0,Math.max(d.minTarget.x,Math.min(d.maxTarget.x,d.target.x)));d.target.setComponent(1,Math.max(d.minTarget.y,Math.min(d.maxTarget.y,d.target.y)));
d.target.setComponent(2,Math.max(d.minTarget.z,Math.min(d.maxTarget.z,d.target.z)));if(d.target.distanceTo(d.targetSphereCenter)>d.targetSphereRadius){var E=(new module$src$externals$three.default.Vector3(d.target.x-d.targetSphereCenter.x,d.target.y-d.targetSphereCenter.y,d.target.z-d.targetSphereCenter.z)).normalize();d.target.setComponent(0,d.targetSphereCenter.x+E.x*d.targetSphereRadius);d.target.setComponent(1,d.targetSphereCenter.y+E.y*d.targetSphereRadius);d.target.setComponent(2,d.targetSphereCenter.z+
E.z*d.targetSphereRadius)}b.setFromSpherical(q);b.applyQuaternion(e);a.copy(d.target).add(b);a.setComponent(0,Math.max(d.minPosition.x,Math.min(d.maxPosition.x,a.x)));a.setComponent(1,Math.max(d.minPosition.y,Math.min(d.maxPosition.y,a.y)));a.setComponent(2,Math.max(d.minPosition.z,Math.min(d.maxPosition.z,a.z)));a.distanceTo(d.positionSphereCenter)>d.positionSphereRadius&&(E=(new module$src$externals$three.default.Vector3(a.x-d.positionSphereCenter.x,a.y-d.positionSphereCenter.y,a.z-d.positionSphereCenter.z)).normalize(),
a.setComponent(0,d.positionSphereCenter.x+E.x*d.positionSphereRadius),a.setComponent(1,d.positionSphereCenter.y+E.y*d.positionSphereRadius),a.setComponent(2,d.positionSphereCenter.z+E.z*d.positionSphereRadius));d.object.lookAt(d.target);!0===d.enableDamping?(t.theta*=1-d.rotateDampingFactor,t.phi*=1-d.rotateDampingFactor,l.x*=1-d.panDampingFactor,l.y*=1-d.panDampingFactor,l.z*=1-d.panDampingFactor,u*=1-d.zoomDampingFactor,n*=1-d.zoomDampingFactor):(t.set(0,0,0),l.set(0,0,0),n=u=0);if(v||g.distanceToSquared(d.object.position)>
r||8*(1-p.dot(d.object.quaternion))>r||d.object instanceof module$src$externals$three.default.OrthographicCamera&&Math.abs(n)>r)return this.isMoving=!0,this.lastMove=Date.now(),g.copy(d.object.position),p.copy(d.object.quaternion),v=!1,d.dispatchEvent(f),!0;100<Date.now()-this.lastMove&&(this.isMoving=!1,l.set(0,0,0),t.set(0,0,0),n=u=0,d.dispatchEvent(f));return!1}}();this.dispose=function(){d.proxy.dispose()};var d=this,f={type:"change"},p={type:"start"},e={type:"end"},m={NONE:-1,ROTATE:0,DOLLY:1,
PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},h=m.NONE,r=.001,q=new module$src$externals$three.default.Spherical,t=new module$src$externals$three.default.Spherical,u=0,n=0,l=new module$src$externals$three.default.Vector3,v=!1,x=new module$src$externals$three.default.Vector2,w=new module$src$externals$three.default.Vector2,y=new module$src$externals$three.default.Vector2,z=new module$src$externals$three.default.Vector2,B=new module$src$externals$three.default.Vector2,A=new module$src$externals$three.default.Vector2,
D=new module$src$externals$three.default.Vector2,H=new module$src$externals$three.default.Vector2,G=new module$src$externals$three.default.Vector2,E=function(){var a=new module$src$externals$three.default.Vector3;return function(b,c){a.setFromMatrixColumn(c,0);a.multiplyScalar(-b);l.add(a)}}(),J=function(){var a=new module$src$externals$three.default.Vector3;return function(b,c){a.setFromMatrixColumn(c,1);a.multiplyScalar(b);l.add(a)}}(),F=function(){var a=new module$src$externals$three.default.Vector3;
return function(b,c){var e=d.proxy.getClientSize();if(0!=e.width&&0!=e.height)if(d.object instanceof module$src$externals$three.default.PerspectiveCamera){a.copy(d.object.position).sub(d.target);var f=a.length();f*=Math.tan(d.object.fov/2*Math.PI/180);E(2*b*f/e.width,d.object.matrix);J(2*c*f/e.height,d.object.matrix)}else d.object instanceof module$src$externals$three.default.OrthographicCamera?(E(b*(d.object.right-d.object.left)/d.object.zoom/e.width,d.object.matrix),J(c*(d.object.top-d.object.bottom)/
d.object.zoom/e.height,d.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),d.enablePan=!1)}}();this.update()};module$src$externals$three.default.OrbitControls.prototype=Object.create(module$src$externals$three.default.EventDispatcher.prototype);module$src$externals$three.default.OrbitControls.prototype.constructor=module$src$externals$three.default.OrbitControls;
Object.defineProperties(module$src$externals$three.default.OrbitControls.prototype,{center:{get:function(){console.warn("THREE.OrbitControls: .center has been renamed to .target");return this.target}},noZoom:{get:function(){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.");return!this.enableZoom},set:function(a){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.");this.enableZoom=!a}},noRotate:{get:function(){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotation instead.");
return!this.enableRotation},set:function(a){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotation instead.");this.enableRotation=!a}},noPan:{get:function(){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.");return!this.enablePan},set:function(a){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.");this.enablePan=!a}},noKeys:{get:function(){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.");
return!this.enableKeys},set:function(a){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.");this.enableKeys=!a}},staticMoving:{get:function(){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.");return!this.enableDamping},set:function(a){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.");this.enableDamping=!a}},dynamicDampingFactor:{get:function(){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.");
return this.dampingFactor},set:function(a){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.");this.dampingFactor=a}}});var module$src$3d$controls$DragControls={default:{}},THREE$$module$src$3d$controls$DragControls=module$src$externals$three.default,DETECT_IT$$module$src$3d$controls$DragControls=module$node_modules$detect_it$lib$index.default.default;
module$src$externals$three.default.DragControls=function(a,b,c){function g(){var a=!1;!0===module$node_modules$detect_it$lib$index.default.default.passiveEvents&&(a={capture:!1,passive:!1});c.addEventListener("mousemove",f,a);c.addEventListener("mousedown",p,a);c.addEventListener("mouseup",e,a);c.addEventListener("mouseleave",e,a);c.addEventListener("touchmove",m,a);c.addEventListener("touchstart",h,a);c.addEventListener("touchend",r,a)}function d(){c.removeEventListener("mousemove",f,!1);c.removeEventListener("mousedown",
p,!1);c.removeEventListener("mouseup",e,!1);c.removeEventListener("mouseleave",e,!1);c.removeEventListener("touchmove",m,!1);c.removeEventListener("touchstart",h,!1);c.removeEventListener("touchend",r,!1)}function f(d){d.preventDefault();var e=c.getBoundingClientRect();n.x=(d.clientX-e.left)/e.width*2-1;n.y=2*-((d.clientY-e.top)/e.height)+1;if(x&&z.enabled){var f;u.setFromCamera(n,b);u.ray.intersectPlane(t,v)&&(f=v.sub(l));z.dispatchEvent({type:"drag",object:x,position:f,event:d})}u.setFromCamera(n,
b);var h=a.indexOf(x);f=u.intersectObjects(a.filter(function(a,b){return h!==b}));0<f.length?(e=f[0].object,f=f[0].point,w!==e?(null!==w&&z.dispatchEvent({type:"hoveroff",object:w,event:d}),z.dispatchEvent({type:"hoveron",object:e,point:f,event:d}),c.style.cursor="pointer",w=e):z.dispatchEvent({type:"hover",object:e,point:f,event:d})):null!==w&&(z.dispatchEvent({type:"hoveroff",object:w,event:d}),c.style.cursor="auto",w=null)}function p(d){d.preventDefault();if(0===d.button){z.dispatchEvent({type:"mousedowncustom",
event:d});u.setFromCamera(n,b);var e=u.intersectObjects(a);0<e.length?(x=e[0].object,e=e[0].point,x.hasOwnProperty("interactionPlaneNormal")?t.setFromNormalAndCoplanarPoint(x.interactionPlaneNormal,x.position):t.setFromNormalAndCoplanarPoint(b.getWorldDirection(t.normal),x.position),u.ray.intersectPlane(t,v)&&l.copy(v).sub(x.position),c.style.cursor="move",z.dispatchEvent({type:"dragstart",object:x,event:d,point:e})):z.dispatchEvent({type:"emptyclick",event:d})}}function e(a){a.preventDefault();z.dispatchEvent({type:"mouseupcustom",
event:a});x&&(z.dispatchEvent({type:"dragend",object:x,event:a}),x=null);c.style.cursor="auto"}function m(d){if(y){d.preventDefault();for(var e=null,f,h=0;h<d.changedTouches.length;h++)if(f=d.changedTouches[h],f.identifier===y){e=f;break}if(e){d=e;e=c.getBoundingClientRect();n.x=(d.clientX-e.left)/e.width*2-1;n.y=2*-((d.clientY-e.top)/e.height)+1;if(x&&z.enabled){var g;u.setFromCamera(n,b);u.ray.intersectPlane(t,v)&&(g=v.sub(l));z.dispatchEvent({type:"drag",object:x,position:g,event:d})}u.setFromCamera(n,
b);var m=a.indexOf(x);e=u.intersectObjects(a.filter(function(a,b){return m!==b}));0<e.length?(g=e[0].object,e=e[0].point,g.hasOwnProperty("interactionPlaneNormal")?t.setFromNormalAndCoplanarPoint(g.interactionPlaneNormal,g.position):t.setFromNormalAndCoplanarPoint(b.getWorldDirection(t.normal),g.position),w!==g?(null!==w&&z.dispatchEvent({type:"hoveroff",object:w,event:d}),z.dispatchEvent({type:"hoveron",object:g,point:e,event:d}),w=g):z.dispatchEvent({type:"hover",object:g,point:e,event:d})):null!==
w&&(z.dispatchEvent({type:"hoveroff",object:w,event:d}),w=null)}}}function h(d){d.preventDefault();if(!(1<d.touches.length)){d=d.changedTouches[0];y=d.identifier;var e=c.getBoundingClientRect();n.x=(d.clientX-e.left)/e.width*2-1;n.y=2*-((d.clientY-e.top)/e.height)+1;u.setFromCamera(n,b);e=u.intersectObjects(a);0<e.length?(x=e[0].object,e=e[0].point,x.hasOwnProperty("interactionPlaneNormal")?t.setFromNormalAndCoplanarPoint(x.interactionPlaneNormal,x.position):t.setFromNormalAndCoplanarPoint(b.getWorldDirection(t.normal),
x.position),u.ray.intersectPlane(t,v)&&l.copy(v).sub(x.position),c.style.cursor="move",z.dispatchEvent({type:"dragstart",object:x,event:d,point:e})):z.dispatchEvent({type:"emptyclick",event:d})}}function r(a){if(y){a.preventDefault();for(var b=null,d,e=0;e<a.changedTouches.length;e++)if(d=a.changedTouches[e],d.identifier===y){b=d;break}b&&(a=b,y=null,x&&(z.dispatchEvent({type:"dragend",object:x,event:a}),x=null),null!==w&&(z.dispatchEvent({type:"hoveroff",object:w,event:a}),w=null),c.style.cursor=
"auto")}}if(a instanceof module$src$externals$three.default.Camera){console.warn("THREE.DragControls: Constructor now expects ( objects, camera, domElement )");var q=a;a=b;b=q}var t=new module$src$externals$three.default.Plane,u=new module$src$externals$three.default.Raycaster,n=new module$src$externals$three.default.Vector2,l=new module$src$externals$three.default.Vector3,v=new module$src$externals$three.default.Vector3,x=null,w=null,y=null,z=this;g();this.enabled=!0;this.activate=g;this.deactivate=
d;this.dispose=function(){d()};this.setObjects=function(b){a=b};this.on=function(a,b){console.warn("THREE.DragControls: on() has been deprecated. Use addEventListener() instead.");z.addEventListener(a,b)};this.off=function(a,b){console.warn("THREE.DragControls: off() has been deprecated. Use removeEventListener() instead.");z.removeEventListener(a,b)};this.notify=function(a){console.error("THREE.DragControls: notify() has been deprecated. Use dispatchEvent() instead.");z.dispatchEvent({type:a})}};
module$src$externals$three.default.DragControls.prototype=Object.create(module$src$externals$three.default.EventDispatcher.prototype);module$src$externals$three.default.DragControls.prototype.constructor=module$src$externals$three.default.DragControls;var module$src$3d$viewports$default$materials$ShapeDiverStandardMaterial={default:{}},THREE$$module$src$3d$viewports$default$materials$ShapeDiverStandardMaterial=module$src$externals$three.default,Shaders$$module$src$3d$viewports$default$materials$ShapeDiverStandardMaterial=module$src$3d$viewports$default$shaders$ShaderFile.default;
module$src$externals$three.default.ShapeDiverStandardMaterial=function(a){module$src$externals$three.default.MeshStandardMaterial.call(this);this.defines={STANDARD:""};a&&0<a.threeDNoiseOpacity&&(this.defines.USE_3D_NOISE="",a.threeDNoiseID||(a.threeDNoiseID=0),0<=a.threeDNoiseID&&3>a.threeDNoiseID||999==a.threeDNoiseID)&&(this.defines["USE_3D_NOISE_F"+a.threeDNoiseID]="");this.uniforms=module$src$externals$three.default.UniformsUtils.merge([module$src$externals$three.default.UniformsLib.common,module$src$externals$three.default.UniformsLib.envmap,
module$src$externals$three.default.UniformsLib.aomap,module$src$externals$three.default.UniformsLib.lightmap,module$src$externals$three.default.UniformsLib.bumpmap,module$src$externals$three.default.UniformsLib.normalmap,module$src$externals$three.default.UniformsLib.displacementmap,module$src$externals$three.default.UniformsLib.roughnessmap,module$src$externals$three.default.UniformsLib.metalnessmap,module$src$externals$three.default.UniformsLib.lights,{emissive:{value:new module$src$externals$three.default.Color(0)},
roughness:{value:.5},metalness:{value:0},envMapIntensity:{value:1}},{lightWorldSize:{value:.005},lightFrustum:{value:6.5}},{shadowOpacity:{value:1}},{lightReflectivity:{value:1}},{threeDNoiseOpacity:{value:0},threeDNoiseID:{value:0},threeDNoiseScale:{value:1},threeDNoiseDistanceFade:{value:0}},{uvTransformMap:{type:"m3",value:(new module$src$externals$three.default.Matrix3).identity()},uvTransformBumpMap:{type:"m3",value:(new module$src$externals$three.default.Matrix3).identity()},uvTransformNormalMap:{type:"m3",
value:(new module$src$externals$three.default.Matrix3).identity()},uvTransformSpecularMap:{type:"m3",value:(new module$src$externals$three.default.Matrix3).identity()},uvTransformAlphaMap:{type:"m3",value:(new module$src$externals$three.default.Matrix3).identity()},uvTransformEmissiveMap:{type:"m3",value:(new module$src$externals$three.default.Matrix3).identity()},uvTransformRoughnessMap:{type:"m3",value:(new module$src$externals$three.default.Matrix3).identity()},uvTransformMetalnessMap:{type:"m3",
value:(new module$src$externals$three.default.Matrix3).identity()}},{rgbMap:{type:"t",value:null}},{mapsSize:{type:"i",value:0},additionalMaps0:{type:"t",value:null},additionalMaps1:{type:"t",value:null},additionalMaps2:{type:"t",value:null},additionalMaps3:{type:"t",value:null},additionalMaps4:{type:"t",value:null},mapPropertyType:{type:"iv1",value:[-1,-1,-1,-1,-1]},mapPropertyColor:{type:"v3v",value:[new module$src$externals$three.default.Color(0),new module$src$externals$three.default.Color(0),
new module$src$externals$three.default.Color(0),new module$src$externals$three.default.Color(0),new module$src$externals$three.default.Color(0)]},uvTransformAddMap:{type:"m3v",value:[(new module$src$externals$three.default.Matrix3).identity(),(new module$src$externals$three.default.Matrix3).identity(),(new module$src$externals$three.default.Matrix3).identity(),(new module$src$externals$three.default.Matrix3).identity(),(new module$src$externals$three.default.Matrix3).identity()]}}]);this.lightWorldSize=
this.uniforms.lightWorldSize.value;this.lightFrustum=this.uniforms.lightFrustum.value;this.shadowOpacity=this.uniforms.shadowOpacity.value;this.lightReflectivity=this.uniforms.lightReflectivity.value;this.threeDNoiseID=this.uniforms.threeDNoiseID.value;this.threeDNoiseScale=this.uniforms.threeDNoiseScale.value;this.threeDNoiseDistanceFade=this.uniforms.threeDNoiseDistanceFade.value;this.threeDNoiseOpacity=this.uniforms.threeDNoiseOpacity.value;this.mapsSize=this.uniforms.mapsSize.value;this.rgbMap=
this.uniforms.rgbMap.value;var b=0;if(a){a.map&&(this.uvTransformMap=a.map.uvTransform,a.map.matrix.identity(),b++);a.specularMap&&(this.uvTransformSpecularMap=a.specularMap.uvTransform,a.specularMap.matrix.identity(),b++);a.normalMap&&(this.uvTransformNormalMap=a.normalMap.uvTransform,a.normalMap.matrix.identity(),b++);a.bumpMap&&(this.uvTransformBumpMap=a.bumpMap.uvTransform,a.bumpMap.matrix.identity(),b++);a.roughnessMap&&(this.uvTransformRoughnessMap=a.roughnessMap.uvTransform,a.roughnessMap.matrix.identity(),
b++);a.metalnessMap&&(this.uvTransformMetalnessMap=a.metalnessMap.uvTransform,a.metalnessMap.matrix.identity(),b++);a.alphaMap&&(this.uvTransformAlphaMap=a.alphaMap.uvTransform,a.alphaMap.matrix.identity(),b++);a.emissiveMap&&(this.uvTransformEmissiveMap=a.emissiveMap.uvTransform,a.emissiveMap.matrix.identity(),b++);a&&a.roughnessMap&&a.metalnessMap&&a.roughnessMap.image===a.metalnessMap.image&&(this.rgbMap=a.roughnessMap,a.roughnessMap={uvTransform:a.roughnessMap.uvTransform,isTexture:!1},a.metalnessMap=
{uvTransform:a.metalnessMap.uvTransform,isTexture:!1},this.defines.USE_RGBMAP="",b--);if(a&&a.additionalMaps){for(this.mapsSize=a.additionalMaps.length;5>a.mapPropertyType.length;)a.mapPropertyType.push(-1);for(;5>a.mapPropertyColor.length;)a.mapPropertyColor.push(new module$src$externals$three.default.Color(0));for(;5>a.uvTransformAddMap.length;)a.uvTransformAddMap.push((new module$src$externals$three.default.Matrix3).identity());this.mapPropertyType=a.mapPropertyType;this.mapPropertyColor=a.mapPropertyColor;
this.uvTransformAddMap=a.uvTransformAddMap;for(var c=0,g=a.additionalMaps.length;c<g;c++)0==c&&(this.additionalMaps0=a.additionalMaps[c]),1==c&&(this.additionalMaps1=a.additionalMaps[c]),2==c&&(this.additionalMaps2=a.additionalMaps[c]),3==c&&(this.additionalMaps3=a.additionalMaps[c]),4==c&&(this.additionalMaps4=a.additionalMaps[c]);delete a.additionalMaps}b+=this.mapsSize;this.defines.NUM_ADD_MAPS=this.mapsSize;for(a.envMap&&b++;b>=a.textureUnitCount;)if(a.envMap)delete a.envMap,this.envMap=null,
b--;else if(a.emissiveMap&&a.emissiveMap.image)delete a.emissiveMap,this.uvTransformEmissiveMap=this.uniforms.uvTransformEmissiveMap.value,b--;else if(a.alphaMap&&a.alphaMap.image)delete a.alphaMap,this.uvTransformAlphaMap=this.uniforms.uvTransformAlphaMap.value,b--;else if(a.metalnessMap&&a.metalnessMap.image)delete a.metalnessMap,this.uvTransformMetalnessMap=this.uniforms.uvTransformMetalnessMap.value,b--;else if(a.roughnessMap&&a.roughnessMap.image)delete a.roughnessMap,this.uvTransformRoughnessMap=
this.uniforms.uvTransformRoughnessMap.value,b--;else if(this.rgbMap)this.rgbMap=null,delete this.defines.USE_RGBMAP,this.uvTransformMetalnessMap=this.uniforms.uvTransformMetalnessMap.value,this.uvTransformRoughnessMap=this.uniforms.uvTransformRoughnessMap.value,b--;else if(a.bumpMap&&a.bumpMap.image)delete a.bumpMap,this.uvTransformBumpMap=this.uniforms.uvTransformBumpMap.value,b--;else if(a.normalMap&&a.normalMap.image)delete a.normalMap,this.uvTransformNormalMap=this.uniforms.uvTransformNormalMap.value,
b--;else if(a.specularMap&&a.specularMap.image)delete a.specularMap,this.uvTransformSpecularMap=this.uniforms.uvTransformSpecularMap.value,b--;else break;this.availableTextures=a.textureUnitCount-1-b;delete a.textureUnitCount;this.renderAO=a.renderAO}this.vertexShader=module$src$3d$viewports$default$shaders$ShaderFile.default.standard_vert;this.fragmentShader=module$src$3d$viewports$default$shaders$ShaderFile.default.standard_frag;this.type="ShapeDiverStandardMaterial";this.softShadow=!1;this.attributes=
["position","normal"];0<b&&this.attributes.push("uv");this.needsUpdate=!1;this.setValues(a)};module$src$externals$three.default.ShapeDiverStandardMaterial.prototype=Object.create(module$src$externals$three.default.MeshStandardMaterial.prototype);module$src$externals$three.default.ShapeDiverStandardMaterial.prototype.constructor=module$src$externals$three.default.ShapeDiverStandardMaterial;module$src$externals$three.default.ShapeDiverStandardMaterial.prototype.isMeshStandardMaterial=!0;
module$src$externals$three.default.ShapeDiverStandardMaterial.prototype.copy=function(a){module$src$externals$three.default.MeshStandardMaterial.prototype.copy.call(this,a);this.defines=a.defines;this.uniforms=module$src$externals$three.default.UniformsUtils.clone(a.uniforms);this.type=a.type;this.softShadow=a.softShadow;this.renderAO=a.renderAO;return this};
module$src$externals$three.default.ShapeDiverStandardMaterial.prototype.deepCopy=function(a){module$src$externals$three.default.MeshStandardMaterial.prototype.copy.call(this,a);this.defines=Object.assign({},a.defines);this.uniforms=module$src$externals$three.default.UniformsUtils.clone(a.uniforms);this.type=a.type;this.softShadow=a.softShadow;this.renderAO=a.renderAO;return this};var module$src$3d$viewports$default$materials$ShapeDiverGemMaterial={default:{}},THREE$$module$src$3d$viewports$default$materials$ShapeDiverGemMaterial=module$src$externals$three.default,Shaders$$module$src$3d$viewports$default$materials$ShapeDiverGemMaterial=module$src$3d$viewports$default$shaders$ShaderFile.default;
module$src$externals$three.default.ShapeDiverGemMaterial=function(a){module$src$externals$three.default.MeshStandardMaterial.call(this);this.defines={STANDARD:"",DEPTH:5};this.uniforms=module$src$externals$three.default.UniformsUtils.merge([module$src$externals$three.default.UniformsLib.common,module$src$externals$three.default.UniformsLib.envmap,module$src$externals$three.default.UniformsLib.aomap,module$src$externals$three.default.UniformsLib.lightmap,module$src$externals$three.default.UniformsLib.bumpmap,
module$src$externals$three.default.UniformsLib.normalmap,module$src$externals$three.default.UniformsLib.displacementmap,module$src$externals$three.default.UniformsLib.roughnessmap,module$src$externals$three.default.UniformsLib.metalnessmap,module$src$externals$three.default.UniformsLib.lights,{emissive:{value:new module$src$externals$three.default.Color(0)},roughness:{value:0},metalness:{value:1},envMapIntensity:{value:1}},{refractionIndex:{value:2.4},impurityMap:{value:null},impurityScale:{value:1},
colorTransferBegin:{value:new module$src$externals$three.default.Color(16777215)},colorTransferEnd:{value:new module$src$externals$three.default.Color(16777215)},center:{value:new module$src$externals$three.default.Vector3(0,0,0)},radius:{value:1},sphericalNormalMap:{value:null},gamma:{value:1},contrast:{value:1},brightness:{value:0},dispersion:{value:0},tracingOpacity:{value:0},inverseModelMatrix:{value:new module$src$externals$three.default.Matrix4},inverseTransposeModelMatrix:{value:new module$src$externals$three.default.Matrix4}}]);
a&&(this.customEnvMap=a.customEnvMap,delete a.customEnvMap,delete a.materialType,delete a.environmentMap,this.depth=a.depth,this.defines.DEPTH=this.depth,0!=a.dispersion&&(this.defines.DISPERSION=""),this.roughness=0,this.metalness=1,this.transparent=!0,a.impurityMap&&(this.defines.USE_IMPURITY_MAP=""),this.inverseModelMatrix=this.uniforms.inverseModelMatrix.value=a.inverseModelMatrix,this.inverseTransposeModelMatrix=this.uniforms.inverseTransposeModelMatrix.value=a.inverseTransposeModelMatrix,this.refractionIndex=
this.uniforms.refractionIndex.value=a.refractionIndex,this.dispersion=this.uniforms.dispersion.value=a.dispersion,this.center=this.uniforms.center.value=a.center,this.radius=this.uniforms.radius.value=a.radius,this.sphericalNormalMap=this.uniforms.sphericalNormalMap.value=a.sphericalNormalMap,this.impurityMap=this.uniforms.impurityMap.value=a.impurityMap,this.impurityScale=this.uniforms.impurityScale.value=a.impurityScale,this.colorTransferBegin=this.uniforms.colorTransferBegin.value=a.colorTransferBegin,
this.colorTransferEnd=this.uniforms.colorTransferEnd.value=a.colorTransferEnd,this.gamma=this.uniforms.gamma.value=a.gamma,this.contrast=this.uniforms.contrast.value=a.contrast,this.brightness=this.uniforms.brightness.value=a.brightness,this.tracingOpacity=this.uniforms.tracingOpacity.value=a.tracingOpacity);this.vertexShader=module$src$3d$viewports$default$shaders$ShaderFile.default.gem_vert;this.fragmentShader=module$src$3d$viewports$default$shaders$ShaderFile.default.gem_frag;this.type="ShapeDiverGemMaterial";
this.needsUpdate=!1;this.setValues(a)};module$src$externals$three.default.ShapeDiverGemMaterial.prototype=Object.create(module$src$externals$three.default.MeshStandardMaterial.prototype);module$src$externals$three.default.ShapeDiverGemMaterial.prototype.constructor=module$src$externals$three.default.ShapeDiverGemMaterial;module$src$externals$three.default.ShapeDiverGemMaterial.prototype.isMeshStandardMaterial=!0;
module$src$externals$three.default.ShapeDiverGemMaterial.prototype.copy=function(a){module$src$externals$three.default.MeshStandardMaterial.prototype.copy.call(this,a);this.defines=a.defines;this.uniforms=module$src$externals$three.default.UniformsUtils.clone(a.uniforms);this.type=a.type;return this};
module$src$externals$three.default.ShapeDiverGemMaterial.prototype.deepCopy=function(a){module$src$externals$three.default.MeshStandardMaterial.prototype.copy.call(this,a);this.defines=Object.assign({},a.defines);this.uniforms=module$src$externals$three.default.UniformsUtils.clone(a.uniforms);this.type=a.type;return this};var module$src$3d$SceneGeometryManager={default:function(a,b){var c,g,d,f,p=[],e=[],m=[],h=new module$src$externals$three.default.Matrix4,r=new module$src$externals$three.default.Matrix4,q=[],t=new module$src$shared$util$PathUtils.default,u=function(a,b){c=this;g=a;module$src$externals$three.default.Cache.enabled=!0;d=new module$src$externals$three.default.Scene;f=new module$src$externals$three.default.Object3D;f.computeSceneBoundingBox=function(){var a=new module$src$externals$three.default.Box3;
this.traverse(function(b){b.hasOwnProperty("SDBoundingBox")&&a.union(b.SDBoundingBox)});0==a.min.distanceTo(a.max)&&(a=new module$src$externals$three.default.Box3(new module$src$externals$three.default.Vector3(-1,-1,-1),new module$src$externals$three.default.Vector3(1,1,1)));return a};f.computeBoundingBox=function(a){var b=new module$src$externals$three.default.Box3;if(!Array.isArray(a)||0===a.length)return this.computeSceneBoundingBox();for(var c=0,d=a.length;c<d;c++){var e=t.getPathObject(this,
a[c]+"");e&&b.union((new module$src$externals$three.default.Box3).setFromObject(e))}0==b.min.distanceTo(b.max)&&(b=this.computeSceneBoundingBox());return b};d.add(f);t.setScene(f);module$src$shared$mixins$GlobalMixin.default.call(c);b&&b.loggingHandler?module$src$shared$util$GlobalUtils.default.inject(b.loggingHandler,c):module$src$shared$mixins$LoggingMixin.default.call(c);module$src$shared$mixins$SettingsMixin.default.call(c,b.settings,{});b&&b.messagingHandler&&module$src$shared$util$GlobalUtils.default.inject(b.messagingHandler,
c)};u.prototype._getMaterials=function(a,b,d,e,f,h){a=g.getMaterial(a,b,d,e,f);(a.includes(null)||a.includes(void 0))&&c.warn("The creation of a material for at least one viewport failed.");if(!h)for(h=0,b=a.length;h<b;h++)a[h].map=null,a[h].alphaMap=null,a[h].aoMap=null,a[h].bumpMap=null,a[h].displacementMap=null,a[h].emissiveMap=null,a[h].normalMap=null,a[h].metalnessMap=null,a[h].roughnessMap=null;return a};u.prototype._setMeshMaterialCombo=function(a,b,c,d,e,f){g.addMesh(a,b,c);p.push({mesh:a,
properties:c,hasTextureCoordinates:d,overrideColor:e,vertexColors:f})};u.prototype._addMesh=function(a,b,d,e,f,h){if(a.transparentMeshHelper){b.renderAO=!1;b.side=module$src$externals$three.default.BackSide;var g=c._getMaterials(b,a.children[0],d,f,h,e);a.children[0].castShadow=!0;b.opacity&&.5<b.opacity&&(a.children[0].receiveShadow=!0);c._setMeshMaterialCombo(a.children[0],g,b,e,f,h);b.side=module$src$externals$three.default.FrontSide;g=c._getMaterials(b,a.children[1],d,f,h,e);a.children[1].castShadow=
!0;b.opacity&&.5<b.opacity&&(a.children[1].receiveShadow=!0);c._setMeshMaterialCombo(a.children[1],g,b,e,f,h);b.side=module$src$externals$three.default.DoubleSide}else a.meshHelper?(d=c._getMaterials(b,a.children[0],d,f,h,e),a.children[0].castShadow=!0,a.children[0].receiveShadow=!0,c._setMeshMaterialCombo(a.children[0],d,b,e,f,h)):(d=c._getMaterials(b,a,d,f,h,e),a.castShadow=!0,a.receiveShadow=!0,c._setMeshMaterialCombo(a,d,b,e,f,h))};u.prototype._removeMesh=function(a){g.removeMesh(a);for(var b=
0,c=p.length;b<c;b++)if(p[b].mesh===a){p.splice(b,1);break}};u.prototype._addAnchor=function(a,b){e.push({object:a,properties:b});g.addAnchor(a,b)};u.prototype._removeAnchor=function(a){g.removeAnchor(a);for(var b=0,c=e.length;b<c;b++)if(e[b].object===a){e.splice(b,1);break}};u.prototype.getScene=function(){return d};u.prototype.getGeometryNode=function(){return f};u.prototype.getPathUtils=function(){return t};u.prototype.getMeshMaterialObjects=function(){return p};u.prototype.addGeometry=function(a,
b,d,e){g.registerForContinuousRendering("geomAddEvent");d=d||{};if(null!=t.getPathObject(f,a))return g.unregisterForContinuousRendering("geomAddEvent"),Promise.reject(Error("Geometry already exists at that path: "+a));var h=t.ensurePath(f,a);module$src$shared$util$GlobalUtils.default.typeCheck(d.name,"string")&&(h.SDName=d.name);module$src$shared$util$GlobalUtils.default.typeCheck(d.visible,"boolean")?h.visible=d.visible:h.visible=!0;var m=d.hasOwnProperty("boundingBox");m&&(h.SDBoundingBox=d.boundingBox);
var l={};b=$jscomp.makeIterator(b);for(var n=b.next();!n.done;l={g:l.g},n=b.next()){l.g=n.value;["geometry","path","type","material"].forEach(function(a){return function(b){if(!a.g.hasOwnProperty(b))return g.unregisterForContinuousRendering("geomAddEvent"),Promise.reject(Error("GeometryData object is missing property "+b))}}(l));var r=t.ensurePath(h,l.g.path),q=void 0;q=l.g.material.color?new module$src$externals$three.default.MeshBasicMaterial({color:l.g.material.color}):new module$src$externals$three.default.MeshBasicMaterial;
l.g.color&&q.color.set(l.g.color.toRgbString());l.g.geometry.attributes&&l.g.geometry.attributes.hasOwnProperty("color")&&(q.vertexColors=module$src$externals$three.default.VertexColors);n=null;var p=!1;try{switch(l.g.type){case "mesh":l.g.geometry instanceof module$src$externals$three.default.BufferGeometry?l.g.geometry.hasOwnProperty("attributes")&&l.g.geometry.attributes.hasOwnProperty("uv")&&(p=!0):l.g.geometry instanceof module$src$externals$three.default.Geometry&&0<l.g.geometry.faceVertexUvs.length&&
(p=!0);if(l.g.geometry instanceof module$src$externals$three.default.BufferGeometry)l.g.geometry.attributes.hasOwnProperty("normal")&&null!=l.g.geometry.attributes.normal||l.g.geometry.computeVertexNormals();else if(l.g.geometry instanceof module$src$externals$three.default.Geometry&&0<l.g.geometry.faces.length){var u=l.g.geometry.faces[0];if(null==u.vertexNormals||0==u.vertexNormals.length)l.g.geometry.computeFaceNormals(),l.g.geometry.computeVertexNormals()}n=new module$src$externals$three.default.Object3D;
n.meshHelper=!0;l.g.geometry.boundingSphere||(l.g.geometry.computeBoundingSphere(),l.g.geometry.boundingSphere.realCenter=l.g.geometry.boundingSphere.center.clone(),l.g.geometry.translate(-l.g.geometry.boundingSphere.center.x,-l.g.geometry.boundingSphere.center.y,-l.g.geometry.boundingSphere.center.z));if(l.g.material&&!0===l.g.material.transparent&&l.g.material.side===module$src$externals$three.default.DoubleSide&&"gem"!==l.g.material.materialType){n.transparentMeshHelper=!0;var E=new module$src$externals$three.default.Mesh(l.g.geometry,
q);E.position.set(l.g.geometry.boundingSphere.realCenter.x,l.g.geometry.boundingSphere.realCenter.y,l.g.geometry.boundingSphere.realCenter.z);var v=new module$src$externals$three.default.Mesh(l.g.geometry,q);v.position.set(l.g.geometry.boundingSphere.realCenter.x,l.g.geometry.boundingSphere.realCenter.y,l.g.geometry.boundingSphere.realCenter.z);n.add(E);n.add(v)}else{var x=new module$src$externals$three.default.Mesh(l.g.geometry,q);x.position.set(l.g.geometry.boundingSphere.realCenter.x,l.g.geometry.boundingSphere.realCenter.y,
l.g.geometry.boundingSphere.realCenter.z);n.add(x)}break;case "points":n=new module$src$externals$three.default.Points(l.g.geometry,new module$src$externals$three.default.PointsMaterial({color:q.color,size:1}));break;case "line":n=new module$src$externals$three.default.Line(l.g.geometry,new module$src$externals$three.default.LineBasicMaterial({color:q.color}));break;case "linesegments":n=new module$src$externals$three.default.LineSegments(l.g.geometry,new module$src$externals$three.default.LineBasicMaterial({color:q.color}));
break;case "lineloop":n=new module$src$externals$three.default.LineLoop(l.g.geometry,new module$src$externals$three.default.LineBasicMaterial({color:q.color}));break;case "anchor":n=new module$src$externals$three.default.Object3D,n.position.set(l.g.geometry.position.x,l.g.geometry.position.y,l.g.geometry.position.z),n.type="Anchor",n.material={}}}catch(I){return g.unregisterForContinuousRendering("geomAddEvent"),Promise.reject(I)}if(n){l.g.hasOwnProperty("initialMatrix")&&n.applyMatrix(l.g.initialMatrix);
var C=0;for(q=n.children.length;C<q;C++)n.children[C].SDMaterialDefinition=l.g.material;r.add(n);n.meshHelper?c._addMesh(n,l.g.material,e,p,l.g.color,l.g.geometry.attributes&&l.g.geometry.attributes.hasOwnProperty("color")):"Anchor"===n.type&&c._addAnchor(n,Object.assign({path:a},l.g.geometry));if("number"===typeof d.duration&&0<d.duration)for(r=0,q=n.children.length;r<q;r++)n.children[r].material.transparent=!0,n.children[r].material.opacity=0}}g.updateInteractions(a,d);c.evaluateGeometryVisibility();
m||(e=new module$src$externals$three.default.Box3,e.setFromObject(h),h.SDBoundingBox=e);g.adjustScene();if("number"===typeof d.duration&&0<d.duration)return g.fadeIn(a,d.duration).then(function(){g.unregisterForContinuousRendering("geomAddEvent")});g.unregisterForContinuousRendering("geomAddEvent");return Promise.resolve()};u.prototype.removeGeometry=function(a,b){b=b||{};var d=t.getPathObject(f,a);if(null==d)return Promise.resolve();g.registerForContinuousRendering("geomRemoveEvent");var e=function(){g.removeFromInteractions(a);
g.adjustScene();g.unregisterForContinuousRendering("geomRemoveEvent");d.traverse(function(a){"Mesh"===a.type?(c._removeMesh(a),a.material.dispose(),a.geometry.dispose()):"Anchor"===a.type&&c._removeAnchor(a)});if(!t.deletePath(f,a)){var b="Could not delete scene path "+a;c.error("ThreeDManager.removeGeometry",b);return Promise.reject(Error(b))}return Promise.resolve()};return"number"===typeof b.duration&&0<b.duration?g.fadeOut(a,b.duration).then(function(){return e()}).catch(function(b){c.error("ThreeDManager.removeGeometry",
"Exception when removing geometry at path "+a,b);return Promise.reject(b)}):e()};u.prototype.replaceGeometry=function(a,b,d,e){d=d||{};g.registerForContinuousRendering("geomReplaceEvent");for(var h=g.getDefaultThreeDManagers(),l={},m=0,n=h.length;m<n;m++){var q=h[m],r=q.api.getSelected(),p=[];if(r.includes(a))p.push(a);else{var u=t.getPathObject(f,a);if(null!==u)for(var E=0,v=r.length;E<v;E++){var x=r[E];null!==t.getPathObject(u,x)&&p.push(x)}}l[q.runtimeId]=p}var C={};"number"===typeof d.duration&&
0<d.duration&&(C={duration:.5*d.duration});["interactionGroup","interactionMode","dragPlaneNormal","visible"].forEach(function(a){d.hasOwnProperty(a)&&(C[a]=d[a])});return c.removeGeometry(a,C).catch(function(a){g.unregisterForContinuousRendering("geomReplaceEvent");return Promise.reject(a)}).then(function(){c.addGeometry(a,b,C,e)}).catch(function(a){g.unregisterForContinuousRendering("geomReplaceEvent");return Promise.reject(a)}).then(function(){for(var a=g.getDefaultThreeDManagers(),b=0,c=a.length;b<
c;b++){var d=a[b],e=l[d.runtimeId];e&&0!=e.length&&d.api.updateSelected(d.api.getSelected().concat(e))}g.unregisterForContinuousRendering("geomReplaceEvent")})};u.prototype.setToggleCastShadow=function(a,b){a=t.getPathObject(f,a);if(null==a)return!1;a.castShadow=b;a.traverse(function(a){a.castShadow=b});g.updateShadowMap();g.render();return!0};u.prototype.getObjectPath=function(a){return t.getObjectPath(a)};u.prototype.getPathObject=function(a,b){return t.getPathObject(a,b)};u.prototype.getBoundingBox=
function(a){if(a=t.getPathObject(f,a)){var b=(new module$src$externals$three.default.Box3).setFromObject(a);a.traverseVisible(function(a){b.union((new module$src$externals$three.default.Box3).setFromObject(a))});return{min:b.min,max:b.max}}return null};u.prototype.setPluginTransformation=function(a,b){a=t.getPathObject(f,a);if(!a)return!1;a.originalMatrix||(a.originalMatrix=a.matrix.clone());a.transformationMatrices||(a.transformationMatrices=[]);if(!Array.isArray(b[0])&&null!==b[0]||b.isMatrix4)b=
[b];h.identity();for(var c=0,d=b.length>a.transformationMatrices.length?b.length:a.transformationMatrices.length;c<d;c++){if(b[c]){var e;a.transformationMatrices[c]=b[c].isMatrix4?b[c]:(e=r.clone()).set.apply(e,$jscomp.arrayFromIterable(b[c]))}else a.transformationMatrices[c]||(a.transformationMatrices[c]=r.clone());h.premultiply(a.transformationMatrices[c])}a.matrix.identity();a.applyMatrix(h);g.render();return!0};u.prototype.getPluginTransformation=function(a){a=t.getPathObject(f,a);if(!a)return[new module$src$externals$three.default.Matrix4];
if(a.transformationMatrices&&0<a.transformationMatrices.length){for(var b=[],c=0,d=a.transformationMatrices.length;c<d;c++)b[c]=a.transformationMatrices[c].clone();return b}return[a.matrix.clone()]};u.prototype.applyPluginTransformation=function(a,b){a=t.getPathObject(f,a);a.originalMatrix||(a.originalMatrix=a.matrix.clone());a.transformationMatrices||(a.transformationMatrices=[]);if(!Array.isArray(b[0])&&null!==b[0]||b.isMatrix4)b=[b];h.identity();for(var c=0,d=b.length>a.transformationMatrices.length?
b.length:a.transformationMatrices.length;c<d;c++){if(b[c]){var e;q[c]=b[c].isMatrix4?b[c]:(e=r.clone()).set.apply(e,$jscomp.arrayFromIterable(b[c]))}a.transformationMatrices[c]?b[c]&&a.transformationMatrices[c].multiply(q[c]):a.transformationMatrices[c]=b[c]?q[c]:r.clone();h.premultiply(a.transformationMatrices[c])}a.matrix.identity();a.applyMatrix(h);g.render();return!0};u.prototype.resetPluginTransformation=function(a){a=t.getPathObject(f,a);a.originalMatrix&&(a.matrix.identity(),a.applyMatrix(a.originalMatrix),
a.transformationMatrices=[]);g.render();return!0};u.prototype.toggleGeometry=function(a,b){for(var d=0;d<a.length;d++)if(module$src$shared$util$GlobalUtils.default.typeCheck(a[d],"string")){var e=t.getPathObject(f,a[d]);e&&(e.visible=!0);e=m.indexOf(a[d]);-1<e&&m.splice(e,1)}for(a=0;a<b.length;a++)module$src$shared$util$GlobalUtils.default.typeCheck(b[a],"string")&&(m.includes(b[a])||m.push(b[a]));c.evaluateGeometryVisibility()};u.prototype.evaluateGeometryVisibility=function(){for(var a=0;a<m.length;a++){var b=
t.getPathObject(f,m[a]);b&&(b.visible=!1)}g.updateShadowMap();g.render()};return new u(a,b)}};var module$src$app$handlers$ViewportVisibilityHandler={},viewerAppConstants$$module$src$app$handlers$ViewportVisibilityHandler=module$src$app$ViewerAppConstants.default,MessagePrototype$$module$src$app$handlers$ViewportVisibilityHandler=module$src$shared$messages$MessagePrototype.default,GlobalUtils$$module$src$app$handlers$ViewportVisibilityHandler=module$src$shared$util$GlobalUtils.default;
module$src$app$handlers$ViewportVisibilityHandler.default=function(a){var b=this,c=a.viewportManager,g=a.sceneGeometryManager,d=!1,f={isVisible:function(){return b.getSettingShallow("showScene")},showScene:function(a){if(!1===a)c.updateSetting("show",!1),f.isVisible()&&(a=new module$src$shared$messages$MessagePrototype.default(module$src$app$ViewerAppConstants.default.messageDataTypes.GENERIC,{shownBefore:d}),b.message(module$src$app$ViewerAppConstants.default.messageTopics.SCENE_VISIBILITY_OFF,a));
else{c.updateSetting("show",!0);f.isVisible()||(a=new module$src$shared$messages$MessagePrototype.default(module$src$app$ViewerAppConstants.default.messageDataTypes.GENERIC,{shownBefore:d}),b.message(module$src$app$ViewerAppConstants.default.messageTopics.SCENE_VISIBILITY_ON,a));if(!d&&!b.getSetting("hasRestoredSettings")&&(a=c.getDefaultThreeDManagers(),0<a.length)){var e=a[0];e.api.camera.zoomAsync().then(function(a){a.data&&e.updateSettingAsync("camera.defaults.perspective",a.data)})}d=!0}},hideScene:function(){b.updateSetting("showScene",
!1)}};this.registerHook("showSceneTransition",function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string"))return!1;c.updateSetting("showTransition",a);return!0});this.registerHook("showScene",function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean")||0===g.getGeometryNode().children.length)return!1;f.showScene(a);return!0});var p={};f.messageReceiver=function(a,c,f){if(!d)if(c=c||{},f===module$src$app$ViewerAppConstants.default.messageDataTypes.PROCESS_STATUS&&
0===c.progress)p[a.id]=a;else if(f===module$src$app$ViewerAppConstants.default.messageDataTypes.PROCESS_SUCCESS)p.hasOwnProperty(a.id)&&(delete p[a.id],a=b.getSettingShallow("showSceneMode"),(a===module$src$app$ViewerAppConstants.default.showSceneModes.ON_FIRST_PLUGIN||0===Object.keys(p).length&&a===module$src$app$ViewerAppConstants.default.showSceneModes.ON_ALL_PLUGINS)&&b.updateSetting("showScene",!0));else if(f===module$src$app$ViewerAppConstants.default.messageDataTypes.PROCESS_ERROR)b.debug("ViewportVisibilityHandler.messageReceiver",
"Received PROCESS_ERROR for initial geometry loading process, not yet showing 3D scene",a);else if(f===module$src$app$ViewerAppConstants.default.messageDataTypes.PROCESS_FORK&&p.hasOwnProperty(a.id)){f=p[a.id];for(var e in c)c=module$src$shared$util$GlobalUtils.default.deepCopy(f),c.id=e,p[e]=c;delete p[a.id]}};f.init=function(){b.getSetting("showSceneMode")===module$src$app$ViewerAppConstants.default.showSceneModes.INSTANT?b.updateSetting("showScene",!0):b.updateSetting("showScene",!1);setTimeout(function(){b.updateSetting("showSceneTransition",
b.getSetting("showSceneTransition"))},0)};return f};var module$src$shared$scene$OutputVersion={},GlobalUtils$$module$src$shared$scene$OutputVersion=module$src$shared$util$GlobalUtils.default;
module$src$shared$scene$OutputVersion.default=function(a){var b=this,c={},g={};this.addOutputVersion=function(a){if(!a.hasOwnProperty("id")||c.hasOwnProperty(a.id))return!1;c[a.id]=a;a.hasOwnProperty("name")&&(g[a.name]=g[a.name]||[],g[a.name].push(a.id));return!0};this.removeOutputVersion=function(a){if(module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")){c[a]&&delete c[a];var b=Object.keys(g);b=$jscomp.makeIterator(b);for(var d=b.next();!d.done;d=b.next()){d=d.value;var f=g[d].indexOf(a);
-1!==f&&g[d].splice(f,1)}}};this.getOutputVersion=function(a){return c[a]};this.getOutputVersionIdByName=function(a){return g[a]};this.outputIds=Object.defineProperty(this,"outputIds",{enumerable:!0,configurable:!1,readable:!0,get:function(){return Object.keys(c)}});this.outputNames=Object.defineProperty(this,"outputNames",{enumerable:!0,configurable:!1,readable:!0,get:function(){return Object.keys(g)}});this.getCompiledOutputVersion=function(a,c){if("string"!==typeof a||!c)return null;var d=b.getOutputVersion(a);
if(!d||!Array.isArray(d.geometry)||0===d.geometry.length)return null;var f={geometry:[]};"id version name bbmin bbmax interactionGroup interactionMode duration dragPlaneNormal visible".split(" ").forEach(function(a){d.hasOwnProperty(a)&&(f[a]=d[a])});a=null;if(d.hasOwnProperty("materialId")){var h=this.getOutputVersion(d.materialId);h&&h.material&&(a=h.material)}h={};for(var g=$jscomp.makeIterator(d.geometry),q=g.next();!q.done;h={geom:h.geom,g:h.g},q=g.next()){h.geom=q.value;h.g={};"path type geometry texcoord initialMatrix material color".split(" ").forEach(function(a){return function(b){a.geom.hasOwnProperty(b)&&
(a.g[b]=a.geom[b])}}(h));["path","type"].forEach(function(a){return function(b){if(!a.g.hasOwnProperty(b))return null}}(h));if(!h.g.hasOwnProperty("material")){q=null;q=a?a:d.hasOwnProperty("material")?d.material:[c];var p=h.g.path.split(".");if(0<p.length){var u=null;p=$jscomp.makeIterator(p);for(var n=p.next();!n.done;n=p.next())if(n=n.value,n.includes("content_")){u=n;break}null!==u&&(u=u.split("_"),"content"===u[0]&&2===u.length&&(u=parseInt(u[1]),isNaN(u)||(h.g.material=q[u%q.length].clone(),
h.geom.hasOwnProperty("flatShade")&&!1===h.g.material.flatShading&&(h.g.material.flatShading=h.geom.flatShade))))}h.g.hasOwnProperty("material")||(h.g.material=q[0])}h.g.material.bumpScale=c.bumpScale;f.geometry.push(h.g)}return f};if(null!==a&&Array.isArray(a)){a=$jscomp.makeIterator(a);for(var d=a.next();!d.done;d=a.next())b.addOutputVersion(d.value)}};var module$src$externals$verb_nurbs={};try{module$src$externals$verb_nurbs.default=eval("verb")}catch(a){"function"===typeof require&&(module$src$externals$verb_nurbs.default=eval("require('verb-nurbs')"))};var module$src$shared$util$verbToThreeConversion={default:{}},verb$$module$src$shared$util$verbToThreeConversion;try{verb$$module$src$shared$util$verbToThreeConversion=module$src$externals$verb_nurbs.default}catch(a){verb$$module$src$shared$util$verbToThreeConversion=null}
if(verb$$module$src$shared$util$verbToThreeConversion){var THREE$235=module$src$externals$three.default,asVector3=function(a){return a.map(function(a){return new module$src$externals$three.default.Vector3(a[0],a[1],a[2])})},tessellateCurve=function(a){var b=new module$src$externals$three.default.Geometry;b.vertices=asVector3(a.tessellate());return b},tessellateSurface=function(a){var b=a.tessellate();a=new module$src$externals$three.default.Geometry;a.vertices=asVector3(b.points);a.faces=b.faces.map(function(a){var c=
a.map(function(a){a=b.normals[a];return new module$src$externals$three.default.Vector3(a[0],a[1],a[2])});return new module$src$externals$three.default.Face3(a[0],a[1],a[2],c)});return a};verb$$module$src$shared$util$verbToThreeConversion.geom.NurbsCurve.prototype.toThreeGeometry=function(){return tessellateCurve(this)};verb$$module$src$shared$util$verbToThreeConversion.geom.NurbsSurface.prototype.toThreeGeometry=function(){return tessellateSurface(this)}};var module$src$shared$singletons$GLBLoader={},AXIOS$$module$src$shared$singletons$GLBLoader=module$src$externals$axios.default,THREE$$module$src$shared$singletons$GLBLoader=module$src$externals$three.default,TO_TINY_COLOR$$module$src$shared$singletons$GLBLoader=module$src$shared$util$toTinyColor.default,GLOBAL_UTILS$$module$src$shared$singletons$GLBLoader=module$src$shared$util$GlobalUtils.default,MATERIAL_PROPERTIES_STANDARD$$module$src$shared$singletons$GLBLoader=module$src$shared$materials$MaterialPropertiesStandard.default,
verb$$module$src$shared$singletons$GLBLoader,verb_util$$module$src$shared$singletons$GLBLoader;try{verb$$module$src$shared$singletons$GLBLoader=module$src$externals$verb_nurbs.default,null!==verb$$module$src$shared$singletons$GLBLoader&&(verb_util$$module$src$shared$singletons$GLBLoader=module$src$shared$util$verbToThreeConversion)}catch(a){verb$$module$src$shared$singletons$GLBLoader=null}
var GLBLoader$$module$src$shared$singletons$GLBLoader=function(){var a=this;this.log=function(){};this.warn=function(){};this.error=function(){};this.loadGeometry=function(a,g,d){d=d||.001;return(0,module$src$externals$axios.default)({method:"GET",url:a,timeout:3E4,responseType:"arraybuffer"}).catch(function(a){return a.response?Promise.reject(Error("Loading glb failed with status "+a.response.status+".")):a.request?Promise.reject(Error("No response to glb download AJAX request.")):Promise.reject(Error("Error setting up the glb download AJAX request."))}).then(function(a){return b(a.data,
g,d)})};var b=function(b,g,d){return new Promise(function(c,p){for(var e=new DataView(b),f="",h=0;4>h;++h)f+=String.fromCharCode(e.getUint8(h));if("glTF"!=f)p(Error("ShapeDiverGLBLoader got invalid data: glTF magic wrong."));else{f=e.getUint32(8,!0);h=e.getUint32(12,!0);for(var r="",q=0;q<h;++q)r+=String.fromCharCode(e.getUint8(20+q));var t=JSON.parse(r),u=20+h;if(t.hasOwnProperty("meshes")&&t.hasOwnProperty("bufferViews")&&t.hasOwnProperty("accessors")){var n={};Object.keys(t.accessors).forEach(function(c){var d=
t.accessors[c],e=d.bufferView;if(t.bufferViews.hasOwnProperty(e)){var f=t.bufferViews[e];e={};if(d.hasOwnProperty("type")&&d.hasOwnProperty("count")&&d.hasOwnProperty("componentType")){switch(d.type){case "SCALAR":e.itemSize=1;break;case "VEC2":e.itemSize=2;break;case "VEC3":e.itemSize=3;break;case "VEC4":e.itemSize=4;break;case "MAT2":e.itemSize=4;break;case "MAT3":e.itemSize=9;break;case "MAT4":e.itemSize=16;break;default:e.itemSize=1}var h=u+parseInt(f.byteOffset)+parseInt(d.byteOffset);if(b.length<
h+d.count*e.itemSize)p(Error("Error: buffer length exceeded"));else{var g=d.count*e.itemSize;switch(d.componentType){case 5120:e.typedArray=new Int8Array(b,h,g);break;case 5121:e.typedArray=new Uint8Array(b,h,g);break;case 5122:if(0==h%2)e.typedArray=new Int16Array(b,h,g);else{a.warn("Geometry loader encountered unaligned data.");f=new ArrayBuffer(2*g);var l=new Int8Array(f);h=new Int8Array(b,h,2*g);for(var m=0,q=2*g;m<q;++m)l[m]=h[m];e.typedArray=new Int16Array(f,0,d.count*e.itemSize)}break;case 5123:if(0==
h%2)e.typedArray=new Uint16Array(b,h,g);else{a.warn("Geometry loader encountered unaligned data.");f=new ArrayBuffer(2*g);l=new Int8Array(f);h=new Int8Array(b,h,2*g);d=0;for(q=2*g;d<q;++d)l[d]=h[d];e.typedArray=new Uint16Array(f,0,g)}break;case 5124:a.warn("Encountered 16 bit integer as type for array buffer. This is illegal for webGL. Ignoring it.");break;case 5125:a.warn("Encountered 16 bit unsigned integer as type for array buffer. This is illegal for webGL. Ignoring it.");break;case 5126:if(0==
h%4)e.typedArray=new Float32Array(b,h,g);else{a.warn("Geometry loader encountered unaligned data.");f=new ArrayBuffer(4*g);l=new Int8Array(f);h=new Int8Array(b,h,4*g);d=0;for(q=4*g;d<q;++d)l[d]=h[d];e.typedArray=new Float32Array(f,0,g)}break;default:e.typedArray=new Float32Array(b,h,g)}n[c]=e}}else p(Error("Invalid JSON format in glTF file. Accessor is missing required property."))}});var l={};t.hasOwnProperty("materials")&&Object.keys(t.materials).forEach(function(a){var b=t.materials[a];if(b.hasOwnProperty("extensions"))if(b.extensions.hasOwnProperty("KHR_materials_common"))if(b.extensions.KHR_materials_common.hasOwnProperty("technique"))if("BLINN"!=
b.extensions.KHR_materials_common.technique)p(Error("ShapeDiverGLBLoader got invalid data: only BLINN material technique is supported, we got "+b.extensions.KHR_materials_common.technique));else if(b.extensions.KHR_materials_common.hasOwnProperty("values")){var c=new module$src$shared$materials$MaterialPropertiesStandard.default;b=b.extensions.KHR_materials_common.values;b.hasOwnProperty("doubleSided")&&(c.side=b.doubleSided?module$src$externals$three.default.DoubleSide:module$src$externals$three.default.FrontSide);
if(b.hasOwnProperty("diffuse")){for(var d=b.diffuse.slice(0,3),e=0;3>e;++e)d[e]*=255;c.color=(0,module$src$shared$util$toTinyColor.default)(d).toThreeColor();d=Math.max(0,Math.min(b.diffuse[3],1));c.opacity=d;c.transparent=1>d}b.hasOwnProperty("shininess")&&(c.metalness=Math.min(1,b.shininess),c.roughness=1-Math.min(1,b.shininess));b.hasOwnProperty("transparency")&&(d=Math.max(0,Math.min(b.transparency,1)),c.opacity=d,c.transparent=1>d);b.hasOwnProperty("transparent")&&(d=module$src$shared$util$GlobalUtils.default.toBoolean(b.transparent),
c.transparent=d,d||(c.opacity=1));b.hasOwnProperty("_roughness")&&(c.roughness=Math.min(1,Math.max(0,b.roughness)));b.hasOwnProperty("_metalness")&&(c.metalness=Math.min(1,Math.max(0,b.metalness)));l[a]=c}else p(Error("ShapeDiverGLBLoader got invalid data: material definition did not contain values member."));else p(Error("ShapeDiverGLBLoader got invalid data: material definition did not contain technique member."));else p(Error("ShapeDiverGLBLoader got invalid data: material definition did not contain KHR_materials_common member."));
else p(Error("ShapeDiverGLBLoader got invalid data: material definition did not contain extensions member."))});var v={};Object.keys(t.meshes).forEach(function(a){var b=[],c=t.meshes[a];if(c.hasOwnProperty("primitives")){c=$jscomp.makeIterator(c.primitives);for(var d=c.next();!d.done;d=c.next()){var e=d.value;if(!e.hasOwnProperty("indices")||!e.hasOwnProperty("attributes")){p(Error("ShapeDiverGLBLoader got invalid data: mesh definition primitive misses indices or attributes."));return}if(!e.attributes.hasOwnProperty("POSITION")){p(Error("ShapeDiverGLBLoader got invalid data: mesh definition primitive is missing POSITION"));
return}d=new module$src$externals$three.default.BufferGeometry;if(!n.hasOwnProperty(e.indices)){p(Error("ShapeDiverGLBLoader got invalid data: accessor for mesh primitives not found."));return}var f=n[e.indices];d.setIndex(new module$src$externals$three.default.BufferAttribute(f.typedArray,f.itemSize));if(!n.hasOwnProperty(e.attributes.POSITION)){p(Error("ShapeDiverGLBLoader got invalid data: accessor for mesh positions not found"));return}f=n[e.attributes.POSITION];d.addAttribute("position",new module$src$externals$three.default.BufferAttribute(f.typedArray,
f.itemSize));f=!1;if(e.attributes.hasOwnProperty("NORMAL")){if(n.hasOwnProperty(e.attributes.NORMAL)){for(var h=n[e.attributes.NORMAL],g=!1,m=0;10>m;++m){if(.001<Math.abs(h.typedArray[3*m])){g=!0;break}if(.001<Math.abs(h.typedArray[3*m+1])){g=!0;break}if(.001<Math.abs(h.typedArray[3*m+2])){g=!0;break}}g?d.addAttribute("normal",new module$src$externals$three.default.BufferAttribute(h.typedArray,h.itemSize)):d.computeVertexNormals()}}else f=!0;h=!1;e.attributes.hasOwnProperty("COLOR")&&n.hasOwnProperty(e.attributes.COLOR)&&
(h=n[e.attributes.COLOR],d.addAttribute("color",new module$src$externals$three.default.BufferAttribute(h.typedArray,h.itemSize,!0)),h=!0);m=!1;e.attributes.hasOwnProperty("TEXCOORD_0")&&n.hasOwnProperty(e.attributes.TEXCOORD_0)&&(g=n[e.attributes.TEXCOORD_0],d.addAttribute("uv",new module$src$externals$three.default.BufferAttribute(g.typedArray,g.itemSize)),m=!0);g=null;e.hasOwnProperty("material")&&(e=e.material,l.hasOwnProperty(e)&&(g=l[e]));d={geometry:d,hasTexCoord:m,hasVertexColors:h,flatShading:f};
null!=g&&(d.material=g);b.push(d)}v[a]=b}else p(Error("ShapeDiverGLBLoader got invalid data: primitives property missing."))});var x=[];Array.isArray(g)&&0!=g.length&&g.every(function(a){return a&&a.isMatrix4})||(g=[new module$src$externals$three.default.Matrix4]);Object.keys(t.nodes).forEach(function(a){var b=t.nodes[a],c=new module$src$externals$three.default.Matrix4;b.hasOwnProperty("matrix")&&c.fromArray(b.matrix);if(b.hasOwnProperty("meshes"))for(var d={transformIndex:0};d.transformIndex<g.length;d=
{transformIndex:d.transformIndex,matrixFinal:d.matrixFinal},++d.transformIndex){var e=g[d.transformIndex];d.matrixFinal=new module$src$externals$three.default.Matrix4;d.matrixFinal.multiplyMatrices(e,c);b.meshes.forEach(function(b){return function(c){if(v.hasOwnProperty(c))for(var d=0,e=v[c].length;d<e;++d){var f={path:"transformation_"+b.transformIndex+"."+a+"."+c+".primitive_"+d,geometry:v[c][d].geometry,texCoord:v[c][d].hasTexCoord,vertexColors:v[c][d].hasVertexColors,initialMatrix:b.matrixFinal,
type:"mesh"};v[c][d].hasOwnProperty("material")?(v[c][d].flatShading&&!1===v[c][d].material.flatShading&&(v[c][d].material.flatShading=v[c][d].flatShading),f.material=v[c][d].material):f.flatShade=v[c][d].flatShading;x.push(f)}}}(d))}});h="";for(r=0;5>r;++r)h+=String.fromCharCode(e.getUint8(f+r));if("sdgTF"!=h)a.warn("ShapeDiverGLBLoader got invalid data, sdgTF magic wrong : "+h);else{e=e.getUint32(f+13,!0);h="";r=Math.ceil(e/1024);for(q=0;q<r;++q){var w=1024;1024>e-1024*q&&(w=e-1024*q);h+=String.fromCharCode.apply(null,
new Uint8Array(b,f+21+1024*q,w))}var y=JSON.parse(h),z=f+21+e;if(y.hasOwnProperty("accessors")){n={};Object.keys(y.accessors).forEach(function(d){var e=y.accessors[d],f={};if(e.hasOwnProperty("type")&&e.hasOwnProperty("count")&&e.hasOwnProperty("componentType")){switch(e.type){case "SCALAR":f.itemSize=1;break;case "VEC2":f.itemSize=2;break;case "VEC3":f.itemSize=3;break;case "VEC4":f.itemSize=4;break;case "VEC7":f.itemSize=7;break;case "VEC10":f.itemSize=10;break;case "VEC12":f.itemSize=12;break;
case "MAT2":f.itemSize=4;break;case "MAT3":f.itemSize=9;break;case "MAT4":f.itemSize=16;break;default:f.itemSize=1}var h=z+parseInt(e.byteOffset);b.length<h+e.count*e.itemSize&&a.warn("Error: buffer length exceeded");switch(e.componentType){case 5120:f.typedArray=new Int8Array(b,h,e.count*f.itemSize);break;case 5121:f.typedArray=new Uint8Array(b,h,e.count*f.itemSize);break;case 5122:f.typedArray=new Int16Array(b,h,e.count*f.itemSize);break;case 5123:f.typedArray=new Uint16Array(b,h,e.count*f.itemSize);
break;case 5126:f.typedArray=new Float32Array(b,h,e.count*f.itemSize);break;default:f.typedArray=new Float32Array(b,h,e.count*f.itemSize)}f.count=e.count;n[d]=f}else a.warn("ShapeDiverGLBLoader got invalid data for ShapeDiver formats. Returning pure glTF-based object only."),c(x)});if(y.hasOwnProperty("spheres")&&(f=y.spheres,f.hasOwnProperty("attributes")&&(f=f.attributes,f.hasOwnProperty("SPHERES"))))for(e=n[f.SPHERES],r=0,f=e.count;r<f;++r)h=new module$src$externals$three.default.SphereBufferGeometry(e.typedArray[4*
r+3],20,20),h.translate(e.typedArray[4*r],e.typedArray[4*r+1],e.typedArray[4*r+2]),x.push({path:"sdgtf_sphere_"+(r+1).toString(),geometry:h,texCoord:!1,type:"mesh"});if(y.hasOwnProperty("circles")&&(f=y.circles,f.hasOwnProperty("attributes")&&(f=f.attributes,f.hasOwnProperty("CIRCLES"))))for(e=n[f.CIRCLES],h=0,f=e.count;h<f;++h){r=new module$src$externals$three.default.Vector3(e.typedArray[10*h],e.typedArray[10*h+1],e.typedArray[10*h+2]);q=new module$src$externals$three.default.Vector3(e.typedArray[10*
h+3],e.typedArray[10*h+4],e.typedArray[10*h+5]);w=new module$src$externals$three.default.Vector3(e.typedArray[10*h+6],e.typedArray[10*h+7],e.typedArray[10*h+8]);var B=e.typedArray[10*h+9],A=new module$src$externals$three.default.Vector3;A.crossVectors(q,w);if(0<B){B=new module$src$externals$three.default.ArcCurve(0,0,B,0,2*Math.PI,!1);B=(new module$src$externals$three.default.Geometry).setFromPoints(B.getPoints(50));var D=new module$src$externals$three.default.Matrix4;D.set(q.x,w.x,A.x,0,q.y,w.y,
A.y,0,q.z,w.z,A.z,0,0,0,0,1);B.applyMatrix(D);B.translate(r.x,r.y,r.z);B.sdgtfType="circle";x.push({path:"sdgtf_circle_"+(h+1).toString(),geometry:B,type:"line"})}}if(y.hasOwnProperty("cylinders")&&(f=y.cylinders,f.hasOwnProperty("attributes")&&(f=f.attributes,f.hasOwnProperty("CYLINDERS"))))for(e=n[f.CYLINDERS],h=0,f=e.count;h<f;++h){A=new module$src$externals$three.default.Vector3(e.typedArray[7*h],e.typedArray[7*h+1],e.typedArray[7*h+2]);r=new module$src$externals$three.default.Vector3(e.typedArray[7*
h+3],e.typedArray[7*h+4],e.typedArray[7*h+5]);B=e.typedArray[7*h+6];q=new module$src$externals$three.default.Vector3;q.subVectors(A,r);D=Math.abs(q.dot(new module$src$externals$three.default.Vector3(1,0,0)));var H=Math.abs(q.dot(new module$src$externals$three.default.Vector3(0,1,0)));w=new module$src$externals$three.default.Vector3;D<H?w.crossVectors(q,new module$src$externals$three.default.Vector3(1,0,0)):w.crossVectors(q,new module$src$externals$three.default.Vector3(0,1,0));D=new module$src$externals$three.default.Vector3;
D.crossVectors(q,w);q.normalize();w.normalize();D.normalize();B=new module$src$externals$three.default.CylinderBufferGeometry(B,B,A.distanceTo(r),50,1,!0);B.rotateX(.5*Math.PI);B.translate(0,0,.5*A.distanceTo(r));A=new module$src$externals$three.default.Matrix4;A.set(w.x,D.x,q.x,0,w.y,D.y,q.y,0,w.z,D.z,q.z,0,0,0,0,1);B.applyMatrix(A);B.translate(r.x,r.y,r.z);x.push({path:"sdgtf_cylinder_"+(h+1).toString(),geometry:B,texCoord:!1,type:"mesh"})}if(y.hasOwnProperty("arcs")&&(f=y.arcs,f.hasOwnProperty("attributes")&&
(f=f.attributes,f.hasOwnProperty("ARCS"))))for(e=n[f.ARCS],h=0,f=e.count;h<f;++h)r=new module$src$externals$three.default.Vector3(e.typedArray[12*h],e.typedArray[12*h+1],e.typedArray[12*h+2]),q=new module$src$externals$three.default.Vector3(e.typedArray[12*h+3],e.typedArray[12*h+4],e.typedArray[12*h+5]),w=new module$src$externals$three.default.Vector3(e.typedArray[12*h+6],e.typedArray[12*h+7],e.typedArray[12*h+8]),H=e.typedArray[12*h+9],B=e.typedArray[12*h+10],D=e.typedArray[12*h+11],A=new module$src$externals$three.default.Vector3,
A.crossVectors(q,w),0<H&&(H=new module$src$externals$three.default.ArcCurve(0,0,H,B,D,!1),B=(new module$src$externals$three.default.Geometry).setFromPoints(H.getPoints(Math.max(3,Math.round((D-B)/2*50*Math.PI)))),D=new module$src$externals$three.default.Matrix4,D.set(q.x,w.x,A.x,0,q.y,w.y,A.y,0,q.z,w.z,A.z,0,0,0,0,1),B.applyMatrix(D),B.translate(r.x,r.y,r.z),B.sdgtfType="arc",x.push({path:"sdgtf_arc_"+(h+1).toString(),geometry:B,type:"line"}));if(verb$$module$src$shared$singletons$GLBLoader&&y.hasOwnProperty("beziercurves")){var G=
y.beziercurves,E=0;Object.keys(G).forEach(function(b){var c=G[b];if(c.hasOwnProperty("attributes")&&c.hasOwnProperty("degree")){var e=c.attributes;if(e.hasOwnProperty("KNOTS")&&e.hasOwnProperty("CONTROLPOINTS")){var f=n[e.KNOTS];b=[];for(var h=0,g=f.typedArray.length;h<g;++h)b.push(f.typedArray[h]),0!=h&&h!=f.typedArray.length-1||b.push(f.typedArray[h]);f=n[e.CONTROLPOINTS];e=[];h=0;for(g=f.typedArray.length/3;h<g;++h)e.push([f.typedArray[3*h],f.typedArray[3*h+1],f.typedArray[3*h+2]]);c=c.degree;
try{var l=verb$$module$src$shared$singletons$GLBLoader.geom.NurbsCurve.byKnotsControlPointsWeights(c,b,e)}catch(S){a.warn("verb nurbs curve creation failed with error "+S);return}l=l.toThreeGeometry(d);l.sdgtfType="beziercurve";x.push({path:"sdgtf_curve_"+(E+1).toString(),geometry:l,type:"line"});++E}}})}if(verb$$module$src$shared$singletons$GLBLoader&&y.hasOwnProperty("surfacepatches")){var J=y.surfacepatches,F=0;Object.keys(J).forEach(function(b){var c=J[b];if(c.hasOwnProperty("attributes")&&c.hasOwnProperty("degreeU")&&
c.hasOwnProperty("degreeV")&&c.hasOwnProperty("controlPointCountU")&&c.hasOwnProperty("controlPointCountV")){var e=c.attributes;if(e.hasOwnProperty("KNOTSU")&&e.hasOwnProperty("KNOTSV")&&e.hasOwnProperty("CONTROLPOINTS")){var f=n[e.KNOTSU];b=[];for(var h=0,g=f.typedArray.length;h<g;++h)b.push(f.typedArray[h]),0!=h&&h!=f.typedArray.length-1||b.push(f.typedArray[h]);h=n[e.KNOTSV];f=[];var l=0;for(g=h.typedArray.length;l<g;++l)f.push(h.typedArray[l]),0!=l&&l!=h.typedArray.length-1||f.push(h.typedArray[l]);
g=c.controlPointCountU;h=c.controlPointCountV;l=n[e.CONTROLPOINTS];e=[];for(var m=0,q=0;q<g;++q){for(var r=[],p=0;p<h;++p)r.push([l.typedArray[3*m],l.typedArray[3*m+1],l.typedArray[3*m+2]]),++m;e.push(r)}g=c.degreeU;c=c.degreeV;try{var t=verb$$module$src$shared$singletons$GLBLoader.geom.NurbsSurface.byKnotsControlPointsWeights(g,c,b,f,e)}catch(V){a.warn("verb surface curve creation failed with error "+V.message);return}t=t.toThreeGeometry(d);t.computeFaceNormals();t.computeVertexNormals();x.push({path:"sdgtf_surface_"+
(F+1).toString(),geometry:t,texCoord:!1,type:"mesh"});++F}}})}if(y.hasOwnProperty("polylines")){var C=y.polylines,I=0;Object.keys(C).forEach(function(a){a=C[a];if(a.hasOwnProperty("attributes")&&(a=a.attributes,a.hasOwnProperty("VERTICES"))){a=n[a.VERTICES];var b=new module$src$externals$three.default.BufferGeometry;b.addAttribute("position",new module$src$externals$three.default.BufferAttribute(a.typedArray,3));b.sdgtfType="polyline";x.push({path:"sdgtf_polyline_"+(I+1).toString(),geometry:b,type:"line"});
++I}})}if(y.hasOwnProperty("points")){var M=y.points,N=0;Object.keys(M).forEach(function(a){a=M[a];if(a.hasOwnProperty("attributes")&&(a=a.attributes,a.hasOwnProperty("POINTS"))){a=n[a.POINTS];for(var b=new module$src$externals$three.default.Geometry,c=0,d=a.typedArray.length/3;c<d;++c){var e=new module$src$externals$three.default.Vector3(a.typedArray[3*c],a.typedArray[3*c+1],a.typedArray[3*c+2]);b.vertices.push(e)}x.push({path:"sdgtf_pointcloud_"+(N+1).toString(),geometry:b,type:"points"});++N}})}}else a.warn("ShapeDiverGLBLoader got invalid data for ShapeDiver formats. Returning pure glTF-based object only.")}c(x)}else p(Error("Invalid JSON format in glTF file. Main object is missing required property."))}})}};
module$src$shared$singletons$GLBLoader.default=new GLBLoader$$module$src$shared$singletons$GLBLoader;var module$src$3d$loaders$MTLLoader={default:{}},THREE$$module$src$3d$loaders$MTLLoader=module$src$externals$three.default;module$src$externals$three.default.MTLLoader=function(a){this.manager=void 0!==a?a:module$src$externals$three.default.DefaultLoadingManager};
module$src$externals$three.default.MTLLoader.prototype={constructor:module$src$externals$three.default.MTLLoader,load:function(a,b,c,g){var d=this,f=new module$src$externals$three.default.FileLoader(this.manager);f.setPath(this.path);f.load(a,function(a){b(d.parse(a))},c,g)},setPath:function(a){this.path=a;return this},setTexturePath:function(a){this.texturePath=a;return this},setBaseUrl:function(a){console.warn("THREE.MTLLoader: .setBaseUrl() is deprecated. Use .setTexturePath( path ) for texture path or .setPath( path ) for general base path instead.");
return this.setTexturePath(a)},setCrossOrigin:function(a){this.crossOrigin=a;return this},setMaterialOptions:function(a){this.materialOptions=a;return this},parse:function(a){var b=a.split("\n"),c={},g=/\s+/;a={};for(var d=0;d<b.length;d++){var f=b[d];f=f.trim();if(0!==f.length&&"#"!==f.charAt(0)){var p=f.indexOf(" "),e=0<=p?f.substring(0,p):f;e=e.toLowerCase();f=0<=p?f.substring(p+1):"";f=f.trim();"newmtl"===e?(c={name:f},a[f]=c):c&&("ka"===e||"kd"===e||"ks"===e?(f=f.split(g,3),c[e]=[parseFloat(f[0]),
parseFloat(f[1]),parseFloat(f[2])]):c[e]=f)}}b=new module$src$externals$three.default.MTLLoader.MaterialCreator(this.texturePath||this.path,this.materialOptions);b.setCrossOrigin(this.crossOrigin);b.setManager(this.manager);b.setMaterials(a);return b}};
module$src$externals$three.default.MTLLoader.MaterialCreator=function(a,b){this.baseUrl=a||"";this.options=b;this.materialsInfo={};this.materials={};this.materialsArray=[];this.nameLookup={};this.side=this.options&&this.options.side?this.options.side:module$src$externals$three.default.FrontSide;this.wrap=this.options&&this.options.wrap?this.options.wrap:module$src$externals$three.default.RepeatWrapping};
module$src$externals$three.default.MTLLoader.MaterialCreator.prototype={constructor:module$src$externals$three.default.MTLLoader.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(a){this.crossOrigin=a;return this},setManager:function(a){this.manager=a},setMaterials:function(a){this.materialsInfo=this.convert(a);this.materials={};this.materialsArray=[];this.nameLookup={}},convert:function(a){if(!this.options)return a;var b={},c;for(c in a){var g=a[c],d={};b[c]=d;for(var f in g){var p=
!0,e=g[f],m=f.toLowerCase();switch(m){case "kd":case "ka":case "ks":this.options&&this.options.normalizeRGB&&(e=[e[0]/255,e[1]/255,e[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===e[0]&&0===e[1]&&0===e[2]&&(p=!1)}p&&(d[m]=e)}}return b},preload:function(){for(var a in this.materialsInfo)this.create(a)},getIndex:function(a){return this.nameLookup[a]},getAsArray:function(){var a=0,b;for(b in this.materialsInfo)this.materialsArray[a]=this.create(b),this.nameLookup[b]=a,a++;return this.materialsArray},
create:function(a){void 0===this.materials[a]&&this.createMaterial_(a);return this.materials[a]},createMaterial_:function(a){function b(a,b){return"string"!==typeof b||""===b?"":/^https?:\/\//i.test(b)?b:a+b}function c(a,c){if(!f[a]){c=g.getTextureParams(c,f);var d=g.loadTexture(b(g.baseUrl,c.url));d.repeat.copy(c.scale);d.offset.copy(c.offset);d.wrapS=g.wrap;d.wrapT=g.wrap;f[a]=d}}var g=this,d=this.materialsInfo[a],f={name:a,side:this.side},p;for(p in d){var e=d[p];if(""!==e)switch(p.toLowerCase()){case "kd":f.color=
(new module$src$externals$three.default.Color).fromArray(e);break;case "ks":f.specular=(new module$src$externals$three.default.Color).fromArray(e);break;case "map_kd":c("map",e);break;case "map_ks":c("specularMap",e);break;case "norm":c("normalMap",e);break;case "map_bump":case "bump":c("bumpMap",e);break;case "ns":f.shininess=parseFloat(e);break;case "d":e=parseFloat(e);1>e&&(f.opacity=e,f.transparent=!0);break;case "tr":e=parseFloat(e),this.options&&this.options.invertTrProperty&&(e=1-e),0<e&&(f.opacity=
1-e,f.transparent=!0)}}this.materials[a]=new module$src$externals$three.default.MeshPhongMaterial(f);return this.materials[a]},getTextureParams:function(a,b){var c={scale:new module$src$externals$three.default.Vector2(1,1),offset:new module$src$externals$three.default.Vector2(0,0)};a=a.split(/\s+/);var g=a.indexOf("-bm");0<=g&&(b.bumpScale=parseFloat(a[g+1]),a.splice(g,2));g=a.indexOf("-s");0<=g&&(c.scale.set(parseFloat(a[g+1]),parseFloat(a[g+2])),a.splice(g,4));g=a.indexOf("-o");0<=g&&(c.offset.set(parseFloat(a[g+
1]),parseFloat(a[g+2])),a.splice(g,4));c.url=a.join(" ").trim();return c},loadTexture:function(a,b,c,g,d){var f=module$src$externals$three.default.Loader.Handlers.get(a),p=void 0!==this.manager?this.manager:module$src$externals$three.default.DefaultLoadingManager;null===f&&(f=new module$src$externals$three.default.TextureLoader(p));f.setCrossOrigin&&f.setCrossOrigin(this.crossOrigin);a=f.load(a,c,g,d);void 0!==b&&(a.mapping=b);return a}};var module$src$3d$loaders$OBJLoader={default:{}},THREE$$module$src$3d$loaders$OBJLoader=module$src$externals$three.default;
module$src$externals$three.default.OBJLoader=function(){function a(){var a={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materialLibraries:[],startObject:function(a,b){if(this.object&&!1===this.object.fromDeclaration)this.object.name=a,this.object.fromDeclaration=!1!==b;else{var c=this.object&&"function"===typeof this.object.currentMaterial?this.object.currentMaterial():void 0;this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0);this.object={name:a||"",
fromDeclaration:!1!==b,geometry:{vertices:[],normals:[],colors:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(a,b){var c=this._finalize(!1);c&&(c.inherited||0>=c.groupCount)&&this.materials.splice(c.index,1);a={index:this.materials.length,name:a||"",mtllib:Array.isArray(b)&&0<b.length?b[b.length-1]:"",smooth:void 0!==c?c.smooth:this.smooth,groupStart:void 0!==c?c.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(a){a={index:"number"===typeof a?a:this.index,name:this.name,
mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};a.clone=this.clone.bind(a);return a}};this.materials.push(a);return a},currentMaterial:function(){if(0<this.materials.length)return this.materials[this.materials.length-1]},_finalize:function(a){var b=this.currentMaterial();b&&-1===b.groupEnd&&(b.groupEnd=this.geometry.vertices.length/3,b.groupCount=b.groupEnd-b.groupStart,b.inherited=!1);if(a&&1<this.materials.length)for(var c=this.materials.length-1;0<=c;c--)0>=
this.materials[c].groupCount&&this.materials.splice(c,1);a&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth});return b}};c&&c.name&&"function"===typeof c.clone&&(a=c.clone(0),a.inherited=!0,this.object.materials.push(a));this.objects.push(this.object)}},finalize:function(){this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(a,b){a=parseInt(a,10);return 3*(0<=a?a-1:a+b/3)},parseNormalIndex:function(a,b){a=parseInt(a,
10);return 3*(0<=a?a-1:a+b/3)},parseUVIndex:function(a,b){a=parseInt(a,10);return 2*(0<=a?a-1:a+b/2)},addVertex:function(a,b,c){var d=this.vertices,e=this.object.geometry.vertices;e.push(d[a+0],d[a+1],d[a+2]);e.push(d[b+0],d[b+1],d[b+2]);e.push(d[c+0],d[c+1],d[c+2])},addVertexPoint:function(a){var b=this.vertices;this.object.geometry.vertices.push(b[a+0],b[a+1],b[a+2])},addVertexLine:function(a){var b=this.vertices;this.object.geometry.vertices.push(b[a+0],b[a+1],b[a+2])},addNormal:function(a,b,c){var d=
this.normals,e=this.object.geometry.normals;e.push(d[a+0],d[a+1],d[a+2]);e.push(d[b+0],d[b+1],d[b+2]);e.push(d[c+0],d[c+1],d[c+2])},addColor:function(a,b,c){var d=this.colors,e=this.object.geometry.colors;e.push(d[a+0],d[a+1],d[a+2]);e.push(d[b+0],d[b+1],d[b+2]);e.push(d[c+0],d[c+1],d[c+2])},addUV:function(a,b,c){var d=this.uvs,e=this.object.geometry.uvs;e.push(d[a+0],d[a+1]);e.push(d[b+0],d[b+1]);e.push(d[c+0],d[c+1])},addUVLine:function(a){var b=this.uvs;this.object.geometry.uvs.push(b[a+0],b[a+
1])},addFace:function(a,b,c,d,f,g,t,u,n){var e=this.vertices.length;a=this.parseVertexIndex(a,e);b=this.parseVertexIndex(b,e);c=this.parseVertexIndex(c,e);this.addVertex(a,b,c);void 0!==d&&""!==d&&(c=this.uvs.length,a=this.parseUVIndex(d,c),b=this.parseUVIndex(f,c),c=this.parseUVIndex(g,c),this.addUV(a,b,c));void 0!==t&&""!==t&&(d=this.normals.length,a=this.parseNormalIndex(t,d),b=t===u?a:this.parseNormalIndex(u,d),c=t===n?a:this.parseNormalIndex(n,d),this.addNormal(a,b,c));0<this.colors.length&&
this.addColor(a,b,c)},addPointGeometry:function(a){this.object.geometry.type="Points";for(var b=this.vertices.length,c=0,d=a.length;c<d;c++)this.addVertexPoint(this.parseVertexIndex(a[c],b))},addLineGeometry:function(a,b){this.object.geometry.type="Line";for(var c=this.vertices.length,d=this.uvs.length,e=0,f=a.length;e<f;e++)this.addVertexLine(this.parseVertexIndex(a[e],c));a=0;for(f=b.length;a<f;a++)this.addUVLine(this.parseUVIndex(b[a],d))}};a.startObject("",!1);return a}function b(a){this.manager=
void 0!==a?a:module$src$externals$three.default.DefaultLoadingManager;this.materials=null}var c=/^[og]\s*(.+)?/,g=/^mtllib /,d=/^usemtl /;b.prototype={constructor:b,load:function(a,b,c,d){var e=this,f=new module$src$externals$three.default.FileLoader(e.manager);f.setPath(this.path);f.load(a,function(a){b(e.parse(a))},c,d)},setPath:function(a){this.path=a;return this},setMaterials:function(a){this.materials=a;return this},parse:function(b){console.time("OBJLoader");var f=new a;-1!==b.indexOf("\r\n")&&
(b=b.replace(/\r\n/g,"\n"));-1!==b.indexOf("\\\n")&&(b=b.replace(/\\\n/g,""));var e=b.split("\n"),m,h="function"===typeof"".trimLeft;b=0;for(var r=e.length;b<r;b++){var q=e[b];q=h?q.trimLeft():q.trim();var t=q.length;if(0!==t&&(t=q.charAt(0),"#"!==t))if("v"===t)switch(q=q.split(/\s+/),q[0]){case "v":f.vertices.push(parseFloat(q[1]),parseFloat(q[2]),parseFloat(q[3]));8===q.length&&f.colors.push(parseFloat(q[4]),parseFloat(q[5]),parseFloat(q[6]));break;case "vn":f.normals.push(parseFloat(q[1]),parseFloat(q[2]),
parseFloat(q[3]));break;case "vt":f.uvs.push(parseFloat(q[1]),parseFloat(q[2]))}else if("f"===t){q=q.substr(1).trim();var u=q.split(/\s+/);q=[];t=0;for(m=u.length;t<m;t++){var n=u[t];0<n.length&&(n=n.split("/"),q.push(n))}u=q[0];t=1;for(m=q.length-1;t<m;t++){n=q[t];var l=q[t+1];f.addFace(u[0],n[0],l[0],u[1],n[1],l[1],u[2],n[2],l[2])}}else if("l"===t){t=q.substring(1).trim().split(" ");m=[];u=[];if(-1===q.indexOf("/"))m=t;else for(q=0,n=t.length;q<n;q++)l=t[q].split("/"),""!==l[0]&&m.push(l[0]),""!==
l[1]&&u.push(l[1]);f.addLineGeometry(m,u)}else if("p"===t)q=q.substr(1).trim(),q=q.split(" "),f.addPointGeometry(q);else if(null!==(m=c.exec(q)))q=(" "+m[0].substr(1).trim()).substr(1),f.startObject(q);else if(d.test(q))f.object.startMaterial(q.substring(7).trim(),f.materialLibraries);else if(g.test(q))f.materialLibraries.push(q.substring(7).trim());else if("s"===t){if(m=q.split(" "),1<m.length?(q=m[1].trim().toLowerCase(),f.object.smooth="0"!==q&&"off"!==q):f.object.smooth=!0,q=f.object.currentMaterial())q.smooth=
f.object.smooth}else if("\x00"!==q)throw Error('THREE.OBJLoader: Unexpected line: "'+q+'"');}f.finalize();e=new module$src$externals$three.default.Group;e.materialLibraries=[].concat(f.materialLibraries);b=0;for(r=f.objects.length;b<r;b++)if(h=f.objects[b],q=h.geometry,t=h.materials,m="Line"===q.type,u="Points"===q.type,n=!1,0!==q.vertices.length){l=new module$src$externals$three.default.BufferGeometry;l.addAttribute("position",new module$src$externals$three.default.Float32BufferAttribute(q.vertices,
3));0<q.normals.length?l.addAttribute("normal",new module$src$externals$three.default.Float32BufferAttribute(q.normals,3)):l.computeVertexNormals();0<q.colors.length&&(n=!0,l.addAttribute("color",new module$src$externals$three.default.Float32BufferAttribute(q.colors,3)));0<q.uvs.length&&l.addAttribute("uv",new module$src$externals$three.default.Float32BufferAttribute(q.uvs,2));for(var v=[],x=0,w=t.length;x<w;x++){var y=t[x];q=void 0;if(null!==this.materials)if(q=this.materials.create(y.name),m&&q&&
!(q instanceof module$src$externals$three.default.LineBasicMaterial)){var z=new module$src$externals$three.default.LineBasicMaterial;z.copy(q);z.lights=!1;q=z}else if(u&&q&&!(q instanceof module$src$externals$three.default.PointsMaterial)){var B=new module$src$externals$three.default.PointsMaterial({size:10,sizeAttenuation:!1});z.copy(q);q=B}q||(q=m?new module$src$externals$three.default.LineBasicMaterial:u?new module$src$externals$three.default.PointsMaterial({size:1,sizeAttenuation:!1}):new module$src$externals$three.default.MeshPhongMaterial,
q.name=y.name);!1===q.flatShading&&(q.flatShading=y.smooth?!1:!0);q.vertexColors=n?module$src$externals$three.default.VertexColors:module$src$externals$three.default.NoColors;v.push(q)}if(1<v.length){x=0;for(w=t.length;x<w;x++)y=t[x],l.addGroup(y.groupStart,y.groupCount,x);q=m?new module$src$externals$three.default.LineSegments(l,v):u?new module$src$externals$three.default.Points(l,v):new module$src$externals$three.default.Mesh(l,v)}else q=m?new module$src$externals$three.default.LineSegments(l,v[0]):
u?new module$src$externals$three.default.Points(l,v[0]):new module$src$externals$three.default.Mesh(l,v[0]);q.name=h.name;e.add(q)}console.timeEnd("OBJLoader");return e}};return b}();var module$src$3d$loaders$DDSLoader={default:{}},THREE$$module$src$3d$loaders$DDSLoader=module$src$externals$three.default;module$src$externals$three.default.DDSLoader=function(a){module$src$externals$three.default.CompressedTextureLoader.call(this,a);this._parser=module$src$externals$three.default.DDSLoader.parse};module$src$externals$three.default.DDSLoader.prototype=Object.create(module$src$externals$three.default.CompressedTextureLoader.prototype);
module$src$externals$three.default.DDSLoader.prototype.constructor=module$src$externals$three.default.DDSLoader;
module$src$externals$three.default.DDSLoader.parse=function(a,b){function c(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function g(a,b,c,d){var e=c*d*4;a=new Uint8Array(a,b,e);e=new Uint8Array(e);for(var f=b=0,g=0;g<d;g++)for(var h=0;h<c;h++){var l=a[f];f++;var m=a[f];f++;var n=a[f];f++;var q=a[f];f++;e[b]=n;b++;e[b]=m;b++;e[b]=l;b++;e[b]=q;b++}return e}var d={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},f=c("DXT1"),p=c("DXT3"),e=c("DXT5"),
m=c("ETC1"),h=new Int32Array(a,0,31);if(542327876!==h[0])return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),d;if(!h[20]&4)return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),d;var r=h[21],q=!1;switch(r){case f:f=8;d.format=module$src$externals$three.default.RGB_S3TC_DXT1_Format;break;case p:f=16;d.format=module$src$externals$three.default.RGBA_S3TC_DXT3_Format;break;case e:f=16;d.format=module$src$externals$three.default.RGBA_S3TC_DXT5_Format;
break;case m:f=8;d.format=module$src$externals$three.default.RGB_ETC1_Format;break;default:if(32===h[22]&&h[23]&16711680&&h[24]&65280&&h[25]&255&&h[26]&4278190080)q=!0,f=64,d.format=module$src$externals$three.default.RGBAFormat;else return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",String.fromCharCode(r&255,r>>8&255,r>>16&255,r>>24&255)),d}d.mipmapCount=1;h[2]&131072&&!1!==b&&(d.mipmapCount=Math.max(1,h[7]));b=h[28];d.isCubemap=b&512?!0:!1;if(d.isCubemap&&!(b&1024&&b&2048&&b&
4096&&b&8192&&b&16384&&b&32768))return console.error("THREE.DDSLoader.parse: Incomplete cubemap faces"),d;d.width=h[4];d.height=h[3];h=h[1]+4;b=d.isCubemap?6:1;for(p=0;p<b;p++)for(e=d.width,m=d.height,r=0;r<d.mipmapCount;r++){if(q)var t=g(a,h,e,m),u=t.length;else u=Math.max(4,e)/4*Math.max(4,m)/4*f,t=new Uint8Array(a,h,u);d.mipmaps.push({data:t,width:e,height:m});h+=u;e=Math.max(e>>1,1);m=Math.max(m>>1,1)}return d};var module$src$shared$singletons$OBJLoader={},THREE$$module$src$shared$singletons$OBJLoader=module$src$externals$three.default,MaterialPropertiesStandard$$module$src$shared$singletons$OBJLoader=module$src$shared$materials$MaterialPropertiesStandard.default,OBJLoader$$module$src$shared$singletons$OBJLoader=function(){this.log=function(){};this.warn=function(){};this.error=function(){};module$src$externals$three.default.Loader.Handlers.add(/\.dds$/i,new module$src$externals$three.default.DDSLoader);
this.loadGeometry=function(a,b,c,g,d,f){var p=function(){var a=new module$src$externals$three.default.LoadingManager,f=new module$src$externals$three.default.MTLLoader(a);f.setCrossOrigin(!0);null!=c&&f.setPath(c);null!=g&&f.setTexturePath(g);var r=module$src$externals$three.default.DoubleSide;"front"===d?r=module$src$externals$three.default.FrontSide:"back"===d&&(r=module$src$externals$three.default.BackSide);var q={};q.wrap=module$src$externals$three.default.ClampToEdgeWrapping;q.side=r;f.setMaterialOptions(q);
return new Promise(function(){var c=null;a.onLoad=function(){return c.hasOwnProperty("materialsInfo")&&0<Object.keys(c.materialsInfo).length?e(c):e()};f.load(b,function(a){a.preload();c=a},function(){},function(){e()})})},e=function(b){return new Promise(function(d,e){var g=new module$src$externals$three.default.OBJLoader;null!=b&&g.setMaterials(b);null!=c&&g.setPath(c);g.load(a,function(a){Array.isArray(f)&&0!=f.length&&f.every(function(a){return a&&a.isMatrix4})||(f=[new module$src$externals$three.default.Matrix4]);
var c=[];a.traverse(function(a){if(null!=a.geometry){var d=!1;a.geometry instanceof module$src$externals$three.default.BufferGeometry?a.geometry.hasOwnProperty("attributes")&&a.geometry.attributes.hasOwnProperty("uv")&&(d=!0):a.geometry instanceof module$src$externals$three.default.Geometry&&0<a.geometry.faceVertexUvs.length&&(d=!0);var e=null;if(null!=b&&a.hasOwnProperty("material")){e=new module$src$shared$materials$MaterialPropertiesStandard.default;e.side=a.material.side;e.color=a.material.color;
e.opacity=a.material.opacity;e.transparent=a.material.transparent;a.material.hasOwnProperty("shininess")&&(e.metalness=Math.min(1,a.material.shininess),e.roughness=1-Math.min(1,a.material.shininess));if(null!=a.material.map){var g=a.material.map.clone();g.needsUpdate=!0;e.map=g}["alpha","normal","bump"].forEach(function(b){if(null!=a.material[b+"Map"]){var c=a.material[b+"Map"].clone();c.needsUpdate=!0;e[b+"Map"]=c}})}g=0;for(var h=$jscomp.makeIterator(f),m=h.next();!m.done;m=h.next())m={path:"transformation_"+
g,geometry:a.geometry,texCoord:d,initialMatrix:m.value,type:"mesh"},null!=e&&(m.material=e),c.push(m),++g}});d(c)},function(){},function(a){e(a)})})};return null!=b&&0<b.length?p:e()}};module$src$shared$singletons$OBJLoader.default=new OBJLoader$$module$src$shared$singletons$OBJLoader;var module$src$shared$singletons$THREELoader={},THREE$$module$src$shared$singletons$THREELoader=module$src$externals$three.default,THREELoader$$module$src$shared$singletons$THREELoader=function(){this.loadGeometry=function(a,b){var c=[];if(a.isMesh)var g="mesh";else if(a.isLineLoop)g="lineloop";else if(a.isLineSegments)g="linesegments";else if(a.isLine)g="line";else if(a.isPoints)g="points";else return Promise.reject(Error("Unsupported type of THREE.Object3D"));Array.isArray(b)&&0!=b.length&&b.every(function(a){return a&&
a.isMatrix4})||(b=[new module$src$externals$three.default.Matrix4]);var d=a.geometry;"Geometry"===a.geometry.type&&(d=(new module$src$externals$three.default.Geometry).copy(a.geometry));"BufferGeometry"===a.geometry.type&&(d=(new module$src$externals$three.default.BufferGeometry).copy(a.geometry));a=0;b=$jscomp.makeIterator(b);for(var f=b.next();!f.done;f=b.next())c.push({path:"transformation_"+a,geometry:d,texCoord:!1,initialMatrix:f.value,type:g}),++a;return Promise.resolve(c)}};
module$src$shared$singletons$THREELoader.default=new THREELoader$$module$src$shared$singletons$THREELoader;var module$src$shared$singletons$Tag3DLoader={default:{}},THREE$$module$src$shared$singletons$Tag3DLoader=module$src$externals$three.default,toTinyColor$$module$src$shared$singletons$Tag3DLoader=module$src$shared$util$toTinyColor.default,_font3d$$module$src$shared$singletons$Tag3DLoader=null;
module$src$shared$singletons$Tag3DLoader.default.load3DTags=function(a){return(new Promise(function(a){null==_font3d$$module$src$shared$singletons$Tag3DLoader?(new module$src$externals$three.default.FontLoader).load("https://viewer.shapediver.com/graphik_regular.typeface.json",function(b){_font3d$$module$src$shared$singletons$Tag3DLoader=b;a()}.bind(this)):a()})).then(function(){var b=[],c={},g;for(g in a){var d=a[g];d=d||{};d.size=d.size||1;d.text=d.text||"";for(var f={size:d.size,height:d.size/
10,font:_font3d$$module$src$shared$singletons$Tag3DLoader},p=d.text.split(/\r\n|\r|\n/g),e="tag3d_"+g,m=[],h=0;h<p.length;++h){var r=e+".line_"+h,q=new module$src$externals$three.default.TextBufferGeometry(p[h],f);r={path:r,geometry:q,texCoord:!1,type:"mesh"};"default"!=d.color&&(r.color=(0,module$src$shared$util$toTinyColor.default)(d.color));m.push(r)}f=new module$src$externals$three.default.Object3D;e=$jscomp.makeIterator(m);for(p=e.next();!p.done;p=e.next())f.add(new module$src$externals$three.default.Mesh(p.value.geometry,
new module$src$externals$three.default.MeshPhongMaterial));e=p=e=void 0;c.lineHeight=void 0;c.lineHeight=0;p=$jscomp.makeIterator(f.children);for(e=p.next();!e.done;e=p.next())e=e.value,e=(new module$src$externals$three.default.Box3).setFromObject(e),e=e.max.y-e.min.y,c.lineHeight=Math.max(c.lineHeight,e);c.lineHeight*=1.15;m.forEach(function(a){return function(b,c){b.geometry.translate(0,(-c-1)*a.lineHeight,0)}}(c));e=(new module$src$externals$three.default.Box3).setFromObject(f);p=e.max.x-e.min.x;
e=e.max.y-e.min.y;f=new module$src$externals$three.default.Vector3(0,0,0);switch(d.justification){case "TC":f.x=.5*-p;break;case "TR":f.x=-p;break;case "ML":f.y=.5*e;break;case "MC":f.x=.5*-p;f.y=.5*e;break;case "MR":f.x=-p;f.y=.5*e;break;case "BL":f.y=e;break;case "BC":f.x=.5*-p;f.y=e;break;case "BR":f.x=-p,f.y=e}e=$jscomp.makeIterator(m);for(p=e.next();!p.done;p=e.next())p.value.geometry.translate(f.x,f.y,f.z);if(d.location.hasOwnProperty("xAxis"))for(f=new module$src$externals$three.default.Matrix4,
f.set(d.location.xAxis.X,d.location.yAxis.X,d.location.normal.X,0,d.location.xAxis.Y,d.location.yAxis.Y,d.location.normal.Y,0,d.location.xAxis.Z,d.location.yAxis.Z,d.location.normal.Z,0,0,0,0,1),e=$jscomp.makeIterator(m),p=e.next();!p.done;p=e.next())p=p.value,p.geometry.applyMatrix(f),p.geometry.translate(d.location.origin.X,d.location.origin.Y,d.location.origin.Z);Array.prototype.push.apply(b,m);c={lineHeight:c.lineHeight}}return b})};var module$src$app$partials$ViewerAppSceneManager={},THREE$$module$src$app$partials$ViewerAppSceneManager=module$src$externals$three.default,toTinyColor$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$util$toTinyColor.default,messagingConstants$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$constants$MessagingConstants.default,MessagePrototype$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$messages$MessagePrototype.default,SubScene$$module$src$app$partials$ViewerAppSceneManager=
module$src$shared$scene$OutputVersion.default,GlobalUtils$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$util$GlobalUtils.default,GLBLoader$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$singletons$GLBLoader.default,OBJLoader$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$singletons$OBJLoader.default,THREELoader$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$singletons$THREELoader.default,Tag3DLoader$$module$src$app$partials$ViewerAppSceneManager=
module$src$shared$singletons$Tag3DLoader.default,MaterialParser$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$materials$MaterialParser.default;
module$src$app$partials$ViewerAppSceneManager.default=function(a){var b=this,c=a.sceneGeometryManager,g={},d={},f={},p=["canvas","threeObject","transformations"],e={},m={},h={},r={},q=Promise.resolve(),t={},u={},n={},l=["interactionGroup","interactionMode","duration","dragPlaneNormal","visible"],v=function(a,b,c){b=Error(b);b.scope=a;b.data=c;return Promise.reject(b)},x=function(a,b){var c;var d=function(a,b){return v("SceneManager._addOutputVersion",a,b)};var g=a.id;var l=h[g];var m=l.creatorId;
var n=b.id;var q=!1;if(f[m]&&f[m][n]&&(n=f[m][n],n.ov))for(c in q=!0,n=n.ov,n)"_json"===c?(b._json_scene=module$src$shared$util$GlobalUtils.default.deepCopy(b[c],p),module$src$shared$util$GlobalUtils.default.defaults(b._json_scene,n._json,!0)):"_json_scene"!==c&&(b[c]=n[c]);q||delete b._json_scene;if(!e[m][g].subScene.addOutputVersion(b))return d("could not add output version to subscene");++l.finishedOutputVersions;return l.finishedOutputVersions<l.totalOutputVersions?Promise.resolve(!0):y(a)},w=
function(a,e,f,h){var m=function(a,b){return v("SceneManager._publishSubScene",a,b)};var p=f.id;h=h||{};var u="boolean"===typeof h.forceUpdate||"string"===typeof h.forceUpdate?h.forceUpdate:!1;if(!b.hasSetting("defaultMaterial"))return m("no default material configured");var w=n[e+"."+p],A=t[e];return A&&A.serial>w?Promise.resolve(!1):q=A=q.then(function(){var n=null;return(new module$src$shared$materials$MaterialParser.default).fromJSONMaterialObject(b.getSetting("defaultMaterial")).then(function(a){n=
a},function(a){return m("could not create default material",a)}).then(function(){for(var q=a.outputIds,E=d.hasOwnProperty(e)?d[e]._subSceneObject:null,v=null!==E?E.outputIds:[],J=$jscomp.makeIterator(v),A=J.next();!A.done;A=J.next())A=A.value,-1===q.indexOf(A)&&(a.addOutputVersion(E.getOutputVersion(A)),q.push(A));J=[];var y={},x={},C={assets:{add:{},replace:{},remove:{}}};A={};for(var F=q.length-1;-1<F;A={compiledOutputVersion:A.compiledOutputVersion,options:A.options,options$272:A.options$272},
--F){var z=q[F],D=a.getOutputVersion(z),B=g.getJSONOutputVersion(z,e,!0);if(D.hasOwnProperty("geometry")){A.compiledOutputVersion=a.getCompiledOutputVersion(z,n);if(!A.compiledOutputVersion||!Array.isArray(A.compiledOutputVersion.geometry))return m("could not compile output version "+z);x[z]={};for(var I={},H=$jscomp.makeIterator(A.compiledOutputVersion.geometry),G=H.next();!G.done;I={g:I.g,o:I.o},G=H.next()){I.g=G.value;I.o=x[z];G=I.g.path.split(".");G=$jscomp.makeIterator(G);for(var M=G.next();!M.done;M=
G.next())M=M.value,I.o[M]=I.o[M]||{},I.o=I.o[M];["type","geometry","material","initialMatrix"].forEach(function(a){return function(b){a.g.hasOwnProperty(b)&&(a.o[b]=a.g[b])}}(I));I.o._isSDGeometry=!0}if(-1===v.indexOf(z)){A.options={};A.compiledOutputVersion.hasOwnProperty("name")&&(A.options.name=A.compiledOutputVersion.name);if(A.compiledOutputVersion.hasOwnProperty("bbmin")&&A.compiledOutputVersion.hasOwnProperty("bbmax"))try{var ba=new module$src$externals$three.default.Box3(module$src$shared$util$GlobalUtils.default.toVector3(A.compiledOutputVersion.bbmin),
module$src$shared$util$GlobalUtils.default.toVector3(A.compiledOutputVersion.bbmax));A.options.boundingBox=ba}catch(ca){b.debug("SceneManager._publishSubScene","invalid bounding box for output version "+z,ca)}l.forEach(function(a){return function(b){a.compiledOutputVersion.hasOwnProperty(b)&&(a.options[b]=a.compiledOutputVersion[b])}}(A));J.push(c.addGeometry(e+"."+z,A.compiledOutputVersion.geometry,A.options,D.version));C.assets.add[z]=B}else(I=!0===u||u===z)||(I=E.getOutputVersion(z).version!==
D.version),!I&&D.materialId&&(H=a.getOutputVersion(D.materialId),(G=E.getOutputVersion(D.materialId))&&H.version===G.version&&D.materialId!==u||(I=!0)),I&&(A.options$272={},l.forEach(function(a){return function(b){a.compiledOutputVersion.hasOwnProperty(b)&&(a.options$272[b]=a.compiledOutputVersion[b])}}(A)),"number"===typeof h.duration&&0<=h.duration&&(A.options$272.duration=h.duration),J.push(c.replaceGeometry(e+"."+z,A.compiledOutputVersion.geometry,A.options$272,D.version)),C.assets.replace[z]=
B)}else E&&(I=E.getOutputVersion(z))&&I.geometry&&(J.push(c.removeGeometry(e+"."+z)),C.assets.remove[z]=B);D.hasOwnProperty("data")&&(y[z]=D.data)}return Promise.all(J).then(function(){d[e]=x;d[e]._subSceneObject=a;r[e]=y;t[e]={serial:w,id:p};Object.keys(C.assets.add).forEach(function(a){C.assets.add[a]=g.getJSONOutputVersion(a,e,!0)});var c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_UPDATE,C,f);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_PUBLISHED,
c);0<Object.keys(y).length&&(c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.DATA,y,f),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.DATA,c));return C})})})},y=function(a){var f=function(a,b){return v("SceneManager._finishProcess",a,b)};var g=a.id;var l=h[g];var n=l.creatorId;m[n]=m[n]||{};m[n][g]=e[n][g];delete e[n][g];0===Object.keys(e[n]).length&&delete e[n];var q=m[n][g].subScene,
r=d[n]?d[n]._subSceneObject:null,p=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{state:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_READY,progress:.75},a);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,p);return w(q,n,a,l.options).then(function(a){delete m[n][g];0===Object.keys(m[n]).length&&delete m[n];return a},function(b){if(null!==
r)return w(r,n,a).then(function(){return f("publishing of subscene failed, restored previous state",b)});d.hasOwnProperty(n)&&delete d[n];return c.removeGeometry(n).then(function(){return f("publishing of subscene failed, restored previous state",b)})}).catch(function(a){return f("publishing of subscene failed",a)})},z=function(a,b){var c=function(a,b){return v("SceneManager._convertOutputVersion",a,b)};void 0===b&&(b=!1);a=a||{};if(!b){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a.version,
"string"))return c("version missing");if(!Array.isArray(a.content))return c("content array missing")}var d={id:a.id};["version","name"].concat($jscomp.arrayFromIterable(l)).forEach(function(b){void 0!==a[b]&&null!==a[b]&&(d[b]=a[b])});module$src$shared$util$GlobalUtils.default.typeCheck(a.material,"string")&&(d.materialId=a.material);module$src$shared$util$GlobalUtils.default.typeCheck(a.bbmin,"vector3any")&&(d.bbmin=module$src$shared$util$GlobalUtils.default.toVector3(a.bbmin));module$src$shared$util$GlobalUtils.default.typeCheck(a.bbmax,
"vector3any")&&(d.bbmax=module$src$shared$util$GlobalUtils.default.toVector3(a.bbmax));var e=(d.bbmin&&d.bbmax?d.bbmin.distanceTo(d.bbmax):1)/1E4,f=[],g=[];b=[];if(Array.isArray(a.content))for(var h=$jscomp.makeIterator(a.content),m=h.next();!m.done;m=h.next()){m=m.value;if(!module$src$shared$util$GlobalUtils.default.typeCheck(m.format,"string"))return c("format of content item missing");switch(m.format){case "material":if(!m.data)return c("data of material content item missing");m=module$src$shared$util$GlobalUtils.default.deepCopy(m.data,
p);f.push(m);break;case "glb":case "obj":case "tag2d":case "tag3d":case "anchor":case "three":g.push(module$src$shared$util$GlobalUtils.default.deepCopy(m,p));break;default:b.push(module$src$shared$util$GlobalUtils.default.deepCopy(m))}}h=[];f=$jscomp.makeIterator(f);for(m=f.next();!m.done;m=f.next()){m=m.value;var n=new module$src$shared$materials$MaterialParser.default;h.push(n.fromJSONMaterialObject(m))}f=[];m={};g=$jscomp.makeIterator(g);for(n=g.next();!n.done;m={gj:m.gj,anchorArray:m.anchorArray},
n=g.next()){m.gj=n.value;n=[];if(Array.isArray(m.gj.transformations))for(var q=$jscomp.makeIterator(m.gj.transformations),r=q.next();!r.done;r=q.next())if(r=r.value,r.isMatrix4)n.push(r.clone());else{var t=new module$src$externals$three.default.Matrix4;t.fromArray(r);n.push(t)}m.gj.hasOwnProperty("href")&&"glb"===m.gj.format?f.push(module$src$shared$singletons$GLBLoader.default.loadGeometry(m.gj.href,n,e)):"obj"===m.gj.format?m.gj.data&&m.gj.data.objUrl&&f.push(module$src$shared$singletons$OBJLoader.default.loadGeometry(m.gj.data.objUrl,
m.gj.data.mtlUrl,m.gj.data.path,m.gj.data.texturePath,m.gj.data.side,n)):"three"===m.gj.format?m.gj.data&&m.gj.data.threeObject&&f.push(module$src$shared$singletons$THREELoader.default.loadGeometry(m.gj.data.threeObject,n)):"tag3d"===m.gj.format&&m.gj.hasOwnProperty("data")&&Array.isArray(m.gj.data)?f.push(module$src$shared$singletons$Tag3DLoader.default.load3DTags(m.gj.data)):("tag2d"===m.gj.format||"anchor"===m.gj.format)&&m.gj.hasOwnProperty("data")&&Array.isArray(m.gj.data)&&(m.anchorArray=[],
m.gj.data.forEach(function(a){return function(b,c){if(b.location){var d=b.location;d=void 0!==d.x?new module$src$externals$three.default.Vector3(d.x,d.y,d.z):new module$src$externals$three.default.Vector3(d.X,d.Y,d.Z);a.anchorArray.push({path:"Anchor_"+c,type:"anchor",geometry:{position:d,viewports:b.viewports,format:"tag2d"===a.gj.format?a.gj.format:b.format,data:"tag2d"===a.gj.format?{color:b.color,text:b.text}:b.data}})}}}(m)),f.push(Promise.resolve(m.anchorArray)))}e=Promise.all(f).then(function(a){a.forEach(function(a,
b){a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next())c=c.value,c.path="content_"+b+"."+c.path});return a}).catch(function(a){return c("loading of geometry failed",a)});h=Promise.all(h).catch(function(a){return c("loading of material failed",a)});b=Promise.resolve(b);return Promise.all([e,h,b]).then(function(b){if(0<b[0].length){d.geometry=[];for(var c=$jscomp.makeIterator(b[0]),e=c.next();!e.done;e=c.next()){e=$jscomp.makeIterator(e.value);for(var f=e.next();!f.done;f=e.next())d.geometry.push(f.value)}}0<
b[1].length&&(d.material=b[1]);0<b[2].length&&(d.data=b[2]);d._json=a;return d})},B=function(a){for(var b in e)delete e[b][a],delete n[b+"."+a];delete h[a]};g.initSubScene=function(a,c,d,f){var g=function(a,c){c instanceof Error?a=c:(a=Error(a),a.scope="SceneManager.initSubScene",a.data=c);l&&(c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,a,d),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,
c));b.error(a.scope,a.message,a);return!1};if(!d||!d.id)return g("invalid token");var l=d.id;var m=d.serial?d.serial:Date.now();"number"!==typeof m&&(m=parseInt(m),isNaN(m)&&(m=Date.now()));if(u.hasOwnProperty(c)&&u[c].serial>m||t.hasOwnProperty(c)&&t[c].serial>m)return a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT,"Subscene obsolete because of newer request",d),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,
a),!1;if(h.hasOwnProperty(l))return g("attempt to register duplicate process "+l);u[c]={serial:m,id:l};n[c+"."+l]=m;h[l]={initTime:Date.now(),creatorId:c,processId:l,totalOutputVersions:a,finishedOutputVersions:0,options:f};e[c]=e[c]||{};e[c][l]={creatorId:c,processId:l,subScene:new module$src$shared$scene$OutputVersion.default};return!0};g.addJSONOutputVersionToSubScene=function(a,c,d){var e=function(a,c){c instanceof Error?a=c:(a=Error(a),a.scope="SceneManager.addJSONOutputVersionToSubScene",a.data=
c);f&&(c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,a,d),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,c),B(f));b.error(a.scope,a.message,a);return Promise.reject(a)};if(!d||!d.id)return e("invalid token");var f=d.id;return z(a).then(function(a){return g.addOutputVersionToSubScene(a,c,d)},function(a){return e("conversion of output version failed",a)})};g.addOutputVersionToSubScene=
function(a,c,d){var f=function(a,c,e){c instanceof Error?a=c:(a=e?{message:a}:Error(a),a.scope="SceneManager.addOutputVersionToSubScene",a.data=c);g&&(c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,a,d),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,c),B(g));if(e)return b.warn(a.scope,a.message,a),Promise.resolve(!1);b.error(a.scope,a.message,a);return Promise.reject(a)};
if(!a.id)return f("output version without id");if(!d||!d.id)return f("invalid token");var g=d.id;if(!h[g])return f("unknown process id "+g+", probably process was superseded",void 0,!0);var l=h[g];if(l.creatorId!==c)return f("unexpected creatorId");if(!e[c]||!e[c][g])return f("no partial subscene for creatorId/processId, probably process was superseded",void 0,!0);var m=u[c];return m?b.getSettingShallow("ignoreSuperseded")&&m.id!==g?(B(g),a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT,
"Subscene obsolete because of newer request",d),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,a),Promise.resolve(!1)):x(d,a).then(function(a){if(!1===a){var c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT,"Subscene superseded, not published",d);B(d.id)}else!0===a?c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,
{state:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_OUTPUTVERSION,progress:.25+l.finishedOutputVersions/l.totalOutputVersions*.5},d):(c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS,"Subscene published",d),c.addPart(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_UPDATE,a),B(d.id));b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,
c);return a},function(a){return f("adding output version failed",a)}):f("could not find latest serial for creator id "+c+", probably process was superseded",void 0,!0)};g.numberOfPartialSubScenes=function(){return Object.keys(e).length};g.numberOfCompleteSubScenes=function(){return Object.keys(m).length};g.getModelData=function(a){var b=[];a=a||{};var c=a.creatorId?[a.creatorId]:Object.keys(r);c=$jscomp.makeIterator(c);for(var d=c.next();!d.done;d=c.next())if(d=d.value,r.hasOwnProperty(d)){var e=
Object.keys(r[d]);e=$jscomp.makeIterator(e);for(var f=e.next();!f.done;f=e.next())if(f=f.value,null==a.id||f==a.id)for(var g=$jscomp.makeIterator(r[d][f]),h=g.next();!h.done;h=g.next())if(h=h.value,null==a.name||h.name==a.name)h=module$src$shared$util$GlobalUtils.default.deepCopy(h),delete h.format,h.plugin=d,h.id=f,b.push(h)}return b};g.getGeometryNames=function(a){var b={};(null==a?Object.keys(d):[a]).forEach(function(a){if(d.hasOwnProperty(a)&&d[a].hasOwnProperty("_subSceneObject")){b[a]={};for(var c=
$jscomp.makeIterator(d[a]._subSceneObject.outputNames),e=c.next();!e.done;e=c.next()){e=e.value;b[a][e]=[];var f=d[a]._subSceneObject.getOutputVersionIdByName(e);f=$jscomp.makeIterator(f);for(var g=f.next();!g.done;g=f.next()){g=g.value;var h=d[a]._subSceneObject.getOutputVersion(g);h&&h.hasOwnProperty("geometry")&&b[a][e].push(g)}}}});return b};g.getGeometryPathsByName=function(a,b){var c=[];(null==b?Object.keys(d):[b]).forEach(function(b){if(d.hasOwnProperty(b)&&d[b].hasOwnProperty("_subSceneObject")){var e=
d[b]._subSceneObject.getOutputVersionIdByName(a);e=$jscomp.makeIterator(e);for(var f=e.next();!f.done;f=e.next()){f=f.value;var g=d[b]._subSceneObject.getOutputVersion(f);g&&g.hasOwnProperty("geometry")&&c.push(b+"."+f)}}});return c};g.getJSONOutputVersion=function(a,b,c){if(!d.hasOwnProperty(b))return null;var e=d[b]._subSceneObject.getOutputVersion(a);if(!e)return null;var f="_json";if(!e.hasOwnProperty(f))return null;c&&e.hasOwnProperty("_json_scene")&&(f="_json_scene");e=module$src$shared$util$GlobalUtils.default.deepCopy(e[f],
p);e.scenePath=b+"."+a;return e};g.getOutputIds=function(a){return d.hasOwnProperty(a)?d[a]._subSceneObject.outputIds:[]};g.removeOutputIds=function(a,b){Array.isArray(b)||(b=[b]);var e=Promise.resolve();if(d[a]){var f=d[a],g={};b=$jscomp.makeIterator(b);for(var h=b.next();!h.done;g={id$275:g.id$275},h=b.next())g.id$275=h.value,f[g.id$275]&&(f._subSceneObject.removeOutputVersion(g.id$275),delete f[g.id$275],e=e.then(function(b){return function(){return c.removeGeometry(a+"."+b.id$275)}}(g)))}return e};
g.setPersistentAttributes=function(a,c,e){var h;var l=function(a,b){return v("SceneManager.setPersistentAttributes",a,b)};f[c]=f[c]||{};f[c][a]=f[c][a]||{};f[c][a].json=f[c][a].json||{};var m=-1;e.hasOwnProperty("duration")&&(m=e.duration,delete e.duration);var n=module$src$shared$util$GlobalUtils.default.deepCopy(f[c][a].json,p);e=module$src$shared$util$GlobalUtils.default.deepCopy(e,p);for(h in e)null===e[h]?delete n[h]:n[h]=e[h];n.id=a;return z(n,!0).then(function(e){f[c][a].json=n;f[c][a].ov=
e;if(!d.hasOwnProperty(c))return n;e=d[c]._subSceneObject.getOutputVersion(a);if(!e)return n;var h={id:module$src$shared$util$GlobalUtils.default.createRandomId(),serial:Date.now()};var q=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{busy:!1,progress:0,creator:"SceneManager.setPersistentAttributes"},h);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,q);q={forceUpdate:a};
0<=m&&(q.duration=m);return g.initSubScene(1,c,h,q)?g.addOutputVersionToSubScene(e,c,h).then(function(){return n}):l("ViewerApp.initSubScene failed")})};g.getPersistentAttributes=function(a,b){return f[b]&&f[b][a]?f[b][a].json:null};g.getCreatorIds=function(){return Object.keys(d)};return g};var module$src$app$handlers$ProcessStatusHandler={},GlobalUtils$$module$src$app$handlers$ProcessStatusHandler=module$src$shared$util$GlobalUtils.default,MessagePrototype$$module$src$app$handlers$ProcessStatusHandler=module$src$shared$messages$MessagePrototype.default,viewerAppConstants$$module$src$app$handlers$ProcessStatusHandler=module$src$app$ViewerAppConstants.default;
module$src$app$handlers$ProcessStatusHandler.default=function(a){var b=this;if(a&&a.viewportManager)var c=a.viewportManager;var g={},d={busy:!1,progress:1,processes:module$src$shared$util$GlobalUtils.default.deepCopy(g)},f={getSummary:function(){return module$src$shared$util$GlobalUtils.default.deepCopy(d)},updateViewerStatus:function(){var a=d.busy,e={busy:!1,progress:1,processes:module$src$shared$util$GlobalUtils.default.deepCopy(g)};for(h in g){var f=g[h];f.busy&&(e.busy=!0);void 0!==f.progress&&
"number"===typeof f.progress&&f.progress<e.progress&&0<=f.progress&&(e.progress=f.progress)}d=module$src$shared$util$GlobalUtils.default.deepCopy(e);if(d.busy){var h=new module$src$shared$messages$MessagePrototype.default(module$src$app$ViewerAppConstants.default.messageDataTypes.APP_STATUS,e);b.message(module$src$app$ViewerAppConstants.default.messageTopics.STATUS_BUSY,h);a||(b.debug("ProcessStatusHandler.updateViewerStatus","Entering busy mode, progress "+100*d.progress+"%",e),c&&b.getSettingShallow("blurSceneWhenBusy")&&
c.setBlur(d.busy,100))}else!d.busy&&a?(b.debug("ProcessStatusHandler.updateViewerStatus","Entering idle mode",e),a=new module$src$shared$messages$MessagePrototype.default(module$src$app$ViewerAppConstants.default.messageDataTypes.APP_STATUS,e),b.message(module$src$app$ViewerAppConstants.default.messageTopics.STATUS_IDLE,a),c&&b.getSettingShallow("blurSceneWhenBusy")&&c.setBlur(d.busy,100)):d.busy&&b.debug("ProcessStatusHandler.updateViewerStatus","Updating busy mode",e)},updateProcessStatus:function(a,
c){var d=a;d&&"object"===typeof d&&module$src$shared$util$GlobalUtils.default.typeCheck(a.id,"string")&&(d=a.id);if(!module$src$shared$util$GlobalUtils.default.typeCheck(d,"string"))return!1;c=c||{};if(g.hasOwnProperty(d))module$src$shared$util$GlobalUtils.default.inject(c,g[d],!0);else if(0===c.progress)g[d]={initTime:Date.now()},module$src$shared$util$GlobalUtils.default.inject(c,g[d],!0);else return b.debug("ProcessStatusHandler.updateProcessStatus","Ignoring status message for unknown process "+
d,c),!1;f.updateViewerStatus();return!0},forkProcessStatus:function(a,b){var c=a;c&&"object"===typeof c&&module$src$shared$util$GlobalUtils.default.typeCheck(a.id,"string")&&(c=a.id);if(!(module$src$shared$util$GlobalUtils.default.typeCheck(c,"string")&&g.hasOwnProperty(c)&&Array.isArray(b)&&b.every(function(a){return a.startsWith(c+".")})))return!1;var d=g[c];b.forEach(function(a){g[a]=module$src$shared$util$GlobalUtils.default.deepCopy(d)});delete g[c];return!0},unregisterProcess:function(a){var c=
a;c&&"object"===typeof c&&module$src$shared$util$GlobalUtils.default.typeCheck(a.id,"string")&&(c=a.id);if(!module$src$shared$util$GlobalUtils.default.typeCheck(c,"string"))return!1;if(!g.hasOwnProperty(c))return b.debug("ProcessStatusHandler.unregisterProcess","Unregistering unknown process "+c),!1;delete g[c];f.updateViewerStatus();return!0}};return f};var module$src$ar$ArApiInterface={default:function(){}};module$src$ar$ArApiInterface.default.prototype.hitTest=function(){};module$src$ar$ArApiInterface.default.prototype.registerAnchor=function(){};module$src$ar$ArApiInterface.default.prototype.removeAnchor=function(){};module$src$ar$ArApiInterface.default.prototype.pauseSession=function(){};module$src$ar$ArApiInterface.default.prototype.runSession=function(){};module$src$ar$ArApiInterface.default.prototype.getStatus=function(){};
module$src$ar$ArApiInterface.default.prototype.addEventListener=function(){};module$src$ar$ArApiInterface.default.prototype.removeEventListener=function(){};module$src$ar$ArApiInterface.default.prototype.EVENTTYPE={ANCHOR_CREATE_IMAGE:"anchor.create.image",ANCHOR_UPDATE:"anchor.update",STATUS_TRACKING:"status.tracking",STATUS_MAPPING:"status.mapping"};var module$src$ar$diagnostics$ArStatusType={default:function(a,b,c,g,d){this.framework=a;this.anchors=b;this.tracking=c;this.trackingReason=g;this.worldMapping=d}};var module$src$ar$ArSettingsHooks={},GLOBAL_UTILS$$module$src$ar$ArSettingsHooks=module$src$shared$util$GlobalUtils.default;
module$src$ar$ArSettingsHooks.default=function(a){var b=this;this._settings=a.settings;this._loggingHandler=a.loggingHandler;this._viewportManager=a.viewportManager;this._container=a.container;this.getDefaultHitTestTypeVal=this.getEnableAutomaticPlacementVal=this.getEnableTouchControlRotationVal=this.getEnableTouchControlsVal=this.getEnableLightingEstimationVal=this.getEnableCameraSyncVal=this.onSettingChange=null;a=this._settings.getSettings();var c=function(a,c){var d=b[a](c);if(b.onSettingChange&&
d)b.onSettingChange(a,c);return d};this.enableCameraSync(a.enableCameraSync);this._settings.registerHook("enableCameraSync",function(a){return c("enableCameraSync",a)});this.enableLightingEstimation(a.enableLightingEstimation);this._settings.registerHook("enableLightingEstimation",function(a){return c("enableLightingEstimation",a)});this.enableTouchControls(a.enableTouchControls);this._settings.registerHook("enableTouchControls",function(a){return c("enableTouchControls",a)});this.enableTouchControlRotation(a.enableTouchControlRotation);
this._settings.registerHook("enableTouchControlRotation",function(a){return c("enableTouchControlRotation",a)});this.enableAutomaticPlacement(a.enableAutomaticPlacement);this._settings.registerHook("enableAutomaticPlacement",function(a){return c("enableAutomaticPlacement",a)});this.defaultHitTestType(a.defaultHitTestType);this._settings.registerHook("defaultHitTestType",function(a){return c("defaultHitTestType",a)})};
module$src$ar$ArSettingsHooks.default.prototype.enableCameraSync=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",this._loggingHandler.warn,"ArHandler.Hook->enableCameraSync"))return!1;this.getEnableCameraSyncVal=a;return!0};
module$src$ar$ArSettingsHooks.default.prototype.enableLightingEstimation=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",this._loggingHandler.warn,"ArHandler.Hook->enableLightingEstimation"))return!1;this.getEnableLightingEstimationVal=a;return!0};
module$src$ar$ArSettingsHooks.default.prototype.enableTouchControls=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",this._loggingHandler.warn,"ArHandler.Hook->enableTouchControls"))return!1;this.getEnableTouchControlsVal=a;return!0};
module$src$ar$ArSettingsHooks.default.prototype.enableTouchControlRotation=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",this._loggingHandler.warn,"ArHandler.Hook->enableTouchControlRotation"))return!1;this.getEnableTouchControlRotationVal=a;return!0};
module$src$ar$ArSettingsHooks.default.prototype.enableAutomaticPlacement=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",this._loggingHandler.warn,"ArHandler.Hook->enableAutomaticPlacement"))return!1;this.getEnableAutomaticPlacementVal=a;return!0};
module$src$ar$ArSettingsHooks.default.prototype.defaultHitTestType=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string",this._loggingHandler.warn,"ArHandler.Hook->defaultHitTestType"))return!1;this.getDefaultHitTestTypeVal=a;return!0};var module$src$ar$ArEvent={default:function(a,b,c){this.type=a;this.api=b;c&&(c.image&&(this.image=c.image),c.anchors&&(this.anchors=c.anchors),c.tracking&&(this.tracking=c.tracking),c.trackingReason&&(this.trackingReason=c.trackingReason),c.worldMapping&&(this.worldMapping=c.worldMapping))}};var module$src$ar$utils$ArApi_utils={default:{}};
module$src$ar$utils$ArApi_utils.default.temp2rgb=function(a){var b=a/100;var c=[];6504>=a?(c[0]=255,c[1]=b,c[1]=99.4708025861*Math.log(c[1])-161.1195681661):(c[0]=b-60,c[0]=329.698727446*Math.pow(c[0],-.1332047592),0>c[0]&&(c[0]=0),255<c[0]&&(c[0]=255),c[1]=b-60,c[1]=288.1221695283*Math.pow(c[1],-.0755148492));0>c[1]&&(c[1]=0);255<c[1]&&(c[1]=255);6504<=a?c[2]=255:19>=b?c[2]=0:(c[2]=b-10,c[2]=138.5177312231*Math.log(c[2])-305.0447927307,0>c[2]&&(c[2]=0),255<c[2]&&(c[2]=255));return c};var module$src$ar$ArApiARKit={},THREE$$module$src$ar$ArApiARKit=module$src$externals$three.default,GLOBAL_UTILS$$module$src$ar$ArApiARKit=module$src$shared$util$GlobalUtils.default,ArApiFactory$$module$src$ar$ArApiARKit=function(a){var b=new module$src$ar$ArApiInterface.default,c={events:[],listen:function(a,b,c){this.events[a]||(this.events[a]=[]);this.events[a].push({token:b,cb:c})},raise:function(a,b){this.events[a]&&this.events[a].forEach(function(a){a.cb(b)})},remove:function(a){var b=a.split(":");
a=b[0];b=b[1];if(this.events[a])for(var c=0;c<this.events[a].length;c++)if(this.events[a][c].token==b){this.events[a].splice(c,1);break}}},g=a.viewportManager,d=Array.isArray(a.container)&&0<a.container.length?a.container[0]:a.container,f=a.apiResponse,p=a.sceneGeometryManager,e={},m=null,h=new module$src$externals$three.default.Matrix4,r=new module$src$externals$three.default.Matrix4,q=null,t=new module$src$ar$ArSettingsHooks.default({viewportManager:a.viewportManager,loggingHandler:a.loggingHandler,
settings:a.settings}),u=function(){return function(){q||(q=g.getFirstDefaultThreeDManagerApi());return q}}(),n=function(){var a;return function(){a||(a=u().camera);return a}}();a={};var l=new module$src$externals$three.default.Matrix4,v=new module$src$externals$three.default.Matrix4,x={};l.makeRotationAxis(new module$src$externals$three.default.Vector3(1,0,0),-.5*Math.PI);v.getInverse(l);window.SDVARKitBridge=a;var w=function(a){return a.includes("'")||a.includes('"')?JSON.parse(a):a.replace(/["'\[\]]/g,
"").split(",").map(function(a){return parseFloat(a)})};a.viewProjectionMatrixUpdate=function(a,b,c,d,e){z(c,d,e);"string"===typeof a&&(a=w(a));"string"===typeof b&&(b=w(b));h.identity();r.identity();h.fromArray(a);h.multiply(l);r.fromArray(b);t.getEnableCameraSyncVal&&n().updateMatrices(h,r);t.getEnableCameraSyncVal&&t.getEnableTouchControlsVal&&Q&&T(W[0],W[1])};a.lightingEstimateUpdate=function(){};var y=function(a){var b=new module$src$externals$three.default.Matrix4,c=a.plane;b.fromArray(a.transform);
b.multiply(l);b.premultiply(v);a.transform=b;c&&(a=new module$src$externals$three.default.Vector3,b=new module$src$externals$three.default.Vector3,a.fromArray(c.center),a.applyMatrix4(v),c.center=a,b.fromArray(c.extent),b.applyMatrix4(v),c.extent=b)};a.anchorTransformUpdate=function(a,b){m="string"===typeof a?JSON.parse(a):a;Object.keys(m).forEach(function(a){y(m[a])});A(m,b)};a.imageAnchorCreated=function(a){a="string"===typeof a?JSON.parse(a):a;y(a);D(a)};a.hitTestResponse=function(a,b){var c=x[a];
c&&(delete x[a],b?(a="string"===typeof b?JSON.parse(b):b,a.forEach(function(a){var b=new module$src$externals$three.default.Matrix4,c=new module$src$externals$three.default.Matrix4,d=a.anchor;b.fromArray(a.worldTransform);b.multiply(l);b.premultiply(v);a.worldTransform=b;c.fromArray(a.localTransform);c.multiply(l);c.premultiply(v);a.localTransform=c;d&&y(d)}),c.resolve(a)):c.resolve([]))};a.registerAnchorResponse=function(a,b){var c=x[a];c&&(delete x[a],c.resolve(b))};a.removeAnchorResponse=function(a,
b){var c=x[a];c&&(delete x[a],c.resolve(b))};a.pauseSessionResponse=function(a){var b=x[a];b&&(delete x[a],b.resolve())};a.runSessionResponse=function(a){var b=x[a];b&&(delete x[a],b.resolve())};var z=function(a,d,f){if(e.worldMappingStatus!==a){var g=new module$src$ar$ArEvent.default(b.EVENTTYPE.STATUS_MAPPING,this,{worldMapping:a,tracking:d,trackingReason:f});c.raise(b.EVENTTYPE.STATUS_MAPPING,g)}e.trackingStatus!==d&&(g=new module$src$ar$ArEvent.default(b.EVENTTYPE.STATUS_TRACKING,this,{worldMapping:a,
tracking:d,trackingReason:f}),c.raise(b.EVENTTYPE.STATUS_TRACKING,g));e.worldMappingStatus=a;e.trackingStatus=d;e.trackingStatusReason=f},B=new module$src$ar$ArEvent.default(b.EVENTTYPE.ANCHOR_UPDATE,this),A=function(a){if(t.getEnableCameraSyncVal&&t.getEnableAutomaticPlacementVal){if(!K){var d=Object.keys(a);0<d.length&&(K=d[0])}K&&a[K]&&p.setPluginTransformation("CommPlugin_1",[null,null,a[K].transform])}B.anchors=a;c.raise(b.EVENTTYPE.ANCHOR_UPDATE,B)},D=function(a){a=new module$src$ar$ArEvent.default(b.EVENTTYPE.ANCHOR_CREATE_IMAGE,
this,{image:a});c.raise(b.EVENTTYPE.ANCHOR_CREATE_IMAGE,a)},H=0;var G=window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.runSession?"arkit":"none";var E=function(a,b){return new Promise(function(c,d){if(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers[a]){var e="id"+H++;b=b||{};b.requestId=e;x[e]={resolve:c,reject:d};window.webkit.messageHandlers[a].postMessage(b)}else d("Handler "+a+" does not exist")})},J=function(a,b,c){if(0>a||1<a||0>b||1<b)return Promise.reject("Expects normalized screen coordinates");
"string"===typeof c?c=[c]:Array.isArray(c)||(c=[]);return E("hitTest",{screenX:a+"",screenY:b+"",types:c.join(";")})},F=function(a,b){if(!a||!a.isMatrix4)return Promise.reject("Provide a THREE.Matrix4");"string"!==typeof b&&(b="");var c=new module$src$externals$three.default.Matrix4;c.copy(a);c.multiply(v);c.premultiply(l);return E("registerAnchor",{transform:JSON.stringify(c.toArray(),null,0),name:b})},C=function(a){return"string"!==typeof a?Promise.reject("Anchor uuid must be a string"):E("removeAnchor",
{uuid:a})},I=0,M=0,N=0,Q="",W=[],R=new module$src$externals$three.default.Matrix4,O=new module$src$externals$three.default.Matrix4,K=!1,Z,X="",S,U,T=function(a,b,c){c=c||t.getDefaultHitTestTypeVal;return J(a,b,c).then(function(a){Array.isArray(a)&&0<a.length&&(p.setPluginTransformation("CommPlugin_1",[null,null,a[0].worldTransform]),K="x",Z=a[0].worldTransform)})},P=function(a){if(2>a.length)return[0,0];for(var b=[],c=0,d=a.length;c<d;c++)b.push(a.item(c));b.sort(function(a,b){return a.identifier<
b.identifier});return new module$src$externals$three.default.Vector2(b[1].screenX-b[0].screenX,b[1].screenY-b[0].screenY)},Y=function(a){a.preventDefault();if(2===a.touches.length)I=P(a.touches).angle();else if(!(1<a.touches.length)){a=a.changedTouches.item(0);var b=a.screenX/window.innerWidth,c=a.screenY/window.innerHeight;Q=a.identifier;W=[b,c];T(b,c)}},V=function(a){a.preventDefault();var b=a.changedTouches;a=a.touches;2===a.length&&(a=P(a),M=I-a.angle()+N,R.makeRotationZ(M),t.getEnableTouchControlRotationVal&&
p.setPluginTransformation("CommPlugin_1",[null,R]));a=0;for(var c=b.length;a<c;a++)if(b.item(a).identifier===Q){a=b.item(a);b=a.screenX/window.innerWidth;a=a.screenY/window.innerHeight;W=[b,a];T(b,a);break}},aa=function(a){a.preventDefault();a=a.changedTouches;N=M;for(var b=0,c=a.length;b<c;b++)if(a.item(b).identifier===Q){Q="";break}Q||C(X).then(function(){return F(Z).then(function(a){X=K=a})})};if(d){var L=!1;t.onSettingChange=function(a,b){"enableCameraSync"===a&&(b?(S&&U&&p.setPluginTransformation("CommPlugin_1",
[null,S,U]),g.registerForContinuousRendering("AR"),b&&u().updateSettingAsync("camera.enableOrbitControls",!b)):(a=p.getPluginTransformation("CommPlugin_1"),Array.isArray(a)&&3<=a.length&&(S=a[1],U=a[2]),p.setPluginTransformation("CommPlugin_1",[null,O,O]),g.unregisterForContinuousRendering("AR")));t.getEnableCameraSyncVal&&t.getEnableTouchControlsVal&&!L?(d.addEventListener("touchstart",Y,!1),d.addEventListener("touchmove",V,!1),d.addEventListener("touchend",aa,!1),d.addEventListener("touchcancel",
aa,!1),L=!0):(d.removeEventListener("touchstart",Y,!1),d.removeEventListener("touchmove",V,!1),d.removeEventListener("touchend",aa,!1),d.removeEventListener("touchcancel",aa,!1),L=!1)};setTimeout(function(){if(u())t.onSettingChange("enableCameraSync",t.getEnableCameraSyncVal)},0)}a=function(){module$src$ar$ArApiInterface.default.call(this)};$jscomp.inherits(a,module$src$ar$ArApiInterface.default);a.prototype.hitTest=function(a,b,c){return J(a,b,c)};a.prototype.registerAnchor=function(a,b){return F(a,
b)};a.prototype.removeAnchor=function(a){return C(a)};a.prototype.pauseSession=function(){return E("pauseSession")};a.prototype.runSession=function(a,b){"string"===typeof a?a=[a]:Array.isArray(a)||(a=[]);"string"===typeof b?b=[b]:Array.isArray(b)||(b=[]);return E("runSession",{planeDetection:a.join(";"),options:b.join(";")})};a.prototype.getStatus=function(){return f(null,new module$src$ar$diagnostics$ArStatusType.default(G,m,e.trackingStatus,e.trackingStatusReason,e.worldMappingStatus))};a.prototype.addEventListener=
function(a,d){if(!Object.keys(b.EVENTTYPE).find(function(c){return b.EVENTTYPE[c]===a}))return f("Unsupported event type");var e=module$src$shared$util$GlobalUtils.default.createRandomId();c.listen(a,e,d);return f(null,{token:a+":"+e})};a.prototype.removeEventListener=function(a){return f(null,c.remove(a))};return new a},_ArApiInstance$$module$src$ar$ArApiARKit;
module$src$ar$ArApiARKit.default=function(a){_ArApiInstance$$module$src$ar$ArApiARKit||(_ArApiInstance$$module$src$ar$ArApiARKit=ArApiFactory$$module$src$ar$ArApiARKit(a));return _ArApiInstance$$module$src$ar$ArApiARKit};var module$src$api$v2$ApiResponse={},GLOBALUTILS$$module$src$api$v2$ApiResponse=module$src$shared$util$GlobalUtils.default;
module$src$api$v2$ApiResponse.default=function(a,b,c){var g={};void 0!==a&&null!==a&&(module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")?g.err=Error(a):a instanceof Error?g.err=a:a.hasOwnProperty("m")?(g.err=Error(a.m),a.hasOwnProperty("d")&&(g.err.data=Error(a.d))):(g.err=Error(),g.err.data=a));void 0!==b&&null!==b&&(g.data=b);void 0!==c&&null!==c&&(g.payload=c);return g};var module$src$api$v2$ApiInterfaceV2_1={},ARAPIINTERFACE$$module$src$api$v2$ApiInterfaceV2_1=module$src$ar$ArApiInterface.default,ApiParameterInterface$$module$src$api$v2$ApiInterfaceV2_1=function(){this.EVENTTYPE={REGISTERED:"registered",UPDATE:"update",VALUE_UPDATE:"value.update"};this.RESULT={PARAM_NOT_FOUND:"param_not_found",NO_VALUE:"no_value",VALUE_REJECT:"value_reject",VALUE_EXISTS:"value_exists",VALUE_OK:"value_ok",PLUGIN_NOT_FOUND:"plugin_not_found",ERROR:"error",LIVE:"live",CACHE:"cache",
LOAD:"load",ABORT:"abort"};this.TYPE={FLOAT:"Float",INT:"Int",EVEN:"Even",ODD:"Odd",STRING:"String",COLOR:"Color",STRINGLIST:"StringList",BOOL:"Bool",TIME:"Time",FILE:"File"};this.VISUALIZATION={SLIDER:"slider",SEQUENCE:"sequence",CYCLE:"cycle",DROPDOWN:"dropdown",CHECKLIST:"checklist",CLOCK:"clock",CALENDAR:"calendar"};this.get=function(){};this.updateAsync=function(){};this.canGoBackInHistory=function(){};this.canGoForwardInHistory=function(){};this.goBackInHistoryAsync=function(){};this.goForwardInHistoryAsync=
function(){};this.updateProperties=function(){};this.addEventListener=function(){};this.removeEventListener=function(){}},ApiExportInterface$$module$src$api$v2$ApiInterfaceV2_1=function(){this.RESULT={EXPORT_NOT_FOUND:"export_not_found",PLUGIN_NOT_FOUND:"plugin_not_found",ERROR:"error",CACHE:"cache",LOAD:"load"};this.EVENTTYPE={AVAILABLE:"available",REGISTERED:"registered",UPDATE:"update",STATUS:"status"};this.get=function(){};this.requestAsync=function(){};this.updateProperties=function(){};this.addEventListener=
function(){};this.removeEventListener=function(){}},ApiPluginInterface$$module$src$api$v2$ApiInterfaceV2_1=function(){this.STATUS={NONE:"none",READY:"ready",FAILED:"failed",LOADED:"loaded",ACTIVE:"active",UNLOADED:"unloaded"};this.get=function(){};this.registerPluginAsync=function(){};this.registerCommPluginAsync=function(){};this.refreshPluginAsync=function(){};this.saveDefaultParameterValuesAsync=function(){};this.deregisterPluginAsync=function(){}},ApiStateInterface$$module$src$api$v2$ApiInterfaceV2_1=
function(){this.EVENTTYPE={BUSY:"busy",IDLE:"idle",MESSAGE:"message",FAILED:"failed"};this.get=function(){};this.setBusy=function(){};this.addEventListener=function(){};this.removeEventListener=function(){}},ApiViewportsInterface$$module$src$api$v2$ApiInterfaceV2_1=function(){this.TYPE={DEFAULT:"default"};this.EVENTTYPE={DESTROYED:"destroyed"};this.get=function(){};this.create=function(){};this.destroy=function(){}},ApiSceneInterface$$module$src$api$v2$ApiInterfaceV2_1=function(){this.FORMAT={GLB:"glb",
OBJ:"obj",THREE:"three",DATA:"data",MATERIAL:"material",TAG2D:"tag2d",TAG3D:"tag3d",ANCHOR:"anchor"};this.EVENTTYPE={ANCHOR_ADD:"anchor.add",ANCHOR_REMOVE:"anchor.remove",DRAG_START:"drag.start",DRAG_MOVE:"drag.move",DRAG_END:"drag.end",HOVER_ON:"hover.on",HOVER_OVER:"hover.over",HOVER_OFF:"hover.off",RENDER_BEAUTY_START:"render.beauty.start",RENDER_BEAUTY_CANCEL:"render.beauty.cancel",RENDER_BEAUTY_END:"render.beauty.end",SELECT_ON:"select.on",SELECT_OFF:"select.off",SUBSCENE_PUBLISHED:"subscene.published",
VISIBILITY_ON:"visibility.on",VISIBILITY_OFF:"visibility.off"};this.MATERIALTYPE={STANDARD:"standard",GEM:"gem"};this.INTERACTIONMODETYPE={GLOBAL:"global",SUB:"sub"};this.SELECTIONMODETYPE={SINGLE:"single",MULTIPLE:"multiple"};this.TRANSFORMATIONTYPE={PLUGIN:"plugin",VIEWPORT:"viewport"};this.LIVETRANSFORMATIONTYPE={ROTATION:"rotation",TRANSLATION:"translation",SCALING:"scaling"};this.updateAsync=function(){};this.get=function(){};this.getData=function(){};this.convertTo2D=function(){};this.getBoundingBox=
function(){};this.setTransformation=function(){};this.getTransformation=function(){};this.applyTransformation=function(){};this.resetTransformation=function(){};this.setLiveTransformation=function(){};this.getScreenshot=function(){};this.updateSelected=function(){};this.getSelected=function(){};this.removeAsync=function(){};this.render=function(){};this.pause=function(){};this.resume=function(){};this.updatePersistentAsync=function(){};this.getPersistent=function(){};this.updateInteractionGroups=
function(){};this.getInteractionGroups=function(){};this.addEventListener=function(){};this.removeEventListener=function(){};this.toggleGeometry=function(){}};
module$src$api$v2$ApiInterfaceV2_1.default=function(){this.EVENTTYPE={SETTINGS_UPDATE:"settings.update",SETTINGS_REGISTERED:"settings.registered"};this.state=new ApiStateInterface$$module$src$api$v2$ApiInterfaceV2_1;this.parameters=new ApiParameterInterface$$module$src$api$v2$ApiInterfaceV2_1;this.exports=new ApiExportInterface$$module$src$api$v2$ApiInterfaceV2_1;this.plugins=new ApiPluginInterface$$module$src$api$v2$ApiInterfaceV2_1;this.viewports=new ApiViewportsInterface$$module$src$api$v2$ApiInterfaceV2_1;
this.scene=new ApiSceneInterface$$module$src$api$v2$ApiInterfaceV2_1;this.ar=new module$src$ar$ArApiInterface.default;this.addEventListener=function(){};this.removeEventListener=function(){};this.getSettingDefinitions=function(){};this.getSettings=function(){};this.getSetting=function(){};this.updateSettingAsync=function(){};this.updateSettingsAsync=function(){};this.saveSettingsAsync=function(){};this.createAsynchronousFunctions=function(){};this.getRuntimeId=function(){}};
module$src$api$v2$ApiInterfaceV2_1.default.utils={};module$src$api$v2$ApiInterfaceV2_1.default.utils.APIResponse={};var module$src$api$v2$ApiImplementationV2_1={},COMM_PLUGIN$$module$src$api$v2$ApiImplementationV2_1=module$src$plugins$comm$CommPlugin.default,ARAPIARKIT$$module$src$api$v2$ApiImplementationV2_1=module$src$ar$ArApiARKit.default,messagingConstants$$module$src$api$v2$ApiImplementationV2_1=module$src$shared$constants$MessagingConstants.default,pluginConstantsGlobal$$module$src$api$v2$ApiImplementationV2_1=module$src$shared$constants$PluginConstantsGlobal.default,GlobalUtils$$module$src$api$v2$ApiImplementationV2_1=
module$src$shared$util$GlobalUtils.default,MessagePrototype$$module$src$api$v2$ApiImplementationV2_1=module$src$shared$messages$MessagePrototype.default,ApiInterfaceV2$$module$src$api$v2$ApiImplementationV2_1=new module$src$api$v2$ApiInterfaceV2_1.default,TWEEN$$module$src$api$v2$ApiImplementationV2_1=module$node_modules$$tweenjs$tween_js$src$Tween.default,APIResponse$$module$src$api$v2$ApiImplementationV2_1=module$src$api$v2$ApiResponse.default,StateApi$$module$src$api$v2$ApiImplementationV2_1=function(a,
b){var c=this;this.EVENTTYPE=ApiInterfaceV2$$module$src$api$v2$ApiImplementationV2_1.state.EVENTTYPE;var g=b.messagingHandler,d=b.processStatusHandler;this.get=function(){var a=d.getSummary();a.failedStatusMessages=g.getFailedStatusMessages();return(0,module$src$api$v2$ApiResponse.default)(null,a)};this.setBusy=function(b,c){var e={};if(c){if("number"!==typeof c||0>c||1<c)return(0,module$src$api$v2$ApiResponse.default)("progess must be a number between 0 and 1",d.getSummary());e.progress=c}b?(e.busy=
!0,d.updateProcessStatus(a.getRuntimeId(),e)):d.unregisterProcess(a.getRuntimeId());return this.get()};this.addEventListener=function(b,d){if(!Object.keys(c.EVENTTYPE).find(function(a){return c.EVENTTYPE[a]===b}))return(0,module$src$api$v2$ApiResponse.default)("Unsupported event type");var e=a.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS+"."+b,function(a,c){a=new CustomEvent(b);a.api=c.api;c.token&&(a.token=c.token);var e={};e[module$src$shared$constants$MessagingConstants.default.messageDataTypes.APP_STATUS]=
{progress:1};e[module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE]=null;for(var f in e){var g=c.getUniquePartByType(f);if(g){g.data&&(g=g.data);var h=e[f]?e[f]:g,m;for(m in h)a[m]=g[m]}}d(a)});return(0,module$src$api$v2$ApiResponse.default)(null,e)};this.removeEventListener=function(b){return(0,module$src$api$v2$ApiResponse.default)(null,a.unsubscribeFromMessageStream(b))}},SceneApi$$module$src$api$v2$ApiImplementationV2_1=function(a,b){var c=this;this.FORMAT=ApiInterfaceV2$$module$src$api$v2$ApiImplementationV2_1.scene.FORMAT;
this.EVENTTYPE=ApiInterfaceV2$$module$src$api$v2$ApiImplementationV2_1.scene.EVENTTYPE;this.INTERACTIONMODETYPE=ApiInterfaceV2$$module$src$api$v2$ApiImplementationV2_1.scene.INTERACTIONMODETYPE;this.SELECTIONMODETYPE=ApiInterfaceV2$$module$src$api$v2$ApiImplementationV2_1.scene.SELECTIONMODETYPE;this.TRANSFORMATIONTYPE=ApiInterfaceV2$$module$src$api$v2$ApiImplementationV2_1.scene.TRANSFORMATIONTYPE;this.LIVETRANSFORMATIONTYPE=ApiInterfaceV2$$module$src$api$v2$ApiImplementationV2_1.scene.LIVETRANSFORMATIONTYPE;
var g=b.sceneManager,d=b.viewportManager,f=b.sceneGeometryManager,p=b.interactionGroupManager,e=b.messagingHandler;b=d.getFirstDefaultThreeDManagerApi();c.lights=b?b.lights:null;c.camera=b?b.camera:null;this.updateAsync=function(b,d,f){Array.isArray(b)||(b=[b]);var h=d||a.getRuntimeId(),m=[],r=[];b=$jscomp.makeIterator(b);for(d=b.next();!d.done;d=b.next()){var n=d.value;if(!n||!n.id)return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Asset without id property",null,f));r.push(n.id);
d=module$src$shared$util$GlobalUtils.default.deepCopy(n,["canvas","threeObject","transformations"]);if(n=g.getJSONOutputVersion(n.id,h,!1)){var l=Object.keys(n);l=$jscomp.makeIterator(l);for(var p=l.next();!p.done;p=l.next())p=p.value,d.hasOwnProperty(p)||"version"===p||(d[p]=n[p])}d.hasOwnProperty("version")||(d.version=module$src$shared$util$GlobalUtils.default.createRandomId());m.push(d)}var x=module$src$shared$constants$MessagingConstants.default.makeMessageToken();x.payload=f;return(new Promise(function(a,
b){var d=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{busy:!1,progress:0},x);e.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,d);if(g.initSubScene(m.length,h,x)){d=[];for(var f=$jscomp.makeIterator(m),l=f.next();!l.done;l=f.next())d.push(g.addJSONOutputVersionToSubScene(l.value,h,x));return Promise.all(d).then(function(){for(var d=[],e={},f=$jscomp.makeIterator(r),
l=f.next();!l.done;e={asset$283:e.asset$283},l=f.next())e.asset$283=g.getJSONOutputVersion(l.value,h,!0),e.asset$283&&(e.asset$283.addEventListener=function(a){return function(b,d){if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,"string")||0>=b.length)return(0,module$src$api$v2$ApiResponse.default)("Event type must be a string");var e=b;b.endsWith(a.asset$283.scenePath)||(e=b+"."+a.asset$283.scenePath);return c.addEventListener(e,d)}}(e),d.push(e.asset$283));d.length==r.length?a(d):b("Failed to publish all assets, unknown error.")},
function(a){b(a)})}b(Error("Could not initialize subscene."))})).then(function(a){return(0,module$src$api$v2$ApiResponse.default)(null,a,f)},function(a){return Promise.resolve((0,module$src$api$v2$ApiResponse.default)(a,null,f))})};this.get=function(b,c,d){b=b||{};"object"!==typeof b&&(b={});var e=[];e=module$src$shared$util$GlobalUtils.default.typeCheck(c,"string")?[c]:[a.getRuntimeId()];c=[];e=$jscomp.makeIterator(e);for(var f=e.next();!f.done;f=e.next()){f=f.value;var h=b.hasOwnProperty("id")?
[b.id]:g.getOutputIds(f);h=$jscomp.makeIterator(h);for(var m=h.next();!m.done;m=h.next()){m=g.getJSONOutputVersion(m.value,f,d);if(null===m)return(0,module$src$api$v2$ApiResponse.default)(void 0,[]);c.push(m)}}e=Object.keys(b);d={};e=$jscomp.makeIterator(e);for(f=e.next();!f.done;d={f:d.f},f=e.next())d.f=f.value,c=c.filter(function(a){return function(c){return c[a.f]===b[a.f]}}(d));return(0,module$src$api$v2$ApiResponse.default)(null,c)};this.getData=function(a,b){a=module$src$shared$util$GlobalUtils.default.deepCopy(a);
module$src$shared$util$GlobalUtils.default.typeCheck(b,"string")&&(a.plugin=b);b=g.getModelData(a);return(0,module$src$api$v2$ApiResponse.default)(null,b)};this.convertTo2D=function(b){if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,"vector3obj"))return null;for(var c=[],d=a.viewports.get(),e=0,f=d.length;e<f;e++)c.push(d[e].convertTo2D(b));return(0,module$src$api$v2$ApiResponse.default)(null,c)};this.getBoundingBox=function(a){return!module$src$shared$util$GlobalUtils.default.typeCheck(a,
"string")||0>=a.length?(0,module$src$api$v2$ApiResponse.default)("Path must be a string."):(a=f.getBoundingBox(a))?(0,module$src$api$v2$ApiResponse.default)(null,a):(0,module$src$api$v2$ApiResponse.default)("No Object was found at this path.")};this.setTransformation=function(b,c,e){if(!Array.isArray(e[0])&&null!==e[0]||e.isMatrix4){if(!module$src$shared$util$GlobalUtils.default.typeCheck(e,"matrix4x4arr")&&!e.isMatrix4)return(0,module$src$api$v2$ApiResponse.default)("The provided matrix is not valid.")}else for(var g=
0,h=e.length;g<h;g++)if(null!==e[g]&&!module$src$shared$util$GlobalUtils.default.typeCheck(e[g],"matrix4x4arr")&&!e[g].isMatrix4)return(0,module$src$api$v2$ApiResponse.default)("At least one provided matrix is not valid.");if(b===this.TRANSFORMATIONTYPE.PLUGIN){b=a.plugins.get().data;if(c){g=!1;var m=0;for(h=b.length;m<h;m++)b[m].id===c&&(f.setPluginTransformation(c,e),g=!0);if(!g)return(0,module$src$api$v2$ApiResponse.default)("Plugin with id "+c+" does not exist.")}else for(c=0,h=b.length;c<h;c++)f.setPluginTransformation(b[c].id,
e);d.updateShadowMap();d.render()}else if(b===this.TRANSFORMATIONTYPE.VIEWPORT)if(c){h=a.viewports.get(c);if(!h)return(0,module$src$api$v2$ApiResponse.default)("Viewport with id "+c+" does not exist.");h.setTransformation(e)}else for(c=a.viewports.get(),b=0,h=c.length;b<h;b++)c[b].setTransformation(e);else return(0,module$src$api$v2$ApiResponse.default)('Invalid transformation type. Types: "plugin", "viewport"');return(0,module$src$api$v2$ApiResponse.default)(null,!0)};this.getTransformation=function(b,
c){if(b===this.TRANSFORMATIONTYPE.PLUGIN){var d=a.plugins.get().data;if(c){var e=0;for(b=d.length;e<b;e++)if(d[e].id===c){b=f.getPluginTransformation(c);d=[];e=0;for(c=b.length;e<c;e++)d[e]=b[e].transpose().elements;return(0,module$src$api$v2$ApiResponse.default)(null,1===d.length?d[0]:d)}return(0,module$src$api$v2$ApiResponse.default)("Plugin with id "+c+" does not exist.")}if(1==d.length){b=f.getPluginTransformation(d[0].id);d=[];e=0;for(c=b.length;e<c;e++)d[e]=b[e].transpose().elements;return(0,module$src$api$v2$ApiResponse.default)(null,
1===d.length?d[0]:d)}e=0;for(b=d.length;e<b;e++){var g=f.getPluginTransformation(d[e].id),h=0;for(c=g.length;h<c;h++)g[h].transpose()}return(0,module$src$api$v2$ApiResponse.default)(null,void 0)}if(b===this.TRANSFORMATIONTYPE.VIEWPORT){if(c){b=a.viewports.get(c);if(!b)return(0,module$src$api$v2$ApiResponse.default)("Viewport with id "+c+" does not exist.");b=b.getTransformation();d=[];e=0;for(c=b.length;e<c;e++)d[e]=b[e].transpose().elements;return(0,module$src$api$v2$ApiResponse.default)(null,1===
d.length?d[0]:d)}d=a.viewports.get();if(1==d.length){b=d[0].getTransformation();d=[];e=0;for(c=b.length;e<c;e++)d[e]=b[e].transpose().elements;return(0,module$src$api$v2$ApiResponse.default)(null,1===d.length?d[0]:d)}e=0;for(b=d.length;e<b;e++){g=d[e].getTransformation();h=[];var m=0;for(c=g.length;m<c;m++)h[m]=g[m].transpose().elements;(void 0)[d[e].getRuntimeId()]=1===h.length?h[0]:h}return(0,module$src$api$v2$ApiResponse.default)(null,void 0)}return(0,module$src$api$v2$ApiResponse.default)('Invalid transformation type. Types: "plugin", "viewport"')};
this.applyTransformation=function(b,c,e){if(!Array.isArray(e[0])&&null!==e[0]||e.isMatrix4){if(!module$src$shared$util$GlobalUtils.default.typeCheck(e,"matrix4x4arr")&&!e.isMatrix4)return(0,module$src$api$v2$ApiResponse.default)("The provided matrix is not valid.")}else for(var g=0,h=e.length;g<h;g++)if(null!==e[g]&&!module$src$shared$util$GlobalUtils.default.typeCheck(e[g],"matrix4x4arr")&&!e[g].isMatrix4)return(0,module$src$api$v2$ApiResponse.default)("At least one provided matrix is not valid.");
if(b===this.TRANSFORMATIONTYPE.PLUGIN){b=a.plugins.get().data;if(c){g=!1;var m=0;for(h=b.length;m<h;m++)b[m].id===c&&(f.applyPluginTransformation(c,e),g=!0);if(!g)return(0,module$src$api$v2$ApiResponse.default)("Plugin with id "+c+" does not exist.")}else for(c=0,h=b.length;c<h;c++)f.applyPluginTransformation(b[c].id,e);d.updateShadowMap();d.render()}else if(b===this.TRANSFORMATIONTYPE.VIEWPORT)if(c){h=a.viewports.get(c);if(!h)return(0,module$src$api$v2$ApiResponse.default)("Viewport with id "+c+
" does not exist.");h.applyTransformation(e)}else for(c=a.viewports.get(),b=0,h=c.length;b<h;b++)c[b].applyTransformation(e);else return(0,module$src$api$v2$ApiResponse.default)('Invalid transformation type. Types: "plugin", "viewport"');return(0,module$src$api$v2$ApiResponse.default)(null,!0)};this.resetTransformation=function(b,c){if(b===this.TRANSFORMATIONTYPE.PLUGIN){var e=a.plugins.get().data;if(c){var g=!1,h=0;for(b=e.length;h<b;h++)e[h].id===c&&(f.resetPluginTransformation(c),g=!0);if(!g)return(0,module$src$api$v2$ApiResponse.default)("Plugin with id "+
c+" does not exist.")}else for(c=0,b=e.length;c<b;c++)f.resetPluginTransformation(e[c].id);d.updateShadowMap();d.render()}else if(b===this.TRANSFORMATIONTYPE.VIEWPORT)if(c){b=a.viewports.get(c);if(!b)return(0,module$src$api$v2$ApiResponse.default)("Viewport with id "+c+" does not exist.");b.resetTransformation()}else for(c=a.viewports.get(),e=0,b=c.length;e<b;e++)c[e].resetTransformation();else return(0,module$src$api$v2$ApiResponse.default)('Invalid transformation type. Types: "plugin", "viewport"');
return(0,module$src$api$v2$ApiResponse.default)(null,!0)};this.setLiveTransformation=function(b,d,e){if(d&&!module$src$shared$util$GlobalUtils.default.typeCheck(d,"string")&&!Array.isArray(d))return(0,module$src$api$v2$ApiResponse.default)("The provided viewports is not of type array or string, but also not null.");module$src$shared$util$GlobalUtils.default.typeCheck(d,"string")&&!Array.isArray(d)&&(d=[d]);var g=[];if(d){for(var h=0,m=d.length;h<m;h++)g.push(a.viewports.get(d[h]));if(0===g.length)return(0,module$src$api$v2$ApiResponse.default)("No viewports with the provided runtimeIds were found.")}else if(g=
a.viewports.get(),0===g.length)return(0,module$src$api$v2$ApiResponse.default)("No viewports are created at this point.");if(e&&!module$src$shared$util$GlobalUtils.default.typeCheck(e,"notnegative"))return(0,module$src$api$v2$ApiResponse.default)("The provided duration is not a valid number.");e||(e=Infinity);b=Array.isArray(b)?b:[b];if(0===b.length)return(0,module$src$api$v2$ApiResponse.default)("No live transformations were provided.");d=0;for(m=b.length;d<m;d++){h=b[d];if(!h.scenePaths)return(0,module$src$api$v2$ApiResponse.default)("No scene paths provided.");
Array.isArray(h.scenePaths)||(h.scenePaths=[h.scenePaths]);for(var n=0,l=h.scenePaths.length;n<l;n++){var p=h.scenePaths[n];if(!module$src$shared$util$GlobalUtils.default.typeCheck(p,"string"))return(0,module$src$api$v2$ApiResponse.default)("One of the provided scenePaths of a live transformation is not of valid type.");if(!f.getBoundingBox(p))return(0,module$src$api$v2$ApiResponse.default)("One of the provided scenePaths is not a valid path.")}if(!h.transformations)return(0,module$src$api$v2$ApiResponse.default)("No live transformations provided.");
Array.isArray(h.transformations)||(h.transformations=[b]);if(0===h.transformations.length)return(0,module$src$api$v2$ApiResponse.default)("One of the provided live transformations does not have any transformations.");n=0;for(l=h.transformations.length;n<l;n++){p=h.transformations[n];if(!module$src$shared$util$GlobalUtils.default.typeCheck(p.type,"string")||p.type!==c.LIVETRANSFORMATIONTYPE.ROTATION&&p.type!==c.LIVETRANSFORMATIONTYPE.TRANSLATION&&p.type!==c.LIVETRANSFORMATIONTYPE.SCALING)return(0,module$src$api$v2$ApiResponse.default)("No valid transformation type provided for at least one of the live transformations.");
if(!module$src$shared$util$GlobalUtils.default.typeCheck(p.duration,"notnegative"))return(0,module$src$api$v2$ApiResponse.default)("No valid duration provided for at least one of the live transformations.");module$src$shared$util$GlobalUtils.default.typeCheck(p.delay,"notnegative")||(p.delay&&a.warn("setLiveTransformation","The value "+p.delay+" is not a valid input for the delay. It is set to the default (0)."),p.delay=0);module$src$shared$util$GlobalUtils.default.typeCheck(p.repeat,"notnegative")||
(p.repeat&&a.warn("setLiveTransformation","The value "+p.repeat+" is not a valid input for the repeat. It is set to the default (0)."),p.repeat=0);module$src$shared$util$GlobalUtils.default.typeCheck(p.yoyo,"boolean")||(p.yoyo&&a.warn("setLiveTransformation","The value "+p.yoyo+" is not a valid input for the yoyo. It is set to the default (false)."),p.yoyo=!1);module$src$shared$util$GlobalUtils.default.typeCheck(p.parent,"string")?f.getBoundingBox(p.parent)||(a.warn("setLiveTransformation","The value "+
p.parent+" is not a valid path to a parent. It is set to the default (null)."),p.parent=null):(p.parent&&a.warn("setLiveTransformation","The value "+p.parent+" is not a valid input for the parent. It is set to the default (null)."),p.parent=null);p.easing?module$src$shared$util$GlobalUtils.default.typeCheck(p.easing,"string")?(p.easing=module$src$shared$util$GlobalUtils.default.getAtPath(module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing,p.easing),p.easing||(a.warn("setLiveTransformation",
"The value "+p.easing+" is not a valid input for the easing. It is set to the default (Linear.None)."),p.easing=module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Linear.None)):module$src$shared$util$GlobalUtils.default.typeCheck(p.easing,"function")||p.easing||(a.warn("setLiveTransformation","The value "+p.easing+" is not a valid input for the easing. It is set to the default (Linear.None)."),p.easing=module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Linear.None):p.easing=
module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Linear.None;module$src$shared$util$GlobalUtils.default.typeCheck(p.pivot,"vector3any")||(p.pivot&&a.warn("setLiveTransformation","The value "+p.pivot+" is not a valid input for the pivot. It is set to the default (null)."),p.pivot=null);if(!module$src$shared$util$GlobalUtils.default.typeCheck(p.rotationAxis,"vector3any")&&p.type===c.LIVETRANSFORMATIONTYPE.ROTATION)return(0,module$src$api$v2$ApiResponse.default)("No valid rotationAxis provided for at least one of the live transformations with type ROTATION.");
if(!module$src$shared$util$GlobalUtils.default.typeCheck(p.rotationDegree,"number")&&p.type===c.LIVETRANSFORMATIONTYPE.ROTATION)return(0,module$src$api$v2$ApiResponse.default)("No valid rotationDegree provided for at least one of the live transformations with type ROTATION.");if(!module$src$shared$util$GlobalUtils.default.typeCheck(p.scalingVector,"vector3any")&&p.type===c.LIVETRANSFORMATIONTYPE.SCALING)return(0,module$src$api$v2$ApiResponse.default)("No valid scalingVector provided for at least one of the live transformations with type SCALING.");
if(!module$src$shared$util$GlobalUtils.default.typeCheck(p.translationVector,"vector3any")&&p.type===c.LIVETRANSFORMATIONTYPE.TRANSLATION)return(0,module$src$api$v2$ApiResponse.default)("No valid translationVector provided for at least one of the live transformations with type TRANSLATION.")}module$src$shared$util$GlobalUtils.default.typeCheck(h.reset,"boolean")||(h.reset&&a.warn("setLiveTransformation","The value "+h.reset+" is not a valid input for the reset. It is set to the default (true)."),
h.reset=!0)}d=[];h={};l=0;for(n=g.length;l<n;h={stops:h.stops},l++){p=[];h.stops=[];var r=[],w=g[0].setLiveTransformation(b,e),y=0;for(m=w.length;y<m;y++)p.push({stop:w[y].stop,promise:w[y].promise}),h.stops.push(w[y].stop),r.push(w[y].promise);d.push({responses:p,stop:function(a){return function(b){for(var c=0,d=a.stops.length;c<d;c++)a.stops[c](b)}}(h),promise:Promise.all(r)})}return(0,module$src$api$v2$ApiResponse.default)(null,1===d.length?d[0]:d)};this.getScreenshot=function(){for(var b=[],c=
a.viewports.get(),d=0,e=c.length;d<e;d++)b.push(c[d].getScreenshot());return 1===b.length?b[0]:b};this.updateSelected=function(a,b){var e=d.getDefaultThreeDManagers();if(0===e.length)return c.error("ApiImplementationV2.updateSelected","There is no default viewport defined. This function is therefore not available."),null;for(var f=[],g=0,h=e.length;g<h;g++)f.push(e[g].interactionHandler.setSelectedPaths(a,b));1===f.length&&(f=f[0]);return f};this.getSelected=function(){var a=d.getDefaultThreeDManagers();
if(0===a.length)return c.error("ApiImplementationV2.getSelected","There is no default viewport defined. This function is therefore not available."),null;for(var b=[],e=0,f=a.length;e<f;e++)b.push(a[e].interactionHandler.getSelectedPaths());1===b.length&&(b=b[0]);return b};this.removeAsync=function(b,d,e){d=d||a.getRuntimeId();var f=c.get(b,d,!0);f.payload=e;if(f.err)return f;b=[];for(var h=$jscomp.makeIterator(f.data),m=h.next();!m.done;m=h.next())b.push(m.value.id);return g.removeOutputIds(d,b).then(function(){return(0,module$src$api$v2$ApiResponse.default)(null,
f.data,e)},function(a){return Promise.resolve((0,module$src$api$v2$ApiResponse.default)(a,null,e))})};this.updatePersistentAsync=function(b,c,d){Array.isArray(b)||(b=[b]);c=c||a.getRuntimeId();var e=[];b=$jscomp.makeIterator(b);for(var f=b.next();!f.done;f=b.next()){f=f.value;if(void 0===f||"object"!==typeof f)return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Unexpected asset format",null,d));if(!f.hasOwnProperty("id"))return Promise.resolve((0,module$src$api$v2$ApiResponse.default)('Asset does not have "id" attribute.',
null,d));e.push(g.setPersistentAttributes(f.id,c,f))}return Promise.all(e).then(function(a){return(0,module$src$api$v2$ApiResponse.default)(null,a,d)}).catch(function(a){return Promise.resolve((0,module$src$api$v2$ApiResponse.default)(a,null,d))})};this.getPersistent=function(b,d){d=d||a.getRuntimeId();var e=c.get(b,d,!1);if(e.err)return e;b=[];e=$jscomp.makeIterator(e.data);for(var f=e.next();!f.done;f=e.next())(f=g.getPersistentAttributes(f.value.id,d))&&b.push(f);return(0,module$src$api$v2$ApiResponse.default)(null,
b)};this.updateInteractionGroups=function(a){Array.isArray(a)||(a=[a]);var b={};a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;b={g:b.g,group:b.group},c=a.next()){b.group=c.value;if(!b.group||!b.group.id)return(0,module$src$api$v2$ApiResponse.default)("Interaction group without id property");b.g={};["hoverable","selectable","draggable"].forEach(function(a){return function(b){a.g[b]=a.group[b]||!1}}(b));b.group.selectionMode&&(b.g.selectionMode=b.group.selectionMode);b.g.name=b.group.id;c=function(a){var b=
["active","passive"],c;for(c in b)if(b=a[c]){if("object"!==typeof b)return"Effect has invalid type. Should be object.";if(!b.name)return"Effect has no name property.";if(-1==["colorHighlight","opacityHighlight"].indexOf(b.name))return"Invalid effect type name."}};if(b.g.hoverable&&b.group.hoverEffect){var d=c(b.group.hoverEffect);if(d)return(0,module$src$api$v2$ApiResponse.default)(d);b.g.hoverableHighlight=b.group.hoverEffect}if(b.g.selectable&&b.group.selectionEffect){if(d=c(b.group.selectionEffect))return(0,module$src$api$v2$ApiResponse.default)(d);
b.g.selectableHighlight=b.group.selectionEffect}if(b.g.draggable&&b.group.dragEffect){if(c=c(b.group.dragEffect))return(0,module$src$api$v2$ApiResponse.default)(c);b.g.draggableHighlight=b.group.dragEffect}p.isInteractionGroup(b.g.name)&&(c=p.getGroup(b.g.name),b.g.hasOwnProperty("hoverable")||(b.g.hoverable=c.isHoverable()),b.g.hasOwnProperty("selectable")||(b.g.selectable=c.isSelectable()),b.g.hasOwnProperty("selectionMode")||(b.g.selectionMode=c.getSelectionMode()),b.g.hasOwnProperty("draggable")||
(b.g.draggable=c.isDraggable()),b.g.hasOwnProperty("hoverEffect")||(b.g.hoverEffect=c.getHoverableHighlight()),b.g.hasOwnProperty("selectionEffect")||(b.g.selectionEffect=c.getSelectableHighlight()),b.g.hasOwnProperty("dragEffect")||(b.g.dragEffect=c.getDraggableHighlight()));p.addOrReplaceInteractionGroup(b.g)}return(0,module$src$api$v2$ApiResponse.default)(null,!0)};this.getInteractionGroups=function(){var a=p.getGroups(),b=[],c={};a=$jscomp.makeIterator(a);for(var d=a.next();!d.done;c={g:c.g},
d=a.next())d=d.value,c.g={},c.g.id=d.getName(),c.g.hoverable=d.isHoverable(),c.g.selectable=d.isSelectable(),c.g.selectionMode=d.getSelectionMode(),c.g.draggable=d.isDraggable(),c.g.hoverEffect=d.getHoverableHighlight(),c.g.selectionEffect=d.getSelectableHighlight(),c.g.dragEffect=d.getDraggableHighlight(),["dragEffect","hoverEffect","selectionEffect"].forEach(function(a){return function(b){if(a.g[b]){var c=a.g[b],d={};["active","passive"].forEach(function(a){if(c[a]&&(d[a]={name:c[a].name},c[a].options&&
(d[a].options={},d[a].options.opacity&&(d[a].options.opacity=c[a].options.opacity),c[a].options.color))){var b=c[a].options.color;["r","g","b"].every(function(a){return b.hasOwnProperty(a)})&&(d[a].options.color=[255*b.r,255*b.g,255*b.b])}});a.g[b]=d}}}(c)),b.push(c.g);return(0,module$src$api$v2$ApiResponse.default)(null,b)};this.addEventListener=function(b,d){if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,"string")||0>=b.length)return(0,module$src$api$v2$ApiResponse.default)("Event type must be a string");
var e;if(!Object.keys(c.EVENTTYPE).find(function(a){a=c.EVENTTYPE[a];return b.startsWith(a)?(e=a,!0):!1}))return(0,module$src$api$v2$ApiResponse.default)("Unsupported event type");var f=a.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE+"."+b,function(a,b){a=new CustomEvent(e);a.api=b.api;b.token&&(a.token=b.token);var c={};c[module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION]=null;c[module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC]=
null;c[module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_ANCHORDATA]=null;c[module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_UPDATE]={assets:1};for(var f in c){var g=b.getUniquePartByType(f);if(g){g.data&&(g=g.data);var h=c[f]?c[f]:g,m;for(m in h)a[m]=g[m]}}d(a)});return(0,module$src$api$v2$ApiResponse.default)(null,f)};this.removeEventListener=function(b){return(0,module$src$api$v2$ApiResponse.default)(null,a.unsubscribeFromMessageStream(b))};
this.render=function(){d.render()};this.pause=function(){for(var a=d.getApis(),b=0,c=a.length;b<c;b++)a[b].pause()};this.resume=function(){for(var a=d.getApis(),b=0,c=a.length;b<c;b++)a[b].resume();d.render()};this.toggleGeometry=function(a,b){module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")&&(a=[a]);module$src$shared$util$GlobalUtils.default.typeCheck(b,"string")&&(b=[b]);if(!(Array.isArray(a)&&Array.isArray(b)&&a.every(function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,
"string")})&&b.every(function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")})))return(0,module$src$api$v2$ApiResponse.default)("The provided input is not valid");f.toggleGeometry(a,b);return(0,module$src$api$v2$ApiResponse.default)(null,!0)}},ParameterApi$$module$src$api$v2$ApiImplementationV2_1=function(a,b){var c=this;this.RESULT=ApiInterfaceV2$$module$src$api$v2$ApiImplementationV2_1.parameters.RESULT;this.TYPE=ApiInterfaceV2$$module$src$api$v2$ApiImplementationV2_1.parameters.TYPE;
this.VISUALIZATION=ApiInterfaceV2$$module$src$api$v2$ApiImplementationV2_1.parameters.VISUALIZATION;this.EVENTTYPE=ApiInterfaceV2$$module$src$api$v2$ApiImplementationV2_1.parameters.EVENTTYPE;var g=b.parameterHandler;this.get=function(a){return(a=g.getParameterDefinitionsAndValues(a))?(0,module$src$api$v2$ApiResponse.default)(null,a):(0,module$src$api$v2$ApiResponse.default)("Failed to get parameter definitions")};var d=function(a){return!a||"object"!==typeof a||!module$src$shared$util$GlobalUtils.default.typeCheck(a.id,
"string")&&!module$src$shared$util$GlobalUtils.default.typeCheck(a.idOrName,"string")&&!module$src$shared$util$GlobalUtils.default.typeCheck(a.name,"string")||a.plugin&&!module$src$shared$util$GlobalUtils.default.typeCheck(a.plugin,"string")||void 0===a.value?!1:!0};this.updateAsync=function(b,c){Array.isArray(b)||(b=[b]);for(var e=$jscomp.makeIterator(b),f=e.next();!f.done;f=e.next())if(!d(f.value))return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Invalid input, expecting array of ParameterUpdateObject.",
null,c));var h=module$src$shared$util$GlobalUtils.default.deepCopy(b);e=0;for(f=b.length;e<f;e++)b[e].value instanceof Blob&&(h[e].value=b[e].value);var p=module$src$shared$constants$MessagingConstants.default.makeMessageToken();p.payload=c;return new Promise(function(b){var d=function(){var d=a.setProcessCallback(p.id,function(e,f){if(f.hasOwnProperty("parts"))for(e=$jscomp.makeIterator(f.parts),f=e.next();!f.done;f=e.next()){f=f.value;if(f.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS){a.clearProcessCallback(d);
b((0,module$src$api$v2$ApiResponse.default)(null,h,c));break}if(f.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT){a.clearProcessCallback(d);b((0,module$src$api$v2$ApiResponse.default)(f.data,null,c));break}if(f.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR){a.clearProcessCallback(d);b((0,module$src$api$v2$ApiResponse.default)(f.data,null,c));break}}}),e=g.setMultipleParameterValues(h,p);if(e.err)a.error("ApiImplementationV2.ParameterApi.updateAsync",
"_parameterHandler.setMultipleParameterValues returned error",e),a.clearProcessCallback(d),b((0,module$src$api$v2$ApiResponse.default)({m:"Failed to set parameter values",d:e},null,c));else{e.warn&&a.warn("ApiImplementationV2.ParameterApi.updateAsync","_parameterHandler.setMultipleParameterValues returned warning",e);var f={};e=$jscomp.makeIterator(e.params);for(var m=e.next();!m.done;f={p:f.p},m=e.next())f.p=m.value,h.find(function(a){return function(b){return b.id===a.p.id&&b.plugin===a.p.plugin}}(f)).result=
f.p.result}},e=g.updateRequiresPriorUpload(h);void 0===e?b((0,module$src$api$v2$ApiResponse.default)("Parameter not found",null,c)):!1===e?d():g.priorUpload(h).then(function(e){e.err?(a.error("ApiImplementationV2.ParameterApi.updateAsync","_parameterHandler.priorUpload returned error",e),b((0,module$src$api$v2$ApiResponse.default)({m:"Failed to upload blobs",d:e},null,c))):d()},function(d){a.error("ApiImplementationV2.ParameterApi.updateAsync","_parameterHandler.priorUpload failed",d);b((0,module$src$api$v2$ApiResponse.default)({m:"Failed to upload blobs",
d:d},null,c))})})};this.canGoBackInHistory=function(){return g.canGoBackInHistory()};this.canGoForwardInHistory=function(){return g.canGoForwardInHistory()};this.goBackInHistoryAsync=function(b){var c=module$src$shared$constants$MessagingConstants.default.makeMessageToken();c.payload=b;return new Promise(function(d){var e=a.setProcessCallback(c.id,function(c,f){if(f.hasOwnProperty("parts"))for(c=$jscomp.makeIterator(f.parts),f=c.next();!f.done;f=c.next()){f=f.value;if(f.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS){a.clearProcessCallback(e);
d((0,module$src$api$v2$ApiResponse.default)(null,g.getParameterState(),b));break}if(f.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT){a.clearProcessCallback(e);d((0,module$src$api$v2$ApiResponse.default)(f.data,null,b));break}if(f.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR){a.clearProcessCallback(e);d((0,module$src$api$v2$ApiResponse.default)(f.data,null,b));break}}});g.goBackInHistory(c)||(a.error("ApiImplementationV2.goBackInHistoryAsync",
"_parameterHandler.goBackInHistory returned false"),a.clearProcessCallback(e),d((0,module$src$api$v2$ApiResponse.default)("Failed to go back in history",null,b)))})};this.goForwardInHistoryAsync=function(b){var c=module$src$shared$constants$MessagingConstants.default.makeMessageToken();c.payload=b;return new Promise(function(d){var e=a.setProcessCallback(c.id,function(c,f){if(f.hasOwnProperty("parts"))for(c=$jscomp.makeIterator(f.parts),f=c.next();!f.done;f=c.next()){f=f.value;if(f.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS){a.clearProcessCallback(e);
d((0,module$src$api$v2$ApiResponse.default)(null,g.getParameterState(),b));break}if(f.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT){a.clearProcessCallback(e);d((0,module$src$api$v2$ApiResponse.default)(f.data,null,b));break}if(f.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR){a.clearProcessCallback(e);d((0,module$src$api$v2$ApiResponse.default)(f.data,null,b));break}}});g.goForwardInHistory(c)||(a.error("ApiImplementationV2.goForwardInHistoryAsync",
"_parameterHandler.goForwardInHistory returned false"),a.clearProcessCallback(e),d((0,module$src$api$v2$ApiResponse.default)("Failed to go forward in history",null,b)))})};this.updateProperties=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,g.updateMultipleParameters(a))};this.addEventListener=function(b,d){if(!Object.keys(c.EVENTTYPE).find(function(a){return c.EVENTTYPE[a]===b}))return(0,module$src$api$v2$ApiResponse.default)("Unsupported event type");var e=a.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.PARAMETER+
"."+b,function(a,c){a=new CustomEvent(b);a.api=c.api;c.token&&(a.token=c.token);a.parameter={};var e={};e[module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_DEFINITION]=null;e[module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_UPDATE]=null;for(var f in e){var g=c.getUniquePartByType(f);if(g){g.data&&(g=g.data);var h=e[f]?e[f]:g,n;for(n in h)a.parameter[n]=g[n]}}d(a)});return(0,module$src$api$v2$ApiResponse.default)(null,e)};this.removeEventListener=
function(b){return(0,module$src$api$v2$ApiResponse.default)(null,a.unsubscribeFromMessageStream(b))}},ExportApi$$module$src$api$v2$ApiImplementationV2_1=function(a,b){var c=this;this.RESULT=ApiInterfaceV2$$module$src$api$v2$ApiImplementationV2_1.exports.RESULT;this.EVENTTYPE=ApiInterfaceV2$$module$src$api$v2$ApiImplementationV2_1.exports.EVENTTYPE;var g=b.exportHandler;this.get=function(){return(0,module$src$api$v2$ApiResponse.default)(null,g.getExportDefinitions())};var d=function(a){return!a||"object"!==
typeof a||!module$src$shared$util$GlobalUtils.default.typeCheck(a.id,"string")&&!module$src$shared$util$GlobalUtils.default.typeCheck(a.idOrName,"string")&&!module$src$shared$util$GlobalUtils.default.typeCheck(a.name,"string")||a.plugin&&"string"!==typeof a.plugin?!1:!0};this.requestAsync=function(b,c){if(!d(b))return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Invalid input, expecting an ExportRequestObject.",null,c));var e=g.getUniqueExportByRequestObject(b);if(void 0===e)return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Invalid input, ExportRequestObject did not match a unique export definition.",
null,c));var f=module$src$shared$constants$MessagingConstants.default.makeMessageToken();f.payload=c;b.silent&&(f.attributes={silent:!0});return new Promise(function(b){var d=a.setProcessCallback(f.id,function(f,g){if(g.hasOwnProperty("parts"))for(f=$jscomp.makeIterator(g.parts),g=f.next();!g.done;g=f.next()){g=g.value;if(g.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_RESULT){module$src$shared$util$GlobalUtils.default.defaults(e,g.data,!0);a.clearProcessCallback(d);
b((0,module$src$api$v2$ApiResponse.default)(null,e,c));break}if(g.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT){a.clearProcessCallback(d);b((0,module$src$api$v2$ApiResponse.default)(g.data,null,c));break}if(g.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR){a.clearProcessCallback(d);b((0,module$src$api$v2$ApiResponse.default)(g.data,null,c));break}}}),h=g.requestExport(e,f);e.resultcode=h;h!==module$src$shared$constants$PluginConstantsGlobal.default.requestExportResults.CACHE&&
h!==module$src$shared$constants$PluginConstantsGlobal.default.requestExportResults.LOAD&&(a.error("ApiImplementationV2.ExportApi.requestAsync","_exportHandler.requestExport returned error",h),a.clearProcessCallback(d),b((0,module$src$api$v2$ApiResponse.default)({m:"Failed to request export",d:h},e,c)))})};this.updateProperties=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,g.updateMultipleExports(a))};this.addEventListener=function(b,d){if(!Object.keys(c.EVENTTYPE).find(function(a){return c.EVENTTYPE[a]===
b}))return(0,module$src$api$v2$ApiResponse.default)("Unsupported event type");var e=a.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT+"."+b,function(a,c){a=new CustomEvent(b);a.api=c.api;c.token&&(a.token=c.token);a.export={};var e={};e[module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_DEFINITION]=null;e[module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_RESULT]=null;e[module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_STATUS]=
null;for(var f in e){var g=c.getUniquePartByType(f);if(g){g.data&&(g=g.data);var h=e[f]?e[f]:g,n;for(n in h)a.export[n]=g[n]}}d(a)});return(0,module$src$api$v2$ApiResponse.default)(null,e)};this.removeEventListener=function(b){return(0,module$src$api$v2$ApiResponse.default)(null,a.unsubscribeFromMessageStream(b))}},PluginApi$$module$src$api$v2$ApiImplementationV2_1=function(a,b){var c=this;this.STATUS=ApiInterfaceV2$$module$src$api$v2$ApiImplementationV2_1.plugins.STATUS;var g=b.pluginHandler,d=b.messagingHandler,
f=b.parameterHandler;this.get=function(){return(0,module$src$api$v2$ApiResponse.default)(null,g.getStatusDescription())};this.registerPluginAsync=function(a){return new Promise(function(b){try{var c=a.getRuntimeId(),e=[],f=function(f,g){(f=g.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PLUGIN_RUNTIME_ID))&&f.data===c&&(e.forEach(function(a){d.unsubscribeFromMessageStream(a)}),b((0,module$src$api$v2$ApiResponse.default)(null,a.getStatusDescription())))};
e.push(d.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.PLUGIN_ACTIVE,f));e.push(d.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.PLUGIN_FAILED,f));void 0===g.registerPlugin(a)&&(e.forEach(function(a){d.unsubscribeFromMessageStream(a)}),b((0,module$src$api$v2$ApiResponse.default)("Failed to register plugin.",a.getStatusDescription())))}catch(q){b((0,module$src$api$v2$ApiResponse.default)(q))}})};this.registerCommPluginAsync=
function(a){a=new module$src$plugins$comm$CommPlugin.default(a);return c.registerPluginAsync(a)};this.refreshPluginAsync=function(b,c){var d=module$src$shared$constants$MessagingConstants.default.makeMessageToken();d.payload=c;return new Promise(function(e){var g=a.setProcessCallback(d.id,function(b,d){if(d.hasOwnProperty("parts"))for(b=$jscomp.makeIterator(d.parts),d=b.next();!d.done;d=b.next()){d=d.value;if(d.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS){a.clearProcessCallback(g);
e((0,module$src$api$v2$ApiResponse.default)(null,f.getParameterState(),c));break}if(d.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT){a.clearProcessCallback(g);e((0,module$src$api$v2$ApiResponse.default)(d.data,null,c));break}if(d.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR){a.clearProcessCallback(g);e((0,module$src$api$v2$ApiResponse.default)(d.data,null,c));break}}});f.refreshPlugin(b,d).err&&(a.error("ApiImplementationV2.refreshPluginAsync",
"_parameterHandler.refreshPlugin failed"),a.clearProcessCallback(g),e((0,module$src$api$v2$ApiResponse.default)("Failed to refresh plugin "+b,null,c)))})};this.saveDefaultParameterValuesAsync=function(a){a||(a=g.getRuntimeIds());Array.isArray(a)||(a=[a]);for(var b=[],c=0,d=a.length;c<d;c++){var p=a[c],q=g.getPluginByRuntimeId(p);q?q.getCapabilities().includes(module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities.DEFAULTPARAM)?(p=f.getParameterValuesForPlugin(p,!0),b.push(q.saveDefaultParameterValues(p))):
b.push(Promise.resolve(!1)):b.push(Promise.resolve(!1))}return Promise.all(b).then(function(a){return(0,module$src$api$v2$ApiResponse.default)(null,a.every(function(a){return a}))},function(a){return(0,module$src$api$v2$ApiResponse.default)(a,!1)})};this.deregisterPluginAsync=function(){return Promise.reject("not implemented yet")}},ApiViewportsInterface$$module$src$api$v2$ApiImplementationV2_1=function(a,b){var c=b.viewportManager;this.TYPE=ApiInterfaceV2$$module$src$api$v2$ApiImplementationV2_1.viewports.TYPE;
this.EVENTTYPE=ApiInterfaceV2$$module$src$api$v2$ApiImplementationV2_1.viewports.EVENTTYPE;this.get=function(a){return a?module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")?c.getApi(a):(0,module$src$api$v2$ApiResponse.default)("The provided input is not a valid runtimeId"):c.getApis()};this.create=function(a){return c.createThreeDManager(a)[0]};this.destroy=function(a){a=this.get(a);if(!a)return(0,module$src$api$v2$ApiResponse.default)("The viewport with this runtime Id was not found.");
if(Array.isArray(a)){for(var b=0,c=a.length;b<c;b++)a[b].destroy();return!0}return a.destroy()}};
module$src$api$v2$ApiImplementationV2_1.default=function(a,b){var c=this,g=module$src$shared$util$GlobalUtils.default.deepCopy(b);g.runtimeId&&module$src$shared$util$GlobalUtils.default.typeCheck(g.runtimeId,"string")||(g.runtimeId=module$src$shared$util$GlobalUtils.default.createRandomId());this.EVENTTYPE=ApiInterfaceV2$$module$src$api$v2$ApiImplementationV2_1.EVENTTYPE;this.getRuntimeId=function(){return g.runtimeId};b=a.app;var d=a.exportHandler,f=a.messagingHandler,p=a.parameterHandler,e=a.pluginHandler,
m=a.processStatusHandler,h=a.sceneManager,r=a.settingsHandler,q=a.viewportManager,t=a.sceneGeometryManager,u=a.interactionGroupManager,n=a.arApi,l=/^scene\./;module$src$shared$util$GlobalUtils.default.inject(a.loggingHandler,c);var v={};this.clearProcessCallback=function(a){if(!v.hasOwnProperty(a))return!1;f.unsubscribeFromMessageStream(v[a].subToken);delete v[a];return!0};this.setProcessCallback=function(a,b){if(!v.hasOwnProperty(a)){var d=f.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS+
"."+a,function(d,e){var f=d.substring(d.indexOf(".")+1);if(v.hasOwnProperty(a)){var g=v[a],h=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_FORK);if(h&&Array.isArray(h.data)){if(h.data.every(function(b){return b.startsWith(a+".")})){var l=g.procTokens;l=l.splice(l.indexOf(f),1);l=l.concat(h.data);g.procTokens=l}else c.error("ApiImplementationV2.setProcessCallback","Forked process token must be a sub-token of "+a);try{b(d,e)}catch(F){c.error("ApiImplementationV2.setProcessCallback",
"Exception in process callback:",F)}}else{h=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR);l=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT);var n=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS);h?g.procTokenStat[f]=module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR:l?g.procTokenStat[f]=
module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT:n&&(g.procTokenStat[f]=module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS);g.procTokens.every(function(a){return g.procTokenStat.hasOwnProperty(a)})&&(c.debug("ApiImplementationV2.setProcessCallback","Clearing process callback for token "+a),c.clearProcessCallback(a));try{b(d,e)}catch(F){c.error("ApiImplementationV2.setProcessCallback","Exception in process callback:",F)}}}else c.warn("ApiImplementationV2.setProcessCallback",
"Message for unknown token:",e)});v[a]={subToken:d,procTokens:[a],procTokenStat:{}};return a}};this.subscribeToMessageStream=function(a,b){return f.subscribeToMessageStream(a,function(a,d){try{d=d||{},d.api=c,b(a,d)}catch(A){c.warn("ApiImplementationV2.subscribeToMessageStream","Exception in callback for topic "+a,A,d)}})};this.unsubscribeFromMessageStream=function(a){return f.unsubscribeFromMessageStream(a)};this.state=new StateApi$$module$src$api$v2$ApiImplementationV2_1(c,{processStatusHandler:m,
messagingHandler:f});this.parameters=new ParameterApi$$module$src$api$v2$ApiImplementationV2_1(c,{parameterHandler:p,messagingHandler:f});this.plugins=new PluginApi$$module$src$api$v2$ApiImplementationV2_1(c,{pluginHandler:e,messagingHandler:f,parameterHandler:p});this.exports=new ExportApi$$module$src$api$v2$ApiImplementationV2_1(c,{exportHandler:d});this.viewports=new ApiViewportsInterface$$module$src$api$v2$ApiImplementationV2_1(c,{viewportManager:q});this.scene=new SceneApi$$module$src$api$v2$ApiImplementationV2_1(c,
{sceneManager:h,viewportManager:q,sceneGeometryManager:t,interactionGroupManager:u,messagingHandler:f});var x={};x["defaultMaterial.color"]={handler:b,namespace:"app",setting:"defaultMaterial.color",desc:"Color of the default material",type:function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"color")?!0:!1}};x["defaultMaterial.bumpAmplitude"]={handler:b,namespace:"app",setting:"defaultMaterial.bumpAmplitude",desc:"Bump amplitude of the default material",type:"notnegative"};x["defaultMaterial.metalness"]=
{handler:b,namespace:"app",setting:"defaultMaterial.metalness",desc:"Metalness of the default material",type:function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"number")&&0<=a&&1>=a}};x["defaultMaterial.roughness"]={handler:b,namespace:"app",setting:"defaultMaterial.roughness",desc:"Roughness of the default material",type:function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"number")&&0<=a&&1>=a}};x.ignoreSuperseded={handler:b,namespace:"app",setting:"ignoreSuperseded",
desc:"Ignore intermediate solutions which at the time of their arrival have already been superseded by another customization request",type:"boolean"};x.blurSceneWhenBusy={handler:b,namespace:"app",setting:"blurSceneWhenBusy",desc:"Blur or don't blur the scene while a process is busy",type:"boolean"};x.loggingLevel={handler:b,namespace:"app",setting:"loggingLevel",desc:"Level of log messages shown on the console, allowed values: -1 (none), 0 (error), 1 (warn), 2 (info), 3 (debug)",type:function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,
"number")&&-1<=a&&3>=a}};x.messageLoggingLevel={handler:b,namespace:"app",setting:"messageLoggingLevel",desc:"Log level to be used for logging internal messages, allowed values: -1 (none), 0 (error), 1 (warn), 2 (info), 3 (debug)",type:function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"number")&&-1<=a&&3>=a}};x["scene.show"]={handler:b,namespace:"app",setting:"showScene",desc:"Show / hide the scene",type:"boolean"};x.showMessages={handler:b,namespace:"app",setting:"showMessages",
desc:"Show or don't show user messages in the viewport",type:"boolean"};x.commitParameters={handler:b,namespace:"app",setting:"commitParameters",desc:"Use or don't commit mode for parameters",type:"boolean"};x.commitSettings={handler:b,namespace:"app",setting:"commitSettings",desc:"Use or don't commit mode for settings",type:"boolean"};x["ar.enableCameraSync"]={handler:b,namespace:"app",setting:"ar.enableCameraSync",desc:"Enable / disable synchronisation of the camera with AR tracking information. Enabling this will disable the orbit controls.",
tyoe:"boolean"};x["ar.enableLightingEstimation"]={handler:b,namespace:"app",setting:"ar.enableLightingEstimation",desc:"Enable / disable automatic lighting estimation. Enabling this stores the current state of the lights which will get restored once automatic lighting estimation gets disabled again.",tyoe:"boolean"};x["ar.enableTouchControls"]={handler:b,namespace:"app",setting:"ar.enableTouchControls",desc:"Enable / disable touch controls for placement of objects in the AR scene while AR camera synchronisation is enabled.",
tyoe:"boolean"};x["ar.enableTouchControlRotation"]={handler:b,namespace:"app",setting:"ar.enableTouchControlRotation",desc:"Enable / disable rotation of objects in the AR scene by means of touch controls. Typically this should be enabled for objects to be placed horizontally.",tyoe:"boolean"};x["ar.enableAutomaticPlacement"]={handler:b,namespace:"app",setting:"ar.enableAutomaticPlacement",desc:"Enable / disable initial automatic placement of objects in the AR scene as soon as plane anchors get detected. Automatic placement stops once the user starts to interact.",
tyoe:"boolean"};x["ar.defaultHitTestType"]={handler:b,namespace:"app",setting:"ar.defaultHitTestType",desc:"Default type of feature to use for hit tests, used by touch controls. ",tyoe:function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")&&"featurePoint estimatedHorizontalPlane estimatedVerticalPlane existingPlane existingPlaneUsingExtent existingPlaneUsingGeometry".split(" ").contains(a)}};this.addEventListener=function(a,b){if(!Object.keys(c.EVENTTYPE).find(function(b){return c.EVENTTYPE[b]===
a}))return(0,module$src$api$v2$ApiResponse.default)("Unsupported event type");var d=c.subscribeToMessageStream(a,function(d,e){d=new CustomEvent(a);d.api=e.api;e.token&&(d.token=e.token);d.settings={};var f=d.settings;if(e=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SETTINGS_UPDATE)){e.data&&(e=e.data);for(var g=q.getApis(),h=0,l=g.length;h<l;h++){var n=g[h];if(n&&e.namespace===n.getRuntimeId()){f.key=e.key;f.runtimeId=e.namespace;f.namespace="scene";
break}else for(var m in x)if(n=x[m],n.namespace===e.namespace&&n.setting===e.key){f.key=m;f.runtimeId=c.getRuntimeId();break}}f.key&&(f.valueNew=e.valueNew,f.valueOld=e.valueOld,b(d))}});return(0,module$src$api$v2$ApiResponse.default)(null,d)};this.removeEventListener=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,c.unsubscribeFromMessageStream(a))};this.getSettingDefinitions=function(){var a={};Object.keys(x).forEach(function(b){var c=x[b],d={description:c.desc};c.type&&(d.type=
c.type);c=module$src$shared$util$GlobalUtils.default.deepCopy(d);a[b]=c});for(var b=[],c=q.getApis(),d=0,e=c.length;d<e;d++){var f=c[d];if(f){f=f.getSettingDefinitions();var g={},h;for(h in f)g["scene."+h]=f[h];b.push(Object.assign({},a,g))}}1===b.length&&(b=b[0]);return b};this.getSettings=function(a){var b=q.getApis();if(!Array.isArray(a)){a=Object.keys(c.getSettingDefinitions());for(var d=0,e=b.length;d<e;d++)for(var f=Object.keys(b[d].getSettingDefinitions()),g=0,h=f.length;g<h;g++){var n="scene."+
f[g];a.includes(n)||a.push(n)}}d=[];if(0===b.length){var m={};a.forEach(function(a){var b=x[a];void 0!==b&&(b=b.handler.getSetting(b.setting),module$src$shared$util$GlobalUtils.default.forceAtPath(m,a,b))});d.push(m)}else for(f={},g=0,e=b.length;g<e;f={settings$331:f.settings$331,viewportApi$330:f.viewportApi$330},g++)f.viewportApi$330=b[g],f.settings$331={},a.forEach(function(a){return function(b){var c=x[b];void 0!==c?(c=c.handler.getSetting(c.setting),module$src$shared$util$GlobalUtils.default.forceAtPath(a.settings$331,
b,c)):a.viewportApi$330&&(c=a.viewportApi$330.getSetting(b.replace(l,"")),void 0!==c&&module$src$shared$util$GlobalUtils.default.forceAtPath(a.settings$331,b,c))}}(f)),d.push(f.settings$331);1===d.length&&(d=d[0]);return d};this.getSetting=function(a){var b=x[a];if(void 0===b){b=[];for(var c=q.getApis(),d=0,e=c.length;d<e;d++)b.push(c[d].getSetting(a.replace(l,"")));if(0===b.length)return;1===b.length&&(b=b[0]);return b}return b.handler.getSetting(b.setting)};this.updateSettingAsync=function(a,b){var c=
x[a];if(void 0===c){c=[];for(var d=q.getApis(),e=0,f=d.length;e<f;e++)c.push(d[e].updateSettingAsync(a.replace(l,""),b));if(0===c.length)return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Setting does not exist",!1));1===c.length&&(c=c[0]);return c}if(void 0!==c.type&&null!==c.type)if(module$src$shared$util$GlobalUtils.default.typeCheck(c.type,"string")){if(module$src$shared$util$GlobalUtils.default.typeCheck(b,"m.type"))return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Setting has wrong value type",
!1))}else if("function"===typeof c.type&&!c.type(b))return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Setting has wrong value type",!1));c.hasOwnProperty("transform")&&"function"===typeof c.transform&&(b=c.transform(b));return c.handler.updateSettingAsync(c.setting,b).then(function(a){return a?Promise.resolve((0,module$src$api$v2$ApiResponse.default)(null,!0)):Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Update of setting failed",!1))},function(){return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Update of setting failed",
!1))})};this.updateSettingsAsync=function(a){var b=[];module$src$shared$util$GlobalUtils.default.getPaths(a,b);var d={},e=Promise.resolve(),f={};b=$jscomp.makeIterator(b);for(var g=b.next();!g.done;f={path:f.path},g=b.next())f.path=g.value,e=e.then(function(b){return function(){return c.updateSettingAsync(b.path,module$src$shared$util$GlobalUtils.default.getAtPath(a,b.path))}}(f)),e=e.then(function(a){return function(b){b.err?module$src$shared$util$GlobalUtils.default.forceAtPath(d,a.path,!1):module$src$shared$util$GlobalUtils.default.forceAtPath(d,
a.path,!0)}}(f),function(a){return function(){module$src$shared$util$GlobalUtils.default.forceAtPath(d,a.path,!1)}}(f));return e.then(function(){return(0,module$src$api$v2$ApiResponse.default)(null,d)})};this.createAsynchronousFunctions=function(){var a=function(b){var c={},d;for(d in b)c.key=d,b[c.key]instanceof Function?c.key.endsWith("Async")||c.key.endsWith("EventListener")||b[c.key+"Async"]||(b[c.key+"Async"]=function(a){return function(c){for(var d=[],e=0;e<arguments.length;++e)d[e-0]=arguments[e];
return new Promise(function(c,e){c(b[a.key].call.apply(b[a.key],[b].concat($jscomp.arrayFromIterable(d))))})}}(c)):-1<"state parameters plugins exports viewports scene camera lights".split(" ").indexOf(c.key)&&a(b[c.key]),c={key:c.key}};a(this)};this.saveSettingsAsync=function(a){return r.saveSettings(a).then(function(a){return(0,module$src$api$v2$ApiResponse.default)(null,a)},function(a){return(0,module$src$api$v2$ApiResponse.default)(a,!1)})};n&&(this.ar=n);this.utils=module$src$shared$util$GlobalUtils.default;
this.utils.APIResponse=module$src$api$v2$ApiResponse.default};var module$src$api$v1$ApiInterfaceV1={default:function(){this.STATUSCODE={READY:0,BUSY:1,INITIALIZING:2,ERROR:3};this.TYPE={FLOAT:"Float",INT:"Int",EVEN:"Even",ODD:"Odd",STRING:"String",COLOR:"Color",STRINGLIST:"StringList",BOOL:"Bool",TIME:"Time"};this.VISUALIZATION={SLIDER:"slider",SEQUENCE:"sequence",CYCLE:"cycle",DROPDOWN:"dropdown",CHECKLIST:"checklist",CLOCK:"clock",CALENDAR:"calendar"};this.activateTopView=function(){};this.addDraggableShape=function(){};this.cameraPath=function(){};this.changeEnvMap=
function(){};this.clearMessagingCallback=function(){};this.clearProcessCallback=function(){};this.deregisterPlugin=function(){};this.disablePan=function(){};this.disableZoom=function(){};this.fadeInViewer=function(){};this.findTexturedGeometry=function(){};this.getApiVersion=function(){};this.getBackgroundColor=function(){};this.getCamera=function(){};this.getDraggableShapePosition=function(){};this.getExportDefinitions=function(){};this.getGeometryNames=function(){};this.getGeometryPathsByName=function(){};
this.getModelData=function(){};this.getParameterDefinitions=function(){};this.getParameterValues=function(){};this.getScreenshot=function(){};this.getStatus=function(){};this.hideControls=function(){};this.hideFullscreenToggle=function(){};this.hideZoomToggle=function(){};this.loadStaticMesh=function(){};this.refreshPlugin=function(){};this.registerPlugin=function(){};this.removeDraggableShape=function(){};this.removeExternalTexture=function(){};this.removeStaticMesh=function(){};this.requestExport=
function(){};this.requestSceneUpdate=function(){};this.resetCamera=function(){};this.restrictCamera=function(){};this.restrictPan=function(){};this.restrictZoom=function(){};this.setAutoRotate=function(){};this.setAutoRotation=function(){};this.setAutoRotationSpeed=function(){};this.setBackgroundColor=function(){};this.setBumpAmplitude=function(){};this.setBusyGraphic=function(){};this.setBusyGraphicPosition=function(){};this.setButtonColor=function(){};this.setCamera=function(){};this.setCommandResultCallback=
function(){};this.setDefaultMaterialColor=function(){};this.setExternalTexture=function(){};this.setFOV=function(){};this.setPointSize=function(){};this.setToggleAmbientOcclusion=function(){};this.setToggleCastShadow=function(){};this.setControlDamping=function(){};this.setDamping=function(){};this.setEdgeColor=function(){};this.setEdgeColorByObject=function(){};this.setIgnoreMouse=function(){};this.setMessagingCallback=function(){};this.setParameterValue=function(){};this.setParameterValues=function(){};
this.setProcessCallback=function(){};this.setRotateSpeed=function(){};this.setRotationSpeed=function(){};this.setZoomExtentFactor=function(){};this.setZoomSpeed=function(){};this.showControls=function(){};this.showEdges=function(){};this.showFullscreenToggle=function(){};this.showGrid=function(){};this.showGroundPlane=function(){};this.showShadows=function(){};this.showStaticMesh=function(){};this.showZoomToggle=function(){};this.toggleDisablePan=function(){};this.toggleDisableZoom=function(){};this.toggleFullscreen=
function(){};this.toggleSceneBackground=function(){};this.toggleShadows=function(){};this.toggleTopView=function(){};this.zoomExt=function(){};this.zoomExtents=function(){}}};var module$src$api$v1$ApiImplementationV1={},pluginConstants$$module$src$api$v1$ApiImplementationV1=module$src$shared$constants$PluginConstantsGlobal.default,messagingConstants$$module$src$api$v1$ApiImplementationV1=module$src$shared$constants$MessagingConstants.default,GlobalUtils$$module$src$api$v1$ApiImplementationV1=module$src$shared$util$GlobalUtils.default,threeDManagerConstants$$module$src$api$v1$ApiImplementationV1=module$src$3d$viewports$default$ThreeDManagerConstants.default,toTinyColor$$module$src$api$v1$ApiImplementationV1=
module$src$shared$util$toTinyColor.default,ApiInterfaceV1$$module$src$api$v1$ApiImplementationV1=new module$src$api$v1$ApiInterfaceV1.default,THREE$$module$src$api$v1$ApiImplementationV1=module$src$externals$three.default;
module$src$api$v1$ApiImplementationV1.default=function(a){var b=this,c=a.app,g=a.viewportVisibilityHandler,d=a.exportHandler,f=a.messagingHandler,p=a.parameterHandler,e=a.pluginHandler,m=a.processStatusHandler,h=a.sceneManager,r=a.threeDManager;module$src$shared$util$GlobalUtils.default.inject(a.loggingHandler,b);var q=c.api({version:2}),t=q.getRuntimeId();module$src$shared$mixins$GlobalMixin.default.call(this);this.STATUSCODE=ApiInterfaceV1$$module$src$api$v1$ApiImplementationV1.STATUSCODE;this.TYPE=
ApiInterfaceV1$$module$src$api$v1$ApiImplementationV1.TYPE;this.VISUALIZATION=ApiInterfaceV1$$module$src$api$v1$ApiImplementationV1.VISUALIZATION;var u={},n,l=function(a,c){if("function"===typeof n)try{n(a,c)}catch(F){b.error("ApiImplementationV1._callCommandResultCallback","Exception in callback:",a,F)}return c};this._callCommandResultCallback=l;var v={},x=function(a){a.type===q.scene.EVENTTYPE.DRAG_START?A("ObjectDragStarted"):a.type===q.scene.EVENTTYPE.DRAG_END&&A("ObjectDragEnded");if(a.dragPosAbs&&
a.scenePath){var b=a.scenePath.split(".");v[b[1]]=a.dragPosAbs}},w=[],y=function(){if(0<Object.keys(v).length){var a=q.scene.addEventListener(q.scene.EVENTTYPE.DRAG_START+"."+t,x);a.data&&w.push(a.data);a=q.scene.addEventListener(q.scene.EVENTTYPE.DRAG_MOVE+"."+t,x);a.data&&w.push(a.data);a=q.scene.addEventListener(q.scene.EVENTTYPE.DRAG_END+"."+t,x);a.data&&w.push(a.data)}else w.forEach(function(a){q.scene.removeEventListener(a)}),w=[]},z=[],B,A=function(a){if("function"===typeof B)try{B(a)}catch(J){b.error("ApiImplementationV1._sendExternalMsg",
"Exception in messaging callback ("+a+"):",J)}},D=function(){z.forEach(function(a){f.unsubscribeFromMessageStream(a)});z=[]},H=function(){if(!(0<z.length)){var a=module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_PUBLISHED;a=f.subscribeToMessageStream(a,function(){A("GeometryUpdateDone");A("GeometryUpdateVisible")});z=z.concat(a);a=module$src$shared$constants$MessagingConstants.default.messageTopics.PLUGIN_ACTIVE;a=f.subscribeToMessageStream(a,function(a,b){if(a=b.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PLUGIN_RUNTIME_ID))a=
e.getPluginByRuntimeId(a.data).getShortName()+"Loaded",A(a)});z=z.concat(a);a=module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_VISIBILITY_ON;var b=f.subscribeToMessageStream(a,function(){f.unsubscribeFromMessageStream(b);A("InitialSceneReady")});z=z.concat(b)}};this.activateTopView=function(a){a=r.updateSetting("camera.type",a?module$src$3d$viewports$default$ThreeDManagerConstants.default.cameraViewTypes.TOP:module$src$3d$viewports$default$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE);
return l("activateTopView",a)};this.addDraggableShape=function(a,c,d,e,f){if(!(module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")&&module$src$shared$util$GlobalUtils.default.typeCheck(c,"string")&&module$src$shared$util$GlobalUtils.default.typeCheck(d,"notnegative")&&module$src$shared$util$GlobalUtils.default.typeCheck(e,"color")&&module$src$shared$util$GlobalUtils.default.typeCheck(f,"vector3obj")))return l("addDraggableShape",!1);var g=q.scene.get({id:a},t);if(g.err||0<g.data.length)return l("addDraggableShape",
!1);var h;"box"===c?h=new module$src$externals$three.default.BoxBufferGeometry(d,d,d):"sphere"===c?h=new module$src$externals$three.default.SphereBufferGeometry(.5*d,20,20):"dodecahedron"===c&&(h=new module$src$externals$three.default.DodecahedronBufferGeometry(.5*d));if(void 0===h)return l("addDraggableShape",!1);c=q.scene.updateInteractionGroups({id:t,draggable:!0,selectable:!1,hoverable:!1});!0!==c.data?(b.error("ApiImplementationV1._createInteractionGroup","Could not add interaction group",c.err),
c=!1):c=!0;if(!c)return l("addDraggableShape",!1);e=[{id:a,name:a,material:a+"_m",interactionGroup:t,content:[{format:"three",data:{threeObject:new module$src$externals$three.default.Mesh(h)},transformations:(new module$src$externals$three.default.Matrix4).makeTranslation(f.x,f.y,f.z)}]},{id:a+"_m",content:[{format:"material",data:{version:"3.0",color:e}}]}];q.scene.updateAsync(e,t);v[a]=module$src$shared$util$GlobalUtils.default.toVector3(f);y();return l("addDraggableShape",!0)};this.cameraPath=
function(a,b,c){if(a.length!==b.length||0>=a.length)return l("cameraPath",!1);var d={};c&&(d.duration=c);r.cameraHandler.setCameraPath(a,b,d);return l("cameraPath",!0)};this.changeEnvMap=function(a){r.updateSettingAsync("material.environmentMap",a);return!0};this.clearMessagingCallback=function(){D();B=void 0};this.clearProcessCallback=function(a){if(!u.hasOwnProperty(a))return!1;f.unsubscribeFromMessageStream(u[a].subToken);delete u[a];return!0};this.deregisterPlugin=function(a){return e.deregisterPlugin(a)};
this.disablePan=function(a){if(r.getSetting("camera.enablePan")===!a)return l("disablePan",!1);a=r.updateSetting("camera.enablePan",!a);return l("disablePan",a)};this.disableZoom=function(a){if(r.getSetting("camera.enableZoom")===!a)return l("disableZoom",!1);a=r.updateSetting("camera.enableZoom",!a);return l("disableZoom",a)};this.fadeInViewer=function(){g.showScene(!0);return!0};this.findTexturedGeometry=function(){var a=b.getGeometryNames(),c=[],d,e;for(d in a)for(e in a[d])c.push(e);return l("findTexturedGeometry",
c)};this.getApiVersion=function(){return"1.0.0"};this.getBackgroundColor=function(){var a=r.getSetting("render.clearColor"),b=r.getSetting("render.clearAlpha");a=(0,module$src$shared$util$toTinyColor.default)(a);a.setAlpha(b);return a.toString("hex8")};this.getCamera=function(){var a=r.cameraHandler.getPositionAndTarget();return l("getCamera",a)};this.getDraggableShapePosition=function(a){return v.hasOwnProperty(a)?l("getDraggableShapePosition",v[a]):l("getDraggableShapePosition",!1)};this.getExportDefinitions=
function(){var a=d.getExportDefinitions();l("getExportDefinitions",a)};this.getGeometryNames=function(a){return h.getGeometryNames(a)};this.getGeometryPathsByName=function(a,b){return h.getGeometryPathsByName(a,b)};this.getModelData=function(a){var b={};h.getModelData(a).forEach(function(a){b[a.id]=a});return l("getModelData",b)};this.getParameterDefinitions=function(a){a=p.getParameterDefinitions(a);return l("getParameterDefinitions",a)};this.getParameterValues=function(){var a=p.getParameterValuesCompat();
return l("getParameterValues",a)};this.getScreenshot=function(){var a=r.renderingHandler.getScreenshot();return l("getScreenshot",a)};this.getStatus=function(){var a=e.getStatusDescription();if(!a.every(function(a){return a.status!==module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.FAILED}))return a={statusCode:3,statusText:"Error",statusInfo:"At least one plugin failed"},l("getStatus",a);if(!a.every(function(a){return a.status===module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.ACTIVE}))return a=
{statusCode:2,statusText:"Initializing",statusInfo:"The viewer is still initializing"},l("getStatus",a);if(m.getSummary().busy)return a={statusCode:1,statusText:"Busy",statusInfo:"Viewer is processing a parameter update"},l("getStatus",a);a={statusCode:0,statusText:"Ready",statusInfo:"Viewer is fully loaded, geometry is being displayed"};return l("getStatus",a)};this.hideControls=function(){b.error("ApiImplementationV1.hideControls","Requires UI");return l("hideControls",!1)};this.hideFullscreenToggle=
function(){b.error("ApiImplementationV1.hideFullscreenToggle","Requires UI");return!1};this.hideZoomToggle=function(){b.error("ApiImplementationV1.hideZoomToggle","Requires UI");return!1};this.loadStaticMesh=function(a,b,c,d,e,f){if(4>arguments.length||!module$src$shared$util$GlobalUtils.default.typeCheck(d,"string")||0===d.length)d=module$src$shared$util$GlobalUtils.default.createRandomId();if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,"string")||0===b.length)return!1;var g=q.scene.get({id:d},
t);if(g.err||0<g.data.length)return!1;g=[{id:d,material:"material_1",version:"1",duration:0,content:[{format:"obj",data:{objUrl:b}}]}];module$src$shared$util$GlobalUtils.default.typeCheck(c,"string")&&(g[0].content.data.mtlUrl=c);module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")&&(g[0].content.data.path=a);module$src$shared$util$GlobalUtils.default.typeCheck(e,"string")&&(g[0].content.data.texturePath=e);module$src$shared$util$GlobalUtils.default.typeCheck(f,"string")&&(g[0].content.data.side=
f);q.scene.updateAsync(g,t).then(function(){A("LoadStaticMeshDone")});return!0};this.refreshPlugin=function(a,b){b=module$src$shared$constants$MessagingConstants.default.makeMessageToken(b);return p.refreshPlugin(a,b).err?!1:!0};this.registerPlugin=function(a){return e.registerPlugin(a)};this.removeExternalTexture=function(a,c){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string"))return l("removeExternalTexture",!1);var d="color alpha roughness metalness normal bump".split(" ");if("string"===
typeof c)try{c=JSON.parse(c),Array.isArray(c)||(c=[c])}catch(N){c=d}else Array.isArray(c)||(c=d);c.includes("color")&&(c.splice(c.findIndex(function(a){return"color"===a}),1),c.push("bitmap"));c.includes("alpha")&&(c.splice(c.findIndex(function(a){return"alpha"===a}),1),c.push("transparency"));d=b.getGeometryNames();var e;for(e in d)if(d[e].hasOwnProperty(a)){var f=e;break}if(!f)return l("removeExternalTexture",!1);a=q.scene.get({name:a},f);if(a.err||1>=a.data.length)return l("removeExternalTexture",
!1);a=a.data.filter(function(a){return a.material});if(1!==a.length)return l("removeExternalTexture",!1);a=q.scene.getPersistent({id:a[0].material},f);if(a.err||1!==a.data.length)return l("removeExternalTexture",!1);a=module$src$shared$util$GlobalUtils.default.deepCopy(a.data[0]);if(!Array.isArray(a.content)||0>=a.content.length||"material"!==a.content[0].format)return l("removeExternalTexture",!1);var g=a.content[0].data;c.forEach(function(a){delete g[a+"texture"]});q.scene.updatePersistentAsync([a],
f);return l("removeExternalTexture",!0)};this.removeDraggableShape=function(a){if(!v.hasOwnProperty(a))return l("removeDraggableShape",!1);q.scene.removeAsync({id:a},t);delete v[a];y();return l("removeDraggableShape",!0)};this.removeStaticMesh=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")||0< !a.length)return!1;var b=q.scene.get({id:a},t);if(b.err||1!==b.data.length)return!1;q.scene.removeAsync({id:a},t);return!0};this.requestExport=function(a,b,c,e){if("string"===
typeof a)a={idOrName:a},"string"===typeof c&&(a.plugin=c);else if(!a||"object"!==typeof a||!module$src$shared$util$GlobalUtils.default.typeCheck(a.id,"string")&&!module$src$shared$util$GlobalUtils.default.typeCheck(a.idOrName,"string")&&!module$src$shared$util$GlobalUtils.default.typeCheck(a.name,"string")||a.plugin&&"string"!==typeof a.plugin)return l("requestExport",!1);e=module$src$shared$constants$MessagingConstants.default.makeMessageToken(e);c=d.requestExport(a,e);return c!==module$src$shared$constants$PluginConstantsGlobal.default.requestExportResults.CACHE&&
c!==module$src$shared$constants$PluginConstantsGlobal.default.requestExportResults.LOAD?l("requestExport",!1):l("requestExport",!0)};this.requestSceneUpdate=function(){var a=e.getStatusDescription(),b=!0;a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next())c=c.value,c.status===module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.ACTIVE&&p.refreshPlugin(c.id).err&&(b=!1);return b};this.resetCamera=function(a,b){var c={duration:0};void 0===a&&(a=!0);a&&(c.duration=b?b:
800);r.cameraHandler.resetPositionAndTarget(c);return!0};this.restrictCamera=function(a,b,c){if("number"===typeof a)if(0===a)a="x";else if(1===a)a="y";else if(2===a)a="z";else return l("restrictCamera",!1);else if("string"===typeof a){if("x"!==a&&"y"!==a&&"z"!==a)return l("restrictCamera",!1)}else return l("restrictCamera",!1);var d="min";b&&(d="max");if("number"!==typeof c)return l("restrictCamera",!1);b=r.getSetting("camera.restrictions.position.cube");b[d][a]=c;c=r.updateSetting("camera.restrictions.position.cube",
b);return l("restrictCamera",c)};this.restrictPan=function(a,b,c){if("number"===typeof a)if(0===a)a="x";else if(1===a)a="y";else if(2===a)a="z";else return l("restrictPan",!1);else if("string"===typeof a){if("x"!==a&&"y"!==a&&"z"!==a)return!1}else return l("restrictPan",!1);var d="min";b&&(d="max");if("number"!==typeof c)return l("restrictPan",!1);b=r.getSetting("camera.restrictions.target.cube");b[d][a]=c;c=r.updateSetting("camera.restrictions.target.cube",b);return l("restrictPan",c)};this.restrictZoom=
function(a,b){a=r.updateSetting("camera.restrictions.zoom",{minDistance:a,maxDistance:b});return l("restrictZoom",a)};this.setAutoRotate=function(a){if("number"===typeof a){var c=b.setAutoRotationSpeed(a);a=r.updateSetting("camera.enableAutoRotation",0!==a);return l("setAutoRotate",c||a)}return"boolean"===typeof a?(c=r.updateSetting("camera.enableAutoRotation",a),l("setAutoRotate",c)):l("setAutoRotate",!1)};this.setAutoRotation=function(a){return b.setAutoRotate(a)};this.setAutoRotationSpeed=function(a){return"number"!==
typeof a?!1:r.updateSetting("camera.autoRotationSpeed",a)};this.setBackgroundColor=function(a){a=(0,module$src$shared$util$toTinyColor.default)(a);return a.isValid()&&r.updateSetting("render.clearColor",a.toString("hex6"))&&r.updateSetting("render.clearAlpha",a.getAlpha())?l("setBackgroundColor",!0):l("setBackgroundColor",!1)};this.setBumpAmplitude=function(a){q.updateSettingAsync("defaultMaterial.bumpAmplitude",a);return l("setBumpAmplitude",!0)};this.setBusyGraphic=function(){b.error("ApiImplementationV1.setBusyGraphic",
"Requires UI")};this.setBusyGraphicPosition=function(){b.error("ApiImplementationV1.setBusyGraphicPosition","Requires UI")};this.setButtonColor=function(){b.error("ApiImplementationV1.setButtonColor","Not implemented yet");return l("setButtonColor",!1)};this.setCamera=function(a,b,c,d){var e={duration:0};void 0===c&&(c=!0);c&&(e.duration=d?d:800);a=r.cameraHandler.setPositionAndTarget(a,b,e);return l("setCamera",a)};this.setCommandResultCallback=function(a){n=a};this.setDefaultMaterialColor=function(a){q.updateSettingAsync("defaultMaterial.color",
a);return l("setDefaultMaterialColor",!0)};this.setExternalTexture=function(a,c){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string"))return l("setExternalTexture",!1);if("string"===typeof c)try{c=JSON.parse(c)}catch(N){c={color:c}}else if(c&&"object"===typeof c)c=module$src$shared$util$GlobalUtils.default.deepCopy(c);else return l("setExternalTexture",!1);c.color&&(c.bitmap=c.color,delete c.color);c.alpha&&(c.transparency=c.alpha,delete c.alpha);var d=b.getGeometryNames();for(f in d)if(d[f].hasOwnProperty(a)){var e=
f;break}if(!e)return l("setExternalTexture",!1);a=q.scene.get({name:a},e);if(a.err||1>=a.data.length)return l("setExternalTexture",!1);a=a.data.filter(function(a){return a.material});if(1!==a.length)return l("setExternalTexture",!1);d=a[0];a=q.scene.get({id:d.material},e);if(a.err||1!==a.data.length||!Array.isArray(a.data[0].content)||0>=a.data[0].content.length)return l("setExternalTexture",!1);var f={};f.content=module$src$shared$util$GlobalUtils.default.deepCopy(a.data[0].content);if("material"!==
f.content[0].format)return l("setExternalTexture",!1);var g=f.content[0].data;"bitmap metalness roughness bump normal transparency".split(" ").forEach(function(a){if(c[a]&&module$src$shared$util$GlobalUtils.default.typeCheck(c[a],"string")){var b=a+"texture";g[b]&&"object"===typeof g[b]?g[b].href=c[a]:g[b]=c[a]}});f.id=d.material;q.scene.updatePersistentAsync([f],e);return l("setExternalTexture",!0)};this.setFOV=function(a){a=r.updateSetting("camera.fov",a);return l("setFOV",a)};this.setPointSize=
function(a){"number"!==typeof a&&(a=1);a=r.updateSetting("render.pointSize",a);return l("setPointSize",a)};this.setToggleAmbientOcclusion=function(a){return r.updateSetting("render.ambientOcclusion",a)};this.setToggleCastShadow=function(a,b){r.setToggleCastShadow(a,b)};this.setControlDamping=function(a){a=r.updateSetting("camera.damping",a);return l("setControlDamping",a)};this.setDamping=function(a){return b.setControlDamping(a)};this.setEdgeColor=function(){b.warn("ApiImplementationV1.setEdgeColor",
"Not implemented");return l("setEdgeColor",!1)};this.setEdgeColorByObject=function(){b.warn("ApiImplementationV1.setEdgeColorByObject","Not implemented");return l("setEdgeColorByObject",!1)};this.setIgnoreMouse=function(a){q.updateSettingAsync("scene.ignorePointerEvents",a);l("setIgnoreMouse",!0);return!0};this.setMessagingCallback=function(a){"function"===typeof a&&(H(),B=a)};var G=function(a){return!a||"object"!==typeof a||"string"!==typeof a.id&&"string"!==typeof a.idOrName&&"string"!==typeof a.name||
a.plugin&&"string"!==typeof a.plugin||void 0===a.value?!1:!0};this.setParameterValue=function(a,c){if("string"===typeof a)a={idOrName:a,value:c};else if(G(a))var d=c;else return l("setParameterValue",!1);d=module$src$shared$constants$MessagingConstants.default.makeMessageToken(d);c=p.setParameterValue(a,d);if(c.err)return b.error("ApiImplementationV1.setParameterValue","_parameterHandler.setParameterValue returned error",c),l("setParameterValue",!1);if(c.warn)return b.warn("ApiImplementationV1.setParameterValue",
"_parameterHandler.setParameterValue returned warning",c),l("setParameterValue",!1);b.debug("ApiImplementationV1.setParameterValue","_parameterHandler.setParameterValue returned",c);return l("setParameterValue",!0)};this.setParameterValues=function(a,c){var d=[];if(!Array.isArray(a))return l("setParameterValues",!1);if(a.every(function(a){return"string"===typeof a})){if(!Array.isArray(c)||c.length!==a.length)return!1;for(var e=0;e<a.length;e++)d.push({idOrName:a[e],value:c[e]})}else if(a.every(function(a){return G(a)})){d=
a;var f=c}f=module$src$shared$constants$MessagingConstants.default.makeMessageToken(f);a=p.setMultipleParameterValues(d,f);if(a.err)return b.error("ApiImplementationV1.setParameterValues","_parameterHandler.setParameterValue returned error",a),l("setParameterValues",!1);if(a.warn)return b.warn("ApiImplementationV1.setParameterValues","_parameterHandler.setParameterValue returned warning",a),l("setParameterValues",!1);b.debug("ApiImplementationV1.setParameterValues","_parameterHandler.setParameterValue returned",
a);return l("setParameterValues",!0)};this.setProcessCallback=function(a,c){if(!u.hasOwnProperty(a)){var d=f.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS+"."+a,function(d,e){var f=d.substring(d.indexOf(".")+1);if(u.hasOwnProperty(a)){var g=u[a],h=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_FORK);if(h&&Array.isArray(h.data)){if(h.data.every(function(b){return b.startsWith(a+".")})){var l=
g.procTokens;l=l.splice(l.indexOf(f),1);l=l.concat(h.data);g.procTokens=l}else b.error("ApiImplementationV1.setProcessCallback","Forked process token must be a sub-token of "+a);try{c(d,e)}catch(O){b.error("ApiImplementationV1.setProcessCallback","Exception in process callback:",O)}}else{h=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR);l=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT);
var n=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS);h?g.procTokenStat[f]=module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR:l?g.procTokenStat[f]=module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT:n&&(g.procTokenStat[f]=module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS);g.procTokens.every(function(a){return g.procTokenStat.hasOwnProperty(a)})&&
(b.debug("ApiImplementationV1.setProcessCallback","Clearing process callback for token "+a),b.clearProcessCallback(a));try{c(d,e)}catch(O){b.error("ApiImplementationV1.setProcessCallback","Exception in process callback:",O)}}}else b.warn("ApiImplementationV1.setProcessCallback","Message for unknown token:",e)});u[a]={subToken:d,procTokens:[a],procTokenStat:{}};return a}};this.setRotateSpeed=function(a){a=r.updateSetting("camera.rotationSpeed",a);return l("setRotateSpeed",a)};this.setRotationSpeed=
function(a){return b.setRotateSpeed(a)};this.setZoomExtentFactor=function(a){a=r.updateSetting("camera.zoomExtentsFactor",a);return l("setZoomExtentFactor",a)};this.setZoomSpeed=function(a){a=r.updateSetting("camera.zoomSpeed",a);return l("setZoomSpeed",a)};this.showControls=function(){b.error("ApiImplementationV1.showControls","Requires UI");return l("showControls",!1)};this.showEdges=function(){b.warn("ApiImplementationV1.showEdges","Not implemented");return l("showEdges",!1)};this.showFullscreenToggle=
function(){b.error("ApiImplementationV1.showFullscreenToggle","Requires UI");return!1};this.showGrid=function(a){"boolean"!==typeof a&&(a=!0);if(r.getSettingShallow("gridVisibility")==a)return l("showGrid",!1);a=r.updateSetting("gridVisibility",a);return l("showGrid",a)};this.showGroundPlane=function(a){"boolean"!==typeof a&&(a=!0);if(r.getSettingShallow("groundPlaneVisibility")==a)return l("showGroundPlane",!1);a=r.updateSetting("groundPlaneVisibility",a);return l("showGroundPlane",a)};this.showShadows=
function(a){"boolean"!==typeof a&&(a=!0);if(r.getSettingShallow("render.shadows")==a)return l("showShadows",!1);a=r.updateSetting("render.shadows",a);return l("showShadows",a)};this.showStaticMesh=function(a,b){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")||0===a.length||!module$src$shared$util$GlobalUtils.default.typeCheck(b,"boolean"))return!1;var c=q.scene.get({id:a},t);if(c.err||1!==c.data.length)return!1;q.scene.updateAsync({id:a,visible:b},t);return!0};this.showZoomToggle=
function(){b.error("ApiImplementationV1.showZoomToggle","Requires UI");return!1};this.toggleDisablePan=function(){var a=r.getSettingShallow("camera.enablePan");return r.updateSetting("camera.enablePan",!a)};this.toggleDisableZoom=function(){var a=r.getSettingShallow("camera.enableZoom");a=r.updateSetting("camera.enableZoom",!a);return l(a)};this.toggleFullscreen=function(a){var b=r.getSettingShallow("fullscreen");if("boolean"!==typeof a)a=!b;else if(a===b)return!1;return r.updateSetting("fullscreen",
a)};this.toggleSceneBackground=function(a){"boolean"!==typeof a&&(a=!0);return r.updateSetting("material.environmentMapAsBackground",a)};this.toggleShadows=function(){var a=r.getSettingShallow("render.shadows");return r.updateSetting("render.shadows",!a)};this.toggleTopView=function(){var a=r.getSettingShallow("camera.type")===module$src$3d$viewports$default$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE?module$src$3d$viewports$default$ThreeDManagerConstants.default.cameraViewTypes.TOP:
module$src$3d$viewports$default$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE;return r.updateSetting("camera.type",a)};this.zoomExt=function(a){return b.zoomExtents(a)};this.zoomExtents=function(a,b){var c={duration:0};void 0===a&&(a=!0);a&&(c.duration=b?b:800);r.cameraHandler.zoomExtents(c);return!0};return this};var module$src$app$handlers$SettingsHandler={},GLOBAL_UTILS$$module$src$app$handlers$SettingsHandler=module$src$shared$util$GlobalUtils.default,TO_TINY_COLOR$$module$src$app$handlers$SettingsHandler=module$src$shared$util$toTinyColor.default,viewerAppConstants$$module$src$app$handlers$SettingsHandler=module$src$app$ViewerAppConstants.default,messagingConstants$$module$src$app$handlers$SettingsHandler=module$src$shared$constants$MessagingConstants.default,pluginConstantsGlobal$$module$src$app$handlers$SettingsHandler=
module$src$shared$constants$PluginConstantsGlobal.default,MessagePrototype$$module$src$app$handlers$SettingsHandler=module$src$shared$messages$MessagePrototype.default;
module$src$app$handlers$SettingsHandler.default=function(a){var b=this,c=a.pluginManager,g=a.parameterManager,d=a.exportManager,f=a.viewportManager;a=a.app;var p={},e=!1,m,h={},r=function(a){var b={};if(a){if(a.lightHandler){var c=function(b,c){b=a.getSetting(b);if(b.type===c&&(c=b.properties))return c=c.intensity,module$src$shared$util$GlobalUtils.default.typeCheck(c,"number")?c.toString():"1.0"};b.ambientIntensity={handler:function(b){var c=a.getSetting("lights.light1");if(!c)return Promise.resolve(!0);
c.properties.intensity=parseFloat(b);return a.updateSettingAsync("lights.light1",c)},handlerInverse:function(){return c("lights.light1",0)},order:10};b.spotlightIntensity={handler:function(b){var c=a.getSetting("lights.light2");if(!c)return Promise.resolve(!0);c.properties.intensity=parseFloat(b);return a.updateSettingAsync("lights.light2",c)},handlerInverse:function(){return c("lights.light2",1)},order:20}}b.ambientOcclusion={handler:a,setting:"render.ambientOcclusion",type:"boolean",order:40};b.autoRotateSpeed=
{handler:a,setting:"camera.autoRotationSpeed",type:"number",hook:function(a){return 0!=a?[["enableAutoRotation",!0]]:[]},order:50};b.backgroundColor={type:function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")&&10===a.length},hook:function(a){a=(0,module$src$shared$util$toTinyColor.default)(a);return[["clearColor",a.toHexString()],["clearAlpha",a.getAlpha()]]},handlerInverse:function(){var b=a.getSetting("render.clearColor"),c=a.getSetting("render.clearAlpha");b=(0,module$src$shared$util$toTinyColor.default)(b);
b.setAlpha(c);return"0x"+b.toHex8()},order:60};b.cameraAutoAdjust={handler:a,setting:"camera.autoAdjust",type:"boolean",order:80};b.cameraMovementDuration={handler:a,setting:"camera.cameraMovementDuration",type:"number",order:90};b.cameraRevertAtMouseUp={handler:a,setting:"camera.revertAtMouseUp",type:"boolean",order:100};b.revertAtMouseUpDuration={handler:a,setting:"camera.revertAtMouseUpDuration",type:"number",order:110};b.clearAlpha={handler:a,setting:"render.clearAlpha",type:"number",order:120};
b.clearColor={handler:a,setting:"render.clearColor",type:"string",order:130};b.controlDamping={handler:a,setting:"camera.damping",type:"number",order:140};b.disablePan={handler:a,setting:"camera.enablePan",type:"boolean",transform:function(a){return!a},handlerInverse:function(){return!a.getSetting("camera.enablePan")},order:150};b.disableZoom={handler:a,setting:"camera.enableZoom",type:"boolean",transform:function(a){return!a},handlerInverse:function(){return!a.getSetting("camera.enableZoom")},order:160};
b.enableAutoRotation={handler:a,setting:"camera.enableAutoRotation",type:"boolean",order:170};b.environmentMapResolution={handler:a,setting:"material.environmentMapResolution",type:function(a){return["256","512","1024","2048"].includes(a)},order:180};b.environmentMap={handler:a,setting:"material.environmentMap",type:function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")||module$src$shared$util$GlobalUtils.default.isArrayOfType(a,"string")},order:190};b.fov={handler:a,
setting:"camera.fov",type:"number",order:200};b.pointSize={handler:a,setting:"render.pointSize",type:function(a){return"number"===typeof a&&0<=a},order:210};b.rotateSpeed={handler:a,setting:"camera.rotationSpeed",type:"number",order:220};b.showEnvironmentMap={handler:a,setting:"material.environmentMapAsBackground",type:"boolean",order:230};b.showGrid={handler:a,setting:"gridVisibility",type:"boolean",order:240};b.showGroundPlane={handler:a,setting:"groundPlaneVisibility",type:"boolean",order:250};
b.showShadows={handler:a,setting:"render.shadows",type:"boolean",order:260};b.zoomExtentFactor={handler:a,setting:"camera.zoomExtentsFactor",type:"number",order:270};b.zoomSpeed={handler:a,setting:"camera.zoomSpeed",type:"number",order:280};b.panSpeed={handler:a,setting:"camera.panSpeed",type:"number",order:290};b.enableRotation={handler:a,setting:"camera.enableRotation",type:"boolean",order:300};b.topView={handler:function(b){return a.constants.cameraViewTypes?a.updateSettingAsync("camera.type",
b?a.constants.cameraViewTypes.TOP:a.constants.cameraViewTypes.PERSPECTIVE):null},handlerInverse:function(){var b=a.getSetting("camera.type");return a.constants.cameraViewTypes?b===a.constants.cameraViewTypes.TOP?!0:!1:!1},order:310};b.camera={handler:a,setting:"camera.defaults.perspective",type:"object",handlerInverse:function(){return a.getSetting("camera.type")===a.constants.cameraViewTypes.PERSPECTIVE?a.cameraHandler.getPositionAndTarget():a.getSetting("camera.defaults.perspective")},order:320};
b.cameraOrtho={handler:a,setting:"camera.defaults.orthographic",type:"object",handlerInverse:function(){return a.getSetting("camera.type")===a.constants.cameraViewTypes.TOP?a.cameraHandler.getPositionAndTarget():a.getSetting("camera.defaults.orthographic")},order:325};b.directUpdates={handler:function(){return!0}};b.directionallight2Intensity={handler:function(){return!0}};b.edgeColor={handler:function(){return!0}};b.edgeColorByObject={handler:function(){return!0}};b.showEdges={handler:function(){return!0}};
b.build_version={handler:function(){return!0}};b.build_date={handler:function(){return!0}}}return b};h.controlOrder={handler:function(){return!0}};h.controlNames={handler:function(){return!0}};h.parametersHidden={handler:function(){return!0}};h.version={handler:function(a){},order:500};a&&(h.defaultMaterialColor={handler:a,setting:"defaultMaterial.color",type:function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"color")},transform:function(a){return(0,module$src$shared$util$toTinyColor.default)(a).toArray()},
order:510},h.bumpAmplitude={handler:a,setting:"defaultMaterial.bumpAmplitude",type:"number",order:520},h.commitParameters={handler:a,setting:"commitParameters",type:"boolean",order:530});p.getStoredSetting=function(a){return e?module$src$shared$util$GlobalUtils.default.deepCopy(module$src$shared$util$GlobalUtils.default.getAtPath(e,a)):!1};p.hasStoredSetting=function(a){return e?void 0!==module$src$shared$util$GlobalUtils.default.getAtPath(e,a):!1};p.restoreSetting=function(a,c,d){if(d.hasOwnProperty(a)){var f=
d[a];if(f.hasOwnProperty("handler")&&"function"===typeof f.handler){var g=f.handler(c);return g instanceof Promise?g:Promise.resolve(g)}if(void 0===f.handler||"object"!==typeof f.handler||!module$src$shared$util$GlobalUtils.default.typeCheck(f.setting,"string")||0>=f.setting.length||!f.handler.hasOwnProperty("updateSettingAsync")){if(f.hasOwnProperty("hook")&&"function"===typeof f.hook)return g=f.hook(c),Promise.all(g.map(function(a){return p.restoreSetting(a[0],a[1],d)}));b.debug("SettingsHandler.restoreSetting",
"Mapping for property "+a+" not configured correctly",f);return Promise.resolve(!1)}if(void 0!==f.type&&null!==f.type)if(module$src$shared$util$GlobalUtils.default.typeCheck(f.type,"string")){if(typeof c!==f.type)if(module$src$shared$util$GlobalUtils.default.typeCheck(c,"string")&&"number"===f.type){if(c=parseFloat(c),Number.isNaN(c))return b.warn("SettingsHandler.restoreSetting","Not restoring setting "+a+" due to NaN",e[a]),Promise.resolve(!1)}else return b.warn("SettingsHandler.restoreSetting",
"Not restoring setting "+a+" due to unexpected data type",e[a]),Promise.resolve(!1)}else if("function"===typeof f.type&&!f.type(c))return b.warn("SettingsHandler.restoreSetting","Not restoring setting "+a+" due to unexpected data type",e[a]),Promise.resolve(!1);f.hasOwnProperty("transform")&&"function"===typeof f.transform&&(c=f.transform(c));return f.handler.updateSettingAsync(f.setting,c).then(function(g){if(!g)b.warn("SettingsHandler.restoreSetting","Setting "+a+" could not be restored",e[a]);
else if(f.hasOwnProperty("hook")&&"function"===typeof f.hook)return g=f.hook(c),Promise.all(g.map(function(a){return p.restoreSetting(a[0],a[1],d)}));return g},function(c){b.warn("SettingsHandler.restoreSetting","Setting "+a+" could not be restored",e[a],c);return!1})}b.warn("SettingsHandler.restoreSetting","Unknown setting "+a);return Promise.resolve(!1)};p.restoreSettings=function(a){if(void 0===e||"object"!==typeof e)return!1;var c=[];if(a){Array.isArray(a)||(a=[a]);for(var d=0,g=a.length;d<g;d++)a[d].restoredSettings||
(a[d].restoredSettings=!0,c.push(r(a[d])))}else c=[h];var l=Promise.resolve(!0),m=!0;d={};g=0;for(var q=c.length;g<q;d={current_mapping:d.current_mapping},g++){d.current_mapping=c[g];var w=[],y;for(y in e)d.current_mapping.hasOwnProperty(y)&&w.push({prop:y,order:d.current_mapping[y].order||0});w.sort(function(a,b){return a.order-b.order});w.forEach(function(a){return function(c){var d=e[c.prop];l=l.then(function(b){b||(m=!1);return p.restoreSetting(c.prop,d,a.current_mapping)},function(e){b.error("SettingsHandler.restoreSettings",
e);m=!1;return p.restoreSetting(c.prop,d,a.current_mapping)})}}(d))}a||(l=l.then(function(a){a||(m=!1);return p.restoreSettings(f.getThreeDManagers())},function(a){b.error("SettingsHandler.restoreSettings",a);m=!1;return p.restoreSettings(f.getThreeDManagers())}));return l.then(function(){return m})};p.saveSettings=function(a){if(module$src$shared$util$GlobalUtils.default.typeCheck(a,"string"))var b=c.getPluginByRuntimeId(a);else m&&m.plugin&&(b=c.getPluginByRuntimeId(m.plugin))&&!b.getCapabilities().includes(module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities.SETTINGS)&&
(b=void 0),b||(b=c.getPluginByCapabilities(module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities.SETTINGS));if(!b||!module$src$shared$util$GlobalUtils.default.typeCheck(b.saveSettings,"function"))return Promise.resolve(!1);var e=p.getCurrentSettingsObject();if(!e)return Promise.resolve(!1);var f=g.getConfig(b.getRuntimeId());Object.keys(f).forEach(function(a){e.hasOwnProperty(a)?e[a]=[].concat($jscomp.arrayFromIterable(e[a]),$jscomp.arrayFromIterable(f[a])):e[a]=f[a]});var h=
d.getConfig(b.getRuntimeId());Object.keys(h).forEach(function(a){e.hasOwnProperty(a)?e[a]=[].concat($jscomp.arrayFromIterable(e[a]),$jscomp.arrayFromIterable(h[a])):e[a]=h[a]});e.hasOwnProperty("controlNames")&&(a=e.controlNames,e.controlNames={},a.forEach(function(a){return e.controlNames[a.id]=a.name}));e.hasOwnProperty("controlOrder")&&(e.controlOrder.sort(function(a,b){return a.order-b.order}),e.controlOrder=e.controlOrder.map(function(a){return a.id}));return b.saveSettings(e).then(function(){return!0})};
p.messageReceiver=function(a,c,d,f){e||d!==module$src$app$ViewerAppConstants.default.messageDataTypes.APP_SETTINGS||(e=c,m=f,p.restoreSettings().then(function(){var a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC,{});b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SETTINGS_REGISTERED,a)}),b.updateSetting("hasRestoredSettings",!0))};p.getCurrentSettingsObject=function(a){var c={},
d;c.version=b.getSetting("build_version");c.build_version=b.getSetting("build_version");c.build_date=b.getSetting("build_date");var e=[];a||(e=[h],a=f.getThreeDManagers());Array.isArray(a)||(a=[a]);var g=0;for(var m=a.length;g<m;g++)e.push(r(a[g]));e.reverse();m=0;for(var p=e.length;m<p;m++){var q=e[m];for(d in q){var y=q[d];a=y.handler;g=y.handlerInverse;y=y.setting;module$src$shared$util$GlobalUtils.default.typeCheck(g,"function")?c[d]=g():module$src$shared$util$GlobalUtils.default.typeCheck(y,
"string")&&a&&module$src$shared$util$GlobalUtils.default.typeCheck(a.getSetting,"function")&&(c[d]=a.getSetting(y))}}return c};return p};var module$src$app$conf$DispatchingConstants={},callbackParamTypes$$module$src$app$conf$DispatchingConstants={TYPE:"type",DATA:"data",TOKEN:"token",ORIGIN:"origin",TOPIC:"topic",PLUGIN:"plugin"},callbackParamTypesDefault$$module$src$app$conf$DispatchingConstants=[callbackParamTypes$$module$src$app$conf$DispatchingConstants.TOKEN,callbackParamTypes$$module$src$app$conf$DispatchingConstants.DATA,callbackParamTypes$$module$src$app$conf$DispatchingConstants.TYPE,callbackParamTypes$$module$src$app$conf$DispatchingConstants.ORIGIN],
dispatchingConstants$$module$src$app$conf$DispatchingConstants={callbackParamTypes:callbackParamTypes$$module$src$app$conf$DispatchingConstants,callbackParamTypesDefault:callbackParamTypesDefault$$module$src$app$conf$DispatchingConstants},GlobalUtils$$module$src$app$conf$DispatchingConstants=module$src$shared$util$GlobalUtils.default;module$src$app$conf$DispatchingConstants.default=module$src$shared$util$GlobalUtils.default.deepCopy(dispatchingConstants$$module$src$app$conf$DispatchingConstants);var module$src$app$conf$DispatchingConfig={},GlobalUtils$$module$src$app$conf$DispatchingConfig=module$src$shared$util$GlobalUtils.default;module$src$app$conf$DispatchingConfig.default=function(){var a={};this.getConfig=function(){return a};this.addPartListener=function(b,c,g,d){a.hasOwnProperty(b)&&"object"===typeof a[b]||(a[b]={});b=a[b];b.hasOwnProperty("partListeners")&&Array.isArray(b.partListeners)||(b.partListeners=[]);var f={};f.type=c;f.cb=g;f.params=d;b.partListeners.push(f);return!0}};var module$src$app$conf$DefaultDispatching={},messagingConstants$$module$src$app$conf$DefaultDispatching=module$src$shared$constants$MessagingConstants.default,dispatchingConstants$$module$src$app$conf$DefaultDispatching=module$src$app$conf$DispatchingConstants.default,DispatchingConfig$$module$src$app$conf$DefaultDispatching=module$src$app$conf$DispatchingConfig.default;
module$src$app$conf$DefaultDispatching.default=function(a){var b=new module$src$app$conf$DispatchingConfig.default;b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PARAMETER_REGISTER,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_DEFINITION,a.parameterManager.registerMultipleParameters,[module$src$app$conf$DispatchingConstants.default.callbackParamTypes.DATA,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.PLUGIN,
module$src$app$conf$DispatchingConstants.default.callbackParamTypes.TOKEN]);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PARAMETER_REGISTER,module$src$shared$constants$MessagingConstants.default.messageDataTypes.APP_SETTINGS,a.parameterManager.registerConfig,[module$src$app$conf$DispatchingConstants.default.callbackParamTypes.DATA,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.PLUGIN,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.TOKEN]);
b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_REGISTER,module$src$shared$constants$MessagingConstants.default.messageDataTypes.APP_SETTINGS,a.exportManager.registerConfig,[module$src$app$conf$DispatchingConstants.default.callbackParamTypes.DATA,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.PLUGIN,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.TOKEN]);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PLUGIN_ACTIVE,
module$src$shared$constants$MessagingConstants.default.messageDataTypes.PLUGIN_RUNTIME_ID,a.parameterManager.refreshPluginInitial,[module$src$app$conf$DispatchingConstants.default.callbackParamTypes.PLUGIN,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.TOKEN]);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_REGISTER,module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_DEFINITION,a.exportManager.registerMultipleExports,
[module$src$app$conf$DispatchingConstants.default.callbackParamTypes.DATA,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.PLUGIN,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.TOKEN]);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_INIT,module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_INIT,a.sceneManager.initSubScene,[module$src$app$conf$DispatchingConstants.default.callbackParamTypes.DATA,
module$src$app$conf$DispatchingConstants.default.callbackParamTypes.PLUGIN,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.TOKEN]);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_OUTPUTVERSION,module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_OUTPUTVERSION_JSON,a.sceneManager.addJSONOutputVersionToSubScene,[module$src$app$conf$DispatchingConstants.default.callbackParamTypes.DATA,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.PLUGIN,
module$src$app$conf$DispatchingConstants.default.callbackParamTypes.TOKEN]);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_OUTPUTVERSION,module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_OUTPUTVERSION_OBJ,a.sceneManager.addOutputVersionToSubScene,[module$src$app$conf$DispatchingConstants.default.callbackParamTypes.DATA,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.PLUGIN,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.TOKEN]);
b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,a.processStatusHandler.updateProcessStatus);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS,a.processStatusHandler.unregisterProcess);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,
module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT,a.processStatusHandler.unregisterProcess);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,a.processStatusHandler.unregisterProcess);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_FORK,
a.processStatusHandler.forkProcessStatus);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,a.viewportVisibilityHandler.messageReceiver);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS,a.viewportVisibilityHandler.messageReceiver);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,
module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,a.viewportVisibilityHandler.messageReceiver);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_FORK,a.processStatusHandler.forkProcessStatus);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.SETTINGS_REGISTER,module$src$shared$constants$MessagingConstants.default.messageDataTypes.APP_SETTINGS,
a.settingsHandler.messageReceiver);return b.getConfig()};var module$src$app$ViewerApp={},viewerAppConstants$$module$src$app$ViewerApp=module$src$app$ViewerAppConstants.default;
module$src$app$ViewerApp.default=function(a){var b=this;module$src$shared$mixins$GlobalMixin.default.call(this);module$src$shared$mixins$SettingsMixin.default.call(this,a,module$src$app$ViewerAppConstants.default.defaultSettings,"app");module$src$shared$mixins$LoggingMixin.default.call(this);module$src$app$partials$ViewerAppLoggingPartial.default.call(this);var c={error:b.error,warn:b.warn,info:b.info,debug:b.debug,log:b.log};THREE.Extensions.Logger.bind(c);THREE.Extensions.Settings.bind({debug:function(){return!1},
allowedCachedPrograms:function(){return 50}});module$src$shared$mixins$MessagingMixin.default.call(this);module$src$app$partials$ViewerAppMessagingPartial.default.call(this);this.pluginManager=module$src$app$partials$ViewerAppPluginManager.default.call(b);this.parameterManager=module$src$app$partials$ViewerAppParameterManager.default.call(b,{pluginManager:b.pluginManager});this.exportManager=module$src$app$partials$ViewerAppExportManager.default.call(b,{pluginManager:b.pluginManager,parameterManager:b.parameterManager});
this.interactionGroupManager=new module$src$3d$InteractionGroupManager.default;this.viewportManager=new module$src$3d$ViewportManager.default(b,c,b.interactionGroupManager);this.sceneGeometryManager=new module$src$3d$SceneGeometryManager.default(b.viewportManager,{loggingHandler:c,messagingHandler:{message:b.message,subscribeToMessageStream:b.subscribeToMessageStream,unsubscribeFromMessageStream:b.unsubscribeFromMessageStream}});this.viewportVisibilityHandler=module$src$app$handlers$ViewportVisibilityHandler.default.call(b,
{viewportManager:b.viewportManager,sceneGeometryManager:b.sceneGeometryManager});this.getContainer=function(){var a=b.viewportManager.getContainers();return 1===a.length?a[0]:a};this.sceneManager=module$src$app$partials$ViewerAppSceneManager.default.call(b,{sceneGeometryManager:b.sceneGeometryManager});this.processStatusHandler=module$src$app$handlers$ProcessStatusHandler.default.call(b,{viewportManager:b.viewportManager});!0===this.getSetting("arkitbridge")&&(this.arApi=(0,module$src$ar$ArApiARKit.default)({viewportManager:b.viewportManager,
apiResponse:module$src$api$v2$ApiResponse.default,sceneGeometryManager:b.sceneGeometryManager,settings:b.getSection("ar"),container:a.container,loggingHandler:c}));this.api=function(a){a=a||{version:1};return!a.version||2!==a.version&&"2"!==a.version?new module$src$api$v1$ApiImplementationV1.default({exportHandler:b.exportManager,parameterHandler:b.parameterManager,pluginHandler:b.pluginManager,processStatusHandler:b.processStatusHandler,sceneManager:b.sceneManager,settingsHandler:b.settingsHandler,
threeDManager:b.viewportManager.getFirstDefaultThreeDManager(),viewportVisibilityHandler:b.viewportVisibilityHandler,messagingHandler:{message:b.message,subscribeToMessageStream:b.subscribeToMessageStream,unsubscribeFromMessageStream:b.unsubscribeFromMessageStream,getFailedStatusMessages:b.getFailedStatusMessages},loggingHandler:c,app:b},a):new module$src$api$v2$ApiImplementationV2_1.default({exportHandler:b.exportManager,parameterHandler:b.parameterManager,pluginHandler:b.pluginManager,processStatusHandler:b.processStatusHandler,
sceneManager:b.sceneManager,settingsHandler:b.settingsHandler,viewportManager:b.viewportManager,sceneGeometryManager:b.sceneGeometryManager,interactionGroupManager:b.interactionGroupManager,arApi:b.arApi,messagingHandler:{message:b.message,subscribeToMessageStream:b.subscribeToMessageStream,unsubscribeFromMessageStream:b.unsubscribeFromMessageStream,getFailedStatusMessages:b.getFailedStatusMessages},loggingHandler:c,app:b},a)};a.container&&b.viewportManager.createThreeDManager(a.container);this.settingsHandler=
module$src$app$handlers$SettingsHandler.default.call(b,{viewportManager:b.viewportManager,parameterManager:b.parameterManager,exportManager:b.exportManager,pluginManager:b.pluginManager,app:b});this.setupDispatching(module$src$app$conf$DefaultDispatching.default.call(b,{parameterManager:b.parameterManager,exportManager:b.exportManager,pluginManager:b.pluginManager,sceneManager:b.sceneManager,processStatusHandler:b.processStatusHandler,viewportVisibilityHandler:b.viewportVisibilityHandler,settingsHandler:b.settingsHandler}));
this.viewportVisibilityHandler.init();a.build_version&&a.build_date&&("number"===typeof a.brandedModeConsole?console.log((1===a.brandedModeConsole?"SD":"ShapeDiver")+" Viewer App "+a.build_version+", built "+a.build_date):console.log("%cShapeDiver Viewer App "+a.build_version+"           \n%c"+a.build_date+"\n\n%cWe're hiring: https://shapediver.com/jobs","font-size:16px; font-weight:200; letter-spacing:0.02em; line-height:1.4em; font-family:helvetica,arial; color: #0a12c6; background:url(https://s3.amazonaws.com/wp-shapediver-content/static/images/logomark_gradient%40400x17.png) no-repeat; display: block; background-size: 400px 17px; background-position: right bottom;",
"font-size:10px; font-weight:200; letter-spacing:0.02em; line-height:1.4em; font-family:helvetica,arial; color: #be47fd;","font-size:12px; font-weight:200; letter-spacing:0.02em; line-height:1.4em; font-family:helvetica,arial; color: #0a12c6;"));return this};var module$build$package={},GLOBAL_UTILS$$module$build$package=module$src$shared$util$GlobalUtils.default,BUILD_DATA$$module$build$package=module$build$build_data.default,API_REFLECTOR$$module$build$package=module$src$api$v2$ApiReflectorV2_1.default,RUNNING_IN_BROWSER$$module$build$package=module$src$shared$util$GlobalUtils.default.runningInBrowser(),RUNNING_IN_IFRAME$$module$build$package=module$src$shared$util$GlobalUtils.default.runningInIframe(),SETTING_DEFINITIONS$$module$build$package={anchorElements:{type:"boolean",
defval:RUNNING_IN_BROWSER$$module$build$package},authorization:{type:"string",defval:""},arkitbridge:{type:"boolean",defval:!1},brandedMode:{type:"boolean",defval:!0},busyGraphic:{type:"string",defval:null},createButtons:{type:"boolean",defval:!0},editMode:{type:"boolean",defval:!1},commitParameters:{type:"boolean",defval:!1},exportModal:{type:"boolean",defval:!0},showControlsButton:{type:"boolean",defval:!0},showControlsInitial:{type:"boolean",defval:!1},showSettingsButton:{type:"boolean",defval:!0},
showSettingsInitial:{type:"boolean",defval:!1},showZoomButton:{type:"boolean",defval:!0},zoomButtonResetsCamera:{type:"boolean",defval:!1},showFullscreenButton:{type:"boolean",defval:!0},showInitialSpinner:{type:"boolean",defval:!0},showBusySpinner:{type:"boolean",defval:!0},viewportOverlays:{type:"boolean",defval:!0},apiversion:{type:"string",defval:"2"},runtimeId:{type:"string",defval:""},blurSceneWhenBusy:{type:"boolean",defval:!0},deferGeometryLoading:{type:"boolean",defval:!1},ignoreSuperseded:{type:"boolean",
defval:!0},exposeViewer:{type:"boolean",defval:!1},loggingLevel:{type:"number",defval:-1},messageLoggingLevel:{type:"number",defval:-1},iframeDebugging:{type:"boolean",defval:!1},modelViewUrl:{type:"string",defval:""},showSceneMode:{type:"number",defval:2},ticket:{type:"string",defval:""},iframeId:{type:"string",defval:"sdv-iframe"},commPluginRuntimeId:{type:"string",defval:"CommPlugin_1"}},ParametricViewer$$module$build$package=function(){var a=this;this.constants=module$src$app$ViewerAppConstants.default;
this.plugins={runtimeIds:[]};this.plugins.CommPlugin=module$src$plugins$comm$CommPlugin.default;this.plugins.PluginPrototype=module$src$plugins$PluginPrototype.default;this.apps={};this.apps.controls=module$src$api$apps$SDControls.default;this.apps.domElements=module$src$api$apps$DomElementManager.default;this.apps.overlays=module$src$api$apps$UIkitViewportOverlays.default;this.apps.exportModal=module$src$api$apps$UIkitExportModal.default;this.utils=module$src$shared$util$GlobalUtils.default;this.getBuildData=
function(){return module$src$shared$util$GlobalUtils.default.deepCopy(module$build$build_data.default)};this.ParametricViewer=function(b){b=b||{};if(RUNNING_IN_IFRAME$$module$build$package&&(b.useQueryStringParameters||b.forceQueryStringParameters)){var c=module$src$shared$util$GlobalUtils.default.parseQueryString(window.location.search.substring(1));Object.keys(c).forEach(function(a){if(SETTING_DEFINITIONS$$module$build$package.hasOwnProperty(a)&&(b.forceQueryStringParameters||!b.hasOwnProperty(a))){var d=
SETTING_DEFINITIONS$$module$build$package[a];b[a]="boolean"===d.type?module$src$shared$util$GlobalUtils.default.toBoolean(c[a],d.defval):"number"===d.type?module$src$shared$util$GlobalUtils.default.toNumber(c[a],d.defval):c[a]}})}b.domElementIdPrefix=b.domElementIdPrefix||"sdv-container";if(RUNNING_IN_BROWSER$$module$build$package){b.container||(b.container=document.getElementById(b.domElementIdPrefix+"-viewport"));!b.container&&1<(b.logginglevel&3)&&console.log("No viewport container");b.containerControls=
b.containerControls||document.getElementById(b.domElementIdPrefix+"-controls");b.containerSettings=b.containerSettings||document.getElementById(b.domElementIdPrefix+"-settings");var g=b.container?Array.isArray(b.container)&&0<b.container.length?b.container[0].parentElement:b.container.parentElement:null,d=b.containerControls,f=b.containerSettings;if(g&&d&&f){var p=g.parentElement,e=f.parentElement;if(p===d.parentElement&&p===e&&null!==p){var m=[p,g,d,f];b.resizeHandler=function(){var a="landscape",
b="portrait",c=250,e=p.offsetWidth,g=0,h="landscape";"none"!==d.style.display&&(e-=c,g+=1);"none"!==f.style.display&&(e-=c,g+=1);p.offsetHeight>e&&(a="portrait",b="landscape",c=40+(1<g?89:178),h="portrait");m.forEach(function(c){c&&(c.classList.remove(b),c.classList.add(a))});d.style.flexBasis=c+"px";f.style.flexBasis=c+"px";c=new CustomEvent("viewer-resized",{detail:{mode:h,flexBasis:c}});f.dispatchEvent(c);d.dispatchEvent(c)};window.addEventListener("resize",b.resizeHandler);b.resizeHandler()}}}Object.keys(SETTING_DEFINITIONS$$module$build$package).forEach(function(a){if(!b.hasOwnProperty(a)){var c=
SETTING_DEFINITIONS$$module$build$package[a],d=a.toLowerCase();d=module$src$shared$util$GlobalUtils.default.getNodeAttribute(b.container,d,c.defval);b[a]="boolean"===c.type?module$src$shared$util$GlobalUtils.default.toBoolean(d,c.defval):"number"===c.type?module$src$shared$util$GlobalUtils.default.toNumber(d,c.defval):d}});if(1>b.showSceneMode||3<b.showSceneMode)b.showSceneMode=2;b.editMode||void 0!==b.showSettingsButton||(b.showSettingsButton=!1);for(var h in module$build$build_data.default)b[h]=
module$build$build_data.default[h];RUNNING_IN_IFRAME$$module$build$package&&document.referrer&&parent.postMessage({type:"sdv-DOMContentLoaded",iframeId:b.iframeId},document.referrer);var r=new module$src$app$ViewerApp.default(b),q=r.api({version:b.apiversion,runtimeId:b.runtimeId});q.apps={};q.getApiV2=function(a){a=a||{};a.version=2;return r.api(a)};b.exposeViewer&&(module$build$build_data.default.build_branch.startsWith("feature")||module$build$build_data.default.build_branch.startsWith("development"))&&
(q.getViewer=function(){console.warn("Direct access to the ShapeDiver Viewer is disabled for release builds.");return r});g=q;g.scene||(g=q.getApiV2());if(b.ticket){var t={runtimeId:b.commPluginRuntimeId,ticket:b.ticket,deferGeometryLoading:b.deferGeometryLoading,loggingLevel:b.loggingLevel,messageLoggingLevel:b.messageLoggingLevel,authorization:b.authorization,ignoreSuperseded:b.ignoreSuperseded};b.modelViewUrl&&(t.modelViewUrl=b.modelViewUrl);e=new a.plugins.CommPlugin(t);g.plugins.registerPluginAsync(e).then(function(c){RUNNING_IN_IFRAME$$module$build$package&&
document.referrer&&(c.err||c.data&&"failed"===c.data.status?parent.postMessage({type:"sdv-CommPluginFailed",runtimeId:t.runtimeId,iframeId:b.iframeId},document.referrer):(a.plugins.runtimeIds.push(t.runtimeId),parent.postMessage({type:"sdv-CommPluginLoaded",data:c.data,runtimeId:t.runtimeId,iframeId:b.iframeId},document.referrer)))},function(a){RUNNING_IN_IFRAME$$module$build$package&&document.referrer&&parent.postMessage({type:"sdv-CommPluginFailed",err:a,runtimeId:t.runtimeId,iframeId:b.iframeId},
document.referrer)})}if(b.viewportOverlays){var u={containerViewport:b.container,containerControls:b.containerControls,containerSettings:b.containerSettings,domElementIdPrefix:b.domElementIdPrefix};"brandedMode createButtons showControlsButton showSettingsButton showControlsInitial showSettingsInitial showZoomButton showFullscreenButton showInitialSpinner showBusySpinner viewportOverlays zoomButtonResetsCamera resizeHandler".split(" ").forEach(function(a){u[a]=b[a]});try{q.apps.overlays=new a.apps.overlays(g,
u),q.apps.overlays||q.warn("SDVApp.ParametricViewer","Viewport overlays could not be created, has UIkit been loaded ?")}catch(l){delete q.apps.overlays,q.warn("SDVApp.ParametricViewer","Exception when creating viewport overlays, has UIkit been loaded ?",l)}b.busyGraphic&&q.apps.overlays.setBusyGraphic(b.busyGraphic)}if(b.containerControls){e={editMode:b.editMode,commitParameters:b.commitParameters};q.apps.overlays&&(e.showMessage=q.apps.overlays.showMessage);try{q.apps.controls=new a.apps.controls(g,
b.containerControls,e,{onElementCreated:b.resizeHandler}),q.apps.controls||q.warn("SDVApp.ParametricViewer","Parameter controls could not be created.")}catch(l){delete q.apps.controls,q.warn("SDVApp.ParametricViewer","Exception when creating parameter controls",l)}}if(b.containerSettings)try{q.apps.settings=new a.apps.controls(g,b.containerSettings,{settings:!0},{onElementCreated:b.resizeHandler}),q.apps.settings||q.warn("SDVApp.ParametricViewer","Setting controls could not be created.")}catch(l){delete q.apps.settings,
q.warn("SDVApp.ParametricViewer","Exception when creating setting controls",l)}if(b.anchorElements)try{q.apps.domElements=new a.apps.domElements(g),q.apps.domElements||q.warn("SDVApp.ParametricViewer","Anchor elements app could not be created.")}catch(l){delete q.apps.domElements,q.warn("SDVApp.ParametricViewer","Exception when creating anchor elements app",l)}if(b.exportModal)try{q.apps.exportModal=new a.apps.exportModal(g,{domElementIdPrefix:b.domElementIdPrefix+"-modal-export"}),q.apps.exportModal||
q.warn("SDVApp.ParametricViewer","Modal dialog could not be created, has UIkit been loaded ?")}catch(l){delete q.apps.exportModal,q.warn("SDVApp.ParametricViewer","Exception when creating modal dialog",l)}var n=function(a){q.apps.overlays&&(a.setBusyGraphic=q.apps.overlays.setBusyGraphic,a.setBusyGraphicPosition=q.apps.overlays.setBusyGraphicPosition,a.hideControls=function(){q.apps.overlays.buttonOnClick("controls",!1);q.apps.overlays.toggleVisibility("controls",!1);a._callCommandResultCallback("hideControls",
!0)},a.hideFullscreenToggle=function(){q.apps.overlays.toggleVisibility("fullscreen",!1);return!0},a.hideZoomToggle=function(){q.apps.overlays.toggleVisibility("zoom",!1);return!0},a.showControls=function(){q.apps.overlays.buttonOnClick("controls",!0);q.apps.overlays.toggleVisibility("controls",!0);a._callCommandResultCallback("showControls",!0)},a.showFullscreenToggle=function(){q.apps.overlays.toggleVisibility("fullscreen",!0);return!0},a.showZoomToggle=function(){q.apps.overlays.toggleVisibility("zoom",
!0);return!0});return a};1===Number(b.apiversion)&&n(q);q.getApiV1=function(a){a=a||{};a.version=1;return n(r.api(a))};RUNNING_IN_IFRAME$$module$build$package&&document.referrer&&(g.apps||(g.apps=q.apps),(new module$src$api$v2$ApiReflectorV2_1.default(parent,document.referrer,b.iframeDebugging,b.iframeId)).reflect(g,"api").then(function(){b.iframeDebugging&&console.log("API object could be reflected")},function(){b.iframeDebugging&&console.log("API object could NOT be reflected")}),parent.postMessage({type:"sdv-ViewerLoaded",
iframeId:b.iframeId},document.referrer));return q};return this};module$build$package.default=new ParametricViewer$$module$build$package;var SDVApp=module$build$package.default;



//# sourceMappingURL=sdv.concat.min.js.map