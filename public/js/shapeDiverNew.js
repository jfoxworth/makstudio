(function(l,C){"object"===typeof exports&&"undefined"!==typeof module?C(exports):"function"===typeof define&&define.amd?define(["exports"],C):C(l.THREE={})})(this,function(l){function C(a,b){this.x=a||0;this.y=b||0}function I(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function ia(a,b,c,d){this._x=a||0;this._y=b||0;this._z=c||0;this._w=void 0!==d?d:1}function p(a,b,c){this.x=a||
0;this.y=b||0;this.z=c||0}function la(){this.elements=[1,0,0,0,1,0,0,0,1];0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function kb(a,b,c,d,e,f,g,h,k,m,q,n){ta.call(this,null,f,g,h,k,m,d,e,q,n);this.image={data:a,width:b,height:c};this.magFilter=void 0!==k?k:1003;this.minFilter=void 0!==m?m:1003;this.flipY=this.generateMipmaps=!1;this.unpackAlignment=1}function Va(a,b){this.min=void 0!==a?a:new p(Infinity,Infinity,Infinity);this.max=
void 0!==b?b:new p(-Infinity,-Infinity,-Infinity)}function za(a,b){this.center=void 0!==a?a:new p;this.radius=void 0!==b?b:0}function Pa(a,b){this.normal=void 0!==a?a:new p(1,0,0);this.constant=void 0!==b?b:0}function ld(a,b,c,d,e,f){this.planes=[void 0!==a?a:new Pa,void 0!==b?b:new Pa,void 0!==c?c:new Pa,void 0!==d?d:new Pa,void 0!==e?e:new Pa,void 0!==f?f:new Pa]}function G(a,b,c){return void 0===b&&void 0===c?this.set(a):this.setRGB(a,b,c)}function ca(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||
0;this.w=void 0!==d?d:1}function Qd(){function a(e,f){!1!==c&&(d(e,f),b.requestAnimationFrame(a))}var b=null,c=!1,d=null;return{start:function(){!0!==c&&null!==d&&(b.requestAnimationFrame(a),c=!0)},stop:function(){c=!1},setAnimationLoop:function(a){d=a},setContext:function(a){b=a}}}function Gf(a){function b(b,c){var d=b.array,e=b.dynamic?a.DYNAMIC_DRAW:a.STATIC_DRAW,h=a.createBuffer();a.bindBuffer(c,h);a.bufferData(c,d,e);b.onUploadCallback();c=a.FLOAT;d instanceof Float32Array?c=a.FLOAT:d instanceof
Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):d instanceof Uint16Array?c=a.UNSIGNED_SHORT:d instanceof Int16Array?c=a.SHORT:d instanceof Uint32Array?c=a.UNSIGNED_INT:d instanceof Int32Array?c=a.INT:d instanceof Int8Array?c=a.BYTE:d instanceof Uint8Array&&(c=a.UNSIGNED_BYTE);return{buffer:h,type:c,bytesPerElement:d.BYTES_PER_ELEMENT,version:b.version}}var c=new WeakMap;return{get:function(a){a.isInterleavedBufferAttribute&&(a=a.data);return c.get(a)},
remove:function(b){b.isInterleavedBufferAttribute&&(b=b.data);var d=c.get(b);d&&(a.deleteBuffer(d.buffer),c.delete(b))},update:function(d,e){d.isInterleavedBufferAttribute&&(d=d.data);var f=c.get(d);if(void 0===f)c.set(d,b(d,e));else if(f.version<d.version){var g=d,h=g.array,k=g.updateRange;a.bindBuffer(e,f.buffer);!1===g.dynamic?a.bufferData(e,h,a.STATIC_DRAW):-1===k.count?a.bufferSubData(e,0,h):0===k.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):
(a.bufferSubData(e,k.offset*h.BYTES_PER_ELEMENT,h.subarray(k.offset,k.offset+k.count)),k.count=-1);f.version=d.version}}}}function lb(a,b,c,d){this._x=a||0;this._y=b||0;this._z=c||0;this._order=d||lb.DefaultOrder}function Rd(){this.mask=1}function B(){Object.defineProperty(this,"id",{value:Hf++});this.uuid=Q.generateUUID();this.name="";this.type="Object3D";this.parent=null;this.children=[];this.up=B.DefaultUp.clone();var a=new p,b=new lb,c=new ia,d=new p(1,1,1);b.onChange(function(){c.setFromEuler(b,
!1)});c.onChange(function(){b.setFromQuaternion(c,void 0,!1)});Object.defineProperties(this,{position:{enumerable:!0,value:a},rotation:{enumerable:!0,value:b},quaternion:{enumerable:!0,value:c},scale:{enumerable:!0,value:d},modelViewMatrix:{value:new I},normalMatrix:{value:new la}});this.matrix=new I;this.matrixWorld=new I;this.matrixAutoUpdate=B.DefaultMatrixAutoUpdate;this.matrixWorldNeedsUpdate=!1;this.layers=new Rd;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.renderOrder=
0;this.userData={}}function Qa(){B.call(this);this.type="Camera";this.matrixWorldInverse=new I;this.projectionMatrix=new I}function Jb(a,b,c,d,e,f){Qa.call(this);this.type="OrthographicCamera";this.zoom=1;this.view=null;this.left=a;this.right=b;this.top=c;this.bottom=d;this.near=void 0!==e?e:.1;this.far=void 0!==f?f:2E3;this.updateProjectionMatrix()}function Wa(a,b,c,d,e,f){this.a=a;this.b=b;this.c=c;this.normal=d&&d.isVector3?d:new p;this.vertexNormals=Array.isArray(d)?d:[];this.color=e&&e.isColor?
e:new G;this.vertexColors=Array.isArray(e)?e:[];this.materialIndex=void 0!==f?f:0}function K(){Object.defineProperty(this,"id",{value:If+=2});this.uuid=Q.generateUUID();this.name="";this.type="Geometry";this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=
this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function P(a,b,c){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="";this.array=a;this.itemSize=b;this.count=void 0!==a?a.length/b:0;this.normalized=!0===c;this.dynamic=!1;this.updateRange={offset:0,count:-1};this.version=0}function qc(a,b,c){P.call(this,new Int8Array(a),b,c)}function rc(a,b,c){P.call(this,new Uint8Array(a),b,c)}function sc(a,b,c){P.call(this,new Uint8ClampedArray(a),
b,c)}function tc(a,b,c){P.call(this,new Int16Array(a),b,c)}function mb(a,b,c){P.call(this,new Uint16Array(a),b,c)}function uc(a,b,c){P.call(this,new Int32Array(a),b,c)}function nb(a,b,c){P.call(this,new Uint32Array(a),b,c)}function A(a,b,c){P.call(this,new Float32Array(a),b,c)}function vc(a,b,c){P.call(this,new Float64Array(a),b,c)}function Ae(){this.vertices=[];this.normals=[];this.colors=[];this.uvs=[];this.uvs2=[];this.groups=[];this.morphTargets={};this.skinWeights=[];this.skinIndices=[];this.boundingSphere=
this.boundingBox=null;this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function Be(a){if(0===a.length)return-Infinity;for(var b=a[0],c=1,d=a.length;c<d;++c)a[c]>b&&(b=a[c]);return b}function E(){Object.defineProperty(this,"id",{value:Jf+=2});this.uuid=Q.generateUUID();this.name="";this.type="BufferGeometry";this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;this.drawRange=
{start:0,count:Infinity};this.userData={}}function Kb(a,b,c,d,e,f){K.call(this);this.type="BoxGeometry";this.parameters={width:a,height:b,depth:c,widthSegments:d,heightSegments:e,depthSegments:f};this.fromBufferGeometry(new ob(a,b,c,d,e,f));this.mergeVertices()}function ob(a,b,c,d,e,f){function g(a,b,c,d,e,f,g,l,da,J,C){var r=f/da,v=g/J,z=f/2,w=g/2,x=l/2;g=da+1;var H=J+1,y=f=0,O,A,Fa=new p;for(A=0;A<H;A++){var B=A*v-w;for(O=0;O<g;O++)Fa[a]=(O*r-z)*d,Fa[b]=B*e,Fa[c]=x,m.push(Fa.x,Fa.y,Fa.z),Fa[a]=
0,Fa[b]=0,Fa[c]=0<l?1:-1,q.push(Fa.x,Fa.y,Fa.z),n.push(O/da),n.push(1-A/J),f+=1}for(A=0;A<J;A++)for(O=0;O<da;O++)a=u+O+g*(A+1),b=u+(O+1)+g*(A+1),c=u+(O+1)+g*A,k.push(u+O+g*A,a,c),k.push(a,b,c),y+=6;h.addGroup(t,y,C);t+=y;u+=f}E.call(this);this.type="BoxBufferGeometry";this.parameters={width:a,height:b,depth:c,widthSegments:d,heightSegments:e,depthSegments:f};var h=this;a=a||1;b=b||1;c=c||1;d=Math.floor(d)||1;e=Math.floor(e)||1;f=Math.floor(f)||1;var k=[],m=[],q=[],n=[],u=0,t=0;g("z","y","x",-1,-1,
c,b,a,f,e,0);g("z","y","x",1,-1,c,b,-a,f,e,1);g("x","z","y",1,1,a,c,b,d,f,2);g("x","z","y",1,-1,a,c,-b,d,f,3);g("x","y","z",1,-1,a,b,c,d,e,4);g("x","y","z",-1,-1,a,b,-c,d,e,5);this.setIndex(k);this.addAttribute("position",new A(m,3));this.addAttribute("normal",new A(q,3));this.addAttribute("uv",new A(n,2))}function wc(a,b,c,d){K.call(this);this.type="PlaneGeometry";this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};this.fromBufferGeometry(new pb(a,b,c,d));this.mergeVertices()}function pb(a,
b,c,d){E.call(this);this.type="PlaneBufferGeometry";this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};a=a||1;b=b||1;var e=a/2,f=b/2;c=Math.floor(c)||1;d=Math.floor(d)||1;var g=c+1,h=d+1,k=a/c,m=b/d,q=[],n=[],u=[],t=[];for(a=0;a<h;a++){var r=a*m-f;for(b=0;b<g;b++)n.push(b*k-e,-r,0),u.push(0,0,1),t.push(b/c),t.push(1-a/d)}for(a=0;a<d;a++)for(b=0;b<c;b++)e=b+g*(a+1),f=b+1+g*(a+1),h=b+1+g*a,q.push(b+g*a,e,h),q.push(e,f,h);this.setIndex(q);this.addAttribute("position",new A(n,3));this.addAttribute("normal",
new A(u,3));this.addAttribute("uv",new A(t,2))}function Aa(a){F.call(this);this.type="MeshBasicMaterial";this.color=new G(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.envMap=this.alphaMap=this.specularMap=null;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.lights=this.morphTargets=this.skinning=!1;this.setValues(a)}function Da(a){F.call(this);
this.type="ShaderMaterial";this.defines={};this.uniforms={};this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}";this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1;this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1};this.defaultAttributeValues=
{color:[1,1,1],uv:[0,0],uv2:[0,0]};this.index0AttributeName=void 0;this.uniformsNeedUpdate=!1;this.attributes=null;void 0!==a&&this.setValues(a)}function qb(a,b){this.origin=void 0!==a?a:new p;this.direction=void 0!==b?b:new p}function Ba(a,b,c){this.a=void 0!==a?a:new p;this.b=void 0!==b?b:new p;this.c=void 0!==c?c:new p}function ra(a,b){B.call(this);this.type="Mesh";this.geometry=void 0!==a?a:new E;this.material=void 0!==b?b:new Aa({color:16777215*Math.random()});this.drawMode=0;this.updateMorphTargets()}
function Kf(a,b,c,d){function e(a,c){b.buffers.color.setClear(a.r,a.g,a.b,c,d)}var f=new G(0),g=0,h,k,m;return{getClearColor:function(){return f},setClearColor:function(a,b){f.set(a);g=void 0!==b?b:1;e(f,g)},getClearAlpha:function(){return g},setClearAlpha:function(a){g=a;e(f,g)},render:function(b,d,u,t){d=d.background;null===d?e(f,g):d&&d.isColor&&(e(d,1),t=!0);(a.autoClear||t)&&a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil);d&&d.isCubeTexture?(void 0===m&&(m=new ra(new ob(1,1,1),
new Da({uniforms:rb.cube.uniforms,vertexShader:rb.cube.vertexShader,fragmentShader:rb.cube.fragmentShader,side:1,depthTest:!0,depthWrite:!1,fog:!1})),m.geometry.removeAttribute("normal"),m.geometry.removeAttribute("uv"),m.onBeforeRender=function(a,b,c){this.matrixWorld.copyPosition(c.matrixWorld)},c.update(m)),m.material.uniforms.tCube.value=d,b.push(m,m.geometry,m.material,0,null)):d&&d.isTexture&&(void 0===h&&(h=new Jb(-1,1,1,-1,0,1),k=new ra(new pb(2,2),new Aa({depthTest:!1,depthWrite:!1,fog:!1})),
c.update(k)),k.material.map=d,a.renderBufferDirect(h,null,k.geometry,k.material,k,null))}}}function Lf(a,b,c,d){var e;this.setMode=function(a){e=a};this.render=function(b,d){a.drawArrays(e,b,d);c.update(d,e)};this.renderInstances=function(f,g,h){if(d.isWebGL2)var k=a;else if(k=b.get("ANGLE_instanced_arrays"),null===k){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}k[d.isWebGL2?"drawArraysInstanced":
"drawArraysInstancedANGLE"](e,g,h,f.maxInstancedCount);c.update(h,e,f.maxInstancedCount)}}function Mf(a,b,c){function d(b){if("highp"===b){if(0<a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.HIGH_FLOAT).precision&&0<a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision)return"highp";b="mediump"}return"mediump"===b&&0<a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.MEDIUM_FLOAT).precision&&0<a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.MEDIUM_FLOAT).precision?"mediump":"lowp"}var e,f="undefined"!==
typeof WebGL2RenderingContext&&a instanceof WebGL2RenderingContext,g=void 0!==c.precision?c.precision:"highp",h=d(g);h!==g&&(console.warn("THREE.WebGLRenderer:",g,"not supported, using",h,"instead."),g=h);c=!0===c.logarithmicDepthBuffer;h=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS);var k=a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS),m=a.getParameter(a.MAX_TEXTURE_SIZE),q=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE),n=a.getParameter(a.MAX_VERTEX_ATTRIBS),u=a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS),
t=a.getParameter(a.MAX_VARYING_VECTORS),r=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS),l=0<k,p=f||!!b.get("OES_texture_float");return{isWebGL2:f,getMaxAnisotropy:function(){if(void 0!==e)return e;var c=b.get("EXT_texture_filter_anisotropic");return e=null!==c?a.getParameter(c.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:d,precision:g,logarithmicDepthBuffer:c,maxTextures:h,maxVertexTextures:k,maxTextureSize:m,maxCubemapSize:q,maxAttributes:n,maxVertexUniforms:u,maxVaryings:t,maxFragmentUniforms:r,
vertexTextures:l,floatFragmentTextures:p,floatVertexTextures:l&&p}}function Nf(){function a(){m.value!==d&&(m.value=d,m.needsUpdate=0<e);c.numPlanes=e;c.numIntersection=0}function b(a,b,d,e){var f=null!==a?a.length:0,g=null;if(0!==f){g=m.value;if(!0!==e||null===g){e=d+4*f;b=b.matrixWorldInverse;k.getNormalMatrix(b);if(null===g||g.length<e)g=new Float32Array(e);for(e=0;e!==f;++e,d+=4)h.copy(a[e]).applyMatrix4(b,k),h.normal.toArray(g,d),g[d+3]=h.constant}m.value=g;m.needsUpdate=!0}c.numPlanes=f;return g}
var c=this,d=null,e=0,f=!1,g=!1,h=new Pa,k=new la,m={value:null,needsUpdate:!1};this.uniform=m;this.numIntersection=this.numPlanes=0;this.init=function(a,c,g){var h=0!==a.length||c||0!==e||f;f=c;d=b(a,g,0);e=a.length;return h};this.beginShadows=function(){g=!0;b(null)};this.endShadows=function(){g=!1;a()};this.setState=function(c,h,k,t,r,l){if(!f||null===c||0===c.length||g&&!k)g?b(null):a();else{k=g?0:e;var n=4*k,q=r.clippingState||null;m.value=q;q=b(c,t,n,l);for(c=0;c!==n;++c)q[c]=d[c];r.clippingState=
q;this.numIntersection=h?this.numPlanes:0;this.numPlanes+=k}}}function Of(a){var b={};return{get:function(c){if(void 0!==b[c])return b[c];switch(c){case "WEBGL_depth_texture":var d=a.getExtension("WEBGL_depth_texture")||a.getExtension("MOZ_WEBGL_depth_texture")||a.getExtension("WEBKIT_WEBGL_depth_texture");break;case "EXT_texture_filter_anisotropic":d=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");
break;case "WEBGL_compressed_texture_s3tc":d=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case "WEBGL_compressed_texture_pvrtc":d=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:d=a.getExtension(c)}null===d&&console.warn("THREE.WebGLRenderer: "+c+" extension not supported.");return b[c]=d}}}function Pf(a,b,c){function d(a){var g=
a.target;a=e[g.id];null!==a.index&&b.remove(a.index);for(var k in a.attributes)b.remove(a.attributes[k]);g.removeEventListener("dispose",d);delete e[g.id];if(k=f[a.id])b.remove(k),delete f[a.id];c.memory.geometries--}var e={},f={};return{get:function(a,b){var f=e[b.id];if(f)return f;b.addEventListener("dispose",d);b.isBufferGeometry?f=b:b.isGeometry&&(void 0===b._bufferGeometry&&(b._bufferGeometry=(new E).setFromObject(a)),f=b._bufferGeometry);e[b.id]=f;c.memory.geometries++;return f},update:function(c){var d=
c.index,e=c.attributes;null!==d&&b.update(d,a.ELEMENT_ARRAY_BUFFER);for(var f in e)b.update(e[f],a.ARRAY_BUFFER);c=c.morphAttributes;for(f in c){d=c[f];e=0;for(var g=d.length;e<g;e++)b.update(d[e],a.ARRAY_BUFFER)}},getWireframeAttribute:function(c){var d=f[c.id];if(d)return d;d=[];var e=c.index,g=c.attributes;if(null!==e){e=e.array;g=0;for(var q=e.length;g<q;g+=3){var n=e[g+0],u=e[g+1],t=e[g+2];d.push(n,u,u,t,t,n)}}else for(e=g.position.array,g=0,q=e.length/3-1;g<q;g+=3)n=g+0,u=g+1,t=g+2,d.push(n,
u,u,t,t,n);d=new (65535<Be(d)?nb:mb)(d,1);b.update(d,a.ELEMENT_ARRAY_BUFFER);return f[c.id]=d}}}function Qf(a,b,c,d){var e,f,g;this.setMode=function(a){e=a};this.setIndex=function(a){f=a.type;g=a.bytesPerElement};this.render=function(b,d){a.drawElements(e,d,f,b*g);c.update(d,e)};this.renderInstances=function(h,k,m){if(d.isWebGL2)var q=a;else if(q=b.get("ANGLE_instanced_arrays"),null===q){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");
return}q[d.isWebGL2?"drawElementsInstanced":"drawElementsInstancedANGLE"](e,m,f,k*g,h.maxInstancedCount);c.update(m,e,h.maxInstancedCount)}}function Rf(a){var b={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:b,programs:null,autoReset:!0,reset:function(){b.frame++;b.calls=0;b.triangles=0;b.points=0;b.lines=0},update:function(c,d,e){e=e||1;b.calls++;switch(d){case a.TRIANGLES:b.triangles+=c/3*e;break;case a.TRIANGLE_STRIP:case a.TRIANGLE_FAN:b.triangles+=
e*(c-2);break;case a.LINES:b.lines+=c/2*e;break;case a.LINE_STRIP:b.lines+=e*(c-1);break;case a.LINE_LOOP:b.lines+=e*c;break;case a.POINTS:b.points+=e*c;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",d)}}}}function Sf(a,b){return Math.abs(b[1])-Math.abs(a[1])}function Tf(a){var b={},c=new Float32Array(8);return{update:function(d,e,f,g){var h=d.morphTargetInfluences,k=h.length;d=b[e.id];if(void 0===d){d=[];for(var m=0;m<k;m++)d[m]=[m,0];b[e.id]=d}var q=f.morphTargets&&e.morphAttributes.position;
f=f.morphNormals&&e.morphAttributes.normal;for(m=0;m<k;m++){var n=d[m];0!==n[1]&&(q&&e.removeAttribute("morphTarget"+m),f&&e.removeAttribute("morphNormal"+m))}for(m=0;m<k;m++)n=d[m],n[0]=m,n[1]=h[m];d.sort(Sf);for(m=0;8>m;m++){if(n=d[m])if(h=n[0],k=n[1]){q&&e.addAttribute("morphTarget"+m,q[h]);f&&e.addAttribute("morphNormal"+m,f[h]);c[m]=k;continue}c[m]=0}g.getUniforms().setValue(a,"morphTargetInfluences",c)}}}function Uf(a,b){var c={};return{update:function(d){var e=b.render.frame,f=d.geometry,g=
a.get(d,f);c[g.id]!==e&&(f.isGeometry&&g.updateFromObject(d),a.update(g),c[g.id]=e);return g},dispose:function(){c={}}}}function Lb(a,b,c){var d=a[0];if(0>=d||0<d)return a;var e=b*c,f=Ce[e];void 0===f&&(f=new Float32Array(e),Ce[e]=f);if(0!==b)for(d.toArray(f,0),d=1,e=0;d!==b;++d)e+=c,a[d].toArray(f,e);return f}function S(a,b){if(a.length!==b.length)return!1;for(var c=0,d=a.length;c<d;c++)if(a[c]!==b[c])return!1;return!0}function pa(a,b){for(var c=0,d=b.length;c<d;c++)a[c]=b[c]}function De(a,b){var c=
Ee[b];void 0===c&&(c=new Int32Array(b),Ee[b]=c);for(var d=0;d!==b;++d)c[d]=a.allocTextureUnit();return c}function Vf(a,b){var c=this.cache;c[0]!==b&&(a.uniform1f(this.addr,b),c[0]=b)}function Wf(a,b){var c=this.cache;c[0]!==b&&(a.uniform1i(this.addr,b),c[0]=b)}function Xf(a,b){var c=this.cache;if(void 0!==b.x){if(c[0]!==b.x||c[1]!==b.y)a.uniform2f(this.addr,b.x,b.y),c[0]=b.x,c[1]=b.y}else S(c,b)||(a.uniform2fv(this.addr,b),pa(c,b))}function Yf(a,b){var c=this.cache;if(void 0!==b.x){if(c[0]!==b.x||
c[1]!==b.y||c[2]!==b.z)a.uniform3f(this.addr,b.x,b.y,b.z),c[0]=b.x,c[1]=b.y,c[2]=b.z}else if(void 0!==b.r){if(c[0]!==b.r||c[1]!==b.g||c[2]!==b.b)a.uniform3f(this.addr,b.r,b.g,b.b),c[0]=b.r,c[1]=b.g,c[2]=b.b}else S(c,b)||(a.uniform3fv(this.addr,b),pa(c,b))}function Zf(a,b){var c=this.cache;if(void 0!==b.x){if(c[0]!==b.x||c[1]!==b.y||c[2]!==b.z||c[3]!==b.w)a.uniform4f(this.addr,b.x,b.y,b.z,b.w),c[0]=b.x,c[1]=b.y,c[2]=b.z,c[3]=b.w}else S(c,b)||(a.uniform4fv(this.addr,b),pa(c,b))}function $f(a,b){var c=
this.cache,d=b.elements;void 0===d?S(c,b)||(a.uniformMatrix2fv(this.addr,!1,b),pa(c,b)):S(c,d)||(Fe.set(d),a.uniformMatrix2fv(this.addr,!1,Fe),pa(c,d))}function ag(a,b){var c=this.cache,d=b.elements;void 0===d?S(c,b)||(a.uniformMatrix3fv(this.addr,!1,b),pa(c,b)):S(c,d)||(Ge.set(d),a.uniformMatrix3fv(this.addr,!1,Ge),pa(c,d))}function bg(a,b){var c=this.cache,d=b.elements;void 0===d?S(c,b)||(a.uniformMatrix4fv(this.addr,!1,b),pa(c,b)):S(c,d)||(He.set(d),a.uniformMatrix4fv(this.addr,!1,He),pa(c,d))}
function cg(a,b,c){var d=this.cache,e=c.allocTextureUnit();d[0]!==e&&(a.uniform1i(this.addr,e),d[0]=e);c.setTexture2D(b||Ie,e)}function dg(a,b,c){var d=this.cache,e=c.allocTextureUnit();d[0]!==e&&(a.uniform1i(this.addr,e),d[0]=e);c.setTextureCube(b||Je,e)}function Ke(a,b){var c=this.cache;S(c,b)||(a.uniform2iv(this.addr,b),pa(c,b))}function Le(a,b){var c=this.cache;S(c,b)||(a.uniform3iv(this.addr,b),pa(c,b))}function Me(a,b){var c=this.cache;S(c,b)||(a.uniform4iv(this.addr,b),pa(c,b))}function eg(a){switch(a){case 5126:return Vf;
case 35664:return Xf;case 35665:return Yf;case 35666:return Zf;case 35674:return $f;case 35675:return ag;case 35676:return bg;case 35678:case 36198:return cg;case 35680:return dg;case 5124:case 35670:return Wf;case 35667:case 35671:return Ke;case 35668:case 35672:return Le;case 35669:case 35673:return Me}}function fg(a,b){var c=this.cache;S(c,b)||(a.uniform1fv(this.addr,b),pa(c,b))}function gg(a,b){var c=this.cache;S(c,b)||(a.uniform1iv(this.addr,b),pa(c,b))}function hg(a,b){var c=this.cache;b=Lb(b,
this.size,2);S(c,b)||(a.uniform2fv(this.addr,b),this.updateCache(b))}function ig(a,b){var c=this.cache;b=Lb(b,this.size,3);S(c,b)||(a.uniform3fv(this.addr,b),this.updateCache(b))}function jg(a,b){var c=this.cache;b=Lb(b,this.size,4);S(c,b)||(a.uniform4fv(this.addr,b),this.updateCache(b))}function kg(a,b){var c=this.cache;b=Lb(b,this.size,4);S(c,b)||(a.uniformMatrix2fv(this.addr,!1,b),this.updateCache(b))}function lg(a,b){var c=this.cache;b=Lb(b,this.size,9);S(c,b)||(a.uniformMatrix3fv(this.addr,!1,
b),this.updateCache(b))}function mg(a,b){var c=this.cache;b=Lb(b,this.size,16);S(c,b)||(a.uniformMatrix4fv(this.addr,!1,b),this.updateCache(b))}function ng(a,b,c){var d=this.cache,e=b.length,f=De(c,e);!1===S(d,f)&&(a.uniform1iv(this.addr,f),pa(d,f));for(a=0;a!==e;++a)c.setTexture2D(b[a]||Ie,f[a])}function og(a,b,c){var d=this.cache,e=b.length,f=De(c,e);!1===S(d,f)&&(a.uniform1iv(this.addr,f),pa(d,f));for(a=0;a!==e;++a)c.setTextureCube(b[a]||Je,f[a])}function pg(a){switch(a){case 5126:return fg;case 35664:return hg;
case 35665:return ig;case 35666:return jg;case 35674:return kg;case 35675:return lg;case 35676:return mg;case 35678:return ng;case 35680:return og;case 5124:case 35670:return gg;case 35667:case 35671:return Ke;case 35668:case 35672:return Le;case 35669:case 35673:return Me}}function qg(a,b,c){this.id=a;this.addr=c;this.cache=[];this.setValue=eg(b.type)}function Ne(a,b,c){this.id=a;this.addr=c;this.cache=[];this.size=b.size;this.setValue=pg(b.type)}function Oe(a){this.id=a;this.seq=[];this.map={}}
function cb(a,b,c,d){this.seq=[];this.map={};this.renderer=c;c=a.getProgramParameter(b,a.ACTIVE_UNIFORMS);for(d=0;d<c;++d){var e=a.getActiveUniform(b,d),f=a.getUniformLocation(b,e.name),g=this,h=e.name,k=h.length;for(Sd.lastIndex=0;;){var m=Sd.exec(h),q=Sd.lastIndex,n=m[1],u=m[3];"]"===m[2]&&(n|=0);if(void 0===u||"["===u&&q+2===k){h=g;e=void 0===u?new qg(n,e,f):new Ne(n,e,f);h.seq.push(e);h.map[e.id]=e;break}else u=g.map[n],void 0===u&&(u=new Oe(n),n=g,g=u,n.seq.push(g),n.map[g.id]=g),g=u}}}function rg(a){a=
a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+": "+a[b];return a.join("\n")}function Pe(a,b,c){var d=Xa.Settings.resolve(),e=a.createShader(b);a.shaderSource(e,c);a.compileShader(e);d.debug()&&sg.logShaderCompilationInformation(a,e,b,c);return e}function Qe(a){switch(a){case 3E3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];
case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw Error("unsupported encoding: "+a);}}function Td(a,b){b=Qe(b);return"vec4 "+a+"( vec4 value ) { return "+b[0]+"ToLinear"+b[1]+"; }"}function tg(a,b){b=Qe(b);return"vec4 "+a+"( vec4 value ) { return LinearTo"+b[0]+b[1]+"; }"}function ug(a,b){switch(b){case 1:b="Linear";break;case 2:b="Reinhard";break;case 3:b="Uncharted2";break;case 4:b="OptimizedCineon";break;default:throw Error("unsupported toneMapping: "+b);}return"vec3 "+
a+"( vec3 color ) { return "+b+"ToneMapping( color ); }"}function vg(a,b,c){a=a||{};return[a.derivatives||b.envMapCubeUV||b.bumpMap||b.normalMap&&!b.objectSpaceNormalMap||b.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(a.fragDepth||b.logarithmicDepthBuffer)&&c.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",a.drawBuffers&&c.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(a.shaderTextureLOD||b.envMap)&&c.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":
""].filter(xc).join("\n")}function wg(a){var b=[],c;for(c in a){var d=a[c];!1!==d&&b.push("#define "+c+" "+d)}return b.join("\n")}function xg(a,b,c){var d={},e=!1;c.attributes&&0<c.attributes.length?c.attributes.forEach(function(f){d[f]=a.getAttribLocation(b,f);-1===d[f]&&(Re.warn("Attribute "+f+" not defined in material shader. Material: "+c.type+". Check shader attributes or material.attributes definition."),e=!0)}):e=!0;if(e){d={};for(var f=a.getProgramParameter(b,a.ACTIVE_ATTRIBUTES),g=0;g<f;g++){var h=
a.getActiveAttrib(b,g).name;Re.warn("Fallback to getProgramParameter webgl method. Try to avoid it by settings attributes to material or attributes to ShaderMaterial constructor parameters. Material: "+c.type+" Attribute: "+h);d[h]=a.getAttribLocation(b,h)}}return d}function xc(a){return""!==a}function Se(a,b){return a.replace(/NUM_DIR_LIGHTS/g,b.numDirLights).replace(/NUM_SPOT_LIGHTS/g,b.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,b.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,b.numPointLights).replace(/NUM_HEMI_LIGHTS/g,
b.numHemiLights)}function Te(a,b){return a.replace(/NUM_CLIPPING_PLANES/g,b.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,b.numClippingPlanes-b.numClipIntersection)}function Ud(a){return a.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,function(a,c){a=R[c];if(void 0===a)throw Error("Can not resolve #include <"+c+">");return Ud(a)})}function Ue(a){return a.replace(/#pragma unroll_loop[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(a,c,d,e){a="";for(c=parseInt(c);c<
parseInt(d);c++)a+=e.replace(/\[ i \]/g,"[ "+c+" ]");return a})}function yg(a,b,c,d,e,f,g){var h=Xa.Settings.resolve(),k=a.context,m=d.defines,q=e.vertexShader,n=e.fragmentShader,u="SHADOWMAP_TYPE_BASIC";1===f.shadowMapType?u="SHADOWMAP_TYPE_PCF":2===f.shadowMapType&&(u="SHADOWMAP_TYPE_PCF_SOFT");var t="ENVMAP_TYPE_CUBE",r="ENVMAP_MODE_REFLECTION",l="ENVMAP_BLENDING_MULTIPLY";if(f.envMap){switch(d.envMap.mapping){case 301:case 302:t="ENVMAP_TYPE_CUBE";break;case 306:case 307:t="ENVMAP_TYPE_CUBE_UV";
break;case 303:case 304:t="ENVMAP_TYPE_EQUIREC";break;case 305:t="ENVMAP_TYPE_SPHERE"}switch(d.envMap.mapping){case 302:case 304:r="ENVMAP_MODE_REFRACTION"}switch(d.combine){case 0:l="ENVMAP_BLENDING_MULTIPLY";break;case 1:l="ENVMAP_BLENDING_MIX";break;case 2:l="ENVMAP_BLENDING_ADD"}}var p=0<a.gammaFactor?a.gammaFactor:1,x=g.isWebGL2?"":vg(d.extensions,f,b),w=wg(m),y=k.createProgram();d.isRawShaderMaterial?(m=[w].filter(xc).join("\n"),0<m.length&&(m+="\n"),b=[x,w].filter(xc).join("\n"),0<b.length&&
(b+="\n")):(m=["precision "+f.precision+" float;","precision "+f.precision+" int;","#define SHADER_NAME "+e.name,w,f.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+p,"#define MAX_BONES "+f.maxBones,f.useFog&&f.fog?"#define USE_FOG":"",f.useFog&&f.fogExp?"#define FOG_EXP2":"",f.map?"#define USE_MAP":"",f.envMap?"#define USE_ENVMAP":"",f.envMap?"#define "+r:"",f.lightMap?"#define USE_LIGHTMAP":"",f.aoMap?"#define USE_AOMAP":"",f.emissiveMap?"#define USE_EMISSIVEMAP":"",
f.bumpMap?"#define USE_BUMPMAP":"",f.normalMap?"#define USE_NORMALMAP":"",f.normalMap&&f.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",f.displacementMap&&f.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",f.specularMap?"#define USE_SPECULARMAP":"",f.roughnessMap?"#define USE_ROUGHNESSMAP":"",f.metalnessMap?"#define USE_METALNESSMAP":"",f.alphaMap?"#define USE_ALPHAMAP":"",f.vertexColors?"#define USE_COLOR":"",f.flatShading?"#define FLAT_SHADED":"",f.skinning?"#define USE_SKINNING":
"",f.useVertexTexture?"#define BONE_TEXTURE":"",f.morphTargets?"#define USE_MORPHTARGETS":"",f.morphNormals&&!1===f.flatShading?"#define USE_MORPHNORMALS":"",f.doubleSided?"#define DOUBLE_SIDED":"",f.flipSided?"#define FLIP_SIDED":"",f.shadowMapEnabled?"#define USE_SHADOWMAP":"",f.shadowMapEnabled?"#define "+u:"",f.sizeAttenuation?"#define USE_SIZEATTENUATION":"",f.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",f.logarithmicDepthBuffer&&(g.isWebGL2||b.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":
"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;",
"\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(xc).join("\n"),b=[x,"precision "+f.precision+" float;","precision "+f.precision+" int;","#define SHADER_NAME "+e.name,w,f.alphaTest?
"#define ALPHATEST "+f.alphaTest+(f.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+p,f.useFog&&f.fog?"#define USE_FOG":"",f.useFog&&f.fogExp?"#define FOG_EXP2":"",f.map?"#define USE_MAP":"",f.envMap?"#define USE_ENVMAP":"",f.envMap?"#define "+t:"",f.envMap?"#define "+r:"",f.envMap?"#define "+l:"",f.lightMap?"#define USE_LIGHTMAP":"",f.aoMap?"#define USE_AOMAP":"",f.emissiveMap?"#define USE_EMISSIVEMAP":"",f.bumpMap?"#define USE_BUMPMAP":"",f.normalMap?"#define USE_NORMALMAP":"",f.normalMap&&f.objectSpaceNormalMap?
"#define OBJECTSPACE_NORMALMAP":"",f.specularMap?"#define USE_SPECULARMAP":"",f.roughnessMap?"#define USE_ROUGHNESSMAP":"",f.metalnessMap?"#define USE_METALNESSMAP":"",f.alphaMap?"#define USE_ALPHAMAP":"",f.vertexColors?"#define USE_COLOR":"",f.gradientMap?"#define USE_GRADIENTMAP":"",f.flatShading?"#define FLAT_SHADED":"",f.doubleSided?"#define DOUBLE_SIDED":"",f.flipSided?"#define FLIP_SIDED":"",f.shadowMapEnabled?"#define USE_SHADOWMAP":"",f.shadowMapEnabled?"#define "+u:"",f.premultipliedAlpha?
"#define PREMULTIPLIED_ALPHA":"",f.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",f.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",f.logarithmicDepthBuffer&&(g.isWebGL2||b.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",f.envMap&&(g.isWebGL2||b.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",0!==f.toneMapping?"#define TONE_MAPPING":"",0!==f.toneMapping?R.tonemapping_pars_fragment:"",0!==f.toneMapping?
ug("toneMapping",f.toneMapping):"",f.dithering?"#define DITHERING":"",f.outputEncoding||f.mapEncoding||f.envMapEncoding||f.emissiveMapEncoding?R.encodings_pars_fragment:"",f.mapEncoding?Td("mapTexelToLinear",f.mapEncoding):"",f.envMapEncoding?Td("envMapTexelToLinear",f.envMapEncoding):"",f.emissiveMapEncoding?Td("emissiveMapTexelToLinear",f.emissiveMapEncoding):"",f.outputEncoding?tg("linearToOutputTexel",f.outputEncoding):"",f.depthPacking?"#define DEPTH_PACKING "+d.depthPacking:"","\n"].filter(xc).join("\n"));
q=Ud(q);q=Se(q,f);q=Te(q,f);n=Ud(n);n=Se(n,f);n=Te(n,f);q=Ue(q);n=Ue(n);g.isWebGL2&&!d.isRawShaderMaterial&&(g=!1,u=/^\s*#version\s+300\s+es\s*\n/,d.isShaderMaterial&&null!==q.match(u)&&null!==n.match(u)&&(g=!0,q=q.replace(u,""),n=n.replace(u,"")),m="#version 300 es\n\n#define attribute in\n#define varying out\n#define texture2D texture\n"+m,b=["#version 300 es\n\n#define varying in",g?"":"out highp vec4 pc_fragColor;",g?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth\n#define texture2D texture\n#define textureCube texture\n#define texture2DProj textureProj\n#define texture2DLodEXT textureLod\n#define texture2DProjLodEXT textureProjLod\n#define textureCubeLodEXT textureLod\n#define texture2DGradEXT textureGrad\n#define texture2DProjGradEXT textureProjGrad\n#define textureCubeGradEXT textureGrad"].join("\n")+
"\n"+b);n=b+n;q=Pe(k,k.VERTEX_SHADER,m+q);n=Pe(k,k.FRAGMENT_SHADER,n);k.attachShader(y,q);k.attachShader(y,n);void 0!==d.index0AttributeName?k.bindAttribLocation(y,0,d.index0AttributeName):!0===f.morphTargets&&k.bindAttribLocation(y,0,"position");k.linkProgram(y);h.debug()&&(f=zg.getWebGLProgramDiagnostics(k,y,q,n,m,b,d))&&(this.diagnostics=f);k.deleteShader(q);k.deleteShader(n);var H;this.getUniforms=function(){void 0===H&&(H=new cb(k,y,a,d));return H};var O;this.getAttributes=function(){void 0===
O&&(O=xg(k,y,d));return O};this.destroy=function(){k.deleteProgram(y);this.program=void 0};Object.defineProperties(this,{uniforms:{get:function(){console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms().");return this.getUniforms()}},attributes:{get:function(){console.warn("THREE.WebGLProgram: .attributes is now .getAttributes().");return this.getAttributes()}}});this.name=e.name;this.id=Ag++;this.code=c;this.usedTimes=1;this.program=y;this.vertexShader=q;this.fragmentShader=n;return this}
function Bg(a,b,c){function d(a,b){if(a)a.isTexture?c=a.encoding:a.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),c=a.texture.encoding);else var c=3E3;3E3===c&&b&&(c=3007);return c}var e=[],f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",
MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},g="precision supportsVertexTextures map mapEncoding envMap envMapMode envMapEncoding lightMap aoMap emissiveMap emissiveMapEncoding bumpMap normalMap objectSpaceNormalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors fog useFog fogExp flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering".split(" ");
this.getParameters=function(b,e,g,q,n,u,t){var h=f[b.type];if(t.isSkinnedMesh){var k=t.skeleton.bones;if(c.floatVertexTextures)k=1024;else{var m=Math.min(Math.floor((c.maxVertexUniforms-20)/4),k.length);m<k.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+k.length+" bones. This GPU supports "+m+"."),k=0):k=m}}else k=0;m=c.precision;null!==b.precision&&(m=c.getMaxPrecision(b.precision),m!==b.precision&&console.warn("THREE.WebGLProgram.getParameters:",b.precision,"not supported, using",m,"instead."));
var l=a.getRenderTarget();return{shaderID:h,precision:m,supportsVertexTextures:c.vertexTextures,outputEncoding:d(l?l.texture:null,a.gammaOutput),map:!!b.map,mapEncoding:d(b.map,a.gammaInput),envMap:!!b.envMap,envMapMode:b.envMap&&b.envMap.mapping,envMapEncoding:d(b.envMap,a.gammaInput),envMapCubeUV:!!b.envMap&&(306===b.envMap.mapping||307===b.envMap.mapping),lightMap:!!b.lightMap,aoMap:!!b.aoMap,emissiveMap:!!b.emissiveMap,emissiveMapEncoding:d(b.emissiveMap,a.gammaInput),bumpMap:!!b.bumpMap,normalMap:!!b.normalMap,
objectSpaceNormalMap:1===b.normalMapType,displacementMap:!!b.displacementMap,roughnessMap:!!b.roughnessMap,metalnessMap:!!b.metalnessMap,specularMap:!!b.specularMap,alphaMap:!!b.alphaMap,gradientMap:!!b.gradientMap,combine:b.combine,vertexColors:b.vertexColors,fog:!!q,useFog:b.fog,fogExp:q&&q.isFogExp2,flatShading:b.flatShading,sizeAttenuation:b.sizeAttenuation,logarithmicDepthBuffer:c.logarithmicDepthBuffer,skinning:b.skinning&&0<k,maxBones:k,useVertexTexture:c.floatVertexTextures,morphTargets:b.morphTargets,
morphNormals:b.morphNormals,maxMorphTargets:a.maxMorphTargets,maxMorphNormals:a.maxMorphNormals,numDirLights:e.directional.length,numPointLights:e.point.length,numSpotLights:e.spot.length,numRectAreaLights:e.rectArea.length,numHemiLights:e.hemi.length,numClippingPlanes:n,numClipIntersection:u,dithering:b.dithering,shadowMapEnabled:a.shadowMap.enabled&&t.receiveShadow&&0<g.length,shadowMapType:a.shadowMap.type,toneMapping:a.toneMapping,physicallyCorrectLights:a.physicallyCorrectLights,premultipliedAlpha:b.premultipliedAlpha,
alphaTest:b.alphaTest,doubleSided:2===b.side,flipSided:1===b.side,depthPacking:void 0!==b.depthPacking?b.depthPacking:!1}};this.getProgramCode=function(b,c){var d=[];c.shaderID?d.push(c.shaderID):(d.push(b.fragmentShader),d.push(b.vertexShader));if(void 0!==b.defines)for(var e in b.defines)d.push(e),d.push(b.defines[e]);for(e=0;e<g.length;e++)d.push(c[g[e]]);d.push(b.onBeforeCompile.toString());d.push(a.gammaOutput);return d.join()};this.acquireProgram=function(d,f,g,q){for(var h,k=0,m=e.length;k<
m;k++){var r=e[k];if(r.code===q){h=r;++h.usedTimes;break}}void 0===h&&(h=new yg(a,b,q,d,f,g,c),e.push(h));return h};this.releaseProgram=function(a){if(!(e.length<Xa.Settings.resolve().allowedCachedPrograms())&&0===--a.usedTimes){var b=e.indexOf(a);e[b]=e[e.length-1];e.pop();a.destroy()}};this.disposeCached=function(){for(;0<e.length;)e.pop().destroy()};this.programs=e}function Cg(a,b){return a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.program&&b.program&&a.program!==b.program?a.program.id-
b.program.id:a.material.id!==b.material.id?a.material.id-b.material.id:a.z!==b.z?a.z-b.z:a.id-b.id}function Dg(a,b){return a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.z!==b.z?b.z-a.z:a.id-b.id}function Eg(){var a=[],b=0,c=[],d=[];return{opaque:c,transparent:d,init:function(){b=0;c.length=0;d.length=0},push:function(e,f,g,h,k){var m=a[b];void 0===m?(m={id:e.id,object:e,geometry:f,material:g,program:g.program,renderOrder:e.renderOrder,z:h,group:k},a[b]=m):(m.id=e.id,m.object=e,m.geometry=
f,m.material=g,m.program=g.program,m.renderOrder=e.renderOrder,m.z=h,m.group=k);(!0===g.transparent?d:c).push(m);b++},sort:function(){1<c.length&&c.sort(Cg);1<d.length&&d.sort(Dg)}}}function Fg(){var a={};return{get:function(b,c){b=b.id+","+c.id;c=a[b];void 0===c&&(c=new Eg,a[b]=c);return c},dispose:function(){a={}}}}function Gg(){var a={};return{get:function(b){if(void 0!==a[b.id])return a[b.id];switch(b.type){case "DirectionalLight":var c={direction:new p,color:new G,shadow:!1,shadowBias:0,shadowRadius:1,
shadowMapSize:new C};break;case "SpotLight":c={position:new p,direction:new p,color:new G,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new C};break;case "PointLight":c={position:new p,color:new G,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new C,shadowCameraNear:1,shadowCameraFar:1E3};break;case "HemisphereLight":c={direction:new p,skyColor:new G,groundColor:new G};break;case "RectAreaLight":c={color:new G,position:new p,
halfWidth:new p,halfHeight:new p}}return a[b.id]=c}}}function Hg(){var a=new Gg,b={id:Ig++,hash:{stateID:-1,directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},c=new p,d=new I,e=new I;return{setup:function(f,g,h){var k=0,m=0,q=0,n=0,u=0,t=0,r=0,l=0;h=h.matrixWorldInverse;
for(var p=0,x=f.length;p<x;p++){var w=f[p],y=w.color,H=w.intensity,O=w.distance,da=w.shadow&&w.shadow.map?w.shadow.map.texture:null;if(w.isAmbientLight)k+=y.r*H,m+=y.g*H,q+=y.b*H;else if(w.isDirectionalLight){var J=a.get(w);J.color.copy(w.color).multiplyScalar(w.intensity);J.direction.setFromMatrixPosition(w.matrixWorld);c.setFromMatrixPosition(w.target.matrixWorld);J.direction.sub(c);J.direction.transformDirection(h);if(J.shadow=w.castShadow)y=w.shadow,J.shadowBias=y.bias,J.shadowRadius=y.radius,
J.shadowMapSize=y.mapSize;b.directionalShadowMap[n]=da;b.directionalShadowMatrix[n]=w.shadow.matrix;b.directional[n]=J;n++}else if(w.isSpotLight){J=a.get(w);J.position.setFromMatrixPosition(w.matrixWorld);J.position.applyMatrix4(h);J.color.copy(y).multiplyScalar(H);J.distance=O;J.direction.setFromMatrixPosition(w.matrixWorld);c.setFromMatrixPosition(w.target.matrixWorld);J.direction.sub(c);J.direction.transformDirection(h);J.coneCos=Math.cos(w.angle);J.penumbraCos=Math.cos(w.angle*(1-w.penumbra));
J.decay=0===w.distance?0:w.decay;if(J.shadow=w.castShadow)y=w.shadow,J.shadowBias=y.bias,J.shadowRadius=y.radius,J.shadowMapSize=y.mapSize;b.spotShadowMap[t]=da;b.spotShadowMatrix[t]=w.shadow.matrix;b.spot[t]=J;t++}else if(w.isRectAreaLight)J=a.get(w),J.color.copy(y).multiplyScalar(H),J.position.setFromMatrixPosition(w.matrixWorld),J.position.applyMatrix4(h),e.identity(),d.copy(w.matrixWorld),d.premultiply(h),e.extractRotation(d),J.halfWidth.set(.5*w.width,0,0),J.halfHeight.set(0,.5*w.height,0),J.halfWidth.applyMatrix4(e),
J.halfHeight.applyMatrix4(e),b.rectArea[r]=J,r++;else if(w.isPointLight){J=a.get(w);J.position.setFromMatrixPosition(w.matrixWorld);J.position.applyMatrix4(h);J.color.copy(w.color).multiplyScalar(w.intensity);J.distance=w.distance;J.decay=0===w.distance?0:w.decay;if(J.shadow=w.castShadow)y=w.shadow,J.shadowBias=y.bias,J.shadowRadius=y.radius,J.shadowMapSize=y.mapSize,J.shadowCameraNear=y.camera.near,J.shadowCameraFar=y.camera.far;b.pointShadowMap[u]=da;b.pointShadowMatrix[u]=w.shadow.matrix;b.point[u]=
J;u++}else w.isHemisphereLight&&(J=a.get(w),J.direction.setFromMatrixPosition(w.matrixWorld),J.direction.transformDirection(h),J.direction.normalize(),J.skyColor.copy(w.color).multiplyScalar(H),J.groundColor.copy(w.groundColor).multiplyScalar(H),b.hemi[l]=J,l++)}b.ambient[0]=k;b.ambient[1]=m;b.ambient[2]=q;b.directional.length=n;b.spot.length=t;b.rectArea.length=r;b.point.length=u;b.hemi.length=l;b.hash.stateID=b.id;b.hash.directionalLength=n;b.hash.pointLength=u;b.hash.spotLength=t;b.hash.rectAreaLength=
r;b.hash.hemiLength=l;b.hash.shadowsLength=g.length},state:b}}function Ve(){var a=new Hg,b=[],c=[];return{init:function(){b.length=0;c.length=0},state:{lightsArray:b,shadowsArray:c,lights:a},setupLights:function(d){a.setup(b,c,d)},pushLight:function(a){b.push(a)},pushShadow:function(a){c.push(a)}}}function Jg(){var a={};return{get:function(b,c){if(void 0===a[b.id]){var d=new Ve;a[b.id]={};a[b.id][c.id]=d}else void 0===a[b.id][c.id]?(d=new Ve,a[b.id][c.id]=d):d=a[b.id][c.id];return d},dispose:function(){a=
{}}}}function db(a){F.call(this);this.type="MeshDepthMaterial";this.depthPacking=3200;this.morphTargets=this.skinning=!1;this.displacementMap=this.alphaMap=this.map=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=!1;this.wireframeLinewidth=1;this.lights=this.fog=!1;this.setValues(a);this.attributes=["position"]}function eb(a){F.call(this);this.type="MeshDistanceMaterial";this.referencePosition=new p;this.nearDistance=1;this.farDistance=1E3;this.morphTargets=this.skinning=!1;this.displacementMap=
this.alphaMap=this.map=null;this.displacementScale=1;this.displacementBias=0;this.lights=this.fog=!1;this.setValues(a)}function We(a,b,c){function d(b,c,d,e,f,g){var h=b.geometry;var k=n;var m=b.customDepthMaterial;d&&(k=u,m=b.customDistanceMaterial);m?k=m:(m=!1,c.morphTargets&&(h&&h.isBufferGeometry?m=h.morphAttributes&&h.morphAttributes.position&&0<h.morphAttributes.position.length:h&&h.isGeometry&&(m=h.morphTargets&&0<h.morphTargets.length)),b.isSkinnedMesh&&!1===c.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",
b),b=b.isSkinnedMesh&&c.skinning,h=0,m&&(h|=1),b&&(h|=2),k=k[h]);a.localClippingEnabled&&!0===c.clipShadows&&0!==c.clippingPlanes.length&&(h=k.uuid,m=c.uuid,b=t[h],void 0===b&&(b={},t[h]=b),h=b[m],void 0===h&&(h=k.clone(),b[m]=h),k=h);k.visible=c.visible;k.wireframe=c.wireframe;k.side=null!=c.shadowSide?c.shadowSide:r[c.side];k.clipShadows=c.clipShadows;k.clippingPlanes=c.clippingPlanes;k.clipIntersection=c.clipIntersection;k.wireframeLinewidth=c.wireframeLinewidth;k.linewidth=c.linewidth;d&&k.isMeshDistanceMaterial&&
(k.referencePosition.copy(e),k.nearDistance=f,k.farDistance=g);return k}function e(c,g,h,k){if(!1!==c.visible){if(c.layers.test(g.layers)&&(c.isMesh||c.isLine||c.isPoints)&&c.castShadow&&(!c.frustumCulled||f.intersectsObject(c))){c.modelViewMatrix.multiplyMatrices(h.matrixWorldInverse,c.matrixWorld);var m=b.update(c),n=c.material;if(Array.isArray(n))for(var u=m.groups,t=0,r=u.length;t<r;t++){var l=u[t],v=n[l.materialIndex];v&&v.visible&&(v=d(c,v,k,q,h.near,h.far),a.renderBufferDirect(h,null,m,v,c,
l))}else n.visible&&(v=d(c,n,k,q,h.near,h.far),a.renderBufferDirect(h,null,m,v,c,null))}c=c.children;m=0;for(n=c.length;m<n;m++)e(c[m],g,h,k)}}var f=new ld,g=new I,h=new C,k=new C(c,c),m=new p,q=new p,n=Array(4),u=Array(4),t={},r={0:1,1:0,2:2},l=[new p(1,0,0),new p(-1,0,0),new p(0,0,1),new p(0,0,-1),new p(0,1,0),new p(0,-1,0)],z=[new p(0,1,0),new p(0,1,0),new p(0,1,0),new p(0,1,0),new p(0,0,1),new p(0,0,-1)],x=[new ca,new ca,new ca,new ca,new ca,new ca];for(c=0;4!==c;++c){var w=0!==(c&1),y=0!==(c&
2),H=new db({depthPacking:3201,morphTargets:w,skinning:y});n[c]=H;w=new eb({morphTargets:w,skinning:y});u[c]=w}var O=this;this.enabled=!1;this.autoUpdate=!0;this.needsUpdate=!1;this.type=1;this.render=function(b,c,d){if(!1!==O.enabled&&(!1!==O.autoUpdate||!1!==O.needsUpdate)&&0!==b.length){var n=a.state;n.disable(a.context.BLEND);n.buffers.color.setClear(1,1,1,1);n.buffers.depth.setTest(!0);n.setScissorTest(!1);for(var u,t=0,r=b.length;t<r;t++){var v=b[t];u=v.shadow;var p=v&&v.isPointLight;if(void 0===
u)console.warn("THREE.WebGLShadowMap:",v,"has no shadow.");else{var w=u.camera;h.copy(u.mapSize);h.min(k);if(p){var H=h.x,y=h.y;x[0].set(2*H,y,H,y);x[1].set(0,y,H,y);x[2].set(3*H,y,H,y);x[3].set(H,y,H,y);x[4].set(3*H,0,H,y);x[5].set(H,0,H,y);h.x*=4;h.y*=2}null===u.map&&(u.map=new md(h.x,h.y,{minFilter:1003,magFilter:1003,format:1023}),u.map.texture.name=v.name+".shadowMap",w.updateProjectionMatrix());u.isSpotLightShadow&&u.update(v);H=u.map;y=u.matrix;q.setFromMatrixPosition(v.matrixWorld);w.position.copy(q);
p?(u=6,y.makeTranslation(-q.x,-q.y,-q.z)):(u=1,m.setFromMatrixPosition(v.target.matrixWorld),w.lookAt(m),w.updateMatrixWorld(),y.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),y.multiply(w.projectionMatrix),y.multiply(w.matrixWorldInverse));a.setRenderTarget(H);a.clear();for(v=0;v<u;v++)p&&(m.copy(w.position),m.add(l[v]),w.up.copy(z[v]),w.lookAt(m),w.updateMatrixWorld(),n.viewport(x[v])),g.multiplyMatrices(w.projectionMatrix,w.matrixWorldInverse),f.setFromMatrix(g),e(c,d,w,p)}}O.needsUpdate=!1}}}function Kg(a,
b,c,d){function e(b,c,d){var e=new Uint8Array(4),f=a.createTexture();a.bindTexture(b,f);a.texParameteri(b,a.TEXTURE_MIN_FILTER,a.NEAREST);a.texParameteri(b,a.TEXTURE_MAG_FILTER,a.NEAREST);for(b=0;b<d;b++)a.texImage2D(c+b,0,a.RGBA,1,1,0,a.RGBA,a.UNSIGNED_BYTE,e);return f}function f(c,e){x[c]=1;0===w[c]&&(a.enableVertexAttribArray(c),w[c]=1);y[c]!==e&&((d.isWebGL2?a:b.get("ANGLE_instanced_arrays"))[d.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](c,e),y[c]=e)}function g(b){!0!==H[b]&&(a.enable(b),
H[b]=!0)}function h(b){!1!==H[b]&&(a.disable(b),H[b]=!1)}function k(b,d,e,f,k,m,n,q){0!==b?g(a.BLEND):h(a.BLEND);if(5!==b){if(b!==J||q!==M)switch(b){case 2:q?(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ONE,a.ONE,a.ONE,a.ONE)):(a.blendEquation(a.FUNC_ADD),a.blendFunc(a.SRC_ALPHA,a.ONE));break;case 3:q?(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ZERO,a.ZERO,a.ONE_MINUS_SRC_COLOR,a.ONE_MINUS_SRC_ALPHA)):(a.blendEquation(a.FUNC_ADD),a.blendFunc(a.ZERO,
a.ONE_MINUS_SRC_COLOR));break;case 4:q?(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ZERO,a.SRC_COLOR,a.ZERO,a.SRC_ALPHA)):(a.blendEquation(a.FUNC_ADD),a.blendFunc(a.ZERO,a.SRC_COLOR));break;default:q?(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.ONE,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA)):(a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA))}G=V=E=B=A=C=null}else{k=
k||d;m=m||e;n=n||f;if(d!==C||k!==E)a.blendEquationSeparate(c.convert(d),c.convert(k)),C=d,E=k;if(e!==A||f!==B||m!==V||n!==G)a.blendFuncSeparate(c.convert(e),c.convert(f),c.convert(m),c.convert(n)),A=e,B=f,V=m,G=n}J=b;M=q}function m(b){L!==b&&(b?a.frontFace(a.CW):a.frontFace(a.CCW),L=b)}function q(b){0!==b?(g(a.CULL_FACE),b!==K&&(1===b?a.cullFace(a.BACK):2===b?a.cullFace(a.FRONT):a.cullFace(a.FRONT_AND_BACK))):h(a.CULL_FACE);K=b}function n(b,c,d){if(b){if(g(a.POLYGON_OFFSET_FILL),P!==c||F!==d)a.polygonOffset(c,
d),P=c,F=d}else h(a.POLYGON_OFFSET_FILL)}function u(b){void 0===b&&(b=a.TEXTURE0+Q-1);aa!==b&&(a.activeTexture(b),aa=b)}var t=new function(){var b=!1,c=new ca,d=null,e=new ca(0,0,0,0);return{setMask:function(c){d===c||b||(a.colorMask(c,c,c,c),d=c)},setLocked:function(a){b=a},setClear:function(b,d,f,g,h){!0===h&&(b*=g,d*=g,f*=g);c.set(b,d,f,g);!1===e.equals(c)&&(a.clearColor(b,d,f,g),e.copy(c))},reset:function(){b=!1;d=null;e.set(-1,0,0,0)}}},r=new function(){var b=!1,c=null,d=null,e=null;return{setTest:function(b){b?
g(a.DEPTH_TEST):h(a.DEPTH_TEST)},setMask:function(d){c===d||b||(a.depthMask(d),c=d)},setFunc:function(b){if(d!==b){if(b)switch(b){case 0:a.depthFunc(a.NEVER);break;case 1:a.depthFunc(a.ALWAYS);break;case 2:a.depthFunc(a.LESS);break;case 3:a.depthFunc(a.LEQUAL);break;case 4:a.depthFunc(a.EQUAL);break;case 5:a.depthFunc(a.GEQUAL);break;case 6:a.depthFunc(a.GREATER);break;case 7:a.depthFunc(a.NOTEQUAL);break;default:a.depthFunc(a.LEQUAL)}else a.depthFunc(a.LEQUAL);d=b}},setLocked:function(a){b=a},setClear:function(b){e!==
b&&(a.clearDepth(b),e=b)},reset:function(){b=!1;e=d=c=null}}},l=new function(){var b=!1,c=null,d=null,e=null,f=null,k=null,m=null,n=null,q=null;return{setTest:function(b){b?g(a.STENCIL_TEST):h(a.STENCIL_TEST)},setMask:function(d){c===d||b||(a.stencilMask(d),c=d)},setFunc:function(b,c,g){if(d!==b||e!==c||f!==g)a.stencilFunc(b,c,g),d=b,e=c,f=g},setOp:function(b,c,d){if(k!==b||m!==c||n!==d)a.stencilOp(b,c,d),k=b,m=c,n=d},setLocked:function(a){b=a},setClear:function(b){q!==b&&(a.clearStencil(b),q=b)},
reset:function(){b=!1;q=n=m=k=f=e=d=c=null}}},p=a.getParameter(a.MAX_VERTEX_ATTRIBS),x=new Uint8Array(p),w=new Uint8Array(p),y=new Uint8Array(p),H={},O=null,da=null,J=null,C=null,A=null,B=null,E=null,V=null,G=null,M=!1,L=null,K=null,I=null,P=null,F=null,Q=a.getParameter(a.MAX_COMBINED_TEXTURE_IMAGE_UNITS),R=!1;p=0;p=a.getParameter(a.VERSION);-1!==p.indexOf("WebGL")?(p=parseFloat(/^WebGL ([0-9])/.exec(p)[1]),R=1<=p):-1!==p.indexOf("OpenGL ES")&&(p=parseFloat(/^OpenGL ES ([0-9])/.exec(p)[1]),R=2<=p);
var aa=null,T={},W=new ca,S=new ca,N={};N[a.TEXTURE_2D]=e(a.TEXTURE_2D,a.TEXTURE_2D,1);N[a.TEXTURE_CUBE_MAP]=e(a.TEXTURE_CUBE_MAP,a.TEXTURE_CUBE_MAP_POSITIVE_X,6);t.setClear(0,0,0,1);r.setClear(1);l.setClear(0);g(a.DEPTH_TEST);r.setFunc(3);m(!1);q(1);g(a.CULL_FACE);g(a.BLEND);k(1);return{buffers:{color:t,depth:r,stencil:l},initAttributes:function(){for(var a=0,b=x.length;a<b;a++)x[a]=0},enableAttribute:function(a){f(a,0)},enableAttributeAndDivisor:f,disableUnusedAttributes:function(){for(var b=0,
c=w.length;b!==c;++b)w[b]!==x[b]&&(a.disableVertexAttribArray(b),w[b]=0)},enable:g,disable:h,getCompressedTextureFormats:function(){if(null===O&&(O=[],b.get("WEBGL_compressed_texture_pvrtc")||b.get("WEBGL_compressed_texture_s3tc")||b.get("WEBGL_compressed_texture_etc1")||b.get("WEBGL_compressed_texture_astc")))for(var c=a.getParameter(a.COMPRESSED_TEXTURE_FORMATS),d=0;d<c.length;d++)O.push(c[d]);return O},useProgram:function(b){return da!==b?(a.useProgram(b),da=b,!0):!1},setBlending:k,setMaterial:function(b,
c){2===b.side?h(a.CULL_FACE):g(a.CULL_FACE);var d=1===b.side;c&&(d=!d);m(d);1===b.blending&&!1===b.transparent?k(0):k(b.blending,b.blendEquation,b.blendSrc,b.blendDst,b.blendEquationAlpha,b.blendSrcAlpha,b.blendDstAlpha,b.premultipliedAlpha);r.setFunc(b.depthFunc);r.setTest(b.depthTest);r.setMask(b.depthWrite);t.setMask(b.colorWrite);n(b.polygonOffset,b.polygonOffsetFactor,b.polygonOffsetUnits)},setFlipSided:m,setCullFace:q,setLineWidth:function(b){b!==I&&(R&&a.lineWidth(b),I=b)},setPolygonOffset:n,
setScissorTest:function(b){b?g(a.SCISSOR_TEST):h(a.SCISSOR_TEST)},activeTexture:u,bindTexture:function(b,c){null===aa&&u();var d=T[aa];void 0===d&&(d={type:void 0,texture:void 0},T[aa]=d);if(d.type!==b||d.texture!==c)a.bindTexture(b,c||N[b]),d.type=b,d.texture=c},compressedTexImage2D:function(){try{a.compressedTexImage2D.apply(a,arguments)}catch(U){console.error("THREE.WebGLState:",U)}},texImage2D:function(){try{a.texImage2D.apply(a,arguments)}catch(U){console.error("THREE.WebGLState:",U)}},scissor:function(b){!1===
W.equals(b)&&(a.scissor(b.x,b.y,b.z,b.w),W.copy(b))},viewport:function(b){!1===S.equals(b)&&(a.viewport(b.x,b.y,b.z,b.w),S.copy(b))},reset:function(){for(var b=0;b<w.length;b++)1===w[b]&&(a.disableVertexAttribArray(b),w[b]=0);H={};aa=O=null;T={};K=L=J=da=null;t.reset();r.reset();l.reset()}}}function Xe(a,b,c){return{convert:function(d){if(1E3===d)return a.REPEAT;if(1001===d)return a.CLAMP_TO_EDGE;if(1002===d)return a.MIRRORED_REPEAT;if(1003===d)return a.NEAREST;if(1004===d)return a.NEAREST_MIPMAP_NEAREST;
if(1005===d)return a.NEAREST_MIPMAP_LINEAR;if(1006===d)return a.LINEAR;if(1007===d)return a.LINEAR_MIPMAP_NEAREST;if(1008===d)return a.LINEAR_MIPMAP_LINEAR;if(1009===d)return a.UNSIGNED_BYTE;if(1017===d)return a.UNSIGNED_SHORT_4_4_4_4;if(1018===d)return a.UNSIGNED_SHORT_5_5_5_1;if(1019===d)return a.UNSIGNED_SHORT_5_6_5;if(1010===d)return a.BYTE;if(1011===d)return a.SHORT;if(1012===d)return a.UNSIGNED_SHORT;if(1013===d)return a.INT;if(1014===d)return a.UNSIGNED_INT;if(1015===d)return a.FLOAT;if(1016===
d){if(c.isWebGL2)return a.HALF_FLOAT;var e=b.get("OES_texture_half_float");if(null!==e)return e.HALF_FLOAT_OES}if(1021===d)return a.ALPHA;if(1022===d)return a.RGB;if(1023===d)return a.RGBA;if(1024===d)return a.LUMINANCE;if(1025===d)return a.LUMINANCE_ALPHA;if(1026===d)return a.DEPTH_COMPONENT;if(1027===d)return a.DEPTH_STENCIL;if(100===d)return a.FUNC_ADD;if(101===d)return a.FUNC_SUBTRACT;if(102===d)return a.FUNC_REVERSE_SUBTRACT;if(200===d)return a.ZERO;if(201===d)return a.ONE;if(202===d)return a.SRC_COLOR;
if(203===d)return a.ONE_MINUS_SRC_COLOR;if(204===d)return a.SRC_ALPHA;if(205===d)return a.ONE_MINUS_SRC_ALPHA;if(206===d)return a.DST_ALPHA;if(207===d)return a.ONE_MINUS_DST_ALPHA;if(208===d)return a.DST_COLOR;if(209===d)return a.ONE_MINUS_DST_COLOR;if(210===d)return a.SRC_ALPHA_SATURATE;if(33776===d||33777===d||33778===d||33779===d)if(e=b.get("WEBGL_compressed_texture_s3tc"),null!==e){if(33776===d)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===d)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===
d)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===d)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===d||35841===d||35842===d||35843===d)if(e=b.get("WEBGL_compressed_texture_pvrtc"),null!==e){if(35840===d)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===d)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===d)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===d)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===d&&(e=b.get("WEBGL_compressed_texture_etc1"),null!==e))return e.COMPRESSED_RGB_ETC1_WEBGL;
if(37808===d||37809===d||37810===d||37811===d||37812===d||37813===d||37814===d||37815===d||37816===d||37817===d||37818===d||37819===d||37820===d||37821===d)if(e=b.get("WEBGL_compressed_texture_astc"),null!==e)return d;if(103===d||104===d){if(c.isWebGL2){if(103===d)return a.MIN;if(104===d)return a.MAX}e=b.get("EXT_blend_minmax");if(null!==e){if(103===d)return e.MIN_EXT;if(104===d)return e.MAX_EXT}}if(1020===d){if(c.isWebGL2)return a.UNSIGNED_INT_24_8;e=b.get("WEBGL_depth_texture");if(null!==e)return e.UNSIGNED_INT_24_8_WEBGL}return 0}}}
function Mb(){B.call(this);this.type="Group"}function ea(a,b,c,d){Qa.call(this);this.type="PerspectiveCamera";this.fov=void 0!==a?a:50;this.zoom=1;this.near=void 0!==c?c:.1;this.far=void 0!==d?d:2E3;this.focus=10;this.aspect=void 0!==b?b:1;this.view=null;this.filmGauge=35;this.filmOffset=0;this.updateProjectionMatrix()}function zc(a){ea.call(this);this.cameras=a||[]}function Ye(a){function b(){return null!==e&&!0===e.isPresenting}function c(){if(b()){var c=e.getEyeParameters("left"),f=c.renderWidth;
c=c.renderHeight;x=a.getPixelRatio();z=a.getSize();a.setDrawingBufferSize(2*f,c,1);y.start()}else d.enabled&&(a.setDrawingBufferSize(z.width,z.height,x),y.stop())}var d=this,e=null,f=null,g=null,h=[],k=new I,m=new I;"undefined"!==typeof window&&"VRFrameData"in window&&(f=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",c,!1));var q=new I,n=new ia,u=new p,t=new ea;t.bounds=new ca(0,0,.5,1);t.layers.enable(1);var r=new ea;r.bounds=new ca(.5,0,.5,1);r.layers.enable(2);var l=new zc([t,
r]);l.layers.enable(1);l.layers.enable(2);var z,x,w=[];this.enabled=!1;this.userHeight=1.6;this.getController=function(a){var b=h[a];void 0===b&&(b=new Mb,b.matrixAutoUpdate=!1,b.visible=!1,h[a]=b);return b};this.getDevice=function(){return e};this.setDevice=function(a){void 0!==a&&(e=a);y.setContext(a)};this.setPoseTarget=function(a){void 0!==a&&(g=a)};this.getCamera=function(a){if(null===e)return a.position.set(0,d.userHeight,0),a;e.depthNear=a.near;e.depthFar=a.far;e.getFrameData(f);var b=e.stageParameters;
b?k.fromArray(b.sittingToStandingTransform):k.makeTranslation(0,d.userHeight,0);b=f.pose;var c=null!==g?g:a;c.matrix.copy(k);c.matrix.decompose(c.position,c.quaternion,c.scale);null!==b.orientation&&(n.fromArray(b.orientation),c.quaternion.multiply(n));null!==b.position&&(n.setFromRotationMatrix(k),u.fromArray(b.position),u.applyQuaternion(n),c.position.add(u));c.updateMatrixWorld();if(!1===e.isPresenting)return a;t.near=a.near;r.near=a.near;t.far=a.far;r.far=a.far;l.matrixWorld.copy(a.matrixWorld);
l.matrixWorldInverse.copy(a.matrixWorldInverse);t.matrixWorldInverse.fromArray(f.leftViewMatrix);r.matrixWorldInverse.fromArray(f.rightViewMatrix);m.getInverse(k);t.matrixWorldInverse.multiply(m);r.matrixWorldInverse.multiply(m);a=c.parent;null!==a&&(q.getInverse(a.matrixWorld),t.matrixWorldInverse.multiply(q),r.matrixWorldInverse.multiply(q));t.matrixWorld.getInverse(t.matrixWorldInverse);r.matrixWorld.getInverse(r.matrixWorldInverse);t.projectionMatrix.fromArray(f.leftProjectionMatrix);r.projectionMatrix.fromArray(f.rightProjectionMatrix);
l.projectionMatrix.copy(t.projectionMatrix);a=e.getLayers();a.length&&(a=a[0],null!==a.leftBounds&&4===a.leftBounds.length&&t.bounds.fromArray(a.leftBounds),null!==a.rightBounds&&4===a.rightBounds.length&&r.bounds.fromArray(a.rightBounds));a:for(a=0;a<h.length;a++){b=h[a];b:{c=a;for(var v=navigator.getGamepads&&navigator.getGamepads(),p=0,z=0,x=v.length;p<x;p++){var y=v[p];if(y&&("Daydream Controller"===y.id||"Gear VR Controller"===y.id||"Oculus Go Controller"===y.id||"OpenVR Gamepad"===y.id||y.id.startsWith("Oculus Touch")||
y.id.startsWith("Spatial Controller"))){if(z===c){c=y;break b}z++}}c=void 0}if(void 0!==c&&void 0!==c.pose){if(null===c.pose)break a;v=c.pose;!1===v.hasPosition&&b.position.set(.2,-.6,-.05);null!==v.position&&b.position.fromArray(v.position);null!==v.orientation&&b.quaternion.fromArray(v.orientation);b.matrix.compose(b.position,b.quaternion,b.scale);b.matrix.premultiply(k);b.matrix.decompose(b.position,b.quaternion,b.scale);b.matrixWorldNeedsUpdate=!0;b.visible=!0;v="Daydream Controller"===c.id?0:
1;w[a]!==c.buttons[v].pressed&&(w[a]=c.buttons[v].pressed,!0===w[a]?b.dispatchEvent({type:"selectstart"}):(b.dispatchEvent({type:"selectend"}),b.dispatchEvent({type:"select"})))}else b.visible=!1}return l};this.getStandingMatrix=function(){return k};this.isPresenting=b;var y=new Qd;this.setAnimationLoop=function(a){y.setAnimationLoop(a)};this.submitFrame=function(){b()&&e.submitFrame()};this.dispose=function(){"undefined"!==typeof window&&window.removeEventListener("vrdisplaypresentchange",c)}}function Lg(a){function b(){return null!==
h&&null!==k}function c(a){var b=q[n.indexOf(a.inputSource)];b&&b.dispatchEvent({type:a.type})}function d(){a.setFramebuffer(null);p.stop()}function e(a,b){null===b?a.matrixWorld.copy(a.matrix):a.matrixWorld.multiplyMatrices(b.matrixWorld,a.matrix);a.matrixWorldInverse.getInverse(a.matrixWorld)}var f=a.context,g=null,h=null,k=null,m=null,q=[],n=[],u=new ea;u.layers.enable(1);u.viewport=new ca;var t=new ea;t.layers.enable(2);t.viewport=new ca;var r=new zc([u,t]);r.layers.enable(1);r.layers.enable(2);
this.enabled=!1;this.getController=function(a){var b=q[a];void 0===b&&(b=new Mb,b.matrixAutoUpdate=!1,b.visible=!1,q[a]=b);return b};this.getDevice=function(){return g};this.setDevice=function(a){void 0!==a&&(g=a);a instanceof XRDevice&&f.setCompatibleXRDevice(a)};this.setSession=function(b,e){h=b;null!==h&&(h.addEventListener("select",c),h.addEventListener("selectstart",c),h.addEventListener("selectend",c),h.addEventListener("end",d),h.baseLayer=new XRWebGLLayer(h,f),h.requestFrameOfReference(e.frameOfReferenceType).then(function(b){k=
b;a.setFramebuffer(h.baseLayer.framebuffer);p.setContext(h);p.start()}),n=h.getInputSources(),h.addEventListener("inputsourceschange",function(){n=h.getInputSources();console.log(n)}))};this.getCamera=function(a){if(b()){var c=a.parent,d=r.cameras;e(r,c);for(var f=0;f<d.length;f++)e(d[f],c);a.matrixWorld.copy(r.matrixWorld);a=a.children;f=0;for(c=a.length;f<c;f++)a[f].updateMatrixWorld(!0);return r}return a};this.isPresenting=b;var l=null,p=new Qd;p.setAnimationLoop(function(a,b){m=b.getDevicePose(k);
if(null!==m)for(var c=h.baseLayer,d=b.views,e=0;e<d.length;e++){var f=d[e],g=c.getViewport(f),u=m.getViewMatrix(f),t=r.cameras[e];t.matrix.fromArray(u).getInverse(t.matrix);t.projectionMatrix.fromArray(f.projectionMatrix);t.viewport.set(g.x,g.y,g.width,g.height);0===e&&(r.matrix.copy(t.matrix),r.projectionMatrix.copy(t.projectionMatrix))}for(e=0;e<q.length;e++){c=q[e];if(d=n[e])if(d=b.getInputPose(d,k),null!==d){c.matrix.elements=d.pointerMatrix;c.matrix.decompose(c.position,c.rotation,c.scale);c.visible=
!0;continue}c.visible=!1}l&&l(a)});this.setAnimationLoop=function(a){l=a};this.dispose=function(){};this.getStandingMatrix=function(){console.warn("THREE.WebXRManager: getStandingMatrix() is no longer needed.");return new THREE.Matrix4};this.submitFrame=function(){}}function Wd(a){var b;function c(){ja=new Of(D);xa=new Mf(D,ja,a);xa.isWebGL2||(ja.get("WEBGL_depth_texture"),ja.get("OES_texture_float"),ja.get("OES_texture_half_float"),ja.get("OES_texture_half_float_linear"),ja.get("OES_standard_derivatives"),
ja.get("OES_element_index_uint"),ja.get("ANGLE_instanced_arrays"));ja.get("OES_texture_float_linear");ka=new Xe(D,ja,xa);ba=new Kg(D,ja,ka,xa);ba.scissor(X.copy(qa).multiplyScalar(Z));ba.viewport(aa.copy(pa).multiplyScalar(Z));ha=new Rf(D);Y=new Mg;la=new Ng(D,ja,ba,Y,xa,ka,ha,z);ta=new Gf(D);va=new Pf(D,ta,ha);ra=new Uf(va,ha);ya=new Tf(D);ma=new Bg(V,ja,xa);ua=new Fg;sa=new Jg;na=new Kf(V,ba,ra,J);Aa=new Lf(D,ja,ha,xa);Ba=new Qf(D,ja,ha,xa);ha.programs=ma.programs;V.context=D;V.capabilities=xa;
V.extensions=ja;V.properties=Y;V.renderLists=ua;V.state=ba;V.info=ha}function d(a){a.preventDefault();console.log("THREE.WebGLRenderer: Context Lost.");G=!0}function e(){console.log("THREE.WebGLRenderer: Context Restored.");G=!1;c()}function f(a){a=a.target;a.removeEventListener("dispose",f);g(a);Y.remove(a)}function g(a){var b=Y.get(a).program;a.program=void 0;void 0!==b&&ma.releaseProgram(b)}function h(a,b){a.render(function(a){V.renderBufferImmediate(a,b)})}function k(a,b,c){if(!1!==a.visible){if(a.layers.test(b.layers))if(a.isLight)E.pushLight(a),
a.castShadow&&E.pushShadow(a);else if(a.isSprite){if(!a.frustumCulled||fa.intersectsSprite(a)){c&&fb.setFromMatrixPosition(a.matrixWorld).applyMatrix4(yc);var d=ra.update(a),e=a.material;B.push(a,d,e,fb.z,null)}}else if(a.isImmediateRenderObject)c&&fb.setFromMatrixPosition(a.matrixWorld).applyMatrix4(yc),B.push(a,null,a.material,fb.z,null);else if(a.isMesh||a.isLine||a.isPoints)if(a.isSkinnedMesh&&a.skeleton.update(),!a.frustumCulled||fa.intersectsObject(a))if(c&&fb.setFromMatrixPosition(a.matrixWorld).applyMatrix4(yc),
d=ra.update(a),e=a.material,Array.isArray(e))for(var f=d.groups,g=0,h=f.length;g<h;g++){var m=f[g],n=e[m.materialIndex];n&&n.visible&&B.push(a,d,n,fb.z,m)}else e.visible&&B.push(a,d,e,fb.z,null);a=a.children;g=0;for(h=a.length;g<h;g++)k(a[g],b,c)}}function m(a,b,c,d){for(var e=0,f=a.length;e<f;e++){var g=a[e],h=g.object,k=g.geometry,m=void 0===d?g.material:d;g=g.group;if(c.isArrayCamera){S=c;for(var n=c.cameras,u=0,t=n.length;u<t;u++){var l=n[u];if(h.layers.test(l.layers)){if("viewport"in l)ba.viewport(aa.copy(l.viewport));
else{var r=l.bounds;ba.viewport(aa.set(r.x*N,r.y*U,r.z*N,r.w*U).multiplyScalar(Z))}q(h,b,l,k,m,g)}}}else S=null,q(h,b,c,k,m,g)}}function q(a,c,d,e,f,g){a.onBeforeRender(V,c,d,e,f,g);E=sa.get(c,S||d);a.modelViewMatrix.multiplyMatrices(d.matrixWorldInverse,a.matrixWorld);a.normalMatrix.getNormalMatrix(a.modelViewMatrix);if(a.isImmediateRenderObject){ba.setMaterial(f);var k=u(d,c.fog,f,a);R=b=null;T=!1;h(a,k)}else V.renderBufferDirect(d,c.fog,e,f,a,g);a.onAfterRender(V,c,d,e,f,g);E=sa.get(c,S||d)}function n(a,
b,c){var d=Y.get(a),e=E.state.lights,h=d.lightsHash,k=e.state.hash;c=ma.getParameters(a,e.state,E.state.shadowsArray,b,Ga.numPlanes,Ga.numIntersection,c);var m=ma.getProgramCode(a,c),n=d.program,q=!0;if(void 0===n)a.addEventListener("dispose",f);else if(n.code!==m)g(a);else{if(h.stateID!==k.stateID||h.directionalLength!==k.directionalLength||h.pointLength!==k.pointLength||h.spotLength!==k.spotLength||h.rectAreaLength!==k.rectAreaLength||h.hemiLength!==k.hemiLength||h.shadowsLength!==k.shadowsLength)h.stateID=
k.stateID,h.directionalLength=k.directionalLength,h.pointLength=k.pointLength,h.spotLength=k.spotLength,h.rectAreaLength=k.rectAreaLength,h.hemiLength=k.hemiLength,h.shadowsLength=k.shadowsLength;else if(void 0!==c.shaderID)return;q=!1}q&&(c.shaderID?(m=rb[c.shaderID],d.shader={name:a.type,uniforms:Ea.clone(m.uniforms),vertexShader:m.vertexShader,fragmentShader:m.fragmentShader}):d.shader={name:a.type,uniforms:a.uniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader},a.onBeforeCompile(d.shader,
V),m=ma.getProgramCode(a,c),n=ma.acquireProgram(a,d.shader,c,m),d.program=n,a.program=n);c=n.getAttributes();if(a.morphTargets)for(m=a.numSupportedMorphTargets=0;m<V.maxMorphTargets;m++)0<=c["morphTarget"+m]&&a.numSupportedMorphTargets++;if(a.morphNormals)for(m=a.numSupportedMorphNormals=0;m<V.maxMorphNormals;m++)0<=c["morphNormal"+m]&&a.numSupportedMorphNormals++;c=d.shader.uniforms;if(!a.isShaderMaterial&&!a.isRawShaderMaterial||!0===a.clipping)d.numClippingPlanes=Ga.numPlanes,d.numIntersection=
Ga.numIntersection,c.clippingPlanes=Ga.uniform;d.fog=b;void 0===h&&(d.lightsHash=h={});h.stateID=k.stateID;h.directionalLength=k.directionalLength;h.pointLength=k.pointLength;h.spotLength=k.spotLength;h.rectAreaLength=k.rectAreaLength;h.hemiLength=k.hemiLength;h.shadowsLength=k.shadowsLength;a.lights&&(c.ambientLightColor.value=e.state.ambient,c.directionalLights.value=e.state.directional,c.spotLights.value=e.state.spot,c.rectAreaLights.value=e.state.rectArea,c.pointLights.value=e.state.point,c.hemisphereLights.value=
e.state.hemi,c.directionalShadowMap.value=e.state.directionalShadowMap,c.directionalShadowMatrix.value=e.state.directionalShadowMatrix,c.spotShadowMap.value=e.state.spotShadowMap,c.spotShadowMatrix.value=e.state.spotShadowMatrix,c.pointShadowMap.value=e.state.pointShadowMap,c.pointShadowMatrix.value=e.state.pointShadowMatrix);a=d.program.getUniforms();a=cb.seqWithValue(a.seq,c);d.uniformsList=a}function u(a,b,c,d){ia=0;var e=Y.get(c),f=e.lightsHash,g=E.state.lights.state.hash;nd&&(Vd||a!==W)&&Ga.setState(c.clippingPlanes,
c.clipIntersection,c.clipShadows,a,e,a===W&&c.id===F);!1===c.needsUpdate&&(void 0===e.program?c.needsUpdate=!0:c.fog&&e.fog!==b?c.needsUpdate=!0:!c.lights||f.stateID===g.stateID&&f.directionalLength===g.directionalLength&&f.pointLength===g.pointLength&&f.spotLength===g.spotLength&&f.rectAreaLength===g.rectAreaLength&&f.hemiLength===g.hemiLength&&f.shadowsLength===g.shadowsLength?void 0===e.numClippingPlanes||e.numClippingPlanes===Ga.numPlanes&&e.numIntersection===Ga.numIntersection||(c.needsUpdate=
!0):c.needsUpdate=!0);c.needsUpdate&&(n(c,b,d),c.needsUpdate=!1);var h=!1,k=!1,m=!1;f=e.program;g=f.getUniforms();var q=e.shader.uniforms;ba.useProgram(f.program)&&(m=k=h=!0);c.id!==F&&(F=c.id,k=!0);if(h||a!==W){g.setValue(D,"projectionMatrix",a.projectionMatrix);xa.logarithmicDepthBuffer&&g.setValue(D,"logDepthBufFC",2/(Math.log(a.far+1)/Math.LN2));W!==(S||a)&&(W=S||a,m=k=!0);if(c.isShaderMaterial||c.isMeshPhongMaterial||c.isMeshStandardMaterial||c.envMap)h=g.map.cameraPosition,void 0!==h&&h.setValue(D,
fb.setFromMatrixPosition(a.matrixWorld));(c.isMeshPhongMaterial||c.isMeshLambertMaterial||c.isMeshBasicMaterial||c.isMeshStandardMaterial||c.isShaderMaterial||c.skinning)&&g.setValue(D,"viewMatrix",a.matrixWorldInverse)}if(c.skinning&&(g.setOptional(D,d,"bindMatrix"),g.setOptional(D,d,"bindMatrixInverse"),a=d.skeleton))if(h=a.bones,xa.floatVertexTextures){if(void 0===a.boneTexture){h=Math.sqrt(4*h.length);h=Q.ceilPowerOfTwo(h);h=Math.max(h,4);var u=new Float32Array(h*h*4);u.set(a.boneMatrices);var r=
new kb(u,h,h,1023,1015);r.needsUpdate=!0;a.boneMatrices=u;a.boneTexture=r;a.boneTextureSize=h}g.setValue(D,"boneTexture",a.boneTexture);g.setValue(D,"boneTextureSize",a.boneTextureSize)}else g.setOptional(D,a,"boneMatrices");k&&(g.setValue(D,"toneMappingExposure",V.toneMappingExposure),g.setValue(D,"toneMappingWhitePoint",V.toneMappingWhitePoint),c.lights&&(k=m,q.ambientLightColor.needsUpdate=k,q.directionalLights.needsUpdate=k,q.pointLights.needsUpdate=k,q.spotLights.needsUpdate=k,q.rectAreaLights.needsUpdate=
k,q.hemisphereLights.needsUpdate=k),b&&c.fog&&(q.fogColor.value=b.color,b.isFog?(q.fogNear.value=b.near,q.fogFar.value=b.far):b.isFogExp2&&(q.fogDensity.value=b.density)),c.isMeshBasicMaterial?t(q,c):c.isMeshLambertMaterial?(t(q,c),c.emissiveMap&&(q.emissiveMap.value=c.emissiveMap)):c.isMeshPhongMaterial?(t(q,c),c.isMeshToonMaterial?(l(q,c),c.gradientMap&&(q.gradientMap.value=c.gradientMap)):l(q,c)):c.isMeshStandardMaterial?(t(q,c),c.isMeshPhysicalMaterial?(v(q,c),q.reflectivity.value=c.reflectivity,
q.clearCoat.value=c.clearCoat,q.clearCoatRoughness.value=c.clearCoatRoughness):v(q,c)):c.isMeshDepthMaterial?(t(q,c),c.displacementMap&&(q.displacementMap.value=c.displacementMap,q.displacementScale.value=c.displacementScale,q.displacementBias.value=c.displacementBias)):c.isMeshDistanceMaterial?(t(q,c),c.displacementMap&&(q.displacementMap.value=c.displacementMap,q.displacementScale.value=c.displacementScale,q.displacementBias.value=c.displacementBias),q.referencePosition.value.copy(c.referencePosition),
q.nearDistance.value=c.nearDistance,q.farDistance.value=c.farDistance):c.isMeshNormalMaterial?(t(q,c),c.bumpMap&&(q.bumpMap.value=c.bumpMap,q.bumpScale.value=c.bumpScale,1===c.side&&(q.bumpScale.value*=-1)),c.normalMap&&(q.normalMap.value=c.normalMap,q.normalScale.value.copy(c.normalScale),1===c.side&&q.normalScale.value.negate()),c.displacementMap&&(q.displacementMap.value=c.displacementMap,q.displacementScale.value=c.displacementScale,q.displacementBias.value=c.displacementBias)):c.isLineBasicMaterial?
(q.diffuse.value=c.color,q.opacity.value=c.opacity,c.isLineDashedMaterial&&(q.dashSize.value=c.dashSize,q.totalSize.value=c.dashSize+c.gapSize,q.scale.value=c.scale)):c.isPointsMaterial?(q.diffuse.value=c.color,q.opacity.value=c.opacity,q.size.value=c.size*Z,q.scale.value=.5*U,q.map.value=c.map,null!==c.map&&(!0===c.map.matrixAutoUpdate&&c.map.updateMatrix(),q.uvTransform.value.copy(c.map.matrix))):c.isSpriteMaterial?(q.diffuse.value=c.color,q.opacity.value=c.opacity,q.rotation.value=c.rotation,q.map.value=
c.map,null!==c.map&&(!0===c.map.matrixAutoUpdate&&c.map.updateMatrix(),q.uvTransform.value.copy(c.map.matrix))):c.isShadowMaterial&&(q.color.value=c.color,q.opacity.value=c.opacity),void 0!==q.ltc_1&&(q.ltc_1.value=M.LTC_1),void 0!==q.ltc_2&&(q.ltc_2.value=M.LTC_2),cb.upload(D,e.uniformsList,q,V));c.isShaderMaterial&&!0===c.uniformsNeedUpdate&&(cb.upload(D,e.uniformsList,q,V),c.uniformsNeedUpdate=!1);c.isSpriteMaterial&&g.setValue(D,"center",d.center);g.setValue(D,"modelViewMatrix",d.modelViewMatrix);
g.setValue(D,"normalMatrix",d.normalMatrix);g.setValue(D,"modelMatrix",d.matrixWorld);return f}function t(a,b){a.opacity.value=b.opacity;b.color&&(a.diffuse.value=b.color);b.emissive&&a.emissive.value.copy(b.emissive).multiplyScalar(b.emissiveIntensity);b.map&&(a.map.value=b.map);b.alphaMap&&(a.alphaMap.value=b.alphaMap);b.specularMap&&(a.specularMap.value=b.specularMap);b.envMap&&(a.envMap.value=b.envMap,a.flipEnvMap.value=b.envMap&&b.envMap.isCubeTexture?-1:1,a.reflectivity.value=b.reflectivity,
a.refractionRatio.value=b.refractionRatio,a.maxMipLevel.value=Y.get(b.envMap).__maxMipLevel);b.lightMap&&(a.lightMap.value=b.lightMap,a.lightMapIntensity.value=b.lightMapIntensity);b.aoMap&&(a.aoMap.value=b.aoMap,a.aoMapIntensity.value=b.aoMapIntensity);if(b.map)var c=b.map;else b.specularMap?c=b.specularMap:b.displacementMap?c=b.displacementMap:b.normalMap?c=b.normalMap:b.bumpMap?c=b.bumpMap:b.roughnessMap?c=b.roughnessMap:b.metalnessMap?c=b.metalnessMap:b.alphaMap?c=b.alphaMap:b.emissiveMap&&(c=
b.emissiveMap);void 0!==c&&(c.isWebGLRenderTarget&&(c=c.texture),!0===c.matrixAutoUpdate&&c.updateMatrix(),a.uvTransform.value.copy(c.matrix))}function l(a,b){a.specular.value=b.specular;a.shininess.value=Math.max(b.shininess,1E-4);b.emissiveMap&&(a.emissiveMap.value=b.emissiveMap);b.bumpMap&&(a.bumpMap.value=b.bumpMap,a.bumpScale.value=b.bumpScale,1===b.side&&(a.bumpScale.value*=-1));b.normalMap&&(a.normalMap.value=b.normalMap,a.normalScale.value.copy(b.normalScale),1===b.side&&a.normalScale.value.negate());
b.displacementMap&&(a.displacementMap.value=b.displacementMap,a.displacementScale.value=b.displacementScale,a.displacementBias.value=b.displacementBias)}function v(a,b){a.roughness.value=b.roughness;a.metalness.value=b.metalness;b.roughnessMap&&(a.roughnessMap.value=b.roughnessMap);b.metalnessMap&&(a.metalnessMap.value=b.metalnessMap);b.emissiveMap&&(a.emissiveMap.value=b.emissiveMap);b.bumpMap&&(a.bumpMap.value=b.bumpMap,a.bumpScale.value=b.bumpScale,1===b.side&&(a.bumpScale.value*=-1));b.normalMap&&
(a.normalMap.value=b.normalMap,a.normalScale.value.copy(b.normalScale),1===b.side&&a.normalScale.value.negate());b.displacementMap&&(a.displacementMap.value=b.displacementMap,a.displacementScale.value=b.displacementScale,a.displacementBias.value=b.displacementBias);b.envMap&&(a.envMapIntensity.value=b.envMapIntensity)}console.log("THREE.WebGLRenderer","95");var z=new Pg;a=a||{};var x=void 0!==a.canvas?a.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),w=void 0!==a.context?
a.context:null,y=void 0!==a.alpha?a.alpha:!1,H=void 0!==a.depth?a.depth:!0,O=void 0!==a.stencil?a.stencil:!0,da=void 0!==a.antialias?a.antialias:!1,J=void 0!==a.premultipliedAlpha?a.premultipliedAlpha:!0,C=void 0!==a.preserveDrawingBuffer?a.preserveDrawingBuffer:!1,A=void 0!==a.powerPreference?a.powerPreference:"default",B=null,E=null;this.domElement=x;this.context=null;this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.clippingPlanes=[];this.localClippingEnabled=
!1;this.gammaFactor=2;this.physicallyCorrectLights=this.gammaOutput=this.gammaInput=!1;this.toneMappingWhitePoint=this.toneMappingExposure=this.toneMapping=1;this.maxMorphTargets=8;this.maxMorphNormals=4;var V=this,G=!1,L=null,K=null,P=null,F=-1;var R=b=null;var T=!1;var W=null,S=null,aa=new ca,X=new ca,ea=null,ia=0,N=x.width,U=x.height,Z=1,pa=new ca(0,0,N,U),qa=new ca(0,0,N,U),wa=!1,fa=new ld,Ga=new Nf,nd=!1,Vd=!1,yc=new I,fb=new p;try{y={alpha:y,depth:H,stencil:O,antialias:da,premultipliedAlpha:J,
preserveDrawingBuffer:C,powerPreference:A};x.addEventListener("webglcontextlost",d,!1);x.addEventListener("webglcontextrestored",e,!1);var D=w||x.getContext("webgl",y)||x.getContext("experimental-webgl",y);if(null===D){if(null!==x.getContext("webgl"))throw Error("Error creating WebGL context with your selected attributes.");throw Error("Error creating WebGL context.");}void 0===D.getShaderPrecisionFormat&&(D.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Og){console.error("THREE.WebGLRenderer: "+
Og.message)}var ja,xa,ba,ha,Y,la,ta,va,ra,ma,ua,sa,na,ya,Aa,Ba,ka;c();var oa="xr"in navigator?new Lg(V):new Ye(V);this.vr=oa;var Da=new We(V,ra,xa.maxTextureSize);this.shadowMap=Da;this.getContext=function(){return D};this.getContextAttributes=function(){return D.getContextAttributes()};this.forceContextLoss=function(){var a=ja.get("WEBGL_lose_context");a&&a.loseContext()};this.forceContextRestore=function(){var a=ja.get("WEBGL_lose_context");a&&a.restoreContext()};this.getPixelRatio=function(){return Z};
this.setPixelRatio=function(a){void 0!==a&&(Z=a,this.setSize(N,U,!1))};this.getSize=function(){return{width:N,height:U}};this.setSize=function(a,b,c){oa.isPresenting()?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(N=a,U=b,x.width=a*Z,x.height=b*Z,!1!==c&&(x.style.width=a+"px",x.style.height=b+"px"),this.setViewport(0,0,a,b))};this.getDrawingBufferSize=function(){return{width:N*Z,height:U*Z}};this.setDrawingBufferSize=function(a,b,c){N=a;U=b;Z=c;x.width=a*c;
x.height=b*c;this.setViewport(0,0,a,b)};this.getCurrentViewport=function(){return aa};this.setViewport=function(a,b,c,d){pa.set(a,U-b-d,c,d);ba.viewport(aa.copy(pa).multiplyScalar(Z))};this.setScissor=function(a,b,c,d){qa.set(a,U-b-d,c,d);ba.scissor(X.copy(qa).multiplyScalar(Z))};this.setScissorTest=function(a){ba.setScissorTest(wa=a)};this.getClearColor=function(){return na.getClearColor()};this.setClearColor=function(){na.setClearColor.apply(na,arguments)};this.getClearAlpha=function(){return na.getClearAlpha()};
this.setClearAlpha=function(){na.setClearAlpha.apply(na,arguments)};this.clear=function(a,b,c){var d=0;if(void 0===a||a)d|=D.COLOR_BUFFER_BIT;if(void 0===b||b)d|=D.DEPTH_BUFFER_BIT;if(void 0===c||c)d|=D.STENCIL_BUFFER_BIT;D.clear(d)};this.clearColor=function(){this.clear(!0,!1,!1)};this.clearDepth=function(){this.clear(!1,!0,!1)};this.clearStencil=function(){this.clear(!1,!1,!0)};this.clearTarget=function(a,b,c,d){this.setRenderTarget(a);this.clear(b,c,d)};this.dispose=function(){x.removeEventListener("webglcontextlost",
d,!1);x.removeEventListener("webglcontextrestored",e,!1);ua.dispose();sa.dispose();Y.dispose();ra.dispose();ma.disposeCached();z.textureCache.dispose();oa.dispose();za.stop()};this.renderBufferImmediate=function(a,b){ba.initAttributes();var c=Y.get(a);a.hasPositions&&!c.position&&(c.position=D.createBuffer());a.hasNormals&&!c.normal&&(c.normal=D.createBuffer());a.hasUvs&&!c.uv&&(c.uv=D.createBuffer());a.hasColors&&!c.color&&(c.color=D.createBuffer());b=b.getAttributes();a.hasPositions&&(D.bindBuffer(D.ARRAY_BUFFER,
c.position),D.bufferData(D.ARRAY_BUFFER,a.positionArray,D.DYNAMIC_DRAW),ba.enableAttribute(b.position),D.vertexAttribPointer(b.position,3,D.FLOAT,!1,0,0));a.hasNormals&&(D.bindBuffer(D.ARRAY_BUFFER,c.normal),D.bufferData(D.ARRAY_BUFFER,a.normalArray,D.DYNAMIC_DRAW),ba.enableAttribute(b.normal),D.vertexAttribPointer(b.normal,3,D.FLOAT,!1,0,0));a.hasUvs&&(D.bindBuffer(D.ARRAY_BUFFER,c.uv),D.bufferData(D.ARRAY_BUFFER,a.uvArray,D.DYNAMIC_DRAW),ba.enableAttribute(b.uv),D.vertexAttribPointer(b.uv,2,D.FLOAT,
!1,0,0));a.hasColors&&(D.bindBuffer(D.ARRAY_BUFFER,c.color),D.bufferData(D.ARRAY_BUFFER,a.colorArray,D.DYNAMIC_DRAW),ba.enableAttribute(b.color),D.vertexAttribPointer(b.color,3,D.FLOAT,!1,0,0));ba.disableUnusedAttributes();D.drawArrays(D.TRIANGLES,0,a.count);a.count=0};this.renderBufferDirect=function(a,c,d,e,f,g){var h=f.isMesh&&0>f.normalMatrix.determinant();ba.setMaterial(e,h);var k=u(a,c,e,f),m=!1;if(b!==d.id||R!==k.id||T!==(!0===e.wireframe))b=d.id,R=k.id,T=!0===e.wireframe,m=!0;f.morphTargetInfluences&&
(ya.update(f,d,e,k),m=!0);h=d.index;var q=d.attributes.position;c=1;!0===e.wireframe&&(h=va.getWireframeAttribute(d),c=2);a=Aa;if(null!==h){var n=ta.get(h);a=Ba;a.setIndex(n)}if(m){if(d&&d.isInstancedBufferGeometry&&!xa.isWebGL2&&null===ja.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{ba.initAttributes();m=d.attributes;k=k.getAttributes();var t=e.defaultAttributeValues;
for(O in k){var l=k[O];if(0<=l){var r=m[O];if(void 0!==r){var v=r.normalized,p=r.itemSize,w=ta.get(r);if(void 0!==w){var z=w.buffer,y=w.type;w=w.bytesPerElement;if(r.isInterleavedBufferAttribute){var x=r.data,H=x.stride;r=r.offset;x&&x.isInstancedInterleavedBuffer?(ba.enableAttributeAndDivisor(l,x.meshPerAttribute),void 0===d.maxInstancedCount&&(d.maxInstancedCount=x.meshPerAttribute*x.count)):ba.enableAttribute(l);D.bindBuffer(D.ARRAY_BUFFER,z);D.vertexAttribPointer(l,p,y,v,H*w,r*w)}else r.isInstancedBufferAttribute?
(ba.enableAttributeAndDivisor(l,r.meshPerAttribute),void 0===d.maxInstancedCount&&(d.maxInstancedCount=r.meshPerAttribute*r.count)):ba.enableAttribute(l),D.bindBuffer(D.ARRAY_BUFFER,z),D.vertexAttribPointer(l,p,y,v,0,0)}}else if(void 0!==t&&(v=t[O],void 0!==v))switch(v.length){case 2:D.vertexAttrib2fv(l,v);break;case 3:D.vertexAttrib3fv(l,v);break;case 4:D.vertexAttrib4fv(l,v);break;default:D.vertexAttrib1fv(l,v)}}}ba.disableUnusedAttributes()}null!==h&&D.bindBuffer(D.ELEMENT_ARRAY_BUFFER,n.buffer)}n=
Infinity;null!==h?n=h.count:void 0!==q&&(n=q.count);h=d.drawRange.start*c;q=null!==g?g.start*c:0;var O=Math.max(h,q);g=Math.max(0,Math.min(n,h+d.drawRange.count*c,q+(null!==g?g.count*c:Infinity))-1-O+1);if(0!==g){if(f.isMesh)if(!0===e.wireframe)ba.setLineWidth(e.wireframeLinewidth*(null===K?Z:1)),a.setMode(D.LINES);else switch(f.drawMode){case 0:a.setMode(D.TRIANGLES);break;case 1:a.setMode(D.TRIANGLE_STRIP);break;case 2:a.setMode(D.TRIANGLE_FAN)}else f.isLine?(e=e.linewidth,void 0===e&&(e=1),ba.setLineWidth(e*
(null===K?Z:1)),f.isLineSegments?a.setMode(D.LINES):f.isLineLoop?a.setMode(D.LINE_LOOP):a.setMode(D.LINE_STRIP)):f.isPoints?a.setMode(D.POINTS):f.isSprite&&a.setMode(D.TRIANGLES);d&&d.isInstancedBufferGeometry?0<d.maxInstancedCount&&a.renderInstances(d,O,g):a.render(O,g)}};this.compile=function(a,b){E=sa.get(a,b);E.init();a.traverse(function(a){a.isLight&&(E.pushLight(a),a.castShadow&&E.pushShadow(a))});E.setupLights(b);a.traverse(function(b){if(b.material)if(Array.isArray(b.material))for(var c=0;c<
b.material.length;c++)n(b.material[c],a.fog,b);else n(b.material,a.fog,b)})};var Ca=null,za=new Qd;za.setAnimationLoop(function(a){oa.isPresenting()||Ca&&Ca(a)});"undefined"!==typeof window&&za.setContext(window);this.setAnimationLoop=function(a){Ca=a;oa.setAnimationLoop(a);za.start()};this.render=function(a,c,d,e){if(!c||!c.isCamera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else if(!G){R=b=null;T=!1;F=-1;W=null;!0===a.autoUpdate&&a.updateMatrixWorld();
null===c.parent&&c.updateMatrixWorld();oa.enabled&&(c=oa.getCamera(c));E=sa.get(a,c);E.init();a.onBeforeRender(V,a,c,d);yc.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse);fa.setFromMatrix(yc);Vd=this.localClippingEnabled;nd=Ga.init(this.clippingPlanes,Vd,c);B=ua.get(a,c);B.init();k(a,c,V.sortObjects);!0===V.sortObjects&&B.sort();nd&&Ga.beginShadows();Da.render(E.state.shadowsArray,a,c);E.setupLights(c);nd&&Ga.endShadows();this.info.autoReset&&this.info.reset();void 0===d&&(d=null);this.setRenderTarget(d);
na.render(B,a,c,e);e=B.opaque;var f=B.transparent;if(a.overrideMaterial){var g=a.overrideMaterial;e.length&&m(e,a,c,g);f.length&&m(f,a,c,g)}else e.length&&m(e,a,c),f.length&&m(f,a,c);d&&la.updateRenderTargetMipmap(d);ba.buffers.depth.setTest(!0);ba.buffers.depth.setMask(!0);ba.buffers.color.setMask(!0);ba.setPolygonOffset(!1);a.onAfterRender(V,a,c);oa.enabled&&oa.submitFrame();E=B=null}};this.allocTextureUnit=function(){var a=ia;a>=xa.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+
a+" texture units while this GPU supports only "+xa.maxTextures);ia+=1;return a};this.setTexture2D=function(){var a=!1;return function(b,c){b&&b.isWebGLRenderTarget&&(a||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),a=!0),b=b.texture);la.setTexture2D(b,c)}}();this.setTexture=function(){var a=!1;return function(b,c){a||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),a=!0);la.setTexture2D(b,
c)}}();this.setTextureCube=function(){var a=!1;return function(b,c){b&&b.isWebGLRenderTargetCube&&(a||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),a=!0),b=b.texture);b&&b.isCubeTexture||Array.isArray(b.images)&&6===b.images.length?la.setTextureCube(b,c):la.setTextureCubeDynamic(b,c)}}();this.setFramebuffer=function(a){L=a};this.getRenderTarget=function(){return K};this.setRenderTarget=function(a){(K=a)&&void 0===
Y.get(a).__webglFramebuffer&&la.setupRenderTarget(a);var b=L,c=!1;a?(b=Y.get(a).__webglFramebuffer,a.isWebGLRenderTargetCube&&(b=b[a.activeCubeFace],c=!0),aa.copy(a.viewport),X.copy(a.scissor),ea=a.scissorTest):(aa.copy(pa).multiplyScalar(Z),X.copy(qa).multiplyScalar(Z),ea=wa);P!==b&&(D.bindFramebuffer(D.FRAMEBUFFER,b),P=b);ba.viewport(aa);ba.scissor(X);ba.setScissorTest(ea);c&&(c=Y.get(a.texture),D.framebufferTexture2D(D.FRAMEBUFFER,D.COLOR_ATTACHMENT0,D.TEXTURE_CUBE_MAP_POSITIVE_X+a.activeCubeFace,
c.__webglTexture,a.activeMipMapLevel))};this.readRenderTargetPixels=function(a,b,c,d,e,f){if(a&&a.isWebGLRenderTarget){var g=Y.get(a).__webglFramebuffer;if(g){var h=!1;g!==P&&(D.bindFramebuffer(D.FRAMEBUFFER,g),h=!0);try{var k=a.texture,m=k.format,q=k.type;1023!==m&&ka.convert(m)!==D.getParameter(D.IMPLEMENTATION_COLOR_READ_FORMAT)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):1009===q||ka.convert(q)===D.getParameter(D.IMPLEMENTATION_COLOR_READ_TYPE)||
1015===q&&(xa.isWebGL2||ja.get("OES_texture_float")||ja.get("WEBGL_color_buffer_float"))||1016===q&&(xa.isWebGL2?ja.get("EXT_color_buffer_float"):ja.get("EXT_color_buffer_half_float"))?D.checkFramebufferStatus(D.FRAMEBUFFER)===D.FRAMEBUFFER_COMPLETE?0<=b&&b<=a.width-d&&0<=c&&c<=a.height-e&&D.readPixels(b,c,d,e,ka.convert(m),ka.convert(q),f):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{h&&
D.bindFramebuffer(D.FRAMEBUFFER,P)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")};this.copyFramebufferToTexture=function(a,b,c){var d=b.image.width,e=b.image.height,f=ka.convert(b.format);this.setTexture2D(b,0);D.copyTexImage2D(D.TEXTURE_2D,c||0,f,a.x,a.y,d,e,0)};this.copyTextureToTexture=function(a,b,c,d){var e=b.image.width,f=b.image.height,g=ka.convert(c.format),h=ka.convert(c.type);this.setTexture2D(c,0);b.isDataTexture?D.texSubImage2D(D.TEXTURE_2D,
d||0,a.x,a.y,e,f,g,h,b.image.data):D.texSubImage2D(D.TEXTURE_2D,d||0,a.x,a.y,g,h,b.image)}}function Nb(a,b){this.name="";this.color=new G(a);this.density=void 0!==b?b:2.5E-4}function Ob(a,b,c){this.name="";this.color=new G(a);this.near=void 0!==b?b:1;this.far=void 0!==c?c:1E3}function od(){B.call(this);this.type="Scene";this.overrideMaterial=this.fog=this.background=null;this.autoUpdate=!0}function sb(a,b){this.array=a;this.stride=b;this.count=void 0!==a?a.length/b:0;this.dynamic=!1;this.updateRange=
{offset:0,count:-1};this.version=0}function Ac(a,b,c,d){this.data=a;this.itemSize=b;this.offset=c;this.normalized=!0===d}function gb(a){F.call(this);this.type="SpriteMaterial";this.color=new G(16777215);this.map=null;this.rotation=0;this.lights=!1;this.transparent=!0;this.setValues(a)}function Bc(a){B.call(this);this.type="Sprite";if(void 0===Pb){Pb=new E;var b=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]);b=new sb(b,5);Pb.setIndex([0,1,2,0,2,3]);Pb.addAttribute("position",
new Ac(b,3,0,!1));Pb.addAttribute("uv",new Ac(b,2,3,!1))}this.geometry=Pb;this.material=void 0!==a?a:new gb;this.center=new C(.5,.5)}function Cc(){B.call(this);this.type="LOD";Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function Dc(a,b){a=a||[];this.bones=a.slice(0);this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===b)this.calculateInverses();else if(this.bones.length===b.length)this.boneInverses=b.slice(0);else for(console.warn("THREE.Skeleton boneInverses is the wrong length."),
this.boneInverses=[],a=0,b=this.bones.length;a<b;a++)this.boneInverses.push(new I)}function pd(){B.call(this);this.type="Bone"}function qd(a,b){ra.call(this,a,b);this.type="SkinnedMesh";this.bindMode="attached";this.bindMatrix=new I;this.bindMatrixInverse=new I;a=this.initBones();a=new Dc(a);this.bind(a,this.matrixWorld);this.normalizeSkinWeights()}function T(a){F.call(this);this.type="LineBasicMaterial";this.color=new G(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.lights=!1;
this.setValues(a);this.attributes=["position","color"]}function ma(a,b,c){1===c&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead.");B.call(this);this.type="Line";this.geometry=void 0!==a?a:new E;this.material=void 0!==b?b:new T({color:16777215*Math.random()})}function W(a,b){ma.call(this,a,b);this.type="LineSegments"}function rd(a,b){ma.call(this,a,b);this.type="LineLoop"}function Ha(a){F.call(this);this.type="PointsMaterial";this.color=new G(16777215);
this.map=null;this.size=1;this.sizeAttenuation=!0;this.lights=this.morphTargets=!1;this.setValues(a)}function Qb(a,b){B.call(this);this.type="Points";this.geometry=void 0!==a?a:new E;this.material=void 0!==b?b:new Ha({color:16777215*Math.random()})}function Xd(a,b,c,d,e,f,g,h,k){ta.call(this,a,b,c,d,e,f,g,h,k);this.generateMipmaps=!1}function Rb(a,b,c,d,e,f,g,h,k,m,q,n){ta.call(this,null,f,g,h,k,m,d,e,q,n);this.image={width:b,height:c};this.mipmaps=a;this.generateMipmaps=this.flipY=!1}function Ec(a,
b,c,d,e,f,g,h,k,m){m=void 0!==m?m:1026;if(1026!==m&&1027!==m)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===c&&1026===m&&(c=1012);void 0===c&&1027===m&&(c=1020);ta.call(this,null,d,e,f,g,h,m,c,k);this.image={width:a,height:b};this.magFilter=void 0!==g?g:1003;this.minFilter=void 0!==h?h:1003;this.generateMipmaps=this.flipY=!1}function Sb(a){E.call(this);this.type="WireframeGeometry";var b=[],c,d,e,f=[0,0],g={},h=["a","b","c"];if(a&&a.isGeometry){var k=
a.faces;var m=0;for(d=k.length;m<d;m++){var q=k[m];for(c=0;3>c;c++){var n=q[h[c]];var u=q[h[(c+1)%3]];f[0]=Math.min(n,u);f[1]=Math.max(n,u);n=f[0]+","+f[1];void 0===g[n]&&(g[n]={index1:f[0],index2:f[1]})}}for(n in g)m=g[n],h=a.vertices[m.index1],b.push(h.x,h.y,h.z),h=a.vertices[m.index2],b.push(h.x,h.y,h.z)}else if(a&&a.isBufferGeometry)if(h=new p,null!==a.index){k=a.attributes.position;q=a.index;var t=a.groups;0===t.length&&(t=[{start:0,count:q.count,materialIndex:0}]);a=0;for(e=t.length;a<e;++a)for(m=
t[a],c=m.start,d=m.count,m=c,d=c+d;m<d;m+=3)for(c=0;3>c;c++)n=q.getX(m+c),u=q.getX(m+(c+1)%3),f[0]=Math.min(n,u),f[1]=Math.max(n,u),n=f[0]+","+f[1],void 0===g[n]&&(g[n]={index1:f[0],index2:f[1]});for(n in g)m=g[n],h.fromBufferAttribute(k,m.index1),b.push(h.x,h.y,h.z),h.fromBufferAttribute(k,m.index2),b.push(h.x,h.y,h.z)}else for(k=a.attributes.position,m=0,d=k.count/3;m<d;m++)for(c=0;3>c;c++)g=3*m+c,h.fromBufferAttribute(k,g),b.push(h.x,h.y,h.z),g=3*m+(c+1)%3,h.fromBufferAttribute(k,g),b.push(h.x,
h.y,h.z);this.addAttribute("position",new A(b,3))}function Fc(a,b,c){K.call(this);this.type="ParametricGeometry";this.parameters={func:a,slices:b,stacks:c};this.fromBufferGeometry(new Tb(a,b,c));this.mergeVertices()}function Tb(a,b,c){E.call(this);this.type="ParametricBufferGeometry";this.parameters={func:a,slices:b,stacks:c};var d=[],e=[],f=[],g=[],h=new p,k=new p,m=new p,q=new p,n=new p,u,t;3>a.length&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");
var l=b+1;for(u=0;u<=c;u++){var v=u/c;for(t=0;t<=b;t++){var z=t/b;a(z,v,k);e.push(k.x,k.y,k.z);0<=z-1E-5?(a(z-1E-5,v,m),q.subVectors(k,m)):(a(z+1E-5,v,m),q.subVectors(m,k));0<=v-1E-5?(a(z,v-1E-5,m),n.subVectors(k,m)):(a(z,v+1E-5,m),n.subVectors(m,k));h.crossVectors(q,n).normalize();f.push(h.x,h.y,h.z);g.push(z,v)}}for(u=0;u<c;u++)for(t=0;t<b;t++)a=u*l+t+1,h=(u+1)*l+t+1,k=(u+1)*l+t,d.push(u*l+t,a,k),d.push(a,h,k);this.setIndex(d);this.addAttribute("position",new A(e,3));this.addAttribute("normal",
new A(f,3));this.addAttribute("uv",new A(g,2))}function Gc(a,b,c,d){K.call(this);this.type="PolyhedronGeometry";this.parameters={vertices:a,indices:b,radius:c,detail:d};this.fromBufferGeometry(new ua(a,b,c,d));this.mergeVertices()}function ua(a,b,c,d){function e(a){h.push(a.x,a.y,a.z)}function f(b,c){b*=3;c.x=a[b+0];c.y=a[b+1];c.z=a[b+2]}function g(a,b,c,d){0>d&&1===a.x&&(k[b]=a.x-1);0===c.x&&0===c.z&&(k[b]=d/2/Math.PI+.5)}E.call(this);this.type="PolyhedronBufferGeometry";this.parameters={vertices:a,
indices:b,radius:c,detail:d};c=c||1;d=d||0;var h=[],k=[];(function(a){for(var c=new p,d=new p,g=new p,h=0;h<b.length;h+=3){f(b[h+0],c);f(b[h+1],d);f(b[h+2],g);var k,m,l=c,x=d,w=g,y=Math.pow(2,a),H=[];for(m=0;m<=y;m++){H[m]=[];var O=l.clone().lerp(w,m/y),da=x.clone().lerp(w,m/y),J=y-m;for(k=0;k<=J;k++)H[m][k]=0===k&&m===y?O:O.clone().lerp(da,k/J)}for(m=0;m<y;m++)for(k=0;k<2*(y-m)-1;k++)l=Math.floor(k/2),0===k%2?(e(H[m][l+1]),e(H[m+1][l]),e(H[m][l])):(e(H[m][l+1]),e(H[m+1][l+1]),e(H[m+1][l]))}})(d);
(function(a){for(var b=new p,c=0;c<h.length;c+=3)b.x=h[c+0],b.y=h[c+1],b.z=h[c+2],b.normalize().multiplyScalar(a),h[c+0]=b.x,h[c+1]=b.y,h[c+2]=b.z})(c);(function(){for(var a=new p,b=0;b<h.length;b+=3)a.x=h[b+0],a.y=h[b+1],a.z=h[b+2],k.push(Math.atan2(a.z,-a.x)/2/Math.PI+.5,1-(Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+.5));a=new p;b=new p;for(var c=new p,d=new p,e=new C,f=new C,l=new C,z=0,x=0;z<h.length;z+=9,x+=6){a.set(h[z+0],h[z+1],h[z+2]);b.set(h[z+3],h[z+4],h[z+5]);c.set(h[z+6],h[z+
7],h[z+8]);e.set(k[x+0],k[x+1]);f.set(k[x+2],k[x+3]);l.set(k[x+4],k[x+5]);d.copy(a).add(b).add(c).divideScalar(3);var w=Math.atan2(d.z,-d.x);g(e,x+0,a,w);g(f,x+2,b,w);g(l,x+4,c,w)}for(a=0;a<k.length;a+=6)b=k[a+0],c=k[a+2],d=k[a+4],e=Math.min(b,c,d),.9<Math.max(b,c,d)&&.1>e&&(.2>b&&(k[a+0]+=1),.2>c&&(k[a+2]+=1),.2>d&&(k[a+4]+=1))})();this.addAttribute("position",new A(h,3));this.addAttribute("normal",new A(h.slice(),3));this.addAttribute("uv",new A(k,2));0===d?this.computeVertexNormals():this.normalizeNormals()}
function Hc(a,b){K.call(this);this.type="TetrahedronGeometry";this.parameters={radius:a,detail:b};this.fromBufferGeometry(new Ub(a,b));this.mergeVertices()}function Ub(a,b){ua.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],a,b);this.type="TetrahedronBufferGeometry";this.parameters={radius:a,detail:b}}function Ic(a,b){K.call(this);this.type="OctahedronGeometry";this.parameters={radius:a,detail:b};this.fromBufferGeometry(new tb(a,b));this.mergeVertices()}function tb(a,b){ua.call(this,
[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],a,b);this.type="OctahedronBufferGeometry";this.parameters={radius:a,detail:b}}function Jc(a,b){K.call(this);this.type="IcosahedronGeometry";this.parameters={radius:a,detail:b};this.fromBufferGeometry(new Vb(a,b));this.mergeVertices()}function Vb(a,b){var c=(1+Math.sqrt(5))/2;ua.call(this,[-1,c,0,1,c,0,-1,-c,0,1,-c,0,0,-1,c,0,1,c,0,-1,-c,0,1,-c,c,0,-1,c,0,1,-c,0,-1,-c,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,
1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a,b);this.type="IcosahedronBufferGeometry";this.parameters={radius:a,detail:b}}function Kc(a,b){K.call(this);this.type="DodecahedronGeometry";this.parameters={radius:a,detail:b};this.fromBufferGeometry(new Wb(a,b));this.mergeVertices()}function Wb(a,b){var c=(1+Math.sqrt(5))/2,d=1/c;ua.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-d,-c,0,-d,c,0,d,-c,0,d,c,-d,-c,0,-d,c,0,d,-c,
0,d,c,0,-c,0,-d,c,0,-d,-c,0,d,c,0,d],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a,b);this.type="DodecahedronBufferGeometry";this.parameters={radius:a,detail:b}}function Lc(a,b,c,d,e,f){K.call(this);this.type="TubeGeometry";this.parameters={path:a,tubularSegments:b,radius:c,radialSegments:d,
closed:e};void 0!==f&&console.warn("THREE.TubeGeometry: taper has been removed.");a=new Xb(a,b,c,d,e);this.tangents=a.tangents;this.normals=a.normals;this.binormals=a.binormals;this.fromBufferGeometry(a);this.mergeVertices()}function Xb(a,b,c,d,e){function f(e){q=a.getPointAt(e/b,q);var f=g.normals[e];e=g.binormals[e];for(u=0;u<=d;u++){var m=u/d*Math.PI*2,n=Math.sin(m);m=-Math.cos(m);k.x=m*f.x+n*e.x;k.y=m*f.y+n*e.y;k.z=m*f.z+n*e.z;k.normalize();r.push(k.x,k.y,k.z);h.x=q.x+c*k.x;h.y=q.y+c*k.y;h.z=
q.z+c*k.z;l.push(h.x,h.y,h.z)}}E.call(this);this.type="TubeBufferGeometry";this.parameters={path:a,tubularSegments:b,radius:c,radialSegments:d,closed:e};b=b||64;c=c||1;d=d||8;e=e||!1;var g=a.computeFrenetFrames(b,e);this.tangents=g.tangents;this.normals=g.normals;this.binormals=g.binormals;var h=new p,k=new p,m=new C,q=new p,n,u,l=[],r=[],v=[],z=[];for(n=0;n<b;n++)f(n);f(!1===e?b:0);for(n=0;n<=b;n++)for(u=0;u<=d;u++)m.x=n/b,m.y=u/d,v.push(m.x,m.y);(function(){for(u=1;u<=b;u++)for(n=1;n<=d;n++){var a=
(d+1)*u+(n-1),c=(d+1)*u+n,e=(d+1)*(u-1)+n;z.push((d+1)*(u-1)+(n-1),a,e);z.push(a,c,e)}})();this.setIndex(z);this.addAttribute("position",new A(l,3));this.addAttribute("normal",new A(r,3));this.addAttribute("uv",new A(v,2))}function Mc(a,b,c,d,e,f,g){K.call(this);this.type="TorusKnotGeometry";this.parameters={radius:a,tube:b,tubularSegments:c,radialSegments:d,p:e,q:f};void 0!==g&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead.");this.fromBufferGeometry(new Yb(a,
b,c,d,e,f));this.mergeVertices()}function Yb(a,b,c,d,e,f){function g(a,b,c,d,e){var f=Math.sin(a);b=c/b*a;c=Math.cos(b);e.x=d*(2+c)*.5*Math.cos(a);e.y=d*(2+c)*f*.5;e.z=d*Math.sin(b)*.5}E.call(this);this.type="TorusKnotBufferGeometry";this.parameters={radius:a,tube:b,tubularSegments:c,radialSegments:d,p:e,q:f};a=a||1;b=b||.4;c=Math.floor(c)||64;d=Math.floor(d)||8;e=e||2;f=f||3;var h=[],k=[],m=[],q=[],n,u=new p,l=new p,r=new p,v=new p,z=new p,x=new p,w=new p;for(n=0;n<=c;++n){var y=n/c*e*Math.PI*2;
g(y,e,f,a,r);g(y+.01,e,f,a,v);x.subVectors(v,r);w.addVectors(v,r);z.crossVectors(x,w);w.crossVectors(z,x);z.normalize();w.normalize();for(y=0;y<=d;++y){var H=y/d*Math.PI*2,O=-b*Math.cos(H);H=b*Math.sin(H);u.x=r.x+(O*w.x+H*z.x);u.y=r.y+(O*w.y+H*z.y);u.z=r.z+(O*w.z+H*z.z);k.push(u.x,u.y,u.z);l.subVectors(u,r).normalize();m.push(l.x,l.y,l.z);q.push(n/c);q.push(y/d)}}for(y=1;y<=c;y++)for(n=1;n<=d;n++)a=(d+1)*y+(n-1),b=(d+1)*y+n,e=(d+1)*(y-1)+n,h.push((d+1)*(y-1)+(n-1),a,e),h.push(a,b,e);this.setIndex(h);
this.addAttribute("position",new A(k,3));this.addAttribute("normal",new A(m,3));this.addAttribute("uv",new A(q,2))}function Nc(a,b,c,d,e){K.call(this);this.type="TorusGeometry";this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:d,arc:e};this.fromBufferGeometry(new Zb(a,b,c,d,e));this.mergeVertices()}function Zb(a,b,c,d,e){E.call(this);this.type="TorusBufferGeometry";this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:d,arc:e};a=a||1;b=b||.4;c=Math.floor(c)||8;d=Math.floor(d)||
6;e=e||2*Math.PI;var f=[],g=[],h=[],k=[],m=new p,q=new p,n=new p,u,l;for(u=0;u<=c;u++)for(l=0;l<=d;l++){var r=l/d*e,v=u/c*Math.PI*2;q.x=(a+b*Math.cos(v))*Math.cos(r);q.y=(a+b*Math.cos(v))*Math.sin(r);q.z=b*Math.sin(v);g.push(q.x,q.y,q.z);m.x=a*Math.cos(r);m.y=a*Math.sin(r);n.subVectors(q,m).normalize();h.push(n.x,n.y,n.z);k.push(l/d);k.push(u/c)}for(u=1;u<=c;u++)for(l=1;l<=d;l++)a=(d+1)*(u-1)+l-1,b=(d+1)*(u-1)+l,e=(d+1)*u+l,f.push((d+1)*u+l-1,a,e),f.push(a,b,e);this.setIndex(f);this.addAttribute("position",
new A(g,3));this.addAttribute("normal",new A(h,3));this.addAttribute("uv",new A(k,2))}function Ze(a,b,c,d,e){for(var f,g=0,h=b,k=c-d;h<c;h+=d)g+=(a[k]-a[h])*(a[h+1]+a[k+1]),k=h;if(e===0<g)for(e=b;e<c;e+=d)f=$e(e,a[e],a[e+1],f);else for(e=c-d;e>=b;e-=d)f=$e(e,a[e],a[e+1],f);f&&ub(f,f.next)&&(Oc(f),f=f.next);return f}function Pc(a,b){if(!a)return a;b||(b=a);do{var c=!1;if(a.steiner||!ub(a,a.next)&&0!==va(a.prev,a,a.next))a=a.next;else{Oc(a);a=b=a.prev;if(a===a.next)break;c=!0}}while(c||a!==b);return b}
function Qc(a,b,c,d,e,f,g){if(a){if(!g&&f){var h=a,k=h;do null===k.z&&(k.z=Yd(k.x,k.y,d,e,f)),k.prevZ=k.prev,k=k.nextZ=k.next;while(k!==h);k.prevZ.nextZ=null;k.prevZ=null;h=k;var m,q,n,u,l=1;do{k=h;var r=h=null;for(q=0;k;){q++;var v=k;for(m=n=0;m<l&&(n++,v=v.nextZ,v);m++);for(u=l;0<n||0<u&&v;)0!==n&&(0===u||!v||k.z<=v.z)?(m=k,k=k.nextZ,n--):(m=v,v=v.nextZ,u--),r?r.nextZ=m:h=m,m.prevZ=r,r=m;k=v}r.nextZ=null;l*=2}while(1<q)}for(h=a;a.prev!==a.next;){k=a.prev;v=a.next;if(f)a:{r=a;u=d;var p=e,x=f;q=r.prev;
n=r;l=r.next;if(0<=va(q,n,l))r=!1;else{var w=q.x>n.x?q.x>l.x?q.x:l.x:n.x>l.x?n.x:l.x,y=q.y>n.y?q.y>l.y?q.y:l.y:n.y>l.y?n.y:l.y;m=Yd(q.x<n.x?q.x<l.x?q.x:l.x:n.x<l.x?n.x:l.x,q.y<n.y?q.y<l.y?q.y:l.y:n.y<l.y?n.y:l.y,u,p,x);u=Yd(w,y,u,p,x);for(p=r.nextZ;p&&p.z<=u;){if(p!==r.prev&&p!==r.next&&sd(q.x,q.y,n.x,n.y,l.x,l.y,p.x,p.y)&&0<=va(p.prev,p,p.next)){r=!1;break a}p=p.nextZ}for(p=r.prevZ;p&&p.z>=m;){if(p!==r.prev&&p!==r.next&&sd(q.x,q.y,n.x,n.y,l.x,l.y,p.x,p.y)&&0<=va(p.prev,p,p.next)){r=!1;break a}p=
p.prevZ}r=!0}}else a:if(r=a,q=r.prev,n=r,l=r.next,0<=va(q,n,l))r=!1;else{for(m=r.next.next;m!==r.prev;){if(sd(q.x,q.y,n.x,n.y,l.x,l.y,m.x,m.y)&&0<=va(m.prev,m,m.next)){r=!1;break a}m=m.next}r=!0}if(r)b.push(k.i/c),b.push(a.i/c),b.push(v.i/c),Oc(a),h=a=v.next;else if(a=v,a===h){if(!g)Qc(Pc(a),b,c,d,e,f,1);else if(1===g){g=b;h=c;k=a;do v=k.prev,r=k.next.next,!ub(v,r)&&af(v,k,k.next,r)&&Rc(v,r)&&Rc(r,v)&&(g.push(v.i/h),g.push(k.i/h),g.push(r.i/h),Oc(k),Oc(k.next),k=a=r),k=k.next;while(k!==a);a=k;Qc(a,
b,c,d,e,f,2)}else if(2===g)a:{g=a;do{for(h=g.next.next;h!==g.prev;){if(k=g.i!==h.i){k=g;v=h;if(r=k.next.i!==v.i&&k.prev.i!==v.i){b:{r=k;do{if(r.i!==k.i&&r.next.i!==k.i&&r.i!==v.i&&r.next.i!==v.i&&af(r,r.next,k,v)){r=!0;break b}r=r.next}while(r!==k);r=!1}r=!r}if(r=r&&Rc(k,v)&&Rc(v,k)){r=k;q=!1;n=(k.x+v.x)/2;v=(k.y+v.y)/2;do r.y>v!==r.next.y>v&&r.next.y!==r.y&&n<(r.next.x-r.x)*(v-r.y)/(r.next.y-r.y)+r.x&&(q=!q),r=r.next;while(r!==k);r=q}k=r}if(k){a=bf(g,h);g=Pc(g,g.next);a=Pc(a,a.next);Qc(g,b,c,d,e,
f);Qc(a,b,c,d,e,f);break a}h=h.next}g=g.next}while(g!==a)}break}}}}function Qg(a,b){return a.x-b.x}function Rg(a,b){var c=b,d=a.x,e=a.y,f=-Infinity;do{if(e<=c.y&&e>=c.next.y&&c.next.y!==c.y){var g=c.x+(e-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if(g<=d&&g>f){f=g;if(g===d){if(e===c.y)return c;if(e===c.next.y)return c.next}var h=c.x<c.next.x?c:c.next}}c=c.next}while(c!==b);if(!h)return null;if(d===f)return h.prev;b=h;g=h.x;var k=h.y,m=Infinity;for(c=h.next;c!==b;){if(d>=c.x&&c.x>=g&&d!==c.x&&sd(e<k?d:f,e,
g,k,e<k?f:d,e,c.x,c.y)){var q=Math.abs(e-c.y)/(d-c.x);(q<m||q===m&&c.x>h.x)&&Rc(c,a)&&(h=c,m=q)}c=c.next}return h}function Yd(a,b,c,d,e){a=32767*(a-c)*e;b=32767*(b-d)*e;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;b=(b|b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;return(a|a<<1)&1431655765|((b|b<<1)&1431655765)<<1}function Sg(a){var b=a,c=a;do b.x<c.x&&(c=b),b=b.next;while(b!==a);return c}function sd(a,b,c,d,e,f,g,h){return 0<=(e-g)*(b-h)-(a-g)*(f-h)&&0<=(a-g)*(d-h)-(c-
g)*(b-h)&&0<=(c-g)*(f-h)-(e-g)*(d-h)}function va(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function ub(a,b){return a.x===b.x&&a.y===b.y}function af(a,b,c,d){return ub(a,b)&&ub(c,d)||ub(a,d)&&ub(c,b)?!0:0<va(a,b,c)!==0<va(a,b,d)&&0<va(c,d,a)!==0<va(c,d,b)}function Rc(a,b){return 0>va(a.prev,a,a.next)?0<=va(a,b,a.next)&&0<=va(a,a.prev,b):0>va(a,b,a.prev)||0>va(a,a.next,b)}function bf(a,b){var c=new Zd(a.i,a.x,a.y),d=new Zd(b.i,b.x,b.y),e=a.next,f=b.prev;a.next=b;b.prev=a;c.next=e;e.prev=
c;d.next=c;c.prev=d;f.next=d;d.prev=f;return d}function $e(a,b,c,d){a=new Zd(a,b,c);d?(a.next=d.next,a.prev=d,d.next.prev=a,d.next=a):(a.prev=a,a.next=a);return a}function Oc(a){a.next.prev=a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Zd(a,b,c){this.i=a;this.x=b;this.y=c;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function cf(a){var b=a.length;2<b&&a[b-1].equals(a[0])&&a.pop()}function df(a,b){for(var c=0;c<b.length;c++)a.push(b[c].x),
a.push(b[c].y)}function vb(a,b){K.call(this);this.type="ExtrudeGeometry";this.parameters={shapes:a,options:b};this.fromBufferGeometry(new Ra(a,b));this.mergeVertices()}function Ra(a,b){function c(a){function c(a,b,c){b||console.error("THREE.ExtrudeGeometry: vec does not exist");return b.clone().multiplyScalar(c).add(a)}function g(a,b,c){var d=a.x-b.x;var e=a.y-b.y;var f=c.x-a.x;var g=c.y-a.y,h=d*d+e*e;if(Math.abs(d*g-e*f)>Number.EPSILON){var k=Math.sqrt(h),m=Math.sqrt(f*f+g*g);h=b.x-e/k;b=b.y+d/k;
g=((c.x-g/m-h)*g-(c.y+f/m-b)*f)/(d*g-e*f);f=h+d*g-a.x;d=b+e*g-a.y;e=f*f+d*d;if(2>=e)return new C(f,d);e=Math.sqrt(e/2)}else a=!1,d>Number.EPSILON?f>Number.EPSILON&&(a=!0):d<-Number.EPSILON?f<-Number.EPSILON&&(a=!0):Math.sign(e)===Math.sign(g)&&(a=!0),a?(f=-e,e=Math.sqrt(h)):(f=d,d=e,e=Math.sqrt(h/2));return new C(f/e,d/e)}function h(a,b){for(N=a.length;0<=--N;){var c=N;var f=N-1;0>f&&(f=a.length-1);var g,h=w+2*J;for(g=0;g<h;g++){var k=W*g,m=W*(g+1),q=b+f+k,n=b+f+m;m=b+c+m;r(b+c+k);r(q);r(m);r(q);
r(n);r(m);k=e.length/3;k=B.generateSideWallUV(d,e,k-6,k-3,k-2,k-1);v(k[0]);v(k[1]);v(k[3]);v(k[1]);v(k[2]);v(k[3])}}}function k(a,b,c){z.push(a);z.push(b);z.push(c)}function l(a,b,c){r(a);r(b);r(c);a=e.length/3;a=B.generateTopUV(d,e,a-3,a-2,a-1);v(a[0]);v(a[1]);v(a[2])}function r(a){e.push(z[3*a]);e.push(z[3*a+1]);e.push(z[3*a+2])}function v(a){f.push(a.x);f.push(a.y)}var z=[],x=void 0!==b.curveSegments?b.curveSegments:12,w=void 0!==b.steps?b.steps:1,y=void 0!==b.depth?b.depth:100,H=void 0!==b.bevelEnabled?
b.bevelEnabled:!0,O=void 0!==b.bevelThickness?b.bevelThickness:6,da=void 0!==b.bevelSize?b.bevelSize:O-2,J=void 0!==b.bevelSegments?b.bevelSegments:3,A=b.extrudePath,B=void 0!==b.UVGenerator?b.UVGenerator:Tg;void 0!==b.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),y=b.amount);var E=!1;if(A){var G=A.getSpacedPoints(w);E=!0;H=!1;var V=A.computeFrenetFrames(w,!1);var L=new p;var M=new p;var K=new p}H||(da=O=J=0);var I;x=a.extractPoints(x);a=x.shape;var P=x.holes;
if(!Ya.isClockWise(a)){a=a.reverse();var F=0;for(I=P.length;F<I;F++){var Q=P[F];Ya.isClockWise(Q)&&(P[F]=Q.reverse())}}var R=Ya.triangulateShape(a,P),T=a;F=0;for(I=P.length;F<I;F++)Q=P[F],a=a.concat(Q);var aa,W=a.length,S,Y=R.length;x=[];var N=0;var U=T.length;var Z=U-1;for(aa=N+1;N<U;N++,Z++,aa++)Z===U&&(Z=0),aa===U&&(aa=0),x[N]=g(T[N],T[Z],T[aa]);A=[];var ca=x.concat();F=0;for(I=P.length;F<I;F++){Q=P[F];var X=[];N=0;U=Q.length;Z=U-1;for(aa=N+1;N<U;N++,Z++,aa++)Z===U&&(Z=0),aa===U&&(aa=0),X[N]=g(Q[N],
Q[Z],Q[aa]);A.push(X);ca=ca.concat(X)}for(Z=0;Z<J;Z++){U=Z/J;var ea=O*Math.cos(U*Math.PI/2);aa=da*Math.sin(U*Math.PI/2);N=0;for(U=T.length;N<U;N++){var fa=c(T[N],x[N],aa);k(fa.x,fa.y,-ea)}F=0;for(I=P.length;F<I;F++)for(Q=P[F],X=A[F],N=0,U=Q.length;N<U;N++)fa=c(Q[N],X[N],aa),k(fa.x,fa.y,-ea)}aa=da;for(N=0;N<W;N++)fa=H?c(a[N],ca[N],aa):a[N],E?(M.copy(V.normals[0]).multiplyScalar(fa.x),L.copy(V.binormals[0]).multiplyScalar(fa.y),K.copy(G[0]).add(M).add(L),k(K.x,K.y,K.z)):k(fa.x,fa.y,0);for(U=1;U<=w;U++)for(N=
0;N<W;N++)fa=H?c(a[N],ca[N],aa):a[N],E?(M.copy(V.normals[U]).multiplyScalar(fa.x),L.copy(V.binormals[U]).multiplyScalar(fa.y),K.copy(G[U]).add(M).add(L),k(K.x,K.y,K.z)):k(fa.x,fa.y,y/w*U);for(Z=J-1;0<=Z;Z--){U=Z/J;ea=O*Math.cos(U*Math.PI/2);aa=da*Math.sin(U*Math.PI/2);N=0;for(U=T.length;N<U;N++)fa=c(T[N],x[N],aa),k(fa.x,fa.y,y+ea);F=0;for(I=P.length;F<I;F++)for(Q=P[F],X=A[F],N=0,U=Q.length;N<U;N++)fa=c(Q[N],X[N],aa),E?k(fa.x,fa.y+G[w-1].y,G[w-1].x+ea):k(fa.x,fa.y,y+ea)}(function(){var a=e.length/
3;if(H){var b=0*W;for(N=0;N<Y;N++)S=R[N],l(S[2]+b,S[1]+b,S[0]+b);b=W*(w+2*J);for(N=0;N<Y;N++)S=R[N],l(S[0]+b,S[1]+b,S[2]+b)}else{for(N=0;N<Y;N++)S=R[N],l(S[2],S[1],S[0]);for(N=0;N<Y;N++)S=R[N],l(S[0]+W*w,S[1]+W*w,S[2]+W*w)}d.addGroup(a,e.length/3-a,0)})();(function(){var a=e.length/3,b=0;h(T,b);b+=T.length;F=0;for(I=P.length;F<I;F++)Q=P[F],h(Q,b),b+=Q.length;d.addGroup(a,e.length/3-a,1)})()}E.call(this);this.type="ExtrudeBufferGeometry";this.parameters={shapes:a,options:b};a=Array.isArray(a)?a:[a];
for(var d=this,e=[],f=[],g=0,h=a.length;g<h;g++)c(a[g]);this.addAttribute("position",new A(e,3));this.addAttribute("uv",new A(f,2));this.computeVertexNormals()}function ef(a,b,c){c.shapes=[];if(Array.isArray(a))for(var d=0,e=a.length;d<e;d++)c.shapes.push(a[d].uuid);else c.shapes.push(a.uuid);void 0!==b.extrudePath&&(c.options.extrudePath=b.extrudePath.toJSON());return c}function Sc(a,b){K.call(this);this.type="TextGeometry";this.parameters={text:a,parameters:b};this.fromBufferGeometry(new $b(a,b));
this.mergeVertices()}function $b(a,b){b=b||{};var c=b.font;if(!c||!c.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new K;a=c.generateShapes(a,b);b.depth=void 0!==b.height?b.height:50;void 0===b.bevelThickness&&(b.bevelThickness=10);void 0===b.bevelSize&&(b.bevelSize=8);void 0===b.bevelEnabled&&(b.bevelEnabled=!1);Ra.call(this,a,b);this.type="TextBufferGeometry"}function Tc(a,b,c,d,e,f,g){K.call(this);this.type="SphereGeometry";this.parameters=
{radius:a,widthSegments:b,heightSegments:c,phiStart:d,phiLength:e,thetaStart:f,thetaLength:g};this.fromBufferGeometry(new wb(a,b,c,d,e,f,g));this.mergeVertices()}function wb(a,b,c,d,e,f,g){E.call(this);this.type="SphereBufferGeometry";this.parameters={radius:a,widthSegments:b,heightSegments:c,phiStart:d,phiLength:e,thetaStart:f,thetaLength:g};a=a||1;b=Math.max(3,Math.floor(b)||8);c=Math.max(2,Math.floor(c)||6);d=void 0!==d?d:0;e=void 0!==e?e:2*Math.PI;f=void 0!==f?f:0;g=void 0!==g?g:Math.PI;var h=
f+g,k,m,q=0,n=[],l=new p,t=new p,r=[],v=[],z=[],x=[];for(m=0;m<=c;m++){var w=[],y=m/c;for(k=0;k<=b;k++){var H=k/b;l.x=-a*Math.cos(d+H*e)*Math.sin(f+y*g);l.y=a*Math.cos(f+y*g);l.z=a*Math.sin(d+H*e)*Math.sin(f+y*g);v.push(l.x,l.y,l.z);t.set(l.x,l.y,l.z).normalize();z.push(t.x,t.y,t.z);x.push(H,1-y);w.push(q++)}n.push(w)}for(m=0;m<c;m++)for(k=0;k<b;k++)a=n[m][k+1],d=n[m][k],e=n[m+1][k],g=n[m+1][k+1],(0!==m||0<f)&&r.push(a,d,g),(m!==c-1||h<Math.PI)&&r.push(d,e,g);this.setIndex(r);this.addAttribute("position",
new A(v,3));this.addAttribute("normal",new A(z,3));this.addAttribute("uv",new A(x,2))}function Uc(a,b,c,d,e,f){K.call(this);this.type="RingGeometry";this.parameters={innerRadius:a,outerRadius:b,thetaSegments:c,phiSegments:d,thetaStart:e,thetaLength:f};this.fromBufferGeometry(new ac(a,b,c,d,e,f));this.mergeVertices()}function ac(a,b,c,d,e,f){E.call(this);this.type="RingBufferGeometry";this.parameters={innerRadius:a,outerRadius:b,thetaSegments:c,phiSegments:d,thetaStart:e,thetaLength:f};a=a||.5;b=b||
1;e=void 0!==e?e:0;f=void 0!==f?f:2*Math.PI;c=void 0!==c?Math.max(3,c):8;d=void 0!==d?Math.max(1,d):1;var g=[],h=[],k=[],m=[],q=a,n=(b-a)/d,l=new p,t=new C,r,v;for(r=0;r<=d;r++){for(v=0;v<=c;v++)a=e+v/c*f,l.x=q*Math.cos(a),l.y=q*Math.sin(a),h.push(l.x,l.y,l.z),k.push(0,0,1),t.x=(l.x/b+1)/2,t.y=(l.y/b+1)/2,m.push(t.x,t.y);q+=n}for(r=0;r<d;r++)for(b=r*(c+1),v=0;v<c;v++)a=v+b,e=a+c+1,f=a+c+2,q=a+1,g.push(a,e,q),g.push(e,f,q);this.setIndex(g);this.addAttribute("position",new A(h,3));this.addAttribute("normal",
new A(k,3));this.addAttribute("uv",new A(m,2))}function Vc(a,b,c,d){K.call(this);this.type="LatheGeometry";this.parameters={points:a,segments:b,phiStart:c,phiLength:d};this.fromBufferGeometry(new bc(a,b,c,d));this.mergeVertices()}function bc(a,b,c,d){E.call(this);this.type="LatheBufferGeometry";this.parameters={points:a,segments:b,phiStart:c,phiLength:d};b=Math.floor(b)||12;c=c||0;d=d||2*Math.PI;d=Q.clamp(d,0,2*Math.PI);var e=[],f=[],g=[],h=1/b,k=new p,m=new C,q;for(q=0;q<=b;q++){var n=c+q*h*d;var l=
Math.sin(n),t=Math.cos(n);for(n=0;n<=a.length-1;n++)k.x=a[n].x*l,k.y=a[n].y,k.z=a[n].x*t,f.push(k.x,k.y,k.z),m.x=q/b,m.y=n/(a.length-1),g.push(m.x,m.y)}for(q=0;q<b;q++)for(n=0;n<a.length-1;n++)c=n+q*a.length,h=c+a.length,k=c+a.length+1,m=c+1,e.push(c,h,m),e.push(h,k,m);this.setIndex(e);this.addAttribute("position",new A(f,3));this.addAttribute("uv",new A(g,2));this.computeVertexNormals();if(d===2*Math.PI)for(d=this.attributes.normal.array,e=new p,f=new p,g=new p,c=b*a.length*3,n=q=0;q<a.length;q++,
n+=3)e.x=d[n+0],e.y=d[n+1],e.z=d[n+2],f.x=d[c+n+0],f.y=d[c+n+1],f.z=d[c+n+2],g.addVectors(e,f).normalize(),d[n+0]=d[c+n+0]=g.x,d[n+1]=d[c+n+1]=g.y,d[n+2]=d[c+n+2]=g.z}function xb(a,b){K.call(this);this.type="ShapeGeometry";"object"===typeof b&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),b=b.curveSegments);this.parameters={shapes:a,curveSegments:b};this.fromBufferGeometry(new yb(a,b));this.mergeVertices()}function yb(a,b){function c(a){var c,h=e.length/3;a=a.extractPoints(b);
var m=a.shape,q=a.holes;if(!1===Ya.isClockWise(m))for(m=m.reverse(),a=0,c=q.length;a<c;a++){var l=q[a];!0===Ya.isClockWise(l)&&(q[a]=l.reverse())}var p=Ya.triangulateShape(m,q);a=0;for(c=q.length;a<c;a++)l=q[a],m=m.concat(l);a=0;for(c=m.length;a<c;a++)l=m[a],e.push(l.x,l.y,0),f.push(0,0,1),g.push(l.x,l.y);a=0;for(c=p.length;a<c;a++)m=p[a],d.push(m[0]+h,m[1]+h,m[2]+h),k+=3}E.call(this);this.type="ShapeBufferGeometry";this.parameters={shapes:a,curveSegments:b};b=b||12;var d=[],e=[],f=[],g=[],h=0,k=
0;if(!1===Array.isArray(a))c(a);else for(var m=0;m<a.length;m++)c(a[m]),this.addGroup(h,k,m),h+=k,k=0;this.setIndex(d);this.addAttribute("position",new A(e,3));this.addAttribute("normal",new A(f,3));this.addAttribute("uv",new A(g,2))}function ff(a,b){b.shapes=[];if(Array.isArray(a))for(var c=0,d=a.length;c<d;c++)b.shapes.push(a[c].uuid);else b.shapes.push(a.uuid);return b}function cc(a,b){E.call(this);this.type="EdgesGeometry";this.parameters={thresholdAngle:b};var c=[];b=Math.cos(Q.DEG2RAD*(void 0!==
b?b:1));var d=[0,0],e={},f=["a","b","c"];if(a.isBufferGeometry){var g=new K;g.fromBufferGeometry(a)}else g=a.clone();g.mergeVertices();g.computeFaceNormals();a=g.vertices;g=g.faces;for(var h=0,k=g.length;h<k;h++)for(var m=g[h],q=0;3>q;q++){var n=m[f[q]];var l=m[f[(q+1)%3]];d[0]=Math.min(n,l);d[1]=Math.max(n,l);n=d[0]+","+d[1];void 0===e[n]?e[n]={index1:d[0],index2:d[1],face1:h,face2:void 0}:e[n].face2=h}for(n in e)if(d=e[n],void 0===d.face2||g[d.face1].normal.dot(g[d.face2].normal)<=b)f=a[d.index1],
c.push(f.x,f.y,f.z),f=a[d.index2],c.push(f.x,f.y,f.z);this.addAttribute("position",new A(c,3))}function zb(a,b,c,d,e,f,g,h){K.call(this);this.type="CylinderGeometry";this.parameters={radiusTop:a,radiusBottom:b,height:c,radialSegments:d,heightSegments:e,openEnded:f,thetaStart:g,thetaLength:h};this.fromBufferGeometry(new Za(a,b,c,d,e,f,g,h));this.mergeVertices()}function Za(a,b,c,d,e,f,g,h){function k(c){var e,f=new C,k=new p,u=0,v=!0===c?a:b,w=!0===c?1:-1;var A=r;for(e=1;e<=d;e++)n.push(0,z*w,0),l.push(0,
w,0),t.push(.5,.5),r++;var B=r;for(e=0;e<=d;e++){var E=e/d*h+g,V=Math.cos(E);E=Math.sin(E);k.x=v*E;k.y=z*w;k.z=v*V;n.push(k.x,k.y,k.z);l.push(0,w,0);f.x=.5*V+.5;f.y=.5*E*w+.5;t.push(f.x,f.y);r++}for(e=0;e<d;e++)f=A+e,k=B+e,!0===c?q.push(k,k+1,f):q.push(k+1,k,f),u+=3;m.addGroup(x,u,!0===c?1:2);x+=u}E.call(this);this.type="CylinderBufferGeometry";this.parameters={radiusTop:a,radiusBottom:b,height:c,radialSegments:d,heightSegments:e,openEnded:f,thetaStart:g,thetaLength:h};var m=this;a=void 0!==a?a:1;
b=void 0!==b?b:1;c=c||1;d=Math.floor(d)||8;e=Math.floor(e)||1;f=void 0!==f?f:!1;g=void 0!==g?g:0;h=void 0!==h?h:2*Math.PI;var q=[],n=[],l=[],t=[],r=0,v=[],z=c/2,x=0;(function(){var f,k,u=new p,O=new p,da=0,J=(b-a)/c;for(k=0;k<=e;k++){var A=[],C=k/e,E=C*(b-a)+a;for(f=0;f<=d;f++){var B=f/d,V=B*h+g,F=Math.sin(V);V=Math.cos(V);O.x=E*F;O.y=-C*c+z;O.z=E*V;n.push(O.x,O.y,O.z);u.set(F,J,V).normalize();l.push(u.x,u.y,u.z);t.push(B,1-C);A.push(r++)}v.push(A)}for(f=0;f<d;f++)for(k=0;k<e;k++)u=v[k+1][f],O=v[k+
1][f+1],J=v[k][f+1],q.push(v[k][f],u,J),q.push(u,O,J),da+=6;m.addGroup(x,da,0);x+=da})();!1===f&&(0<a&&k(!0),0<b&&k(!1));this.setIndex(q);this.addAttribute("position",new A(n,3));this.addAttribute("normal",new A(l,3));this.addAttribute("uv",new A(t,2))}function Wc(a,b,c,d,e,f,g){zb.call(this,0,a,b,c,d,e,f,g);this.type="ConeGeometry";this.parameters={radius:a,height:b,radialSegments:c,heightSegments:d,openEnded:e,thetaStart:f,thetaLength:g}}function Xc(a,b,c,d,e,f,g){Za.call(this,0,a,b,c,d,e,f,g);
this.type="ConeBufferGeometry";this.parameters={radius:a,height:b,radialSegments:c,heightSegments:d,openEnded:e,thetaStart:f,thetaLength:g}}function Yc(a,b,c,d){K.call(this);this.type="CircleGeometry";this.parameters={radius:a,segments:b,thetaStart:c,thetaLength:d};this.fromBufferGeometry(new dc(a,b,c,d));this.mergeVertices()}function dc(a,b,c,d){E.call(this);this.type="CircleBufferGeometry";this.parameters={radius:a,segments:b,thetaStart:c,thetaLength:d};a=a||1;b=void 0!==b?Math.max(3,b):8;c=void 0!==
c?c:0;d=void 0!==d?d:2*Math.PI;var e=[],f=[],g=[],h=[],k,m=new p,q=new C;f.push(0,0,0);g.push(0,0,1);h.push(.5,.5);var n=0;for(k=3;n<=b;n++,k+=3){var l=c+n/b*d;m.x=a*Math.cos(l);m.y=a*Math.sin(l);f.push(m.x,m.y,m.z);g.push(0,0,1);q.x=(f[k]/a+1)/2;q.y=(f[k+1]/a+1)/2;h.push(q.x,q.y)}for(k=1;k<=b;k++)e.push(k,k+1,0);this.setIndex(e);this.addAttribute("position",new A(f,3));this.addAttribute("normal",new A(g,3));this.addAttribute("uv",new A(h,2))}function Ab(a){F.call(this);this.type="ShadowMaterial";
this.color=new G(0);this.transparent=!0;this.setValues(a)}function ec(a){Da.call(this,a);this.type="RawShaderMaterial"}function Sa(a){F.call(this);this.defines={STANDARD:""};this.type="MeshStandardMaterial";this.color=new G(16777215);this.metalness=this.roughness=.5;this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new G(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=
new C(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null;this.envMapIntensity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)}function Bb(a){Sa.call(this);this.defines={PHYSICAL:""};this.type="MeshPhysicalMaterial";this.reflectivity=.5;this.clearCoatRoughness=
this.clearCoat=0;this.setValues(a)}function Ia(a){F.call(this);this.type="MeshPhongMaterial";this.color=new G(16777215);this.specular=new G(1118481);this.shininess=30;this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new G(0);this.emissiveIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalMapType=0;this.normalScale=new C(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;
this.envMap=this.alphaMap=this.specularMap=null;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)}function Cb(a){Ia.call(this);this.defines={TOON:""};this.type="MeshToonMaterial";this.gradientMap=null;this.setValues(a)}function Db(a){F.call(this);this.type="MeshNormalMaterial";this.bumpMap=null;this.bumpScale=1;this.normalMap=
null;this.normalMapType=0;this.normalScale=new C(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=!1;this.wireframeLinewidth=1;this.morphNormals=this.morphTargets=this.skinning=this.lights=this.fog=!1;this.setValues(a);this.attributes=["position","normal"]}function Eb(a){F.call(this);this.type="MeshLambertMaterial";this.color=new G(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new G(0);
this.emissiveIntensity=1;this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)}function Fb(a){T.call(this);this.type="LineDashedMaterial";this.scale=1;this.dashSize=3;this.gapSize=1;this.setValues(a)}function Ja(a){this.manager=void 0!==a?a:sa}function gf(a){this.manager=
void 0!==a?a:sa;this._parser=null}function $d(a){this.manager=void 0!==a?a:sa;this._parser=null}function td(a){this.manager=void 0!==a?a:sa}function L(){this.type="Curve";this.arcLengthDivisions=200}function ka(a,b,c,d,e,f,g,h){L.call(this);this.type="EllipseCurve";this.aX=a||0;this.aY=b||0;this.xRadius=c||1;this.yRadius=d||1;this.aStartAngle=e||0;this.aEndAngle=f||2*Math.PI;this.aClockwise=g||!1;this.aRotation=h||0}function fc(a,b,c,d,e,f){ka.call(this,a,b,c,c,d,e,f);this.type="ArcCurve"}function ae(){var a=
0,b=0,c=0,d=0;return{initCatmullRom:function(e,f,g,h,k){e=k*(g-e);h=k*(h-f);a=f;b=e;c=-3*f+3*g-2*e-h;d=2*f-2*g+e+h},initNonuniformCatmullRom:function(e,f,g,h,k,m,q){e=((f-e)/k-(g-e)/(k+m)+(g-f)/m)*m;h=((g-f)/m-(h-f)/(m+q)+(h-g)/q)*m;a=f;b=e;c=-3*f+3*g-2*e-h;d=2*f-2*g+e+h},calc:function(e){var f=e*e;return a+b*e+c*f+d*f*e}}}function wa(a,b,c,d){L.call(this);this.type="CatmullRomCurve3";this.points=a||[];this.closed=b||!1;this.curveType=c||"centripetal";this.tension=d||.5}function hf(a,b,c,d,e){b=.5*
(d-b);e=.5*(e-c);var f=a*a;return(2*c-2*d+b+e)*a*f+(-3*c+3*d-2*b-e)*f+b*a+c}function Zc(a,b,c,d){var e=1-a;return e*e*b+2*(1-a)*a*c+a*a*d}function $c(a,b,c,d,e){var f=1-a,g=1-a;return f*f*f*b+3*g*g*a*c+3*(1-a)*a*a*d+a*a*a*e}function Ka(a,b,c,d){L.call(this);this.type="CubicBezierCurve";this.v0=a||new C;this.v1=b||new C;this.v2=c||new C;this.v3=d||new C}function Ta(a,b,c,d){L.call(this);this.type="CubicBezierCurve3";this.v0=a||new p;this.v1=b||new p;this.v2=c||new p;this.v3=d||new p}function na(a,
b){L.call(this);this.type="LineCurve";this.v1=a||new C;this.v2=b||new C}function La(a,b){L.call(this);this.type="LineCurve3";this.v1=a||new p;this.v2=b||new p}function Ma(a,b,c){L.call(this);this.type="QuadraticBezierCurve";this.v0=a||new C;this.v1=b||new C;this.v2=c||new C}function Ua(a,b,c){L.call(this);this.type="QuadraticBezierCurve3";this.v0=a||new p;this.v1=b||new p;this.v2=c||new p}function Na(a){L.call(this);this.type="SplineCurve";this.points=a||[]}function $a(){L.call(this);this.type="CurvePath";
this.curves=[];this.autoClose=!1}function Oa(a){$a.call(this);this.type="Path";this.currentPoint=new C;a&&this.setFromPoints(a)}function hb(a){Oa.call(this,a);this.uuid=Q.generateUUID();this.type="Shape";this.holes=[]}function X(a,b){B.call(this);this.type="Light";this.color=new G(a);this.intensity=void 0!==b?b:1;this.receiveShadow=void 0}function ud(a,b,c){X.call(this,a,c);this.type="HemisphereLight";this.castShadow=void 0;this.position.copy(B.DefaultUp);this.updateMatrix();this.groundColor=new G(b)}
function Gb(a){this.camera=a;this.bias=0;this.radius=1;this.mapSize=new C(512,512);this.map=null;this.matrix=new I}function vd(){Gb.call(this,new ea(50,1,.5,500))}function wd(a,b,c,d,e,f){X.call(this,a,b);this.type="SpotLight";this.position.copy(B.DefaultUp);this.updateMatrix();this.target=new B;Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(a){this.intensity=a/Math.PI}});this.distance=void 0!==c?c:0;this.angle=void 0!==d?d:Math.PI/3;this.penumbra=void 0!==
e?e:0;this.decay=void 0!==f?f:1;this.shadow=new vd}function xd(a,b,c,d){X.call(this,a,b);this.type="PointLight";Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(a){this.intensity=a/(4*Math.PI)}});this.distance=void 0!==c?c:0;this.decay=void 0!==d?d:1;this.shadow=new Gb(new ea(90,1,.5,500))}function yd(){Gb.call(this,new Jb(-5,5,5,-5,.5,500))}function zd(a,b){X.call(this,a,b);this.type="DirectionalLight";this.position.copy(B.DefaultUp);this.updateMatrix();
this.target=new B;this.shadow=new yd}function Ad(a,b){X.call(this,a,b);this.type="AmbientLight";this.castShadow=void 0}function Bd(a,b,c,d){X.call(this,a,b);this.type="RectAreaLight";this.width=void 0!==c?c:10;this.height=void 0!==d?d:10}function oa(a,b,c,d){this.parameterPositions=a;this._cachedIndex=0;this.resultBuffer=void 0!==d?d:new b.constructor(c);this.sampleValues=b;this.valueSize=c}function Cd(a,b,c,d){oa.call(this,a,b,c,d);this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=
-0}function ad(a,b,c,d){oa.call(this,a,b,c,d)}function Dd(a,b,c,d){oa.call(this,a,b,c,d)}function qa(a,b,c,d){if(void 0===a)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===b||0===b.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+a);this.name=a;this.times=ha.convertArray(b,this.TimeBufferType);this.values=ha.convertArray(c,this.ValueBufferType);this.setInterpolation(d||this.DefaultInterpolation)}function Ed(a,b,c){qa.call(this,a,b,c)}function Fd(a,b,c,
d){qa.call(this,a,b,c,d)}function gc(a,b,c,d){qa.call(this,a,b,c,d)}function Gd(a,b,c,d){oa.call(this,a,b,c,d)}function bd(a,b,c,d){qa.call(this,a,b,c,d)}function Hd(a,b,c,d){qa.call(this,a,b,c,d)}function hc(a,b,c,d){qa.call(this,a,b,c,d)}function Ca(a,b,c){this.name=a;this.tracks=c;this.duration=void 0!==b?b:-1;this.uuid=Q.generateUUID();0>this.duration&&this.resetDuration()}function Ug(a){switch(a.toLowerCase()){case "scalar":case "double":case "float":case "number":case "integer":return gc;case "vector":case "vector2":case "vector3":case "vector4":return hc;
case "color":return Fd;case "quaternion":return bd;case "bool":case "boolean":return Ed;case "string":return Hd}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+a);}function Vg(a){if(void 0===a.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");var b=Ug(a.type);if(void 0===a.times){var c=[],d=[];ha.flattenJSON(a.keys,c,d,"value");a.times=c;a.values=d}return void 0!==b.parse?b.parse(a):new b(a.name,a.times,a.values,a.interpolation)}function Id(a){this.manager=void 0!==
a?a:sa;this.textures={}}function be(a){this.manager=void 0!==a?a:sa}function ic(){}function ce(a){"boolean"===typeof a&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),a=void 0);this.manager=void 0!==a?a:sa;this.withCredentials=!1}function jf(a){this.manager=void 0!==a?a:sa;this.texturePath=""}function de(a){"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported.");"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported.");
this.manager=void 0!==a?a:sa;this.options=void 0}function ee(){this.type="ShapePath";this.color=new G;this.subPaths=[];this.currentPath=null}function fe(a){this.type="Font";this.data=a}function kf(a){this.manager=void 0!==a?a:sa}function ge(a){this.manager=void 0!==a?a:sa}function lf(){this.type="StereoCamera";this.aspect=1;this.eyeSep=.064;this.cameraL=new ea;this.cameraL.layers.enable(1);this.cameraL.matrixAutoUpdate=!1;this.cameraR=new ea;this.cameraR.layers.enable(2);this.cameraR.matrixAutoUpdate=
!1}function cd(a,b,c){B.call(this);this.type="CubeCamera";var d=new ea(90,1,a,b);d.up.set(0,-1,0);d.lookAt(new p(1,0,0));this.add(d);var e=new ea(90,1,a,b);e.up.set(0,-1,0);e.lookAt(new p(-1,0,0));this.add(e);var f=new ea(90,1,a,b);f.up.set(0,0,1);f.lookAt(new p(0,1,0));this.add(f);var g=new ea(90,1,a,b);g.up.set(0,0,-1);g.lookAt(new p(0,-1,0));this.add(g);var h=new ea(90,1,a,b);h.up.set(0,-1,0);h.lookAt(new p(0,0,1));this.add(h);var k=new ea(90,1,a,b);k.up.set(0,-1,0);k.lookAt(new p(0,0,-1));this.add(k);
this.renderTarget=new mf(c,c,{format:1022,magFilter:1006,minFilter:1006});this.renderTarget.texture.name="CubeCamera";this.update=function(a,b){null===this.parent&&this.updateMatrixWorld();var c=this.renderTarget,m=c.texture.generateMipmaps;c.texture.generateMipmaps=!1;c.activeCubeFace=0;a.render(b,d,c);c.activeCubeFace=1;a.render(b,e,c);c.activeCubeFace=2;a.render(b,f,c);c.activeCubeFace=3;a.render(b,g,c);c.activeCubeFace=4;a.render(b,h,c);c.texture.generateMipmaps=m;c.activeCubeFace=5;a.render(b,
k,c);a.setRenderTarget(null)};this.clear=function(a,b,c,d){for(var e=this.renderTarget,f=0;6>f;f++)e.activeCubeFace=f,a.setRenderTarget(e),a.clear(b,c,d);a.setRenderTarget(null)}}function he(){B.call(this);this.type="AudioListener";this.context=ie.getContext();this.gain=this.context.createGain();this.gain.connect(this.context.destination);this.filter=null}function jc(a){B.call(this);this.type="Audio";this.context=a.context;this.gain=this.context.createGain();this.gain.connect(a.getInput());this.autoplay=
!1;this.buffer=null;this.loop=!1;this.offset=this.startTime=0;this.playbackRate=1;this.isPlaying=!1;this.hasPlaybackControl=!0;this.sourceType="empty";this.filters=[]}function je(a){jc.call(this,a);this.panner=this.context.createPanner();this.panner.connect(this.gain)}function ke(a,b){this.analyser=a.context.createAnalyser();this.analyser.fftSize=void 0!==b?b:2048;this.data=new Uint8Array(this.analyser.frequencyBinCount);a.getOutput().connect(this.analyser)}function le(a,b,c){this.binding=a;this.valueSize=
c;a=Float64Array;switch(b){case "quaternion":b=this._slerp;break;case "string":case "bool":a=Array;b=this._select;break;default:b=this._lerp}this.buffer=new a(4*c);this._mixBufferRegion=b;this.referenceCount=this.useCount=this.cumulativeWeight=0}function nf(a,b,c){c=c||Y.parseTrackName(b);this._targetGroup=a;this._bindings=a.subscribe_(b,c)}function Y(a,b,c){this.path=b;this.parsedPath=c||Y.parseTrackName(b);this.node=Y.findNode(a,this.parsedPath.nodeName)||a;this.rootNode=a}function of(){this.uuid=
Q.generateUUID();this._objects=Array.prototype.slice.call(arguments);this.nCachedObjects_=0;var a={};this._indicesByUUID=a;for(var b=0,c=arguments.length;b!==c;++b)a[arguments[b].uuid]=b;this._paths=[];this._parsedPaths=[];this._bindings=[];this._bindingsIndicesByPath={};var d=this;this.stats={objects:{get total(){return d._objects.length},get inUse(){return this.total-d.nCachedObjects_}},get bindingsPerObject(){return d._bindings.length}}}function pf(a,b,c){this._mixer=a;this._clip=b;this._localRoot=
c||null;a=b.tracks;b=a.length;c=Array(b);for(var d={endingStart:2400,endingEnd:2400},e=0;e!==b;++e){var f=a[e].createInterpolant(null);c[e]=f;f.settings=d}this._interpolantSettings=d;this._interpolants=c;this._propertyBindings=Array(b);this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null;this.loop=2201;this._loopCount=-1;this._startTime=null;this.time=0;this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1;this.repetitions=Infinity;
this.paused=!1;this.enabled=!0;this.clampWhenFinished=!1;this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}function me(a){this._root=a;this._initMemoryManager();this.time=this._accuIndex=0;this.timeScale=1}function Jd(a,b){"string"===typeof a&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),a=b);this.value=a}function ne(){E.call(this);this.type="InstancedBufferGeometry";this.maxInstancedCount=void 0}function oe(a,b,c){sb.call(this,a,b);this.meshPerAttribute=c||1}function pe(a,b,c){P.call(this,
a,b);this.meshPerAttribute=c||1}function qf(a,b,c,d){this.ray=new qb(a,b);this.near=c||0;this.far=d||Infinity;this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}};Object.defineProperties(this.params,{PointCloud:{get:function(){console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points.");return this.Points}}})}function rf(a,b){return a.distance-b.distance}function qe(a,b,c,d){if(!1!==a.visible&&(a.raycast(b,c),!0===d)){a=a.children;d=0;for(var e=a.length;d<e;d++)qe(a[d],
b,c,!0)}}function sf(a){this.autoStart=void 0!==a?a:!0;this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1}function tf(a,b,c){this.radius=void 0!==a?a:1;this.phi=void 0!==b?b:0;this.theta=void 0!==c?c:0;return this}function uf(a,b,c){this.radius=void 0!==a?a:1;this.theta=void 0!==b?b:0;this.y=void 0!==c?c:0;return this}function re(a,b){this.min=void 0!==a?a:new C(Infinity,Infinity);this.max=void 0!==b?b:new C(-Infinity,-Infinity)}function se(a,b){this.start=void 0!==a?a:new p;this.end=
void 0!==b?b:new p}function dd(a){B.call(this);this.material=a;this.render=function(){}}function ed(a,b,c,d){this.object=a;this.size=void 0!==b?b:1;a=void 0!==c?c:16711680;d=void 0!==d?d:1;b=0;(c=this.object.geometry)&&c.isGeometry?b=3*c.faces.length:c&&c.isBufferGeometry&&(b=c.attributes.normal.count);c=new E;b=new A(6*b,3);c.addAttribute("position",b);W.call(this,c,new T({color:a,linewidth:d}));this.matrixAutoUpdate=!1;this.update()}function kc(a,b){B.call(this);this.light=a;this.light.updateMatrixWorld();
this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=b;a=new E;b=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var c=0,d=1;32>c;c++,d++){var e=c/32*Math.PI*2,f=d/32*Math.PI*2;b.push(Math.cos(e),Math.sin(e),1,Math.cos(f),Math.sin(f),1)}a.addAttribute("position",new A(b,3));b=new T({fog:!1});this.cone=new W(a,b);this.add(this.cone);this.update()}function vf(a){var b=[];a&&a.isBone&&b.push(a);for(var c=0;c<a.children.length;c++)b.push.apply(b,vf(a.children[c]));return b}
function lc(a){for(var b=vf(a),c=new E,d=[],e=[],f=new G(0,0,1),g=new G(0,1,0),h=0;h<b.length;h++){var k=b[h];k.parent&&k.parent.isBone&&(d.push(0,0,0),d.push(0,0,0),e.push(f.r,f.g,f.b),e.push(g.r,g.g,g.b))}c.addAttribute("position",new A(d,3));c.addAttribute("color",new A(e,3));d=new T({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0});W.call(this,c,d);this.root=a;this.bones=b;this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1}function mc(a,b,c){this.light=a;this.light.updateMatrixWorld();
this.color=c;a=new wb(b,4,2);b=new Aa({wireframe:!0,fog:!1});ra.call(this,a,b);this.matrix=this.light.matrixWorld;this.matrixAutoUpdate=!1;this.update()}function nc(a,b){B.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=b;a=new T({fog:!1});b=new E;b.addAttribute("position",new P(new Float32Array(15),3));this.line=new ma(b,a);this.add(this.line);this.update()}function oc(a,b,c){B.call(this);this.light=a;this.light.updateMatrixWorld();
this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=c;a=new tb(b);a.rotateY(.5*Math.PI);this.material=new Aa({wireframe:!0,fog:!1});void 0===this.color&&(this.material.vertexColors=2);b=a.getAttribute("position");b=new Float32Array(3*b.count);a.addAttribute("color",new P(b,3));this.add(new ra(a,this.material));this.update()}function fd(a,b,c,d){a=a||10;b=b||10;c=new G(void 0!==c?c:4473924);d=new G(void 0!==d?d:8947848);var e=b/2,f=a/b,g=a/2;a=[];for(var h=[],k=0,m=0,q=-g;k<=b;k++,q+=f){a.push(-g,
0,q,g,0,q);a.push(q,0,-g,q,0,g);var n=k===e?c:d;n.toArray(h,m);m+=3;n.toArray(h,m);m+=3;n.toArray(h,m);m+=3;n.toArray(h,m);m+=3}b=new E;b.addAttribute("position",new A(a,3));b.addAttribute("color",new A(h,3));c=new T({vertexColors:2});W.call(this,b,c)}function Kd(a,b,c,d,e,f){a=a||10;b=b||16;c=c||8;d=d||64;e=new G(void 0!==e?e:4473924);f=new G(void 0!==f?f:8947848);var g=[],h=[],k;for(k=0;k<=b;k++){var m=k/b*2*Math.PI;var q=Math.sin(m)*a;m=Math.cos(m)*a;g.push(0,0,0);g.push(q,0,m);var n=k&1?e:f;h.push(n.r,
n.g,n.b);h.push(n.r,n.g,n.b)}for(k=0;k<=c;k++){n=k&1?e:f;var l=a-a/c*k;for(b=0;b<d;b++)m=b/d*2*Math.PI,q=Math.sin(m)*l,m=Math.cos(m)*l,g.push(q,0,m),h.push(n.r,n.g,n.b),m=(b+1)/d*2*Math.PI,q=Math.sin(m)*l,m=Math.cos(m)*l,g.push(q,0,m),h.push(n.r,n.g,n.b)}a=new E;a.addAttribute("position",new A(g,3));a.addAttribute("color",new A(h,3));g=new T({vertexColors:2});W.call(this,a,g)}function gd(a,b,c,d){this.object=a;this.size=void 0!==b?b:1;a=void 0!==c?c:16776960;d=void 0!==d?d:1;b=0;(c=this.object.geometry)&&
c.isGeometry?b=c.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");c=new E;b=new A(6*b,3);c.addAttribute("position",b);W.call(this,c,new T({color:a,linewidth:d}));this.matrixAutoUpdate=!1;this.update()}function pc(a,b,c){B.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.color=c;void 0===b&&(b=1);a=new E;a.addAttribute("position",new A([-b,b,0,b,b,0,b,-b,0,-b,
-b,0,-b,b,0],3));b=new T({fog:!1});this.lightPlane=new ma(a,b);this.add(this.lightPlane);a=new E;a.addAttribute("position",new A([0,0,0,0,0,1],3));this.targetLine=new ma(a,b);this.add(this.targetLine);this.update()}function hd(a){function b(a,b,d){c(a,d);c(b,d)}function c(a,b){f.push(0,0,0);g.push(b.r,b.g,b.b);void 0===h[a]&&(h[a]=[]);h[a].push(f.length/3-1)}var d=new E,e=new T({color:16777215,vertexColors:1}),f=[],g=[],h={},k=new G(16755200),m=new G(16711680),q=new G(43775),n=new G(16777215),l=new G(3355443);
b("n1","n2",k);b("n2","n4",k);b("n4","n3",k);b("n3","n1",k);b("f1","f2",k);b("f2","f4",k);b("f4","f3",k);b("f3","f1",k);b("n1","f1",k);b("n2","f2",k);b("n3","f3",k);b("n4","f4",k);b("p","n1",m);b("p","n2",m);b("p","n3",m);b("p","n4",m);b("u1","u2",q);b("u2","u3",q);b("u3","u1",q);b("c","t",n);b("p","c",l);b("cn1","cn2",l);b("cn3","cn4",l);b("cf1","cf2",l);b("cf3","cf4",l);d.addAttribute("position",new A(f,3));d.addAttribute("color",new A(g,3));W.call(this,d,e);this.camera=a;this.camera.updateProjectionMatrix&&
this.camera.updateProjectionMatrix();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.pointMap=h;this.update()}function Hb(a,b){this.object=a;void 0===b&&(b=16776960);a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var c=new Float32Array(24),d=new E;d.setIndex(new P(a,1));d.addAttribute("position",new P(c,3));W.call(this,d,new T({color:b}));this.matrixAutoUpdate=!1;this.update()}function id(a,b){this.type="Box3Helper";this.box=a;a=void 0!==b?b:16776960;b=new Uint16Array([0,
1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var c=new E;c.setIndex(new P(b,1));c.addAttribute("position",new A([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3));W.call(this,c,new T({color:a}));this.geometry.computeBoundingSphere()}function jd(a,b,c){this.type="PlaneHelper";this.plane=a;this.size=void 0===b?1:b;a=void 0!==c?c:16776960;b=new E;b.addAttribute("position",new A([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3));b.computeBoundingSphere();ma.call(this,
b,new T({color:a}));b=new E;b.addAttribute("position",new A([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3));b.computeBoundingSphere();this.add(new ra(b,new Aa({color:a,opacity:.2,transparent:!0,depthWrite:!1})))}function Ib(a,b,c,d,e,f){B.call(this);void 0===d&&(d=16776960);void 0===c&&(c=1);void 0===e&&(e=.2*c);void 0===f&&(f=.2*e);void 0===Ld&&(Ld=new E,Ld.addAttribute("position",new A([0,0,0,0,1,0],3)),te=new Za(0,.5,1,5,1),te.translate(0,-.5,0));this.position.copy(b);this.line=new ma(Ld,new T({color:d}));
this.line.matrixAutoUpdate=!1;this.add(this.line);this.cone=new ra(te,new Aa({color:d}));this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(a);this.setLength(c,e,f)}function kd(a){a=a||1;var b=[0,0,0,a,0,0,0,0,0,0,a,0,0,0,0,0,0,a];a=new E;a.addAttribute("position",new A(b,3));a.addAttribute("color",new A([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));b=new T({vertexColors:2});W.call(this,a,b)}function wf(a){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.");
wa.call(this,a);this.type="catmullrom";this.closed=!0}function xf(a){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.");wa.call(this,a);this.type="catmullrom"}function ue(a){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead.");wa.call(this,a);this.type="catmullrom"}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52));void 0===Number.isInteger&&(Number.isInteger=function(a){return"number"===typeof a&&isFinite(a)&&Math.floor(a)===
a});void 0===Math.sign&&(Math.sign=function(a){return 0>a?-1:0<a?1:+a});!1==="name"in Function.prototype&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}});void 0===Object.assign&&function(){Object.assign=function(a){if(void 0===a||null===a)throw new TypeError("Cannot convert undefined or null to object");for(var b=Object(a),c=1;c<arguments.length;c++){var d=arguments[c];if(void 0!==d&&null!==d)for(var e in d)Object.prototype.hasOwnProperty.call(d,
e)&&(b[e]=d[e])}return b}}();var ib=function(){function a(){}a.prototype.addEventListener=function(a,c){void 0===this._listeners&&(this._listeners={});void 0===this._listeners[a]&&(this._listeners[a]=[]);-1===this._listeners[a].indexOf(c)&&this._listeners[a].push(c)};a.prototype.dispatchEvent=function(a){if(void 0!==this._listeners){var b=this._listeners[a.type];if(void 0!==b){a.target=this;b=b.slice(0);for(var d=0,e=b.length;d<e;d++)b[d].call(this,a)}return!0}};a.prototype.hasEventListener=function(a,
c){return void 0!==this._listeners&&void 0!==this._listeners[a]&&-1!==this._listeners[a].indexOf(c)};a.prototype.removeEventListener=function(a,c){void 0!==this._listeners&&(a=this._listeners[a],void 0!==a&&(c=a.indexOf(c),-1!==c&&a.splice(c,1)))};return a}(),Q=new (function(){function a(){this.DEG2RAD=Math.PI/180;this.RAD2DEG=180/Math.PI}a.prototype.ceilPowerOfTwo=function(a){return Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))};a.prototype.clamp=function(a,c,d){return Math.max(c,Math.min(d,a))};a.prototype.degToRad=
function(a){return a*this.DEG2RAD};a.prototype.euclideanModulo=function(a,c){return(a%c+c)%c};a.prototype.floorPowerOfTwo=function(a){return Math.pow(2,Math.floor(Math.log(a)/Math.LN2))};a.prototype.generateUUID=function(){for(var a=[],c=0;256>c;c++)a[c]=(16>c?"0":"")+c.toString(16);c=4294967295*Math.random()|0;var d=4294967295*Math.random()|0,e=4294967295*Math.random()|0,f=4294967295*Math.random()|0;return(a[c&255]+a[c>>8&255]+a[c>>16&255]+a[c>>24&255]+"-"+a[d&255]+a[d>>8&255]+"-"+a[d>>16&15|64]+
a[d>>24&255]+"-"+a[e&63|128]+a[e>>8&255]+"-"+a[e>>16&255]+a[e>>24&255]+a[f&255]+a[f>>8&255]+a[f>>16&255]+a[f>>24&255]).toUpperCase()};a.prototype.isPowerOfTwo=function(a){return 0===(a&a-1)&&0!==a};a.prototype.lerp=function(a,c,d){return(1-d)*a+d*c};a.prototype.mapLinear=function(a,c,d,e,f){return e+(a-c)*(f-e)/(d-c)};a.prototype.radToDeg=function(a){return a*this.RAD2DEG};a.prototype.randFloat=function(a,c){return a+Math.random()*(c-a)};a.prototype.randFloatSpread=function(a){return a*(.5-Math.random())};
a.prototype.randInt=function(a,c){return a+Math.floor(Math.random()*(c-a+1))};a.prototype.smootherstep=function(a,c,d){if(a<=c)return 0;if(a>=d)return 1;a=(a-c)/(d-c);return a*a*a*(a*(6*a-15)+10)};a.prototype.smoothstep=function(a,c,d){if(a<=c)return 0;if(a>=d)return 1;a=(a-c)/(d-c);return a*a*(3-2*a)};return a}());Object.defineProperties(C.prototype,{width:{get:function(){return this.x},set:function(a){this.x=a}},height:{get:function(){return this.y},set:function(a){this.y=a}}});Object.assign(C.prototype,
{isVector2:!0,set:function(a,b){this.x=a;this.y=b;return this},setScalar:function(a){this.y=this.x=a;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw Error("index is out of range: "+a);}return this},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,
this.y)},copy:function(a){this.x=a.x;this.y=a.y;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;return this},addScalar:function(a){this.x+=a;this.y+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
this.subVectors(a,b);this.x-=a.x;this.y-=a.y;return this},subScalar:function(a){this.x-=a;this.y-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},multiply:function(a){this.x*=a.x;this.y*=a.y;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;return this},divide:function(a){this.x/=a.x;this.y/=a.y;return this},divideScalar:function(a){return this.multiplyScalar(1/a)},applyMatrix3:function(a){var b=this.x,c=this.y;a=a.elements;this.x=a[0]*b+a[3]*c+a[6];this.y=
a[1]*b+a[4]*c+a[7];return this},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);return this},clamp:function(a,b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));return this},clampScalar:function(){var a=new C,b=new C;return function(c,d){a.set(c,c);b.set(d,d);return this.clamp(a,b)}}(),clampLength:function(a,b){var c=this.length();return this.divideScalar(c||
1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);return this},negate:function(){this.x=-this.x;this.y=-this.y;return this},dot:function(a){return this.x*
a.x+this.y*a.y},cross:function(a){return this.x*a.y-this.y*a.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var a=Math.atan2(this.y,this.x);0>a&&(a+=2*Math.PI);return a},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=
this.x-a.x;a=this.y-a.y;return b*b+a*a},manhattanDistanceTo:function(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;return this},lerpVectors:function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},equals:function(a){return a.x===this.x&&a.y===this.y},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];return this},toArray:function(a,
b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;return a},fromBufferAttribute:function(a,b,c){void 0!==c&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute().");this.x=a.getX(b);this.y=a.getY(b);return this},rotateAround:function(a,b){var c=Math.cos(b);b=Math.sin(b);var d=this.x-a.x,e=this.y-a.y;this.x=d*c-e*b+a.x;this.y=d*b+e*c+a.y;return this}});Object.assign(I.prototype,{isMatrix4:!0,set:function(a,b,c,d,e,f,g,h,k,m,q,n,l,t,r,p){var u=this.elements;
u[0]=a;u[4]=b;u[8]=c;u[12]=d;u[1]=e;u[5]=f;u[9]=g;u[13]=h;u[2]=k;u[6]=m;u[10]=q;u[14]=n;u[3]=l;u[7]=t;u[11]=r;u[15]=p;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},clone:function(){return(new I).fromArray(this.elements)},copy:function(a){var b=this.elements;a=a.elements;b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return this},copyPosition:function(a){var b=
this.elements;a=a.elements;b[12]=a[12];b[13]=a[13];b[14]=a[14];return this},extractBasis:function(a,b,c){a.setFromMatrixColumn(this,0);b.setFromMatrixColumn(this,1);c.setFromMatrixColumn(this,2);return this},makeBasis:function(a,b,c){this.set(a.x,b.x,c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1);return this},extractRotation:function(){var a=new p;return function(b){var c=this.elements,d=b.elements,e=1/a.setFromMatrixColumn(b,0).length(),f=1/a.setFromMatrixColumn(b,1).length();b=1/a.setFromMatrixColumn(b,
2).length();c[0]=d[0]*e;c[1]=d[1]*e;c[2]=d[2]*e;c[3]=0;c[4]=d[4]*f;c[5]=d[5]*f;c[6]=d[6]*f;c[7]=0;c[8]=d[8]*b;c[9]=d[9]*b;c[10]=d[10]*b;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return this}}(),makeRotationFromEuler:function(a){a&&a.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var b=this.elements,c=a.x,d=a.y,e=a.z,f=Math.cos(c);c=Math.sin(c);var g=Math.cos(d);d=Math.sin(d);var h=Math.cos(e);e=Math.sin(e);if("XYZ"===a.order){a=
f*h;var k=f*e,m=c*h,q=c*e;b[0]=g*h;b[4]=-g*e;b[8]=d;b[1]=k+m*d;b[5]=a-q*d;b[9]=-c*g;b[2]=q-a*d;b[6]=m+k*d;b[10]=f*g}else"YXZ"===a.order?(a=g*h,k=g*e,m=d*h,q=d*e,b[0]=a+q*c,b[4]=m*c-k,b[8]=f*d,b[1]=f*e,b[5]=f*h,b[9]=-c,b[2]=k*c-m,b[6]=q+a*c,b[10]=f*g):"ZXY"===a.order?(a=g*h,k=g*e,m=d*h,q=d*e,b[0]=a-q*c,b[4]=-f*e,b[8]=m+k*c,b[1]=k+m*c,b[5]=f*h,b[9]=q-a*c,b[2]=-f*d,b[6]=c,b[10]=f*g):"ZYX"===a.order?(a=f*h,k=f*e,m=c*h,q=c*e,b[0]=g*h,b[4]=m*d-k,b[8]=a*d+q,b[1]=g*e,b[5]=q*d+a,b[9]=k*d-m,b[2]=-d,b[6]=c*
g,b[10]=f*g):"YZX"===a.order?(a=f*g,k=f*d,m=c*g,q=c*d,b[0]=g*h,b[4]=q-a*e,b[8]=m*e+k,b[1]=e,b[5]=f*h,b[9]=-c*h,b[2]=-d*h,b[6]=k*e+m,b[10]=a-q*e):"XZY"===a.order&&(a=f*g,k=f*d,m=c*g,q=c*d,b[0]=g*h,b[4]=-e,b[8]=d*h,b[1]=a*e+q,b[5]=f*h,b[9]=k*e-m,b[2]=m*e-k,b[6]=c*h,b[10]=q*e+a);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},makeRotationFromQuaternion:function(){var a=new p(0,0,0),b=new p(1,1,1);return function(c){return this.compose(a,c,b)}}(),lookAt:function(){var a=new p,b=new p,
c=new p;return function(d,e,f){var g=this.elements;c.subVectors(d,e);0===c.lengthSq()&&(c.z=1);c.normalize();a.crossVectors(f,c);0===a.lengthSq()&&(1===Math.abs(f.z)?c.x+=1E-4:c.z+=1E-4,c.normalize(),a.crossVectors(f,c));a.normalize();b.crossVectors(c,a);g[0]=a.x;g[4]=b.x;g[8]=c.x;g[1]=a.y;g[5]=b.y;g[9]=c.y;g[2]=a.z;g[6]=b.z;g[10]=c.z;return this}}(),multiply:function(a,b){return void 0!==b?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),
this.multiplyMatrices(a,b)):this.multiplyMatrices(this,a)},premultiply:function(a){return this.multiplyMatrices(a,this)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements;b=this.elements;a=c[0];var e=c[4],f=c[8],g=c[12],h=c[1],k=c[5],m=c[9],q=c[13],n=c[2],l=c[6],t=c[10],r=c[14],p=c[3],z=c[7],x=c[11];c=c[15];var w=d[0],y=d[4],H=d[8],O=d[12],da=d[1],J=d[5],A=d[9],C=d[13],E=d[2],B=d[6],F=d[10],G=d[14],K=d[3],L=d[7],I=d[11];d=d[15];b[0]=a*w+e*da+f*E+g*K;b[4]=a*y+e*J+f*B+g*L;b[8]=a*H+e*A+f*
F+g*I;b[12]=a*O+e*C+f*G+g*d;b[1]=h*w+k*da+m*E+q*K;b[5]=h*y+k*J+m*B+q*L;b[9]=h*H+k*A+m*F+q*I;b[13]=h*O+k*C+m*G+q*d;b[2]=n*w+l*da+t*E+r*K;b[6]=n*y+l*J+t*B+r*L;b[10]=n*H+l*A+t*F+r*I;b[14]=n*O+l*C+t*G+r*d;b[3]=p*w+z*da+x*E+c*K;b[7]=p*y+z*J+x*B+c*L;b[11]=p*H+z*A+x*F+c*I;b[15]=p*O+z*C+x*G+c*d;return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},applyToBufferAttribute:function(){var a=
new p;return function(b){for(var c=0,d=b.count;c<d;c++)a.x=b.getX(c),a.y=b.getY(c),a.z=b.getZ(c),a.applyMatrix4(this),b.setXYZ(c,a.x,a.y,a.z);return b}}(),determinant:function(){var a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],k=a[13],m=a[2],q=a[6],n=a[10],l=a[14];return a[3]*(+e*h*q-d*k*q-e*g*n+c*k*n+d*g*l-c*h*l)+a[7]*(+b*h*l-b*k*n+e*f*n-d*f*l+d*k*m-e*h*m)+a[11]*(+b*k*q-b*g*l-e*f*q+c*f*l+e*g*m-c*k*m)+a[15]*(-d*g*m-b*h*q+b*g*n+d*f*q-c*f*n+c*h*m)},transpose:function(){var a=this.elements;
var b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},setPosition:function(a){var b=this.elements;b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(a,b){var c=this.elements,d=a.elements;a=d[0];var e=d[1],f=d[2],g=d[3],h=d[4],k=d[5],m=d[6],q=d[7],n=d[8],l=d[9],t=d[10],r=d[11],p=d[12],z=d[13],x=d[14];d=d[15];var w=l*x*q-z*t*q+z*m*r-k*x*r-l*m*d+k*t*d,y=p*t*q-n*x*q-p*m*r+h*x*
r+n*m*d-h*t*d,H=n*z*q-p*l*q+p*k*r-h*z*r-n*k*d+h*l*d,O=p*l*m-n*z*m-p*k*t+h*z*t+n*k*x-h*l*x,da=a*w+e*y+f*H+g*O;if(0===da){if(!0===b)throw Error("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0");console.warn("THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0");return this.identity()}b=1/da;c[0]=w*b;c[1]=(z*t*g-l*x*g-z*f*r+e*x*r+l*f*d-e*t*d)*b;c[2]=(k*x*g-z*m*g+z*f*q-e*x*q-k*f*d+e*m*d)*b;c[3]=(l*m*g-k*t*g-l*f*q+e*t*q+k*f*r-e*m*r)*b;c[4]=y*b;c[5]=(n*x*g-p*t*g+p*f*r-
a*x*r-n*f*d+a*t*d)*b;c[6]=(p*m*g-h*x*g-p*f*q+a*x*q+h*f*d-a*m*d)*b;c[7]=(h*t*g-n*m*g+n*f*q-a*t*q-h*f*r+a*m*r)*b;c[8]=H*b;c[9]=(p*l*g-n*z*g-p*e*r+a*z*r+n*e*d-a*l*d)*b;c[10]=(h*z*g-p*k*g+p*e*q-a*z*q-h*e*d+a*k*d)*b;c[11]=(n*k*g-h*l*g-n*e*q+a*l*q+h*e*r-a*k*r)*b;c[12]=O*b;c[13]=(n*z*f-p*l*f+p*e*t-a*z*t-n*e*x+a*l*x)*b;c[14]=(p*k*f-h*z*f-p*e*m+a*z*m+h*e*x-a*k*x)*b;c[15]=(h*l*f-n*k*f+n*e*m-a*l*m-h*e*t+a*k*t)*b;return this},scale:function(a){var b=this.elements,c=a.x,d=a.y;a=a.z;b[0]*=c;b[4]*=d;b[8]*=a;b[1]*=
c;b[5]*=d;b[9]*=a;b[2]*=c;b[6]*=d;b[10]*=a;b[3]*=c;b[7]*=d;b[11]*=a;return this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10]))},makeTranslation:function(a,b,c){this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1);return this},makeRotationX:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this},makeRotationY:function(a){var b=Math.cos(a);a=Math.sin(a);
this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this},makeRotationZ:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var c=Math.cos(b);b=Math.sin(b);var d=1-c,e=a.x,f=a.y;a=a.z;var g=d*e,h=d*f;this.set(g*e+c,g*f-b*a,g*a+b*f,0,g*f+b*a,h*f+c,h*a-b*e,0,g*a-b*f,h*a+b*e,d*a*a+c,0,0,0,0,1);return this},makeScale:function(a,b,c){this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1);return this},makeShear:function(a,b,c){this.set(1,b,
c,0,a,1,c,0,a,b,1,0,0,0,0,1);return this},compose:function(a,b,c){var d=this.elements,e=b._x,f=b._y,g=b._z,h=b._w,k=e+e,m=f+f,q=g+g;b=e*k;var n=e*m;e*=q;var l=f*m;f*=q;g*=q;k*=h;m*=h;h*=q;q=c.x;var t=c.y;c=c.z;d[0]=(1-(l+g))*q;d[1]=(n+h)*q;d[2]=(e-m)*q;d[3]=0;d[4]=(n-h)*t;d[5]=(1-(b+g))*t;d[6]=(f+k)*t;d[7]=0;d[8]=(e+m)*c;d[9]=(f-k)*c;d[10]=(1-(b+l))*c;d[11]=0;d[12]=a.x;d[13]=a.y;d[14]=a.z;d[15]=1;return this},decompose:function(){var a=new p,b=new I;return function(c,d,e){var f=this.elements,g=a.set(f[0],
f[1],f[2]).length(),h=a.set(f[4],f[5],f[6]).length(),k=a.set(f[8],f[9],f[10]).length();0>this.determinant()&&(g=-g);c.x=f[12];c.y=f[13];c.z=f[14];b.copy(this);c=1/g;f=1/h;var m=1/k;b.elements[0]*=c;b.elements[1]*=c;b.elements[2]*=c;b.elements[4]*=f;b.elements[5]*=f;b.elements[6]*=f;b.elements[8]*=m;b.elements[9]*=m;b.elements[10]*=m;d.setFromRotationMatrix(b);e.x=g;e.y=h;e.z=k;return this}}(),makePerspective:function(a,b,c,d,e,f){void 0===f&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");
var g=this.elements;g[0]=2*e/(b-a);g[4]=0;g[8]=(b+a)/(b-a);g[12]=0;g[1]=0;g[5]=2*e/(c-d);g[9]=(c+d)/(c-d);g[13]=0;g[2]=0;g[6]=0;g[10]=-(f+e)/(f-e);g[14]=-2*f*e/(f-e);g[3]=0;g[7]=0;g[11]=-1;g[15]=0;return this},makeOrthographic:function(a,b,c,d,e,f){var g=this.elements,h=1/(b-a),k=1/(c-d),m=1/(f-e);g[0]=2*h;g[4]=0;g[8]=0;g[12]=-((b+a)*h);g[1]=0;g[5]=2*k;g[9]=0;g[13]=-((c+d)*k);g[2]=0;g[6]=0;g[10]=-2*m;g[14]=-((f+e)*m);g[3]=0;g[7]=0;g[11]=0;g[15]=1;return this},equals:function(a){var b=this.elements;
a=a.elements;for(var c=0;16>c;c++)if(b[c]!==a[c])return!1;return!0},fromArray:function(a,b){void 0===b&&(b=0);for(var c=0;16>c;c++)this.elements[c]=a[c+b];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a}});Object.assign(ia,{slerp:function(a,b,c,d){return c.copy(a).slerp(b,
d)},slerpFlat:function(a,b,c,d,e,f,g){var h=c[d+0],k=c[d+1],m=c[d+2];c=c[d+3];d=e[f+0];var q=e[f+1],n=e[f+2];e=e[f+3];if(c!==e||h!==d||k!==q||m!==n){f=1-g;var l=h*d+k*q+m*n+c*e,t=0<=l?1:-1,r=1-l*l;r>Number.EPSILON&&(r=Math.sqrt(r),l=Math.atan2(r,l*t),f=Math.sin(f*l)/r,g=Math.sin(g*l)/r);t*=g;h=h*f+d*t;k=k*f+q*t;m=m*f+n*t;c=c*f+e*t;f===1-g&&(g=1/Math.sqrt(h*h+k*k+m*m+c*c),h*=g,k*=g,m*=g,c*=g)}a[b]=h;a[b+1]=k;a[b+2]=m;a[b+3]=c}});Object.defineProperties(ia.prototype,{x:{get:function(){return this._x},
set:function(a){this._x=a;this.onChangeCallback()}},y:{get:function(){return this._y},set:function(a){this._y=a;this.onChangeCallback()}},z:{get:function(){return this._z},set:function(a){this._z=a;this.onChangeCallback()}},w:{get:function(){return this._w},set:function(a){this._w=a;this.onChangeCallback()}}});Object.assign(ia.prototype,{set:function(a,b,c,d){this._x=a;this._y=b;this._z=c;this._w=d;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,
this._w)},copy:function(a){this._x=a.x;this._y=a.y;this._z=a.z;this._w=a.w;this.onChangeCallback();return this},setFromEuler:function(a,b){if(!a||!a.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var c=a._x,d=a._y,e=a._z;a=a.order;var f=Math.cos,g=Math.sin,h=f(c/2),k=f(d/2);f=f(e/2);c=g(c/2);d=g(d/2);e=g(e/2);"XYZ"===a?(this._x=c*k*f+h*d*e,this._y=h*d*f-c*k*e,this._z=h*k*e+c*d*f,this._w=h*k*f-c*d*e):"YXZ"===a?(this._x=c*k*f+
h*d*e,this._y=h*d*f-c*k*e,this._z=h*k*e-c*d*f,this._w=h*k*f+c*d*e):"ZXY"===a?(this._x=c*k*f-h*d*e,this._y=h*d*f+c*k*e,this._z=h*k*e+c*d*f,this._w=h*k*f-c*d*e):"ZYX"===a?(this._x=c*k*f-h*d*e,this._y=h*d*f+c*k*e,this._z=h*k*e-c*d*f,this._w=h*k*f+c*d*e):"YZX"===a?(this._x=c*k*f+h*d*e,this._y=h*d*f+c*k*e,this._z=h*k*e-c*d*f,this._w=h*k*f-c*d*e):"XZY"===a&&(this._x=c*k*f-h*d*e,this._y=h*d*f-c*k*e,this._z=h*k*e+c*d*f,this._w=h*k*f+c*d*e);if(!1!==b)this.onChangeCallback();return this},setFromAxisAngle:function(a,
b){b/=2;var c=Math.sin(b);this._x=a.x*c;this._y=a.y*c;this._z=a.z*c;this._w=Math.cos(b);this.onChangeCallback();return this},setFromRotationMatrix:function(a){var b=a.elements,c=b[0];a=b[4];var d=b[8],e=b[1],f=b[5],g=b[9],h=b[2],k=b[6];b=b[10];var m=c+f+b;0<m?(c=.5/Math.sqrt(m+1),this._w=.25/c,this._x=(k-g)*c,this._y=(d-h)*c,this._z=(e-a)*c):c>f&&c>b?(c=2*Math.sqrt(1+c-f-b),this._w=(k-g)/c,this._x=.25*c,this._y=(a+e)/c,this._z=(d+h)/c):f>b?(c=2*Math.sqrt(1+f-c-b),this._w=(d-h)/c,this._x=(a+e)/c,this._y=
.25*c,this._z=(g+k)/c):(c=2*Math.sqrt(1+b-c-f),this._w=(e-a)/c,this._x=(d+h)/c,this._y=(g+k)/c,this._z=.25*c);this.onChangeCallback();return this},setFromUnitVectors:function(){var a=new p,b;return function(c,d){void 0===a&&(a=new p);b=c.dot(d)+1;1E-6>b?(b=0,Math.abs(c.x)>Math.abs(c.z)?a.set(-c.y,c.x,0):a.set(0,-c.z,c.y)):a.crossVectors(c,d);this._x=a.x;this._y=a.y;this._z=a.z;this._w=b;return this.normalize()}}(),angleTo:function(a){return 2*Math.acos(Math.abs(Q.clamp(this.dot(a),-1,1)))},rotateTowards:function(a,
b){var c=this.angleTo(a);if(0===c)return this;this.slerp(a,Math.min(1,b/c));return this},inverse:function(){return this.conjugate()},conjugate:function(){this._x*=-1;this._y*=-1;this._z*=-1;this.onChangeCallback();return this},dot:function(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var a=
this.length();0===a?(this._z=this._y=this._x=0,this._w=1):(a=1/a,this._x*=a,this._y*=a,this._z*=a,this._w*=a);this.onChangeCallback();return this},multiply:function(a,b){return void 0!==b?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(a,b)):this.multiplyQuaternions(this,a)},premultiply:function(a){return this.multiplyQuaternions(a,this)},multiplyQuaternions:function(a,b){var c=a._x,d=a._y,e=a._z;a=a._w;
var f=b._x,g=b._y,h=b._z;b=b._w;this._x=c*b+a*f+d*h-e*g;this._y=d*b+a*g+e*f-c*h;this._z=e*b+a*h+c*g-d*f;this._w=a*b-c*f-d*g-e*h;this.onChangeCallback();return this},slerp:function(a,b){if(0===b)return this;if(1===b)return this.copy(a);var c=this._x,d=this._y,e=this._z,f=this._w,g=f*a._w+c*a._x+d*a._y+e*a._z;0>g?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,g=-g):this.copy(a);if(1<=g)return this._w=f,this._x=c,this._y=d,this._z=e,this;a=1-g*g;if(a<=Number.EPSILON)return g=1-b,this._w=g*
f+b*this._w,this._x=g*c+b*this._x,this._y=g*d+b*this._y,this._z=g*e+b*this._z,this.normalize();a=Math.sqrt(a);var h=Math.atan2(a,g);g=Math.sin((1-b)*h)/a;b=Math.sin(b*h)/a;this._w=f*g+this._w*b;this._x=c*g+this._x*b;this._y=d*g+this._y*b;this._z=e*g+this._z*b;this.onChangeCallback();return this},equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w},fromArray:function(a,b){void 0===b&&(b=0);this._x=a[b];this._y=a[b+1];this._z=a[b+2];this._w=a[b+3];this.onChangeCallback();
return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._w;return a},onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){}});Object.assign(p.prototype,{isVector3:!0,set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},setScalar:function(a){this.z=this.y=this.x=a;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},
setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a);}return this},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),
this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;this.z+=a.z*b;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;
return this},subScalar:function(a){this.x-=a;this.y-=a;this.z-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},multiply:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(a,b);this.x*=a.x;this.y*=a.y;this.z*=a.z;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;return this},multiplyVectors:function(a,b){this.x=a.x*
b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},applyEuler:function(){var a=new ia;return function(b){b&&b.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.");return this.applyQuaternion(a.setFromEuler(b))}}(),applyAxisAngle:function(){var a=new ia;return function(b,c){return this.applyQuaternion(a.setFromAxisAngle(b,c))}}(),applyMatrix3:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[3]*c+a[6]*d;this.y=a[1]*
b+a[4]*c+a[7]*d;this.z=a[2]*b+a[5]*c+a[8]*d;return this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;var e=1/(a[3]*b+a[7]*c+a[11]*d+a[15]);this.x=(a[0]*b+a[4]*c+a[8]*d+a[12])*e;this.y=(a[1]*b+a[5]*c+a[9]*d+a[13])*e;this.z=(a[2]*b+a[6]*c+a[10]*d+a[14])*e;return this},applyQuaternion:function(a){var b=this.x,c=this.y,d=this.z,e=a.x,f=a.y,g=a.z;a=a.w;var h=a*b+f*d-g*c,k=a*c+g*b-e*d,m=a*d+e*c-f*b;b=-e*b-f*c-g*d;this.x=h*a+b*-e+k*-g-m*-f;this.y=k*a+b*-f+m*-e-h*-g;this.z=m*a+b*
-g+h*-f-k*-e;return this},project:function(){var a=new I;return function(b){a.multiplyMatrices(b.projectionMatrix,a.getInverse(b.matrixWorld));return this.applyMatrix4(a)}}(),unproject:function(){var a=new I;return function(b){a.multiplyMatrices(b.matrixWorld,a.getInverse(b.projectionMatrix));return this.applyMatrix4(a)}}(),transformDirection:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d;this.y=a[1]*b+a[5]*c+a[9]*d;this.z=a[2]*b+a[6]*c+a[10]*d;return this.normalize()},
divide:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this},divideScalar:function(a){return this.multiplyScalar(1/a)},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.z=Math.min(this.z,a.z);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);return this},clamp:function(a,b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));this.z=Math.max(a.z,Math.min(b.z,this.z));return this},
clampScalar:function(){var a=new p,b=new p;return function(c,d){a.set(c,c,c);b.set(d,d,d);return this.clamp(a,b)}}(),clampLength:function(a,b){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);
this.z=Math.round(this.z);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*
this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},lerpVectors:function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},cross:function(a,b){return void 0!==b?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),
this.crossVectors(a,b)):this.crossVectors(this,a)},crossVectors:function(a,b){var c=a.x,d=a.y;a=a.z;var e=b.x,f=b.y;b=b.z;this.x=d*b-a*f;this.y=a*e-c*b;this.z=c*f-d*e;return this},projectOnVector:function(a){var b=a.dot(this)/a.lengthSq();return this.copy(a).multiplyScalar(b)},projectOnPlane:function(){var a=new p;return function(b){a.copy(this).projectOnVector(b);return this.sub(a)}}(),reflect:function(){var a=new p;return function(b){return this.sub(a.copy(b).multiplyScalar(2*this.dot(b)))}}(),
angleTo:function(a){a=this.dot(a)/Math.sqrt(this.lengthSq()*a.lengthSq());return Math.acos(Q.clamp(a,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a},manhattanDistanceTo:function(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)+Math.abs(this.z-a.z)},setFromSpherical:function(a){var b=Math.sin(a.phi)*a.radius;this.x=b*Math.sin(a.theta);this.y=Math.cos(a.phi)*a.radius;this.z=b*
Math.cos(a.theta);return this},setFromCylindrical:function(a){this.x=a.radius*Math.sin(a.theta);this.y=a.y;this.z=a.radius*Math.cos(a.theta);return this},setFromMatrixPosition:function(a){a=a.elements;this.x=a[12];this.y=a[13];this.z=a[14];return this},setFromMatrixScale:function(a){var b=this.setFromMatrixColumn(a,0).length(),c=this.setFromMatrixColumn(a,1).length();a=this.setFromMatrixColumn(a,2).length();this.x=b;this.y=c;this.z=a;return this},setFromMatrixColumn:function(a,b){return this.fromArray(a.elements,
4*b)},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;return a},fromBufferAttribute:function(a,b,c){void 0!==c&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute().");this.x=a.getX(b);this.y=a.getY(b);this.z=a.getZ(b);return this}});Object.assign(la.prototype,
{isMatrix3:!0,set:function(a,b,c,d,e,f,g,h,k){var m=this.elements;m[0]=a;m[1]=d;m[2]=g;m[3]=b;m[4]=e;m[5]=h;m[6]=c;m[7]=f;m[8]=k;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(a){var b=this.elements;a=a.elements;b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return this},setFromMatrix4:function(a){a=a.elements;this.set(a[0],a[4],a[8],a[1],a[5],
a[9],a[2],a[6],a[10]);return this},applyToBufferAttribute:function(){var a=new p;return function(b){for(var c=0,d=b.count;c<d;c++)a.x=b.getX(c),a.y=b.getY(c),a.z=b.getZ(c),a.applyMatrix3(this),b.setXYZ(c,a.x,a.y,a.z);return b}}(),multiply:function(a){return this.multiplyMatrices(this,a)},premultiply:function(a){return this.multiplyMatrices(a,this)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements;b=this.elements;a=c[0];var e=c[3],f=c[6],g=c[1],h=c[4],k=c[7],m=c[2],q=c[5];c=c[8];var n=
d[0],l=d[3],t=d[6],r=d[1],p=d[4],z=d[7],x=d[2],w=d[5];d=d[8];b[0]=a*n+e*r+f*x;b[3]=a*l+e*p+f*w;b[6]=a*t+e*z+f*d;b[1]=g*n+h*r+k*x;b[4]=g*l+h*p+k*w;b[7]=g*t+h*z+k*d;b[2]=m*n+q*r+c*x;b[5]=m*l+q*p+c*w;b[8]=m*t+q*z+c*d;return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[3]*=a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this},determinant:function(){var a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],k=a[7];a=a[8];return b*f*a-b*g*k-c*e*a+c*g*h+d*e*k-
d*f*h},getInverse:function(a,b){a&&a.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var c=a.elements;a=this.elements;var d=c[0],e=c[1],f=c[2],g=c[3],h=c[4],k=c[5],m=c[6],q=c[7];c=c[8];var n=c*h-k*q,l=k*m-c*g,t=q*g-h*m,r=d*n+e*l+f*t;if(0===r){if(!0===b)throw Error("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0");console.warn("THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0");return this.identity()}b=1/r;a[0]=n*b;
a[1]=(f*q-c*e)*b;a[2]=(k*e-f*h)*b;a[3]=l*b;a[4]=(c*d-f*m)*b;a[5]=(f*g-k*d)*b;a[6]=t*b;a[7]=(e*m-q*d)*b;a[8]=(h*d-e*g)*b;return this},transpose:function(){var a=this.elements;var b=a[1];a[1]=a[3];a[3]=b;b=a[2];a[2]=a[6];a[6]=b;b=a[5];a[5]=a[7];a[7]=b;return this},getNormalMatrix:function(a){return this.setFromMatrix4(a).getInverse(this).transpose()},transposeIntoArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=b[2];a[7]=b[5];a[8]=b[8];return this},
setUvTransform:function(a,b,c,d,e,f,g){var h=Math.cos(e);e=Math.sin(e);this.set(c*h,c*e,-c*(h*f+e*g)+f+a,-d*e,d*h,-d*(-e*f+h*g)+g+b,0,0,1)},scale:function(a,b){var c=this.elements;c[0]*=a;c[3]*=a;c[6]*=a;c[1]*=b;c[4]*=b;c[7]*=b;return this},rotate:function(a){var b=Math.cos(a);a=Math.sin(a);var c=this.elements,d=c[0],e=c[3],f=c[6],g=c[1],h=c[4],k=c[7];c[0]=b*d+a*g;c[3]=b*e+a*h;c[6]=b*f+a*k;c[1]=-a*d+b*g;c[4]=-a*e+b*h;c[7]=-a*f+b*k;return this},translate:function(a,b){var c=this.elements;c[0]+=a*c[2];
c[3]+=a*c[5];c[6]+=a*c[8];c[1]+=b*c[2];c[4]+=b*c[5];c[7]+=b*c[8];return this},equals:function(a){var b=this.elements;a=a.elements;for(var c=0;9>c;c++)if(b[c]!==a[c])return!1;return!0},fromArray:function(a,b){void 0===b&&(b=0);for(var c=0;9>c;c++)this.elements[c]=a[c+b];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];return a}});var jb={getDataURL:function(a){if(a instanceof
HTMLCanvasElement)var b=a;else{"undefined"!==typeof OffscreenCanvas?b=new OffscreenCanvas(a.width,a.height):(b=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),b.width=a.width,b.height=a.height);var c=b.getContext("2d");a instanceof ImageData?c.putImageData(a,0,0):c.drawImage(a,0,0,a.width,a.height)}return 2048<b.width||2048<b.height?b.toDataURL("image/jpeg",.6):b.toDataURL("image/png")}},Wg=function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,
b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Xg=function(){function a(){}a.generateId=function(){return a.id++};a.id=0;return a}(),ta=function(a){function b(c,d,e,f,g,h,k,m,q,n){void 0===c&&(c=b.DEFAULT_IMAGE);void 0===d&&(d=b.DEFAULT_IMAGE);void 0===e&&(e=1001);void 0===f&&(f=1001);void 0===g&&(g=1006);void 0===h&&
(h=1008);void 0===k&&(k=1023);void 0===m&&(m=1009);void 0===q&&(q=1);void 0===n&&(n=3E3);var l=a.call(this)||this;l.image=c;l.mapping=d;l.wrapS=e;l.wrapT=f;l.magFilter=g;l.minFilter=h;l.format=k;l.type=m;l.anisotropy=q;l.encoding=n;l._needsUpdate=!1;l.isTexture=!0;l.center=new C(0,0);l.flipY=!0;l.generateMipmaps=!0;l.matrix=new la;l.matrixAutoUpdate=!0;l.mipmaps=[];l.name="";l.offset=new C(0,0);l.onUpdate=null;l.premultiplyAlpha=!1;l.repeat=new C(1,1);l.rotation=0;l.unpackAlignment=4;l.version=0;
l.id={value:Xg.generateId()};l.uuid=Q.generateUUID();return l}Wg(b,a);Object.defineProperty(b.prototype,"needsUpdate",{get:function(){return this._needsUpdate},set:function(a){this._needsUpdate=a;!0===a&&this.version++},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"src",{get:function(){!this._src&&this.image&&(this._src=this.image.src);return this._src},enumerable:!0,configurable:!0});b.prototype.cacheKey=function(){void 0===this._cacheKey&&(this._cacheKey=this.src+";"+(this.format+
";"+this.type+";"+this.wrapS+";"+this.wrapT+";"+this.magFilter+";"+this.minFilter+";"+this.anisotropy+";"+this.name));return this._cacheKey};b.prototype.clone=function(){return(new b).copy(this)};b.prototype.copy=function(a){this.name=a.name;this.image=a.image;this.mipmaps=a.mipmaps.slice(0);this.mapping=a.mapping;this.wrapS=a.wrapS;this.wrapT=a.wrapT;this.magFilter=a.magFilter;this.minFilter=a.minFilter;this.anisotropy=a.anisotropy;this.format=a.format;this.type=a.type;this.offset.copy(a.offset);
this.repeat.copy(a.repeat);this.center.copy(a.center);this.rotation=a.rotation;this.matrixAutoUpdate=a.matrixAutoUpdate;this.matrix.copy(a.matrix);this.generateMipmaps=a.generateMipmaps;this.premultiplyAlpha=a.premultiplyAlpha;this.flipY=a.flipY;this.unpackAlignment=a.unpackAlignment;this.encoding=a.encoding;return this};b.prototype.dispose=function(){this.dispatchEvent({type:"dispose"})};b.prototype.toJSON=function(a){var b=void 0===a||"string"===typeof a;if(!b&&void 0!==a.textures[this.uuid])return a.textures[this.uuid];
var c={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var f=this.image;void 0===f.uuid&&(f.uuid=Q.generateUUID());if(!b&&void 0===a.images[f.uuid]){if(Array.isArray(f)){var g=
[];for(var h=0,k=f.length;h<k;h++)g.push(jb.getDataURL(f[h]))}else g=jb.getDataURL(f);a.images[f.uuid]={uuid:f.uuid,url:g}}c.image=f.uuid}b||(a.textures[this.uuid]=c);return c};b.prototype.transformUv=function(a){if(300===this.mapping){a.applyMatrix3(this.matrix);if(0>a.x||1<a.x)switch(this.wrapS){case 1E3:a.x-=Math.floor(a.x);break;case 1001:a.x=0>a.x?0:1;break;case 1002:a.x=1===Math.abs(Math.floor(a.x)%2)?Math.ceil(a.x)-a.x:a.x-Math.floor(a.x)}if(0>a.y||1<a.y)switch(this.wrapT){case 1E3:a.y-=Math.floor(a.y);
break;case 1001:a.y=0>a.y?0:1;break;case 1002:a.y=1===Math.abs(Math.floor(a.y)%2)?Math.ceil(a.y)-a.y:a.y-Math.floor(a.y)}this.flipY&&(a.y=1-a.y)}};b.prototype.updateMatrix=function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)};b.textureId=0;b.DEFAULT_IMAGE=void 0;b.DEFAULT_MAPPING=300;return b}(ib),Yg=function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||
function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),md=function(a){function b(b,d,e){void 0===b&&(b=0);void 0===d&&(d=0);void 0===e&&(e={});var c=a.call(this)||this;c.width=b;c.height=d;c.options=e;c.scissorTest=!1;c.isWebGLRenderTarget=!0;c.scissor=new ca(0,0,b,d);c.viewport=new ca(0,0,b,d);void 0===e.minFilter&&(e.minFilter=1006);c.texture=
new ta(void 0,void 0,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding);c.texture.generateMipmaps=void 0!==e.generateMipmaps?e.generateMipmaps:!0;c.depthBuffer=void 0!==e.depthBuffer?e.depthBuffer:!0;c.stencilBuffer=void 0!==e.stencilBuffer?e.stencilBuffer:!0;c.depthTexture=void 0!==e.depthTexture?e.depthTexture:null;return c}Yg(b,a);b.prototype.cacheKey=function(){return this.texture.cacheKey()+";"+this.depthTexture.cacheKey()+";"+this.depthBuffer+";"+this.stencilBuffer+
";"+this.scissorTest+";"};b.prototype.clone=function(){return(new b).copy(this)};b.prototype.copy=function(a){this.width=a.width;this.height=a.height;this.viewport.copy(a.viewport);this.texture=a.texture.clone();this.depthBuffer=a.depthBuffer;this.stencilBuffer=a.stencilBuffer;this.depthTexture=a.depthTexture;return this};b.prototype.dispose=function(){this.dispatchEvent({type:"dispose"})};b.prototype.setSize=function(a,b){if(this.width!==a||this.height!==b)this.width=a,this.height=b,this.dispose();
this.viewport.set(0,0,a,b);this.scissor.set(0,0,a,b)};return b}(ib),Zg=function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),mf=function(a){function b(b,d,e){b=a.call(this,b,d,e)||this;b.isWebGLRenderTargetCube=!0;b.activeCubeFace=
0;b.activeMipMapLevel=0;return b}Zg(b,a);return b}(md);kb.prototype=Object.create(ta.prototype);kb.prototype.constructor=kb;kb.prototype.isDataTexture=!0;Object.assign(Va.prototype,{isBox3:!0,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromArray:function(a){for(var b=Infinity,c=Infinity,d=Infinity,e=-Infinity,f=-Infinity,g=-Infinity,h=0,k=a.length;h<k;h+=3){var m=a[h],q=a[h+1],l=a[h+2];m<b&&(b=m);q<c&&(c=q);l<d&&(d=l);m>e&&(e=m);q>f&&(f=q);l>g&&(g=l)}this.min.set(b,c,d);this.max.set(e,
f,g);return this},setFromBufferAttribute:function(a){for(var b=Infinity,c=Infinity,d=Infinity,e=-Infinity,f=-Infinity,g=-Infinity,h=0,k=a.count;h<k;h++){var m=a.getX(h),q=a.getY(h),l=a.getZ(h);m<b&&(b=m);q<c&&(c=q);l<d&&(d=l);m>e&&(e=m);q>f&&(f=q);l>g&&(g=l)}this.min.set(b,c,d);this.max.set(e,f,g);return this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(){var a=new p;return function(b,c){c=a.copy(c).multiplyScalar(.5);
this.min.copy(b).sub(c);this.max.copy(b).add(c);return this}}(),setFromObject:function(a){this.makeEmpty();return this.expandByObject(a)},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(a){void 0===
a&&(console.warn("THREE.Box3: .getCenter() target is now required"),a=new p);return this.isEmpty()?a.set(0,0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(a){void 0===a&&(console.warn("THREE.Box3: .getSize() target is now required"),a=new p);return this.isEmpty()?a.set(0,0,0):a.subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);
this.max.addScalar(a);return this},expandByObject:function(){function a(a){var f=a.geometry;if(void 0!==f)if(f.isGeometry)for(f=f.vertices,c=0,d=f.length;c<d;c++)e.copy(f[c]),e.applyMatrix4(a.matrixWorld),b.expandByPoint(e);else if(f.isBufferGeometry&&(f=f.attributes.position,void 0!==f))for(c=0,d=f.count;c<d;c++)e.fromBufferAttribute(f,c).applyMatrix4(a.matrixWorld),b.expandByPoint(e)}var b,c,d,e=new p;return function(c){b=this;c.updateMatrixWorld(!0);c.traverse(a);return this}}(),containsPoint:function(a){return a.x<
this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z},getParameter:function(a,b){void 0===b&&(console.warn("THREE.Box3: .getParameter() target is now required"),b=new p);return b.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},
intersectsBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z?!1:!0},intersectsSphere:function(){var a=new p;return function(b){this.clampPoint(b.center,a);return a.distanceToSquared(b.center)<=b.radius*b.radius}}(),intersectsPlane:function(a){if(0<a.normal.x){var b=a.normal.x*this.min.x;var c=a.normal.x*this.max.x}else b=a.normal.x*this.max.x,c=a.normal.x*this.min.x;0<a.normal.y?(b+=a.normal.y*this.min.y,c+=
a.normal.y*this.max.y):(b+=a.normal.y*this.max.y,c+=a.normal.y*this.min.y);0<a.normal.z?(b+=a.normal.z*this.min.z,c+=a.normal.z*this.max.z):(b+=a.normal.z*this.max.z,c+=a.normal.z*this.min.z);return b<=a.constant&&c>=a.constant},intersectsTriangle:function(){function a(a){var e;var f=0;for(e=a.length-3;f<=e;f+=3){h.fromArray(a,f);var g=m.x*Math.abs(h.x)+m.y*Math.abs(h.y)+m.z*Math.abs(h.z),k=b.dot(h),q=c.dot(h),l=d.dot(h);if(Math.max(-Math.max(k,q,l),Math.min(k,q,l))>g)return!1}return!0}var b=new p,
c=new p,d=new p,e=new p,f=new p,g=new p,h=new p,k=new p,m=new p,q=new p;return function(h){if(this.isEmpty())return!1;this.getCenter(k);m.subVectors(this.max,k);b.subVectors(h.a,k);c.subVectors(h.b,k);d.subVectors(h.c,k);e.subVectors(c,b);f.subVectors(d,c);g.subVectors(b,d);h=[0,-e.z,e.y,0,-f.z,f.y,0,-g.z,g.y,e.z,0,-e.x,f.z,0,-f.x,g.z,0,-g.x,-e.y,e.x,0,-f.y,f.x,0,-g.y,g.x,0];if(!a(h))return!1;h=[1,0,0,0,1,0,0,0,1];if(!a(h))return!1;q.crossVectors(e,f);h=[q.x,q.y,q.z];return a(h)}}(),clampPoint:function(a,
b){void 0===b&&(console.warn("THREE.Box3: .clampPoint() target is now required"),b=new p);return b.copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new p;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),getBoundingSphere:function(){var a=new p;return function(b){void 0===b&&(b=new za);this.getCenter(b.center);b.radius=.5*this.getSize(a).length();return b}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);this.isEmpty()&&this.makeEmpty();
return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},applyMatrix4:function(a){if(this.isEmpty())return this;a=a.elements;var b=a[0]*this.min.x,c=a[1]*this.min.x,d=a[2]*this.min.x,e=a[0]*this.max.x,f=a[1]*this.max.x,g=a[2]*this.max.x,h=a[4]*this.min.y,k=a[5]*this.min.y,m=a[6]*this.min.y,q=a[4]*this.max.y,l=a[5]*this.max.y,u=a[6]*this.max.y,t=a[8]*this.min.z,r=a[9]*this.min.z,p=a[10]*this.min.z,z=a[8]*this.max.z,x=a[9]*this.max.z,w=a[10]*this.max.z;this.min.x=Math.min(b,
e)+Math.min(h,q)+Math.min(t,z)+a[12];this.min.y=Math.min(c,f)+Math.min(k,l)+Math.min(r,x)+a[13];this.min.z=Math.min(d,g)+Math.min(m,u)+Math.min(p,w)+a[14];this.max.x=Math.max(b,e)+Math.max(h,q)+Math.max(t,z)+a[12];this.max.y=Math.max(c,f)+Math.max(k,l)+Math.max(r,x)+a[13];this.max.z=Math.max(d,g)+Math.max(m,u)+Math.max(p,w)+a[14];return this},translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)}});Object.assign(za.prototype,
{set:function(a,b){this.center.copy(a);this.radius=b;return this},setFromPoints:function(){var a=new Va;return function(b,c){var d=this.center;void 0!==c?d.copy(c):a.setFromPoints(b).getCenter(d);for(var e=c=0,f=b.length;e<f;e++)c=Math.max(c,d.distanceToSquared(b[e]));this.radius=Math.sqrt(c);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.center.copy(a.center);this.radius=a.radius;return this},empty:function(){return 0>=this.radius},containsPoint:function(a){return a.distanceToSquared(this.center)<=
this.radius*this.radius},distanceToPoint:function(a){return a.distanceTo(this.center)-this.radius},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b},intersectsBox:function(a){return a.intersectsSphere(this)},intersectsPlane:function(a){return Math.abs(a.distanceToPoint(this.center))<=this.radius},clampPoint:function(a,b){var c=this.center.distanceToSquared(a);void 0===b&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),
b=new p);b.copy(a);c>this.radius*this.radius&&(b.sub(this.center).normalize(),b.multiplyScalar(this.radius).add(this.center));return b},getBoundingBox:function(a){void 0===a&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),a=new Va);a.set(this.center,this.center);a.expandByScalar(this.radius);return a},applyMatrix4:function(a){this.center.applyMatrix4(a);this.radius*=a.getMaxScaleOnAxis();return this},translate:function(a){this.center.add(a);return this},equals:function(a){return a.center.equals(this.center)&&
a.radius===this.radius}});Object.assign(Pa.prototype,{set:function(a,b){this.normal.copy(a);this.constant=b;return this},setComponents:function(a,b,c,d){this.normal.set(a,b,c);this.constant=d;return this},setFromNormalAndCoplanarPoint:function(a,b){this.normal.copy(a);this.constant=-b.dot(this.normal);return this},setFromCoplanarPoints:function(){var a=new p,b=new p;return function(c,d,e){d=a.subVectors(e,d).cross(b.subVectors(c,d)).normalize();this.setFromNormalAndCoplanarPoint(d,c);return this}}(),
clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.normal.copy(a.normal);this.constant=a.constant;return this},normalize:function(){var a=1/this.normal.length();this.normal.multiplyScalar(a);this.constant*=a;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,b){void 0===
b&&(console.warn("THREE.Plane: .projectPoint() target is now required"),b=new p);return b.copy(this.normal).multiplyScalar(-this.distanceToPoint(a)).add(a)},intersectLine:function(){var a=new p;return function(b,c){void 0===c&&(console.warn("THREE.Plane: .intersectLine() target is now required"),c=new p);var d=b.delta(a),e=this.normal.dot(d);if(0===e){if(0===this.distanceToPoint(b.start))return c.copy(b.start)}else if(e=-(b.start.dot(this.normal)+this.constant)/e,!(0>e||1<e))return c.copy(d).multiplyScalar(e).add(b.start)}}(),
intersectsLine:function(a){var b=this.distanceToPoint(a.start);a=this.distanceToPoint(a.end);return 0>b&&0<a||0>a&&0<b},intersectsBox:function(a){return a.intersectsPlane(this)},intersectsSphere:function(a){return a.intersectsPlane(this)},coplanarPoint:function(a){void 0===a&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),a=new p);return a.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var a=new p,b=new la;return function(c,d){d=d||b.getNormalMatrix(c);
c=this.coplanarPoint(a).applyMatrix4(c);d=this.normal.applyMatrix3(d).normalize();this.constant=-c.dot(d);return this}}(),translate:function(a){this.constant-=a.dot(this.normal);return this},equals:function(a){return a.normal.equals(this.normal)&&a.constant===this.constant}});Object.assign(ld.prototype,{set:function(a,b,c,d,e,f){var g=this.planes;g[0].copy(a);g[1].copy(b);g[2].copy(c);g[3].copy(d);g[4].copy(e);g[5].copy(f);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){for(var b=
this.planes,c=0;6>c;c++)b[c].copy(a.planes[c]);return this},setFromMatrix:function(a){var b=this.planes,c=a.elements;a=c[0];var d=c[1],e=c[2],f=c[3],g=c[4],h=c[5],k=c[6],m=c[7],l=c[8],n=c[9],u=c[10],t=c[11],r=c[12],p=c[13],z=c[14];c=c[15];b[0].setComponents(f-a,m-g,t-l,c-r).normalize();b[1].setComponents(f+a,m+g,t+l,c+r).normalize();b[2].setComponents(f+d,m+h,t+n,c+p).normalize();b[3].setComponents(f-d,m-h,t-n,c-p).normalize();b[4].setComponents(f-e,m-k,t-u,c-z).normalize();b[5].setComponents(f+e,
m+k,t+u,c+z).normalize();return this},intersectsObject:function(){var a=new za;return function(b){var c=b.geometry;null===c.boundingSphere&&c.computeBoundingSphere();a.copy(c.boundingSphere).applyMatrix4(b.matrixWorld);return this.intersectsSphere(a)}}(),intersectsSprite:function(){var a=new za;return function(b){a.center.set(0,0,0);a.radius=.7071067811865476;a.applyMatrix4(b.matrixWorld);return this.intersectsSphere(a)}}(),intersectsSphere:function(a){var b=this.planes,c=a.center;a=-a.radius;for(var d=
0;6>d;d++)if(b[d].distanceToPoint(c)<a)return!1;return!0},intersectsBox:function(){var a=new p;return function(b){for(var c=this.planes,d=0;6>d;d++){var e=c[d];a.x=0<e.normal.x?b.max.x:b.min.x;a.y=0<e.normal.y?b.max.y:b.min.y;a.z=0<e.normal.z?b.max.z:b.min.z;if(0>e.distanceToPoint(a))return!1}return!0}}(),containsPoint:function(a){for(var b=this.planes,c=0;6>c;c++)if(0>b[c].distanceToPoint(a))return!1;return!0}});var R={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",
alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",
aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",
bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",
clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif\n",
clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",
color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",
cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",
defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",
emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",
envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",
envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",
envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",
envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",
fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",
gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",
lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",
lights_pars_begin:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n",
lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",
lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",
lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",
lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif\n",
lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif\n",
lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",
logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",
map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",
metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",
morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",
normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n",normal_fragment_maps:"#ifdef USE_NORMALMAP\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t#ifdef FLIP_SIDED\n\t\t\tnormal = - normal;\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\tnormal = normalize( normalMatrix * normal );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",
normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\t#ifdef OBJECTSPACE_NORMALMAP\n\t\tuniform mat3 normalMatrix;\n\t#else\n\t\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\t\tvec2 st0 = dFdx( vUv.st );\n\t\t\tvec2 st1 = dFdy( vUv.st );\n\t\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\t\tvec3 N = normalize( surf_norm );\n\t\t\tmat3 tsn = mat3( S, T, N );\n\t\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\t\tmapN.xy *= normalScale;\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\treturn normalize( tsn * mapN );\n\t\t}\n\t#endif\n#endif\n",
packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",
premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",
roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",
shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",
shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",
shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",
skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",
skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",
specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",
uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",
uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",
uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",
cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",
depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",
distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",
distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",
equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",
linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",
linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",
meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",
meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",
meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",
meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",
meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",
meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",
meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",
meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",
normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",
normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || ( defined( USE_NORMALMAP ) && ! defined( OBJECTSPACE_NORMALMAP ) )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",
points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",
points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}\n",
shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",
sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",
sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tvec4 mvPosition;\n\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n"},
Ea={merge:function(a){for(var b={},c=0;c<a.length;c++){var d=this.clone(a[c]),e;for(e in d)b[e]=d[e]}return b},clone:function(a){var b={},c;for(c in a){b[c]={};for(var d in a[c]){var e=a[c][d];e&&(e.isColor||e.isMatrix3||e.isMatrix4||e.isVector2||e.isVector3||e.isVector4||e.isTexture)?b[c][d]=e.clone():Array.isArray(e)?b[c][d]=e.slice():b[c][d]=e}}return b}},$g={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,
blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,
darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,
lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,
mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,
rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Object.assign(G.prototype,
{isColor:!0,r:1,g:1,b:1,set:function(a){a&&a.isColor?this.copy(a):"number"===typeof a?this.setHex(a):"string"===typeof a&&this.setStyle(a);return this},setScalar:function(a){this.b=this.g=this.r=a;return this},setHex:function(a){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;return this},setRGB:function(a,b,c){this.r=a;this.g=b;this.b=c;return this},setHSL:function(){function a(a,c,d){0>d&&(d+=1);1<d&&--d;return d<1/6?a+6*(c-a)*d:.5>d?c:d<2/3?a+6*(c-a)*(2/3-d):a}return function(b,
c,d){b=Q.euclideanModulo(b,1);c=Q.clamp(c,0,1);d=Q.clamp(d,0,1);0===c?this.r=this.g=this.b=d:(c=.5>=d?d*(1+c):d+c-d*c,d=2*d-c,this.r=a(d,c,b+1/3),this.g=a(d,c,b),this.b=a(d,c,b-1/3));return this}}(),setStyle:function(a){var b;if(b=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(a)){var c=b[2];switch(b[1]){case "rgb":case "rgba":if(b=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(c))return this.r=Math.min(255,parseInt(b[1],10))/255,this.g=Math.min(255,parseInt(b[2],10))/255,this.b=Math.min(255,
parseInt(b[3],10))/255,this;if(b=/^(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(c))return this.r=Math.min(100,parseInt(b[1],10))/100,this.g=Math.min(100,parseInt(b[2],10))/100,this.b=Math.min(100,parseInt(b[3],10))/100,this;break;case "hsl":case "hsla":if(b=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(c))return a=parseFloat(b[1])/360,c=parseInt(b[2],10)/100,b=parseInt(b[3],10)/100,this.setHSL(a,c,b)}}else if(b=/^#([A-Fa-f0-9]+)$/.exec(a)){b=
b[1];c=b.length;if(3===c)return this.r=parseInt(b.charAt(0)+b.charAt(0),16)/255,this.g=parseInt(b.charAt(1)+b.charAt(1),16)/255,this.b=parseInt(b.charAt(2)+b.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(b.charAt(0)+b.charAt(1),16)/255,this.g=parseInt(b.charAt(2)+b.charAt(3),16)/255,this.b=parseInt(b.charAt(4)+b.charAt(5),16)/255,this}a&&0<a.length&&(b=$g[a],void 0!==b?this.setHex(b):console.warn("THREE.Color: Unknown color "+a));return this},clone:function(){return new this.constructor(this.r,
this.g,this.b)},copy:function(a){this.r=a.r;this.g=a.g;this.b=a.b;return this},copyGammaToLinear:function(a,b){void 0===b&&(b=2);this.r=Math.pow(a.r,b);this.g=Math.pow(a.g,b);this.b=Math.pow(a.b,b);return this},copyLinearToGamma:function(a,b){void 0===b&&(b=2);b=0<b?1/b:1;this.r=Math.pow(a.r,b);this.g=Math.pow(a.g,b);this.b=Math.pow(a.b,b);return this},convertGammaToLinear:function(a){this.copyGammaToLinear(this,a);return this},convertLinearToGamma:function(a){this.copyLinearToGamma(this,a);return this},
copySRGBToLinear:function(){function a(a){return.04045>a?.0773993808*a:Math.pow(.9478672986*a+.0521327014,2.4)}return function(b){this.r=a(b.r);this.g=a(b.g);this.b=a(b.b);return this}}(),copyLinearToSRGB:function(){function a(a){return.0031308>a?12.92*a:1.055*Math.pow(a,.41666)-.055}return function(b){this.r=a(b.r);this.g=a(b.g);this.b=a(b.b);return this}}(),convertSRGBToLinear:function(){this.copySRGBToLinear(this);return this},convertLinearToSRGB:function(){this.copyLinearToSRGB(this);return this},
getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(a){void 0===a&&(console.warn("THREE.Color: .getHSL() target is now required"),a={h:0,s:0,l:0});var b=this.r,c=this.g,d=this.b,e=Math.max(b,c,d),f=Math.min(b,c,d),g,h=(f+e)/2;if(f===e)f=g=0;else{var k=e-f;f=.5>=h?k/(e+f):k/(2-e-f);switch(e){case b:g=(c-d)/k+(c<d?6:0);break;case c:g=(d-b)/k+2;break;case d:g=(b-c)/k+4}g/=6}a.h=g;a.s=f;a.l=
h;return a},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(){var a={};return function(b,c,d){this.getHSL(a);a.h+=b;a.s+=c;a.l+=d;this.setHSL(a.h,a.s,a.l);return this}}(),add:function(a){this.r+=a.r;this.g+=a.g;this.b+=a.b;return this},addColors:function(a,b){this.r=a.r+b.r;this.g=a.g+b.g;this.b=a.b+b.b;return this},addScalar:function(a){this.r+=a;this.g+=a;this.b+=a;return this},sub:function(a){this.r=Math.max(0,this.r-a.r);this.g=Math.max(0,
this.g-a.g);this.b=Math.max(0,this.b-a.b);return this},multiply:function(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;return this},multiplyScalar:function(a){this.r*=a;this.g*=a;this.b*=a;return this},lerp:function(a,b){this.r+=(a.r-this.r)*b;this.g+=(a.g-this.g)*b;this.b+=(a.b-this.b)*b;return this},equals:function(a){return a.r===this.r&&a.g===this.g&&a.b===this.b},fromArray:function(a,b){void 0===b&&(b=0);this.r=a[b];this.g=a[b+1];this.b=a[b+2];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===
b&&(b=0);a[b]=this.r;a[b+1]=this.g;a[b+2]=this.b;return a},toJSON:function(){return this.getHex()}});var M={common:{diffuse:{value:new G(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new la},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},
emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new C(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:2.5E-4},fogNear:{value:1},fogFar:{value:2E3},fogColor:{value:new G(16777215)}},lights:{ambientLightColor:{value:[]},
directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},
shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new G(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new la}},sprite:{diffuse:{value:new G(15658734)},opacity:{value:1},center:{value:new C(.5,
.5)},rotation:{value:0},map:{value:null},uvTransform:{value:new la}}},rb={basic:{uniforms:Ea.merge([M.common,M.specularmap,M.envmap,M.aomap,M.lightmap,M.fog]),vertexShader:R.meshbasic_vert,fragmentShader:R.meshbasic_frag},lambert:{uniforms:Ea.merge([M.common,M.specularmap,M.envmap,M.aomap,M.lightmap,M.emissivemap,M.fog,M.lights,{emissive:{value:new G(0)}}]),vertexShader:R.meshlambert_vert,fragmentShader:R.meshlambert_frag},phong:{uniforms:Ea.merge([M.common,M.specularmap,M.envmap,M.aomap,M.lightmap,
M.emissivemap,M.bumpmap,M.normalmap,M.displacementmap,M.gradientmap,M.fog,M.lights,{emissive:{value:new G(0)},specular:{value:new G(1118481)},shininess:{value:30}}]),vertexShader:R.meshphong_vert,fragmentShader:R.meshphong_frag},standard:{uniforms:Ea.merge([M.common,M.envmap,M.aomap,M.lightmap,M.emissivemap,M.bumpmap,M.normalmap,M.displacementmap,M.roughnessmap,M.metalnessmap,M.fog,M.lights,{emissive:{value:new G(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:R.meshphysical_vert,
fragmentShader:R.meshphysical_frag},points:{uniforms:Ea.merge([M.points,M.fog]),vertexShader:R.points_vert,fragmentShader:R.points_frag},dashed:{uniforms:Ea.merge([M.common,M.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:R.linedashed_vert,fragmentShader:R.linedashed_frag},depth:{uniforms:Ea.merge([M.common,M.displacementmap]),vertexShader:R.depth_vert,fragmentShader:R.depth_frag},normal:{uniforms:Ea.merge([M.common,M.bumpmap,M.normalmap,M.displacementmap,{opacity:{value:1}}]),
vertexShader:R.normal_vert,fragmentShader:R.normal_frag},sprite:{uniforms:Ea.merge([M.sprite,M.fog]),vertexShader:R.sprite_vert,fragmentShader:R.sprite_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:R.cube_vert,fragmentShader:R.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:R.equirect_vert,fragmentShader:R.equirect_frag},distanceRGBA:{uniforms:Ea.merge([M.common,M.displacementmap,{referencePosition:{value:new p},nearDistance:{value:1},
farDistance:{value:1E3}}]),vertexShader:R.distanceRGBA_vert,fragmentShader:R.distanceRGBA_frag},shadow:{uniforms:Ea.merge([M.lights,M.fog,{color:{value:new G(0)},opacity:{value:1}}]),vertexShader:R.shadow_vert,fragmentShader:R.shadow_frag}};rb.physical={uniforms:Ea.merge([rb.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:R.meshphysical_vert,fragmentShader:R.meshphysical_frag};Object.assign(ca.prototype,{isVector4:!0,set:function(a,b,c,d){this.x=a;this.y=b;this.z=
c;this.w=d;return this},setScalar:function(a){this.w=this.z=this.y=this.x=a;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setW:function(a){this.w=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw Error("index is out of range: "+a);}return this},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;
case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=void 0!==a.w?a.w:1;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this},addScalar:function(a){this.x+=
a;this.y+=a;this.z+=a;this.w+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.w=a.w+b.w;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;this.z+=a.z*b;this.w+=a.w*b;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this},subScalar:function(a){this.x-=a;this.y-=
a;this.z-=a;this.w-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.w=a.w-b.w;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;this.w*=a;return this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,e=this.w;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12]*e;this.y=a[1]*b+a[5]*c+a[9]*d+a[13]*e;this.z=a[2]*b+a[6]*c+a[10]*d+a[14]*e;this.w=a[3]*b+a[7]*c+a[11]*d+a[15]*e;return this},divideScalar:function(a){return this.multiplyScalar(1/
a)},setAxisAngleFromQuaternion:function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);1E-4>b?(this.x=1,this.z=this.y=0):(this.x=a.x/b,this.y=a.y/b,this.z=a.z/b);return this},setAxisAngleFromRotationMatrix:function(a){a=a.elements;var b=a[0];var c=a[4];var d=a[8],e=a[1],f=a[5],g=a[9];var h=a[2];var k=a[6];var m=a[10];if(.01>Math.abs(c-e)&&.01>Math.abs(d-h)&&.01>Math.abs(g-k)){if(.1>Math.abs(c+e)&&.1>Math.abs(d+h)&&.1>Math.abs(g+k)&&.1>Math.abs(b+f+m-3))return this.set(1,0,0,0),this;a=Math.PI;
b=(b+1)/2;f=(f+1)/2;m=(m+1)/2;c=(c+e)/4;d=(d+h)/4;g=(g+k)/4;b>f&&b>m?.01>b?(k=0,c=h=.707106781):(k=Math.sqrt(b),h=c/k,c=d/k):f>m?.01>f?(k=.707106781,h=0,c=.707106781):(h=Math.sqrt(f),k=c/h,c=g/h):.01>m?(h=k=.707106781,c=0):(c=Math.sqrt(m),k=d/c,h=g/c);this.set(k,h,c,a);return this}a=Math.sqrt((k-g)*(k-g)+(d-h)*(d-h)+(e-c)*(e-c));.001>Math.abs(a)&&(a=1);this.x=(k-g)/a;this.y=(d-h)/a;this.z=(e-c)/a;this.w=Math.acos((b+f+m-1)/2);return this},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,
a.y);this.z=Math.min(this.z,a.z);this.w=Math.min(this.w,a.w);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);this.w=Math.max(this.w,a.w);return this},clamp:function(a,b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));this.z=Math.max(a.z,Math.min(b.z,this.z));this.w=Math.max(a.w,Math.min(b.w,this.w));return this},clampScalar:function(){var a,b;return function(c,d){void 0===a&&(a=new ca,b=new ca);a.set(c,
c,c,c);b.set(d,d,d,d);return this.clamp(a,b)}}(),clampLength:function(a,b){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);
this.z=Math.round(this.z);this.w=Math.round(this.w);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*
this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.w+=(a.w-this.w)*b;return this},lerpVectors:function(a,
b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];this.w=a[b+3];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;a[b+3]=this.w;return a},fromBufferAttribute:function(a,b,c){void 0!==c&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute().");
this.x=a.getX(b);this.y=a.getY(b);this.z=a.getZ(b);this.w=a.getW(b);return this}});lb.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");lb.DefaultOrder="XYZ";Object.defineProperties(lb.prototype,{x:{get:function(){return this._x},set:function(a){this._x=a;this.onChangeCallback()}},y:{get:function(){return this._y},set:function(a){this._y=a;this.onChangeCallback()}},z:{get:function(){return this._z},set:function(a){this._z=a;this.onChangeCallback()}},order:{get:function(){return this._order},set:function(a){this._order=
a;this.onChangeCallback()}}});Object.assign(lb.prototype,{isEuler:!0,set:function(a,b,c,d){this._x=a;this._y=b;this._z=c;this._order=d||this._order;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(a){this._x=a._x;this._y=a._y;this._z=a._z;this._order=a._order;this.onChangeCallback();return this},setFromRotationMatrix:function(a,b,c){var d=Q.clamp,e=a.elements;a=e[0];var f=e[4],g=e[8],h=e[1],k=e[5],m=e[9],l=e[2],n=
e[6];e=e[10];b=b||this._order;"XYZ"===b?(this._y=Math.asin(d(g,-1,1)),.99999>Math.abs(g)?(this._x=Math.atan2(-m,e),this._z=Math.atan2(-f,a)):(this._x=Math.atan2(n,k),this._z=0)):"YXZ"===b?(this._x=Math.asin(-d(m,-1,1)),.99999>Math.abs(m)?(this._y=Math.atan2(g,e),this._z=Math.atan2(h,k)):(this._y=Math.atan2(-l,a),this._z=0)):"ZXY"===b?(this._x=Math.asin(d(n,-1,1)),.99999>Math.abs(n)?(this._y=Math.atan2(-l,e),this._z=Math.atan2(-f,k)):(this._y=0,this._z=Math.atan2(h,a))):"ZYX"===b?(this._y=Math.asin(-d(l,
-1,1)),.99999>Math.abs(l)?(this._x=Math.atan2(n,e),this._z=Math.atan2(h,a)):(this._x=0,this._z=Math.atan2(-f,k))):"YZX"===b?(this._z=Math.asin(d(h,-1,1)),.99999>Math.abs(h)?(this._x=Math.atan2(-m,k),this._y=Math.atan2(-l,a)):(this._x=0,this._y=Math.atan2(g,e))):"XZY"===b?(this._z=Math.asin(-d(f,-1,1)),.99999>Math.abs(f)?(this._x=Math.atan2(n,k),this._y=Math.atan2(g,a)):(this._x=Math.atan2(-m,e),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+b);this._order=
b;if(!1!==c)this.onChangeCallback();return this},setFromQuaternion:function(){var a=new I;return function(b,c,d){a.makeRotationFromQuaternion(b);return this.setFromRotationMatrix(a,c,d)}}(),setFromVector3:function(a,b){return this.set(a.x,a.y,a.z,b||this._order)},reorder:function(){var a=new ia;return function(b){a.setFromEuler(this);return this.setFromQuaternion(a,b)}}(),equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order},fromArray:function(a){this._x=
a[0];this._y=a[1];this._z=a[2];void 0!==a[3]&&(this._order=a[3]);this.onChangeCallback();return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._order;return a},toVector3:function(a){return a?a.set(this._x,this._y,this._z):new p(this._x,this._y,this._z)},onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){}});Object.assign(Rd.prototype,{set:function(a){this.mask=1<<a|0},enable:function(a){this.mask=
this.mask|1<<a|0},toggle:function(a){this.mask^=1<<a|0},disable:function(a){this.mask&=~(1<<a|0)},test:function(a){return 0!==(this.mask&a.mask)}});var Hf=0;B.DefaultUp=new p(0,1,0);B.DefaultMatrixAutoUpdate=!0;B.prototype=Object.assign(Object.create(ib.prototype),{constructor:B,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(a){this.matrix.multiplyMatrices(a,this.matrix);this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(a){this.quaternion.premultiply(a);
return this},setRotationFromAxisAngle:function(a,b){this.quaternion.setFromAxisAngle(a,b)},setRotationFromEuler:function(a){this.quaternion.setFromEuler(a,!0)},setRotationFromMatrix:function(a){this.quaternion.setFromRotationMatrix(a)},setRotationFromQuaternion:function(a){this.quaternion.copy(a)},rotateOnAxis:function(){var a=new ia;return function(b,c){a.setFromAxisAngle(b,c);this.quaternion.multiply(a);return this}}(),rotateOnWorldAxis:function(){var a=new ia;return function(b,c){a.setFromAxisAngle(b,
c);this.quaternion.premultiply(a);return this}}(),rotateX:function(){var a=new p(1,0,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateY:function(){var a=new p(0,1,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateZ:function(){var a=new p(0,0,1);return function(b){return this.rotateOnAxis(a,b)}}(),translateOnAxis:function(){var a=new p;return function(b,c){a.copy(b).applyQuaternion(this.quaternion);this.position.add(a.multiplyScalar(c));return this}}(),translateX:function(){var a=
new p(1,0,0);return function(b){return this.translateOnAxis(a,b)}}(),translateY:function(){var a=new p(0,1,0);return function(b){return this.translateOnAxis(a,b)}}(),translateZ:function(){var a=new p(0,0,1);return function(b){return this.translateOnAxis(a,b)}}(),localToWorld:function(a){return a.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var a=new I;return function(b){return b.applyMatrix4(a.getInverse(this.matrixWorld))}}(),lookAt:function(){var a=new I,b=new p;return function(c,d,e){c.isVector3?
b.copy(c):b.set(c,d,e);this.isCamera?a.lookAt(this.position,b,this.up):a.lookAt(b,this.position,this.up);this.quaternion.setFromRotationMatrix(a)}}(),add:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.add(arguments[b]);return this}if(a===this)return console.error("THREE.Object3D.add: object can't be added as a child of itself.",a),this;a&&a.isObject3D?(null!==a.parent&&a.parent.remove(a),a.parent=this,a.dispatchEvent({type:"added"}),this.children.push(a)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",
a);return this},remove:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.remove(arguments[b]);return this}b=this.children.indexOf(a);-1!==b&&(a.parent=null,a.dispatchEvent({type:"removed"}),this.children.splice(b,1));return this},getObjectById:function(a){return this.getObjectByProperty("id",a)},getObjectByName:function(a){return this.getObjectByProperty("name",a)},getObjectByProperty:function(a,b){if(this[a]===b)return this;for(var c=0,d=this.children.length;c<d;c++){var e=
this.children[c].getObjectByProperty(a,b);if(void 0!==e)return e}},getWorldPosition:function(a){void 0===a&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),a=new p);this.updateMatrixWorld(!0);return a.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var a=new p,b=new p;return function(c){void 0===c&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),c=new ia);this.updateMatrixWorld(!0);this.matrixWorld.decompose(a,c,b);return c}}(),
getWorldScale:function(){var a=new p,b=new ia;return function(c){void 0===c&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),c=new p);this.updateMatrixWorld(!0);this.matrixWorld.decompose(a,b,c);return c}}(),getWorldDirection:function(){var a=new ia;return function(b){void 0===b&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),b=new p);this.getWorldQuaternion(a);return b.set(0,0,1).applyQuaternion(a)}}(),raycast:function(){},traverse:function(a){a(this);
for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].traverse(a)},traverseVisible:function(a){if(!1!==this.visible){a(this);for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].traverseVisible(a)}},traverseAncestors:function(a){var b=this.parent;null!==b&&(a(b),b.traverseAncestors(a))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(a){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||
a)null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0;for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].updateMatrixWorld(a)},toJSON:function(a){function b(b,c){void 0===b[c.uuid]&&(b[c.uuid]=c.toJSON(a));return c.uuid}function c(a){var b=[],c;for(c in a){var d=a[c];delete d.metadata;b.push(d)}return b}var d=void 0===a||"string"===typeof a,e={};d&&(a={geometries:{},materials:{},textures:{},
images:{},shapes:{}},e.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var f={};f.uuid=this.uuid;f.type=this.type;""!==this.name&&(f.name=this.name);!0===this.castShadow&&(f.castShadow=!0);!0===this.receiveShadow&&(f.receiveShadow=!0);!1===this.visible&&(f.visible=!1);!1===this.frustumCulled&&(f.frustumCulled=!1);0!==this.renderOrder&&(f.renderOrder=this.renderOrder);"{}"!==JSON.stringify(this.userData)&&(f.userData=this.userData);f.layers=this.layers.mask;f.matrix=this.matrix.toArray();
!1===this.matrixAutoUpdate&&(f.matrixAutoUpdate=!1);if(this.isMesh||this.isLine||this.isPoints){f.geometry=b(a.geometries,this.geometry);var g=this.geometry.parameters;if(void 0!==g&&void 0!==g.shapes)if(g=g.shapes,Array.isArray(g))for(var h=0,k=g.length;h<k;h++)b(a.shapes,g[h]);else b(a.shapes,g)}if(void 0!==this.material)if(Array.isArray(this.material)){g=[];h=0;for(k=this.material.length;h<k;h++)g.push(b(a.materials,this.material[h]));f.material=g}else f.material=b(a.materials,this.material);if(0<
this.children.length)for(f.children=[],h=0;h<this.children.length;h++)f.children.push(this.children[h].toJSON(a).object);if(d){d=c(a.geometries);h=c(a.materials);k=c(a.textures);var m=c(a.images);g=c(a.shapes);0<d.length&&(e.geometries=d);0<h.length&&(e.materials=h);0<k.length&&(e.textures=k);0<m.length&&(e.images=m);0<g.length&&(e.shapes=g)}e.object=f;return e},clone:function(a){return(new this.constructor).copy(this,a)},copy:function(a,b){void 0===b&&(b=!0);this.name=a.name;this.up.copy(a.up);this.position.copy(a.position);
this.quaternion.copy(a.quaternion);this.scale.copy(a.scale);this.matrix.copy(a.matrix);this.matrixWorld.copy(a.matrixWorld);this.matrixAutoUpdate=a.matrixAutoUpdate;this.matrixWorldNeedsUpdate=a.matrixWorldNeedsUpdate;this.layers.mask=a.layers.mask;this.visible=a.visible;this.castShadow=a.castShadow;this.receiveShadow=a.receiveShadow;this.frustumCulled=a.frustumCulled;this.renderOrder=a.renderOrder;this.userData=JSON.parse(JSON.stringify(a.userData));if(!0===b)for(b=0;b<a.children.length;b++)this.add(a.children[b].clone());
return this}});Qa.prototype=Object.assign(Object.create(B.prototype),{constructor:Qa,isCamera:!0,copy:function(a,b){B.prototype.copy.call(this,a,b);this.matrixWorldInverse.copy(a.matrixWorldInverse);this.projectionMatrix.copy(a.projectionMatrix);return this},getWorldDirection:function(){var a=new ia;return function(b){void 0===b&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),b=new p);this.getWorldQuaternion(a);return b.set(0,0,-1).applyQuaternion(a)}}(),updateMatrixWorld:function(a){B.prototype.updateMatrixWorld.call(this,
a);this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}});Jb.prototype=Object.assign(Object.create(Qa.prototype),{constructor:Jb,isOrthographicCamera:!0,copy:function(a,b){Qa.prototype.copy.call(this,a,b);this.left=a.left;this.right=a.right;this.top=a.top;this.bottom=a.bottom;this.near=a.near;this.far=a.far;this.zoom=a.zoom;this.view=null===a.view?null:Object.assign({},a.view);return this},setViewOffset:function(a,b,c,d,e,f){null===this.view&&
(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1});this.view.enabled=!0;this.view.fullWidth=a;this.view.fullHeight=b;this.view.offsetX=c;this.view.offsetY=d;this.view.width=e;this.view.height=f;this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1);this.updateProjectionMatrix()},updateProjectionMatrix:function(){var a=(this.right-this.left)/(2*this.zoom),b=(this.top-this.bottom)/(2*this.zoom),c=(this.right+this.left)/
2,d=(this.top+this.bottom)/2,e=c-a;c+=a;a=d+b;b=d-b;if(null!==this.view&&this.view.enabled){c=this.zoom/(this.view.width/this.view.fullWidth);b=this.zoom/(this.view.height/this.view.fullHeight);var f=(this.right-this.left)/this.view.width;d=(this.top-this.bottom)/this.view.height;e+=this.view.offsetX/c*f;c=e+this.view.width/c*f;a-=this.view.offsetY/b*d;b=a-this.view.height/b*d}this.projectionMatrix.makeOrthographic(e,c,a,b,this.near,this.far)},toJSON:function(a){a=B.prototype.toJSON.call(this,a);
a.object.zoom=this.zoom;a.object.left=this.left;a.object.right=this.right;a.object.top=this.top;a.object.bottom=this.bottom;a.object.near=this.near;a.object.far=this.far;null!==this.view&&(a.object.view=Object.assign({},this.view));return a}});Object.assign(Wa.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.a=a.a;this.b=a.b;this.c=a.c;this.normal.copy(a.normal);this.color.copy(a.color);this.materialIndex=a.materialIndex;for(var b=0,c=a.vertexNormals.length;b<
c;b++)this.vertexNormals[b]=a.vertexNormals[b].clone();b=0;for(c=a.vertexColors.length;b<c;b++)this.vertexColors[b]=a.vertexColors[b].clone();return this}});var If=0;K.prototype=Object.assign(Object.create(ib.prototype),{constructor:K,isGeometry:!0,applyMatrix:function(a){for(var b=(new la).getNormalMatrix(a),c=0,d=this.vertices.length;c<d;c++)this.vertices[c].applyMatrix4(a);c=0;for(d=this.faces.length;c<d;c++){a=this.faces[c];a.normal.applyMatrix3(b).normalize();for(var e=0,f=a.vertexNormals.length;e<
f;e++)a.vertexNormals[e].applyMatrix3(b).normalize()}null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere();this.normalsNeedUpdate=this.verticesNeedUpdate=!0;return this},rotateX:function(){var a=new I;return function(b){a.makeRotationX(b);this.applyMatrix(a);return this}}(),rotateY:function(){var a=new I;return function(b){a.makeRotationY(b);this.applyMatrix(a);return this}}(),rotateZ:function(){var a=new I;return function(b){a.makeRotationZ(b);
this.applyMatrix(a);return this}}(),translate:function(){var a=new I;return function(b,c,d){a.makeTranslation(b,c,d);this.applyMatrix(a);return this}}(),scale:function(){var a=new I;return function(b,c,d){a.makeScale(b,c,d);this.applyMatrix(a);return this}}(),lookAt:function(){var a=new B;return function(b){a.lookAt(b);a.updateMatrix();this.applyMatrix(a.matrix)}}(),fromBufferGeometry:function(a){function b(a,b,d,e){var f=void 0!==g?[l[a].clone(),l[b].clone(),l[d].clone()]:[],q=void 0!==h?[c.colors[a].clone(),
c.colors[b].clone(),c.colors[d].clone()]:[];e=new Wa(a,b,d,f,q,e);c.faces.push(e);void 0!==k&&c.faceVertexUvs[0].push([n[a].clone(),n[b].clone(),n[d].clone()]);void 0!==m&&c.faceVertexUvs[1].push([u[a].clone(),u[b].clone(),u[d].clone()])}var c=this,d=null!==a.index?a.index.array:void 0,e=a.attributes,f=e.position.array,g=void 0!==e.normal?e.normal.array:void 0,h=void 0!==e.color?e.color.array:void 0,k=void 0!==e.uv?e.uv.array:void 0,m=void 0!==e.uv2?e.uv2.array:void 0;void 0!==m&&(this.faceVertexUvs[1]=
[]);for(var l=[],n=[],u=[],t=e=0;e<f.length;e+=3,t+=2)c.vertices.push(new p(f[e],f[e+1],f[e+2])),void 0!==g&&l.push(new p(g[e],g[e+1],g[e+2])),void 0!==h&&c.colors.push(new G(h[e],h[e+1],h[e+2])),void 0!==k&&n.push(new C(k[t],k[t+1])),void 0!==m&&u.push(new C(m[t],m[t+1]));var r=a.groups;if(0<r.length)for(e=0;e<r.length;e++){f=r[e];var v=f.start,z=f.count;t=v;for(v+=z;t<v;t+=3)void 0!==d?b(d[t],d[t+1],d[t+2],f.materialIndex):b(t,t+1,t+2,f.materialIndex)}else if(void 0!==d)for(e=0;e<d.length;e+=3)b(d[e],
d[e+1],d[e+2]);else for(e=0;e<f.length/3;e+=3)b(e,e+1,e+2);this.computeFaceNormals();null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone());null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone());return this},center:function(){var a=new p;return function(){this.computeBoundingBox();this.boundingBox.getCenter(a).negate();this.translate(a.x,a.y,a.z);return this}}(),normalize:function(){this.computeBoundingSphere();var a=this.boundingSphere.center,b=this.boundingSphere.radius;
b=0===b?1:1/b;var c=new I;c.set(b,0,0,-b*a.x,0,b,0,-b*a.y,0,0,b,-b*a.z,0,0,0,1);this.applyMatrix(c);return this},computeFaceNormals:function(){for(var a=new p,b=new p,c=0,d=this.faces.length;c<d;c++){var e=this.faces[c],f=this.vertices[e.a],g=this.vertices[e.b];a.subVectors(this.vertices[e.c],g);b.subVectors(f,g);a.cross(b);a.normalize();e.normal.copy(a)}},computeVertexNormals:function(a){void 0===a&&(a=!0);var b;var c=Array(this.vertices.length);var d=0;for(b=this.vertices.length;d<b;d++)c[d]=new p;
if(a){var e=new p,f=new p;a=0;for(d=this.faces.length;a<d;a++){b=this.faces[a];var g=this.vertices[b.a];var h=this.vertices[b.b];var k=this.vertices[b.c];e.subVectors(k,h);f.subVectors(g,h);e.cross(f);c[b.a].add(e);c[b.b].add(e);c[b.c].add(e)}}else for(this.computeFaceNormals(),a=0,d=this.faces.length;a<d;a++)b=this.faces[a],c[b.a].add(b.normal),c[b.b].add(b.normal),c[b.c].add(b.normal);d=0;for(b=this.vertices.length;d<b;d++)c[d].normalize();a=0;for(d=this.faces.length;a<d;a++)b=this.faces[a],g=b.vertexNormals,
3===g.length?(g[0].copy(c[b.a]),g[1].copy(c[b.b]),g[2].copy(c[b.c])):(g[0]=c[b.a].clone(),g[1]=c[b.b].clone(),g[2]=c[b.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var a;this.computeFaceNormals();var b=0;for(a=this.faces.length;b<a;b++){var c=this.faces[b];var d=c.vertexNormals;3===d.length?(d[0].copy(c.normal),d[1].copy(c.normal),d[2].copy(c.normal)):(d[0]=c.normal.clone(),d[1]=c.normal.clone(),d[2]=c.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=
!0)},computeMorphNormals:function(){var a,b;var c=0;for(b=this.faces.length;c<b;c++){var d=this.faces[c];d.__originalFaceNormal?d.__originalFaceNormal.copy(d.normal):d.__originalFaceNormal=d.normal.clone();d.__originalVertexNormals||(d.__originalVertexNormals=[]);var e=0;for(a=d.vertexNormals.length;e<a;e++)d.__originalVertexNormals[e]?d.__originalVertexNormals[e].copy(d.vertexNormals[e]):d.__originalVertexNormals[e]=d.vertexNormals[e].clone()}var f=new K;f.faces=this.faces;e=0;for(a=this.morphTargets.length;e<
a;e++){if(!this.morphNormals[e]){this.morphNormals[e]={};this.morphNormals[e].faceNormals=[];this.morphNormals[e].vertexNormals=[];d=this.morphNormals[e].faceNormals;var g=this.morphNormals[e].vertexNormals;c=0;for(b=this.faces.length;c<b;c++){var h=new p;var k={a:new p,b:new p,c:new p};d.push(h);g.push(k)}}g=this.morphNormals[e];f.vertices=this.morphTargets[e].vertices;f.computeFaceNormals();f.computeVertexNormals();c=0;for(b=this.faces.length;c<b;c++)d=this.faces[c],h=g.faceNormals[c],k=g.vertexNormals[c],
h.copy(d.normal),k.a.copy(d.vertexNormals[0]),k.b.copy(d.vertexNormals[1]),k.c.copy(d.vertexNormals[2])}c=0;for(b=this.faces.length;c<b;c++)d=this.faces[c],d.normal=d.__originalFaceNormal,d.vertexNormals=d.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Va);this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new za);this.boundingSphere.setFromPoints(this.vertices)},merge:function(a,
b,c){if(a&&a.isGeometry){var d,e=this.vertices.length,f=this.vertices,g=a.vertices,h=this.faces,k=a.faces,m=this.faceVertexUvs[0],l=a.faceVertexUvs[0],n=this.colors,u=a.colors;void 0===c&&(c=0);void 0!==b&&(d=(new la).getNormalMatrix(b));a=0;for(var p=g.length;a<p;a++){var r=g[a].clone();void 0!==b&&r.applyMatrix4(b);f.push(r)}a=0;for(p=u.length;a<p;a++)n.push(u[a].clone());a=0;for(p=k.length;a<p;a++){g=k[a];var v=g.vertexNormals;u=g.vertexColors;n=new Wa(g.a+e,g.b+e,g.c+e);n.normal.copy(g.normal);
void 0!==d&&n.normal.applyMatrix3(d).normalize();b=0;for(f=v.length;b<f;b++)r=v[b].clone(),void 0!==d&&r.applyMatrix3(d).normalize(),n.vertexNormals.push(r);n.color.copy(g.color);b=0;for(f=u.length;b<f;b++)r=u[b],n.vertexColors.push(r.clone());n.materialIndex=g.materialIndex+c;h.push(n)}a=0;for(p=l.length;a<p;a++)if(c=l[a],d=[],void 0!==c){b=0;for(f=c.length;b<f;b++)d.push(c[b].clone());m.push(d)}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",a)},mergeMesh:function(a){a&&
a.isMesh?(a.matrixAutoUpdate&&a.updateMatrix(),this.merge(a.geometry,a.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",a)},mergeVertices:function(){var a={},b=[],c=[],d=Math.pow(10,4),e;var f=0;for(e=this.vertices.length;f<e;f++){var g=this.vertices[f];g=Math.round(g.x*d)+"_"+Math.round(g.y*d)+"_"+Math.round(g.z*d);void 0===a[g]?(a[g]=f,b.push(this.vertices[f]),c[f]=b.length-1):c[f]=c[a[g]]}a=[];f=0;for(e=this.faces.length;f<e;f++)for(d=this.faces[f],d.a=c[d.a],
d.b=c[d.b],d.c=c[d.c],d=[d.a,d.b,d.c],g=0;3>g;g++)if(d[g]===d[(g+1)%3]){a.push(f);break}for(f=a.length-1;0<=f;f--)for(d=a[f],this.faces.splice(d,1),c=0,e=this.faceVertexUvs.length;c<e;c++)this.faceVertexUvs[c].splice(d,1);f=this.vertices.length-b.length;this.vertices=b;return f},setFromPoints:function(a){this.vertices=[];for(var b=0,c=a.length;b<c;b++){var d=a[b];this.vertices.push(new p(d.x,d.y,d.z||0))}return this},sortFacesByMaterialIndex:function(){for(var a=this.faces,b=a.length,c=0;c<b;c++)a[c]._id=
c;a.sort(function(a,b){return a.materialIndex-b.materialIndex});var d=this.faceVertexUvs[0],e=this.faceVertexUvs[1],f,g;d&&d.length===b&&(f=[]);e&&e.length===b&&(g=[]);for(c=0;c<b;c++){var h=a[c]._id;f&&f.push(d[h]);g&&g.push(e[h])}f&&(this.faceVertexUvs[0]=f);g&&(this.faceVertexUvs[1]=g)},toJSON:function(){function a(a,b,c){return c?a|1<<b:a&~(1<<b)}function b(a){var b=a.x.toString()+a.y.toString()+a.z.toString();if(void 0!==m[b])return m[b];m[b]=k.length/3;k.push(a.x,a.y,a.z);return m[b]}function c(a){var b=
a.r.toString()+a.g.toString()+a.b.toString();if(void 0!==n[b])return n[b];n[b]=l.length;l.push(a.getHex());return n[b]}function d(a){var b=a.x.toString()+a.y.toString();if(void 0!==p[b])return p[b];p[b]=u.length/2;u.push(a.x,a.y);return p[b]}var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};e.uuid=this.uuid;e.type=this.type;""!==this.name&&(e.name=this.name);if(void 0!==this.parameters){var f=this.parameters,g;for(g in f)void 0!==f[g]&&(e[g]=f[g]);return e}f=[];for(g=0;g<
this.vertices.length;g++){var h=this.vertices[g];f.push(h.x,h.y,h.z)}h=[];var k=[],m={},l=[],n={},u=[],p={};for(g=0;g<this.faces.length;g++){var r=this.faces[g],v=void 0!==this.faceVertexUvs[0][g],z=0<r.normal.length(),x=0<r.vertexNormals.length,w=1!==r.color.r||1!==r.color.g||1!==r.color.b,y=0<r.vertexColors.length,H=0;H=a(H,0,0);H=a(H,1,!0);H=a(H,2,!1);H=a(H,3,v);H=a(H,4,z);H=a(H,5,x);H=a(H,6,w);H=a(H,7,y);h.push(H);h.push(r.a,r.b,r.c);h.push(r.materialIndex);v&&(v=this.faceVertexUvs[0][g],h.push(d(v[0]),
d(v[1]),d(v[2])));z&&h.push(b(r.normal));x&&(z=r.vertexNormals,h.push(b(z[0]),b(z[1]),b(z[2])));w&&h.push(c(r.color));y&&(r=r.vertexColors,h.push(c(r[0]),c(r[1]),c(r[2])))}e.data={};e.data.vertices=f;e.data.normals=k;0<l.length&&(e.data.colors=l);0<u.length&&(e.data.uvs=[u]);e.data.faces=h;return e},clone:function(){return(new K).copy(this)},copy:function(a){var b,c,d;this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];
this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.name=a.name;var e=a.vertices;var f=0;for(b=e.length;f<b;f++)this.vertices.push(e[f].clone());e=a.colors;f=0;for(b=e.length;f<b;f++)this.colors.push(e[f].clone());e=a.faces;f=0;for(b=e.length;f<b;f++)this.faces.push(e[f].clone());f=0;for(b=a.faceVertexUvs.length;f<b;f++){var g=a.faceVertexUvs[f];void 0===this.faceVertexUvs[f]&&(this.faceVertexUvs[f]=[]);e=0;for(c=g.length;e<c;e++){var h=g[e],k=[];var m=0;for(d=
h.length;m<d;m++)k.push(h[m].clone());this.faceVertexUvs[f].push(k)}}m=a.morphTargets;f=0;for(b=m.length;f<b;f++){d={};d.name=m[f].name;if(void 0!==m[f].vertices)for(d.vertices=[],e=0,c=m[f].vertices.length;e<c;e++)d.vertices.push(m[f].vertices[e].clone());if(void 0!==m[f].normals)for(d.normals=[],e=0,c=m[f].normals.length;e<c;e++)d.normals.push(m[f].normals[e].clone());this.morphTargets.push(d)}m=a.morphNormals;f=0;for(b=m.length;f<b;f++){d={};if(void 0!==m[f].vertexNormals)for(d.vertexNormals=[],
e=0,c=m[f].vertexNormals.length;e<c;e++)g=m[f].vertexNormals[e],h={},h.a=g.a.clone(),h.b=g.b.clone(),h.c=g.c.clone(),d.vertexNormals.push(h);if(void 0!==m[f].faceNormals)for(d.faceNormals=[],e=0,c=m[f].faceNormals.length;e<c;e++)d.faceNormals.push(m[f].faceNormals[e].clone());this.morphNormals.push(d)}e=a.skinWeights;f=0;for(b=e.length;f<b;f++)this.skinWeights.push(e[f].clone());e=a.skinIndices;f=0;for(b=e.length;f<b;f++)this.skinIndices.push(e[f].clone());e=a.lineDistances;f=0;for(b=e.length;f<b;f++)this.lineDistances.push(e[f]);
f=a.boundingBox;null!==f&&(this.boundingBox=f.clone());f=a.boundingSphere;null!==f&&(this.boundingSphere=f.clone());this.elementsNeedUpdate=a.elementsNeedUpdate;this.verticesNeedUpdate=a.verticesNeedUpdate;this.uvsNeedUpdate=a.uvsNeedUpdate;this.normalsNeedUpdate=a.normalsNeedUpdate;this.colorsNeedUpdate=a.colorsNeedUpdate;this.lineDistancesNeedUpdate=a.lineDistancesNeedUpdate;this.groupsNeedUpdate=a.groupsNeedUpdate;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});Object.defineProperty(P.prototype,
"needsUpdate",{set:function(a){!0===a&&this.version++}});Object.assign(P.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(a){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==a?a.length/this.itemSize:0;this.array=a;return this},setDynamic:function(a){this.dynamic=a;return this},copy:function(a){this.name=a.name;this.array=new a.array.constructor(a.array);this.itemSize=a.itemSize;this.count=a.count;this.normalized=
a.normalized;this.dynamic=a.dynamic;return this},copyAt:function(a,b,c){a*=this.itemSize;c*=b.itemSize;for(var d=0,e=this.itemSize;d<e;d++)this.array[a+d]=b.array[c+d];return this},copyArray:function(a){this.array.set(a);return this},copyColorsArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];void 0===f&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",d),f=new G);b[c++]=f.r;b[c++]=f.g;b[c++]=f.b}return this},copyVector2sArray:function(a){for(var b=
this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];void 0===f&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",d),f=new C);b[c++]=f.x;b[c++]=f.y}return this},copyVector3sArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=a[d];void 0===f&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",d),f=new p);b[c++]=f.x;b[c++]=f.y;b[c++]=f.z}return this},copyVector4sArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var f=
a[d];void 0===f&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",d),f=new ca);b[c++]=f.x;b[c++]=f.y;b[c++]=f.z;b[c++]=f.w}return this},set:function(a,b){void 0===b&&(b=0);this.array.set(a,b);return this},getX:function(a){return this.array[a*this.itemSize]},setX:function(a,b){this.array[a*this.itemSize]=b;return this},getY:function(a){return this.array[a*this.itemSize+1]},setY:function(a,b){this.array[a*this.itemSize+1]=b;return this},getZ:function(a){return this.array[a*
this.itemSize+2]},setZ:function(a,b){this.array[a*this.itemSize+2]=b;return this},getW:function(a){return this.array[a*this.itemSize+3]},setW:function(a,b){this.array[a*this.itemSize+3]=b;return this},setXY:function(a,b,c){a*=this.itemSize;this.array[a+0]=b;this.array[a+1]=c;return this},setXYZ:function(a,b,c,d){a*=this.itemSize;this.array[a+0]=b;this.array[a+1]=c;this.array[a+2]=d;return this},setXYZW:function(a,b,c,d,e){a*=this.itemSize;this.array[a+0]=b;this.array[a+1]=c;this.array[a+2]=d;this.array[a+
3]=e;return this},onUpload:function(a){this.onUploadCallback=a;return this},clone:function(){return(new this.constructor(this.array,this.itemSize)).copy(this)}});qc.prototype=Object.create(P.prototype);qc.prototype.constructor=qc;rc.prototype=Object.create(P.prototype);rc.prototype.constructor=rc;sc.prototype=Object.create(P.prototype);sc.prototype.constructor=sc;tc.prototype=Object.create(P.prototype);tc.prototype.constructor=tc;mb.prototype=Object.create(P.prototype);mb.prototype.constructor=mb;
uc.prototype=Object.create(P.prototype);uc.prototype.constructor=uc;nb.prototype=Object.create(P.prototype);nb.prototype.constructor=nb;A.prototype=Object.create(P.prototype);A.prototype.constructor=A;vc.prototype=Object.create(P.prototype);vc.prototype.constructor=vc;Object.assign(Ae.prototype,{computeGroups:function(a){var b=[],c=void 0;a=a.faces;for(var d=0;d<a.length;d++){var e=a[d];if(e.materialIndex!==c){c=e.materialIndex;void 0!==f&&(f.count=3*d-f.start,b.push(f));var f={start:3*d,materialIndex:c}}}void 0!==
f&&(f.count=3*d-f.start,b.push(f));this.groups=b},fromGeometry:function(a){var b=a.faces,c=a.vertices,d=a.faceVertexUvs,e=d[0]&&0<d[0].length,f=d[1]&&0<d[1].length,g=a.morphTargets,h=g.length;if(0<h){var k=[];for(var m=0;m<h;m++)k[m]=[];this.morphTargets.position=k}var l=a.morphNormals,n=l.length;if(0<n){var u=[];for(m=0;m<n;m++)u[m]=[];this.morphTargets.normal=u}var p=a.skinIndices,r=a.skinWeights,v=p.length===c.length,z=r.length===c.length;0<c.length&&0===b.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");
for(m=0;m<b.length;m++){var x=b[m];this.vertices.push(c[x.a],c[x.b],c[x.c]);var w=x.vertexNormals;3===w.length?this.normals.push(w[0],w[1],w[2]):(w=x.normal,this.normals.push(w,w,w));w=x.vertexColors;3===w.length?this.colors.push(w[0],w[1],w[2]):(w=x.color,this.colors.push(w,w,w));!0===e&&(w=d[0][m],void 0!==w?this.uvs.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",m),this.uvs.push(new C,new C,new C)));!0===f&&(w=d[1][m],void 0!==w?this.uvs2.push(w[0],
w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",m),this.uvs2.push(new C,new C,new C)));for(w=0;w<h;w++){var y=g[w].vertices;k[w].push(y[x.a],y[x.b],y[x.c])}for(w=0;w<n;w++)y=l[w].vertexNormals[m],u[w].push(y.a,y.b,y.c);v&&this.skinIndices.push(p[x.a],p[x.b],p[x.c]);z&&this.skinWeights.push(r[x.a],r[x.b],r[x.c])}this.computeGroups(a);this.verticesNeedUpdate=a.verticesNeedUpdate;this.normalsNeedUpdate=a.normalsNeedUpdate;this.colorsNeedUpdate=a.colorsNeedUpdate;
this.uvsNeedUpdate=a.uvsNeedUpdate;this.groupsNeedUpdate=a.groupsNeedUpdate;return this}});var Jf=1;E.prototype=Object.assign(Object.create(ib.prototype),{constructor:E,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(a){Array.isArray(a)?this.index=new (65535<Be(a)?nb:mb)(a,1):this.index=a},addAttribute:function(a,b,c){if(!(b&&b.isBufferAttribute||b&&b.isInterleavedBufferAttribute))return console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),
this.addAttribute(a,new P(b,c));if("index"===a)return console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(b),this;this.attributes[a]=b;return this},getAttribute:function(a){return this.attributes[a]},removeAttribute:function(a){delete this.attributes[a];return this},addGroup:function(a,b,c){this.groups.push({start:a,count:b,materialIndex:void 0!==c?c:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(a,b){this.drawRange.start=a;this.drawRange.count=
b},applyMatrix:function(a){var b=this.attributes.position;void 0!==b&&(a.applyToBufferAttribute(b),b.needsUpdate=!0);b=this.attributes.normal;void 0!==b&&((new la).getNormalMatrix(a).applyToBufferAttribute(b),b.needsUpdate=!0);null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere();return this},rotateX:function(){var a=new I;return function(b){a.makeRotationX(b);this.applyMatrix(a);return this}}(),rotateY:function(){var a=new I;return function(b){a.makeRotationY(b);
this.applyMatrix(a);return this}}(),rotateZ:function(){var a=new I;return function(b){a.makeRotationZ(b);this.applyMatrix(a);return this}}(),translate:function(){var a=new I;return function(b,c,d){a.makeTranslation(b,c,d);this.applyMatrix(a);return this}}(),scale:function(){var a=new I;return function(b,c,d){a.makeScale(b,c,d);this.applyMatrix(a);return this}}(),lookAt:function(){var a=new B;return function(b){a.lookAt(b);a.updateMatrix();this.applyMatrix(a.matrix)}}(),center:function(){var a=new p;
return function(){this.computeBoundingBox();this.boundingBox.getCenter(a).negate();this.translate(a.x,a.y,a.z);return this}}(),setFromObject:function(a){var b=a.geometry;if(a.isPoints||a.isLine){a=new A(3*b.vertices.length,3);var c=new A(3*b.colors.length,3);this.addAttribute("position",a.copyVector3sArray(b.vertices));this.addAttribute("color",c.copyColorsArray(b.colors));b.lineDistances&&b.lineDistances.length===b.vertices.length&&(a=new A(b.lineDistances.length,1),this.addAttribute("lineDistance",
a.copyArray(b.lineDistances)));null!==b.boundingSphere&&(this.boundingSphere=b.boundingSphere.clone());null!==b.boundingBox&&(this.boundingBox=b.boundingBox.clone())}else a.isMesh&&b&&b.isGeometry&&this.fromGeometry(b);return this},setFromPoints:function(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c];b.push(e.x,e.y,e.z||0)}this.addAttribute("position",new A(b,3));return this},updateFromObject:function(a){var b=a.geometry;if(a.isMesh){var c=b.__directGeometry;!0===b.elementsNeedUpdate&&(c=void 0,
b.elementsNeedUpdate=!1);if(void 0===c)return this.fromGeometry(b);c.verticesNeedUpdate=b.verticesNeedUpdate;c.normalsNeedUpdate=b.normalsNeedUpdate;c.colorsNeedUpdate=b.colorsNeedUpdate;c.uvsNeedUpdate=b.uvsNeedUpdate;c.groupsNeedUpdate=b.groupsNeedUpdate;b.verticesNeedUpdate=!1;b.normalsNeedUpdate=!1;b.colorsNeedUpdate=!1;b.uvsNeedUpdate=!1;b.groupsNeedUpdate=!1;b=c}!0===b.verticesNeedUpdate&&(c=this.attributes.position,void 0!==c&&(c.copyVector3sArray(b.vertices),c.needsUpdate=!0),b.verticesNeedUpdate=
!1);!0===b.normalsNeedUpdate&&(c=this.attributes.normal,void 0!==c&&(c.copyVector3sArray(b.normals),c.needsUpdate=!0),b.normalsNeedUpdate=!1);!0===b.colorsNeedUpdate&&(c=this.attributes.color,void 0!==c&&(c.copyColorsArray(b.colors),c.needsUpdate=!0),b.colorsNeedUpdate=!1);b.uvsNeedUpdate&&(c=this.attributes.uv,void 0!==c&&(c.copyVector2sArray(b.uvs),c.needsUpdate=!0),b.uvsNeedUpdate=!1);b.lineDistancesNeedUpdate&&(c=this.attributes.lineDistance,void 0!==c&&(c.copyArray(b.lineDistances),c.needsUpdate=
!0),b.lineDistancesNeedUpdate=!1);b.groupsNeedUpdate&&(b.computeGroups(a.geometry),this.groups=b.groups,b.groupsNeedUpdate=!1);return this},fromGeometry:function(a){a.__directGeometry=(new Ae).fromGeometry(a);return this.fromDirectGeometry(a.__directGeometry)},fromDirectGeometry:function(a){var b=new Float32Array(3*a.vertices.length);this.addAttribute("position",(new P(b,3)).copyVector3sArray(a.vertices));0<a.normals.length&&(b=new Float32Array(3*a.normals.length),this.addAttribute("normal",(new P(b,
3)).copyVector3sArray(a.normals)));0<a.colors.length&&(b=new Float32Array(3*a.colors.length),this.addAttribute("color",(new P(b,3)).copyColorsArray(a.colors)));0<a.uvs.length&&(b=new Float32Array(2*a.uvs.length),this.addAttribute("uv",(new P(b,2)).copyVector2sArray(a.uvs)));0<a.uvs2.length&&(b=new Float32Array(2*a.uvs2.length),this.addAttribute("uv2",(new P(b,2)).copyVector2sArray(a.uvs2)));this.groups=a.groups;for(var c in a.morphTargets){b=[];for(var d=a.morphTargets[c],e=0,f=d.length;e<f;e++){var g=
d[e],h=new A(3*g.length,3);b.push(h.copyVector3sArray(g))}this.morphAttributes[c]=b}0<a.skinIndices.length&&(c=new A(4*a.skinIndices.length,4),this.addAttribute("skinIndex",c.copyVector4sArray(a.skinIndices)));0<a.skinWeights.length&&(c=new A(4*a.skinWeights.length,4),this.addAttribute("skinWeight",c.copyVector4sArray(a.skinWeights)));null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone());null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone());return this},computeBoundingBox:function(){null===
this.boundingBox&&(this.boundingBox=new Va);var a=this.attributes.position;void 0!==a?this.boundingBox.setFromBufferAttribute(a):this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var a=new Va,b=new p;return function(){null===this.boundingSphere&&
(this.boundingSphere=new za);var c=this.attributes.position;if(c){var d=this.boundingSphere.center;a.setFromBufferAttribute(c);a.getCenter(d);for(var e=0,f=0,g=c.count;f<g;f++)b.x=c.getX(f),b.y=c.getY(f),b.z=c.getZ(f),e=Math.max(e,d.distanceToSquared(b));this.boundingSphere.radius=Math.sqrt(e);isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},
computeVertexNormals:function(){var a=this.index,b=this.attributes,c=this.groups;if(b.position){var d=b.position.array;if(void 0===b.normal)this.addAttribute("normal",new P(new Float32Array(d.length),3));else for(var e=b.normal.array,f=0,g=e.length;f<g;f++)e[f]=0;e=b.normal.array;var h=new p,k=new p,m=new p,l=new p,n=new p;if(a){a=a.array;0===c.length&&this.addGroup(0,a.length);for(var u=0,t=c.length;u<t;++u){f=c[u];g=f.start;var r=f.count;f=g;for(g+=r;f<g;f+=3){r=3*a[f+0];var v=3*a[f+1];var z=3*
a[f+2];h.fromArray(d,r);k.fromArray(d,v);m.fromArray(d,z);l.subVectors(m,k);n.subVectors(h,k);l.cross(n);e[r]+=l.x;e[r+1]+=l.y;e[r+2]+=l.z;e[v]+=l.x;e[v+1]+=l.y;e[v+2]+=l.z;e[z]+=l.x;e[z+1]+=l.y;e[z+2]+=l.z}}}else for(f=0,g=d.length;f<g;f+=9)h.fromArray(d,f),k.fromArray(d,f+3),m.fromArray(d,f+6),l.subVectors(m,k),n.subVectors(h,k),l.cross(n),e[f]=l.x,e[f+1]=l.y,e[f+2]=l.z,e[f+3]=l.x,e[f+4]=l.y,e[f+5]=l.z,e[f+6]=l.x,e[f+7]=l.y,e[f+8]=l.z;this.normalizeNormals();b.normal.needsUpdate=!0}},merge:function(a,
b){if(a&&a.isBufferGeometry){void 0===b&&(b=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var c=this.attributes,d;for(d in c)if(void 0!==a.attributes[d]){var e=c[d].array,f=a.attributes[d],g=f.array,h=0;for(f=f.itemSize*b;h<g.length;h++,f++)e[f]=g[h]}return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",a)},normalizeNormals:function(){var a=
new p;return function(){for(var b=this.attributes.normal,c=0,d=b.count;c<d;c++)a.x=b.getX(c),a.y=b.getY(c),a.z=b.getZ(c),a.normalize(),b.setXYZ(c,a.x,a.y,a.z)}}(),toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var a=new E,b=this.index.array,c=this.attributes,d;for(d in c){var e=c[d],f=e.array,g=e.itemSize,h=new f.constructor(b.length*g),k=0;e=0;for(var m=b.length;e<m;e++){var l=b[e]*g;for(var n=0;n<g;n++)h[k++]=
f[l++]}a.addAttribute(d,new P(h,g))}b=this.groups;e=0;for(m=b.length;e<m;e++)c=b[e],a.addGroup(c.start,c.count,c.materialIndex);return a},toJSON:function(){var a={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};a.uuid=this.uuid;a.type=this.type;""!==this.name&&(a.name=this.name);0<Object.keys(this.userData).length&&(a.userData=this.userData);if(void 0!==this.parameters){var b=this.parameters;for(e in b)void 0!==b[e]&&(a[e]=b[e]);return a}a.data={attributes:{}};var c=
this.index;null!==c&&(b=Array.prototype.slice.call(c.array),a.data.index={type:c.array.constructor.name,array:b});c=this.attributes;for(e in c){var d=c[e];b=Array.prototype.slice.call(d.array);a.data.attributes[e]={itemSize:d.itemSize,type:d.array.constructor.name,array:b,normalized:d.normalized}}var e=this.groups;0<e.length&&(a.data.groups=JSON.parse(JSON.stringify(e)));e=this.boundingSphere;null!==e&&(a.data.boundingSphere={center:e.center.toArray(),radius:e.radius});return a},clone:function(){return(new E).copy(this)},
copy:function(a){var b;this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;this.name=a.name;var c=a.index;null!==c&&this.setIndex(c.clone());c=a.attributes;for(g in c)this.addAttribute(g,c[g].clone());var d=a.morphAttributes;for(g in d){var e=[],f=d[g];c=0;for(b=f.length;c<b;c++)e.push(f[c].clone());this.morphAttributes[g]=e}var g=a.groups;c=0;for(b=g.length;c<b;c++)d=g[c],this.addGroup(d.start,d.count,d.materialIndex);g=a.boundingBox;
null!==g&&(this.boundingBox=g.clone());g=a.boundingSphere;null!==g&&(this.boundingSphere=g.clone());this.drawRange.start=a.drawRange.start;this.drawRange.count=a.drawRange.count;this.userData=a.userData;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});Kb.prototype=Object.create(K.prototype);Kb.prototype.constructor=Kb;ob.prototype=Object.create(E.prototype);ob.prototype.constructor=ob;wc.prototype=Object.create(K.prototype);wc.prototype.constructor=wc;pb.prototype=Object.create(E.prototype);
pb.prototype.constructor=pb;var ah=function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),bh=function(){function a(){}a.generateId=function(){return a.id++};a.id=0;return a}(),F=function(a){function b(){var b=a.call(this)||this;
b._isMaterial=!0;b.attributes=null;b.needsUpdate=!0;b.type="Material";b.alphaTest=0;b.blendDst=205;b.blendDstAlpha=null;b.blendEquation=100;b.blendEquationAlpha=null;b.blendSrc=204;b.blendSrcAlpha=null;b.blending=1;b.clipIntersection=!1;b.clipShadows=!1;b.clippingPlanes=null;b.colorWrite=!0;b.depthFunc=3;b.depthTest=!0;b.depthWrite=!0;b.dithering=!1;b.flatShading=!1;b.fog=!0;b.lights=!0;b.name="";b.opacity=1;b.overdraw=0;b.polygonOffset=!1;b.polygonOffsetFactor=0;b.polygonOffsetUnits=0;b.precision=
null;b.premultipliedAlpha=!1;b.shadowSide=null;b.side=0;b.transparent=!1;b.userData={};b.vertexColors=0;b.visible=!0;b._id=bh.generateId();b.uuid=Q.generateUUID();return b}ah(b,a);Object.defineProperty(b.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isMaterial",{get:function(){return this._isMaterial},enumerable:!0,configurable:!0});b.prototype.clone=function(){return(new b).copy(this)};b.prototype.copy=function(a){this.name=a.name;
this.fog=a.fog;this.lights=a.lights;this.blending=a.blending;this.side=a.side;this.flatShading=a.flatShading;this.vertexColors=a.vertexColors;this.opacity=a.opacity;this.transparent=a.transparent;this.blendSrc=a.blendSrc;this.blendDst=a.blendDst;this.blendEquation=a.blendEquation;this.blendSrcAlpha=a.blendSrcAlpha;this.blendDstAlpha=a.blendDstAlpha;this.blendEquationAlpha=a.blendEquationAlpha;this.depthFunc=a.depthFunc;this.depthTest=a.depthTest;this.depthWrite=a.depthWrite;this.colorWrite=a.colorWrite;
this.precision=a.precision;this.polygonOffset=a.polygonOffset;this.polygonOffsetFactor=a.polygonOffsetFactor;this.polygonOffsetUnits=a.polygonOffsetUnits;this.dithering=a.dithering;this.alphaTest=a.alphaTest;this.premultipliedAlpha=a.premultipliedAlpha;this.overdraw=a.overdraw;this.visible=a.visible;this.userData=JSON.parse(JSON.stringify(a.userData));this.clipShadows=a.clipShadows;this.clipIntersection=a.clipIntersection;var b=a.clippingPlanes,c=null;if(null!==b){var f=b.length;c=Array(f);for(var g=
0;g!==f;++g)c[g]=b[g].clone()}this.clippingPlanes=c;this.shadowSide=a.shadowSide;return this};b.prototype.dispose=function(){this.dispatchEvent({type:"dispose"})};b.prototype.onBeforeCompile=function(){};b.prototype.setValues=function(a){if(void 0!==a)for(var b in a){var c=a[b];if(void 0===c)console.warn("THREE.Material: '"+b+"' parameter is undefined.");else if("shading"===b)console.warn("THREE.'"+this.type+"': .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===
c?!0:!1;else{var f=this[b];void 0===f?console.warn("THREE."+this.type+": '"+b+"' is not a property of this material."):f&&f.isColor?f.set(c):f&&f.isVector3&&c&&c.isVector3?f.copy(c):this[b]="overdraw"===b?Number(c):c}}};b.prototype.toJSON=function(a){var b=void 0===a||"string"===typeof a;b&&(a={textures:{},images:{}});var c={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};c.uuid=this.uuid;c.type=this.type;""!==this.name&&(c.name=this.name);this.color&&this.color.isColor&&(c.color=
this.color.getHex());void 0!==this.roughness&&(c.roughness=this.roughness);void 0!==this.metalness&&(c.metalness=this.metalness);this.emissive&&this.emissive.isColor&&(c.emissive=this.emissive.getHex());1!==this.emissiveIntensity&&(c.emissiveIntensity=this.emissiveIntensity);this.specular&&this.specular.isColor&&(c.specular=this.specular.getHex());void 0!==this.shininess&&(c.shininess=this.shininess);void 0!==this.clearCoat&&(c.clearCoat=this.clearCoat);void 0!==this.clearCoatRoughness&&(c.clearCoatRoughness=
this.clearCoatRoughness);this.map&&this.map.isTexture&&(c.map=this.map.toJSON(a).uuid);this.alphaMap&&this.alphaMap.isTexture&&(c.alphaMap=this.alphaMap.toJSON(a).uuid);this.lightMap&&this.lightMap.isTexture&&(c.lightMap=this.lightMap.toJSON(a).uuid);this.aoMap&&this.aoMap.isTexture&&(c.aoMap=this.aoMap.toJSON(a).uuid,c.aoMapIntensity=this.aoMapIntensity);this.bumpMap&&this.bumpMap.isTexture&&(c.bumpMap=this.bumpMap.toJSON(a).uuid,c.bumpScale=this.bumpScale);this.normalMap&&this.normalMap.isTexture&&
(c.normalMap=this.normalMap.toJSON(a).uuid,c.normalMapType=this.normalMapType,c.normalScale=this.normalScale.toArray());this.displacementMap&&this.displacementMap.isTexture&&(c.displacementMap=this.displacementMap.toJSON(a).uuid,c.displacementScale=this.displacementScale,c.displacementBias=this.displacementBias);this.roughnessMap&&this.roughnessMap.isTexture&&(c.roughnessMap=this.roughnessMap.toJSON(a).uuid);this.metalnessMap&&this.metalnessMap.isTexture&&(c.metalnessMap=this.metalnessMap.toJSON(a).uuid);
this.emissiveMap&&this.emissiveMap.isTexture&&(c.emissiveMap=this.emissiveMap.toJSON(a).uuid);this.specularMap&&this.specularMap.isTexture&&(c.specularMap=this.specularMap.toJSON(a).uuid);this.envMap&&this.envMap.isTexture&&(c.envMap=this.envMap.toJSON(a).uuid,c.reflectivity=this.reflectivity);this.gradientMap&&this.gradientMap.isTexture&&(c.gradientMap=this.gradientMap.toJSON(a).uuid);void 0!==this.size&&(c.size=this.size);void 0!==this.sizeAttenuation&&(c.sizeAttenuation=this.sizeAttenuation);1!==
this.blending&&(c.blending=this.blending);!0===this.flatShading&&(c.flatShading=this.flatShading);0!==this.side&&(c.side=this.side);0!==this.vertexColors&&(c.vertexColors=this.vertexColors);1>this.opacity&&(c.opacity=this.opacity);!0===this.transparent&&(c.transparent=this.transparent);c.depthFunc=this.depthFunc;c.depthTest=this.depthTest;c.depthWrite=this.depthWrite;0!==this.rotation&&(c.rotation=this.rotation);1!==this.linewidth&&(c.linewidth=this.linewidth);void 0!==this.dashSize&&(c.dashSize=
this.dashSize);void 0!==this.gapSize&&(c.gapSize=this.gapSize);void 0!==this.scale&&(c.scale=this.scale);!0===this.dithering&&(c.dithering=!0);0<this.alphaTest&&(c.alphaTest=this.alphaTest);!0===this.premultipliedAlpha&&(c.premultipliedAlpha=this.premultipliedAlpha);!0===this.wireframe&&(c.wireframe=this.wireframe);1<this.wireframeLinewidth&&(c.wireframeLinewidth=this.wireframeLinewidth);"round"!==this.wireframeLinecap&&(c.wireframeLinecap=this.wireframeLinecap);"round"!==this.wireframeLinejoin&&
(c.wireframeLinejoin=this.wireframeLinejoin);!0===this.morphTargets&&(c.morphTargets=!0);!0===this.skinning&&(c.skinning=!0);!1===this.visible&&(c.visible=!1);"{}"!==JSON.stringify(this.userData)&&(c.userData=this.userData);var f=function(a){var b=[],c;for(c in a){var d=a[c];delete d.metadata;b.push(d)}return b};b&&(b=f(a.textures),a=f(a.images),0<b.length&&(c.textures=b),0<a.length&&(c.images=a));return c};return b}(ib);Aa.prototype=Object.create(F.prototype);Aa.prototype.constructor=Aa;Aa.prototype.isMeshBasicMaterial=
!0;Aa.prototype.copy=function(a){F.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;
this.wireframeLinejoin=a.wireframeLinejoin;this.skinning=a.skinning;this.morphTargets=a.morphTargets;return this};Da.prototype=Object.create(F.prototype);Da.prototype.constructor=Da;Da.prototype.isShaderMaterial=!0;Da.prototype.copy=function(a){F.prototype.copy.call(this,a);this.fragmentShader=a.fragmentShader;this.vertexShader=a.vertexShader;this.uniforms=Ea.clone(a.uniforms);this.defines=Object.assign({},a.defines);this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.lights=
a.lights;this.clipping=a.clipping;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;this.extensions=a.extensions;return this};Da.prototype.toJSON=function(a){a=F.prototype.toJSON.call(this,a);a.uniforms=this.uniforms;a.vertexShader=this.vertexShader;a.fragmentShader=this.fragmentShader;return a};Object.assign(qb.prototype,{set:function(a,b){this.origin.copy(a);this.direction.copy(b);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.origin.copy(a.origin);
this.direction.copy(a.direction);return this},at:function(a,b){void 0===b&&(console.warn("THREE.Ray: .at() target is now required"),b=new p);return b.copy(this.direction).multiplyScalar(a).add(this.origin)},lookAt:function(a){this.direction.copy(a).sub(this.origin).normalize();return this},recast:function(){var a=new p;return function(b){this.origin.copy(this.at(b,a));return this}}(),closestPointToPoint:function(a,b){void 0===b&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),
b=new p);b.subVectors(a,this.origin);a=b.dot(this.direction);return 0>a?b.copy(this.origin):b.copy(this.direction).multiplyScalar(a).add(this.origin)},distanceToPoint:function(a){return Math.sqrt(this.distanceSqToPoint(a))},distanceSqToPoint:function(){var a=new p;return function(b){var c=a.subVectors(b,this.origin).dot(this.direction);if(0>c)return this.origin.distanceToSquared(b);a.copy(this.direction).multiplyScalar(c).add(this.origin);return a.distanceToSquared(b)}}(),distanceSqToSegment:function(){var a=
new p,b=new p,c=new p;return function(d,e,f,g){a.copy(d).add(e).multiplyScalar(.5);b.copy(e).sub(d).normalize();c.copy(this.origin).sub(a);var h=.5*d.distanceTo(e),k=-this.direction.dot(b),m=c.dot(this.direction),l=-c.dot(b),n=c.lengthSq(),u=Math.abs(1-k*k);if(0<u){d=k*l-m;e=k*m-l;var p=h*u;0<=d?e>=-p?e<=p?(h=1/u,d*=h,e*=h,k=d*(d+k*e+2*m)+e*(k*d+e+2*l)+n):(e=h,d=Math.max(0,-(k*e+m)),k=-d*d+e*(e+2*l)+n):(e=-h,d=Math.max(0,-(k*e+m)),k=-d*d+e*(e+2*l)+n):e<=-p?(d=Math.max(0,-(-k*h+m)),e=0<d?-h:Math.min(Math.max(-h,
-l),h),k=-d*d+e*(e+2*l)+n):e<=p?(d=0,e=Math.min(Math.max(-h,-l),h),k=e*(e+2*l)+n):(d=Math.max(0,-(k*h+m)),e=0<d?h:Math.min(Math.max(-h,-l),h),k=-d*d+e*(e+2*l)+n)}else e=0<k?-h:h,d=Math.max(0,-(k*e+m)),k=-d*d+e*(e+2*l)+n;f&&f.copy(this.direction).multiplyScalar(d).add(this.origin);g&&g.copy(b).multiplyScalar(e).add(a);return k}}(),intersectSphere:function(){var a=new p;return function(b,c){a.subVectors(b.center,this.origin);var d=a.dot(this.direction),e=a.dot(a)-d*d;b=b.radius*b.radius;if(e>b)return null;
b=Math.sqrt(b-e);e=d-b;d+=b;return 0>e&&0>d?null:0>e?this.at(d,c):this.at(e,c)}}(),intersectsSphere:function(a){return this.distanceToPoint(a.center)<=a.radius},distanceToPlane:function(a){var b=a.normal.dot(this.direction);if(0===b)return 0===a.distanceToPoint(this.origin)?0:null;a=-(this.origin.dot(a.normal)+a.constant)/b;return 0<=a?a:null},intersectPlane:function(a,b){a=this.distanceToPlane(a);return null===a?null:this.at(a,b)},intersectsPlane:function(a){var b=a.distanceToPoint(this.origin);
return 0===b||0>a.normal.dot(this.direction)*b?!0:!1},intersectBox:function(a,b){var c=1/this.direction.x;var d=1/this.direction.y;var e=1/this.direction.z,f=this.origin;if(0<=c){var g=(a.min.x-f.x)*c;c*=a.max.x-f.x}else g=(a.max.x-f.x)*c,c*=a.min.x-f.x;if(0<=d){var h=(a.min.y-f.y)*d;d*=a.max.y-f.y}else h=(a.max.y-f.y)*d,d*=a.min.y-f.y;if(g>d||h>c)return null;if(h>g||g!==g)g=h;if(d<c||c!==c)c=d;0<=e?(h=(a.min.z-f.z)*e,a=(a.max.z-f.z)*e):(h=(a.max.z-f.z)*e,a=(a.min.z-f.z)*e);if(g>a||h>c)return null;
if(h>g||g!==g)g=h;if(a<c||c!==c)c=a;return 0>c?null:this.at(0<=g?g:c,b)},intersectsBox:function(){var a=new p;return function(b){return null!==this.intersectBox(b,a)}}(),intersectTriangle:function(){var a=new p,b=new p,c=new p,d=new p;return function(e,f,g,h,k){b.subVectors(f,e);c.subVectors(g,e);d.crossVectors(b,c);f=this.direction.dot(d);if(0<f){if(h)return null;h=1}else if(0>f)h=-1,f=-f;else return null;a.subVectors(this.origin,e);e=h*this.direction.dot(c.crossVectors(a,c));if(0>e)return null;
g=h*this.direction.dot(b.cross(a));if(0>g||e+g>f)return null;e=-h*a.dot(d);return 0>e?null:this.at(e/f,k)}}(),applyMatrix4:function(a){this.origin.applyMatrix4(a);this.direction.transformDirection(a);return this},equals:function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)}});Object.assign(Ba,{getNormal:function(){var a=new p;return function(b,c,d,e){void 0===e&&(console.warn("THREE.Triangle: .getNormal() target is now required"),e=new p);e.subVectors(d,c);a.subVectors(b,
c);e.cross(a);b=e.lengthSq();return 0<b?e.multiplyScalar(1/Math.sqrt(b)):e.set(0,0,0)}}(),getBarycoord:function(){var a=new p,b=new p,c=new p;return function(d,e,f,g,h){a.subVectors(g,e);b.subVectors(f,e);c.subVectors(d,e);d=a.dot(a);e=a.dot(b);f=a.dot(c);var k=b.dot(b);g=b.dot(c);var m=d*k-e*e;void 0===h&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),h=new p);if(0===m)return h.set(-2,-1,-1);m=1/m;k=(k*f-e*g)*m;d=(d*g-e*f)*m;return h.set(1-k-d,d,k)}}(),containsPoint:function(){var a=
new p;return function(b,c,d,e){Ba.getBarycoord(b,c,d,e,a);return 0<=a.x&&0<=a.y&&1>=a.x+a.y}}()});Object.assign(Ba.prototype,{set:function(a,b,c){this.a.copy(a);this.b.copy(b);this.c.copy(c);return this},setFromPointsAndIndices:function(a,b,c,d){this.a.copy(a[b]);this.b.copy(a[c]);this.c.copy(a[d]);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.a.copy(a.a);this.b.copy(a.b);this.c.copy(a.c);return this},getArea:function(){var a=new p,b=new p;return function(){a.subVectors(this.c,
this.b);b.subVectors(this.a,this.b);return.5*a.cross(b).length()}}(),getMidpoint:function(a){void 0===a&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),a=new p);return a.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(a){return Ba.getNormal(this.a,this.b,this.c,a)},getPlane:function(a){void 0===a&&(console.warn("THREE.Triangle: .getPlane() target is now required"),a=new p);return a.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(a,
b){return Ba.getBarycoord(a,this.a,this.b,this.c,b)},containsPoint:function(a){return Ba.containsPoint(a,this.a,this.b,this.c)},intersectsBox:function(a){return a.intersectsTriangle(this)},closestPointToPoint:function(){var a=new p,b=new p,c=new p,d=new p,e=new p,f=new p;return function(g,h){void 0===h&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),h=new p);var k=this.a,m=this.b,l=this.c;a.subVectors(m,k);b.subVectors(l,k);d.subVectors(g,k);var n=a.dot(d),u=b.dot(d);
if(0>=n&&0>=u)return h.copy(k);e.subVectors(g,m);var t=a.dot(e),r=b.dot(e);if(0<=t&&r<=t)return h.copy(m);var v=n*r-t*u;if(0>=v&&0<=n&&0>=t)return m=n/(n-t),h.copy(k).addScaledVector(a,m);f.subVectors(g,l);g=a.dot(f);var z=b.dot(f);if(0<=z&&g<=z)return h.copy(l);n=g*u-n*z;if(0>=n&&0<=u&&0>=z)return v=u/(u-z),h.copy(k).addScaledVector(b,v);u=t*z-g*r;if(0>=u&&0<=r-t&&0<=g-z)return c.subVectors(l,m),v=(r-t)/(r-t+(g-z)),h.copy(m).addScaledVector(c,v);l=1/(u+n+v);m=n*l;v*=l;return h.copy(k).addScaledVector(a,
m).addScaledVector(b,v)}}(),equals:function(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)}});ra.prototype=Object.assign(Object.create(B.prototype),{constructor:ra,isMesh:!0,setDrawMode:function(a){this.drawMode=a},copy:function(a){B.prototype.copy.call(this,a);this.drawMode=a.drawMode;void 0!==a.morphTargetInfluences&&(this.morphTargetInfluences=a.morphTargetInfluences.slice());void 0!==a.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},a.morphTargetDictionary));
return this},updateMorphTargets:function(){var a=this.geometry;if(a.isBufferGeometry){a=a.morphAttributes;var b=Object.keys(a);if(0<b.length){var c=a[b[0]];if(void 0!==c)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},a=0,b=c.length;a<b;a++){var d=c[a].name||String(a);this.morphTargetInfluences.push(0);this.morphTargetDictionary[d]=a}}}else if(c=a.morphTargets,void 0!==c&&0<c.length)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},a=0,b=c.length;a<b;a++)d=c[a].name||
String(a),this.morphTargetInfluences.push(0),this.morphTargetDictionary[d]=a},raycast:function(){function a(a,b,c,d,e,f,g){Ba.getBarycoord(a,b,c,d,v);e.multiplyScalar(v.x);f.multiplyScalar(v.y);g.multiplyScalar(v.z);e.add(f).add(g);return e.clone()}function b(a,b,c,d,e,f,g,h){if(null===(1===b.side?d.intersectTriangle(g,f,e,!0,h):d.intersectTriangle(e,f,g,2!==b.side,h)))return null;x.copy(h);x.applyMatrix4(a.matrixWorld);b=c.ray.origin.distanceTo(x);return b<c.near||b>c.far?null:{distance:b,point:x.clone(),
object:a}}function c(c,d,e,f,m,l,n,q,p){g.fromBufferAttribute(m,n);h.fromBufferAttribute(m,q);k.fromBufferAttribute(m,p);if(c=b(c,d,e,f,g,h,k,z))l&&(u.fromBufferAttribute(l,n),t.fromBufferAttribute(l,q),r.fromBufferAttribute(l,p),c.uv=a(z,g,h,k,u,t,r)),l=new Wa(n,q,p),Ba.getNormal(g,h,k,l.normal),c.face=l;return c}var d=new I,e=new qb,f=new za,g=new p,h=new p,k=new p,m=new p,l=new p,n=new p,u=new C,t=new C,r=new C,v=new p,z=new p,x=new p;return function(q,p){var v=this.geometry,w=this.material,x=
this.matrixWorld;if(void 0!==w&&(null===v.boundingSphere&&v.computeBoundingSphere(),f.copy(v.boundingSphere),f.applyMatrix4(x),!1!==q.ray.intersectsSphere(f)&&(d.getInverse(x),e.copy(q.ray).applyMatrix4(d),null===v.boundingBox||!1!==e.intersectsBox(v.boundingBox))))if(v.isBufferGeometry){var y=v.index,A=v.attributes.position,C=v.attributes.uv,E=v.groups;v=v.drawRange;var B;if(null!==y)if(Array.isArray(w)){var F=0;for(B=E.length;F<B;F++){var G=E[F];var K=w[G.materialIndex];x=Math.max(G.start,v.start);
var L=Math.min(G.start+G.count,v.start+v.count);for(G=x;G<L;G+=3){x=y.getX(G);var I=y.getX(G+1);var M=y.getX(G+2);if(x=c(this,K,q,e,A,C,x,I,M))x.faceIndex=Math.floor(G/3),p.push(x)}}}else for(x=Math.max(0,v.start),L=Math.min(y.count,v.start+v.count),F=x,B=L;F<B;F+=3){if(x=y.getX(F),I=y.getX(F+1),M=y.getX(F+2),x=c(this,w,q,e,A,C,x,I,M))x.faceIndex=Math.floor(F/3),p.push(x)}else if(void 0!==A)if(Array.isArray(w))for(F=0,B=E.length;F<B;F++)for(G=E[F],K=w[G.materialIndex],x=Math.max(G.start,v.start),
L=Math.min(G.start+G.count,v.start+v.count),G=x;G<L;G+=3){if(x=G,I=G+1,M=G+2,x=c(this,K,q,e,A,C,x,I,M))x.faceIndex=Math.floor(G/3),p.push(x)}else for(x=Math.max(0,v.start),L=Math.min(A.count,v.start+v.count),F=x,B=L;F<B;F+=3)if(x=F,I=F+1,M=F+2,x=c(this,w,q,e,A,C,x,I,M))x.faceIndex=Math.floor(F/3),p.push(x)}else if(v.isGeometry)for(A=Array.isArray(w),C=v.vertices,E=v.faces,x=v.faceVertexUvs[0],0<x.length&&(y=x),G=0,L=E.length;G<L;G++)if(I=E[G],x=A?w[I.materialIndex]:w,void 0!==x){F=C[I.a];B=C[I.b];
K=C[I.c];if(!0===x.morphTargets){M=v.morphTargets;var P=this.morphTargetInfluences;g.set(0,0,0);h.set(0,0,0);k.set(0,0,0);for(var Q=0,S=M.length;Q<S;Q++){var R=P[Q];if(0!==R){var T=M[Q].vertices;g.addScaledVector(m.subVectors(T[I.a],F),R);h.addScaledVector(l.subVectors(T[I.b],B),R);k.addScaledVector(n.subVectors(T[I.c],K),R)}}g.add(F);h.add(B);k.add(K);F=g;B=h;K=k}if(x=b(this,x,q,e,F,B,K,z))y&&y[G]&&(M=y[G],u.copy(M[0]),t.copy(M[1]),r.copy(M[2]),x.uv=a(z,F,B,K,u,t,r)),x.face=I,x.faceIndex=G,p.push(x)}}}(),
clone:function(){return(new this.constructor(this.geometry,this.material)).copy(this)}});var yf=function(a,b){this._instance=b;this.bind=function(c){"object"===typeof c&&(Object.keys(a).forEach(function(a){if("function"!==typeof c[a])throw Error(typeof c+" must implement "+a);}),this._instance=c);return b};this.resolve=function(){return this._instance}},zf=function(){return{log:function(){},error:function(){},warn:function(){},info:function(){},debug:function(){}}}(),Af=function(){return{debug:function(){return!1},
allowedCachedPrograms:function(){return 50}}}(),Xa={Logger:new yf(zf,zf),Settings:new yf(Af,Af)},zg=function(){return{getWebGLProgramDiagnostics:function(a,b,c,d,e,f,g){var h=Xa.Logger.resolve(),k=a.getProgramInfoLog(b).trim();c=a.getShaderInfoLog(c).trim();d=a.getShaderInfoLog(d).trim();var m=!0,l=!0;if(!1===a.getProgramParameter(b,a.LINK_STATUS))m=!1,h.error("THREE.WebGLProgram: shader error: ",a.getError(),"gl.VALIDATE_STATUS",a.getProgramParameter(b,a.VALIDATE_STATUS),"gl.getProgramInfoLog",k,
c,d);else if(""!==k)h.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",k);else if(""===c||""===d)l=!1;return l?{runnable:m,material:g,programLog:k,vertexShader:{log:c,prefix:e},fragmentShader:{log:d,prefix:f}}:null}}}(),ch=function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?
Object.create(c):(d.prototype=c.prototype,new d)}}(),Md=function(a){function b(b,d,e,f,g,h,k,m,l,n){b=a.call(this,b?b:[],d?d:301,e,f,g,h,k,m,l,n)||this;b._isCubeTexture=!0;b.maxMipLevel=0;b.flipY=!1;return b}ch(b,a);Object.defineProperty(b.prototype,"src",{get:function(){this._src||(this._src=this.images.map(function(a){return a.src}).join(";"));return this._src},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"images",{get:function(){return this.image},set:function(a){this.image=
a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isCubeTexture",{get:function(){return this._isCubeTexture},enumerable:!0,configurable:!0});return b}(ta),Ie=new ta,Je=new Md,Ce=[],Ee=[],He=new Float32Array(16),Ge=new Float32Array(9),Fe=new Float32Array(4);Ne.prototype.updateCache=function(a){var b=this.cache;a instanceof Float32Array&&b.length!==a.length&&(this.cache=new Float32Array(a.length));pa(b,a)};Oe.prototype.setValue=function(a,b,c){for(var d=this.seq,e=0,f=d.length;e!==
f;++e){var g=d[e];g.setValue(a,b[g.id],c)}};var Sd=/([\w\d_]+)(\])?(\[|\.)?/g;cb.prototype.setValue=function(a,b,c){b=this.map[b];void 0!==b&&b.setValue(a,c,this.renderer)};cb.prototype.setOptional=function(a,b,c){b=b[c];void 0!==b&&this.setValue(a,c,b)};cb.upload=function(a,b,c,d){for(var e=0,f=b.length;e!==f;++e){var g=b[e],h=c[g.id];!1!==h.needsUpdate&&g.setValue(a,h.value,d)}};cb.seqWithValue=function(a,b){for(var c=[],d=0,e=a.length;d!==e;++d){var f=a[d];f.id in b&&c.push(f)}return c};var sg=
function(){var a=Xa.Logger.resolve();return{logShaderCompilationInformation:function(b,c,d,e){!1===b.getShaderParameter(c,b.COMPILE_STATUS)&&a.error("THREE.WebGLShader: Shader couldn't compile.");c=b.getShaderInfoLog(c);""!==c&&a.warn("THREE.WebGLShader: gl.getShaderInfoLog()",d===b.VERTEX_SHADER?"vertex":"fragment",c,rg(e))}}}(),Ag=0,Re=Xa.Logger.resolve();Xa.Settings.resolve();var Mg=function(){function a(){this._properties=new WeakMap}a.prototype.dispose=function(){this._properties=new WeakMap};
a.prototype.get=function(a){var b=this._properties.get(a);void 0===b&&(b={},this._properties.set(a,b));return b};a.prototype.remove=function(a){this._properties.delete(a)};a.prototype.update=function(a,c,d){this._properties.get(a)[c]=d};return a}(),Ig=0;db.prototype=Object.create(F.prototype);db.prototype.constructor=db;db.prototype.isMeshDepthMaterial=!0;db.prototype.copy=function(a){F.prototype.copy.call(this,a);this.depthPacking=a.depthPacking;this.skinning=a.skinning;this.morphTargets=a.morphTargets;
this.map=a.map;this.alphaMap=a.alphaMap;this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;return this};eb.prototype=Object.create(F.prototype);eb.prototype.constructor=eb;eb.prototype.isMeshDistanceMaterial=!0;eb.prototype.copy=function(a){F.prototype.copy.call(this,a);this.referencePosition.copy(a.referencePosition);this.nearDistance=a.nearDistance;this.farDistance=
a.farDistance;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.map=a.map;this.alphaMap=a.alphaMap;this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;return this};var Ng=function(){function a(a,c,d,e,f,g,h,k){this._gl=a;this._extensions=c;this._state=d;this._properties=e;this._capabilities=f;this._utils=g;this._info=h;this._webGLCacheFacade=k;this._videoTextures={};this._logger=Xa.Logger.resolve()}a.prototype.setTexture2D=
function(a,c){var b=!a.isCanvasTexture&&this._webGLCacheFacade.textureCache.isInCache(a);a=b?this._webGLCacheFacade.textureCache.get(a):a;var e=this._properties.get(a);a.isVideoTexture&&this.updateVideoTexture(a);if(0<a.version&&!b)if(a.isCanvasTexture||this._webGLCacheFacade.textureCache.cache(a),b=a.image,void 0===b)this._logger.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(!1===b.complete)this._logger.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");
else{this.uploadTexture(e,a,c);return}this._state.activeTexture(this._gl.TEXTURE0+c);this._state.bindTexture(this._gl.TEXTURE_2D,e.__webglTexture)};a.prototype.setTextureCube=function(a,c){var b=this._webGLCacheFacade.textureCache.isInCache(a);a=b?this._webGLCacheFacade.textureCache.get(a):a;var e=this._properties.get(a);if(6===a.images.length)if(0<a.version&&!b){e.__image__webglTextureCube||(e.__image__webglTextureCube=this.createWebGLTexture(a,this.onTextureDispose));this._state.activeTexture(this._gl.TEXTURE0+
c);this._state.bindTexture(this._gl.TEXTURE_CUBE_MAP,e.__image__webglTextureCube);this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,a.flipY);c=a&&a.isCompressedTexture;b=a.image[0]&&a.image[0].isDataTexture;for(var f=[],g=0;6>g;g++)f[g]=c||b?b?a.image[g].image:a.image[g]:this.clampToMaxSize(a.image[g],this._capabilities.maxCubemapSize);var h=f[0],k=this.isPowerOfTwo(h),m=this._utils.convert(a.format),l=this._utils.convert(a.type),n=this.getInternalFormat(m,l);this.setTextureParameters(this._gl.TEXTURE_CUBE_MAP,
a,k);for(g=0;6>g;g++)if(c)for(var u,p=f[g].mipmaps,r=0,v=p.length;r<v;r++)u=p[r],1023!==a.format&&1022!==a.format?-1<this._state.getCompressedTextureFormats().indexOf(m)?this._state.compressedTexImage2D(this._gl.TEXTURE_CUBE_MAP_POSITIVE_X+g,r,n,u.width,u.height,0,u.data):this._logger.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):this._state.texImage2D(this._gl.TEXTURE_CUBE_MAP_POSITIVE_X+g,r,n,u.width,u.height,0,m,l,u.data);else b?this._state.texImage2D(this._gl.TEXTURE_CUBE_MAP_POSITIVE_X+
g,0,n,f[g].width,f[g].height,0,m,l,f[g].data):this._state.texImage2D(this._gl.TEXTURE_CUBE_MAP_POSITIVE_X+g,0,n,m,l,f[g]);e.__maxMipLevel=c?p.length-1:0;this.textureNeedsGenerateMipmaps(a,k)&&this.generateMipmap(this._gl.TEXTURE_CUBE_MAP,a,h.width,h.height);e.__version=a.version;if(a.onUpdate)a.onUpdate(a);this._webGLCacheFacade.textureCache.cache(a)}else this._state.activeTexture(this._gl.TEXTURE0+c),this._state.bindTexture(this._gl.TEXTURE_CUBE_MAP,e.__image__webglTextureCube)};a.prototype.setTextureCubeDynamic=
function(a,c){this._state.activeTexture(this._gl.TEXTURE0+c);this._state.bindTexture(this._gl.TEXTURE_CUBE_MAP,this._properties.get(a).__webglTexture)};a.prototype.setupRenderTarget=function(a){var b=this._properties.get(a),d=this._properties.get(a.texture);d.__webglTexture=this.createWebGLTexture(a,this.onRenderTargetDispose);var e=this.isPowerOfTwo(a);if(a.isWebGLRenderTargetCube){b.__webglFramebuffer=[];for(var f=0;6>f;f++)b.__webglFramebuffer[f]=this._gl.createFramebuffer()}else b.__webglFramebuffer=
this._gl.createFramebuffer();if(a.isWebGLRenderTargetCube){this._state.bindTexture(this._gl.TEXTURE_CUBE_MAP,d.__webglTexture);this.setTextureParameters(this._gl.TEXTURE_CUBE_MAP,a.texture,e);for(f=0;6>f;f++)this.setupFrameBufferTexture(b.__webglFramebuffer[f],a,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_CUBE_MAP_POSITIVE_X+f);this.textureNeedsGenerateMipmaps(a.texture,e)&&this.generateMipmap(this._gl.TEXTURE_CUBE_MAP,a.texture,a.width,a.height);this._state.bindTexture(this._gl.TEXTURE_CUBE_MAP,
null)}else this._state.bindTexture(this._gl.TEXTURE_2D,d.__webglTexture),this.setTextureParameters(this._gl.TEXTURE_2D,a.texture,e),this.setupFrameBufferTexture(b.__webglFramebuffer,a,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D),this.textureNeedsGenerateMipmaps(a.texture,e)&&this.generateMipmap(this._gl.TEXTURE_2D,a.texture,a.width,a.height),this._state.bindTexture(this._gl.TEXTURE_2D,null);a.depthBuffer&&this.setupDepthRenderbuffer(a)};a.prototype.updateRenderTargetMipmap=function(a){var b=a.texture,
d=this.isPowerOfTwo(a);if(this.textureNeedsGenerateMipmaps(b,d)){d=a.isWebGLRenderTargetCube?this._gl.TEXTURE_CUBE_MAP:this._gl.TEXTURE_2D;var e=this._properties.get(b).__webglTexture;this._state.bindTexture(d,e);this.generateMipmap(d,b,a.width,a.height);this._state.bindTexture(d,null)}};a.prototype.clampToMaxSize=function(a,c){if(a.width>c||a.height>c){if("data"in a){this._logger.warn("THREE.WebGLRenderer: image in DataTexture is too big ("+a.width+"x"+a.height+").");return}c/=Math.max(a.width,a.height);
var b=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");b.width=Math.floor(a.width*c);b.height=Math.floor(a.height*c);b.getContext("2d").drawImage(a,0,0,a.width,a.height,0,0,b.width,b.height);this._logger.warn("THREE.WebGLRenderer: image is too big ("+a.width+"x"+a.height+"). Resized to "+b.width+"x"+b.height);return b}return a};a.prototype.createWebGLTexture=function(a,c){a.addEventListener("dispose",c.bind(this));this._info.memory.textures++;return this._gl.createTexture()};a.prototype.deallocateRenderTarget=
function(a){var b=this._properties.get(a),d=this._properties.get(a.texture);if(a){void 0!==d.__webglTexture&&this._gl.deleteTexture(d.__webglTexture);a.depthTexture&&a.depthTexture.dispose();if(a.isWebGLRenderTargetCube)for(d=0;6>d;d++)this._gl.deleteFramebuffer(b.__webglFramebuffer[d]),b.__webglDepthbuffer&&this._gl.deleteRenderbuffer(b.__webglDepthbuffer[d]);else this._gl.deleteFramebuffer(b.__webglFramebuffer),b.__webglDepthbuffer&&this._gl.deleteRenderbuffer(b.__webglDepthbuffer);this._properties.remove(a.texture);
this._properties.remove(a)}};a.prototype.deallocateTexture=function(a){var b=this._properties.get(a);if(a.image&&b.__image__webglTextureCube)this._gl.deleteTexture(b.__image__webglTextureCube);else{if(void 0===b.__webglInit)return;this._gl.deleteTexture(b.__webglTexture)}this._properties.remove(a)};a.prototype.filterFallback=function(a){return 1003===a||1004===a||1005===a?this._gl.NEAREST:this._gl.LINEAR};a.prototype.generateMipmap=function(a,c,d,e){this._gl.generateMipmap(a);this._properties.get(c).__maxMipLevel=
Math.log(Math.max(d,e))*Math.LOG2E};a.prototype.getInternalFormat=function(a,c){if(!this._capabilities.isWebGL2)return a;if(a===this._gl.RGB){if(c===this._gl.FLOAT)return this._gl.RGB32F;if(c===this._gl.HALF_FLOAT)return this._gl.RGB16F;if(c===this._gl.UNSIGNED_BYTE)return this._gl.RGB8}if(a===this._gl.RGBA){if(c===this._gl.FLOAT)return this._gl.RGBA32F;if(c===this._gl.HALF_FLOAT)return this._gl.RGBA16F;if(c===this._gl.UNSIGNED_BYTE)return this._gl.RGBA8}return a};a.prototype.isPowerOfTwo=function(a){return Q.isPowerOfTwo(a.width)&&
Q.isPowerOfTwo(a.height)};a.prototype.makePowerOfTwo=function(a){return a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof ImageBitmap?(void 0===this._canvas&&(this._canvas=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),this._canvas.width=Q.floorPowerOfTwo(a.width),this._canvas.height=Q.floorPowerOfTwo(a.height),this._canvas.getContext("2d").drawImage(a,0,0,this._canvas.width,this._canvas.height),this._logger.warn("THREE.WebGLRenderer: image is not power of two ("+
a.width+"x"+a.height+"). Resized to "+this._canvas.width+"x"+this._canvas.height),this._canvas):a};a.prototype.onRenderTargetDispose=function(a){a=a.target;a.removeEventListener("dispose",this.onRenderTargetDispose.bind(this));this.deallocateRenderTarget(a);this._info.memory.textures--};a.prototype.onTextureDispose=function(a){a=a.target;a.removeEventListener("dispose",this.onTextureDispose.bind(this));this._webGLCacheFacade.textureCache.remove(a);this.deallocateTexture(a);a.isVideoTexture&&delete this._videoTextures[a.id.value];
this._info.memory.textures--};a.prototype.setTextureParameters=function(a,c,d){d?(this._gl.texParameteri(a,this._gl.TEXTURE_WRAP_S,this._utils.convert(c.wrapS)),this._gl.texParameteri(a,this._gl.TEXTURE_WRAP_T,this._utils.convert(c.wrapT)),this._gl.texParameteri(a,this._gl.TEXTURE_MAG_FILTER,this._utils.convert(c.magFilter)),this._gl.texParameteri(a,this._gl.TEXTURE_MIN_FILTER,this._utils.convert(c.minFilter))):(this._gl.texParameteri(a,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(a,
this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),1001===c.wrapS&&1001===c.wrapT||this._logger.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),this._gl.texParameteri(a,this._gl.TEXTURE_MAG_FILTER,this.filterFallback(c.magFilter)),this._gl.texParameteri(a,this._gl.TEXTURE_MIN_FILTER,this.filterFallback(c.minFilter)),1003!==c.minFilter&&1006!==c.minFilter&&this._logger.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));
!(d=this._extensions.get("EXT_texture_filter_anisotropic"))||1015===c.type&&null===this._extensions.get("OES_texture_float_linear")||1016===c.type&&null===(this._capabilities.isWebGL2||this._extensions.get("OES_texture_half_float_linear"))||!(1<c.anisotropy||this._properties.get(c).__currentAnisotropy)||(this._gl.texParameterf(a,d.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(c.anisotropy,this._capabilities.getMaxAnisotropy())),this._properties.get(c).__currentAnisotropy=c.anisotropy)};a.prototype.setupDepthRenderbuffer=
function(a){var b=this._properties.get(a),d=!0===a.isWebGLRenderTargetCube;if(a.depthTexture){if(d)throw Error("target.depthTexture not supported in Cube render targets");this.setupDepthTexture(b.__webglFramebuffer,a)}else if(d)for(b.__webglDepthbuffer=[],d=0;6>d;d++)this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,b.__webglFramebuffer[d]),b.__webglDepthbuffer[d]=this._gl.createRenderbuffer(),this.setupRenderBufferStorage(b.__webglDepthbuffer[d],a);else this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,
b.__webglFramebuffer),b.__webglDepthbuffer=this._gl.createRenderbuffer(),this.setupRenderBufferStorage(b.__webglDepthbuffer,a);this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null)};a.prototype.setupDepthTexture=function(a,c){if(c&&c.isWebGLRenderTargetCube)throw Error("Depth Texture with cube render targets is not supported");this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,a);if(!c.depthTexture||!c.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");
this._properties.get(c.depthTexture).__webglTexture&&c.depthTexture.image.width===c.width&&c.depthTexture.image.height===c.height||(c.depthTexture.image.width=c.width,c.depthTexture.image.height=c.height,c.depthTexture.needsUpdate=!0);this.setTexture2D(c.depthTexture,0);a=this._properties.get(c.depthTexture).__webglTexture;if(1026===c.depthTexture.format)this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,a,0);else if(1027===c.depthTexture.format)this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,
this._gl.DEPTH_STENCIL_ATTACHMENT,this._gl.TEXTURE_2D,a,0);else throw Error("Unknown depthTexture format");};a.prototype.setupFrameBufferTexture=function(a,c,d,e){var b=this._utils.convert(c.texture.format),g=this._utils.convert(c.texture.type),h=this.getInternalFormat(b,g);this._state.texImage2D(e,0,h,c.width,c.height,0,b,g,null);this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,a);this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,d,e,this._properties.get(c.texture).__webglTexture,0);this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,
null)};a.prototype.setupRenderBufferStorage=function(a,c){this._gl.bindRenderbuffer(this._gl.RENDERBUFFER,a);c.depthBuffer&&!c.stencilBuffer?(this._gl.renderbufferStorage(this._gl.RENDERBUFFER,this._gl.DEPTH_COMPONENT16,c.width,c.height),this._gl.framebufferRenderbuffer(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.RENDERBUFFER,a)):c.depthBuffer&&c.stencilBuffer?(this._gl.renderbufferStorage(this._gl.RENDERBUFFER,this._gl.DEPTH_STENCIL,c.width,c.height),this._gl.framebufferRenderbuffer(this._gl.FRAMEBUFFER,
this._gl.DEPTH_STENCIL_ATTACHMENT,this._gl.RENDERBUFFER,a)):this._gl.renderbufferStorage(this._gl.RENDERBUFFER,this._gl.RGBA4,c.width,c.height);this._gl.bindRenderbuffer(this._gl.RENDERBUFFER,null)};a.prototype.textureNeedsGenerateMipmaps=function(a,c){return a.generateMipmaps&&c&&1003!==a.minFilter&&1006!==a.minFilter};a.prototype.textureNeedsPowerOfTwo=function(a){return this._capabilities.isWebGL2?!1:1001!==a.wrapS||1001!==a.wrapT||1003!==a.minFilter&&1006!==a.minFilter};a.prototype.updateVideoTexture=
function(a){var b=a.id.value,d=this._info.render.frame;this._videoTextures[b]!==d&&(this._videoTextures[b]=d,a.update())};a.prototype.uploadTexture=function(a,c,d){void 0===a.__webglInit&&(a.__webglInit=!0,a.__webglTexture=this.createWebGLTexture(c,this.onTextureDispose));this._state.activeTexture(this._gl.TEXTURE0+d);this._state.bindTexture(this._gl.TEXTURE_2D,a.__webglTexture);this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,c.flipY);this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,
c.premultiplyAlpha);this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,c.unpackAlignment);d=this.clampToMaxSize(c.image,this._capabilities.maxTextureSize);this.textureNeedsPowerOfTwo(c)&&!1===this.isPowerOfTwo(d)&&(d=this.makePowerOfTwo(d));var b=this.isPowerOfTwo(d),f=this._utils.convert(c.format),g=this._utils.convert(c.type),h=this.getInternalFormat(f,g);this.setTextureParameters(this._gl.TEXTURE_2D,c,b);var k=c.mipmaps;if(c.isDepthTexture){h=this._gl.DEPTH_COMPONENT;if(1015===c.type){if(!this._capabilities.isWebGL2)throw Error("Float Depth Texture only supported in WebGL2.0");
h=this._gl.DEPTH_COMPONENT32F}else this._capabilities.isWebGL2&&(h=this._gl.DEPTH_COMPONENT16);1026===c.format&&h===this._gl.DEPTH_COMPONENT&&1012!==c.type&&1014!==c.type&&(this._logger.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),c.type=1012,g=this._utils.convert(c.type));1027===c.format&&(h=this._gl.DEPTH_STENCIL,1020!==c.type&&(this._logger.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),c.type=1020,
g=this._utils.convert(c.type)));this._state.texImage2D(this._gl.TEXTURE_2D,0,h,d.width,d.height,0,f,g,null)}else if(c.isDataTexture)if(0<k.length&&b){for(var m=0,l=k.length;m<l;m++){var n=k[m];this._state.texImage2D(this._gl.TEXTURE_2D,m,h,n.width,n.height,0,f,g,n.data)}c.generateMipmaps=!1;a.__maxMipLevel=k.length-1}else this._state.texImage2D(this._gl.TEXTURE_2D,0,h,d.width,d.height,0,f,g,d.data),a.__maxMipLevel=0;else if(c.isCompressedTexture){m=0;for(l=k.length;m<l;m++)n=k[m],1023!==c.format&&
1022!==c.format?-1<this._state.getCompressedTextureFormats().indexOf(f)?this._state.compressedTexImage2D(this._gl.TEXTURE_2D,m,h,n.width,n.height,0,n.data):this._logger.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):this._state.texImage2D(this._gl.TEXTURE_2D,m,h,n.width,n.height,0,f,g,n.data);a.__maxMipLevel=k.length-1}else if(0<k.length&&b){m=0;for(l=k.length;m<l;m++)n=k[m],this._state.texImage2D(this._gl.TEXTURE_2D,m,h,f,g,n);c.generateMipmaps=
!1;a.__maxMipLevel=k.length-1}else this._state.texImage2D(this._gl.TEXTURE_2D,0,h,f,g,d),a.__maxMipLevel=0;this.textureNeedsGenerateMipmaps(c,b)&&this.generateMipmap(this._gl.TEXTURE_2D,c,d.width,d.height);a.__version=c.version;if(c.onUpdate)c.onUpdate(c)};return a}();Mb.prototype=Object.assign(Object.create(B.prototype),{constructor:Mb,isGroup:!0});ea.prototype=Object.assign(Object.create(Qa.prototype),{constructor:ea,isPerspectiveCamera:!0,copy:function(a,b){Qa.prototype.copy.call(this,a,b);this.fov=
a.fov;this.zoom=a.zoom;this.near=a.near;this.far=a.far;this.focus=a.focus;this.aspect=a.aspect;this.view=null===a.view?null:Object.assign({},a.view);this.filmGauge=a.filmGauge;this.filmOffset=a.filmOffset;return this},setFocalLength:function(a){a=.5*this.getFilmHeight()/a;this.fov=2*Q.RAD2DEG*Math.atan(a);this.updateProjectionMatrix()},getFocalLength:function(){var a=Math.tan(.5*Q.DEG2RAD*this.fov);return.5*this.getFilmHeight()/a},getEffectiveFOV:function(){return 2*Q.RAD2DEG*Math.atan(Math.tan(.5*
Q.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(a,b,c,d,e,f){this.aspect=a/b;null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1});this.view.enabled=!0;this.view.fullWidth=a;this.view.fullHeight=b;this.view.offsetX=c;this.view.offsetY=d;this.view.width=e;this.view.height=f;this.updateProjectionMatrix()},
clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1);this.updateProjectionMatrix()},updateProjectionMatrix:function(){var a=this.near,b=a*Math.tan(.5*Q.DEG2RAD*this.fov)/this.zoom,c=2*b,d=this.aspect*c,e=-.5*d,f=this.view;if(null!==this.view&&this.view.enabled){var g=f.fullWidth,h=f.fullHeight;e+=f.offsetX*d/g;b-=f.offsetY*c/h;d*=f.width/g;c*=f.height/h}f=this.filmOffset;0!==f&&(e+=a*f/this.getFilmWidth());this.projectionMatrix.makePerspective(e,e+d,b,b-c,a,this.far)},toJSON:function(a){a=
B.prototype.toJSON.call(this,a);a.object.fov=this.fov;a.object.zoom=this.zoom;a.object.near=this.near;a.object.far=this.far;a.object.focus=this.focus;a.object.aspect=this.aspect;null!==this.view&&(a.object.view=Object.assign({},this.view));a.object.filmGauge=this.filmGauge;a.object.filmOffset=this.filmOffset;return a}});zc.prototype=Object.assign(Object.create(ea.prototype),{constructor:zc,isArrayCamera:!0});var dh=function(){function a(){this._hash={};this._skipConditions=[]}a.prototype.cache=function(a){this._hash[a.cacheKey()]=
a};a.prototype.dispose=function(){for(var a in this._hash)this._hash[a].dispose(),delete this._hash[a]};a.prototype.get=function(a){return this._hash[a.cacheKey()]};a.prototype.isInCache=function(a){return!!this._hash[a.cacheKey()]};a.prototype.remove=function(a){return this.isInCache(a)?(a.cacheKey(),delete this._hash[a.cacheKey()],!0):!1};return a}(),Pg=function(){function a(){this._textureCache=new dh}Object.defineProperty(a.prototype,"textureCache",{get:function(){return this._textureCache},enumerable:!0,
configurable:!0});return a}();Nb.prototype.isFogExp2=!0;Nb.prototype.clone=function(){return new Nb(this.color,this.density)};Nb.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}};Ob.prototype.isFog=!0;Ob.prototype.clone=function(){return new Ob(this.color,this.near,this.far)};Ob.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}};od.prototype=Object.assign(Object.create(B.prototype),{constructor:od,
copy:function(a,b){B.prototype.copy.call(this,a,b);null!==a.background&&(this.background=a.background.clone());null!==a.fog&&(this.fog=a.fog.clone());null!==a.overrideMaterial&&(this.overrideMaterial=a.overrideMaterial.clone());this.autoUpdate=a.autoUpdate;this.matrixAutoUpdate=a.matrixAutoUpdate;return this},toJSON:function(a){var b=B.prototype.toJSON.call(this,a);null!==this.background&&(b.object.background=this.background.toJSON(a));null!==this.fog&&(b.object.fog=this.fog.toJSON());return b}});
Object.defineProperty(sb.prototype,"needsUpdate",{set:function(a){!0===a&&this.version++}});Object.assign(sb.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(a){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==a?a.length/this.stride:0;this.array=a;return this},setDynamic:function(a){this.dynamic=a;return this},copy:function(a){this.array=new a.array.constructor(a.array);this.count=a.count;this.stride=
a.stride;this.dynamic=a.dynamic;return this},copyAt:function(a,b,c){a*=this.stride;c*=b.stride;for(var d=0,e=this.stride;d<e;d++)this.array[a+d]=b.array[c+d];return this},set:function(a,b){void 0===b&&(b=0);this.array.set(a,b);return this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(a){this.onUploadCallback=a;return this}});Object.defineProperties(Ac.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}});Object.assign(Ac.prototype,
{isInterleavedBufferAttribute:!0,setX:function(a,b){this.data.array[a*this.data.stride+this.offset]=b;return this},setY:function(a,b){this.data.array[a*this.data.stride+this.offset+1]=b;return this},setZ:function(a,b){this.data.array[a*this.data.stride+this.offset+2]=b;return this},setW:function(a,b){this.data.array[a*this.data.stride+this.offset+3]=b;return this},getX:function(a){return this.data.array[a*this.data.stride+this.offset]},getY:function(a){return this.data.array[a*this.data.stride+this.offset+
1]},getZ:function(a){return this.data.array[a*this.data.stride+this.offset+2]},getW:function(a){return this.data.array[a*this.data.stride+this.offset+3]},setXY:function(a,b,c){a=a*this.data.stride+this.offset;this.data.array[a+0]=b;this.data.array[a+1]=c;return this},setXYZ:function(a,b,c,d){a=a*this.data.stride+this.offset;this.data.array[a+0]=b;this.data.array[a+1]=c;this.data.array[a+2]=d;return this},setXYZW:function(a,b,c,d,e){a=a*this.data.stride+this.offset;this.data.array[a+0]=b;this.data.array[a+
1]=c;this.data.array[a+2]=d;this.data.array[a+3]=e;return this}});gb.prototype=Object.create(F.prototype);gb.prototype.constructor=gb;gb.prototype.isSpriteMaterial=!0;gb.prototype.copy=function(a){F.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.rotation=a.rotation;return this};var Pb;Bc.prototype=Object.assign(Object.create(B.prototype),{constructor:Bc,isSprite:!0,raycast:function(){function a(a,b,c,d,h,k){e.subVectors(a,c).addScalar(.5).multiply(d);void 0!==h?(f.x=k*e.x-
h*e.y,f.y=h*e.x+k*e.y):f.copy(e);a.copy(b);a.x+=f.x;a.y+=f.y;a.applyMatrix4(g)}var b=new p,c=new p,d=new p,e=new C,f=new C,g=new I,h=new p,k=new p,m=new p;return function(e,f){c.setFromMatrixScale(this.matrixWorld);g.getInverse(this.modelViewMatrix).premultiply(this.matrixWorld);d.setFromMatrixPosition(this.modelViewMatrix);var l=this.material.rotation;if(0!==l){var n=Math.cos(l);var q=Math.sin(l)}l=this.center;a(h.set(-.5,-.5,0),d,l,c,q,n);a(k.set(.5,-.5,0),d,l,c,q,n);a(m.set(.5,.5,0),d,l,c,q,n);
var p=e.ray.intersectTriangle(h,k,m,!1,b);if(null===p&&(a(k.set(-.5,.5,0),d,l,c,q,n),p=e.ray.intersectTriangle(h,m,k,!1,b),null===p))return;q=e.ray.origin.distanceTo(b);q<e.near||q>e.far||f.push({distance:q,point:b.clone(),face:null,object:this})}}(),clone:function(){return(new this.constructor(this.material)).copy(this)},copy:function(a){B.prototype.copy.call(this,a);void 0!==a.center&&this.center.copy(a.center);return this}});Cc.prototype=Object.assign(Object.create(B.prototype),{constructor:Cc,
copy:function(a){B.prototype.copy.call(this,a,!1);a=a.levels;for(var b=0,c=a.length;b<c;b++){var d=a[b];this.addLevel(d.object.clone(),d.distance)}return this},addLevel:function(a,b){void 0===b&&(b=0);b=Math.abs(b);for(var c=this.levels,d=0;d<c.length&&!(b<c[d].distance);d++);c.splice(d,0,{distance:b,object:a});this.add(a)},getObjectForDistance:function(a){for(var b=this.levels,c=1,d=b.length;c<d&&!(a<b[c].distance);c++);return b[c-1].object},raycast:function(){var a=new p;return function(b,c){a.setFromMatrixPosition(this.matrixWorld);
var d=b.ray.origin.distanceTo(a);this.getObjectForDistance(d).raycast(b,c)}}(),update:function(){var a=new p,b=new p;return function(c){var d=this.levels;if(1<d.length){a.setFromMatrixPosition(c.matrixWorld);b.setFromMatrixPosition(this.matrixWorld);c=a.distanceTo(b);d[0].object.visible=!0;for(var e=1,f=d.length;e<f;e++)if(c>=d[e].distance)d[e-1].object.visible=!1,d[e].object.visible=!0;else break;for(;e<f;e++)d[e].object.visible=!1}}}(),toJSON:function(a){a=B.prototype.toJSON.call(this,a);a.object.levels=
[];for(var b=this.levels,c=0,d=b.length;c<d;c++){var e=b[c];a.object.levels.push({object:e.object.uuid,distance:e.distance})}return a}});Object.assign(Dc.prototype,{calculateInverses:function(){this.boneInverses=[];for(var a=0,b=this.bones.length;a<b;a++){var c=new I;this.bones[a]&&c.getInverse(this.bones[a].matrixWorld);this.boneInverses.push(c)}},pose:function(){var a,b;var c=0;for(b=this.bones.length;c<b;c++)(a=this.bones[c])&&a.matrixWorld.getInverse(this.boneInverses[c]);c=0;for(b=this.bones.length;c<
b;c++)if(a=this.bones[c])a.parent&&a.parent.isBone?(a.matrix.getInverse(a.parent.matrixWorld),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale)},update:function(){var a=new I,b=new I;return function(){for(var c=this.bones,d=this.boneInverses,e=this.boneMatrices,f=this.boneTexture,g=0,h=c.length;g<h;g++)a.multiplyMatrices(c[g]?c[g].matrixWorld:b,d[g]),a.toArray(e,16*g);void 0!==f&&(f.needsUpdate=!0)}}(),clone:function(){return new Dc(this.bones,
this.boneInverses)},getBoneByName:function(a){for(var b=0,c=this.bones.length;b<c;b++){var d=this.bones[b];if(d.name===a)return d}}});pd.prototype=Object.assign(Object.create(B.prototype),{constructor:pd,isBone:!0});qd.prototype=Object.assign(Object.create(ra.prototype),{constructor:qd,isSkinnedMesh:!0,initBones:function(){var a=[],b;if(this.geometry&&void 0!==this.geometry.bones){var c=0;for(b=this.geometry.bones.length;c<b;c++){var d=this.geometry.bones[c];var e=new pd;a.push(e);e.name=d.name;e.position.fromArray(d.pos);
e.quaternion.fromArray(d.rotq);void 0!==d.scl&&e.scale.fromArray(d.scl)}c=0;for(b=this.geometry.bones.length;c<b;c++)d=this.geometry.bones[c],-1!==d.parent&&null!==d.parent&&void 0!==a[d.parent]?a[d.parent].add(a[c]):this.add(a[c])}this.updateMatrixWorld(!0);return a},bind:function(a,b){this.skeleton=a;void 0===b&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),b=this.matrixWorld);this.bindMatrix.copy(b);this.bindMatrixInverse.getInverse(b)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var a;
if(this.geometry&&this.geometry.isGeometry)for(a=0;a<this.geometry.skinWeights.length;a++){var b=this.geometry.skinWeights[a];var c=1/b.manhattanLength();Infinity!==c?b.multiplyScalar(c):b.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){b=new ca;var d=this.geometry.attributes.skinWeight;for(a=0;a<d.count;a++)b.x=d.getX(a),b.y=d.getY(a),b.z=d.getZ(a),b.w=d.getW(a),c=1/b.manhattanLength(),Infinity!==c?b.multiplyScalar(c):b.set(1,0,0,0),d.setXYZW(a,b.x,b.y,b.z,b.w)}},updateMatrixWorld:function(a){ra.prototype.updateMatrixWorld.call(this,
a);"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return(new this.constructor(this.geometry,this.material)).copy(this)}});T.prototype=Object.create(F.prototype);T.prototype.constructor=T;T.prototype.isLineBasicMaterial=!0;T.prototype.copy=function(a){F.prototype.copy.call(this,a);this.color.copy(a.color);
this.linewidth=a.linewidth;this.linecap=a.linecap;this.linejoin=a.linejoin;return this};ma.prototype=Object.assign(Object.create(B.prototype),{constructor:ma,isLine:!0,computeLineDistances:function(){var a=new p,b=new p;return function(){var c=this.geometry;if(c.isBufferGeometry)if(null===c.index){for(var d=c.attributes.position,e=[0],f=1,g=d.count;f<g;f++)a.fromBufferAttribute(d,f-1),b.fromBufferAttribute(d,f),e[f]=e[f-1],e[f]+=a.distanceTo(b);c.addAttribute("lineDistance",new A(e,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");
else if(c.isGeometry)for(d=c.vertices,e=c.lineDistances,e[0]=0,f=1,g=d.length;f<g;f++)e[f]=e[f-1],e[f]+=d[f-1].distanceTo(d[f]);return this}}(),raycast:function(){var a=new I,b=new qb,c=new za;return function(d,e){var f=d.linePrecision;f*=f;var g=this.geometry,h=this.matrixWorld;null===g.boundingSphere&&g.computeBoundingSphere();c.copy(g.boundingSphere);c.applyMatrix4(h);if(!1!==d.ray.intersectsSphere(c)){a.getInverse(h);b.copy(d.ray).applyMatrix4(a);var k=new p,m=new p;h=new p;var l=new p,n=this&&
this.isLineSegments?2:1;if(g.isBufferGeometry){var u=g.index,t=g.attributes.position.array;if(null!==u){u=u.array;g=0;for(var r=u.length-1;g<r;g+=n){var v=u[g+1];k.fromArray(t,3*u[g]);m.fromArray(t,3*v);v=b.distanceSqToSegment(k,m,l,h);v>f||(l.applyMatrix4(this.matrixWorld),v=d.ray.origin.distanceTo(l),v<d.near||v>d.far||e.push({distance:v,point:h.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this}))}}else for(g=0,r=t.length/3-1;g<r;g+=n)k.fromArray(t,3*g),m.fromArray(t,
3*g+3),v=b.distanceSqToSegment(k,m,l,h),v>f||(l.applyMatrix4(this.matrixWorld),v=d.ray.origin.distanceTo(l),v<d.near||v>d.far||e.push({distance:v,point:h.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this}))}else if(g.isGeometry)for(k=g.vertices,m=k.length,g=0;g<m-1;g+=n)v=b.distanceSqToSegment(k[g],k[g+1],l,h),v>f||(l.applyMatrix4(this.matrixWorld),v=d.ray.origin.distanceTo(l),v<d.near||v>d.far||e.push({distance:v,point:h.clone().applyMatrix4(this.matrixWorld),index:g,
face:null,faceIndex:null,object:this}))}}}(),clone:function(){return(new this.constructor(this.geometry,this.material)).copy(this)}});W.prototype=Object.assign(Object.create(ma.prototype),{constructor:W,isLineSegments:!0,computeLineDistances:function(){var a=new p,b=new p;return function(){var c=this.geometry;if(c.isBufferGeometry)if(null===c.index){for(var d=c.attributes.position,e=[],f=0,g=d.count;f<g;f+=2)a.fromBufferAttribute(d,f),b.fromBufferAttribute(d,f+1),e[f]=0===f?0:e[f-1],e[f+1]=e[f]+a.distanceTo(b);
c.addAttribute("lineDistance",new A(e,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(c.isGeometry)for(d=c.vertices,e=c.lineDistances,f=0,g=d.length;f<g;f+=2)a.copy(d[f]),b.copy(d[f+1]),e[f]=0===f?0:e[f-1],e[f+1]=e[f]+a.distanceTo(b);return this}}()});rd.prototype=Object.assign(Object.create(ma.prototype),{constructor:rd,isLineLoop:!0});Ha.prototype=Object.create(F.prototype);Ha.prototype.constructor=Ha;Ha.prototype.isPointsMaterial=
!0;Ha.prototype.copy=function(a){F.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.size=a.size;this.sizeAttenuation=a.sizeAttenuation;this.morphTargets=a.morphTargets;return this};Qb.prototype=Object.assign(Object.create(B.prototype),{constructor:Qb,isPoints:!0,raycast:function(){var a=new I,b=new qb,c=new za;return function(d,e){function f(a,c){var f=b.distanceSqToPoint(a);f<l&&(b.closestPointToPoint(a,n),n.applyMatrix4(k),a=d.ray.origin.distanceTo(n),a<d.near||a>d.far||
e.push({distance:a,distanceToRay:Math.sqrt(f),point:n.clone(),index:c,face:null,object:g}))}var g=this,h=this.geometry,k=this.matrixWorld,m=d.params.Points.threshold;null===h.boundingSphere&&h.computeBoundingSphere();c.copy(h.boundingSphere);c.applyMatrix4(k);c.radius+=m;if(!1!==d.ray.intersectsSphere(c)){a.getInverse(k);b.copy(d.ray).applyMatrix4(a);m/=(this.scale.x+this.scale.y+this.scale.z)/3;var l=m*m;m=new p;var n=new p;if(h.isBufferGeometry){var u=h.index;h=h.attributes.position.array;if(null!==
u){var t=u.array;u=0;for(var r=t.length;u<r;u++){var v=t[u];m.fromArray(h,3*v);f(m,v)}}else for(u=0,t=h.length/3;u<t;u++)m.fromArray(h,3*u),f(m,u)}else for(m=h.vertices,u=0,t=m.length;u<t;u++)f(m[u],u)}}}(),clone:function(){return(new this.constructor(this.geometry,this.material)).copy(this)}});Xd.prototype=Object.assign(Object.create(ta.prototype),{constructor:Xd,isVideoTexture:!0,update:function(){var a=this.image;a.readyState>=a.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});Rb.prototype=Object.create(ta.prototype);
Rb.prototype.constructor=Rb;Rb.prototype.isCompressedTexture=!0;var eh=function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),fh=function(a){function b(b,d,e,f,g,h,k,m,l){b=a.call(this,b,d,e,f,g,h,k,m,l)||this;b.needsUpdate=!0;
return b}eh(b,a);Object.defineProperty(b.prototype,"isCanvasTexture",{get:function(){return!0},enumerable:!0,configurable:!0});return b}(ta);Ec.prototype=Object.create(ta.prototype);Ec.prototype.constructor=Ec;Ec.prototype.isDepthTexture=!0;Sb.prototype=Object.create(E.prototype);Sb.prototype.constructor=Sb;Fc.prototype=Object.create(K.prototype);Fc.prototype.constructor=Fc;Tb.prototype=Object.create(E.prototype);Tb.prototype.constructor=Tb;Gc.prototype=Object.create(K.prototype);Gc.prototype.constructor=
Gc;ua.prototype=Object.create(E.prototype);ua.prototype.constructor=ua;Hc.prototype=Object.create(K.prototype);Hc.prototype.constructor=Hc;Ub.prototype=Object.create(ua.prototype);Ub.prototype.constructor=Ub;Ic.prototype=Object.create(K.prototype);Ic.prototype.constructor=Ic;tb.prototype=Object.create(ua.prototype);tb.prototype.constructor=tb;Jc.prototype=Object.create(K.prototype);Jc.prototype.constructor=Jc;Vb.prototype=Object.create(ua.prototype);Vb.prototype.constructor=Vb;Kc.prototype=Object.create(K.prototype);
Kc.prototype.constructor=Kc;Wb.prototype=Object.create(ua.prototype);Wb.prototype.constructor=Wb;Lc.prototype=Object.create(K.prototype);Lc.prototype.constructor=Lc;Xb.prototype=Object.create(E.prototype);Xb.prototype.constructor=Xb;Mc.prototype=Object.create(K.prototype);Mc.prototype.constructor=Mc;Yb.prototype=Object.create(E.prototype);Yb.prototype.constructor=Yb;Nc.prototype=Object.create(K.prototype);Nc.prototype.constructor=Nc;Zb.prototype=Object.create(E.prototype);Zb.prototype.constructor=
Zb;var gh={triangulate:function(a,b,c){c=c||2;var d=b&&b.length,e=d?b[0]*c:a.length,f=Ze(a,0,e,c,!0),g=[];if(!f)return g;var h;if(d){var k=c;d=[];var m;var l=0;for(m=b.length;l<m;l++){var n=b[l]*k;var p=l<m-1?b[l+1]*k:a.length;n=Ze(a,n,p,k,!1);n===n.next&&(n.steiner=!0);d.push(Sg(n))}d.sort(Qg);for(l=0;l<d.length;l++){b=d[l];k=f;if(k=Rg(b,k))b=bf(k,b),Pc(b,b.next);f=Pc(f,f.next)}}if(a.length>80*c){var t=h=a[0];var r=d=a[1];for(k=c;k<e;k+=c)l=a[k],b=a[k+1],l<t&&(t=l),b<r&&(r=b),l>h&&(h=l),b>d&&(d=
b);h=Math.max(h-t,d-r);h=0!==h?1/h:0}Qc(f,g,c,t,r,h);return g}},Ya={area:function(a){for(var b=a.length,c=0,d=b-1,e=0;e<b;d=e++)c+=a[d].x*a[e].y-a[e].x*a[d].y;return.5*c},isClockWise:function(a){return 0>Ya.area(a)},triangulateShape:function(a,b){var c=[],d=[],e=[];cf(a);df(c,a);var f=a.length;b.forEach(cf);for(a=0;a<b.length;a++)d.push(f),f+=b[a].length,df(c,b[a]);b=gh.triangulate(c,d);for(a=0;a<b.length;a+=3)e.push(b.slice(a,a+3));return e}};vb.prototype=Object.create(K.prototype);vb.prototype.constructor=
vb;vb.prototype.toJSON=function(){var a=K.prototype.toJSON.call(this);return ef(this.parameters.shapes,this.parameters.options,a)};Ra.prototype=Object.create(E.prototype);Ra.prototype.constructor=Ra;Ra.prototype.toJSON=function(){var a=E.prototype.toJSON.call(this);return ef(this.parameters.shapes,this.parameters.options,a)};var Tg={generateTopUV:function(a,b,c,d,e){a=b[3*d];d=b[3*d+1];var f=b[3*e];e=b[3*e+1];return[new C(b[3*c],b[3*c+1]),new C(a,d),new C(f,e)]},generateSideWallUV:function(a,b,c,
d,e,f){a=b[3*c];var g=b[3*c+1];c=b[3*c+2];var h=b[3*d],k=b[3*d+1];d=b[3*d+2];var m=b[3*e],l=b[3*e+1];e=b[3*e+2];var n=b[3*f],p=b[3*f+1];b=b[3*f+2];return.01>Math.abs(g-k)?[new C(a,1-c),new C(h,1-d),new C(m,1-e),new C(n,1-b)]:[new C(g,1-c),new C(k,1-d),new C(l,1-e),new C(p,1-b)]}};Sc.prototype=Object.create(K.prototype);Sc.prototype.constructor=Sc;$b.prototype=Object.create(Ra.prototype);$b.prototype.constructor=$b;Tc.prototype=Object.create(K.prototype);Tc.prototype.constructor=Tc;wb.prototype=Object.create(E.prototype);
wb.prototype.constructor=wb;Uc.prototype=Object.create(K.prototype);Uc.prototype.constructor=Uc;ac.prototype=Object.create(E.prototype);ac.prototype.constructor=ac;Vc.prototype=Object.create(K.prototype);Vc.prototype.constructor=Vc;bc.prototype=Object.create(E.prototype);bc.prototype.constructor=bc;xb.prototype=Object.create(K.prototype);xb.prototype.constructor=xb;xb.prototype.toJSON=function(){var a=K.prototype.toJSON.call(this);return ff(this.parameters.shapes,a)};yb.prototype=Object.create(E.prototype);
yb.prototype.constructor=yb;yb.prototype.toJSON=function(){var a=E.prototype.toJSON.call(this);return ff(this.parameters.shapes,a)};cc.prototype=Object.create(E.prototype);cc.prototype.constructor=cc;zb.prototype=Object.create(K.prototype);zb.prototype.constructor=zb;Za.prototype=Object.create(E.prototype);Za.prototype.constructor=Za;Wc.prototype=Object.create(zb.prototype);Wc.prototype.constructor=Wc;Xc.prototype=Object.create(Za.prototype);Xc.prototype.constructor=Xc;Yc.prototype=Object.create(K.prototype);
Yc.prototype.constructor=Yc;dc.prototype=Object.create(E.prototype);dc.prototype.constructor=dc;var ya=Object.freeze({WireframeGeometry:Sb,ParametricGeometry:Fc,ParametricBufferGeometry:Tb,TetrahedronGeometry:Hc,TetrahedronBufferGeometry:Ub,OctahedronGeometry:Ic,OctahedronBufferGeometry:tb,IcosahedronGeometry:Jc,IcosahedronBufferGeometry:Vb,DodecahedronGeometry:Kc,DodecahedronBufferGeometry:Wb,PolyhedronGeometry:Gc,PolyhedronBufferGeometry:ua,TubeGeometry:Lc,TubeBufferGeometry:Xb,TorusKnotGeometry:Mc,
TorusKnotBufferGeometry:Yb,TorusGeometry:Nc,TorusBufferGeometry:Zb,TextGeometry:Sc,TextBufferGeometry:$b,SphereGeometry:Tc,SphereBufferGeometry:wb,RingGeometry:Uc,RingBufferGeometry:ac,PlaneGeometry:wc,PlaneBufferGeometry:pb,LatheGeometry:Vc,LatheBufferGeometry:bc,ShapeGeometry:xb,ShapeBufferGeometry:yb,ExtrudeGeometry:vb,ExtrudeBufferGeometry:Ra,EdgesGeometry:cc,ConeGeometry:Wc,ConeBufferGeometry:Xc,CylinderGeometry:zb,CylinderBufferGeometry:Za,CircleGeometry:Yc,CircleBufferGeometry:dc,BoxGeometry:Kb,
BoxBufferGeometry:ob});Ab.prototype=Object.create(F.prototype);Ab.prototype.constructor=Ab;Ab.prototype.isShadowMaterial=!0;Ab.prototype.copy=function(a){F.prototype.copy.call(this,a);this.color.copy(a.color);return this};ec.prototype=Object.create(Da.prototype);ec.prototype.constructor=ec;ec.prototype.isRawShaderMaterial=!0;Sa.prototype=Object.create(F.prototype);Sa.prototype.constructor=Sa;Sa.prototype.isMeshStandardMaterial=!0;Sa.prototype.copy=function(a){F.prototype.copy.call(this,a);this.defines=
{STANDARD:""};this.color.copy(a.color);this.roughness=a.roughness;this.metalness=a.metalness;this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=
a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.roughnessMap=a.roughnessMap;this.metalnessMap=a.metalnessMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.envMapIntensity=a.envMapIntensity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.skinning=a.skinning;this.morphTargets=a.morphTargets;
this.morphNormals=a.morphNormals;return this};Bb.prototype=Object.create(Sa.prototype);Bb.prototype.constructor=Bb;Bb.prototype.isMeshPhysicalMaterial=!0;Bb.prototype.copy=function(a){Sa.prototype.copy.call(this,a);this.defines={PHYSICAL:""};this.reflectivity=a.reflectivity;this.clearCoat=a.clearCoat;this.clearCoatRoughness=a.clearCoatRoughness;return this};Ia.prototype=Object.create(F.prototype);Ia.prototype.constructor=Ia;Ia.prototype.isMeshPhongMaterial=!0;Ia.prototype.copy=function(a){F.prototype.copy.call(this,
a);this.color.copy(a.color);this.specular.copy(a.specular);this.shininess=a.shininess;this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);this.displacementMap=a.displacementMap;
this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;
return this};Cb.prototype=Object.create(Ia.prototype);Cb.prototype.constructor=Cb;Cb.prototype.isMeshToonMaterial=!0;Cb.prototype.copy=function(a){Ia.prototype.copy.call(this,a);this.gradientMap=a.gradientMap;return this};Db.prototype=Object.create(F.prototype);Db.prototype.constructor=Db;Db.prototype.isMeshNormalMaterial=!0;Db.prototype.copy=function(a){F.prototype.copy.call(this,a);this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalMapType=a.normalMapType;this.normalScale.copy(a.normalScale);
this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;return this};Eb.prototype=Object.create(F.prototype);Eb.prototype.constructor=Eb;Eb.prototype.isMeshLambertMaterial=!0;Eb.prototype.copy=function(a){F.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;
this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissive.copy(a.emissive);this.emissiveMap=a.emissiveMap;this.emissiveIntensity=a.emissiveIntensity;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;
this.wireframeLinejoin=a.wireframeLinejoin;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;return this};Fb.prototype=Object.create(T.prototype);Fb.prototype.constructor=Fb;Fb.prototype.isLineDashedMaterial=!0;Fb.prototype.copy=function(a){T.prototype.copy.call(this,a);this.scale=a.scale;this.dashSize=a.dashSize;this.gapSize=a.gapSize;return this};var hh=Object.freeze({ShadowMaterial:Ab,SpriteMaterial:gb,RawShaderMaterial:ec,ShaderMaterial:Da,PointsMaterial:Ha,
MeshPhysicalMaterial:Bb,MeshStandardMaterial:Sa,MeshPhongMaterial:Ia,MeshToonMaterial:Cb,MeshNormalMaterial:Db,MeshLambertMaterial:Eb,MeshDepthMaterial:db,MeshDistanceMaterial:eb,MeshBasicMaterial:Aa,LineDashedMaterial:Fb,LineBasicMaterial:T,Material:F}),ab=new (function(){function a(){this._files={};this.enabled=!1}a.prototype.add=function(a,c){!1!==this.enabled&&(this._files[a]=c)};a.prototype.clear=function(){this._files={}};a.prototype.get=function(a){if(!1!==this.enabled)return this._files[a]};
a.prototype.remove=function(a){delete this._files[a]};return a}()),ve=function(){function a(a,c,d){void 0===a&&(a=null);void 0===c&&(c=null);void 0===d&&(d=null);this.onLoad=a;this.onProgress=c;this.onError=d;this.isLoading=!1;this.itemsTotal=this.itemsLoaded=0}a.prototype.itemEnd=function(a){this.itemsLoaded++;if("function"===typeof this.onProgress)this.onProgress(a,this.itemsLoaded,this.itemsTotal);if(this.itemsLoaded===this.itemsTotal&&(this.isLoading=!1,"function"===typeof this.onLoad))this.onLoad()};
a.prototype.itemError=function(a){if("function"===typeof this.onError)this.onError(a)};a.prototype.itemStart=function(a){this.itemsTotal++;if(!1===this.isLoading&&"function"===typeof this.onStart)this.onStart(a,this.itemsLoaded,this.itemsTotal)};a.prototype.resolveURL=function(a){return this.urlModifier?this.urlModifier(a):a};a.prototype.setURLModifier=function(a){this.urlModifier=a;return this};return a}(),sa=new ve,bb={};Object.assign(Ja.prototype,{load:function(a,b,c,d){void 0===a&&(a="");void 0!==
this.path&&(a=this.path+a);a=this.manager.resolveURL(a);var e=this,f=ab.get(a);if(void 0!==f)return e.manager.itemStart(a),setTimeout(function(){b&&b(f);e.manager.itemEnd(a)},0),f;if(void 0!==bb[a])bb[a].push({onLoad:b,onProgress:c,onError:d});else{var g=a.match(/^data:(.*?)(;base64)?,(.*)$/);if(g){c=g[1];var h=!!g[2];g=g[3];g=window.decodeURIComponent(g);h&&(g=window.atob(g));try{var k=(this.responseType||"").toLowerCase();switch(k){case "arraybuffer":case "blob":var m=new Uint8Array(g.length);for(h=
0;h<g.length;h++)m[h]=g.charCodeAt(h);var l="blob"===k?new Blob([m.buffer],{type:c}):m.buffer;break;case "document":l=(new DOMParser).parseFromString(g,c);break;case "json":l=JSON.parse(g);break;default:l=g}window.setTimeout(function(){b&&b(l);e.manager.itemEnd(a)},0)}catch(u){window.setTimeout(function(){d&&d(u);e.manager.itemEnd(a);e.manager.itemError(a)},0)}}else{bb[a]=[];bb[a].push({onLoad:b,onProgress:c,onError:d});var n=new XMLHttpRequest;n.open("GET",a,!0);n.addEventListener("load",function(b){var c=
this.response;ab.add(a,c);var d=bb[a];delete bb[a];if(200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var f=0,g=d.length;f<g;f++){var h=d[f];if(h.onLoad)h.onLoad(c)}e.manager.itemEnd(a)}else{f=0;for(g=d.length;f<g;f++)if(h=d[f],h.onError)h.onError(b);e.manager.itemEnd(a);e.manager.itemError(a)}},!1);n.addEventListener("progress",function(b){for(var c=bb[a],d=0,e=c.length;d<e;d++){var f=c[d];if(f.onProgress)f.onProgress(b)}},!1);n.addEventListener("error",
function(b){var c=bb[a];delete bb[a];for(var d=0,f=c.length;d<f;d++){var g=c[d];if(g.onError)g.onError(b)}e.manager.itemEnd(a);e.manager.itemError(a)},!1);void 0!==this.responseType&&(n.responseType=this.responseType);void 0!==this.withCredentials&&(n.withCredentials=this.withCredentials);n.overrideMimeType&&n.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(h in this.requestHeader)n.setRequestHeader(h,this.requestHeader[h]);n.send(null)}e.manager.itemStart(a);return n}},setPath:function(a){this.path=
a;return this},setResponseType:function(a){this.responseType=a;return this},setWithCredentials:function(a){this.withCredentials=a;return this},setMimeType:function(a){this.mimeType=a;return this},setRequestHeader:function(a){this.requestHeader=a;return this}});Object.assign(gf.prototype,{load:function(a,b,c,d){function e(e){k.load(a[e],function(a){a=f._parser(a,!0);g[e]={width:a.width,height:a.height,format:a.format,mipmaps:a.mipmaps};m+=1;6===m&&(1===a.mipmapCount&&(h.minFilter=1006),h.format=a.format,
h.needsUpdate=!0,b&&b(h))},c,d)}var f=this,g=[],h=new Rb;h.image=g;var k=new Ja(this.manager);k.setPath(this.path);k.setResponseType("arraybuffer");if(Array.isArray(a))for(var m=0,l=0,n=a.length;l<n;++l)e(l);else k.load(a,function(a){a=f._parser(a,!0);if(a.isCubemap)for(var c=a.mipmaps.length/a.mipmapCount,d=0;d<c;d++){g[d]={mipmaps:[]};for(var e=0;e<a.mipmapCount;e++)g[d].mipmaps.push(a.mipmaps[d*a.mipmapCount+e]),g[d].format=a.format,g[d].width=a.width,g[d].height=a.height}else h.image.width=a.width,
h.image.height=a.height,h.mipmaps=a.mipmaps;1===a.mipmapCount&&(h.minFilter=1006);h.format=a.format;h.needsUpdate=!0;b&&b(h)},c,d);return h},setPath:function(a){this.path=a;return this}});Object.assign($d.prototype,{load:function(a,b,c,d){var e=this,f=new kb,g=new Ja(this.manager);g.setResponseType("arraybuffer");g.load(a,function(a){if(a=e._parser(a))void 0!==a.image?f.image=a.image:void 0!==a.data&&(f.image.width=a.width,f.image.height=a.height,f.image.data=a.data),f.wrapS=void 0!==a.wrapS?a.wrapS:
1001,f.wrapT=void 0!==a.wrapT?a.wrapT:1001,f.magFilter=void 0!==a.magFilter?a.magFilter:1006,f.minFilter=void 0!==a.minFilter?a.minFilter:1008,f.anisotropy=void 0!==a.anisotropy?a.anisotropy:1,void 0!==a.format&&(f.format=a.format),void 0!==a.type&&(f.type=a.type),void 0!==a.mipmaps&&(f.mipmaps=a.mipmaps),1===a.mipmapCount&&(f.minFilter=1006),f.needsUpdate=!0,b&&b(f,a)},c,d);return f}});var ih=function(a,b,c,d){return new (c||(c=Promise))(function(e,f){function g(a){try{k(d.next(a))}catch(q){f(q)}}
function h(a){try{k(d["throw"](a))}catch(q){f(q)}}function k(a){a.done?e(a.value):(new c(function(b){b(a.value)})).then(g,h)}k((d=d.apply(a,b||[])).next())})},jh=function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(f)throw new TypeError("Generator is already executing.");for(;e;)try{if(f=1,g&&(h=c[0]&2?g["return"]:c[0]?g["throw"]||((h=g["return"])&&h.call(g),0):g.next)&&!(h=h.call(g,c[1])).done)return h;if(g=0,h)c=[c[0]&2,h.value];switch(c[0]){case 0:case 1:h=c;break;case 4:return e.label++,
{value:c[1],done:!1};case 5:e.label++;g=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(h=e.trys,h=0<h.length&&h[h.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!h||c[1]>h[0]&&c[1]<h[3]))e.label=c[1];else if(6===c[0]&&e.label<h[1])e.label=h[1],h=c;else if(h&&e.label<h[2])e.label=h[2],e.ops.push(c);else{h[2]&&e.ops.pop();e.trys.pop();continue}}c=b.call(a,e)}catch(q){c=[6,q],g=0}finally{f=h=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e=
{label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},f,g,h,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k},Nd=function(){function a(a){this._crossOrigin="anonymous";this._manager=a?a:sa}Object.defineProperty(a.prototype,"manager",{get:function(){return this._manager},enumerable:!0,configurable:!0});a.prototype.load=function(a,c,d,e){var b=this;void 0===a&&(a="");void 0!==this._path&&(a=this._path+a);
a=this._manager.resolveURL(a);d=ab.get(a);if(void 0!==d){this._manager.itemStart(a);e=d[0];var g=d[1];!0===d[2]?(c&&c(e),b._manager.itemEnd(a)):g.then(function(d){c&&c(d);b._manager.itemEnd(a)});return e}d=document.createElementNS("http://www.w3.org/1999/xhtml","img");e=[d,this.loadImage(d,a,c,e),!1];ab.add(a,e);return d};a.prototype.setCrossOrigin=function(a){this._crossOrigin=a;return this};a.prototype.setPath=function(a){this._path=a;return this};a.prototype.loadImage=function(a,c,d,e){return ih(this,
void 0,void 0,function(){var b=this;return jh(this,function(f){return[2,new Promise(function(f,g){var h=function(){a.removeEventListener("load",h,!1);a.removeEventListener("error",k,!1);ab.get(c)[2]=!0;d&&d(a);b._manager.itemEnd(c);f(a)},k=function(d){a.removeEventListener("load",h,!1);a.removeEventListener("error",k,!1);ab.remove(c);e&&e(d);b._manager.itemEnd(c);b._manager.itemError(c);g(d)};a.addEventListener("load",h,!1);a.addEventListener("error",k,!1);"data:"!==c.substr(0,5)&&void 0!==b._crossOrigin&&
(a.crossOrigin=b._crossOrigin);b._manager.itemStart(c);a.src=c;return a})]})})};return a}(),Bf=function(){function a(a){this._crossOrigin="anonymous";this._manager=a?a:sa;this._imageLoader=new Nd(this._manager)}Object.defineProperty(a.prototype,"crossOrigin",{get:function(){return this._crossOrigin},enumerable:!0,configurable:!0});a.prototype.load=function(a,c,d,e){var b=this,g=new Md;this._imageLoader.setCrossOrigin(this.crossOrigin);this._imageLoader.setPath(this._path);var h=0;d=function(d){b._imageLoader.load(a[d],
function(a){g.images[d]=a;h++;6===h&&(g.needsUpdate=!0,c&&c(g))},void 0,e)};for(var k=0;k<a.length;++k)d(k);return g};a.prototype.setCrossOrigin=function(a){this._crossOrigin=a;return this};a.prototype.setPath=function(a){this._path=a;return this};return a}();Object.assign(td.prototype,{crossOrigin:"anonymous",load:function(a,b,c,d){var e=new ta,f=new Nd(this.manager);f.setCrossOrigin(this.crossOrigin);f.setPath(this.path);f.load(a,function(c){e.image=c;c=0<a.search(/\.(jpg|jpeg)$/)||0===a.search(/^data:image\/jpeg/);
e.format=c?1022:1023;e.needsUpdate=!0;void 0!==b&&b(e)},c,d);return e},setCrossOrigin:function(a){this.crossOrigin=a;return this},setPath:function(a){this.path=a;return this}});Object.assign(L.prototype,{getPoint:function(){console.warn("THREE.Curve: .getPoint() not implemented.");return null},getPointAt:function(a,b){a=this.getUtoTmapping(a);return this.getPoint(a,b)},getPoints:function(a){void 0===a&&(a=5);for(var b=[],c=0;c<=a;c++)b.push(this.getPoint(c/a));return b},getSpacedPoints:function(a){void 0===
a&&(a=5);for(var b=[],c=0;c<=a;c++)b.push(this.getPointAt(c/a));return b},getLength:function(){var a=this.getLengths();return a[a.length-1]},getLengths:function(a){void 0===a&&(a=this.arcLengthDivisions);if(this.cacheArcLengths&&this.cacheArcLengths.length===a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var b=[],c=this.getPoint(0),d,e=0;b.push(0);for(d=1;d<=a;d++){var f=this.getPoint(d/a);e+=f.distanceTo(c);b.push(e);c=f}return this.cacheArcLengths=b},updateArcLengths:function(){this.needsUpdate=
!0;this.getLengths()},getUtoTmapping:function(a,b){var c=this.getLengths(),d=c.length;b=b?b:a*c[d-1];for(var e=0,f=d-1,g;e<=f;)if(a=Math.floor(e+(f-e)/2),g=c[a]-b,0>g)e=a+1;else if(0<g)f=a-1;else{f=a;break}a=f;if(c[a]===b)return a/(d-1);e=c[a];return(a+(b-e)/(c[a+1]-e))/(d-1)},getTangent:function(a){var b=a-1E-4;a+=1E-4;0>b&&(b=0);1<a&&(a=1);b=this.getPoint(b);return this.getPoint(a).clone().sub(b).normalize()},getTangentAt:function(a){a=this.getUtoTmapping(a);return this.getTangent(a)},computeFrenetFrames:function(a,
b){var c=new p,d=[],e=[],f=[],g=new p,h=new I,k;for(k=0;k<=a;k++){var m=k/a;d[k]=this.getTangentAt(m);d[k].normalize()}e[0]=new p;f[0]=new p;k=Number.MAX_VALUE;m=Math.abs(d[0].x);var l=Math.abs(d[0].y),n=Math.abs(d[0].z);m<=k&&(k=m,c.set(1,0,0));l<=k&&(k=l,c.set(0,1,0));n<=k&&c.set(0,0,1);g.crossVectors(d[0],c).normalize();e[0].crossVectors(d[0],g);f[0].crossVectors(d[0],e[0]);for(k=1;k<=a;k++)e[k]=e[k-1].clone(),f[k]=f[k-1].clone(),g.crossVectors(d[k-1],d[k]),g.length()>Number.EPSILON&&(g.normalize(),
c=Math.acos(Q.clamp(d[k-1].dot(d[k]),-1,1)),e[k].applyMatrix4(h.makeRotationAxis(g,c))),f[k].crossVectors(d[k],e[k]);if(!0===b)for(c=Math.acos(Q.clamp(e[0].dot(e[a]),-1,1)),c/=a,0<d[0].dot(g.crossVectors(e[0],e[a]))&&(c=-c),k=1;k<=a;k++)e[k].applyMatrix4(h.makeRotationAxis(d[k],c*k)),f[k].crossVectors(d[k],e[k]);return{tangents:d,normals:e,binormals:f}},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.arcLengthDivisions=a.arcLengthDivisions;return this},toJSON:function(){var a=
{metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};a.arcLengthDivisions=this.arcLengthDivisions;a.type=this.type;return a},fromJSON:function(a){this.arcLengthDivisions=a.arcLengthDivisions;return this}});ka.prototype=Object.create(L.prototype);ka.prototype.constructor=ka;ka.prototype.isEllipseCurve=!0;ka.prototype.getPoint=function(a,b){b=b||new C;for(var c=2*Math.PI,d=this.aEndAngle-this.aStartAngle,e=Math.abs(d)<Number.EPSILON;0>d;)d+=c;for(;d>c;)d-=c;d<Number.EPSILON&&(d=e?0:c);!0!==
this.aClockwise||e||(d=d===c?-c:d-c);c=this.aStartAngle+a*d;a=this.aX+this.xRadius*Math.cos(c);var f=this.aY+this.yRadius*Math.sin(c);0!==this.aRotation&&(c=Math.cos(this.aRotation),d=Math.sin(this.aRotation),e=a-this.aX,f-=this.aY,a=e*c-f*d+this.aX,f=e*d+f*c+this.aY);return b.set(a,f)};ka.prototype.copy=function(a){L.prototype.copy.call(this,a);this.aX=a.aX;this.aY=a.aY;this.xRadius=a.xRadius;this.yRadius=a.yRadius;this.aStartAngle=a.aStartAngle;this.aEndAngle=a.aEndAngle;this.aClockwise=a.aClockwise;
this.aRotation=a.aRotation;return this};ka.prototype.toJSON=function(){var a=L.prototype.toJSON.call(this);a.aX=this.aX;a.aY=this.aY;a.xRadius=this.xRadius;a.yRadius=this.yRadius;a.aStartAngle=this.aStartAngle;a.aEndAngle=this.aEndAngle;a.aClockwise=this.aClockwise;a.aRotation=this.aRotation;return a};ka.prototype.fromJSON=function(a){L.prototype.fromJSON.call(this,a);this.aX=a.aX;this.aY=a.aY;this.xRadius=a.xRadius;this.yRadius=a.yRadius;this.aStartAngle=a.aStartAngle;this.aEndAngle=a.aEndAngle;
this.aClockwise=a.aClockwise;this.aRotation=a.aRotation;return this};fc.prototype=Object.create(ka.prototype);fc.prototype.constructor=fc;fc.prototype.isArcCurve=!0;var Od=new p,we=new ae,xe=new ae,ye=new ae;wa.prototype=Object.create(L.prototype);wa.prototype.constructor=wa;wa.prototype.isCatmullRomCurve3=!0;wa.prototype.getPoint=function(a,b){b=b||new p;var c=this.points,d=c.length;a*=d-(this.closed?0:1);var e=Math.floor(a);a-=e;this.closed?e+=0<e?0:(Math.floor(Math.abs(e)/d)+1)*d:0===a&&e===d-
1&&(e=d-2,a=1);if(this.closed||0<e)var f=c[(e-1)%d];else Od.subVectors(c[0],c[1]).add(c[0]),f=Od;var g=c[e%d];var h=c[(e+1)%d];this.closed||e+2<d?c=c[(e+2)%d]:(Od.subVectors(c[d-1],c[d-2]).add(c[d-1]),c=Od);if("centripetal"===this.curveType||"chordal"===this.curveType){var k="chordal"===this.curveType?.5:.25;d=Math.pow(f.distanceToSquared(g),k);e=Math.pow(g.distanceToSquared(h),k);k=Math.pow(h.distanceToSquared(c),k);1E-4>e&&(e=1);1E-4>d&&(d=e);1E-4>k&&(k=e);we.initNonuniformCatmullRom(f.x,g.x,h.x,
c.x,d,e,k);xe.initNonuniformCatmullRom(f.y,g.y,h.y,c.y,d,e,k);ye.initNonuniformCatmullRom(f.z,g.z,h.z,c.z,d,e,k)}else"catmullrom"===this.curveType&&(we.initCatmullRom(f.x,g.x,h.x,c.x,this.tension),xe.initCatmullRom(f.y,g.y,h.y,c.y,this.tension),ye.initCatmullRom(f.z,g.z,h.z,c.z,this.tension));b.set(we.calc(a),xe.calc(a),ye.calc(a));return b};wa.prototype.copy=function(a){L.prototype.copy.call(this,a);this.points=[];for(var b=0,c=a.points.length;b<c;b++)this.points.push(a.points[b].clone());this.closed=
a.closed;this.curveType=a.curveType;this.tension=a.tension;return this};wa.prototype.toJSON=function(){var a=L.prototype.toJSON.call(this);a.points=[];for(var b=0,c=this.points.length;b<c;b++)a.points.push(this.points[b].toArray());a.closed=this.closed;a.curveType=this.curveType;a.tension=this.tension;return a};wa.prototype.fromJSON=function(a){L.prototype.fromJSON.call(this,a);this.points=[];for(var b=0,c=a.points.length;b<c;b++){var d=a.points[b];this.points.push((new p).fromArray(d))}this.closed=
a.closed;this.curveType=a.curveType;this.tension=a.tension;return this};Ka.prototype=Object.create(L.prototype);Ka.prototype.constructor=Ka;Ka.prototype.isCubicBezierCurve=!0;Ka.prototype.getPoint=function(a,b){b=b||new C;var c=this.v0,d=this.v1,e=this.v2,f=this.v3;b.set($c(a,c.x,d.x,e.x,f.x),$c(a,c.y,d.y,e.y,f.y));return b};Ka.prototype.copy=function(a){L.prototype.copy.call(this,a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);this.v3.copy(a.v3);return this};Ka.prototype.toJSON=function(){var a=
L.prototype.toJSON.call(this);a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();a.v3=this.v3.toArray();return a};Ka.prototype.fromJSON=function(a){L.prototype.fromJSON.call(this,a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);this.v3.fromArray(a.v3);return this};Ta.prototype=Object.create(L.prototype);Ta.prototype.constructor=Ta;Ta.prototype.isCubicBezierCurve3=!0;Ta.prototype.getPoint=function(a,b){b=b||new p;var c=this.v0,d=this.v1,e=this.v2,f=this.v3;
b.set($c(a,c.x,d.x,e.x,f.x),$c(a,c.y,d.y,e.y,f.y),$c(a,c.z,d.z,e.z,f.z));return b};Ta.prototype.copy=function(a){L.prototype.copy.call(this,a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);this.v3.copy(a.v3);return this};Ta.prototype.toJSON=function(){var a=L.prototype.toJSON.call(this);a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();a.v3=this.v3.toArray();return a};Ta.prototype.fromJSON=function(a){L.prototype.fromJSON.call(this,a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);
this.v2.fromArray(a.v2);this.v3.fromArray(a.v3);return this};na.prototype=Object.create(L.prototype);na.prototype.constructor=na;na.prototype.isLineCurve=!0;na.prototype.getPoint=function(a,b){b=b||new C;1===a?b.copy(this.v2):(b.copy(this.v2).sub(this.v1),b.multiplyScalar(a).add(this.v1));return b};na.prototype.getPointAt=function(a,b){return this.getPoint(a,b)};na.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()};na.prototype.copy=function(a){L.prototype.copy.call(this,
a);this.v1.copy(a.v1);this.v2.copy(a.v2);return this};na.prototype.toJSON=function(){var a=L.prototype.toJSON.call(this);a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a};na.prototype.fromJSON=function(a){L.prototype.fromJSON.call(this,a);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this};La.prototype=Object.create(L.prototype);La.prototype.constructor=La;La.prototype.isLineCurve3=!0;La.prototype.getPoint=function(a,b){b=b||new p;1===a?b.copy(this.v2):(b.copy(this.v2).sub(this.v1),
b.multiplyScalar(a).add(this.v1));return b};La.prototype.getPointAt=function(a,b){return this.getPoint(a,b)};La.prototype.copy=function(a){L.prototype.copy.call(this,a);this.v1.copy(a.v1);this.v2.copy(a.v2);return this};La.prototype.toJSON=function(){var a=L.prototype.toJSON.call(this);a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a};La.prototype.fromJSON=function(a){L.prototype.fromJSON.call(this,a);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this};Ma.prototype=Object.create(L.prototype);
Ma.prototype.constructor=Ma;Ma.prototype.isQuadraticBezierCurve=!0;Ma.prototype.getPoint=function(a,b){b=b||new C;var c=this.v0,d=this.v1,e=this.v2;b.set(Zc(a,c.x,d.x,e.x),Zc(a,c.y,d.y,e.y));return b};Ma.prototype.copy=function(a){L.prototype.copy.call(this,a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);return this};Ma.prototype.toJSON=function(){var a=L.prototype.toJSON.call(this);a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a};Ma.prototype.fromJSON=function(a){L.prototype.fromJSON.call(this,
a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this};Ua.prototype=Object.create(L.prototype);Ua.prototype.constructor=Ua;Ua.prototype.isQuadraticBezierCurve3=!0;Ua.prototype.getPoint=function(a,b){b=b||new p;var c=this.v0,d=this.v1,e=this.v2;b.set(Zc(a,c.x,d.x,e.x),Zc(a,c.y,d.y,e.y),Zc(a,c.z,d.z,e.z));return b};Ua.prototype.copy=function(a){L.prototype.copy.call(this,a);this.v0.copy(a.v0);this.v1.copy(a.v1);this.v2.copy(a.v2);return this};Ua.prototype.toJSON=function(){var a=
L.prototype.toJSON.call(this);a.v0=this.v0.toArray();a.v1=this.v1.toArray();a.v2=this.v2.toArray();return a};Ua.prototype.fromJSON=function(a){L.prototype.fromJSON.call(this,a);this.v0.fromArray(a.v0);this.v1.fromArray(a.v1);this.v2.fromArray(a.v2);return this};Na.prototype=Object.create(L.prototype);Na.prototype.constructor=Na;Na.prototype.isSplineCurve=!0;Na.prototype.getPoint=function(a,b){b=b||new C;var c=this.points,d=(c.length-1)*a;a=Math.floor(d);d-=a;var e=c[0===a?a:a-1],f=c[a],g=c[a>c.length-
2?c.length-1:a+1];c=c[a>c.length-3?c.length-1:a+2];b.set(hf(d,e.x,f.x,g.x,c.x),hf(d,e.y,f.y,g.y,c.y));return b};Na.prototype.copy=function(a){L.prototype.copy.call(this,a);this.points=[];for(var b=0,c=a.points.length;b<c;b++)this.points.push(a.points[b].clone());return this};Na.prototype.toJSON=function(){var a=L.prototype.toJSON.call(this);a.points=[];for(var b=0,c=this.points.length;b<c;b++)a.points.push(this.points[b].toArray());return a};Na.prototype.fromJSON=function(a){L.prototype.fromJSON.call(this,
a);this.points=[];for(var b=0,c=a.points.length;b<c;b++){var d=a.points[b];this.points.push((new C).fromArray(d))}return this};var Cf=Object.freeze({ArcCurve:fc,CatmullRomCurve3:wa,CubicBezierCurve:Ka,CubicBezierCurve3:Ta,EllipseCurve:ka,LineCurve:na,LineCurve3:La,QuadraticBezierCurve:Ma,QuadraticBezierCurve3:Ua,SplineCurve:Na});$a.prototype=Object.assign(Object.create(L.prototype),{constructor:$a,add:function(a){this.curves.push(a)},closePath:function(){var a=this.curves[0].getPoint(0),b=this.curves[this.curves.length-
1].getPoint(1);a.equals(b)||this.curves.push(new na(b,a))},getPoint:function(a){var b=a*this.getLength(),c=this.getCurveLengths();for(a=0;a<c.length;){if(c[a]>=b)return b=c[a]-b,a=this.curves[a],c=a.getLength(),a.getPointAt(0===c?0:1-b/c);a++}return null},getLength:function(){var a=this.getCurveLengths();return a[a.length-1]},updateArcLengths:function(){this.needsUpdate=!0;this.cacheLengths=null;this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;
for(var a=[],b=0,c=0,d=this.curves.length;c<d;c++)b+=this.curves[c].getLength(),a.push(b);return this.cacheLengths=a},getSpacedPoints:function(a){void 0===a&&(a=40);for(var b=[],c=0;c<=a;c++)b.push(this.getPoint(c/a));this.autoClose&&b.push(b[0]);return b},getPoints:function(a){a=a||12;for(var b=[],c,d=0,e=this.curves;d<e.length;d++){var f=e[d];f=f.getPoints(f&&f.isEllipseCurve?2*a:f&&(f.isLineCurve||f.isLineCurve3)?1:f&&f.isSplineCurve?a*f.points.length:a);for(var g=0;g<f.length;g++){var h=f[g];
c&&c.equals(h)||(b.push(h),c=h)}}this.autoClose&&1<b.length&&!b[b.length-1].equals(b[0])&&b.push(b[0]);return b},copy:function(a){L.prototype.copy.call(this,a);this.curves=[];for(var b=0,c=a.curves.length;b<c;b++)this.curves.push(a.curves[b].clone());this.autoClose=a.autoClose;return this},toJSON:function(){var a=L.prototype.toJSON.call(this);a.autoClose=this.autoClose;a.curves=[];for(var b=0,c=this.curves.length;b<c;b++)a.curves.push(this.curves[b].toJSON());return a},fromJSON:function(a){L.prototype.fromJSON.call(this,
a);this.autoClose=a.autoClose;this.curves=[];for(var b=0,c=a.curves.length;b<c;b++){var d=a.curves[b];this.curves.push((new Cf[d.type]).fromJSON(d))}return this}});Oa.prototype=Object.assign(Object.create($a.prototype),{constructor:Oa,setFromPoints:function(a){this.moveTo(a[0].x,a[0].y);for(var b=1,c=a.length;b<c;b++)this.lineTo(a[b].x,a[b].y)},moveTo:function(a,b){this.currentPoint.set(a,b)},lineTo:function(a,b){var c=new na(this.currentPoint.clone(),new C(a,b));this.curves.push(c);this.currentPoint.set(a,
b)},quadraticCurveTo:function(a,b,c,d){a=new Ma(this.currentPoint.clone(),new C(a,b),new C(c,d));this.curves.push(a);this.currentPoint.set(c,d)},bezierCurveTo:function(a,b,c,d,e,f){a=new Ka(this.currentPoint.clone(),new C(a,b),new C(c,d),new C(e,f));this.curves.push(a);this.currentPoint.set(e,f)},splineThru:function(a){var b=[this.currentPoint.clone()].concat(a);b=new Na(b);this.curves.push(b);this.currentPoint.copy(a[a.length-1])},arc:function(a,b,c,d,e,f){this.absarc(a+this.currentPoint.x,b+this.currentPoint.y,
c,d,e,f)},absarc:function(a,b,c,d,e,f){this.absellipse(a,b,c,c,d,e,f)},ellipse:function(a,b,c,d,e,f,g,h){this.absellipse(a+this.currentPoint.x,b+this.currentPoint.y,c,d,e,f,g,h)},absellipse:function(a,b,c,d,e,f,g,h){a=new ka(a,b,c,d,e,f,g,h);0<this.curves.length&&(b=a.getPoint(0),b.equals(this.currentPoint)||this.lineTo(b.x,b.y));this.curves.push(a);a=a.getPoint(1);this.currentPoint.copy(a)},copy:function(a){$a.prototype.copy.call(this,a);this.currentPoint.copy(a.currentPoint);return this},toJSON:function(){var a=
$a.prototype.toJSON.call(this);a.currentPoint=this.currentPoint.toArray();return a},fromJSON:function(a){$a.prototype.fromJSON.call(this,a);this.currentPoint.fromArray(a.currentPoint);return this}});hb.prototype=Object.assign(Object.create(Oa.prototype),{constructor:hb,getPointsHoles:function(a){for(var b=[],c=0,d=this.holes.length;c<d;c++)b[c]=this.holes[c].getPoints(a);return b},extractPoints:function(a){return{shape:this.getPoints(a),holes:this.getPointsHoles(a)}},copy:function(a){Oa.prototype.copy.call(this,
a);this.holes=[];for(var b=0,c=a.holes.length;b<c;b++)this.holes.push(a.holes[b].clone());return this},toJSON:function(){var a=Oa.prototype.toJSON.call(this);a.uuid=this.uuid;a.holes=[];for(var b=0,c=this.holes.length;b<c;b++)a.holes.push(this.holes[b].toJSON());return a},fromJSON:function(a){Oa.prototype.fromJSON.call(this,a);this.uuid=a.uuid;this.holes=[];for(var b=0,c=a.holes.length;b<c;b++){var d=a.holes[b];this.holes.push((new Oa).fromJSON(d))}return this}});X.prototype=Object.assign(Object.create(B.prototype),
{constructor:X,isLight:!0,copy:function(a){B.prototype.copy.call(this,a);this.color.copy(a.color);this.intensity=a.intensity;return this},toJSON:function(a){a=B.prototype.toJSON.call(this,a);a.object.color=this.color.getHex();a.object.intensity=this.intensity;void 0!==this.groundColor&&(a.object.groundColor=this.groundColor.getHex());void 0!==this.distance&&(a.object.distance=this.distance);void 0!==this.angle&&(a.object.angle=this.angle);void 0!==this.decay&&(a.object.decay=this.decay);void 0!==
this.penumbra&&(a.object.penumbra=this.penumbra);void 0!==this.shadow&&(a.object.shadow=this.shadow.toJSON());return a}});ud.prototype=Object.assign(Object.create(X.prototype),{constructor:ud,isHemisphereLight:!0,copy:function(a){X.prototype.copy.call(this,a);this.groundColor.copy(a.groundColor);return this}});Object.assign(Gb.prototype,{copy:function(a){this.camera=a.camera.clone();this.bias=a.bias;this.radius=a.radius;this.mapSize.copy(a.mapSize);return this},clone:function(){return(new this.constructor).copy(this)},
toJSON:function(){var a={};0!==this.bias&&(a.bias=this.bias);1!==this.radius&&(a.radius=this.radius);if(512!==this.mapSize.x||512!==this.mapSize.y)a.mapSize=this.mapSize.toArray();a.camera=this.camera.toJSON(!1).object;delete a.camera.matrix;return a}});vd.prototype=Object.assign(Object.create(Gb.prototype),{constructor:vd,isSpotLightShadow:!0,update:function(a){var b=this.camera,c=2*Q.RAD2DEG*a.angle,d=this.mapSize.width/this.mapSize.height;a=a.distance||b.far;if(c!==b.fov||d!==b.aspect||a!==b.far)b.fov=
c,b.aspect=d,b.far=a,b.updateProjectionMatrix()}});wd.prototype=Object.assign(Object.create(X.prototype),{constructor:wd,isSpotLight:!0,copy:function(a){X.prototype.copy.call(this,a);this.distance=a.distance;this.angle=a.angle;this.penumbra=a.penumbra;this.decay=a.decay;this.target=a.target.clone();this.shadow=a.shadow.clone();return this}});xd.prototype=Object.assign(Object.create(X.prototype),{constructor:xd,isPointLight:!0,copy:function(a){X.prototype.copy.call(this,a);this.distance=a.distance;
this.decay=a.decay;this.shadow=a.shadow.clone();return this}});yd.prototype=Object.assign(Object.create(Gb.prototype),{constructor:yd});zd.prototype=Object.assign(Object.create(X.prototype),{constructor:zd,isDirectionalLight:!0,copy:function(a){X.prototype.copy.call(this,a);this.target=a.target.clone();this.shadow=a.shadow.clone();return this}});Ad.prototype=Object.assign(Object.create(X.prototype),{constructor:Ad,isAmbientLight:!0});Bd.prototype=Object.assign(Object.create(X.prototype),{constructor:Bd,
isRectAreaLight:!0,copy:function(a){X.prototype.copy.call(this,a);this.width=a.width;this.height=a.height;return this},toJSON:function(a){a=X.prototype.toJSON.call(this,a);a.object.width=this.width;a.object.height=this.height;return a}});var ha={arraySlice:function(a,b,c){return ha.isTypedArray(a)?new a.constructor(a.subarray(b,void 0!==c?c:a.length)):a.slice(b,c)},convertArray:function(a,b,c){return!a||!c&&a.constructor===b?a:"number"===typeof b.BYTES_PER_ELEMENT?new b(a):Array.prototype.slice.call(a)},
isTypedArray:function(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)},getKeyframeOrder:function(a){for(var b=a.length,c=Array(b),d=0;d!==b;++d)c[d]=d;c.sort(function(b,c){return a[b]-a[c]});return c},sortedArray:function(a,b,c){for(var d=a.length,e=new a.constructor(d),f=0,g=0;g!==d;++f)for(var h=c[f]*b,k=0;k!==b;++k)e[g++]=a[h+k];return e},flattenJSON:function(a,b,c,d){for(var e=1,f=a[0];void 0!==f&&void 0===f[d];)f=a[e++];if(void 0!==f){var g=f[d];if(void 0!==g)if(Array.isArray(g)){do g=
f[d],void 0!==g&&(b.push(f.time),c.push.apply(c,g)),f=a[e++];while(void 0!==f)}else if(void 0!==g.toArray){do g=f[d],void 0!==g&&(b.push(f.time),g.toArray(c,c.length)),f=a[e++];while(void 0!==f)}else{do g=f[d],void 0!==g&&(b.push(f.time),c.push(g)),f=a[e++];while(void 0!==f)}}}};Object.assign(oa.prototype,{evaluate:function(a){var b=this.parameterPositions,c=this._cachedIndex,d=b[c],e=b[c-1];a:{b:{c:{d:if(!(a<d)){for(var f=c+2;;){if(void 0===d){if(a<e)break d;this._cachedIndex=c=b.length;return this.afterEnd_(c-
1,a,e)}if(c===f)break;e=d;d=b[++c];if(a<d)break b}d=b.length;break c}if(a>=e)break a;else{f=b[1];a<f&&(c=2,e=f);for(f=c-2;;){if(void 0===e)return this._cachedIndex=0,this.beforeStart_(0,a,d);if(c===f)break;d=e;e=b[--c-1];if(a>=e)break b}d=c;c=0}}for(;c<d;)e=c+d>>>1,a<b[e]?d=e:c=e+1;d=b[c];e=b[c-1];if(void 0===e)return this._cachedIndex=0,this.beforeStart_(0,a,d);if(void 0===d)return this._cachedIndex=c=b.length,this.afterEnd_(c-1,e,a)}this._cachedIndex=c;this.intervalChanged_(c,e,d)}return this.interpolate_(c,
e,a,d)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(a){var b=this.resultBuffer,c=this.sampleValues,d=this.valueSize;a*=d;for(var e=0;e!==d;++e)b[e]=c[a+e];return b},interpolate_:function(){throw Error("call to abstract method");},intervalChanged_:function(){}});Object.assign(oa.prototype,{beforeStart_:oa.prototype.copySampleValue_,afterEnd_:oa.prototype.copySampleValue_});Cd.prototype=Object.assign(Object.create(oa.prototype),
{constructor:Cd,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(a,b,c){var d=this.parameterPositions,e=a-2,f=a+1,g=d[e],h=d[f];if(void 0===g)switch(this.getSettings_().endingStart){case 2401:e=a;g=2*b-c;break;case 2402:e=d.length-2;g=b+d[e]-d[e+1];break;default:e=a,g=c}if(void 0===h)switch(this.getSettings_().endingEnd){case 2401:f=a;h=2*c-b;break;case 2402:f=1;h=c+d[1]-d[0];break;default:f=a-1,h=b}a=.5*(c-b);d=this.valueSize;this._weightPrev=a/(b-g);this._weightNext=
a/(h-c);this._offsetPrev=e*d;this._offsetNext=f*d},interpolate_:function(a,b,c,d){var e=this.resultBuffer,f=this.sampleValues,g=this.valueSize;a*=g;var h=a-g,k=this._offsetPrev,m=this._offsetNext,l=this._weightPrev,n=this._weightNext,p=(c-b)/(d-b);c=p*p;d=c*p;b=-l*d+2*l*c-l*p;l=(1+l)*d+(-1.5-2*l)*c+(-.5+l)*p+1;p=(-1-n)*d+(1.5+n)*c+.5*p;n=n*d-n*c;for(c=0;c!==g;++c)e[c]=b*f[k+c]+l*f[h+c]+p*f[a+c]+n*f[m+c];return e}});ad.prototype=Object.assign(Object.create(oa.prototype),{constructor:ad,interpolate_:function(a,
b,c,d){var e=this.resultBuffer,f=this.sampleValues,g=this.valueSize;a*=g;var h=a-g;b=(c-b)/(d-b);c=1-b;for(d=0;d!==g;++d)e[d]=f[h+d]*c+f[a+d]*b;return e}});Dd.prototype=Object.assign(Object.create(oa.prototype),{constructor:Dd,interpolate_:function(a){return this.copySampleValue_(a-1)}});Object.assign(qa,{toJSON:function(a){var b=a.constructor;if(void 0!==b.toJSON)b=b.toJSON(a);else{b={name:a.name,times:ha.convertArray(a.times,Array),values:ha.convertArray(a.values,Array)};var c=a.getInterpolation();
c!==a.DefaultInterpolation&&(b.interpolation=c)}b.type=a.ValueTypeName;return b}});Object.assign(qa.prototype,{constructor:qa,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(a){return new Dd(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodLinear:function(a){return new ad(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodSmooth:function(a){return new Cd(this.times,this.values,this.getValueSize(),
a)},setInterpolation:function(a){switch(a){case 2300:var b=this.InterpolantFactoryMethodDiscrete;break;case 2301:b=this.InterpolantFactoryMethodLinear;break;case 2302:b=this.InterpolantFactoryMethodSmooth}if(void 0===b){b="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant)if(a!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(b);console.warn("THREE.KeyframeTrack:",b);return this}this.createInterpolant=
b;return this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(a){if(0!==a)for(var b=this.times,c=0,d=b.length;c!==d;++c)b[c]+=a;return this},scale:function(a){if(1!==a)for(var b=this.times,c=0,d=b.length;c!==d;++c)b[c]*=a;return this},trim:function(a,
b){for(var c=this.times,d=c.length,e=0,f=d-1;e!==d&&c[e]<a;)++e;for(;-1!==f&&c[f]>b;)--f;++f;if(0!==e||f!==d)e>=f&&(f=Math.max(f,1),e=f-1),a=this.getValueSize(),this.times=ha.arraySlice(c,e,f),this.values=ha.arraySlice(this.values,e*a,f*a);return this},validate:function(){var a=!0,b=this.getValueSize();0!==b-Math.floor(b)&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),a=!1);var c=this.times;b=this.values;var d=c.length;0===d&&(console.error("THREE.KeyframeTrack: Track is empty.",
this),a=!1);for(var e=null,f=0;f!==d;f++){var g=c[f];if("number"===typeof g&&isNaN(g)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,f,g);a=!1;break}if(null!==e&&e>g){console.error("THREE.KeyframeTrack: Out of order keys.",this,f,g,e);a=!1;break}e=g}if(void 0!==b&&ha.isTypedArray(b))for(f=0,c=b.length;f!==c;++f)if(d=b[f],isNaN(d)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,f,d);a=!1;break}return a},optimize:function(){for(var a=this.times,b=this.values,
c=this.getValueSize(),d=2302===this.getInterpolation(),e=1,f=a.length-1,g=1;g<f;++g){var h=!1,k=a[g];if(k!==a[g+1]&&(1!==g||k!==k[0]))if(d)h=!0;else{var m=g*c,l=m-c,n=m+c;for(k=0;k!==c;++k){var p=b[m+k];if(p!==b[l+k]||p!==b[n+k]){h=!0;break}}}if(h){if(g!==e)for(a[e]=a[g],h=g*c,m=e*c,k=0;k!==c;++k)b[m+k]=b[h+k];++e}}if(0<f){a[e]=a[f];h=f*c;m=e*c;for(k=0;k!==c;++k)b[m+k]=b[h+k];++e}e!==a.length&&(this.times=ha.arraySlice(a,0,e),this.values=ha.arraySlice(b,0,e*c));return this}});Ed.prototype=Object.assign(Object.create(qa.prototype),
{constructor:Ed,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});Fd.prototype=Object.assign(Object.create(qa.prototype),{constructor:Fd,ValueTypeName:"color"});gc.prototype=Object.assign(Object.create(qa.prototype),{constructor:gc,ValueTypeName:"number"});Gd.prototype=Object.assign(Object.create(oa.prototype),{constructor:Gd,interpolate_:function(a,b,c,d){var e=this.resultBuffer,f=this.sampleValues,g=
this.valueSize;a*=g;b=(c-b)/(d-b);for(c=a+g;a!==c;a+=4)ia.slerpFlat(e,0,f,a-g,f,a,b);return e}});bd.prototype=Object.assign(Object.create(qa.prototype),{constructor:bd,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(a){return new Gd(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodSmooth:void 0});Hd.prototype=Object.assign(Object.create(qa.prototype),{constructor:Hd,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,
InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});hc.prototype=Object.assign(Object.create(qa.prototype),{constructor:hc,ValueTypeName:"vector"});Object.assign(Ca,{parse:function(a){for(var b=[],c=a.tracks,d=1/(a.fps||1),e=0,f=c.length;e!==f;++e)b.push(Vg(c[e]).scale(d));return new Ca(a.name,a.duration,b)},toJSON:function(a){var b=[],c=a.tracks;a={name:a.name,duration:a.duration,tracks:b,uuid:a.uuid};for(var d=0,e=c.length;d!==e;++d)b.push(qa.toJSON(c[d]));return a},CreateFromMorphTargetSequence:function(a,
b,c,d){for(var e=b.length,f=[],g=0;g<e;g++){var h=[],k=[];h.push((g+e-1)%e,g,(g+1)%e);k.push(0,1,0);var m=ha.getKeyframeOrder(h);h=ha.sortedArray(h,1,m);k=ha.sortedArray(k,1,m);d||0!==h[0]||(h.push(e),k.push(k[0]));f.push((new gc(".morphTargetInfluences["+b[g].name+"]",h,k)).scale(1/c))}return new Ca(a,-1,f)},findByName:function(a,b){var c=a;Array.isArray(a)||(c=a.geometry&&a.geometry.animations||a.animations);for(a=0;a<c.length;a++)if(c[a].name===b)return c[a];return null},CreateClipsFromMorphTargetSequences:function(a,
b,c){for(var d={},e=/^([\w-]*?)([\d]+)$/,f=0,g=a.length;f<g;f++){var h=a[f],k=h.name.match(e);if(k&&1<k.length){var m=k[1];(k=d[m])||(d[m]=k=[]);k.push(h)}}a=[];for(m in d)a.push(Ca.CreateFromMorphTargetSequence(m,d[m],b,c));return a},parseAnimation:function(a,b){if(!a)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;var c=function(a,b,c,d,e){if(0!==c.length){var f=[],g=[];ha.flattenJSON(c,f,g,d);0!==f.length&&e.push(new a(b,f,g))}},d=[],e=a.name||"default",f=a.length||
-1,g=a.fps||30;a=a.hierarchy||[];for(var h=0;h<a.length;h++){var k=a[h].keys;if(k&&0!==k.length)if(k[0].morphTargets){f={};for(var m=0;m<k.length;m++)if(k[m].morphTargets)for(var l=0;l<k[m].morphTargets.length;l++)f[k[m].morphTargets[l]]=-1;for(var n in f){var p=[],t=[];for(l=0;l!==k[m].morphTargets.length;++l){var r=k[m];p.push(r.time);t.push(r.morphTarget===n?1:0)}d.push(new gc(".morphTargetInfluence["+n+"]",p,t))}f=f.length*(g||1)}else m=".bones["+b[h].name+"]",c(hc,m+".position",k,"pos",d),c(bd,
m+".quaternion",k,"rot",d),c(hc,m+".scale",k,"scl",d)}return 0===d.length?null:new Ca(e,f,d)}});Object.assign(Ca.prototype,{resetDuration:function(){for(var a=0,b=0,c=this.tracks.length;b!==c;++b){var d=this.tracks[b];a=Math.max(a,d.times[d.times.length-1])}this.duration=a;return this},trim:function(){for(var a=0;a<this.tracks.length;a++)this.tracks[a].trim(0,this.duration);return this},validate:function(){for(var a=!0,b=0;b<this.tracks.length;b++)a=a&&this.tracks[b].validate();return a},optimize:function(){for(var a=
0;a<this.tracks.length;a++)this.tracks[a].optimize();return this}});Object.assign(Id.prototype,{load:function(a,b,c,d){var e=this;(new Ja(e.manager)).load(a,function(a){b(e.parse(JSON.parse(a)))},c,d)},setTextures:function(a){this.textures=a},parse:function(a){function b(a){void 0===c[a]&&console.warn("THREE.MaterialLoader: Undefined texture",a);return c[a]}var c=this.textures,d=new hh[a.type];void 0!==a.uuid&&(d.uuid=a.uuid);void 0!==a.name&&(d.name=a.name);void 0!==a.color&&d.color.setHex(a.color);
void 0!==a.roughness&&(d.roughness=a.roughness);void 0!==a.metalness&&(d.metalness=a.metalness);void 0!==a.emissive&&d.emissive.setHex(a.emissive);void 0!==a.specular&&d.specular.setHex(a.specular);void 0!==a.shininess&&(d.shininess=a.shininess);void 0!==a.clearCoat&&(d.clearCoat=a.clearCoat);void 0!==a.clearCoatRoughness&&(d.clearCoatRoughness=a.clearCoatRoughness);void 0!==a.uniforms&&(d.uniforms=a.uniforms);void 0!==a.vertexShader&&(d.vertexShader=a.vertexShader);void 0!==a.fragmentShader&&(d.fragmentShader=
a.fragmentShader);void 0!==a.vertexColors&&(d.vertexColors=a.vertexColors);void 0!==a.fog&&(d.fog=a.fog);void 0!==a.flatShading&&(d.flatShading=a.flatShading);void 0!==a.blending&&(d.blending=a.blending);void 0!==a.side&&(d.side=a.side);void 0!==a.opacity&&(d.opacity=a.opacity);void 0!==a.transparent&&(d.transparent=a.transparent);void 0!==a.alphaTest&&(d.alphaTest=a.alphaTest);void 0!==a.depthTest&&(d.depthTest=a.depthTest);void 0!==a.depthWrite&&(d.depthWrite=a.depthWrite);void 0!==a.colorWrite&&
(d.colorWrite=a.colorWrite);void 0!==a.wireframe&&(d.wireframe=a.wireframe);void 0!==a.wireframeLinewidth&&(d.wireframeLinewidth=a.wireframeLinewidth);void 0!==a.wireframeLinecap&&(d.wireframeLinecap=a.wireframeLinecap);void 0!==a.wireframeLinejoin&&(d.wireframeLinejoin=a.wireframeLinejoin);void 0!==a.rotation&&(d.rotation=a.rotation);1!==a.linewidth&&(d.linewidth=a.linewidth);void 0!==a.dashSize&&(d.dashSize=a.dashSize);void 0!==a.gapSize&&(d.gapSize=a.gapSize);void 0!==a.scale&&(d.scale=a.scale);
void 0!==a.polygonOffset&&(d.polygonOffset=a.polygonOffset);void 0!==a.polygonOffsetFactor&&(d.polygonOffsetFactor=a.polygonOffsetFactor);void 0!==a.polygonOffsetUnits&&(d.polygonOffsetUnits=a.polygonOffsetUnits);void 0!==a.skinning&&(d.skinning=a.skinning);void 0!==a.morphTargets&&(d.morphTargets=a.morphTargets);void 0!==a.dithering&&(d.dithering=a.dithering);void 0!==a.visible&&(d.visible=a.visible);void 0!==a.userData&&(d.userData=a.userData);void 0!==a.shading&&(d.flatShading=1===a.shading);void 0!==
a.size&&(d.size=a.size);void 0!==a.sizeAttenuation&&(d.sizeAttenuation=a.sizeAttenuation);void 0!==a.map&&(d.map=b(a.map));void 0!==a.alphaMap&&(d.alphaMap=b(a.alphaMap),d.transparent=!0);void 0!==a.bumpMap&&(d.bumpMap=b(a.bumpMap));void 0!==a.bumpScale&&(d.bumpScale=a.bumpScale);void 0!==a.normalMap&&(d.normalMap=b(a.normalMap));void 0!==a.normalMapType&&(d.normalMapType=a.normalMapType);if(void 0!==a.normalScale){var e=a.normalScale;!1===Array.isArray(e)&&(e=[e,e]);d.normalScale=(new C).fromArray(e)}void 0!==
a.displacementMap&&(d.displacementMap=b(a.displacementMap));void 0!==a.displacementScale&&(d.displacementScale=a.displacementScale);void 0!==a.displacementBias&&(d.displacementBias=a.displacementBias);void 0!==a.roughnessMap&&(d.roughnessMap=b(a.roughnessMap));void 0!==a.metalnessMap&&(d.metalnessMap=b(a.metalnessMap));void 0!==a.emissiveMap&&(d.emissiveMap=b(a.emissiveMap));void 0!==a.emissiveIntensity&&(d.emissiveIntensity=a.emissiveIntensity);void 0!==a.specularMap&&(d.specularMap=b(a.specularMap));
void 0!==a.envMap&&(d.envMap=b(a.envMap));void 0!==a.reflectivity&&(d.reflectivity=a.reflectivity);void 0!==a.lightMap&&(d.lightMap=b(a.lightMap));void 0!==a.lightMapIntensity&&(d.lightMapIntensity=a.lightMapIntensity);void 0!==a.aoMap&&(d.aoMap=b(a.aoMap));void 0!==a.aoMapIntensity&&(d.aoMapIntensity=a.aoMapIntensity);void 0!==a.gradientMap&&(d.gradientMap=b(a.gradientMap));return d}});Object.assign(be.prototype,{load:function(a,b,c,d){var e=this;(new Ja(e.manager)).load(a,function(a){b(e.parse(JSON.parse(a)))},
c,d)},parse:function(a){var b=new E,c=a.data.index;void 0!==c&&(c=new Df[c.type](c.array),b.setIndex(new P(c,1)));var d=a.data.attributes;for(f in d){var e=d[f];c=new Df[e.type](e.array);b.addAttribute(f,new P(c,e.itemSize,e.normalized))}var f=a.data.groups||a.data.drawcalls||a.data.offsets;if(void 0!==f)for(c=0,d=f.length;c!==d;++c)e=f[c],b.addGroup(e.start,e.count,e.materialIndex);a=a.data.boundingSphere;void 0!==a&&(f=new p,void 0!==a.center&&f.fromArray(a.center),b.boundingSphere=new za(f,a.radius));
return b}});var Df={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!==typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};ic.Handlers={handlers:[],add:function(a,b){this.handlers.push(a,b)},get:function(a){for(var b=this.handlers,c=0,d=b.length;c<d;c+=2){var e=b[c+1];if(b[c].test(a))return e}return null}};Object.assign(ic.prototype,
{crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(a,b,c){for(var d=[],e=0;e<a.length;++e)d[e]=this.createMaterial(a[e],b,c);return d},createMaterial:function(){var a={NoBlending:0,NormalBlending:1,AdditiveBlending:2,SubtractiveBlending:3,MultiplyBlending:4,CustomBlending:5},b=new G,c=new td,d=new Id;return function(e,f,g){function h(a,b,d,e,h){a=f+a;var m=ic.Handlers.get(a);null!==m?a=m.load(a):(c.setCrossOrigin(g),a=c.load(a));
void 0!==b&&(a.repeat.fromArray(b),1!==b[0]&&(a.wrapS=1E3),1!==b[1]&&(a.wrapT=1E3));void 0!==d&&a.offset.fromArray(d);void 0!==e&&("repeat"===e[0]&&(a.wrapS=1E3),"mirror"===e[0]&&(a.wrapS=1002),"repeat"===e[1]&&(a.wrapT=1E3),"mirror"===e[1]&&(a.wrapT=1002));void 0!==h&&(a.anisotropy=h);b=Q.generateUUID();k[b]=a;return b}var k={},m={uuid:Q.generateUUID(),type:"MeshLambertMaterial"},l;for(l in e){var n=e[l];switch(l){case "DbgColor":case "DbgIndex":case "opticalDensity":case "illumination":break;case "DbgName":m.name=
n;break;case "blending":m.blending=a[n];break;case "colorAmbient":case "mapAmbient":console.warn("THREE.Loader.createMaterial:",l,"is no longer supported.");break;case "colorDiffuse":m.color=b.fromArray(n).getHex();break;case "colorSpecular":m.specular=b.fromArray(n).getHex();break;case "colorEmissive":m.emissive=b.fromArray(n).getHex();break;case "specularCoef":m.shininess=n;break;case "shading":"basic"===n.toLowerCase()&&(m.type="MeshBasicMaterial");"phong"===n.toLowerCase()&&(m.type="MeshPhongMaterial");
"standard"===n.toLowerCase()&&(m.type="MeshStandardMaterial");break;case "mapDiffuse":m.map=h(n,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy);break;case "mapDiffuseRepeat":case "mapDiffuseOffset":case "mapDiffuseWrap":case "mapDiffuseAnisotropy":break;case "mapEmissive":m.emissiveMap=h(n,e.mapEmissiveRepeat,e.mapEmissiveOffset,e.mapEmissiveWrap,e.mapEmissiveAnisotropy);break;case "mapEmissiveRepeat":case "mapEmissiveOffset":case "mapEmissiveWrap":case "mapEmissiveAnisotropy":break;
case "mapLight":m.lightMap=h(n,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy);break;case "mapLightRepeat":case "mapLightOffset":case "mapLightWrap":case "mapLightAnisotropy":break;case "mapAO":m.aoMap=h(n,e.mapAORepeat,e.mapAOOffset,e.mapAOWrap,e.mapAOAnisotropy);break;case "mapAORepeat":case "mapAOOffset":case "mapAOWrap":case "mapAOAnisotropy":break;case "mapBump":m.bumpMap=h(n,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy);break;case "mapBumpScale":m.bumpScale=
n;break;case "mapBumpRepeat":case "mapBumpOffset":case "mapBumpWrap":case "mapBumpAnisotropy":break;case "mapNormal":m.normalMap=h(n,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy);break;case "mapNormalFactor":m.normalScale=n;break;case "mapNormalRepeat":case "mapNormalOffset":case "mapNormalWrap":case "mapNormalAnisotropy":break;case "mapSpecular":m.specularMap=h(n,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy);break;case "mapSpecularRepeat":case "mapSpecularOffset":case "mapSpecularWrap":case "mapSpecularAnisotropy":break;
case "mapMetalness":m.metalnessMap=h(n,e.mapMetalnessRepeat,e.mapMetalnessOffset,e.mapMetalnessWrap,e.mapMetalnessAnisotropy);break;case "mapMetalnessRepeat":case "mapMetalnessOffset":case "mapMetalnessWrap":case "mapMetalnessAnisotropy":break;case "mapRoughness":m.roughnessMap=h(n,e.mapRoughnessRepeat,e.mapRoughnessOffset,e.mapRoughnessWrap,e.mapRoughnessAnisotropy);break;case "mapRoughnessRepeat":case "mapRoughnessOffset":case "mapRoughnessWrap":case "mapRoughnessAnisotropy":break;case "mapAlpha":m.alphaMap=
h(n,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy);break;case "mapAlphaRepeat":case "mapAlphaOffset":case "mapAlphaWrap":case "mapAlphaAnisotropy":break;case "flipSided":m.side=1;break;case "doubleSided":m.side=2;break;case "transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity");m.opacity=n;break;case "depthTest":case "depthWrite":case "colorWrite":case "opacity":case "reflectivity":case "transparent":case "visible":case "wireframe":m[l]=
n;break;case "vertexColors":!0===n&&(m.vertexColors=2);"face"===n&&(m.vertexColors=1);break;default:console.error("THREE.Loader.createMaterial: Unsupported",l,n)}}"MeshBasicMaterial"===m.type&&delete m.emissive;"MeshPhongMaterial"!==m.type&&delete m.specular;1>m.opacity&&(m.transparent=!0);d.setTextures(k);return d.parse(m)}}()});var ze={decodeText:function(a){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(a);for(var b="",c=0,d=a.length;c<d;c++)b+=String.fromCharCode(a[c]);return decodeURIComponent(escape(b))},
extractUrlBase:function(a){var b=a.lastIndexOf("/");return-1===b?"./":a.substr(0,b+1)}};Object.assign(ce.prototype,{crossOrigin:"anonymous",load:function(a,b,c,d){var e=this,f=this.texturePath&&"string"===typeof this.texturePath?this.texturePath:ze.extractUrlBase(a),g=new Ja(this.manager);g.setWithCredentials(this.withCredentials);g.load(a,function(c){c=JSON.parse(c);var d=c.metadata;if(void 0!==d&&(d=d.type,void 0!==d&&"object"===d.toLowerCase())){console.error("THREE.JSONLoader: "+a+" should be loaded with THREE.ObjectLoader instead.");
return}c=e.parse(c,f);b(c.geometry,c.materials)},c,d)},setCrossOrigin:function(a){this.crossOrigin=a;return this},setTexturePath:function(a){this.texturePath=a;return this},parse:function(){return function(a,b){void 0!==a.data&&(a=a.data);a.scale=void 0!==a.scale?1/a.scale:1;var c=new K,d=a,e,f,g,h=d.faces;var k=d.vertices;var m=d.normals,l=d.colors;var n=d.scale;var u=0;if(void 0!==d.uvs){for(e=0;e<d.uvs.length;e++)d.uvs[e].length&&u++;for(e=0;e<u;e++)c.faceVertexUvs[e]=[]}var t=0;for(g=k.length;t<
g;)e=new p,e.x=k[t++]*n,e.y=k[t++]*n,e.z=k[t++]*n,c.vertices.push(e);t=0;for(g=h.length;t<g;){k=h[t++];var r=k&1;var v=k&2;e=k&8;var z=k&16;var x=k&32;n=k&64;k&=128;if(r){r=new Wa;r.a=h[t];r.b=h[t+1];r.c=h[t+3];var w=new Wa;w.a=h[t+1];w.b=h[t+2];w.c=h[t+3];t+=4;v&&(v=h[t++],r.materialIndex=v,w.materialIndex=v);v=c.faces.length;if(e)for(e=0;e<u;e++){var y=d.uvs[e];c.faceVertexUvs[e][v]=[];c.faceVertexUvs[e][v+1]=[];for(f=0;4>f;f++){var A=h[t++];var B=y[2*A];A=y[2*A+1];B=new C(B,A);2!==f&&c.faceVertexUvs[e][v].push(B);
0!==f&&c.faceVertexUvs[e][v+1].push(B)}}z&&(z=3*h[t++],r.normal.set(m[z++],m[z++],m[z]),w.normal.copy(r.normal));if(x)for(e=0;4>e;e++)z=3*h[t++],x=new p(m[z++],m[z++],m[z]),2!==e&&r.vertexNormals.push(x),0!==e&&w.vertexNormals.push(x);n&&(n=h[t++],n=l[n],r.color.setHex(n),w.color.setHex(n));if(k)for(e=0;4>e;e++)n=h[t++],n=l[n],2!==e&&r.vertexColors.push(new G(n)),0!==e&&w.vertexColors.push(new G(n));c.faces.push(r);c.faces.push(w)}else{r=new Wa;r.a=h[t++];r.b=h[t++];r.c=h[t++];v&&(v=h[t++],r.materialIndex=
v);v=c.faces.length;if(e)for(e=0;e<u;e++)for(y=d.uvs[e],c.faceVertexUvs[e][v]=[],f=0;3>f;f++)A=h[t++],B=y[2*A],A=y[2*A+1],B=new C(B,A),c.faceVertexUvs[e][v].push(B);z&&(z=3*h[t++],r.normal.set(m[z++],m[z++],m[z]));if(x)for(e=0;3>e;e++)z=3*h[t++],x=new p(m[z++],m[z++],m[z]),r.vertexNormals.push(x);n&&(n=h[t++],r.color.setHex(l[n]));if(k)for(e=0;3>e;e++)n=h[t++],r.vertexColors.push(new G(l[n]));c.faces.push(r)}}d=a;t=void 0!==d.influencesPerVertex?d.influencesPerVertex:2;if(d.skinWeights)for(g=0,h=
d.skinWeights.length;g<h;g+=t)c.skinWeights.push(new ca(d.skinWeights[g],1<t?d.skinWeights[g+1]:0,2<t?d.skinWeights[g+2]:0,3<t?d.skinWeights[g+3]:0));if(d.skinIndices)for(g=0,h=d.skinIndices.length;g<h;g+=t)c.skinIndices.push(new ca(d.skinIndices[g],1<t?d.skinIndices[g+1]:0,2<t?d.skinIndices[g+2]:0,3<t?d.skinIndices[g+3]:0));c.bones=d.bones;c.bones&&0<c.bones.length&&(c.skinWeights.length!==c.skinIndices.length||c.skinIndices.length!==c.vertices.length)&&console.warn("When skinning, number of vertices ("+
c.vertices.length+"), skinIndices ("+c.skinIndices.length+"), and skinWeights ("+c.skinWeights.length+") should match.");g=a;h=g.scale;if(void 0!==g.morphTargets)for(d=0,t=g.morphTargets.length;d<t;d++)for(c.morphTargets[d]={},c.morphTargets[d].name=g.morphTargets[d].name,c.morphTargets[d].vertices=[],m=c.morphTargets[d].vertices,l=g.morphTargets[d].vertices,u=0,k=l.length;u<k;u+=3)n=new p,n.x=l[u]*h,n.y=l[u+1]*h,n.z=l[u+2]*h,m.push(n);if(void 0!==g.morphColors&&0<g.morphColors.length)for(console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.'),
h=c.faces,g=g.morphColors[0].colors,d=0,t=h.length;d<t;d++)h[d].color.fromArray(g,3*d);g=a;d=[];t=[];void 0!==g.animation&&t.push(g.animation);void 0!==g.animations&&(g.animations.length?t=t.concat(g.animations):t.push(g.animations));for(g=0;g<t.length;g++)(h=Ca.parseAnimation(t[g],c.bones))&&d.push(h);c.morphTargets&&(t=Ca.CreateClipsFromMorphTargetSequences(c.morphTargets,10),d=d.concat(t));0<d.length&&(c.animations=d);c.computeFaceNormals();c.computeBoundingSphere();if(void 0===a.materials||0===
a.materials.length)return{geometry:c};a=ic.prototype.initMaterials(a.materials,b,this.crossOrigin);return{geometry:c,materials:a}}}()});Object.assign(jf.prototype,{crossOrigin:"anonymous",load:function(a,b,c,d){""===this.texturePath&&(this.texturePath=a.substring(0,a.lastIndexOf("/")+1));var e=this;(new Ja(e.manager)).load(a,function(c){var f=null;try{f=JSON.parse(c)}catch(h){void 0!==d&&d(h);console.error("THREE:ObjectLoader: Can't parse "+a+".",h.message);return}c=f.metadata;void 0===c||void 0===
c.type||"geometry"===c.type.toLowerCase()?console.error("THREE.ObjectLoader: Can't load "+a+". Use THREE.JSONLoader instead."):e.parse(f,b)},c,d)},setTexturePath:function(a){this.texturePath=a;return this},setCrossOrigin:function(a){this.crossOrigin=a;return this},parse:function(a,b){var c=this.parseShape(a.shapes);c=this.parseGeometries(a.geometries,c);var d=this.parseImages(a.images,function(){void 0!==b&&b(e)});d=this.parseTextures(a.textures,d);d=this.parseMaterials(a.materials,d);var e=this.parseObject(a.object,
c,d);a.animations&&(e.animations=this.parseAnimations(a.animations));void 0!==a.images&&0!==a.images.length||void 0===b||b(e);return e},parseShape:function(a){var b={};if(void 0!==a)for(var c=0,d=a.length;c<d;c++){var e=(new hb).fromJSON(a[c]);b[e.uuid]=e}return b},parseGeometries:function(a,b){var c={};if(void 0!==a)for(var d=new ce,e=new be,f=0,g=a.length;f<g;f++){var h=a[f];switch(h.type){case "PlaneGeometry":case "PlaneBufferGeometry":var k=new ya[h.type](h.width,h.height,h.widthSegments,h.heightSegments);
break;case "BoxGeometry":case "BoxBufferGeometry":case "CubeGeometry":k=new ya[h.type](h.width,h.height,h.depth,h.widthSegments,h.heightSegments,h.depthSegments);break;case "CircleGeometry":case "CircleBufferGeometry":k=new ya[h.type](h.radius,h.segments,h.thetaStart,h.thetaLength);break;case "CylinderGeometry":case "CylinderBufferGeometry":k=new ya[h.type](h.radiusTop,h.radiusBottom,h.height,h.radialSegments,h.heightSegments,h.openEnded,h.thetaStart,h.thetaLength);break;case "ConeGeometry":case "ConeBufferGeometry":k=
new ya[h.type](h.radius,h.height,h.radialSegments,h.heightSegments,h.openEnded,h.thetaStart,h.thetaLength);break;case "SphereGeometry":case "SphereBufferGeometry":k=new ya[h.type](h.radius,h.widthSegments,h.heightSegments,h.phiStart,h.phiLength,h.thetaStart,h.thetaLength);break;case "DodecahedronGeometry":case "DodecahedronBufferGeometry":case "IcosahedronGeometry":case "IcosahedronBufferGeometry":case "OctahedronGeometry":case "OctahedronBufferGeometry":case "TetrahedronGeometry":case "TetrahedronBufferGeometry":k=
new ya[h.type](h.radius,h.detail);break;case "RingGeometry":case "RingBufferGeometry":k=new ya[h.type](h.innerRadius,h.outerRadius,h.thetaSegments,h.phiSegments,h.thetaStart,h.thetaLength);break;case "TorusGeometry":case "TorusBufferGeometry":k=new ya[h.type](h.radius,h.tube,h.radialSegments,h.tubularSegments,h.arc);break;case "TorusKnotGeometry":case "TorusKnotBufferGeometry":k=new ya[h.type](h.radius,h.tube,h.tubularSegments,h.radialSegments,h.p,h.q);break;case "LatheGeometry":case "LatheBufferGeometry":k=
new ya[h.type](h.points,h.segments,h.phiStart,h.phiLength);break;case "PolyhedronGeometry":case "PolyhedronBufferGeometry":k=new ya[h.type](h.vertices,h.indices,h.radius,h.details);break;case "ShapeGeometry":case "ShapeBufferGeometry":k=[];for(var m=0,l=h.shapes.length;m<l;m++){var n=b[h.shapes[m]];k.push(n)}k=new ya[h.type](k,h.curveSegments);break;case "ExtrudeGeometry":case "ExtrudeBufferGeometry":k=[];m=0;for(l=h.shapes.length;m<l;m++)n=b[h.shapes[m]],k.push(n);m=h.options.extrudePath;void 0!==
m&&(h.options.extrudePath=(new Cf[m.type]).fromJSON(m));k=new ya[h.type](k,h.options);break;case "BufferGeometry":k=e.parse(h);break;case "Geometry":k=d.parse(h,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+h.type+'"');continue}k.uuid=h.uuid;void 0!==h.name&&(k.name=h.name);!0===k.isBufferGeometry&&void 0!==h.userData&&(k.userData=h.userData);c[h.uuid]=k}return c},parseMaterials:function(a,b){var c={};if(void 0!==a){var d=new Id;d.setTextures(b);
b=0;for(var e=a.length;b<e;b++){var f=a[b];if("MultiMaterial"===f.type){for(var g=[],h=0;h<f.materials.length;h++)g.push(d.parse(f.materials[h]));c[f.uuid]=g}else c[f.uuid]=d.parse(f)}}return c},parseAnimations:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=Ca.parse(d);void 0!==d.uuid&&(e.uuid=d.uuid);b.push(e)}return b},parseImages:function(a,b){function c(a){d.manager.itemStart(a);return f.load(a,function(){d.manager.itemEnd(a)},void 0,function(){d.manager.itemEnd(a);d.manager.itemError(a)})}
var d=this,e={};if(void 0!==a&&0<a.length){b=new ve(b);var f=new Nd(b);f.setCrossOrigin(this.crossOrigin);b=0;for(var g=a.length;b<g;b++){var h=a[b],k=h.url;if(Array.isArray(k)){e[h.uuid]=[];for(var m=0,l=k.length;m<l;m++){var n=k[m];n=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:d.texturePath+n;e[h.uuid].push(c(n))}}else n=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h.url)?h.url:d.texturePath+h.url,e[h.uuid]=c(n)}}return e},parseTextures:function(a,b){function c(a,b){if("number"===typeof a)return a;console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",
a);return b[a]}var d={};if(void 0!==a)for(var e=0,f=a.length;e<f;e++){var g=a[e];void 0===g.image&&console.warn('THREE.ObjectLoader: No "image" specified for',g.uuid);void 0===b[g.image]&&console.warn("THREE.ObjectLoader: Undefined image",g.image);var h=Array.isArray(b[g.image])?new Md(b[g.image]):new ta(b[g.image]);h.needsUpdate=!0;h.uuid=g.uuid;void 0!==g.name&&(h.name=g.name);void 0!==g.mapping&&(h.mapping=c(g.mapping,kh));void 0!==g.offset&&h.offset.fromArray(g.offset);void 0!==g.repeat&&h.repeat.fromArray(g.repeat);
void 0!==g.center&&h.center.fromArray(g.center);void 0!==g.rotation&&(h.rotation=g.rotation);void 0!==g.wrap&&(h.wrapS=c(g.wrap[0],Ef),h.wrapT=c(g.wrap[1],Ef));void 0!==g.format&&(h.format=g.format);void 0!==g.minFilter&&(h.minFilter=c(g.minFilter,Ff));void 0!==g.magFilter&&(h.magFilter=c(g.magFilter,Ff));void 0!==g.anisotropy&&(h.anisotropy=g.anisotropy);void 0!==g.flipY&&(h.flipY=g.flipY);d[g.uuid]=h}return d},parseObject:function(a,b,c){function d(a){void 0===b[a]&&console.warn("THREE.ObjectLoader: Undefined geometry",
a);return b[a]}function e(a){if(void 0!==a){if(Array.isArray(a)){for(var b=[],d=0,e=a.length;d<e;d++){var f=a[d];void 0===c[f]&&console.warn("THREE.ObjectLoader: Undefined material",f);b.push(c[f])}return b}void 0===c[a]&&console.warn("THREE.ObjectLoader: Undefined material",a);return c[a]}}switch(a.type){case "Scene":var f=new od;void 0!==a.background&&Number.isInteger(a.background)&&(f.background=new G(a.background));void 0!==a.fog&&("Fog"===a.fog.type?f.fog=new Ob(a.fog.color,a.fog.near,a.fog.far):
"FogExp2"===a.fog.type&&(f.fog=new Nb(a.fog.color,a.fog.density)));break;case "PerspectiveCamera":f=new ea(a.fov,a.aspect,a.near,a.far);void 0!==a.focus&&(f.focus=a.focus);void 0!==a.zoom&&(f.zoom=a.zoom);void 0!==a.filmGauge&&(f.filmGauge=a.filmGauge);void 0!==a.filmOffset&&(f.filmOffset=a.filmOffset);void 0!==a.view&&(f.view=Object.assign({},a.view));break;case "OrthographicCamera":f=new Jb(a.left,a.right,a.top,a.bottom,a.near,a.far);void 0!==a.zoom&&(f.zoom=a.zoom);void 0!==a.view&&(f.view=Object.assign({},
a.view));break;case "AmbientLight":f=new Ad(a.color,a.intensity);break;case "DirectionalLight":f=new zd(a.color,a.intensity);break;case "PointLight":f=new xd(a.color,a.intensity,a.distance,a.decay);break;case "RectAreaLight":f=new Bd(a.color,a.intensity,a.width,a.height);break;case "SpotLight":f=new wd(a.color,a.intensity,a.distance,a.angle,a.penumbra,a.decay);break;case "HemisphereLight":f=new ud(a.color,a.groundColor,a.intensity);break;case "SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");
case "Mesh":f=d(a.geometry);var g=e(a.material);f=f.bones&&0<f.bones.length?new qd(f,g):new ra(f,g);break;case "LOD":f=new Cc;break;case "Line":f=new ma(d(a.geometry),e(a.material),a.mode);break;case "LineLoop":f=new rd(d(a.geometry),e(a.material));break;case "LineSegments":f=new W(d(a.geometry),e(a.material));break;case "PointCloud":case "Points":f=new Qb(d(a.geometry),e(a.material));break;case "Sprite":f=new Bc(e(a.material));break;case "Group":f=new Mb;break;default:f=new B}f.uuid=a.uuid;void 0!==
a.name&&(f.name=a.name);void 0!==a.matrix?(f.matrix.fromArray(a.matrix),void 0!==a.matrixAutoUpdate&&(f.matrixAutoUpdate=a.matrixAutoUpdate),f.matrixAutoUpdate&&f.matrix.decompose(f.position,f.quaternion,f.scale)):(void 0!==a.position&&f.position.fromArray(a.position),void 0!==a.rotation&&f.rotation.fromArray(a.rotation),void 0!==a.quaternion&&f.quaternion.fromArray(a.quaternion),void 0!==a.scale&&f.scale.fromArray(a.scale));void 0!==a.castShadow&&(f.castShadow=a.castShadow);void 0!==a.receiveShadow&&
(f.receiveShadow=a.receiveShadow);a.shadow&&(void 0!==a.shadow.bias&&(f.shadow.bias=a.shadow.bias),void 0!==a.shadow.radius&&(f.shadow.radius=a.shadow.radius),void 0!==a.shadow.mapSize&&f.shadow.mapSize.fromArray(a.shadow.mapSize),void 0!==a.shadow.camera&&(f.shadow.camera=this.parseObject(a.shadow.camera)));void 0!==a.visible&&(f.visible=a.visible);void 0!==a.frustumCulled&&(f.frustumCulled=a.frustumCulled);void 0!==a.renderOrder&&(f.renderOrder=a.renderOrder);void 0!==a.userData&&(f.userData=a.userData);
void 0!==a.layers&&(f.layers.mask=a.layers);if(void 0!==a.children){g=a.children;for(var h=0;h<g.length;h++)f.add(this.parseObject(g[h],b,c))}if("LOD"===a.type)for(a=a.levels,g=0;g<a.length;g++){h=a[g];var k=f.getObjectByProperty("uuid",h.object);void 0!==k&&f.addLevel(k,h.distance)}return f}});var kh={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,
CubeUVRefractionMapping:307},Ef={RepeatWrapping:1E3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},Ff={NearestFilter:1003,NearestMipMapNearestFilter:1004,NearestMipMapLinearFilter:1005,LinearFilter:1006,LinearMipMapNearestFilter:1007,LinearMipMapLinearFilter:1008};de.prototype={constructor:de,setOptions:function(a){this.options=a;return this},load:function(a,b,c,d){void 0===a&&(a="");void 0!==this.path&&(a=this.path+a);a=this.manager.resolveURL(a);var e=this,f=ab.get(a);if(void 0!==f)return e.manager.itemStart(a),
setTimeout(function(){b&&b(f);e.manager.itemEnd(a)},0),f;fetch(a).then(function(a){return a.blob()}).then(function(a){return createImageBitmap(a,e.options)}).then(function(c){ab.add(a,c);b&&b(c);e.manager.itemEnd(a)}).catch(function(b){d&&d(b);e.manager.itemEnd(a);e.manager.itemError(a)})},setCrossOrigin:function(){return this},setPath:function(a){this.path=a;return this}};Object.assign(ee.prototype,{moveTo:function(a,b){this.currentPath=new Oa;this.subPaths.push(this.currentPath);this.currentPath.moveTo(a,
b)},lineTo:function(a,b){this.currentPath.lineTo(a,b)},quadraticCurveTo:function(a,b,c,d){this.currentPath.quadraticCurveTo(a,b,c,d)},bezierCurveTo:function(a,b,c,d,e,f){this.currentPath.bezierCurveTo(a,b,c,d,e,f)},splineThru:function(a){this.currentPath.splineThru(a)},toShapes:function(a,b){function c(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c],f=new hb;f.curves=e.curves;b.push(f)}return b}function d(a,b){for(var c=b.length,d=!1,e=c-1,f=0;f<c;e=f++){var g=b[e],h=b[f],k=h.x-g.x,l=h.y-g.y;if(Math.abs(l)>
Number.EPSILON){if(0>l&&(g=b[f],k=-k,h=b[e],l=-l),!(a.y<g.y||a.y>h.y))if(a.y===g.y){if(a.x===g.x)return!0}else{e=l*(a.x-g.x)-k*(a.y-g.y);if(0===e)return!0;0>e||(d=!d)}}else if(a.y===g.y&&(h.x<=a.x&&a.x<=g.x||g.x<=a.x&&a.x<=h.x))return!0}return d}var e=Ya.isClockWise,f=this.subPaths;if(0===f.length)return[];if(!0===b)return c(f);b=[];if(1===f.length){var g=f[0];var h=new hb;h.curves=g.curves;b.push(h);return b}var k=!e(f[0].getPoints());k=a?!k:k;h=[];var l=[],q=[],n=0;l[n]=void 0;q[n]=[];for(var p=
0,t=f.length;p<t;p++){g=f[p];var r=g.getPoints();var v=e(r);(v=a?!v:v)?(!k&&l[n]&&n++,l[n]={s:new hb,p:r},l[n].s.curves=g.curves,k&&n++,q[n]=[]):q[n].push({h:g,p:r[0]})}if(!l[0])return c(f);if(1<l.length){p=!1;a=[];e=0;for(f=l.length;e<f;e++)h[e]=[];e=0;for(f=l.length;e<f;e++)for(g=q[e],v=0;v<g.length;v++){k=g[v];n=!0;for(r=0;r<l.length;r++)d(k.p,l[r].p)&&(e!==r&&a.push({froms:e,tos:r,hole:v}),n?(n=!1,h[r].push(k)):p=!0);n&&h[e].push(k)}0<a.length&&(p||(q=h))}p=0;for(e=l.length;p<e;p++)for(h=l[p].s,
b.push(h),a=q[p],f=0,g=a.length;f<g;f++)h.holes.push(a[f].h);return b}});Object.assign(fe.prototype,{isFont:!0,generateShapes:function(a,b){var c=b?b.size:null;c||(c=100);var d=[],e=this.data,f=Array.from?Array.from(a):String(a).split(""),g=c/e.resolution,h=(e.boundingBox.yMax-e.boundingBox.yMin+e.underlineThickness)*g;c=[];var k=0,l=0;if(b.justification){for(var q=0,n=a.length-1;0<=n&&(" "===a[n]&&q++," "===a[n]);n--);n=q*e.glyphs[" "].ha*g;b.justification.includes("L")&&(n=0);b.justification.includes("C")&&
(n*=.5);k-=n;for(n=q=0;n<a.length&&(" "===a[n]&&q++," "===a[n]);n++);n=q*e.glyphs[" "].ha*g;b.justification.includes("L")&&(n=0);b.justification.includes("C")&&(n*=.5);k-=n}for(n=0;n<f.length;n++){var p=f[n];if("\n"===p)k=0,l-=h;else{b=g;a=k;q=l;if(p=e.glyphs[p]||e.glyphs["?"]){var t=new ee;if(p.o)for(var r=p._cachedOutline||(p._cachedOutline=p.o.split(" ")),v=0,z=r.length;v<z;)switch(r[v++]){case "m":var x=r[v++]*b+a;var w=r[v++]*b+q;t.moveTo(x,w);break;case "l":x=r[v++]*b+a;w=r[v++]*b+q;t.lineTo(x,
w);break;case "q":var y=r[v++]*b+a;var A=r[v++]*b+q;var B=r[v++]*b+a;var C=r[v++]*b+q;t.quadraticCurveTo(B,C,y,A);break;case "b":y=r[v++]*b+a,A=r[v++]*b+q,B=r[v++]*b+a,C=r[v++]*b+q,x=r[v++]*b+a,w=r[v++]*b+q,t.bezierCurveTo(B,C,x,w,y,A)}b={offsetX:p.ha*b,path:t}}else b=void 0;k+=b.offsetX;c.push(b.path)}}e=0;for(f=c.length;e<f;e++)Array.prototype.push.apply(d,c[e].toShapes());return d}});Object.assign(kf.prototype,{load:function(a,b,c,d){var e=this,f=new Ja(this.manager);f.setPath(this.path);f.load(a,
function(a){try{var c=JSON.parse(a)}catch(k){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),c=JSON.parse(a.substring(65,a.length-2))}a=e.parse(c);b&&b(a)},c,d)},parse:function(a){return new fe(a)},setPath:function(a){this.path=a;return this}});var Pd,ie={getContext:function(){void 0===Pd&&(Pd=new (window.AudioContext||window.webkitAudioContext));return Pd},setContext:function(a){Pd=a}};Object.assign(ge.prototype,{load:function(a,b,c,d){var e=
new Ja(this.manager);e.setResponseType("arraybuffer");e.load(a,function(a){a=a.slice(0);ie.getContext().decodeAudioData(a,function(a){b(a)})},c,d)}});Object.assign(lf.prototype,{update:function(){var a,b,c,d,e,f,g,h,k=new I,l=new I;return function(m){if(a!==this||b!==m.focus||c!==m.fov||d!==m.aspect*this.aspect||e!==m.near||f!==m.far||g!==m.zoom||h!==this.eyeSep){a=this;b=m.focus;c=m.fov;d=m.aspect*this.aspect;e=m.near;f=m.far;g=m.zoom;var n=m.projectionMatrix.clone();h=this.eyeSep/2;var q=h*e/b,
p=e*Math.tan(Q.DEG2RAD*c*.5)/g;l.elements[12]=-h;k.elements[12]=h;var r=-p*d+q;var v=p*d+q;n.elements[0]=2*e/(v-r);n.elements[8]=(v+r)/(v-r);this.cameraL.projectionMatrix.copy(n);r=-p*d-q;v=p*d-q;n.elements[0]=2*e/(v-r);n.elements[8]=(v+r)/(v-r);this.cameraR.projectionMatrix.copy(n)}this.cameraL.matrixWorld.copy(m.matrixWorld).multiply(l);this.cameraR.matrixWorld.copy(m.matrixWorld).multiply(k)}}()});cd.prototype=Object.create(B.prototype);cd.prototype.constructor=cd;he.prototype=Object.assign(Object.create(B.prototype),
{constructor:he,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null);return this},getFilter:function(){return this.filter},setFilter:function(a){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination);this.filter=a;this.gain.connect(this.filter);
this.filter.connect(this.context.destination);return this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(a){this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01);return this},updateMatrixWorld:function(){var a=new p,b=new ia,c=new p,d=new p;return function(e){B.prototype.updateMatrixWorld.call(this,e);e=this.context.listener;var f=this.up;this.matrixWorld.decompose(a,b,c);d.set(0,0,-1).applyQuaternion(b);e.positionX?(e.positionX.setValueAtTime(a.x,this.context.currentTime),
e.positionY.setValueAtTime(a.y,this.context.currentTime),e.positionZ.setValueAtTime(a.z,this.context.currentTime),e.forwardX.setValueAtTime(d.x,this.context.currentTime),e.forwardY.setValueAtTime(d.y,this.context.currentTime),e.forwardZ.setValueAtTime(d.z,this.context.currentTime),e.upX.setValueAtTime(f.x,this.context.currentTime),e.upY.setValueAtTime(f.y,this.context.currentTime),e.upZ.setValueAtTime(f.z,this.context.currentTime)):(e.setPosition(a.x,a.y,a.z),e.setOrientation(d.x,d.y,d.z,f.x,f.y,
f.z))}}()});jc.prototype=Object.assign(Object.create(B.prototype),{constructor:jc,getOutput:function(){return this.gain},setNodeSource:function(a){this.hasPlaybackControl=!1;this.sourceType="audioNode";this.source=a;this.connect();return this},setMediaElementSource:function(a){this.hasPlaybackControl=!1;this.sourceType="mediaNode";this.source=this.context.createMediaElementSource(a);this.connect();return this},setBuffer:function(a){this.buffer=a;this.sourceType="buffer";this.autoplay&&this.play();
return this},play:function(){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else{var a=this.context.createBufferSource();a.buffer=this.buffer;a.loop=this.loop;a.onended=this.onEnded.bind(this);a.playbackRate.setValueAtTime(this.playbackRate,this.startTime);this.startTime=this.context.currentTime;a.start(this.startTime,this.offset);this.isPlaying=!0;this.source=a;return this.connect()}},
pause:function(){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return!0===this.isPlaying&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this},stop:function(){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this},connect:function(){if(0<
this.filters.length){this.source.connect(this.filters[0]);for(var a=1,b=this.filters.length;a<b;a++)this.filters[a-1].connect(this.filters[a]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var a=1,b=this.filters.length;a<b;a++)this.filters[a-1].disconnect(this.filters[a]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());
return this},getFilters:function(){return this.filters},setFilters:function(a){a||(a=[]);!0===this.isPlaying?(this.disconnect(),this.filters=a,this.connect()):this.filters=a;return this},getFilter:function(){return this.getFilters()[0]},setFilter:function(a){return this.setFilters(a?[a]:[])},setPlaybackRate:function(a){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return this.playbackRate=a,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,
this.context.currentTime),this},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(a){if(!1===this.hasPlaybackControl)console.warn("THREE.Audio: this Audio has no playback control.");else return this.loop=a,!0===this.isPlaying&&(this.source.loop=this.loop),this},getVolume:function(){return this.gain.gain.value},
setVolume:function(a){this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01);return this}});je.prototype=Object.assign(Object.create(jc.prototype),{constructor:je,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(a){this.panner.refDistance=a;return this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(a){this.panner.rolloffFactor=a;return this},getDistanceModel:function(){return this.panner.distanceModel},
setDistanceModel:function(a){this.panner.distanceModel=a;return this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(a){this.panner.maxDistance=a;return this},setDirectionalCone:function(a,b,c){this.panner.coneInnerAngle=a;this.panner.coneOuterAngle=b;this.panner.coneOuterGain=c;return this},updateMatrixWorld:function(){var a=new p,b=new ia,c=new p,d=new p;return function(e){B.prototype.updateMatrixWorld.call(this,e);e=this.panner;this.matrixWorld.decompose(a,b,
c);d.set(0,0,1).applyQuaternion(b);e.setPosition(a.x,a.y,a.z);e.setOrientation(d.x,d.y,d.z)}}()});Object.assign(ke.prototype,{getFrequencyData:function(){this.analyser.getByteFrequencyData(this.data);return this.data},getAverageFrequency:function(){for(var a=0,b=this.getFrequencyData(),c=0;c<b.length;c++)a+=b[c];return a/b.length}});Object.assign(le.prototype,{accumulate:function(a,b){var c=this.buffer,d=this.valueSize;a=a*d+d;var e=this.cumulativeWeight;if(0===e){for(e=0;e!==d;++e)c[a+e]=c[e];e=
b}else e+=b,this._mixBufferRegion(c,a,0,b/e,d);this.cumulativeWeight=e},apply:function(a){var b=this.valueSize,c=this.buffer;a=a*b+b;var d=this.cumulativeWeight,e=this.binding;this.cumulativeWeight=0;1>d&&this._mixBufferRegion(c,a,3*b,1-d,b);d=b;for(var f=b+b;d!==f;++d)if(c[d]!==c[d+b]){e.setValue(c,a);break}},saveOriginalState:function(){var a=this.buffer,b=this.valueSize,c=3*b;this.binding.getValue(a,c);for(var d=b;d!==c;++d)a[d]=a[c+d%b];this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,
3*this.valueSize)},_select:function(a,b,c,d,e){if(.5<=d)for(d=0;d!==e;++d)a[b+d]=a[c+d]},_slerp:function(a,b,c,d){ia.slerpFlat(a,b,a,b,a,c,d)},_lerp:function(a,b,c,d,e){for(var f=1-d,g=0;g!==e;++g){var h=b+g;a[h]=a[h]*f+a[c+g]*d}}});Object.assign(nf.prototype,{getValue:function(a,b){this.bind();var c=this._bindings[this._targetGroup.nCachedObjects_];void 0!==c&&c.getValue(a,b)},setValue:function(a,b){for(var c=this._bindings,d=this._targetGroup.nCachedObjects_,e=c.length;d!==e;++d)c[d].setValue(a,
b)},bind:function(){for(var a=this._bindings,b=this._targetGroup.nCachedObjects_,c=a.length;b!==c;++b)a[b].bind()},unbind:function(){for(var a=this._bindings,b=this._targetGroup.nCachedObjects_,c=a.length;b!==c;++b)a[b].unbind()}});Object.assign(Y,{Composite:nf,create:function(a,b,c){return a&&a.isAnimationObjectGroup?new Y.Composite(a,b,c):new Y(a,b,c)},sanitizeNodeName:function(){var a=/[\[\]\.:\/]/g;return function(b){return b.replace(/\s/g,"_").replace(a,"")}}(),parseTrackName:function(){var a=
"[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",b=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]");a=/(WCOD+)?/.source.replace("WCOD",a);var c=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),d=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),e=new RegExp("^"+b+a+c+d+"$"),f=["material","materials","bones"];return function(a){var b=e.exec(a);if(!b)throw Error("PropertyBinding: Cannot parse trackName: "+a);b={nodeName:b[2],objectName:b[3],objectIndex:b[4],propertyName:b[5],
propertyIndex:b[6]};var c=b.nodeName&&b.nodeName.lastIndexOf(".");if(void 0!==c&&-1!==c){var d=b.nodeName.substring(c+1);-1!==f.indexOf(d)&&(b.nodeName=b.nodeName.substring(0,c),b.objectName=d)}if(null===b.propertyName||0===b.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+a);return b}}(),findNode:function(a,b){if(!b||""===b||"root"===b||"."===b||-1===b||b===a.name||b===a.uuid)return a;if(a.skeleton){var c=a.skeleton.getBoneByName(b);if(void 0!==c)return c}if(a.children){var d=
function(a){for(var c=0;c<a.length;c++){var e=a[c];if(e.name===b||e.uuid===b||(e=d(e.children)))return e}return null};if(a=d(a.children))return a}return null}});Object.assign(Y.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(a,b){a[b]=this.node[this.propertyName]},function(a,b){for(var c=this.resolvedProperty,
d=0,e=c.length;d!==e;++d)a[b++]=c[d]},function(a,b){a[b]=this.resolvedProperty[this.propertyIndex]},function(a,b){this.resolvedProperty.toArray(a,b)}],SetterByBindingTypeAndVersioning:[[function(a,b){this.targetObject[this.propertyName]=a[b]},function(a,b){this.targetObject[this.propertyName]=a[b];this.targetObject.needsUpdate=!0},function(a,b){this.targetObject[this.propertyName]=a[b];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==
e;++d)c[d]=a[b++]},function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)c[d]=a[b++];this.targetObject.needsUpdate=!0},function(a,b){for(var c=this.resolvedProperty,d=0,e=c.length;d!==e;++d)c[d]=a[b++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(a,b){this.resolvedProperty[this.propertyIndex]=a[b]},function(a,b){this.resolvedProperty[this.propertyIndex]=a[b];this.targetObject.needsUpdate=!0},function(a,b){this.resolvedProperty[this.propertyIndex]=a[b];this.targetObject.matrixWorldNeedsUpdate=
!0}],[function(a,b){this.resolvedProperty.fromArray(a,b)},function(a,b){this.resolvedProperty.fromArray(a,b);this.targetObject.needsUpdate=!0},function(a,b){this.resolvedProperty.fromArray(a,b);this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(a,b){this.bind();this.getValue(a,b)},setValue:function(a,b){this.bind();this.setValue(a,b)},bind:function(){var a=this.node,b=this.parsedPath,c=b.objectName,d=b.propertyName,e=b.propertyIndex;a||(this.node=a=Y.findNode(this.rootNode,b.nodeName)||
this.rootNode);this.getValue=this._getValue_unavailable;this.setValue=this._setValue_unavailable;if(a){if(c){var f=b.objectIndex;switch(c){case "materials":if(!a.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!a.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}a=a.material.materials;break;case "bones":if(!a.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",
this);return}a=a.skeleton.bones;for(c=0;c<a.length;c++)if(a[c].name===f){f=c;break}break;default:if(void 0===a[c]){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}a=a[c]}if(void 0!==f){if(void 0===a[f]){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,a);return}a=a[f]}}f=a[d];if(void 0===f)console.error("THREE.PropertyBinding: Trying to update property for track: "+b.nodeName+"."+d+" but it wasn't found.",
a);else{b=this.Versioning.None;void 0!==a.needsUpdate?(b=this.Versioning.NeedsUpdate,this.targetObject=a):void 0!==a.matrixWorldNeedsUpdate&&(b=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=a);c=this.BindingType.Direct;if(void 0!==e){if("morphTargetInfluences"===d){if(!a.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(a.geometry.isBufferGeometry){if(!a.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",
this);return}for(c=0;c<this.node.geometry.morphAttributes.position.length;c++)if(a.geometry.morphAttributes.position[c].name===e){e=c;break}}else{if(!a.geometry.morphTargets){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);return}for(c=0;c<this.node.geometry.morphTargets.length;c++)if(a.geometry.morphTargets[c].name===e){e=c;break}}}c=this.BindingType.ArrayElement;this.resolvedProperty=f;this.propertyIndex=e}else void 0!==
f.fromArray&&void 0!==f.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=f):Array.isArray(f)?(c=this.BindingType.EntireArray,this.resolvedProperty=f):this.propertyName=d;this.getValue=this.GetterByBindingType[c];this.setValue=this.SetterByBindingTypeAndVersioning[c][b]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null;this.getValue=this._getValue_unbound;this.setValue=this._setValue_unbound}});
Object.assign(Y.prototype,{_getValue_unbound:Y.prototype.getValue,_setValue_unbound:Y.prototype.setValue});Object.assign(of.prototype,{isAnimationObjectGroup:!0,add:function(){for(var a=this._objects,b=a.length,c=this.nCachedObjects_,d=this._indicesByUUID,e=this._paths,f=this._parsedPaths,g=this._bindings,h=g.length,k=void 0,l=0,q=arguments.length;l!==q;++l){var n=arguments[l],p=n.uuid,t=d[p];if(void 0===t){t=b++;d[p]=t;a.push(n);p=0;for(var r=h;p!==r;++p)g[p].push(new Y(n,e[p],f[p]))}else if(t<c){k=
a[t];var v=--c;r=a[v];d[r.uuid]=t;a[t]=r;d[p]=v;a[v]=n;p=0;for(r=h;p!==r;++p){var z=g[p],x=z[t];z[t]=z[v];void 0===x&&(x=new Y(n,e[p],f[p]));z[v]=x}}else a[t]!==k&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c},remove:function(){for(var a=this._objects,b=this.nCachedObjects_,c=this._indicesByUUID,d=this._bindings,e=d.length,f=0,g=arguments.length;f!==g;++f){var h=
arguments[f],k=h.uuid,l=c[k];if(void 0!==l&&l>=b){var p=b++,n=a[p];c[n.uuid]=l;a[l]=n;c[k]=p;a[p]=h;h=0;for(k=e;h!==k;++h){n=d[h];var u=n[l];n[l]=n[p];n[p]=u}}}this.nCachedObjects_=b},uncache:function(){for(var a=this._objects,b=a.length,c=this.nCachedObjects_,d=this._indicesByUUID,e=this._bindings,f=e.length,g=0,h=arguments.length;g!==h;++g){var k=arguments[g].uuid,l=d[k];if(void 0!==l)if(delete d[k],l<c){k=--c;var p=a[k],n=--b,u=a[n];d[p.uuid]=l;a[l]=p;d[u.uuid]=k;a[k]=u;a.pop();p=0;for(u=f;p!==
u;++p){var t=e[p],r=t[n];t[l]=t[k];t[k]=r;t.pop()}}else for(n=--b,u=a[n],d[u.uuid]=l,a[l]=u,a.pop(),p=0,u=f;p!==u;++p)t=e[p],t[l]=t[n],t.pop()}this.nCachedObjects_=c},subscribe_:function(a,b){var c=this._bindingsIndicesByPath,d=c[a],e=this._bindings;if(void 0!==d)return e[d];var f=this._paths,g=this._parsedPaths,h=this._objects,k=this.nCachedObjects_,l=Array(h.length);d=e.length;c[a]=d;f.push(a);g.push(b);e.push(l);c=k;for(d=h.length;c!==d;++c)l[c]=new Y(h[c],a,b);return l},unsubscribe_:function(a){var b=
this._bindingsIndicesByPath,c=b[a];if(void 0!==c){var d=this._paths,e=this._parsedPaths,f=this._bindings,g=f.length-1,h=f[g];b[a[g]]=c;f[c]=h;f.pop();e[c]=e[g];e.pop();d[c]=d[g];d.pop()}}});Object.assign(pf.prototype,{play:function(){this._mixer._activateAction(this);return this},stop:function(){this._mixer._deactivateAction(this);return this.reset()},reset:function(){this.paused=!1;this.enabled=!0;this.time=0;this._loopCount=-1;this._startTime=null;return this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&
!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(a){this._startTime=a;return this},setLoop:function(a,b){this.loop=a;this.repetitions=b;return this},setEffectiveWeight:function(a){this.weight=a;this._effectiveWeight=this.enabled?a:0;return this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(a){return this._scheduleFading(a,0,1)},fadeOut:function(a){return this._scheduleFading(a,
1,0)},crossFadeFrom:function(a,b,c){a.fadeOut(b);this.fadeIn(b);if(c){c=this._clip.duration;var d=a._clip.duration,e=c/d;a.warp(1,d/c,b);this.warp(e,1,b)}return this},crossFadeTo:function(a,b,c){return a.crossFadeFrom(this,b,c)},stopFading:function(){var a=this._weightInterpolant;null!==a&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(a));return this},setEffectiveTimeScale:function(a){this.timeScale=a;this._effectiveTimeScale=this.paused?0:a;return this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},
setDuration:function(a){this.timeScale=this._clip.duration/a;return this.stopWarping()},syncWith:function(a){this.time=a.time;this.timeScale=a.timeScale;return this.stopWarping()},halt:function(a){return this.warp(this._effectiveTimeScale,0,a)},warp:function(a,b,c){var d=this._mixer,e=d.time,f=this._timeScaleInterpolant,g=this.timeScale;null===f&&(this._timeScaleInterpolant=f=d._lendControlInterpolant());d=f.parameterPositions;f=f.sampleValues;d[0]=e;d[1]=e+c;f[0]=a/g;f[1]=b/g;return this},stopWarping:function(){var a=
this._timeScaleInterpolant;null!==a&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(a));return this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(a,b,c,d){if(this.enabled){var e=this._startTime;if(null!==e){b=(a-e)*c;if(0>b||0===c)return;this._startTime=null;b*=c}b*=this._updateTimeScale(a);c=this._updateTime(b);a=this._updateWeight(a);if(0<a){b=this._interpolants;
e=this._propertyBindings;for(var f=0,g=b.length;f!==g;++f)b[f].evaluate(c),e[f].accumulate(d,a)}}else this._updateWeight(a)},_updateWeight:function(a){var b=0;if(this.enabled){b=this.weight;var c=this._weightInterpolant;if(null!==c){var d=c.evaluate(a)[0];b*=d;a>c.parameterPositions[1]&&(this.stopFading(),0===d&&(this.enabled=!1))}}return this._effectiveWeight=b},_updateTimeScale:function(a){var b=0;if(!this.paused){b=this.timeScale;var c=this._timeScaleInterpolant;if(null!==c){var d=c.evaluate(a)[0];
b*=d;a>c.parameterPositions[1]&&(this.stopWarping(),0===b?this.paused=!0:this.timeScale=b)}}return this._effectiveTimeScale=b},_updateTime:function(a){var b=this.time+a,c=this._clip.duration,d=this.loop,e=this._loopCount,f=2202===d;if(0===a)return-1===e?b:f&&1===(e&1)?c-b:b;if(2200===d)a:{if(-1===e&&(this._loopCount=0,this._setEndings(!0,!0,!1)),b>=c)b=c;else if(0>b)b=0;else break a;this.clampWhenFinished?this.paused=!0:this.enabled=!1;this._mixer.dispatchEvent({type:"finished",action:this,direction:0>
a?-1:1})}else{-1===e&&(0<=a?(e=0,this._setEndings(!0,0===this.repetitions,f)):this._setEndings(0===this.repetitions,!0,f));if(b>=c||0>b){d=Math.floor(b/c);b-=c*d;e+=Math.abs(d);var g=this.repetitions-e;0>=g?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,b=0<a?c:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<a?1:-1})):(1===g?(a=0>a,this._setEndings(a,!a,f)):this._setEndings(!1,!1,f),this._loopCount=e,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:d}))}if(f&&
1===(e&1))return this.time=b,c-b}return this.time=b},_setEndings:function(a,b,c){var d=this._interpolantSettings;c?(d.endingStart=2401,d.endingEnd=2401):(d.endingStart=a?this.zeroSlopeAtStart?2401:2400:2402,d.endingEnd=b?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(a,b,c){var d=this._mixer,e=d.time,f=this._weightInterpolant;null===f&&(this._weightInterpolant=f=d._lendControlInterpolant());d=f.parameterPositions;f=f.sampleValues;d[0]=e;f[0]=b;d[1]=e+a;f[1]=c;return this}});me.prototype=
Object.assign(Object.create(ib.prototype),{constructor:me,_bindAction:function(a,b){var c=a._localRoot||this._root,d=a._clip.tracks,e=d.length,f=a._propertyBindings;a=a._interpolants;var g=c.uuid,h=this._bindingsByRootAndName,k=h[g];void 0===k&&(k={},h[g]=k);for(h=0;h!==e;++h){var l=d[h],p=l.name,n=k[p];if(void 0===n){n=f[h];if(void 0!==n){null===n._cacheIndex&&(++n.referenceCount,this._addInactiveBinding(n,g,p));continue}n=new le(Y.create(c,p,b&&b._propertyBindings[h].binding.parsedPath),l.ValueTypeName,
l.getValueSize());++n.referenceCount;this._addInactiveBinding(n,g,p)}f[h]=n;a[h].resultBuffer=n.buffer}},_activateAction:function(a){if(!this._isActiveAction(a)){if(null===a._cacheIndex){var b=(a._localRoot||this._root).uuid,c=a._clip.uuid,d=this._actionsByClip[c];this._bindAction(a,d&&d.knownActions[0]);this._addInactiveAction(a,c,b)}b=a._propertyBindings;c=0;for(d=b.length;c!==d;++c){var e=b[c];0===e.useCount++&&(this._lendBinding(e),e.saveOriginalState())}this._lendAction(a)}},_deactivateAction:function(a){if(this._isActiveAction(a)){for(var b=
a._propertyBindings,c=0,d=b.length;c!==d;++c){var e=b[c];0===--e.useCount&&(e.restoreOriginalState(),this._takeBackBinding(e))}this._takeBackAction(a)}},_initMemoryManager:function(){this._actions=[];this._nActiveActions=0;this._actionsByClip={};this._bindings=[];this._nActiveBindings=0;this._bindingsByRootAndName={};this._controlInterpolants=[];this._nActiveControlInterpolants=0;var a=this;this.stats={actions:{get total(){return a._actions.length},get inUse(){return a._nActiveActions}},bindings:{get total(){return a._bindings.length},
get inUse(){return a._nActiveBindings}},controlInterpolants:{get total(){return a._controlInterpolants.length},get inUse(){return a._nActiveControlInterpolants}}}},_isActiveAction:function(a){a=a._cacheIndex;return null!==a&&a<this._nActiveActions},_addInactiveAction:function(a,b,c){var d=this._actions,e=this._actionsByClip,f=e[b];void 0===f?(f={knownActions:[a],actionByRoot:{}},a._byClipCacheIndex=0,e[b]=f):(b=f.knownActions,a._byClipCacheIndex=b.length,b.push(a));a._cacheIndex=d.length;d.push(a);
f.actionByRoot[c]=a},_removeInactiveAction:function(a){var b=this._actions,c=b[b.length-1],d=a._cacheIndex;c._cacheIndex=d;b[d]=c;b.pop();a._cacheIndex=null;b=a._clip.uuid;c=this._actionsByClip;d=c[b];var e=d.knownActions,f=e[e.length-1],g=a._byClipCacheIndex;f._byClipCacheIndex=g;e[g]=f;e.pop();a._byClipCacheIndex=null;delete d.actionByRoot[(a._localRoot||this._root).uuid];0===e.length&&delete c[b];this._removeInactiveBindingsForAction(a)},_removeInactiveBindingsForAction:function(a){a=a._propertyBindings;
for(var b=0,c=a.length;b!==c;++b){var d=a[b];0===--d.referenceCount&&this._removeInactiveBinding(d)}},_lendAction:function(a){var b=this._actions,c=a._cacheIndex,d=this._nActiveActions++,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e},_takeBackAction:function(a){var b=this._actions,c=a._cacheIndex,d=--this._nActiveActions,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e},_addInactiveBinding:function(a,b,c){var d=this._bindingsByRootAndName,e=d[b],f=this._bindings;void 0===e&&(e={},d[b]=
e);e[c]=a;a._cacheIndex=f.length;f.push(a)},_removeInactiveBinding:function(a){var b=this._bindings,c=a.binding,d=c.rootNode.uuid;c=c.path;var e=this._bindingsByRootAndName,f=e[d],g=b[b.length-1];a=a._cacheIndex;g._cacheIndex=a;b[a]=g;b.pop();delete f[c];a:{for(var h in f)break a;delete e[d]}},_lendBinding:function(a){var b=this._bindings,c=a._cacheIndex,d=this._nActiveBindings++,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e},_takeBackBinding:function(a){var b=this._bindings,c=a._cacheIndex,
d=--this._nActiveBindings,e=b[d];a._cacheIndex=d;b[d]=a;e._cacheIndex=c;b[c]=e},_lendControlInterpolant:function(){var a=this._controlInterpolants,b=this._nActiveControlInterpolants++,c=a[b];void 0===c&&(c=new ad(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),c.__cacheIndex=b,a[b]=c);return c},_takeBackControlInterpolant:function(a){var b=this._controlInterpolants,c=a.__cacheIndex,d=--this._nActiveControlInterpolants,e=b[d];a.__cacheIndex=d;b[d]=a;e.__cacheIndex=
c;b[c]=e},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(a,b){var c=b||this._root,d=c.uuid;c="string"===typeof a?Ca.findByName(c,a):a;a=null!==c?c.uuid:a;var e=this._actionsByClip[a],f=null;if(void 0!==e){f=e.actionByRoot[d];if(void 0!==f)return f;f=e.knownActions[0];null===c&&(c=f._clip)}if(null===c)return null;b=new pf(this,c,b);this._bindAction(b,f);this._addInactiveAction(b,a,d);return b},existingAction:function(a,b){var c=b||this._root;b=c.uuid;c="string"===typeof a?
Ca.findByName(c,a):a;a=this._actionsByClip[c?c.uuid:a];return void 0!==a?a.actionByRoot[b]||null:null},stopAllAction:function(){for(var a=this._actions,b=this._nActiveActions,c=this._bindings,d=this._nActiveBindings,e=this._nActiveBindings=this._nActiveActions=0;e!==b;++e)a[e].reset();for(e=0;e!==d;++e)c[e].useCount=0;return this},update:function(a){a*=this.timeScale;for(var b=this._actions,c=this._nActiveActions,d=this.time+=a,e=Math.sign(a),f=this._accuIndex^=1,g=0;g!==c;++g)b[g]._update(d,a,e,
f);a=this._bindings;b=this._nActiveBindings;for(g=0;g!==b;++g)a[g].apply(f);return this},getRoot:function(){return this._root},uncacheClip:function(a){var b=this._actions;a=a.uuid;var c=this._actionsByClip,d=c[a];if(void 0!==d){d=d.knownActions;for(var e=0,f=d.length;e!==f;++e){var g=d[e];this._deactivateAction(g);var h=g._cacheIndex,k=b[b.length-1];g._cacheIndex=null;g._byClipCacheIndex=null;k._cacheIndex=h;b[h]=k;b.pop();this._removeInactiveBindingsForAction(g)}delete c[a]}},uncacheRoot:function(a){a=
a.uuid;var b=this._actionsByClip;for(d in b){var c=b[d].actionByRoot[a];void 0!==c&&(this._deactivateAction(c),this._removeInactiveAction(c))}var d=this._bindingsByRootAndName[a];if(void 0!==d)for(var e in d)a=d[e],a.restoreOriginalState(),this._removeInactiveBinding(a)},uncacheAction:function(a,b){a=this.existingAction(a,b);null!==a&&(this._deactivateAction(a),this._removeInactiveAction(a))}});Jd.prototype.clone=function(){return new Jd(void 0===this.value.clone?this.value:this.value.clone())};ne.prototype=
Object.assign(Object.create(E.prototype),{constructor:ne,isInstancedBufferGeometry:!0,copy:function(a){E.prototype.copy.call(this,a);this.maxInstancedCount=a.maxInstancedCount;return this},clone:function(){return(new this.constructor).copy(this)}});oe.prototype=Object.assign(Object.create(sb.prototype),{constructor:oe,isInstancedInterleavedBuffer:!0,copy:function(a){sb.prototype.copy.call(this,a);this.meshPerAttribute=a.meshPerAttribute;return this}});pe.prototype=Object.assign(Object.create(P.prototype),
{constructor:pe,isInstancedBufferAttribute:!0,copy:function(a){P.prototype.copy.call(this,a);this.meshPerAttribute=a.meshPerAttribute;return this}});Object.assign(qf.prototype,{linePrecision:1,set:function(a,b){this.ray.set(a,b)},setFromCamera:function(a,b){b&&b.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(b.matrixWorld),this.ray.direction.set(a.x,a.y,.5).unproject(b).sub(this.ray.origin).normalize()):b&&b.isOrthographicCamera?(this.ray.origin.set(a.x,a.y,(b.near+b.far)/(b.near-b.far)).unproject(b),
this.ray.direction.set(0,0,-1).transformDirection(b.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(a,b,c){c=c||[];qe(a,this,c,b);c.sort(rf);return c},intersectObjects:function(a,b,c){c=c||[];if(!1===Array.isArray(a))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),c;for(var d=0,e=a.length;d<e;d++)qe(a[d],this,c,b);c.sort(rf);return c}});Object.assign(sf.prototype,{start:function(){this.oldTime=this.startTime=("undefined"===
typeof performance?Date:performance).now();this.elapsedTime=0;this.running=!0},stop:function(){this.getElapsedTime();this.autoStart=this.running=!1},getElapsedTime:function(){this.getDelta();return this.elapsedTime},getDelta:function(){var a=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var b=("undefined"===typeof performance?Date:performance).now();a=(b-this.oldTime)/1E3;this.oldTime=b;this.elapsedTime+=a}return a}});Object.assign(tf.prototype,{set:function(a,b,c){this.radius=
a;this.phi=b;this.theta=c;return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.radius=a.radius;this.phi=a.phi;this.theta=a.theta;return this},makeSafe:function(){this.phi=Math.max(1E-6,Math.min(Math.PI-1E-6,this.phi));return this},setFromVector3:function(a){this.radius=a.length();0===this.radius?this.phi=this.theta=0:(this.theta=Math.atan2(a.x,a.z),this.phi=Math.acos(Q.clamp(a.y/this.radius,-1,1)));return this}});Object.assign(uf.prototype,{set:function(a,b,
c){this.radius=a;this.theta=b;this.y=c;return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.radius=a.radius;this.theta=a.theta;this.y=a.y;return this},setFromVector3:function(a){this.radius=Math.sqrt(a.x*a.x+a.z*a.z);this.theta=Math.atan2(a.x,a.z);this.y=a.y;return this}});Object.assign(re.prototype,{set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);
return this},setFromCenterAndSize:function(){var a=new C;return function(b,c){c=a.copy(c).multiplyScalar(.5);this.min.copy(b).sub(c);this.max.copy(b).add(c);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(a){void 0===
a&&(console.warn("THREE.Box2: .getCenter() target is now required"),a=new C);return this.isEmpty()?a.set(0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(a){void 0===a&&(console.warn("THREE.Box2: .getSize() target is now required"),a=new C);return this.isEmpty()?a.set(0,0):a.subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);
this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y},getParameter:function(a,b){void 0===b&&(console.warn("THREE.Box2: .getParameter() target is now required"),b=new C);return b.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(a){return a.max.x<
this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y?!1:!0},clampPoint:function(a,b){void 0===b&&(console.warn("THREE.Box2: .clampPoint() target is now required"),b=new C);return b.copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new C;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},translate:function(a){this.min.add(a);
this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)}});Object.assign(se.prototype,{set:function(a,b){this.start.copy(a);this.end.copy(b);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.start.copy(a.start);this.end.copy(a.end);return this},getCenter:function(a){void 0===a&&(console.warn("THREE.Line3: .getCenter() target is now required"),a=new p);return a.addVectors(this.start,this.end).multiplyScalar(.5)},
delta:function(a){void 0===a&&(console.warn("THREE.Line3: .delta() target is now required"),a=new p);return a.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(a,b){void 0===b&&(console.warn("THREE.Line3: .at() target is now required"),b=new p);return this.delta(b).multiplyScalar(a).add(this.start)},closestPointToPointParameter:function(){var a=new p,b=new p;return function(c,
d){a.subVectors(c,this.start);b.subVectors(this.end,this.start);c=b.dot(b);c=b.dot(a)/c;d&&(c=Q.clamp(c,0,1));return c}}(),closestPointToPoint:function(a,b,c){a=this.closestPointToPointParameter(a,b);void 0===c&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),c=new p);return this.delta(c).multiplyScalar(a).add(this.start)},applyMatrix4:function(a){this.start.applyMatrix4(a);this.end.applyMatrix4(a);return this},equals:function(a){return a.start.equals(this.start)&&a.end.equals(this.end)}});
dd.prototype=Object.create(B.prototype);dd.prototype.constructor=dd;dd.prototype.isImmediateRenderObject=!0;ed.prototype=Object.create(W.prototype);ed.prototype.constructor=ed;ed.prototype.update=function(){var a=new p,b=new p,c=new la;return function(){var d=["a","b","c"];this.object.updateMatrixWorld(!0);c.getNormalMatrix(this.object.matrixWorld);var e=this.object.matrixWorld,f=this.geometry.attributes.position,g=this.object.geometry;if(g&&g.isGeometry)for(var h=g.vertices,k=g.faces,l=g=0,p=k.length;l<
p;l++)for(var n=k[l],u=0,t=n.vertexNormals.length;u<t;u++){var r=n.vertexNormals[u];a.copy(h[n[d[u]]]).applyMatrix4(e);b.copy(r).applyMatrix3(c).normalize().multiplyScalar(this.size).add(a);f.setXYZ(g,a.x,a.y,a.z);g+=1;f.setXYZ(g,b.x,b.y,b.z);g+=1}else if(g&&g.isBufferGeometry)for(d=g.attributes.position,h=g.attributes.normal,u=g=0,t=d.count;u<t;u++)a.set(d.getX(u),d.getY(u),d.getZ(u)).applyMatrix4(e),b.set(h.getX(u),h.getY(u),h.getZ(u)),b.applyMatrix3(c).normalize().multiplyScalar(this.size).add(a),
f.setXYZ(g,a.x,a.y,a.z),g+=1,f.setXYZ(g,b.x,b.y,b.z),g+=1;f.needsUpdate=!0}}();kc.prototype=Object.create(B.prototype);kc.prototype.constructor=kc;kc.prototype.dispose=function(){this.cone.geometry.dispose();this.cone.material.dispose()};kc.prototype.update=function(){var a=new p,b=new p;return function(){this.light.updateMatrixWorld();var c=this.light.distance?this.light.distance:1E3,d=c*Math.tan(this.light.angle);this.cone.scale.set(d,d,c);a.setFromMatrixPosition(this.light.matrixWorld);b.setFromMatrixPosition(this.light.target.matrixWorld);
this.cone.lookAt(b.sub(a));void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}();lc.prototype=Object.create(W.prototype);lc.prototype.constructor=lc;lc.prototype.updateMatrixWorld=function(){var a=new p,b=new I,c=new I;return function(d){var e=this.bones,f=this.geometry,g=f.getAttribute("position");c.getInverse(this.root.matrixWorld);for(var h=0,k=0;h<e.length;h++){var l=e[h];l.parent&&l.parent.isBone&&(b.multiplyMatrices(c,l.matrixWorld),
a.setFromMatrixPosition(b),g.setXYZ(k,a.x,a.y,a.z),b.multiplyMatrices(c,l.parent.matrixWorld),a.setFromMatrixPosition(b),g.setXYZ(k+1,a.x,a.y,a.z),k+=2)}f.getAttribute("position").needsUpdate=!0;B.prototype.updateMatrixWorld.call(this,d)}}();mc.prototype=Object.create(ra.prototype);mc.prototype.constructor=mc;mc.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};mc.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};
nc.prototype=Object.create(B.prototype);nc.prototype.constructor=nc;nc.prototype.dispose=function(){this.children[0].geometry.dispose();this.children[0].material.dispose()};nc.prototype.update=function(){var a=.5*this.light.width,b=.5*this.light.height,c=this.line.geometry.attributes.position,d=c.array;d[0]=a;d[1]=-b;d[2]=0;d[3]=a;d[4]=b;d[5]=0;d[6]=-a;d[7]=b;d[8]=0;d[9]=-a;d[10]=-b;d[11]=0;d[12]=a;d[13]=-b;d[14]=0;c.needsUpdate=!0;void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)};
oc.prototype=Object.create(B.prototype);oc.prototype.constructor=oc;oc.prototype.dispose=function(){this.children[0].geometry.dispose();this.children[0].material.dispose()};oc.prototype.update=function(){var a=new p,b=new G,c=new G;return function(){var d=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var e=d.geometry.getAttribute("color");b.copy(this.light.color);c.copy(this.light.groundColor);for(var f=0,g=e.count;f<g;f++){var h=f<g/2?b:c;e.setXYZ(f,h.r,h.g,h.b)}e.needsUpdate=
!0}d.lookAt(a.setFromMatrixPosition(this.light.matrixWorld).negate())}}();fd.prototype=Object.create(W.prototype);fd.prototype.constructor=fd;Kd.prototype=Object.create(W.prototype);Kd.prototype.constructor=Kd;gd.prototype=Object.create(W.prototype);gd.prototype.constructor=gd;gd.prototype.update=function(){var a=new p,b=new p,c=new la;return function(){this.object.updateMatrixWorld(!0);c.getNormalMatrix(this.object.matrixWorld);var d=this.object.matrixWorld,e=this.geometry.attributes.position,f=
this.object.geometry,g=f.vertices;f=f.faces;for(var h=0,k=0,l=f.length;k<l;k++){var p=f[k],n=p.normal;a.copy(g[p.a]).add(g[p.b]).add(g[p.c]).divideScalar(3).applyMatrix4(d);b.copy(n).applyMatrix3(c).normalize().multiplyScalar(this.size).add(a);e.setXYZ(h,a.x,a.y,a.z);h+=1;e.setXYZ(h,b.x,b.y,b.z);h+=1}e.needsUpdate=!0}}();pc.prototype=Object.create(B.prototype);pc.prototype.constructor=pc;pc.prototype.dispose=function(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();this.targetLine.geometry.dispose();
this.targetLine.material.dispose()};pc.prototype.update=function(){var a=new p,b=new p,c=new p;return function(){a.setFromMatrixPosition(this.light.matrixWorld);b.setFromMatrixPosition(this.light.target.matrixWorld);c.subVectors(b,a);this.lightPlane.lookAt(c);void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color));this.targetLine.lookAt(c);
this.targetLine.scale.z=c.length()}}();hd.prototype=Object.create(W.prototype);hd.prototype.constructor=hd;hd.prototype.update=function(){function a(a,g,h,k){d.set(g,h,k).unproject(e);a=c[a];if(void 0!==a)for(g=b.getAttribute("position"),h=0,k=a.length;h<k;h++)g.setXYZ(a[h],d.x,d.y,d.z)}var b,c,d=new p,e=new Qa;return function(){b=this.geometry;c=this.pointMap;e.projectionMatrix.copy(this.camera.projectionMatrix);a("c",0,0,-1);a("t",0,0,1);a("n1",-1,-1,-1);a("n2",1,-1,-1);a("n3",-1,1,-1);a("n4",1,
1,-1);a("f1",-1,-1,1);a("f2",1,-1,1);a("f3",-1,1,1);a("f4",1,1,1);a("u1",.7,1.1,-1);a("u2",-.7,1.1,-1);a("u3",0,2,-1);a("cf1",-1,0,1);a("cf2",1,0,1);a("cf3",0,-1,1);a("cf4",0,1,1);a("cn1",-1,0,-1);a("cn2",1,0,-1);a("cn3",0,-1,-1);a("cn4",0,1,-1);b.getAttribute("position").needsUpdate=!0}}();Hb.prototype=Object.create(W.prototype);Hb.prototype.constructor=Hb;Hb.prototype.update=function(){var a=new Va;return function(b){void 0!==b&&console.warn("THREE.BoxHelper: .update() has no longer arguments.");
void 0!==this.object&&a.setFromObject(this.object);if(!a.isEmpty()){b=a.min;var c=a.max,d=this.geometry.attributes.position,e=d.array;e[0]=c.x;e[1]=c.y;e[2]=c.z;e[3]=b.x;e[4]=c.y;e[5]=c.z;e[6]=b.x;e[7]=b.y;e[8]=c.z;e[9]=c.x;e[10]=b.y;e[11]=c.z;e[12]=c.x;e[13]=c.y;e[14]=b.z;e[15]=b.x;e[16]=c.y;e[17]=b.z;e[18]=b.x;e[19]=b.y;e[20]=b.z;e[21]=c.x;e[22]=b.y;e[23]=b.z;d.needsUpdate=!0;this.geometry.computeBoundingSphere()}}}();Hb.prototype.setFromObject=function(a){this.object=a;this.update();return this};
id.prototype=Object.create(W.prototype);id.prototype.constructor=id;id.prototype.updateMatrixWorld=function(a){var b=this.box;b.isEmpty()||(b.getCenter(this.position),b.getSize(this.scale),this.scale.multiplyScalar(.5),B.prototype.updateMatrixWorld.call(this,a))};jd.prototype=Object.create(ma.prototype);jd.prototype.constructor=jd;jd.prototype.updateMatrixWorld=function(a){var b=-this.plane.constant;1E-8>Math.abs(b)&&(b=1E-8);this.scale.set(.5*this.size,.5*this.size,b);this.children[0].material.side=
0>b?1:0;this.lookAt(this.plane.normal);B.prototype.updateMatrixWorld.call(this,a)};var Ld,te;Ib.prototype=Object.create(B.prototype);Ib.prototype.constructor=Ib;Ib.prototype.setDirection=function(){var a=new p,b;return function(c){.99999<c.y?this.quaternion.set(0,0,0,1):-.99999>c.y?this.quaternion.set(1,0,0,0):(a.set(c.z,0,-c.x).normalize(),b=Math.acos(c.y),this.quaternion.setFromAxisAngle(a,b))}}();Ib.prototype.setLength=function(a,b,c){void 0===b&&(b=.2*a);void 0===c&&(c=.2*b);this.line.scale.set(1,
Math.max(0,a-b),1);this.line.updateMatrix();this.cone.scale.set(c,b,c);this.cone.position.y=a;this.cone.updateMatrix()};Ib.prototype.setColor=function(a){this.line.material.color.copy(a);this.cone.material.color.copy(a)};kd.prototype=Object.create(W.prototype);kd.prototype.constructor=kd;L.create=function(a,b){console.log("THREE.Curve.create() has been deprecated");a.prototype=Object.create(L.prototype);a.prototype.constructor=a;a.prototype.getPoint=b;return a};Object.assign($a.prototype,{createPointsGeometry:function(a){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");
a=this.getPoints(a);return this.createGeometry(a)},createSpacedPointsGeometry:function(a){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");a=this.getSpacedPoints(a);return this.createGeometry(a)},createGeometry:function(a){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var b=new K,c=0,d=a.length;c<d;c++){var e=a[c];b.vertices.push(new p(e.x,
e.y,e.z||0))}return b}});Object.assign(Oa.prototype,{fromPoints:function(a){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints().");this.setFromPoints(a)}});wf.prototype=Object.create(wa.prototype);xf.prototype=Object.create(wa.prototype);ue.prototype=Object.create(wa.prototype);Object.assign(ue.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},
reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}});fd.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")};lc.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};Object.assign(ic.prototype,{extractUrlBase:function(a){console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead.");
return ze.extractUrlBase(a)}});Object.assign(re.prototype,{center:function(a){console.warn("THREE.Box2: .center() has been renamed to .getCenter().");return this.getCenter(a)},empty:function(){console.warn("THREE.Box2: .empty() has been renamed to .isEmpty().");return this.isEmpty()},isIntersectionBox:function(a){console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(a)},size:function(a){console.warn("THREE.Box2: .size() has been renamed to .getSize().");
return this.getSize(a)}});Object.assign(Va.prototype,{center:function(a){console.warn("THREE.Box3: .center() has been renamed to .getCenter().");return this.getCenter(a)},empty:function(){console.warn("THREE.Box3: .empty() has been renamed to .isEmpty().");return this.isEmpty()},isIntersectionBox:function(a){console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(a)},isIntersectionSphere:function(a){console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere().");
return this.intersectsSphere(a)},size:function(a){console.warn("THREE.Box3: .size() has been renamed to .getSize().");return this.getSize(a)}});se.prototype.center=function(a){console.warn("THREE.Line3: .center() has been renamed to .getCenter().");return this.getCenter(a)};Object.assign(Q,{random16:function(){console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead.");return Math.random()},nearestPowerOfTwo:function(a){console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo().");
return Q.floorPowerOfTwo(a)},nextPowerOfTwo:function(a){console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo().");return Q.ceilPowerOfTwo(a)}});Object.assign(la.prototype,{flattenToArrayOffset:function(a,b){console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.");return this.toArray(a,b)},multiplyVector3:function(a){console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return a.applyMatrix3(this)},
multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(a){console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.");return this.applyToBufferAttribute(a)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}});Object.assign(I.prototype,{extractPosition:function(a){console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().");
return this.copyPosition(a)},flattenToArrayOffset:function(a,b){console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.");return this.toArray(a,b)},getPosition:function(){var a;return function(){void 0===a&&(a=new p);console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");return a.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(a){console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().");
return this.makeRotationFromQuaternion(a)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(a){console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},multiplyVector4:function(a){console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},
rotateAxis:function(a){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");a.transformDirection(this)},crossVector:function(a){console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},
rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(a){console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.");return this.applyToBufferAttribute(a)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(a,b,c,d,e,f){console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead.");
return this.makePerspective(a,b,d,c,e,f)}});Pa.prototype.isIntersectionLine=function(a){console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine().");return this.intersectsLine(a)};ia.prototype.multiplyVector3=function(a){console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return a.applyQuaternion(this)};Object.assign(qb.prototype,{isIntersectionBox:function(a){console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox().");
return this.intersectsBox(a)},isIntersectionPlane:function(a){console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane().");return this.intersectsPlane(a)},isIntersectionSphere:function(a){console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere().");return this.intersectsSphere(a)}});Object.assign(Ba.prototype,{area:function(){console.warn("THREE.Triangle: .area() has been renamed to .getArea().");return this.getArea()},barycoordFromPoint:function(a,
b){console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().");return this.getBarycoord(a,b)},midpoint:function(a){console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint().");return this.getMidpoint(a)},normal:function(a){console.warn("THREE.Triangle: .normal() has been renamed to .getNormal().");return this.getNormal(a)},plane:function(a){console.warn("THREE.Triangle: .plane() has been renamed to .getPlane().");return this.getPlane(a)}});Object.assign(Ba,
{barycoordFromPoint:function(a,b,c,d,e){console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord().");return Ba.getBarycoord(a,b,c,d,e)},normal:function(a,b,c,d){console.warn("THREE.Triangle: .normal() has been renamed to .getNormal().");return Ba.getNormal(a,b,c,d)}});Object.assign(hb.prototype,{extractAllPoints:function(a){console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead.");return this.extractPoints(a)},extrude:function(a){console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead.");
return new vb(this,a)},makeGeometry:function(a){console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead.");return new xb(this,a)}});Object.assign(C.prototype,{fromAttribute:function(a,b,c){console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute().");return this.fromBufferAttribute(a,b,c)},distanceToManhattan:function(a){console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo().");return this.manhattanDistanceTo(a)},
lengthManhattan:function(){console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength().");return this.manhattanLength()}});Object.assign(p.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(a){console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().");
return this.setFromMatrixPosition(a)},getScaleFromMatrix:function(a){console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().");return this.setFromMatrixScale(a)},getColumnFromMatrix:function(a,b){console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().");return this.setFromMatrixColumn(b,a)},applyProjection:function(a){console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead.");return this.applyMatrix4(a)},
fromAttribute:function(a,b,c){console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute().");return this.fromBufferAttribute(a,b,c)},distanceToManhattan:function(a){console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo().");return this.manhattanDistanceTo(a)},lengthManhattan:function(){console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength().");return this.manhattanLength()}});Object.assign(ca.prototype,
{fromAttribute:function(a,b,c){console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute().");return this.fromBufferAttribute(a,b,c)},lengthManhattan:function(){console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength().");return this.manhattanLength()}});Object.assign(K.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}});
Object.assign(B.prototype,{getChildByName:function(a){console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().");return this.getObjectByName(a)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(a,b){console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.");return this.translateOnAxis(b,a)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}});
Object.defineProperties(B.prototype,{eulerOrder:{get:function(){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order.");return this.rotation.order},set:function(a){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order.");this.rotation.order=a}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}});
Object.defineProperties(Cc.prototype,{objects:{get:function(){console.warn("THREE.LOD: .objects has been renamed to .levels.");return this.levels}}});Object.defineProperty(Dc.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}});Object.defineProperty(L.prototype,"__arcLengthDivisions",{get:function(){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.");
return this.arcLengthDivisions},set:function(a){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.");this.arcLengthDivisions=a}});ea.prototype.setLens=function(a,b){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup.");void 0!==b&&(this.filmGauge=b);this.setFocalLength(a)};Object.defineProperties(X.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(a){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov.");
this.shadow.camera.fov=a}},shadowCameraLeft:{set:function(a){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left.");this.shadow.camera.left=a}},shadowCameraRight:{set:function(a){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right.");this.shadow.camera.right=a}},shadowCameraTop:{set:function(a){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top.");this.shadow.camera.top=a}},shadowCameraBottom:{set:function(a){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.");
this.shadow.camera.bottom=a}},shadowCameraNear:{set:function(a){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near.");this.shadow.camera.near=a}},shadowCameraFar:{set:function(a){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far.");this.shadow.camera.far=a}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(a){console.warn("THREE.Light: .shadowBias is now .shadow.bias.");
this.shadow.bias=a}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(a){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.");this.shadow.mapSize.width=a}},shadowMapHeight:{set:function(a){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.");this.shadow.mapSize.height=a}}});Object.defineProperties(P.prototype,{length:{get:function(){console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead.");
return this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}});Object.assign(E.prototype,{addIndex:function(a){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().");this.setIndex(a)},addDrawCall:function(a,b,c){void 0!==c&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.");console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup().");this.addGroup(a,b)},
clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().");this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}});Object.defineProperties(E.prototype,{drawcalls:{get:function(){console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups.");return this.groups}},offsets:{get:function(){console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups.");
return this.groups}}});Object.assign(Ra.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}});Object.defineProperties(Jd.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},
onUpdate:{value:function(){console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead.");return this}}});Object.defineProperties(F.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){console.warn("THREE.Material: .wrapRGB has been removed.");return new G}},shading:{get:function(){console.error("THREE."+this.type+
": .shading has been removed. Use the boolean .flatShading instead.")},set:function(a){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.");this.flatShading=1===a}}});Object.defineProperties(Ia.prototype,{metal:{get:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead.");return!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}});
Object.defineProperties(Da.prototype,{derivatives:{get:function(){console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives.");return this.extensions.derivatives},set:function(a){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.");this.extensions.derivatives=a}}});Object.assign(Wd.prototype,{animate:function(a){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop().");this.setAnimationLoop(a)},getCurrentRenderTarget:function(){console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget().");
return this.getRenderTarget()},getMaxAnisotropy:function(){console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy().");return this.capabilities.getMaxAnisotropy()},getPrecision:function(){console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision.");return this.capabilities.precision},resetGLState:function(){console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset().");return this.state.reset()},supportsFloatTextures:function(){console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' ).");
return this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' ).");return this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' ).");return this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' ).");
return this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' ).");return this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' ).");return this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures.");
return this.capabilities.vertexTextures},supportsInstancedArrays:function(){console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' ).");return this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(a){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().");this.setScissorTest(a)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},
addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")}});Object.defineProperties(Wd.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.");
this.shadowMap.enabled=a}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.");this.shadowMap.type=a}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}});Object.defineProperties(We.prototype,
{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},
renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});Object.defineProperties(md.prototype,{wrapS:{get:function(){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.");return this.texture.wrapS},set:function(a){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.");
this.texture.wrapS=a}},wrapT:{get:function(){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.");return this.texture.wrapT},set:function(a){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.");this.texture.wrapT=a}},magFilter:{get:function(){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.");return this.texture.magFilter},set:function(a){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.");this.texture.magFilter=
a}},minFilter:{get:function(){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.");return this.texture.minFilter},set:function(a){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.");this.texture.minFilter=a}},anisotropy:{get:function(){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.");return this.texture.anisotropy},set:function(a){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.");this.texture.anisotropy=
a}},offset:{get:function(){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset.");return this.texture.offset},set:function(a){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset.");this.texture.offset=a}},repeat:{get:function(){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat.");return this.texture.repeat},set:function(a){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat.");this.texture.repeat=a}},format:{get:function(){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format.");
return this.texture.format},set:function(a){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format.");this.texture.format=a}},type:{get:function(){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type.");return this.texture.type},set:function(a){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type.");this.texture.type=a}},generateMipmaps:{get:function(){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.");return this.texture.generateMipmaps},
set:function(a){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.");this.texture.generateMipmaps=a}}});Object.defineProperties(Ye.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}}});jc.prototype.load=function(a){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var b=this;(new ge).load(a,function(a){b.setBuffer(a)});return this};ke.prototype.getData=function(){console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData().");
return this.getFrequencyData()};cd.prototype.updateCubeMap=function(a,b){console.warn("THREE.CubeCamera: .updateCubeMap() is now .update().");return this.update(a,b)};jb.crossOrigin=void 0;jb.loadTexture=function(a,b,c,d){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var e=new td;e.setCrossOrigin(this.crossOrigin);a=e.load(a,c,void 0,d);b&&(a.mapping=b);return a};jb.loadTextureCube=function(a,b,c,d){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");
var e=new Bf;e.setCrossOrigin(this.crossOrigin);a=e.load(a,c,void 0,d);b&&(a.mapping=b);return a};jb.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")};jb.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};l.WebGLRenderTargetCube=mf;l.WebGLRenderTarget=md;l.WebGLRenderer=Wd;l.ShaderLib=rb;l.UniformsLib=M;l.UniformsUtils=
Ea;l.ShaderChunk=R;l.FogExp2=Nb;l.Fog=Ob;l.Scene=od;l.Sprite=Bc;l.LOD=Cc;l.SkinnedMesh=qd;l.Skeleton=Dc;l.Bone=pd;l.Mesh=ra;l.LineSegments=W;l.LineLoop=rd;l.Line=ma;l.Points=Qb;l.Group=Mb;l.VideoTexture=Xd;l.DataTexture=kb;l.CompressedTexture=Rb;l.CubeTexture=Md;l.CanvasTexture=fh;l.DepthTexture=Ec;l.Texture=ta;l.CompressedTextureLoader=gf;l.DataTextureLoader=$d;l.CubeTextureLoader=Bf;l.TextureLoader=td;l.ObjectLoader=jf;l.MaterialLoader=Id;l.BufferGeometryLoader=be;l.DefaultLoadingManager=sa;l.LoadingManager=
ve;l.JSONLoader=ce;l.ImageLoader=Nd;l.ImageBitmapLoader=de;l.FontLoader=kf;l.FileLoader=Ja;l.Loader=ic;l.LoaderUtils=ze;l.Cache=ab;l.AudioLoader=ge;l.SpotLightShadow=vd;l.SpotLight=wd;l.PointLight=xd;l.RectAreaLight=Bd;l.HemisphereLight=ud;l.DirectionalLightShadow=yd;l.DirectionalLight=zd;l.AmbientLight=Ad;l.LightShadow=Gb;l.Light=X;l.StereoCamera=lf;l.PerspectiveCamera=ea;l.OrthographicCamera=Jb;l.CubeCamera=cd;l.ArrayCamera=zc;l.Camera=Qa;l.AudioListener=he;l.PositionalAudio=je;l.AudioContext=ie;
l.AudioAnalyser=ke;l.Audio=jc;l.VectorKeyframeTrack=hc;l.StringKeyframeTrack=Hd;l.QuaternionKeyframeTrack=bd;l.NumberKeyframeTrack=gc;l.ColorKeyframeTrack=Fd;l.BooleanKeyframeTrack=Ed;l.PropertyMixer=le;l.PropertyBinding=Y;l.KeyframeTrack=qa;l.AnimationUtils=ha;l.AnimationObjectGroup=of;l.AnimationMixer=me;l.AnimationClip=Ca;l.Uniform=Jd;l.InstancedBufferGeometry=ne;l.BufferGeometry=E;l.Geometry=K;l.InterleavedBufferAttribute=Ac;l.InstancedInterleavedBuffer=oe;l.InterleavedBuffer=sb;l.InstancedBufferAttribute=
pe;l.Face3=Wa;l.Object3D=B;l.Raycaster=qf;l.Layers=Rd;l.EventDispatcher=ib;l.Clock=sf;l.QuaternionLinearInterpolant=Gd;l.LinearInterpolant=ad;l.DiscreteInterpolant=Dd;l.CubicInterpolant=Cd;l.Interpolant=oa;l.Triangle=Ba;l.Math=Q;l.Spherical=tf;l.Cylindrical=uf;l.Plane=Pa;l.Frustum=ld;l.Sphere=za;l.Ray=qb;l.Matrix4=I;l.Matrix3=la;l.Box3=Va;l.Box2=re;l.Line3=se;l.Euler=lb;l.Vector4=ca;l.Vector3=p;l.Vector2=C;l.Quaternion=ia;l.Color=G;l.ImmediateRenderObject=dd;l.VertexNormalsHelper=ed;l.SpotLightHelper=
kc;l.SkeletonHelper=lc;l.PointLightHelper=mc;l.RectAreaLightHelper=nc;l.HemisphereLightHelper=oc;l.GridHelper=fd;l.PolarGridHelper=Kd;l.FaceNormalsHelper=gd;l.DirectionalLightHelper=pc;l.CameraHelper=hd;l.BoxHelper=Hb;l.Box3Helper=id;l.PlaneHelper=jd;l.ArrowHelper=Ib;l.AxesHelper=kd;l.Shape=hb;l.Path=Oa;l.ShapePath=ee;l.Font=fe;l.CurvePath=$a;l.Curve=L;l.ImageUtils=jb;l.ShapeUtils=Ya;l.WebGLUtils=Xe;l.Extensions=Xa;l.WireframeGeometry=Sb;l.ParametricGeometry=Fc;l.ParametricBufferGeometry=Tb;l.TetrahedronGeometry=
Hc;l.TetrahedronBufferGeometry=Ub;l.OctahedronGeometry=Ic;l.OctahedronBufferGeometry=tb;l.IcosahedronGeometry=Jc;l.IcosahedronBufferGeometry=Vb;l.DodecahedronGeometry=Kc;l.DodecahedronBufferGeometry=Wb;l.PolyhedronGeometry=Gc;l.PolyhedronBufferGeometry=ua;l.TubeGeometry=Lc;l.TubeBufferGeometry=Xb;l.TorusKnotGeometry=Mc;l.TorusKnotBufferGeometry=Yb;l.TorusGeometry=Nc;l.TorusBufferGeometry=Zb;l.TextGeometry=Sc;l.TextBufferGeometry=$b;l.SphereGeometry=Tc;l.SphereBufferGeometry=wb;l.RingGeometry=Uc;l.RingBufferGeometry=
ac;l.PlaneGeometry=wc;l.PlaneBufferGeometry=pb;l.LatheGeometry=Vc;l.LatheBufferGeometry=bc;l.ShapeGeometry=xb;l.ShapeBufferGeometry=yb;l.ExtrudeGeometry=vb;l.ExtrudeBufferGeometry=Ra;l.EdgesGeometry=cc;l.ConeGeometry=Wc;l.ConeBufferGeometry=Xc;l.CylinderGeometry=zb;l.CylinderBufferGeometry=Za;l.CircleGeometry=Yc;l.CircleBufferGeometry=dc;l.BoxGeometry=Kb;l.BoxBufferGeometry=ob;l.ShadowMaterial=Ab;l.SpriteMaterial=gb;l.RawShaderMaterial=ec;l.ShaderMaterial=Da;l.PointsMaterial=Ha;l.MeshPhysicalMaterial=
Bb;l.MeshStandardMaterial=Sa;l.MeshPhongMaterial=Ia;l.MeshToonMaterial=Cb;l.MeshNormalMaterial=Db;l.MeshLambertMaterial=Eb;l.MeshDepthMaterial=db;l.MeshDistanceMaterial=eb;l.MeshBasicMaterial=Aa;l.LineDashedMaterial=Fb;l.LineBasicMaterial=T;l.Material=F;l.Float64BufferAttribute=vc;l.Float32BufferAttribute=A;l.Uint32BufferAttribute=nb;l.Int32BufferAttribute=uc;l.Uint16BufferAttribute=mb;l.Int16BufferAttribute=tc;l.Uint8ClampedBufferAttribute=sc;l.Uint8BufferAttribute=rc;l.Int8BufferAttribute=qc;l.BufferAttribute=
P;l.ArcCurve=fc;l.CatmullRomCurve3=wa;l.CubicBezierCurve=Ka;l.CubicBezierCurve3=Ta;l.EllipseCurve=ka;l.LineCurve=na;l.LineCurve3=La;l.QuadraticBezierCurve=Ma;l.QuadraticBezierCurve3=Ua;l.SplineCurve=Na;l.REVISION="95";l.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2};l.CullFaceNone=0;l.CullFaceBack=1;l.CullFaceFront=2;l.CullFaceFrontBack=3;l.FrontFaceDirectionCW=0;l.FrontFaceDirectionCCW=1;l.BasicShadowMap=0;l.PCFShadowMap=1;l.PCFSoftShadowMap=2;l.FrontSide=0;l.BackSide=1;l.DoubleSide=2;l.FlatShading=1;l.SmoothShading=
2;l.NoColors=0;l.FaceColors=1;l.VertexColors=2;l.NoBlending=0;l.NormalBlending=1;l.AdditiveBlending=2;l.SubtractiveBlending=3;l.MultiplyBlending=4;l.CustomBlending=5;l.AddEquation=100;l.SubtractEquation=101;l.ReverseSubtractEquation=102;l.MinEquation=103;l.MaxEquation=104;l.ZeroFactor=200;l.OneFactor=201;l.SrcColorFactor=202;l.OneMinusSrcColorFactor=203;l.SrcAlphaFactor=204;l.OneMinusSrcAlphaFactor=205;l.DstAlphaFactor=206;l.OneMinusDstAlphaFactor=207;l.DstColorFactor=208;l.OneMinusDstColorFactor=
209;l.SrcAlphaSaturateFactor=210;l.NeverDepth=0;l.AlwaysDepth=1;l.LessDepth=2;l.LessEqualDepth=3;l.EqualDepth=4;l.GreaterEqualDepth=5;l.GreaterDepth=6;l.NotEqualDepth=7;l.MultiplyOperation=0;l.MixOperation=1;l.AddOperation=2;l.NoToneMapping=0;l.LinearToneMapping=1;l.ReinhardToneMapping=2;l.Uncharted2ToneMapping=3;l.CineonToneMapping=4;l.UVMapping=300;l.CubeReflectionMapping=301;l.CubeRefractionMapping=302;l.EquirectangularReflectionMapping=303;l.EquirectangularRefractionMapping=304;l.SphericalReflectionMapping=
305;l.CubeUVReflectionMapping=306;l.CubeUVRefractionMapping=307;l.RepeatWrapping=1E3;l.ClampToEdgeWrapping=1001;l.MirroredRepeatWrapping=1002;l.NearestFilter=1003;l.NearestMipMapNearestFilter=1004;l.NearestMipMapLinearFilter=1005;l.LinearFilter=1006;l.LinearMipMapNearestFilter=1007;l.LinearMipMapLinearFilter=1008;l.UnsignedByteType=1009;l.ByteType=1010;l.ShortType=1011;l.UnsignedShortType=1012;l.IntType=1013;l.UnsignedIntType=1014;l.FloatType=1015;l.HalfFloatType=1016;l.UnsignedShort4444Type=1017;
l.UnsignedShort5551Type=1018;l.UnsignedShort565Type=1019;l.UnsignedInt248Type=1020;l.AlphaFormat=1021;l.RGBFormat=1022;l.RGBAFormat=1023;l.LuminanceFormat=1024;l.LuminanceAlphaFormat=1025;l.RGBEFormat=1023;l.DepthFormat=1026;l.DepthStencilFormat=1027;l.RGB_S3TC_DXT1_Format=33776;l.RGBA_S3TC_DXT1_Format=33777;l.RGBA_S3TC_DXT3_Format=33778;l.RGBA_S3TC_DXT5_Format=33779;l.RGB_PVRTC_4BPPV1_Format=35840;l.RGB_PVRTC_2BPPV1_Format=35841;l.RGBA_PVRTC_4BPPV1_Format=35842;l.RGBA_PVRTC_2BPPV1_Format=35843;l.RGB_ETC1_Format=
36196;l.RGBA_ASTC_4x4_Format=37808;l.RGBA_ASTC_5x4_Format=37809;l.RGBA_ASTC_5x5_Format=37810;l.RGBA_ASTC_6x5_Format=37811;l.RGBA_ASTC_6x6_Format=37812;l.RGBA_ASTC_8x5_Format=37813;l.RGBA_ASTC_8x6_Format=37814;l.RGBA_ASTC_8x8_Format=37815;l.RGBA_ASTC_10x5_Format=37816;l.RGBA_ASTC_10x6_Format=37817;l.RGBA_ASTC_10x8_Format=37818;l.RGBA_ASTC_10x10_Format=37819;l.RGBA_ASTC_12x10_Format=37820;l.RGBA_ASTC_12x12_Format=37821;l.LoopOnce=2200;l.LoopRepeat=2201;l.LoopPingPong=2202;l.InterpolateDiscrete=2300;
l.InterpolateLinear=2301;l.InterpolateSmooth=2302;l.ZeroCurvatureEnding=2400;l.ZeroSlopeEnding=2401;l.WrapAroundEnding=2402;l.TrianglesDrawMode=0;l.TriangleStripDrawMode=1;l.TriangleFanDrawMode=2;l.LinearEncoding=3E3;l.sRGBEncoding=3001;l.GammaEncoding=3007;l.RGBEEncoding=3002;l.LogLuvEncoding=3003;l.RGBM7Encoding=3004;l.RGBM16Encoding=3005;l.RGBDEncoding=3006;l.BasicDepthPacking=3200;l.RGBADepthPacking=3201;l.TangentSpaceNormalMap=0;l.ObjectSpaceNormalMap=1;l.CubeGeometry=Kb;l.Face4=function(a,b,
c,d,e,f,g){console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead.");return new Wa(a,b,c,e,f,g)};l.LineStrip=0;l.LinePieces=1;l.MeshFaceMaterial=function(a){console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead.");return a};l.MultiMaterial=function(a){void 0===a&&(a=[]);console.warn("THREE.MultiMaterial has been removed. Use an Array instead.");a.isMultiMaterial=!0;a.materials=a;a.clone=function(){return a.slice()};return a};l.PointCloud=function(a,
b){console.warn("THREE.PointCloud has been renamed to THREE.Points.");return new Qb(a,b)};l.Particle=function(a){console.warn("THREE.Particle has been renamed to THREE.Sprite.");return new Bc(a)};l.ParticleSystem=function(a,b){console.warn("THREE.ParticleSystem has been renamed to THREE.Points.");return new Qb(a,b)};l.PointCloudMaterial=function(a){console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.");return new Ha(a)};l.ParticleBasicMaterial=function(a){console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.");
return new Ha(a)};l.ParticleSystemMaterial=function(a){console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.");return new Ha(a)};l.Vertex=function(a,b,c){console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead.");return new p(a,b,c)};l.DynamicBufferAttribute=function(a,b){console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead.");return(new P(a,b)).setDynamic(!0)};l.Int8Attribute=function(a,
b){console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead.");return new qc(a,b)};l.Uint8Attribute=function(a,b){console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead.");return new rc(a,b)};l.Uint8ClampedAttribute=function(a,b){console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead.");return new sc(a,b)};l.Int16Attribute=function(a,b){console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead.");
return new tc(a,b)};l.Uint16Attribute=function(a,b){console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead.");return new mb(a,b)};l.Int32Attribute=function(a,b){console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead.");return new uc(a,b)};l.Uint32Attribute=function(a,b){console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead.");return new nb(a,b)};l.Float32Attribute=
function(a,b){console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead.");return new A(a,b)};l.Float64Attribute=function(a,b){console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead.");return new vc(a,b)};l.ClosedSplineCurve3=wf;l.SplineCurve3=xf;l.Spline=ue;l.AxisHelper=function(a){console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper.");return new kd(a)};l.BoundingBoxHelper=function(a,b){console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead.");
return new Hb(a,b)};l.EdgesHelper=function(a,b){console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead.");return new W(new cc(a.geometry),new T({color:void 0!==b?b:16777215}))};l.WireframeHelper=function(a,b){console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead.");return new W(new Sb(a.geometry),new T({color:void 0!==b?b:16777215}))};l.XHRLoader=function(a){console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader.");return new Ja(a)};
l.BinaryTextureLoader=function(a){console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader.");return new $d(a)};l.GeometryUtils={merge:function(a,b,c){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");if(b.isMesh){b.matrixAutoUpdate&&b.updateMatrix();var d=b.matrix;b=b.geometry}a.merge(b,d,c)},center:function(a){console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.");
return a.center()}};l.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js.");this.projectVector=function(a,b){console.warn("THREE.Projector: .projectVector() is now vector.project().");a.project(b)};this.unprojectVector=function(a,b){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject().");a.unproject(b)};this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}};l.CanvasRenderer=
function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js");this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");this.clear=function(){};this.render=function(){};this.setClearColor=function(){};this.setSize=function(){}};l.SceneUtils={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},
attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}};l.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")};Object.defineProperty(l,"__esModule",{value:!0})});

/*! verb 2017-01-16 */
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.verb=a()}}(function(){var a={},b=this,c=(new Function("try {return this===window;}catch(e){ return false;}"),new Function("try {return this===global;}catch(e){return false;}")),d=new Function("try {return typeof importScripts === 'function';}catch(e){return false;}");if(c()&&!d()&&(console.log(typeof e),Worker=require("webworker-threads").Worker),c()||d()){var e=b;if(d()){var f=function(a,c){var d=b;return a.split(".").forEach(function(a){d&&(d=d[a])}),d?d[c]:null};onmessage=function(a){if(a.data.className&&a.data.methodName){var b=f(a.data.className,a.data.methodName);return b?void postMessage({result:b.apply(null,a.data.args),id:a.data.id}):console.error("could not find "+a.data.className+"."+a.data.methodName)}}}}return function(a,b,c){"use strict";function d(a,b){function c(){}c.prototype=a;var d=new c;for(var e in b)d[e]=b[e];return b.toString!==Object.prototype.toString&&(d.toString=b.toString),d}function e(a){return a instanceof Array?function(){return i.iter(a)}:"function"==typeof a.iterator?f(a,a.iterator):a.iterator}function f(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=ib++);var c;return null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__],null==c&&(c=function(){return c.method.apply(c.scope,arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c),c}b.geom=b.geom||{},b.exe=b.exe||{},b.eval=b.eval||{},b.core=b.core||{},b.promhx=b.promhx||{};var g={},h=function(){return D.__string_rec(this,"")},i=function(){};g.HxOverrides=i,i.__name__=["HxOverrides"],i.strDate=function(a){var b=a.length;switch(b){case 8:var c=a.split(":"),d=new Date;return d.setTime(0),d.setUTCHours(c[0]),d.setUTCMinutes(c[1]),d.setUTCSeconds(c[2]),d;case 10:var e=a.split("-");return new Date(e[0],e[1]-1,e[2],0,0,0);case 19:var f=a.split(" "),g=f[0].split("-"),h=f[1].split(":");return new Date(g[0],g[1]-1,g[2],h[0],h[1],h[2]);default:throw new C("Invalid date format : "+a)}},i.cca=function(a,b){var c=a.charCodeAt(b);if(c==c)return c},i.substr=function(a,b,c){return null!=b&&0!=b&&null!=c&&c<0?"":(null==c&&(c=a.length),b<0?(b=a.length+b,b<0&&(b=0)):c<0&&(c=a.length+c-b),a.substr(b,c))},i.iter=function(a){return{cur:0,arr:a,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var j=function(){};g.Lambda=j,j.__name__=["Lambda"],j.fold=function(a,b,c){for(var d=e(a)();d.hasNext();){var f=d.next();c=b(f,c)}return c};var k=function(){this.length=0};g.List=k,k.__name__=["List"],k.prototype={add:function(a){var b=[a];null==this.h?this.h=b:this.q[1]=b,this.q=b,this.length++},pop:function(){if(null==this.h)return null;var a=this.h[0];return this.h=this.h[1],null==this.h&&(this.q=null),this.length--,a},isEmpty:function(){return null==this.h},__class__:k},Math.__name__=["Math"];var l=function(){};g.Reflect=l,l.__name__=["Reflect"],l.field=function(a,b){try{return a[b]}catch(c){return c instanceof C&&(c=c.val),null}},l.callMethod=function(a,b,c){return b.apply(a,c)},l.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty;for(var d in a)"__id__"!=d&&"hx__closures__"!=d&&c.call(a,d)&&b.push(d)}return b},l.isFunction=function(a){return"function"==typeof a&&!(a.__name__||a.__ename__)},l.deleteField=function(a,b){return!!Object.prototype.hasOwnProperty.call(a,b)&&(delete a[b],!0)};var m=function(){};g.Std=m,m.__name__=["Std"],m.string=function(a){return D.__string_rec(a,"")},m.parseFloat=function(a){return parseFloat(a)};var n=function(){this.b=""};g.StringBuf=n,n.__name__=["StringBuf"],n.prototype={add:function(a){this.b+=m.string(a)},__class__:n};var o=function(){};g.StringTools=o,o.__name__=["StringTools"],o.fastCodeAt=function(a,b){return a.charCodeAt(b)};var p=g.ValueType={__ename__:["ValueType"],__constructs__:["TNull","TInt","TFloat","TBool","TObject","TFunction","TClass","TEnum","TUnknown"]};p.TNull=["TNull",0],p.TNull.toString=h,p.TNull.__enum__=p,p.TInt=["TInt",1],p.TInt.toString=h,p.TInt.__enum__=p,p.TFloat=["TFloat",2],p.TFloat.toString=h,p.TFloat.__enum__=p,p.TBool=["TBool",3],p.TBool.toString=h,p.TBool.__enum__=p,p.TObject=["TObject",4],p.TObject.toString=h,p.TObject.__enum__=p,p.TFunction=["TFunction",5],p.TFunction.toString=h,p.TFunction.__enum__=p,p.TClass=function(a){var b=["TClass",6,a];return b.__enum__=p,b.toString=h,b},p.TEnum=function(a){var b=["TEnum",7,a];return b.__enum__=p,b.toString=h,b},p.TUnknown=["TUnknown",8],p.TUnknown.toString=h,p.TUnknown.__enum__=p;var q=function(){};g.Type=q,q.__name__=["Type"],q.getClassName=function(a){var b=a.__name__;return null==b?null:b.join(".")},q.getEnumName=function(a){var b=a.__ename__;return b.join(".")},q.resolveClass=function(a){var b=g[a];return null!=b&&b.__name__?b:null},q.resolveEnum=function(a){var b=g[a];return null!=b&&b.__ename__?b:null},q.createEmptyInstance=function(a){function b(){}return b.prototype=a.prototype,new b},q.createEnum=function(a,b,c){var d=l.field(a,b);if(null==d)throw new C("No such constructor "+b);if(l.isFunction(d)){if(null==c)throw new C("Constructor "+b+" need parameters");return l.callMethod(a,d,c)}if(null!=c&&0!=c.length)throw new C("Constructor "+b+" does not need parameters");return d},q.getEnumConstructs=function(a){var b=a.__constructs__;return b.slice()},q.typeof=function(a){var b=typeof a;switch(b){case"boolean":return p.TBool;case"string":return p.TClass(String);case"number":return Math.ceil(a)==a%2147483648?p.TInt:p.TFloat;case"object":if(null==a)return p.TNull;var c=a.__enum__;if(null!=c)return p.TEnum(c);var d=D.getClass(a);return null!=d?p.TClass(d):p.TObject;case"function":return a.__name__||a.__ename__?p.TObject:p.TFunction;case"undefined":return p.TNull;default:return p.TUnknown}};var r=function(){};g["haxe.IMap"]=r,r.__name__=["haxe","IMap"];var s=function(a,b){this.high=a,this.low=b};g["haxe._Int64.___Int64"]=s,s.__name__=["haxe","_Int64","___Int64"],s.prototype={__class__:s};var t=function(){this.buf=new n,this.cache=[],this.useCache=t.USE_CACHE,this.useEnumIndex=t.USE_ENUM_INDEX,this.shash=new y,this.scount=0};g["haxe.Serializer"]=t,t.__name__=["haxe","Serializer"],t.prototype={toString:function(){return this.buf.b},serializeString:function(a){var b=this.shash.get(a);return null!=b?(this.buf.b+="R",void(null==b?this.buf.b+="null":this.buf.b+=""+b)):(this.shash.set(a,this.scount++),this.buf.b+="y",a=encodeURIComponent(a),null==a.length?this.buf.b+="null":this.buf.b+=""+a.length,this.buf.b+=":",void(null==a?this.buf.b+="null":this.buf.b+=""+a))},serializeRef:function(a){for(var b=typeof a,c=0,d=this.cache.length;c<d;){var e=c++,f=this.cache[e];if(typeof f==b&&f==a)return this.buf.b+="r",null==e?this.buf.b+="null":this.buf.b+=""+e,!0}return this.cache.push(a),!1},serializeFields:function(a){for(var b=0,c=l.fields(a);b<c.length;){var d=c[b];++b,this.serializeString(d),this.serialize(l.field(a,d))}this.buf.b+="g"},serialize:function(a){var b=q.typeof(a);switch(b[1]){case 0:this.buf.b+="n";break;case 1:var c=a;if(0==c)return void(this.buf.b+="z");this.buf.b+="i",null==c?this.buf.b+="null":this.buf.b+=""+c;break;case 2:var d=a;isNaN(d)?this.buf.b+="k":isFinite(d)?(this.buf.b+="d",null==d?this.buf.b+="null":this.buf.b+=""+d):d<0?this.buf.b+="m":this.buf.b+="p";break;case 3:a?this.buf.b+="t":this.buf.b+="f";break;case 6:var e=b[2];if(e==String)return void this.serializeString(a);if(this.useCache&&this.serializeRef(a))return;switch(e){case Array:var f=0;this.buf.b+="a";for(var g=a.length,h=0;h<g;){var i=h++;null==a[i]?f++:(f>0&&(1==f?this.buf.b+="n":(this.buf.b+="u",null==f?this.buf.b+="null":this.buf.b+=""+f),f=0),this.serialize(a[i]))}f>0&&(1==f?this.buf.b+="n":(this.buf.b+="u",null==f?this.buf.b+="null":this.buf.b+=""+f)),this.buf.b+="h";break;case k:this.buf.b+="l";for(var j=a,o=j.h,p=null;null!=o;){var r;p=o[0],o=o[1],r=p,this.serialize(r)}this.buf.b+="h";break;case Date:var s=a;this.buf.b+="v",this.buf.add(s.getTime());break;case y:this.buf.b+="b";for(var u=a,x=u.keys();x.hasNext();){var A=x.next();this.serializeString(A),this.serialize(null!=pb[A]?u.getReserved(A):u.h[A])}this.buf.b+="h";break;case v:this.buf.b+="q";for(var B=a,E=B.keys();E.hasNext();){var F=E.next();this.buf.b+=":",null==F?this.buf.b+="null":this.buf.b+=""+F,this.serialize(B.h[F])}this.buf.b+="h";break;case w:this.buf.b+="M";for(var G=a,H=G.keys();H.hasNext();){var I=H.next(),J=l.field(I,"__id__");l.deleteField(I,"__id__"),this.serialize(I),I.__id__=J,this.serialize(G.h[I.__id__])}this.buf.b+="h";break;case z:for(var K=a,L=0,M=K.length-2,N=new n,O=t.BASE64;L<M;){var P=K.get(L++),Q=K.get(L++),R=K.get(L++);N.add(O.charAt(P>>2)),N.add(O.charAt(63&(P<<4|Q>>4))),N.add(O.charAt(63&(Q<<2|R>>6))),N.add(O.charAt(63&R))}if(L==M){var S=K.get(L++),T=K.get(L++);N.add(O.charAt(S>>2)),N.add(O.charAt(63&(S<<4|T>>4))),N.add(O.charAt(T<<2&63))}else if(L==M+1){var U=K.get(L++);N.add(O.charAt(U>>2)),N.add(O.charAt(U<<4&63))}var V=N.b;this.buf.b+="s",null==V.length?this.buf.b+="null":this.buf.b+=""+V.length,this.buf.b+=":",null==V?this.buf.b+="null":this.buf.b+=""+V;break;default:this.useCache&&this.cache.pop(),null!=a.hxSerialize?(this.buf.b+="C",this.serializeString(q.getClassName(e)),this.useCache&&this.cache.push(a),a.hxSerialize(this),this.buf.b+="g"):(this.buf.b+="c",this.serializeString(q.getClassName(e)),this.useCache&&this.cache.push(a),this.serializeFields(a))}break;case 4:if(D.__instanceof(a,nb)){var W=q.getClassName(a);this.buf.b+="A",this.serializeString(W)}else if(D.__instanceof(a,ob))this.buf.b+="B",this.serializeString(q.getEnumName(a));else{if(this.useCache&&this.serializeRef(a))return;this.buf.b+="o",this.serializeFields(a)}break;case 7:var X=b[2];if(this.useCache){if(this.serializeRef(a))return;this.cache.pop()}this.useEnumIndex?this.buf.b+="j":this.buf.b+="w",this.serializeString(q.getEnumName(X)),this.useEnumIndex?(this.buf.b+=":",this.buf.b+=m.string(a[1])):this.serializeString(a[0]),this.buf.b+=":";var Y=a.length;this.buf.b+=m.string(Y-2);for(var Z=2;Z<Y;){var $=Z++;this.serialize(a[$])}this.useCache&&this.cache.push(a);break;case 5:throw new C("Cannot serialize function");default:throw new C("Cannot serialize "+m.string(a))}},__class__:t};var u=function(a){this.buf=a,this.length=a.length,this.pos=0,this.scache=[],this.cache=[];var b=u.DEFAULT_RESOLVER;null==b&&(b=q,u.DEFAULT_RESOLVER=b),this.setResolver(b)};g["haxe.Unserializer"]=u,u.__name__=["haxe","Unserializer"],u.initCodes=function(){for(var a=[],b=0,c=u.BASE64.length;b<c;){var d=b++;a[u.BASE64.charCodeAt(d)]=d}return a},u.prototype={setResolver:function(a){null==a?this.resolver={resolveClass:function(a){return null},resolveEnum:function(a){return null}}:this.resolver=a},get:function(a){return this.buf.charCodeAt(a)},readDigits:function(){for(var a=0,b=!1,c=this.pos;;){var d=this.buf.charCodeAt(this.pos);if(d!=d)break;if(45!=d){if(d<48||d>57)break;a=10*a+(d-48),this.pos++}else{if(this.pos!=c)break;b=!0,this.pos++}}return b&&(a*=-1),a},readFloat:function(){for(var a=this.pos;;){var b=this.buf.charCodeAt(this.pos);if(!(b>=43&&b<58||101==b||69==b))break;this.pos++}return m.parseFloat(i.substr(this.buf,a,this.pos-a))},unserializeObject:function(a){for(;;){if(this.pos>=this.length)throw new C("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var b=this.unserialize();if("string"!=typeof b)throw new C("Invalid object key");var c=this.unserialize();a[b]=c}this.pos++},unserializeEnum:function(a,b){if(58!=this.get(this.pos++))throw new C("Invalid enum format");var c=this.readDigits();if(0==c)return q.createEnum(a,b);for(var d=[];c-- >0;)d.push(this.unserialize());return q.createEnum(a,b,d)},unserialize:function(){var a=this.get(this.pos++);switch(a){case 110:return null;case 116:return!0;case 102:return!1;case 122:return 0;case 105:return this.readDigits();case 100:return this.readFloat();case 121:var b=this.readDigits();if(58!=this.get(this.pos++)||this.length-this.pos<b)throw new C("Invalid string length");var c=i.substr(this.buf,this.pos,b);return this.pos+=b,c=decodeURIComponent(c.split("+").join(" ")),this.scache.push(c),c;case 107:return NaN;case 109:return-(1/0);case 112:return 1/0;case 97:var d=(this.buf,[]);for(this.cache.push(d);;){var e=this.buf.charCodeAt(this.pos);if(104==e){this.pos++;break}if(117==e){this.pos++;var f=this.readDigits();d[d.length+f-1]=null}else d.push(this.unserialize())}return d;case 111:var g={};return this.cache.push(g),this.unserializeObject(g),g;case 114:var h=this.readDigits();if(h<0||h>=this.cache.length)throw new C("Invalid reference");return this.cache[h];case 82:var j=this.readDigits();if(j<0||j>=this.scache.length)throw new C("Invalid string reference");return this.scache[j];case 120:throw new C(this.unserialize());case 99:var l=this.unserialize(),m=this.resolver.resolveClass(l);if(null==m)throw new C("Class not found "+l);var n=q.createEmptyInstance(m);return this.cache.push(n),this.unserializeObject(n),n;case 119:var p=this.unserialize(),r=this.resolver.resolveEnum(p);if(null==r)throw new C("Enum not found "+p);var s=this.unserializeEnum(r,this.unserialize());return this.cache.push(s),s;case 106:var t=this.unserialize(),x=this.resolver.resolveEnum(t);if(null==x)throw new C("Enum not found "+t);this.pos++;var A=this.readDigits(),B=q.getEnumConstructs(x)[A];if(null==B)throw new C("Unknown enum index "+t+"@"+A);var D=this.unserializeEnum(x,B);return this.cache.push(D),D;case 108:var E=new k;this.cache.push(E);for(this.buf;104!=this.buf.charCodeAt(this.pos);)E.add(this.unserialize());return this.pos++,E;case 98:var F=new y;this.cache.push(F);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var G=this.unserialize();F.set(G,this.unserialize())}return this.pos++,F;case 113:var H=new v;this.cache.push(H);for(var I=(this.buf,this.get(this.pos++));58==I;){var J=this.readDigits();H.set(J,this.unserialize()),I=this.get(this.pos++)}if(104!=I)throw new C("Invalid IntMap format");return H;case 77:var K=new w;this.cache.push(K);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var L=this.unserialize();K.set(L,this.unserialize())}return this.pos++,K;case 118:var M;if(this.buf.charCodeAt(this.pos)>=48&&this.buf.charCodeAt(this.pos)<=57&&this.buf.charCodeAt(this.pos+1)>=48&&this.buf.charCodeAt(this.pos+1)<=57&&this.buf.charCodeAt(this.pos+2)>=48&&this.buf.charCodeAt(this.pos+2)<=57&&this.buf.charCodeAt(this.pos+3)>=48&&this.buf.charCodeAt(this.pos+3)<=57&&45==this.buf.charCodeAt(this.pos+4)){var N=i.substr(this.buf,this.pos,19);M=i.strDate(N),this.pos+=19}else{var O=this.readFloat(),P=new Date;P.setTime(O),M=P}return this.cache.push(M),M;case 115:var Q=this.readDigits(),R=this.buf;if(58!=this.get(this.pos++)||this.length-this.pos<Q)throw new C("Invalid bytes length");var S=u.CODES;null==S&&(S=u.initCodes(),u.CODES=S);var T,U=this.pos,V=3&Q;T=3*(Q>>2)+(V>=2?V-1:0);for(var W=U+(Q-V),X=z.alloc(T),Y=0;U<W;){var Z=S[o.fastCodeAt(R,U++)],$=S[o.fastCodeAt(R,U++)];X.set(Y++,Z<<2|$>>4);var _=S[o.fastCodeAt(R,U++)];X.set(Y++,$<<4|_>>2);var aa=S[o.fastCodeAt(R,U++)];X.set(Y++,_<<6|aa)}if(V>=2){var ba=S[o.fastCodeAt(R,U++)],ca=S[o.fastCodeAt(R,U++)];if(X.set(Y++,ba<<2|ca>>4),3==V){var da=S[o.fastCodeAt(R,U++)];X.set(Y++,ca<<4|da>>2)}}return this.pos+=Q,this.cache.push(X),X;case 67:var ea=this.unserialize(),fa=this.resolver.resolveClass(ea);if(null==fa)throw new C("Class not found "+ea);var ga=q.createEmptyInstance(fa);if(this.cache.push(ga),ga.hxUnserialize(this),103!=this.get(this.pos++))throw new C("Invalid custom data");return ga;case 65:var ha=this.unserialize(),ia=this.resolver.resolveClass(ha);if(null==ia)throw new C("Class not found "+ha);return ia;case 66:var ja=this.unserialize(),ka=this.resolver.resolveEnum(ja);if(null==ka)throw new C("Enum not found "+ja);return ka}throw this.pos--,new C("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:u};var v=function(){this.h={}};g["haxe.ds.IntMap"]=v,v.__name__=["haxe","ds","IntMap"],v.__interfaces__=[r],v.prototype={set:function(a,b){this.h[a]=b},remove:function(a){return!!this.h.hasOwnProperty(a)&&(delete this.h[a],!0)},keys:function(){var a=[];for(var b in this.h)this.h.hasOwnProperty(b)&&a.push(0|b);return i.iter(a)},__class__:v};var w=function(){this.h={},this.h.__keys__={}};g["haxe.ds.ObjectMap"]=w,w.__name__=["haxe","ds","ObjectMap"],w.__interfaces__=[r],w.prototype={set:function(a,b){var c=a.__id__||(a.__id__=++w.count);this.h[c]=b,this.h.__keys__[c]=a},keys:function(){var a=[];for(var b in this.h.__keys__)this.h.hasOwnProperty(b)&&a.push(this.h.__keys__[b]);return i.iter(a)},__class__:w};var x=g["haxe.ds.Option"]={__ename__:["haxe","ds","Option"],__constructs__:["Some","None"]};x.Some=function(a){var b=["Some",0,a];return b.__enum__=x,b.toString=h,b},x.None=["None",1],x.None.toString=h,x.None.__enum__=x;var y=function(){this.h={}};g["haxe.ds.StringMap"]=y,y.__name__=["haxe","ds","StringMap"],y.__interfaces__=[r],y.prototype={set:function(a,b){null!=pb[a]?this.setReserved(a,b):this.h[a]=b},get:function(a){return null!=pb[a]?this.getReserved(a):this.h[a]},setReserved:function(a,b){null==this.rh&&(this.rh={}),this.rh["$"+a]=b},getReserved:function(a){return null==this.rh?null:this.rh["$"+a]},keys:function(){var a=this.arrayKeys();return i.iter(a)},arrayKeys:function(){var a=[];for(var b in this.h)this.h.hasOwnProperty(b)&&a.push(b);if(null!=this.rh)for(var b in this.rh)36==b.charCodeAt(0)&&a.push(b.substr(1));return a},__class__:y};var z=function(a){this.length=a.byteLength,this.b=new rb(a),this.b.bufferValue=a,a.hxBytes=this,a.bytes=this.b};g["haxe.io.Bytes"]=z,z.__name__=["haxe","io","Bytes"],z.alloc=function(a){return new z(new qb(a))},z.prototype={get:function(a){return this.b[a]},set:function(a,b){this.b[a]=255&b},__class__:z};var A=g["haxe.io.Error"]={__ename__:["haxe","io","Error"],__constructs__:["Blocked","Overflow","OutsideBounds","Custom"]};A.Blocked=["Blocked",0],A.Blocked.toString=h,A.Blocked.__enum__=A,A.Overflow=["Overflow",1],A.Overflow.toString=h,A.Overflow.__enum__=A,A.OutsideBounds=["OutsideBounds",2],A.OutsideBounds.toString=h,A.OutsideBounds.__enum__=A,A.Custom=function(a){var b=["Custom",3,a];return b.__enum__=A,b.toString=h,b};var B=function(){};g["haxe.io.FPHelper"]=B,B.__name__=["haxe","io","FPHelper"],B.i32ToFloat=function(a){var b=1-(a>>>31<<1),c=a>>>23&255,d=8388607&a;return 0==d&&0==c?0:b*(1+Math.pow(2,-23)*d)*Math.pow(2,c-127)},B.floatToI32=function(a){if(0==a)return 0;var b;b=a<0?-a:a;var c=Math.floor(Math.log(b)/.6931471805599453);c<-127?c=-127:c>128&&(c=128);var d=8388607&Math.round(8388608*(b/Math.pow(2,c)-1));return(a<0?-2147483648:0)|c+127<<23|d},B.i64ToDouble=function(a,b){var c=1-(b>>>31<<1),d=(b>>20&2047)-1023,e=4294967296*(1048575&b)+2147483648*(a>>>31)+(2147483647&a);return 0==e&&d==-1023?0:c*(1+Math.pow(2,-52)*e)*Math.pow(2,d)},B.doubleToI64=function(a){var b=B.i64tmp;if(0==a)b.low=0,b.high=0;else{var c;c=a<0?-a:a;var d,e=Math.floor(Math.log(c)/.6931471805599453),f=4503599627370496*(c/Math.pow(2,e)-1);d=Math.round(f);var g=0|d,h=d/4294967296|0;b.low=g,b.high=(a<0?-2147483648:0)|e+1023<<20|h}return b};var C=function(a){Error.call(this),this.val=a,this.message=String(a),Error.captureStackTrace&&Error.captureStackTrace(this,C)};g["js._Boot.HaxeError"]=C,C.__name__=["js","_Boot","HaxeError"],C.__super__=Error,C.prototype=d(Error.prototype,{__class__:C});var D=function(){};g["js.Boot"]=D,D.__name__=["js","Boot"],D.getClass=function(a){if(a instanceof Array&&null==a.__enum__)return Array;var b=a.__class__;if(null!=b)return b;var c=D.__nativeClassName(a);return null!=c?D.__resolveNativeClass(c):null},D.__string_rec=function(a,b){if(null==a)return"null";if(b.length>=5)return"<...>";var c=typeof a;switch("function"==c&&(a.__name__||a.__ename__)&&(c="object"),c){case"object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];var d=a[0]+"(";b+="\t";for(var e=2,f=a.length;e<f;){var g=e++;d+=2!=g?","+D.__string_rec(a[g],b):D.__string_rec(a[g],b)}return d+")"}var h=a.length,i="[";b+="\t";for(var j=0;j<h;){var k=j++;i+=(k>0?",":"")+D.__string_rec(a[k],b)}return i+="]"}var l;try{l=a.toString}catch(m){return m instanceof C&&(m=m.val),"???"}if(null!=l&&l!=Object.toString&&"function"==typeof l){var n=a.toString();if("[object Object]"!=n)return n}var o=null,p="{\n";b+="\t";var q=null!=a.hasOwnProperty;for(var o in a)q&&!a.hasOwnProperty(o)||"prototype"!=o&&"__class__"!=o&&"__super__"!=o&&"__interfaces__"!=o&&"__properties__"!=o&&(2!=p.length&&(p+=", \n"),p+=b+o+" : "+D.__string_rec(a[o],b));return b=b.substring(1),p+="\n"+b+"}";case"function":return"<function>";case"string":return a;default:return String(a)}},D.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,e=c.length;d<e;){var f=d++,g=c[f];if(g==b||D.__interfLoop(g,b))return!0}return D.__interfLoop(a.__super__,b)},D.__instanceof=function(a,b){if(null==b)return!1;switch(b){case jb:return(0|a)===a;case lb:return"number"==typeof a;case mb:return"boolean"==typeof a;case String:return"string"==typeof a;case Array:return a instanceof Array&&null==a.__enum__;case kb:return!0;default:if(null==a)return!1;if("function"==typeof b){if(a instanceof b)return!0;if(D.__interfLoop(D.getClass(a),b))return!0}else if("object"==typeof b&&D.__isNativeObj(b)&&a instanceof b)return!0;return b==nb&&null!=a.__name__||(b==ob&&null!=a.__ename__||a.__enum__==b)}},D.__nativeClassName=function(a){var b=D.__toStr.call(a).slice(8,-1);return"Object"==b||"Function"==b||"Math"==b||"JSON"==b?null:b},D.__isNativeObj=function(a){return null!=D.__nativeClassName(a)},D.__resolveNativeClass=function(a){return c[a]};var E=function(a){if(a instanceof Array&&null==a.__enum__)this.a=a,this.byteLength=a.length;else{var b=a;this.a=[];for(var c=0;c<b;){var d=c++;this.a[d]=0}this.byteLength=b}};g["js.html.compat.ArrayBuffer"]=E,E.__name__=["js","html","compat","ArrayBuffer"],E.sliceImpl=function(a,b){var c=new rb(this,a,null==b?null:b-a),d=new qb(c.byteLength),e=new rb(d);return e.set(c),d},E.prototype={slice:function(a,b){return new E(this.a.slice(a,b))},__class__:E};var F=function(a,b,c){if(this.buf=a,null==b?this.offset=0:this.offset=b,null==c?this.length=a.byteLength-this.offset:this.length=c,this.offset<0||this.length<0||this.offset+this.length>a.byteLength)throw new C(A.OutsideBounds)};g["js.html.compat.DataView"]=F,F.__name__=["js","html","compat","DataView"],F.prototype={getInt8:function(a){var b=this.buf.a[this.offset+a];return b>=128?b-256:b},getUint8:function(a){return this.buf.a[this.offset+a]},getInt16:function(a,b){var c=this.getUint16(a,b);return c>=32768?c-65536:c},getUint16:function(a,b){return b?this.buf.a[this.offset+a]|this.buf.a[this.offset+a+1]<<8:this.buf.a[this.offset+a]<<8|this.buf.a[this.offset+a+1]},getInt32:function(a,b){var c=this.offset+a,d=this.buf.a[c++],e=this.buf.a[c++],f=this.buf.a[c++],g=this.buf.a[c++];return b?d|e<<8|f<<16|g<<24:g|f<<8|e<<16|d<<24},getUint32:function(a,b){var c=this.getInt32(a,b);return c<0?c+4294967296:c},getFloat32:function(a,b){return B.i32ToFloat(this.getInt32(a,b))},getFloat64:function(a,b){var c=this.getInt32(a,b),d=this.getInt32(a+4,b);return B.i64ToDouble(b?c:d,b?d:c)},setInt8:function(a,b){b<0?this.buf.a[a+this.offset]=b+128&255:this.buf.a[a+this.offset]=255&b},setUint8:function(a,b){this.buf.a[a+this.offset]=255&b},setInt16:function(a,b,c){this.setUint16(a,b<0?b+65536:b,c)},setUint16:function(a,b,c){var d=a+this.offset;c?(this.buf.a[d]=255&b,this.buf.a[d++]=b>>8&255):(this.buf.a[d++]=b>>8&255,this.buf.a[d]=255&b)},setInt32:function(a,b,c){this.setUint32(a,b,c)},setUint32:function(a,b,c){var d=a+this.offset;c?(this.buf.a[d++]=255&b,this.buf.a[d++]=b>>8&255,this.buf.a[d++]=b>>16&255,this.buf.a[d++]=b>>>24):(this.buf.a[d++]=b>>>24,this.buf.a[d++]=b>>16&255,this.buf.a[d++]=b>>8&255,this.buf.a[d++]=255&b)},setFloat32:function(a,b,c){this.setUint32(a,B.floatToI32(b),c)},setFloat64:function(a,b,c){var d=B.doubleToI64(b);c?(this.setUint32(a,d.low),this.setUint32(a,d.high)):(this.setUint32(a,d.high),this.setUint32(a,d.low))},__class__:F};var G=function(){};g["js.html.compat.Uint8Array"]=G,G.__name__=["js","html","compat","Uint8Array"],G._new=function(a,b,c){var d;if("number"==typeof a){d=[];for(var e=0;e<a;){var f=e++;d[f]=0}d.byteLength=d.length,d.byteOffset=0,d.buffer=new E(d)}else if(D.__instanceof(a,E)){var g=a;null==b&&(b=0),null==c&&(c=g.byteLength-b),d=0==b?g.a:g.a.slice(b,b+c),d.byteLength=d.length,d.byteOffset=b,d.buffer=g}else{if(!(a instanceof Array&&null==a.__enum__))throw new C("TODO "+m.string(a));d=a.slice(),d.byteLength=d.length,d.byteOffset=0,d.buffer=new E(d)}return d.subarray=G._subarray,d.set=G._set,d},G._set=function(a,b){var c=this;if(D.__instanceof(a.buffer,E)){var d=a;if(a.byteLength+b>c.byteLength)throw new C("set() outside of range");for(var e=0,f=a.byteLength;e<f;){var g=e++;c[g+b]=d[g]}}else{if(!(a instanceof Array&&null==a.__enum__))throw new C("TODO");var h=a;if(h.length+b>c.byteLength)throw new C("set() outside of range");for(var i=0,j=h.length;i<j;){var k=i++;c[k+b]=h[k]}}},G._subarray=function(a,b){var c=this,d=G._new(c.slice(a,b));return d.byteOffset=a,d};var H=function(a){this._resolved=!1,this._pending=!1,this._errorPending=!1,this._fulfilled=!1,this._update=[],this._error=[],this._errored=!1,null!=a&&H.link(a,this,function(a){return a})};g["promhx.base.AsyncBase"]=H,H.__name__=["promhx","base","AsyncBase"],H.link=function(a,b,c){a._update.push({async:b,linkf:function(a){b.handleResolve(c(a))}}),H.immediateLinkUpdate(a,b,c)},H.immediateLinkUpdate=function(a,b,c){if(!a._errored||a._errorPending||a._error.length>0||b.handleError(a._errorVal),a._resolved&&!a._pending)try{b.handleResolve(c(a._val))}catch(d){d instanceof C&&(d=d.val),b.handleError(d)}},H.linkAll=function(a,b){for(var c=function(c,d,f){if(0==c.length||H.allFulfilled(c)){for(var g,h=[],i=e(a)();i.hasNext();){var j=i.next();h.push(j==d?f:j._val)}g=h,b.handleResolve(g)}},d=e(a)();d.hasNext();){var f=d.next();f._update.push({async:b,linkf:function(a,b,c){return function(d){a(b,c,d)}}(c,function(b){for(var c,d=[],g=e(a)();g.hasNext();){var h=g.next();h!=f&&d.push(h)}return c=d}(this),f)})}H.allFulfilled(a)&&b.handleResolve(function(b){for(var c,d=[],f=e(a)();f.hasNext();){var g=f.next();d.push(g._val)}return c=d}(this))},H.pipeLink=function(a,b,c){var d=!1,e=function(a){if(!d){d=!0;var e=c(a);e._update.push({async:b,linkf:f(b,b.handleResolve)}),H.immediateLinkUpdate(e,b,function(a){return a})}};if(a._update.push({async:b,linkf:e}),a._resolved&&!a._pending)try{e(a._val)}catch(g){g instanceof C&&(g=g.val),b.handleError(g)}},H.allResolved=function(a){for(var b=e(a)();b.hasNext();){var c=b.next();if(!c._resolved)return!1}return!0},H.allFulfilled=function(a){for(var b=e(a)();b.hasNext();){var c=b.next();if(!c._fulfilled)return!1}return!0},H.prototype={catchError:function(a){return this._error.push(a),this},errorThen:function(a){return this._errorMap=a,this},isResolved:function(){return this._resolved},isErrored:function(){return this._errored},isErrorHandled:function(){return this._error.length>0},isErrorPending:function(){return this._errorPending},isFulfilled:function(){return this._fulfilled},isPending:function(){return this._pending},handleResolve:function(a){this._resolve(a)},_resolve:function(a){var b=this;this._pending?M.enqueue(function(a,b){return function(){a(b)}}(f(this,this._resolve),a)):(this._resolved=!0,this._pending=!0,M.queue.add(function(){b._val=a;for(var c=0,d=b._update;c<d.length;){var e=d[c];++c;try{e.linkf(a)}catch(f){f instanceof C&&(f=f.val),e.async.handleError(f)}}b._fulfilled=!0,b._pending=!1}),M.continueOnNextLoop())},handleError:function(a){this._handleError(a)},_handleError:function(a){var b=this,c=function(a){if(b._error.length>0)for(var c=0,d=b._error;c<d.length;){var e=d[c];++c,e(a)}else{if(!(b._update.length>0))throw new C(a);for(var f=0,g=b._update;f<g.length;){var h=g[f];++f,h.async.handleError(a)}}b._errorPending=!1};this._errorPending||(this._errorPending=!0,this._errored=!0,this._errorVal=a,M.queue.add(function(){if(null!=b._errorMap)try{b._resolve(b._errorMap(a))}catch(d){d instanceof C&&(d=d.val),c(d)}else c(a)}),M.continueOnNextLoop())},then:function(a){var b=new H(null);return H.link(this,b,a),b},unlink:function(a){var b=this;M.queue.add(function(){b._update=b._update.filter(function(b){return b.async!=a})}),M.continueOnNextLoop()},isLinked:function(a){for(var b=!1,c=0,d=this._update;c<d.length;){var e=d[c];if(++c,e.async==a)return!0}return b},__class__:H};var I=b.promhx.Deferred=function(){H.call(this)};g["promhx.Deferred"]=I,I.__name__=["promhx","Deferred"],I.__super__=H,I.prototype=d(H.prototype,{resolve:function(a){this.handleResolve(a)},throwError:function(a){this.handleError(a)},promise:function(){return new J(this)},stream:function(){return new K(this)},publicStream:function(){return new L(this)},__class__:I});var J=b.promhx.Promise=function(a){H.call(this,a),this._rejected=!1};g["promhx.Promise"]=J,J.__name__=["promhx","Promise"],J.whenAll=function(a){var b=new J(null);return H.linkAll(a,b),b},J.promise=function(a){var b=new J;return b.handleResolve(a),b},J.__super__=H,J.prototype=d(H.prototype,{isRejected:function(){return this._rejected},reject:function(a){this._rejected=!0,this.handleError(a)},handleResolve:function(a){if(this._resolved){var b="Promise has already been resolved";throw new C(N.AlreadyResolved(b))}this._resolve(a)},then:function(a){var b=new J(null);return H.link(this,b,a),b},unlink:function(a){var b=this;M.queue.add(function(){if(b._fulfilled)b._update=b._update.filter(function(b){return b.async!=a});else{var c="Downstream Promise is not fullfilled";b.handleError(N.DownstreamNotFullfilled(c))}}),M.continueOnNextLoop()},handleError:function(a){this._rejected=!0,this._handleError(a)},pipe:function(a){var b=new J(null);return H.pipeLink(this,b,a),b},errorPipe:function(a){var b=new J;return this.catchError(function(c){var d=a(c);d.then(f(b,b._resolve))}),this.then(f(b,b._resolve)),b},__class__:J});var K=b.promhx.Stream=function(a){H.call(this,a),this._end_promise=new J};g["promhx.Stream"]=K,K.__name__=["promhx","Stream"],K.foreach=function(a){for(var b=new K(null),c=e(a)();c.hasNext();){var d=c.next();b.handleResolve(d)}return b.end(),b},K.wheneverAll=function(a){var b=new K(null);return H.linkAll(a,b),b},K.concatAll=function(a){for(var b=new K(null),c=e(a)();c.hasNext();){var d=c.next();b.concat(d)}return b},K.mergeAll=function(a){for(var b=new K(null),c=e(a)();c.hasNext();){var d=c.next();b.merge(d)}return b},K.stream=function(a){var b=new K(null);return b.handleResolve(a),b},K.__super__=H,K.prototype=d(H.prototype,{then:function(a){var b=new K(null);return H.link(this,b,a),this._end_promise._update.push({async:b._end_promise,linkf:function(a){b.end()}}),b},detachStream:function(a){for(var b=[],c=!1,d=0,e=this._update;d<e.length;){var f=e[d];++d,f.async==a?(this._end_promise._update=this._end_promise._update.filter(function(b){return b.async!=a._end_promise}),c=!0):b.push(f)}return this._update=b,c},first:function(){var a=new J(null);return this.then(function(b){a._resolved||a.handleResolve(b)}),a},handleResolve:function(a){this._end||this._pause||this._resolve(a)},pause:function(a){null==a&&(a=!this._pause),this._pause=a},pipe:function(a){var b=new K(null);return H.pipeLink(this,b,a),this._end_promise.then(function(a){b.end()}),b},errorPipe:function(a){var b=new K(null);return this.catchError(function(c){var d=a(c);d.then(f(b,b._resolve)),d._end_promise.then((hb=b._end_promise,f(hb,hb._resolve)))}),this.then(f(b,b._resolve)),this._end_promise.then(function(a){b.end()}),b},handleEnd:function(){if(this._pending)M.queue.add(f(this,this.handleEnd)),M.continueOnNextLoop();else{if(this._end_promise._resolved)return;this._end=!0;var a;a=this._resolved?x.Some(this._val):x.None,this._end_promise.handleResolve(a),this._update=[],this._error=[]}},end:function(){return M.queue.add(f(this,this.handleEnd)),M.continueOnNextLoop(),
this},endThen:function(a){return this._end_promise.then(a)},filter:function(a){var b=new K(null);return this._update.push({async:b,linkf:function(c){a(c)&&b.handleResolve(c)}}),H.immediateLinkUpdate(this,b,function(a){return a}),b},concat:function(a){var b=new K(null);return this._update.push({async:b,linkf:f(b,b.handleResolve)}),H.immediateLinkUpdate(this,b,function(a){return a}),this._end_promise.then(function(c){a.pipe(function(a){return b.handleResolve(a),b}),a._end_promise.then(function(a){b.end()})}),b},merge:function(a){var b=new K(null);return this._update.push({async:b,linkf:f(b,b.handleResolve)}),a._update.push({async:b,linkf:f(b,b.handleResolve)}),H.immediateLinkUpdate(this,b,function(a){return a}),H.immediateLinkUpdate(a,b,function(a){return a}),b},__class__:K});var L=b.promhx.PublicStream=function(a){K.call(this,a)};g["promhx.PublicStream"]=L,L.__name__=["promhx","PublicStream"],L.publicstream=function(a){var b=new L(null);return b.handleResolve(a),b},L.__super__=K,L.prototype=d(K.prototype,{resolve:function(a){this.handleResolve(a)},throwError:function(a){this.handleError(a)},update:function(a){this.handleResolve(a)},__class__:L});var M=function(){};g["promhx.base.EventLoop"]=M,M.__name__=["promhx","base","EventLoop"],M.enqueue=function(a){M.queue.add(a),M.continueOnNextLoop()},M.set_nextLoop=function(a){if(null!=M.nextLoop)throw new C("nextLoop has already been set");return M.nextLoop=a,M.nextLoop},M.queueEmpty=function(){return M.queue.isEmpty()},M.finish=function(a){null==a&&(a=1e3);for(var b=null;a-- >0&&null!=(b=M.queue.pop());)b();return M.queue.isEmpty()},M.clear=function(){M.queue=new k},M.f=function(){var a=M.queue.pop();null!=a&&a(),M.queue.isEmpty()||M.continueOnNextLoop()},M.continueOnNextLoop=function(){null!=M.nextLoop?M.nextLoop(M.f):setImmediate(M.f)};var N=g["promhx.error.PromiseError"]={__ename__:["promhx","error","PromiseError"],__constructs__:["AlreadyResolved","DownstreamNotFullfilled"]};N.AlreadyResolved=function(a){var b=["AlreadyResolved",0,a];return b.__enum__=N,b.toString=h,b},N.DownstreamNotFullfilled=function(a){var b=["DownstreamNotFullfilled",1,a];return b.__enum__=N,b.toString=h,b};var O=function(){};g["verb.Verb"]=O,O.__name__=["verb","Verb"],O.main=function(){a.log("verb 2.0.0")};var P=function(){};g["verb.core.ArrayExtensions"]=P,P.__name__=["verb","core","ArrayExtensions"],P.alloc=function(a,b){if(!(b<0))for(;a.length<b;)a.push(null)},P.reversed=function(a){var b=a.slice();return b.reverse(),b},P.last=function(a){return a[a.length-1]},P.first=function(a){return a[0]},P.spliceAndInsert=function(a,b,c,d){a.splice(b,c),a.splice(b,0,d)},P.left=function(a){if(0==a.length)return[];var b=Math.ceil(a.length/2);return a.slice(0,b)},P.right=function(a){if(0==a.length)return[];var b=Math.ceil(a.length/2);return a.slice(b)},P.rightWithPivot=function(a){if(0==a.length)return[];var b=Math.ceil(a.length/2);return a.slice(b-1)},P.unique=function(a,b){if(0==a.length)return[];for(var c=[a.pop()];a.length>0;){for(var d=a.pop(),e=!0,f=0;f<c.length;){var g=c[f];if(++f,b(d,g)){e=!1;break}}e&&c.push(d)}return c};var Q=function(){};g["verb.core.Binomial"]=Q,Q.__name__=["verb","core","Binomial"],Q.get=function(a,b){if(0==b)return 1;if(0==a||b>a)return 0;if(b>a-b&&(b=a-b),Q.memo_exists(a,b))return Q.get_memo(a,b);for(var c=1,d=a,e=1,f=b+1;e<f;){var g=e++;Q.memo_exists(d,g)?(a--,c=Q.get_memo(d,g)):(c*=a--,c/=g,Q.memoize(d,g,c))}return c},Q.get_no_memo=function(a,b){if(0==b)return 1;if(0==a||b>a)return 0;b>a-b&&(b=a-b);for(var c=1,d=1,e=b+1;d<e;){var f=d++;c*=a--,c/=f}return c},Q.memo_exists=function(a,b){return Q.memo.h.hasOwnProperty(a)&&Q.memo.h[a].h.hasOwnProperty(b)},Q.get_memo=function(a,b){return Q.memo.h[a].h[b]},Q.memoize=function(a,b,c){Q.memo.h.hasOwnProperty(a)||Q.memo.set(a,new v),Q.memo.h[a].h[b]=c};var R=b.core.BoundingBox=function(a){this.max=null,this.min=null,this.dim=3,this.initialized=!1,null!=a&&this.addRange(a)};g["verb.core.BoundingBox"]=R,R.__name__=["verb","core","BoundingBox"],R.intervalsOverlap=function(a,b,c,d,e){null==e&&(e=-1);var f;f=e<-.5?S.TOLERANCE:e;var g=Math.min(a,b)-f,h=Math.max(a,b)+f,i=Math.min(c,d)-f,j=Math.max(c,d)+f;return g>=i&&g<=j||h>=i&&h<=j||i>=g&&i<=h||j>=g&&j<=h},R.prototype={fromPoint:function(a){return new R([a])},add:function(a){if(!this.initialized)return this.dim=a.length,this.min=a.slice(0),this.max=a.slice(0),this.initialized=!0,this;for(var b=0,c=this.dim;b<c;){var d=b++;a[d]>this.max[d]&&(this.max[d]=a[d]),a[d]<this.min[d]&&(this.min[d]=a[d])}return this},addRange:function(a){for(var b=a.length,c=0;c<b;){var d=c++;this.add(a[d])}return this},contains:function(a,b){return null==b&&(b=-1),!!this.initialized&&this.intersects(new R([a]),b)},intersects:function(a,b){if(null==b&&(b=-1),!this.initialized||!a.initialized)return!1;for(var c=this.min,d=this.max,e=a.min,f=a.max,g=0,h=this.dim;g<h;){var i=g++;if(!R.intervalsOverlap(c[i],d[i],e[i],f[i],b))return!1}return!0},clear:function(){return this.initialized=!1,this},getLongestAxis:function(){for(var a=0,b=0,c=0,d=this.dim;c<d;){var e=c++,f=this.getAxisLength(e);f>a&&(a=f,b=e)}return b},getAxisLength:function(a){return a<0||a>this.dim-1?0:Math.abs(this.min[a]-this.max[a])},intersect:function(a,b){if(!this.initialized)return null;var c=this.min,d=this.max,e=a.min,f=a.max;if(!this.intersects(a,b))return null;for(var g=[],h=[],i=0,j=this.dim;i<j;){var k=i++;g.push(Math.min(d[k],f[k])),h.push(Math.max(c[k],e[k]))}return new R([h,g])},__class__:R};var S=b.core.Constants=function(){};g["verb.core.Constants"]=S,S.__name__=["verb","core","Constants"];var T=b.core.SerializableBase=function(){};g["verb.core.SerializableBase"]=T,T.__name__=["verb","core","SerializableBase"],T.prototype={serialize:function(){var a=new t;return a.serialize(this),a.toString()},__class__:T};var U=b.core.Plane=function(a,b){this.origin=a,this.normal=b};g["verb.core.Plane"]=U,U.__name__=["verb","core","Plane"],U.__super__=T,U.prototype=d(T.prototype,{__class__:U});var V=b.core.Ray=function(a,b){this.origin=a,this.dir=b};g["verb.core.Ray"]=V,V.__name__=["verb","core","Ray"],V.__super__=T,V.prototype=d(T.prototype,{__class__:V});var W=b.core.NurbsCurveData=function(a,b,c){this.degree=a,this.controlPoints=c,this.knots=b};g["verb.core.NurbsCurveData"]=W,W.__name__=["verb","core","NurbsCurveData"],W.__super__=T,W.prototype=d(T.prototype,{__class__:W});var X=b.core.NurbsSurfaceData=function(a,b,c,d,e){this.degreeU=a,this.degreeV=b,this.knotsU=c,this.knotsV=d,this.controlPoints=e};g["verb.core.NurbsSurfaceData"]=X,X.__name__=["verb","core","NurbsSurfaceData"],X.__super__=T,X.prototype=d(T.prototype,{__class__:X});var Y=b.core.MeshData=function(a,b,c,d){this.faces=a,this.points=b,this.normals=c,this.uvs=d};g["verb.core.MeshData"]=Y,Y.__name__=["verb","core","MeshData"],Y.empty=function(){return new Y([],[],[],[])},Y.__super__=T,Y.prototype=d(T.prototype,{__class__:Y});var Z=b.core.PolylineData=function(a,b){this.points=a,this.params=b};g["verb.core.PolylineData"]=Z,Z.__name__=["verb","core","PolylineData"],Z.__super__=T,Z.prototype=d(T.prototype,{__class__:Z});var $=b.core.VolumeData=function(a,b,c,d,e,f,g){this.degreeU=a,this.degreeV=b,this.degreeW=c,this.knotsU=d,this.knotsV=e,this.knotsW=f,this.controlPoints=g};g["verb.core.VolumeData"]=$,$.__name__=["verb","core","VolumeData"],$.__super__=T,$.prototype=d(T.prototype,{__class__:$});var _=b.core.Pair=function(a,b){this.item0=a,this.item1=b};g["verb.core.Pair"]=_,_.__name__=["verb","core","Pair"],_.prototype={__class__:_};var aa=b.core.Interval=function(a,b){this.min=a,this.max=b};g["verb.core.Interval"]=aa,aa.__name__=["verb","core","Interval"],aa.prototype={__class__:aa};var ba=b.core.CurveCurveIntersection=function(a,b,c,d){this.point0=a,this.point1=b,this.u0=c,this.u1=d};g["verb.core.CurveCurveIntersection"]=ba,ba.__name__=["verb","core","CurveCurveIntersection"],ba.prototype={__class__:ba};var ca=b.core.CurveSurfaceIntersection=function(a,b,c,d){this.u=a,this.uv=b,this.curvePoint=c,this.surfacePoint=d};g["verb.core.CurveSurfaceIntersection"]=ca,ca.__name__=["verb","core","CurveSurfaceIntersection"],ca.prototype={__class__:ca};var da=b.core.MeshIntersectionPoint=function(a,b,c,d,e){this.visited=!1,this.adj=null,this.opp=null,this.uv0=a,this.uv1=b,this.point=c,this.faceIndex0,this.faceIndex1};g["verb.core.MeshIntersectionPoint"]=da,da.__name__=["verb","core","MeshIntersectionPoint"],da.prototype={__class__:da};var ea=b.core.PolylineMeshIntersection=function(a,b,c,d,e){this.point=a,this.u=b,this.uv=c,this.polylineIndex=d,this.faceIndex=e};g["verb.core.PolylineMeshIntersection"]=ea,ea.__name__=["verb","core","PolylineMeshIntersection"],ea.prototype={__class__:ea};var fa=b.core.SurfaceSurfaceIntersectionPoint=function(a,b,c,d){this.uv0=a,this.uv1=b,this.point=c,this.dist=d};g["verb.core.SurfaceSurfaceIntersectionPoint"]=fa,fa.__name__=["verb","core","SurfaceSurfaceIntersectionPoint"],fa.prototype={__class__:fa};var ga=b.core.TriSegmentIntersection=function(a,b,c,d){this.point=a,this.s=b,this.t=c,this.p=d};g["verb.core.TriSegmentIntersection"]=ga,ga.__name__=["verb","core","TriSegmentIntersection"],ga.prototype={__class__:ga};var ha=b.core.CurveTriPoint=function(a,b,c){this.u=a,this.point=b,this.uv=c};g["verb.core.CurveTriPoint"]=ha,ha.__name__=["verb","core","CurveTriPoint"],ha.prototype={__class__:ha};var ia=function(a,b,c,d,e){null==e&&(e=!1),null==d&&(d=-1),this.uv=c,this.point=a,this.normal=b,this.id=d,this.degen=e};g["verb.core.SurfacePoint"]=ia,ia.__name__=["verb","core","SurfacePoint"],ia.fromUv=function(a,b){return new ia(null,null,[a,b])},ia.prototype={__class__:ia};var ja=b.core.CurvePoint=function(a,b){this.u=a,this.pt=b};g["verb.core.CurvePoint"]=ja,ja.__name__=["verb","core","CurvePoint"],ja.prototype={__class__:ja};var ka=b.core.KdTree=function(a,b){this.dim=3,this.points=a,this.distanceFunction=b,this.dim=a[0].point.length,this.root=this.buildTree(a,0,null)};g["verb.core.KdTree"]=ka,ka.__name__=["verb","core","KdTree"],ka.prototype={buildTree:function(a,b,c){var d,e,f=b%this.dim;return 0==a.length?null:1==a.length?new na(a[0],f,c):(a.sort(function(a,b){var c=a.point[f]-b.point[f];return 0==c?0:c>0?1:-1}),d=Math.floor(a.length/2),e=new na(a[d],f,c),e.left=this.buildTree(a.slice(0,d),b+1,e),e.right=this.buildTree(a.slice(d+1),b+1,e),e)},nearest:function(a,b,c){var d,e=this,f=new la(function(a){return-a.item1}),g=null;g=function(c){for(var d,h,i=c.dimension,j=e.distanceFunction(a,c.kdPoint.point),k=[],l=0,m=e.dim;l<m;){l++;k.push(0)}h=k;for(var n,o,p=function(a,c){f.push(new _(a,c)),f.size()>b&&f.pop()},q=0,r=e.dim;q<r;){var s=q++;s==c.dimension?h[s]=a[s]:h[s]=c.kdPoint.point[s]}return n=e.distanceFunction(h,c.kdPoint.point),null==c.right&&null==c.left?void((f.size()<b||j<f.peek().item1)&&p(c,j)):(d=null==c.right?c.left:null==c.left?c.right:a[i]<c.kdPoint.point[i]?c.left:c.right,g(d),(f.size()<b||j<f.peek().item1)&&p(c,j),void((f.size()<b||Math.abs(n)<f.peek().item1)&&(o=d==c.left?c.right:c.left,null!=o&&g(o))))},d=g;for(var h=0;h<b;){h++;f.push(new _(null,c))}d(this.root);for(var i=[],j=0;j<b;){var k=j++;null!=f.content[k].item0&&i.push(new _(f.content[k].item0.kdPoint,f.content[k].item1))}return i},__class__:ka};var la=function(a){this.content=[],this.scoreFunction=a};g["verb.core.BinaryHeap"]=la,la.__name__=["verb","core","BinaryHeap"],la.prototype={push:function(a){this.content.push(a),this.bubbleUp(this.content.length-1)},pop:function(){var a=this.content[0],b=this.content.pop();return this.content.length>0&&(this.content[0]=b,this.sinkDown(0)),a},peek:function(){return this.content[0]},remove:function(a){for(var b=this.content.length,c=0;c<b;){var d=c++;if(this.content[d]==a){var e=this.content.pop();return void(d!=b-1&&(this.content[d]=e,this.scoreFunction(e)<this.scoreFunction(a)?this.bubbleUp(d):this.sinkDown(d)))}}throw new C("Node not found.")},size:function(){return this.content.length},bubbleUp:function(a){for(var b=this.content[a];a>0;){var c=Math.floor((a+1)/2)-1,d=this.content[c];if(!(this.scoreFunction(b)<this.scoreFunction(d)))break;this.content[c]=b,this.content[a]=d,a=c}},sinkDown:function(a){for(var b=this.content.length,c=this.content[a],d=this.scoreFunction(c);;){var e=2*(a+1),f=e-1,g=-1,h=0;if(f<b){var i=this.content[f];h=this.scoreFunction(i),h<d&&(g=f)}if(e<b){var j=this.content[e],k=this.scoreFunction(j);k<(g==-1?d:h)&&(g=e)}if(g==-1)break;this.content[a]=this.content[g],this.content[g]=c,a=g}},__class__:la};var ma=b.core.KdPoint=function(a,b){this.point=a,this.obj=b};g["verb.core.KdPoint"]=ma,ma.__name__=["verb","core","KdPoint"],ma.prototype={__class__:ma};var na=b.core.KdNode=function(a,b,c){this.kdPoint=a,this.left=null,this.right=null,this.parent=c,this.dimension=b};g["verb.core.KdNode"]=na,na.__name__=["verb","core","KdNode"],na.prototype={__class__:na};var oa=function(){};g["verb.eval.IBoundingBoxTree"]=oa,oa.__name__=["verb","eval","IBoundingBoxTree"],oa.prototype={__class__:oa};var pa=function(a,b){this._boundingBox=null,this._curve=a,null==b&&(b=Ca.domain(this._curve.knots)/64),this._knotTol=b};g["verb.core.LazyCurveBoundingBoxTree"]=pa,pa.__name__=["verb","core","LazyCurveBoundingBoxTree"],pa.__interfaces__=[oa],pa.prototype={split:function(){var a=P.first(this._curve.knots),b=P.last(this._curve.knots),c=b-a,d=Ga.curveSplit(this._curve,(b+a)/2+.1*c*Math.random());return new _(new pa(d[0],this._knotTol),new pa(d[1],this._knotTol))},boundingBox:function(){return null==this._boundingBox&&(this._boundingBox=new R(Ia.dehomogenize1d(this._curve.controlPoints))),this._boundingBox},yield:function(){return this._curve},indivisible:function(a){return Ca.domain(this._curve.knots)<this._knotTol},empty:function(){return!1},__class__:pa};var qa=function(a,b){if(this._boundingBox=null,this._mesh=a,null==b){for(var c=[],d=0,e=a.faces.length;d<e;){var f=d++;c.push(f)}b=c}this._faceIndices=b};g["verb.core.LazyMeshBoundingBoxTree"]=qa,qa.__name__=["verb","core","LazyMeshBoundingBoxTree"],qa.__interfaces__=[oa],qa.prototype={split:function(){var a=va.sortTrianglesOnLongestAxis(this.boundingBox(),this._mesh,this._faceIndices),b=P.left(a),c=P.right(a);return new _(new qa(this._mesh,b),new qa(this._mesh,c))},boundingBox:function(){return null==this._boundingBox&&(this._boundingBox=va.makeMeshAabb(this._mesh,this._faceIndices)),this._boundingBox},yield:function(){return this._faceIndices[0]},indivisible:function(a){return 1==this._faceIndices.length},empty:function(){return 0==this._faceIndices.length},__class__:qa};var ra=function(a,b){this._boundingBox=null,this._polyline=a,null==b&&(b=new aa(0,0!=a.points.length?a.points.length-1:0)),this._interval=b};g["verb.core.LazyPolylineBoundingBoxTree"]=ra,ra.__name__=["verb","core","LazyPolylineBoundingBoxTree"],ra.__interfaces__=[oa],ra.prototype={split:function(){var a=this._interval.min,b=this._interval.max,c=a+Math.ceil((b-a)/2),d=new aa(a,c),e=new aa(c,b);return new _(new ra(this._polyline,d),new ra(this._polyline,e))},boundingBox:function(){return null==this._boundingBox&&(this._boundingBox=new R(this._polyline.points)),this._boundingBox},yield:function(){return this._interval.min},indivisible:function(a){return this._interval.max-this._interval.min==1},empty:function(){return this._interval.max-this._interval.min==0},__class__:ra};var sa=function(a,b,c,d){null==b&&(b=!1),this._boundingBox=null,this._surface=a,this._splitV=b,null==c&&(c=Ca.domain(a.knotsU)/16),null==d&&(d=Ca.domain(a.knotsV)/16),this._knotTolU=c,this._knotTolV=d};g["verb.core.LazySurfaceBoundingBoxTree"]=sa,sa.__name__=["verb","core","LazySurfaceBoundingBoxTree"],sa.__interfaces__=[oa],sa.prototype={split:function(){var a,b;this._splitV?(a=P.first(this._surface.knotsV),b=P.last(this._surface.knotsV)):(a=P.first(this._surface.knotsU),b=P.last(this._surface.knotsU));var c=(a+b)/2,d=Ga.surfaceSplit(this._surface,c,this._splitV);return new _(new sa(d[0],!this._splitV,this._knotTolU,this._knotTolV),new sa(d[1],!this._splitV,this._knotTolU,this._knotTolV))},boundingBox:function(){if(null==this._boundingBox){this._boundingBox=new R;for(var a=0,b=this._surface.controlPoints;a<b.length;){var c=b[a];++a,this._boundingBox.addRange(Ia.dehomogenize1d(c))}}return this._boundingBox},yield:function(){return this._surface},indivisible:function(a){return Ca.domain(this._surface.knotsV)<this._knotTolV&&Ca.domain(this._surface.knotsU)<this._knotTolU},empty:function(){return!1},__class__:sa};var ta=b.core.Mat=function(){};g["verb.core.Mat"]=ta,ta.__name__=["verb","core","Mat"],ta.mul=function(a,b){for(var c=[],d=0,e=b.length;d<e;){var f=d++;c.push(Ca.mul(a,b[f]))}return c},ta.mult=function(a,b){var c,d,e,f,g,h,i,j;c=a.length,d=b.length,e=b[0].length,f=[];for(var k=c-1,l=0,m=0;k>=0;){for(g=[],h=a[k],m=e-1;m>=0;){for(i=h[d-1]*b[d-1][m],l=d-2;l>=1;)j=l-1,i+=h[l]*b[l][m]+h[j]*b[j][m],l-=2;0==l&&(i+=h[0]*b[0][m]),g[m]=i,m--}f[k]=g,k--}return f},ta.add=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(Ca.add(a[f],b[f]))}return c},ta.div=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(Ca.div(a[f],b))}return c},ta.sub=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(Ca.sub(a[f],b[f]))}return c},ta.dot=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(Ca.dot(a[f],b))}return c},ta.identity=function(a){for(var b=Ca.zeros2d(a,a),c=0;c<a;){var d=c++;b[d][d]=1}return b},ta.transpose=function(a){if(0==a.length)return[];for(var b=[],c=0,d=a[0].length;c<d;){var e=c++;b.push(function(b){for(var c,d=[],f=0,g=a.length;f<g;){var h=f++;d.push(a[h][e])}return c=d}(this))}return b},ta.solve=function(a,b){return ta.LUsolve(ta.LU(a),b)},ta.LUsolve=function(a,b){var c,d,e,f,g,h=a.LU,i=h.length,j=b.slice(),k=a.P;for(c=i-1;c!=-1;)j[c]=b[c],--c;for(c=0;c<i;){for(e=k[c],k[c]!=c&&(g=j[c],j[c]=j[e],j[e]=g),f=h[c],d=0;d<c;)j[c]-=j[d]*f[d],++d;++c}for(c=i-1;c>=0;){for(f=h[c],d=c+1;d<i;)j[c]-=j[d]*f[d],++d;j[c]/=f[c],--c}return j},ta.LU=function(a){for(var b,c,d,e,f,g,h,i,j,k=(Math.abs,[]),l=0,m=a.length;l<m;){var n=l++;k.push(a[n].slice())}a=k;var o=a.length,p=o-1,q=[];for(d=0;d<o;){for(h=d,g=a[d],j=Math.abs(g[d]),c=d+1;c<o;)e=Math.abs(a[c][d]),j<e&&(j=e,h=c),++c;for(q[d]=h,h!=d&&(a[d]=a[h],a[h]=g,g=a[d]),f=g[d],b=d+1;b<o;)a[b][d]/=f,++b;for(b=d+1;b<o;){for(i=a[b],c=d+1;c<p;)i[c]-=i[d]*g[c],++c,i[c]-=i[d]*g[c],++c;c==p&&(i[c]-=i[d]*g[c]),++b}++d}return new ua(a,q)};var ua=function(a,b){this.LU=a,this.P=b};g["verb.core._Mat.LUDecomp"]=ua,ua.__name__=["verb","core","_Mat","LUDecomp"],ua.prototype={__class__:ua};var va=b.core.Mesh=function(){};g["verb.core.Mesh"]=va,va.__name__=["verb","core","Mesh"],va.getTriangleNorm=function(a,b){var c=a[b[0]],d=a[b[1]],e=a[b[2]],f=Ca.sub(d,c),g=Ca.sub(e,c),h=Ca.cross(f,g);return Ca.mul(1/Ca.norm(h),h)},va.makeMeshAabb=function(a,b){for(var c=new R,d=0;d<b.length;){var e=b[d];++d,c.add(a.points[a.faces[e][0]]),c.add(a.points[a.faces[e][1]]),c.add(a.points[a.faces[e][2]])}return c},va.sortTrianglesOnLongestAxis=function(a,b,c){for(var d=a.getLongestAxis(),e=[],f=0;f<c.length;){var g=c[f];++f;var h=va.getMinCoordOnAxis(b.points,b.faces[g],d);e.push(new _(h,g))}e.sort(function(a,b){var c=a.item0,d=b.item0;return c==d?0:c>d?1:-1});for(var i=[],j=0,k=e.length;j<k;){var l=j++;i.push(e[l].item1)}return i},va.getMinCoordOnAxis=function(a,b,c){for(var d=1/0,e=0;e<3;){var f=e++,g=a[b[f]][c];g<d&&(d=g)}return d},va.getTriangleCentroid=function(a,b){for(var c=[0,0,0],d=0;d<3;)for(var e=d++,f=0;f<3;){var g=f++;c[g]+=a[b[e]][g]}for(var h=0;h<3;){var i=h++;c[i]/=3}return c},va.triangleUVFromPoint=function(a,b,c){var d=a.faces[b],e=a.points[d[0]],f=a.points[d[1]],g=a.points[d[2]],h=a.uvs[d[0]],i=a.uvs[d[1]],j=a.uvs[d[2]],k=Ca.sub(e,c),l=Ca.sub(f,c),m=Ca.sub(g,c),n=Ca.norm(Ca.cross(Ca.sub(e,f),Ca.sub(e,g))),o=Ca.norm(Ca.cross(l,m))/n,p=Ca.norm(Ca.cross(m,k))/n,q=Ca.norm(Ca.cross(k,l))/n;return Ca.add(Ca.mul(o,h),Ca.add(Ca.mul(p,i),Ca.mul(q,j)))};var wa=function(a,b){if(this._empty=!1,this._face=-1,null==b){for(var c=[],d=0,e=a.faces.length;d<e;){var f=d++;c.push(f)}b=c}if(this._boundingBox=va.makeMeshAabb(a,b),b.length<1)return void(this._empty=!0);if(b.length<2)return void(this._face=b[0]);var g=va.sortTrianglesOnLongestAxis(this._boundingBox,a,b),h=P.left(g),i=P.right(g);this._children=new _(new wa(a,h),new wa(a,i))};g["verb.core.MeshBoundingBoxTree"]=wa,wa.__name__=["verb","core","MeshBoundingBoxTree"],wa.__interfaces__=[oa],wa.prototype={split:function(){return this._children},boundingBox:function(){return this._boundingBox},yield:function(){return this._face},indivisible:function(a){return null==this._children},empty:function(){return this._empty},__class__:wa};var xa=b.core.Minimizer=function(){};g["verb.core.Minimizer"]=xa,xa.__name__=["verb","core","Minimizer"],xa.uncmin=function(a,b,c,d,e){null==c&&(c=1e-8),null==d&&(d=function(b){return xa.numericalGradient(a,b)}),null==e&&(e=1e3),b=b.slice(0);var f,g=b.length,h=a(b),i=h;if(isNaN(h))throw new C("uncmin: f(x0) is a NaN!");c=Math.max(c,S.EPSILON);var j,k,l,m,n,o,p,q,r,s=ta.identity(g),t=0,u=[],v="";for(k=d(b);t<e;){if(!Ca.all(Ca.finite(k))){v="Gradient has Infinity or NaN";break}if(j=Ca.neg(ta.dot(s,k)),!Ca.all(Ca.finite(j))){v="Search direction has Infinity or NaN";break}if(r=Ca.norm(j),r<c){v="Newton step smaller than tol";break}for(q=1,f=Ca.dot(k,j),m=b;t<e&&!(q*r<c)&&(u=Ca.mul(q,j),m=Ca.add(b,u),i=a(m),i-h>=.1*q*f||isNaN(i));)q*=.5,++t;if(q*r<c){v="Line search step size smaller than tol";break}if(t==e){v="maxit reached during line search";break}l=d(m),n=Ca.sub(l,k),p=Ca.dot(n,u),o=ta.dot(s,n),s=ta.sub(ta.add(s,ta.mul((p+Ca.dot(n,o))/(p*p),xa.tensor(u,u))),ta.div(ta.add(xa.tensor(o,u),xa.tensor(u,o)),p)),b=m,h=i,k=l,++t}return new ya(b,h,k,s,t,v)},xa.numericalGradient=function(a,b){var c=b.length,d=a(b);if(NaN==d)throw new C("gradient: f(x) is a NaN!");for(var e,f,g,h,i,j,k,l,m,n=b.slice(0),o=[],p=.001,q=0,r=0;r<c;)for(var s=r++,t=Math.max(1e-6*d,1e-8);;){if(++q,q>20)throw new C("Numerical gradient fails");if(n[s]=b[s]+t,e=a(n),n[s]=b[s]-t,f=a(n),n[s]=b[s],isNaN(e)||isNaN(f))t/=16;else{if(o[s]=(e-f)/(2*t),h=b[s]-t,i=b[s],j=b[s]+t,k=(e-d)/t,l=(d-f)/t,m=Ca.max([Math.abs(o[s]),Math.abs(d),Math.abs(e),Math.abs(f),Math.abs(h),Math.abs(i),Math.abs(j),1e-8]),g=Math.min(Ca.max([Math.abs(k-o[s]),Math.abs(l-o[s]),Math.abs(k-l)])/m,t/m),!(g>p))break;t/=16}}return o},xa.tensor=function(a,b){for(var c,d,e=a.length,f=b.length,g=[],h=e-1;h>=0;){c=[],d=a[h];for(var i=f-1;i>=3;)c[i]=d*b[i],--i,c[i]=d*b[i],--i,c[i]=d*b[i],--i,c[i]=d*b[i],--i;for(;i>=0;)c[i]=d*b[i],--i;g[h]=c,h--}return g};var ya=function(a,b,c,d,e,f){this.solution=a,this.value=b,this.gradient=c,this.invHessian=d,this.iterations=e,this.message=f};g["verb.core.MinimizationResult"]=ya,ya.__name__=["verb","core","MinimizationResult"],ya.prototype={__class__:ya};var za=function(){};g["verb.core.ISerializable"]=za,za.__name__=["verb","core","ISerializable"],za.prototype={__class__:za};var Aa=b.core.Deserializer=function(){};g["verb.core.Deserializer"]=Aa,Aa.__name__=["verb","core","Deserializer"],Aa.deserialize=function(a){var b=new u(a),c=b.unserialize();return c};var Ba=b.core.Trig=function(){};g["verb.core.Trig"]=Ba,Ba.__name__=["verb","core","Trig"],Ba.isPointInPlane=function(a,b,c){return Math.abs(Ca.dot(Ca.sub(a,b.origin),b.normal))<c},Ba.distToSegment=function(a,b,c){var d=Ba.segmentClosestPoint(b,a,c,0,1);return Ca.dist(b,d.pt)},Ba.rayClosestPoint=function(a,b,c){var d=Ca.sub(a,b),e=Ca.dot(d,c),f=Ca.add(b,Ca.mul(e,c));return f},Ba.distToRay=function(a,b,c){var d=Ba.rayClosestPoint(a,b,c),e=Ca.sub(d,a);return Ca.norm(e)},Ba.threePointsAreFlat=function(a,b,c,d){var e=Ca.sub(b,a),f=Ca.sub(c,a),g=Ca.cross(e,f),h=Ca.dot(g,g);return h<d},Ba.segmentClosestPoint=function(a,b,c,d,e){var f=Ca.sub(c,b),g=Ca.norm(f);if(g<S.EPSILON)return{u:d,pt:b};var h=b,i=Ca.mul(1/g,f),j=Ca.sub(a,h),k=Ca.dot(j,i);return k<0?{u:d,pt:b}:k>g?{u:e,pt:c}:{u:d+(e-d)*k/g,pt:Ca.add(h,Ca.mul(k,i))}};var Ca=b.core.Vec=function(){};g["verb.core.Vec"]=Ca,Ca.__name__=["verb","core","Vec"],Ca.angleBetween=function(a,b){return Math.acos(Ca.dot(a,b)/(Ca.norm(a)*Ca.norm(b)))},Ca.positiveAngleBetween=function(a,b,c){var d=Ca.cross(a,b),e=Ca.norm(a),f=Ca.norm(b),g=e*f,h=Ca.dot(a,b),i=Ca.norm(d)/g,j=h/g,k=Math.atan2(i,j),l=Ca.dot(c,d);return Math.abs(l)<S.EPSILON?k:l>0?k:-k},Ca.signedAngleBetween=function(a,b,c){var d=Ca.cross(a,b),e=Ca.norm(a),f=Ca.norm(b),g=e*f,h=Ca.dot(a,b),i=Ca.norm(d)/g,j=h/g,k=Math.atan2(i,j),l=Ca.dot(c,d);return l>0?k:2*Math.PI-k},Ca.angleBetweenNormalized2d=function(a,b){var c=a[0]*b[1]-a[1]*b[0];return Math.atan2(c,Ca.dot(a,b))},Ca.domain=function(a){return P.last(a)-P.first(a)},Ca.range=function(a){for(var b=[],c=0,d=0;d<a;){d++;b.push(c),c+=1}return b},Ca.span=function(a,b,c){if(null==c)return[];if(c<S.EPSILON)return[];if(a>b&&c>0)return[];if(b>a&&c<0)return[];for(var d=[],e=a;e<=b;)d.push(e),e+=c;return d},Ca.neg=function(a){return a.map(function(a){return-a})},Ca.min=function(a){return j.fold(a,function(a,b){return Math.min(a,b)},1/0)},Ca.max=function(a){return j.fold(a,function(a,b){return Math.max(a,b)},-(1/0))},Ca.all=function(a){return j.fold(a,function(a,b){return b&&a},!0)},Ca.finite=function(a){return a.map(function(a){return isFinite(a)})},Ca.onRay=function(a,b,c){return Ca.add(a,Ca.mul(c,b))},Ca.lerp=function(a,b,c){return Ca.add(Ca.mul(a,b),Ca.mul(1-a,c))},Ca.normalized=function(a){return Ca.div(a,Ca.norm(a))},Ca.cross=function(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]},Ca.dist=function(a,b){return Ca.norm(Ca.sub(a,b))},Ca.distSquared=function(a,b){return Ca.normSquared(Ca.sub(a,b))},Ca.sum=function(a){return j.fold(a,function(a,b){return b+a},0)},Ca.addAll=function(a){var b=e(a)();if(!b.hasNext())return null;var c=b.next().length;return j.fold(a,function(a,b){return Ca.add(b,a)},Ca.rep(c,0))},Ca.norm=function(a){var b=Ca.normSquared(a);return 0!=b?Math.sqrt(b):b},Ca.normSquared=function(a){return j.fold(a,function(a,b){return b+a*a},0)},Ca.rep=function(a,b){for(var c=[],d=0;d<a;){d++;c.push(b)}return c},Ca.zeros1d=function(a){for(var b=[],c=0;c<a;){c++;b.push(0)}return b},Ca.zeros2d=function(a,b){for(var c=[],d=0;d<a;){d++;c.push(Ca.zeros1d(b))}return c},Ca.zeros3d=function(a,b,c){for(var d=[],e=0;e<a;){e++;d.push(Ca.zeros2d(b,c))}return d},Ca.dot=function(a,b){for(var c=0,d=0,e=a.length;d<e;){var f=d++;c+=a[f]*b[f]}return c},Ca.add=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(a[f]+b[f])}return c},Ca.mul=function(a,b){for(var c=[],d=0,e=b.length;d<e;){var f=d++;c.push(a*b[f])}return c},Ca.div=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(a[f]/b)}return c},Ca.sub=function(a,b){for(var c=[],d=0,e=a.length;d<e;){var f=d++;c.push(a[f]-b[f])}return c},Ca.isZero=function(a){for(var b=0,c=a.length;b<c;){var d=b++;if(Math.abs(a[d])>S.TOLERANCE)return!1}return!0},Ca.sortedSetUnion=function(a,b){for(var c=[],d=0,e=0;d<a.length||e<b.length;)if(d>=a.length)c.push(b[e]),e++;else if(e>=b.length)c.push(a[d]),d++;else{var f=a[d]-b[e];Math.abs(f)<S.EPSILON?(c.push(a[d]),d++,e++):f>0?(c.push(b[e]),e++):(c.push(a[d]),d++)}return c},Ca.sortedSetSub=function(a,b){for(var c=[],d=0,e=0;d<a.length;)e>=b.length?(c.push(a[d]),d++):Math.abs(a[d]-b[e])<S.EPSILON?(d++,e++):(c.push(a[d]),d++);return c};var Da=b.eval.Analyze=function(){};g["verb.eval.Analyze"]=Da,Da.__name__=["verb","eval","Analyze"],Da.knotMultiplicities=function(a){for(var b=[new Ea(a[0],0)],c=b[0],d=0;d<a.length;){var e=a[d];++d,Math.abs(e-c.knot)>S.EPSILON&&(c=new Ea(e,0),b.push(c)),c.inc()}return b},Da.isRationalSurfaceClosed=function(a,b){null==b&&(b=!0);var c;c=b?a.controlPoints:ta.transpose(a.controlPoints);for(var d=0,e=c[0].length;d<e;){var f=d++,g=Ca.dist(P.first(c)[f],P.last(c)[f])<S.EPSILON;if(!g)return!1}return!0},Da.rationalSurfaceClosestPoint=function(a,b){var c=Da.rationalSurfaceClosestParam(a,b);return Ia.rationalSurfacePoint(a,c[0],c[1])},Da.rationalSurfaceClosestParam=function(a,b){for(var c,d,e,f=5,g=0,h=1e-4,i=5e-4,j=a.knotsU[0],k=P.last(a.knotsU),l=a.knotsV[0],m=P.last(a.knotsV),n=Da.isRationalSurfaceClosed(a),o=Da.isRationalSurfaceClosed(a,!1),p=Ma.rationalSurfaceAdaptive(a,new Na),q=1/0,r=0,s=p.points.length;r<s;){var t=r++,u=p.points[t],v=Ca.normSquared(Ca.sub(b,u));v<q&&(q=v,e=p.uvs[t])}for(var w=function(b){return Ia.rationalSurfaceDerivatives(a,b[0],b[1],2)},x=function(a,b,c){var d=b[1][0],e=b[0][1],f=b[2][0],g=b[0][2],h=b[1][1],i=b[1][1],j=Ca.dot(d,c),k=Ca.dot(e,c),l=[-j,-k],m=Ca.dot(d,d)+Ca.dot(f,c),n=Ca.dot(d,e)+Ca.dot(h,c),o=Ca.dot(d,e)+Ca.dot(i,c),p=Ca.dot(e,e)+Ca.dot(g,c),q=[[m,n],[o,p]],r=ta.solve(q,l);return Ca.add(r,a)};g<f;){c=w(e),d=Ca.sub(c[0][0],b);var y=Ca.norm(d),z=Ca.dot(c[1][0],d),A=Ca.norm(c[1][0])*y,B=Ca.dot(c[0][1],d),C=Ca.norm(c[0][1])*y,D=z/A,E=B/C,F=y<h,G=D<i,H=E<i;if(F&&G&&H)return e;var I=x(e,c,d);I[0]<j?I=n?[k-(I[0]-j),I[1]]:[j+S.EPSILON,I[1]]:I[0]>k&&(I=n?[j+(I[0]-k),I[1]]:[k-S.EPSILON,I[1]]),I[1]<l?I=o?[I[0],m-(I[1]-l)]:[I[0],l+S.EPSILON]:I[1]>m&&(I=o?[I[0],l+(I[0]-m)]:[I[0],m-S.EPSILON]);var J=Ca.norm(Ca.mul(I[0]-e[0],c[1][0])),K=Ca.norm(Ca.mul(I[1]-e[1],c[0][1]));if(J+K<h)return e;e=I,g++}return e},Da.rationalCurveClosestPoint=function(a,b){return Ia.rationalCurvePoint(a,Da.rationalCurveClosestParam(a,b))},Da.rationalCurveClosestParam=function(a,b){for(var c=1/0,d=0,e=Ma.rationalCurveRegularSample(a,a.controlPoints.length*a.degree,!0),f=0,g=e.length-1;f<g;){var h=f++,i=e[h][0],j=e[h+1][0],k=e[h].slice(1),l=e[h+1].slice(1),m=Ba.segmentClosestPoint(b,k,l,i,j),n=Ca.norm(Ca.sub(b,m.pt));n<c&&(c=n,d=m.u)}for(var o,p,q=5,r=0,s=1e-4,t=5e-4,u=a.knots[0],v=P.last(a.knots),w=Ca.normSquared(Ca.sub(a.controlPoints[0],P.last(a.controlPoints)))<S.EPSILON,x=d,y=function(b){return Ia.rationalCurveDerivatives(a,b,2)},z=function(a,b,c){var d=Ca.dot(b[1],c),e=Ca.dot(b[2],c),f=Ca.dot(b[1],b[1]),g=e+f;return a-d/g};r<q;){o=y(x),p=Ca.sub(o[0],b);var A=Ca.norm(p),B=Ca.dot(o[1],p),C=Ca.norm(o[1])*A,D=B/C,E=A<s,F=Math.abs(D)<t;if(E&&F)return x;var G=z(x,o,p);G<u?G=w?v-(G-u):u:G>v&&(G=w?u+(G-v):v);var H=Ca.norm(Ca.mul(G-x,o[1]));if(H<s)return x;x=G,r++}return x},Da.rationalCurveParamAtArcLength=function(a,b,c,d,e){if(null==c&&(c=.001),b<S.EPSILON)return a.knots[0];var f;f=null!=d?d:La.decomposeCurveIntoBeziers(a);var g,h=0,i=(f[h],-S.EPSILON);for(g=null!=e?e:[];i<b&&h<f.length;){if(h<g.length?g[h]=g[h]:g[h]=Da.rationalBezierCurveArcLength(a),i+=g[h],b<i+S.EPSILON)return Da.rationalBezierCurveParamAtArcLength(a,b,c,g[h]);h++}return-1},Da.rationalBezierCurveParamAtArcLength=function(a,b,c,d){if(b<0)return a.knots[0];var e;if(e=null!=d?d:Da.rationalBezierCurveArcLength(a),b>e)return P.last(a.knots);var f,g=a.knots[0],h=0,i=P.last(a.knots),j=e,k=0,l=0;for(f=null!=c?c:2*S.TOLERANCE;j-h>f;)k=(g+i)/2,l=Da.rationalBezierCurveArcLength(a,k),l>b?(i=k,j=l):(g=k,h=l);return(g+i)/2},Da.rationalCurveArcLength=function(a,b,c){null==c&&(c=16),b=null==b?P.last(a.knots):b;for(var d=La.decomposeCurveIntoBeziers(a),e=0,f=d[0],g=0;e<d.length&&f.knots[0]+S.EPSILON<b;){var h=Math.min(P.last(f.knots),b);g+=Da.rationalBezierCurveArcLength(f,h,c),f=d[++e]}return g},Da.rationalBezierCurveArcLength=function(a,b,c){null==c&&(c=16);var d;d=null==b?P.last(a.knots):b;for(var e,f,g=(d-a.knots[0])/2,h=0,i=a.degree+c,j=0;j<i;){var k=j++;e=g*Da.Tvalues[i][k]+g+a.knots[0],f=Ia.rationalCurveDerivatives(a,e,1),h+=Da.Cvalues[i][k]*Ca.norm(f[1])}return g*h};var Ea=b.eval.KnotMultiplicity=function(a,b){this.knot=a,this.mult=b};g["verb.eval.KnotMultiplicity"]=Ea,Ea.__name__=["verb","eval","KnotMultiplicity"],Ea.prototype={inc:function(){this.mult++},__class__:Ea};var Fa=b.eval.Check=function(){};g["verb.eval.Check"]=Fa,Fa.__name__=["verb","eval","Check"],Fa.isValidKnotVector=function(a,b){if(0==a.length)return!1;if(a.length<2*(b+1))return!1;for(var c=P.first(a),d=0,e=b+1;d<e;){var f=d++;if(Math.abs(a[f]-c)>S.EPSILON)return!1}c=P.last(a);for(var g=a.length-b-1,h=a.length;g<h;){var i=g++;if(Math.abs(a[i]-c)>S.EPSILON)return!1}return Fa.isNonDecreasing(a)},Fa.isNonDecreasing=function(a){for(var b=P.first(a),c=0,d=a.length;c<d;){var e=c++;if(a[e]<b-S.EPSILON)return!1;b=a[e]}return!0},
Fa.isValidNurbsCurveData=function(a){if(null==a.controlPoints)throw new C("Control points array cannot be null!");if(null==a.degree)throw new C("Degree cannot be null!");if(a.degree<1)throw new C("Degree must be greater than 1!");if(null==a.knots)throw new C("Knots cannot be null!");if(a.knots.length!=a.controlPoints.length+a.degree+1)throw new C("controlPoints.length + degree + 1 must equal knots.length!");if(!Fa.isValidKnotVector(a.knots,a.degree))throw new C("Invalid knot vector format!  Should begin with degree + 1 repeats and end with degree + 1 repeats!");return a},Fa.isValidNurbsSurfaceData=function(a){if(null==a.controlPoints)throw new C("Control points array cannot be null!");if(null==a.degreeU)throw new C("DegreeU cannot be null!");if(null==a.degreeV)throw new C("DegreeV cannot be null!");if(a.degreeU<1)throw new C("DegreeU must be greater than 1!");if(a.degreeV<1)throw new C("DegreeV must be greater than 1!");if(null==a.knotsU)throw new C("KnotsU cannot be null!");if(null==a.knotsV)throw new C("KnotsV cannot be null!");if(a.knotsU.length!=a.controlPoints.length+a.degreeU+1)throw new C("controlPointsU.length + degreeU + 1 must equal knotsU.length!");if(a.knotsV.length!=a.controlPoints[0].length+a.degreeV+1)throw new C("controlPointsV.length + degreeV + 1 must equal knotsV.length!");if(!Fa.isValidKnotVector(a.knotsU,a.degreeU)||!Fa.isValidKnotVector(a.knotsV,a.degreeV))throw new C("Invalid knot vector format!  Should begin with degree + 1 repeats and end with degree + 1 repeats!");return a};var Ga=b.eval.Divide=function(){};g["verb.eval.Divide"]=Ga,Ga.__name__=["verb","eval","Divide"],Ga.surfaceSplit=function(a,b,c){null==c&&(c=!1);var d,e,f;c?(f=a.controlPoints,d=a.knotsV,e=a.degreeV):(f=ta.transpose(a.controlPoints),d=a.knotsU,e=a.degreeU);for(var g,h=[],i=0,j=e+1;i<j;){i++;h.push(b)}g=h;for(var k=[],l=[],m=Ia.knotSpan(e,b,d),n=null,o=0;o<f.length;){var p=f[o];++o,n=La.curveKnotRefine(new W(e,d,p),g),k.push(n.controlPoints.slice(0,m+1)),l.push(n.controlPoints.slice(m+1))}var q=n.knots.slice(0,m+e+2),r=n.knots.slice(m+1);return c?[new X(a.degreeU,e,a.knotsU.slice(),q,k),new X(a.degreeU,e,a.knotsU.slice(),r,l)]:(k=ta.transpose(k),l=ta.transpose(l),[new X(e,a.degreeV,q,a.knotsV.slice(),k),new X(e,a.degreeV,r,a.knotsV.slice(),l)])},Ga.curveSplit=function(a,b){for(var c,d=a.degree,e=(a.controlPoints,a.knots),f=[],g=0,h=d+1;g<h;){g++;f.push(b)}c=f;var i=La.curveKnotRefine(a,c),j=Ia.knotSpan(d,b,e),k=i.knots.slice(0,j+d+2),l=i.knots.slice(j+1),m=i.controlPoints.slice(0,j+1),n=i.controlPoints.slice(j+1);return[new W(d,k,m),new W(d,l,n)]},Ga.rationalCurveByEqualArcLength=function(a,b){var c=Da.rationalCurveArcLength(a),d=c/b;return Ga.rationalCurveByArcLength(a,d)},Ga.rationalCurveByArcLength=function(a,b){var c=La.decomposeCurveIntoBeziers(a),d=c.map(function(a){return Da.rationalBezierCurveArcLength(a)}),e=Ca.sum(d),f=[new Ha(a.knots[0],0)];if(b>e)return f;for(var g,h=b,i=0,j=h,k=0,l=0;i<c.length;){for(k+=d[i];j<k+S.EPSILON;)g=Da.rationalBezierCurveParamAtArcLength(c[i],j-l,S.TOLERANCE,d[i]),f.push(new Ha(g,j)),j+=h;l+=d[i],i++}return f};var Ha=b.eval.CurveLengthSample=function(a,b){this.u=a,this.len=b};g["verb.eval.CurveLengthSample"]=Ha,Ha.__name__=["verb","eval","CurveLengthSample"],Ha.prototype={__class__:Ha};var Ia=b.eval.Eval=function(){};g["verb.eval.Eval"]=Ia,Ia.__name__=["verb","eval","Eval"],Ia.rationalCurveTangent=function(a,b){var c=Ia.rationalCurveDerivatives(a,b,1);return c[1]},Ia.rationalSurfaceNormal=function(a,b,c){var d=Ia.rationalSurfaceDerivatives(a,b,c,1);return Ca.cross(d[1][0],d[0][1])},Ia.rationalSurfaceDerivatives=function(a,b,c,d){null==d&&(d=1);for(var e=Ia.surfaceDerivatives(a,b,c,d),f=Ia.rational2d(e),g=Ia.weight2d(e),h=[],i=f[0][0].length,j=0,k=d+1;j<k;){var l=j++;h.push([]);for(var m=0,n=d-l+1;m<n;){for(var o=m++,p=f[l][o],q=1,r=o+1;q<r;){var s=q++;p=Ca.sub(p,Ca.mul(Q.get(o,s)*g[0][s],h[l][o-s]))}for(var t=1,u=l+1;t<u;){var v=t++;p=Ca.sub(p,Ca.mul(Q.get(l,v)*g[v][0],h[l-v][o]));for(var w=Ca.zeros1d(i),x=1,y=o+1;x<y;){var z=x++;w=Ca.add(w,Ca.mul(Q.get(o,z)*g[v][z],h[l-v][o-z]))}p=Ca.sub(p,Ca.mul(Q.get(l,v),w))}h[l].push(Ca.mul(1/g[0][0],p))}}return h},Ia.rationalSurfacePoint=function(a,b,c){return Ia.dehomogenize(Ia.surfacePoint(a,b,c))},Ia.rationalCurveDerivatives=function(a,b,c){null==c&&(c=1);for(var d=Ia.curveDerivatives(a,b,c),e=Ia.rational1d(d),f=Ia.weight1d(d),g=[],h=0,i=c+1;h<i;){for(var j=h++,k=e[j],l=1,m=j+1;l<m;){var n=l++;k=Ca.sub(k,Ca.mul(Q.get(j,n)*f[n],g[j-n]))}g.push(Ca.mul(1/f[0],k))}return g},Ia.rationalCurvePoint=function(a,b){return Ia.dehomogenize(Ia.curvePoint(a,b))},Ia.surfaceDerivatives=function(a,b,c,d){var e=a.knotsU.length-a.degreeU-2,f=a.knotsV.length-a.degreeV-2;return Ia.surfaceDerivativesGivenNM(e,f,a,b,c,d)},Ia.surfaceDerivativesGivenNM=function(a,b,c,d,e,f){var g=c.degreeU,h=c.degreeV,i=c.controlPoints,j=c.knotsU,k=c.knotsV;if(!Ia.areValidRelations(g,i.length,j.length)||!Ia.areValidRelations(h,i[0].length,k.length))throw new C("Invalid relations between control points, knot vector, and n");var l,m=i[0][0].length;l=f<g?f:g;var n;n=f<h?f:h;for(var o=Ca.zeros3d(f+1,f+1,m),p=Ia.knotSpanGivenN(a,g,d,j),q=Ia.knotSpanGivenN(b,h,e,k),r=Ia.derivativeBasisFunctionsGivenNI(p,d,g,a,j),s=Ia.derivativeBasisFunctionsGivenNI(q,e,h,b,k),t=Ca.zeros2d(h+1,m),u=0,v=0,w=l+1;v<w;){for(var x=v++,y=0,z=h+1;y<z;){var A=y++;t[A]=Ca.zeros1d(m);for(var B=0,D=g+1;B<D;){var E=B++;t[A]=Ca.add(t[A],Ca.mul(r[x][E],i[p-g+E][q-h+A]))}}var F=f-x;u=F<n?F:n;for(var G=0,H=u+1;G<H;){var I=G++;o[x][I]=Ca.zeros1d(m);for(var J=0,K=h+1;J<K;){var L=J++;o[x][I]=Ca.add(o[x][I],Ca.mul(s[I][L],t[L]))}}}return o},Ia.surfacePoint=function(a,b,c){var d=a.knotsU.length-a.degreeU-2,e=a.knotsV.length-a.degreeV-2;return Ia.surfacePointGivenNM(d,e,a,b,c)},Ia.surfacePointGivenNM=function(a,b,c,d,e){var f=c.degreeU,g=c.degreeV,h=c.controlPoints,i=c.knotsU,j=c.knotsV;if(!Ia.areValidRelations(f,h.length,i.length)||!Ia.areValidRelations(g,h[0].length,j.length))throw new C("Invalid relations between control points, knot vector, and n");for(var k=h[0][0].length,l=Ia.knotSpanGivenN(a,f,d,i),m=Ia.knotSpanGivenN(b,g,e,j),n=Ia.basisFunctionsGivenKnotSpanIndex(l,d,f,i),o=Ia.basisFunctionsGivenKnotSpanIndex(m,e,g,j),p=l-f,q=m,r=Ca.zeros1d(k),s=Ca.zeros1d(k),t=0,u=g+1;t<u;){var v=t++;s=Ca.zeros1d(k),q=m-g+v;for(var w=0,x=f+1;w<x;){var y=w++;s=Ca.add(s,Ca.mul(n[y],h[p+y][q]))}r=Ca.add(r,Ca.mul(o[v],s))}return r},Ia.curveDerivatives=function(a,b,c){var d=a.knots.length-a.degree-2;return Ia.curveDerivativesGivenN(d,a,b,c)},Ia.curveDerivativesGivenN=function(a,b,c,d){var e=b.degree,f=b.controlPoints,g=b.knots;if(!Ia.areValidRelations(e,f.length,g.length))throw new C("Invalid relations between control points, knot vector, and n");var h,i=f[0].length;h=d<e?d:e;for(var j=Ca.zeros2d(d+1,i),k=Ia.knotSpanGivenN(a,e,c,g),l=Ia.derivativeBasisFunctionsGivenNI(k,c,e,h,g),m=0,n=h+1;m<n;)for(var o=m++,p=0,q=e+1;p<q;){var r=p++;j[o]=Ca.add(j[o],Ca.mul(l[o][r],f[k-e+r]))}return j},Ia.curvePoint=function(a,b){var c=a.knots.length-a.degree-2;return Ia.curvePointGivenN(c,a,b)},Ia.areValidRelations=function(a,b,c){return b+a+1-c==0},Ia.curvePointGivenN=function(a,b,c){var d=b.degree,e=b.controlPoints,f=b.knots;if(!Ia.areValidRelations(d,e.length,f.length))throw new C("Invalid relations between control points, knot Array, and n");for(var g=Ia.knotSpanGivenN(a,d,c,f),h=Ia.basisFunctionsGivenKnotSpanIndex(g,c,d,f),i=Ca.zeros1d(e[0].length),j=0,k=d+1;j<k;){var l=j++;i=Ca.add(i,Ca.mul(h[l],e[g-d+l]))}return i},Ia.volumePoint=function(a,b,c,d){var e=a.knotsU.length-a.degreeU-2,f=a.knotsV.length-a.degreeV-2,g=a.knotsW.length-a.degreeW-2;return Ia.volumePointGivenNML(a,e,f,g,b,c,d)},Ia.volumePointGivenNML=function(a,b,c,d,e,f,g){if(!Ia.areValidRelations(a.degreeU,a.controlPoints.length,a.knotsU.length)||!Ia.areValidRelations(a.degreeV,a.controlPoints[0].length,a.knotsV.length)||!Ia.areValidRelations(a.degreeW,a.controlPoints[0][0].length,a.knotsW.length))throw new C("Invalid relations between control points and knot vector");for(var h=a.controlPoints,i=a.degreeU,j=a.degreeV,k=a.degreeW,l=a.knotsU,m=a.knotsV,n=a.knotsW,o=h[0][0][0].length,p=Ia.knotSpanGivenN(b,i,e,l),q=Ia.knotSpanGivenN(c,j,f,m),r=Ia.knotSpanGivenN(d,k,g,n),s=Ia.basisFunctionsGivenKnotSpanIndex(p,e,i,l),t=Ia.basisFunctionsGivenKnotSpanIndex(q,f,j,m),u=Ia.basisFunctionsGivenKnotSpanIndex(r,g,k,n),v=p-i,w=Ca.zeros1d(o),x=Ca.zeros1d(o),y=Ca.zeros1d(o),z=0,A=k+1;z<A;){var B=z++;y=Ca.zeros1d(o);for(var D=r-k+B,E=0,F=j+1;E<F;){var G=E++;x=Ca.zeros1d(o);for(var H=q-j+G,I=0,J=i+1;I<J;){var K=I++;x=Ca.add(x,Ca.mul(s[K],h[v+K][H][D]))}y=Ca.add(y,Ca.mul(t[G],x))}w=Ca.add(w,Ca.mul(u[B],y))}return w},Ia.derivativeBasisFunctions=function(a,b,c){var d=Ia.knotSpan(b,a,c),e=c.length-1,f=e-b-1;return Ia.derivativeBasisFunctionsGivenNI(d,a,b,f,c)},Ia.derivativeBasisFunctionsGivenNI=function(a,b,c,d,e){var f=Ca.zeros2d(c+1,c+1),g=Ca.zeros1d(c+1),h=Ca.zeros1d(c+1),i=0,j=0;f[0][0]=1;for(var k=1,l=c+1;k<l;){var m=k++;g[m]=b-e[a+1-m],h[m]=e[a+m]-b,i=0;for(var n=0;n<m;){var o=n++;f[m][o]=h[o+1]+g[m-o],j=f[o][m-1]/f[m][o],f[o][m]=i+h[o+1]*j,i=g[m-o]*j}f[m][m]=i}for(var p=Ca.zeros2d(d+1,c+1),q=Ca.zeros2d(2,c+1),r=0,s=1,t=0,u=0,v=0,w=0,x=0,y=0,z=c+1;y<z;){var A=y++;p[0][A]=f[A][c]}for(var B=0,C=c+1;B<C;){var D=B++;r=0,s=1,q[0][0]=1;for(var E=1,F=d+1;E<F;){var G=E++;t=0,u=D-G,v=c-G,D>=G&&(q[s][0]=q[r][0]/f[v+1][u],t=q[s][0]*f[u][v]),w=u>=-1?1:-u,x=D-1<=v?G-1:c-D;for(var H=w,I=x+1;H<I;){var J=H++;q[s][J]=(q[r][J]-q[r][J-1])/f[v+1][u+J],t+=q[s][J]*f[u+J][v]}D<=v&&(q[s][G]=-q[r][G-1]/f[v+1][D],t+=q[s][G]*f[D][v]),p[G][D]=t;var K=r;r=s,s=K}}for(var L=c,M=1,N=d+1;M<N;){for(var O=M++,P=0,Q=c+1;P<Q;){var R=P++;p[O][R]*=L}L*=c-O}return p},Ia.basisFunctions=function(a,b,c){var d=Ia.knotSpan(b,a,c);return Ia.basisFunctionsGivenKnotSpanIndex(d,a,b,c)},Ia.basisFunctionsGivenKnotSpanIndex=function(a,b,c,d){var e=Ca.zeros1d(c+1),f=Ca.zeros1d(c+1),g=Ca.zeros1d(c+1),h=0,i=0;e[0]=1;for(var j=1,k=c+1;j<k;){var l=j++;f[l]=b-d[a+1-l],g[l]=d[a+l]-b,h=0;for(var m=0;m<l;){var n=m++;i=e[n]/(g[n+1]+f[l-n]),e[n]=h+g[n+1]*i,h=f[l-n]*i}e[l]=h}return e},Ia.knotSpan=function(a,b,c){return Ia.knotSpanGivenN(c.length-a-2,a,b,c)},Ia.knotSpanGivenN=function(a,b,c,d){if(c>d[a+1]-S.EPSILON)return a;if(c<d[b]+S.EPSILON)return b;for(var e=b,f=a+1,g=Math.floor((e+f)/2);c<d[g]||c>=d[g+1];)c<d[g]?f=g:e=g,g=Math.floor((e+f)/2);return g},Ia.dehomogenize=function(a){for(var b=a.length,c=[],d=a[b-1],e=a.length-1,f=0;f<e;){var g=f++;c.push(a[g]/d)}return c},Ia.rational1d=function(a){var b=a[0].length-1;return a.map(function(a){return a.slice(0,b)})},Ia.rational2d=function(a){return a.map(Ia.rational1d)},Ia.weight1d=function(a){var b=a[0].length-1;return a.map(function(a){return a[b]})},Ia.weight2d=function(a){return a.map(Ia.weight1d)},Ia.dehomogenize1d=function(a){return a.map(Ia.dehomogenize)},Ia.dehomogenize2d=function(a){return a.map(Ia.dehomogenize1d)},Ia.homogenize1d=function(a,b){var c,d=a.length,e=a[0].length,f=[],g=0,h=[];c=null!=b?b:Ca.rep(a.length,1);for(var i=0;i<d;){var j=i++,k=[];h=a[j],g=c[j];for(var l=0;l<e;){var m=l++;k.push(h[m]*g)}k.push(g),f.push(k)}return f},Ia.homogenize2d=function(a,b){var c,d=a.length,e=[];if(null!=b)c=b;else{for(var f=[],g=0;g<d;){g++;f.push(Ca.rep(a[0].length,1))}c=f}for(var h=0;h<d;){var i=h++;e.push(Ia.homogenize1d(a[i],c[i]))}return e};var Ja=b.eval.Intersect=function(){};g["verb.eval.Intersect"]=Ja,Ja.__name__=["verb","eval","Intersect"],Ja.surfaces=function(a,b,c){var d=Ma.rationalSurfaceAdaptive(a),e=Ma.rationalSurfaceAdaptive(b),f=Ja.meshes(d,e),g=f.map(function(d){return d.map(function(d){return Ja.surfacesAtPointWithEstimate(a,b,d.uv0,d.uv1,c)})});return g.map(function(a){return Ka.rationalInterpCurve(a.map(function(a){return a.point}),3)})},Ja.surfacesAtPointWithEstimate=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s=5,t=0;do{if(f=Ia.rationalSurfaceDerivatives(a,c[0],c[1],1),g=f[0][0],i=f[1][0],j=f[0][1],h=Ca.normalized(Ca.cross(i,j)),k=Ca.dot(h,g),l=Ia.rationalSurfaceDerivatives(b,d[0],d[1],1),m=l[0][0],o=l[1][0],p=l[0][1],n=Ca.normalized(Ca.cross(o,p)),q=Ca.dot(n,m),r=Ca.distSquared(g,m),r<e*e)break;var u=Ca.normalized(Ca.cross(h,n)),v=Ca.dot(u,g),w=Ja.threePlanes(h,k,n,q,u,v);if(null==w)throw new C("panic!");var x=Ca.sub(w,g),y=Ca.sub(w,m),z=Ca.cross(i,h),A=Ca.cross(j,h),B=Ca.cross(o,n),D=Ca.cross(p,n),E=Ca.dot(A,x)/Ca.dot(A,i),F=Ca.dot(z,x)/Ca.dot(z,j),G=Ca.dot(D,y)/Ca.dot(D,o),H=Ca.dot(B,y)/Ca.dot(B,p);c=Ca.add([E,F],c),d=Ca.add([G,H],d),t++}while(t<s);return new fa(c,d,g,r)},Ja.meshes=function(a,b,c,d){null==c&&(c=new qa(a)),null==d&&(d=new qa(b));var e=Ja.boundingBoxTrees(c,d,0),f=P.unique(e.map(function(c){return Ja.triangles(a,c.item0,b,c.item1)}).filter(function(a){return null!=a}).filter(function(a){return Ca.distSquared(a.min.point,a.max.point)>S.EPSILON}),function(a,b){var c=Ca.sub(a.min.uv0,b.min.uv0),d=Ca.dot(c,c),e=Ca.sub(a.max.uv0,b.max.uv0),f=Ca.dot(e,e),g=Ca.sub(a.min.uv0,b.max.uv0),h=Ca.dot(g,g),i=Ca.sub(a.max.uv0,b.min.uv0),j=Ca.dot(i,i);return d<S.EPSILON&&f<S.EPSILON||h<S.EPSILON&&j<S.EPSILON});return Ja.makeMeshIntersectionPolylines(f)},Ja.meshSlices=function(a,b,c,d){for(var e=new wa(a),f=e.boundingBox(),g=f.min[0],h=f.min[1],i=f.max[0],j=f.max[1],k=Ca.span(b,c,d),l=[],m=0;m<k.length;){var n=k[m];++m;var o=[[g,h,n],[i,h,n],[i,j,n],[g,j,n]],p=[[0,0],[1,0],[1,1],[0,1]],q=[[0,1,2],[0,2,3]],r=new Y(q,o,null,p);l.push(Ja.meshes(a,r,e))}return l},Ja.makeMeshIntersectionPolylines=function(a){if(0==a.length)return[];for(var b=0;b<a.length;){var c=a[b];++b,c.max.opp=c.min,c.min.opp=c.max}for(var d=Ja.kdTreeFromSegments(a),e=[],f=0;f<a.length;){var g=a[f];++f,e.push(g.min),e.push(g.max)}for(var h=0;h<e.length;){var i=e[h];if(++h,null==i.adj){var j=Ja.lookupAdjacentSegment(i,d,a.length);null!=j&&null==j.adj&&(i.adj=j,j.adj=i)}}var k=e.filter(function(a){return null==a.adj});0==k.length&&(k=e);for(var l=[],m=0,n=!1;0!=k.length;){var o=k.pop();if(!o.visited){for(var p=[],q=o;null!=q&&!q.visited&&(q.visited=!0,q.opp.visited=!0,p.push(q),m+=2,q=q.opp.adj,q!=o););p.length>0&&(p.push(p[p.length-1].opp),l.push(p))}if(0==k.length&&e.length>0&&(n||m<e.length)){n=!0;var r=e.pop();k.push(r)}}return l},Ja.kdTreeFromSegments=function(a){for(var b=[],c=0;c<a.length;){var d=a[c];++c,b.push(new ma(d.min.point,d.min)),b.push(new ma(d.max.point,d.max))}return new ka(b,Ca.distSquared)},Ja.lookupAdjacentSegment=function(a,b,c){var d=b.nearest(a.point,c,S.EPSILON).filter(function(b){return a!=b.item0.obj}).map(function(a){return a.item0.obj});return 1==d.length?d[0]:null},Ja.curveAndSurface=function(a,b,c,d,e){null==c&&(c=.001),d=null!=d?d:new pa(a),e=null!=e?e:new sa(b);var f=Ja.boundingBoxTrees(d,e,c);return P.unique(f.map(function(a){var b=a.item0,d=a.item1,e=P.first(b.knots),f=P.last(b.knots),g=(e+f)/2,h=P.first(d.knotsU),i=P.last(d.knotsU),j=P.first(d.knotsV),k=P.last(d.knotsV),l=[(h+i)/2,(j+k)/2];return Ja.curveAndSurfaceWithEstimate(b,d,[g].concat(l),c)}).filter(function(a){return Ca.distSquared(a.curvePoint,a.surfacePoint)<c*c}),function(a,b){return Math.abs(a.u-b.u)<.5*c})},Ja.curveAndSurfaceWithEstimate=function(a,b,c,d){null==d&&(d=.001);var e=function(c){var d=Ia.rationalCurvePoint(a,c[0]),e=Ia.rationalSurfacePoint(b,c[1],c[2]),f=Ca.sub(d,e);return Ca.dot(f,f)},f=function(c){var d=Ia.rationalCurveDerivatives(a,c[0],1),e=Ia.rationalSurfaceDerivatives(b,c[1],c[2],1),f=Ca.sub(e[0][0],d[0]),g=Ca.mul(-1,d[1]),h=e[1][0],i=e[0][1];return[2*Ca.dot(g,f),2*Ca.dot(h,f),2*Ca.dot(i,f)]},g=xa.uncmin(e,c,d*d,f),h=g.solution;return new ca(h[0],[h[1],h[2]],Ia.rationalCurvePoint(a,h[0]),Ia.rationalSurfacePoint(b,h[1],h[2]))},Ja.polylineAndMesh=function(a,b,c){for(var d=Ja.boundingBoxTrees(new ra(a),new qa(b),c),e=[],f=0;f<d.length;){var g=d[f];++f;var h=g.item0,i=g.item1,j=Ja.segmentWithTriangle(a.points[h],a.points[h+1],b.points,b.faces[i]);if(null!=j){var k=j.point,l=Ca.lerp(j.p,[a.params[h]],[a.params[h+1]])[0],m=va.triangleUVFromPoint(b,i,k);e.push(new ea(k,l,m,h,i))}}return e},Ja.boundingBoxTrees=function(a,b,c){null==c&&(c=1e-9);var d=[],e=[];d.push(a),e.push(b);for(var f=[];d.length>0;){var g=d.pop(),h=e.pop();if(!g.empty()&&!h.empty()&&g.boundingBox().intersects(h.boundingBox(),c)){var i=g.indivisible(c),j=h.indivisible(c);if(i&&j)f.push(new _(g.yield(),h.yield()));else if(!i||j)if(i||!j){var k=g.split(),l=h.split();d.push(k.item1),e.push(l.item1),d.push(k.item1),e.push(l.item0),d.push(k.item0),e.push(l.item1),d.push(k.item0),e.push(l.item0)}else{var m=g.split();d.push(m.item1),e.push(h),d.push(m.item0),e.push(h)}else{var n=h.split();d.push(g),e.push(n.item1),d.push(g),e.push(n.item0)}}}return f},Ja.curves=function(a,b,c){var d=Ja.boundingBoxTrees(new pa(a),new pa(b),0);return P.unique(d.map(function(d){return Ja.curvesWithEstimate(a,b,P.first(d.item0.knots),P.first(d.item1.knots),c)}).filter(function(a){return Ca.distSquared(a.point0,a.point1)<c}),function(a,b){return Math.abs(a.u0-b.u0)<5*c})},Ja.curvesWithEstimate=function(a,b,c,d,e){var f=function(c){var d=Ia.rationalCurvePoint(a,c[0]),e=Ia.rationalCurvePoint(b,c[1]),f=Ca.sub(d,e);return Ca.dot(f,f)},g=function(c){var d=Ia.rationalCurveDerivatives(a,c[0],1),e=Ia.rationalCurveDerivatives(b,c[1],1),f=Ca.sub(d[0],e[0]),g=d[1],h=Ca.mul(-1,e[1]);return[2*Ca.dot(g,f),2*Ca.dot(h,f)]},h=xa.uncmin(f,[c,d],e*e,g),i=h.solution[0],j=h.solution[1],k=Ia.rationalCurvePoint(a,i),l=Ia.rationalCurvePoint(b,j);return new ba(k,l,i,j)},Ja.triangles=function(a,b,c,d){var e=a.faces[b],f=c.faces[d],g=va.getTriangleNorm(a.points,e),h=va.getTriangleNorm(c.points,f),i=a.points[e[0]],j=c.points[f[0]],k=Ja.planes(i,g,j,h);if(null==k)return null;var l=Ja.clipRayInCoplanarTriangle(k,a,b);if(null==l)return null;var m=Ja.clipRayInCoplanarTriangle(k,c,d);if(null==m)return null;var n=Ja.mergeTriangleClipIntervals(l,m,a,b,c,d);return null==n?null:new aa(new da(n.min.uv0,n.min.uv1,n.min.point,b,d),new da(n.max.uv0,n.max.uv1,n.max.point,b,d))},Ja.clipRayInCoplanarTriangle=function(a,b,c){for(var d=b.faces[c],e=[b.points[d[0]],b.points[d[1]],b.points[d[2]]],f=[b.uvs[d[0]],b.uvs[d[1]],b.uvs[d[2]]],g=[Ca.sub(f[1],f[0]),Ca.sub(f[2],f[1]),Ca.sub(f[0],f[2])],h=[Ca.sub(e[1],e[0]),Ca.sub(e[2],e[1]),Ca.sub(e[0],e[2])],i=h.map(Ca.normalized),j=h.map(Ca.norm),k=null,l=null,m=0;m<3;){var n=m++,o=e[n],p=i[n],q=Ja.rays(o,p,a.origin,a.dir);if(null!=q){var r=q.u0,s=q.u1;r<-S.EPSILON||r>j[n]+S.EPSILON||((null==k||s<k.u)&&(k=new ha(s,Ca.onRay(a.origin,a.dir,s),Ca.onRay(f[n],g[n],r/j[n]))),(null==l||s>l.u)&&(l=new ha(s,Ca.onRay(a.origin,a.dir,s),Ca.onRay(f[n],g[n],r/j[n]))))}}return null==l||null==k?null:new aa(k,l)},Ja.mergeTriangleClipIntervals=function(a,b,c,d,e,f){if(b.min.u>a.max.u+S.EPSILON||a.min.u>b.max.u+S.EPSILON)return null;var g;g=a.min.u>b.min.u?new _(a.min,0):new _(b.min,1);var h;h=a.max.u<b.max.u?new _(a.max,0):new _(b.max,1);var i=new aa(new da(null,null,g.item0.point,d,f),new da(null,null,h.item0.point,d,f));return 0==g.item1?(i.min.uv0=g.item0.uv,i.min.uv1=va.triangleUVFromPoint(e,f,g.item0.point)):(i.min.uv0=va.triangleUVFromPoint(c,d,g.item0.point),i.min.uv1=g.item0.uv),0==h.item1?(i.max.uv0=h.item0.uv,i.max.uv1=va.triangleUVFromPoint(e,f,h.item0.point)):(i.max.uv0=va.triangleUVFromPoint(c,d,h.item0.point),i.max.uv1=h.item0.uv),i},Ja.planes=function(a,b,c,d){var e=Ca.cross(b,d);if(Ca.dot(e,e)<S.EPSILON)return null;var f=0,g=Math.abs(e[0]),h=Math.abs(e[1]),i=Math.abs(e[2]);h>g&&(f=1,g=h),i>g&&(f=2,g=i);var j,k,l,m;0==f?(j=b[1],k=b[2],l=d[1],m=d[2]):1==f?(j=b[0],k=b[2],l=d[0],m=d[2]):(j=b[0],k=b[1],l=d[0],m=d[1]);var n,o=-Ca.dot(a,b),p=-Ca.dot(c,d),q=j*m-k*l,r=(k*p-o*m)/q,s=(o*l-j*p)/q;return n=0==f?[0,r,s]:1==f?[r,0,s]:[r,s,0],new V(n,Ca.normalized(e))},Ja.threePlanes=function(a,b,c,d,e,f){var g=Ca.cross(c,e),h=Ca.dot(a,g);if(Math.abs(h)<S.EPSILON)return null;var i=Ca.sub(Ca.mul(f,c),Ca.mul(d,e)),j=Ca.add(Ca.mul(b,g),Ca.cross(a,i));return Ca.mul(1/h,j)},Ja.polylines=function(a,b,c){for(var d=Ja.boundingBoxTrees(new ra(a),new ra(b),c),e=[],f=0;f<d.length;){var g=d[f];++f;var h=g.item0,i=g.item1,j=Ja.segments(a.points[h],a.points[h+1],b.points[i],b.points[i+1],c);null!=j&&(j.u0=Ca.lerp(j.u0,[a.params[h]],[a.params[h+1]])[0],j.u1=Ca.lerp(j.u1,[b.params[i]],[b.params[i+1]])[0],e.push(j))}return e},Ja.segments=function(a,b,c,d,e){var f=Ca.sub(b,a),g=Math.sqrt(Ca.dot(f,f)),h=Ca.mul(1/g,f),i=Ca.sub(d,c),j=Math.sqrt(Ca.dot(i,i)),k=Ca.mul(1/j,i),l=Ja.rays(a,h,c,k);if(null!=l){var m=Math.min(Math.max(0,l.u0/g),1),n=Math.min(Math.max(0,l.u1/j),1),o=Ca.onRay(a,f,m),p=Ca.onRay(c,i,n),q=Ca.distSquared(o,p);if(q<e*e)return new ba(o,p,m,n)}return null},Ja.rays=function(a,b,c,d){var e=Ca.dot(b,d),f=Ca.dot(b,c),g=Ca.dot(b,a),h=Ca.dot(d,c),i=Ca.dot(d,a),j=Ca.dot(b,b),k=Ca.dot(d,d),l=j*k-e*e;if(Math.abs(l)<S.EPSILON)return null;var m=e*(f-g)-j*(h-i),n=m/l,o=(f-g+n*e)/j,p=Ca.onRay(a,b,o),q=Ca.onRay(c,d,n);return new ba(p,q,o,n)},Ja.segmentWithTriangle=function(a,b,c,d){var e=c[d[0]],f=c[d[1]],g=c[d[2]],h=Ca.sub(f,e),i=Ca.sub(g,e),j=Ca.cross(h,i),k=Ca.sub(b,a),l=Ca.sub(a,e),m=-Ca.dot(j,l),n=Ca.dot(j,k);if(Math.abs(n)<S.EPSILON)return null;var o=m/n;if(o<0||o>1)return null;var p=Ca.add(a,Ca.mul(o,k)),q=Ca.dot(h,i),r=Ca.dot(h,h),s=Ca.dot(i,i),t=Ca.sub(p,e),u=Ca.dot(t,h),v=Ca.dot(t,i),w=q*q-r*s;if(Math.abs(w)<S.EPSILON)return null;var x=(q*v-s*u)/w,y=(q*u-r*v)/w;return x>1+S.EPSILON||y>1+S.EPSILON||y<-S.EPSILON||x<-S.EPSILON||x+y>1+S.EPSILON?null:new ga(p,x,y,o)},Ja.segmentAndPlane=function(a,b,c,d){var e=Ca.dot(d,Ca.sub(b,a));if(Math.abs(e)<S.EPSILON)return null;var f=Ca.dot(d,Ca.sub(c,a)),g=f/e;return g>1+S.EPSILON||g<-S.EPSILON?null:{p:g}};var Ka=b.eval.Make=function(){};g["verb.eval.Make"]=Ka,Ka.__name__=["verb","eval","Make"],Ka.rationalTranslationalSurface=function(a,b){for(var c=Ia.rationalCurvePoint(b,P.first(b.knots)),d=P.first(b.knots),e=P.last(b.knots),f=2*b.controlPoints.length,g=(e-d)/(f-1),h=[],i=0;i<f;){var j=i++,k=Ca.sub(Ia.rationalCurvePoint(b,d+j*g),c),l=La.rationalCurveTransform(a,[[1,0,0,k[0]],[0,1,0,k[1]],[0,0,1,k[2]],[0,0,0,1]]);h.push(l)}return Ka.loftedSurface(h)},Ka.surfaceBoundaryCurves=function(a){var b=Ka.surfaceIsocurve(a,P.first(a.knotsU),!1),c=Ka.surfaceIsocurve(a,P.last(a.knotsU),!1),d=Ka.surfaceIsocurve(a,P.first(a.knotsV),!0),e=Ka.surfaceIsocurve(a,P.last(a.knotsV),!0);return[b,c,d,e]},Ka.surfaceIsocurve=function(a,b,c){null==c&&(c=!1);var d;d=c?a.knotsV:a.knotsU;var e;e=c?a.degreeV:a.degreeU;for(var f=Da.knotMultiplicities(d),g=-1,h=0,i=f.length;h<i;){var j=h++;if(Math.abs(b-f[j].knot)<S.EPSILON){g=j;break}}var k=e+1;g>=0&&(k-=f[g].mult);var l;l=k>0?La.surfaceKnotRefine(a,Ca.rep(k,b),c):a;var m=Ia.knotSpan(e,b,d);return Math.abs(b-P.first(d))<S.EPSILON?m=0:Math.abs(b-P.last(d))<S.EPSILON&&(m=(c?l.controlPoints[0].length:l.controlPoints.length)-1),c?new W(l.degreeU,l.knotsU,function(a){for(var b,c=[],d=0,e=l.controlPoints;d<e.length;){var f=e[d];++d,c.push(f[m])}return b=c}(this)):new W(l.degreeV,l.knotsV,l.controlPoints[m])},Ka.loftedSurface=function(a,b){a=La.unifyCurveKnotVectors(a);var c=a[0].degree;null==b&&(b=3),b>a.length-1&&(b=a.length-1);for(var d=a[0].knots,e=[],f=[],g=0,h=a[0].controlPoints.length;g<h;){var i=[g++],j=a.map(function(a){return function(b){return b.controlPoints[a[0]]}}(i)),k=Ka.rationalInterpCurve(j,b,!0);f.push(k.controlPoints),e=k.knots}return new X(c,b,d,e,f)},Ka.clonedCurve=function(a){return new W(a.degree,a.knots.slice(),a.controlPoints.map(function(a){return a.slice()}))},Ka.rationalBezierCurve=function(a,b){for(var c=a.length-1,d=[],e=0,f=c+1;e<f;){e++;d.push(0)}for(var g=0,h=c+1;g<h;){g++;d.push(1)}return null==b&&(b=Ca.rep(a.length,1)),new W(c,d,Ia.homogenize1d(a,b))},Ka.fourPointSurface=function(a,b,c,d,e){null==e&&(e=3);for(var f=e,g=[],h=0,i=e+1;h<i;){for(var j=h++,k=[],l=0,m=e+1;l<m;){var n=l++,o=1-j/f,p=Ca.lerp(o,a,b),q=Ca.lerp(o,d,c),r=Ca.lerp(1-n/f,p,q);r.push(1),k.push(r)}g.push(k)}var s=Ca.rep(e+1,0),t=Ca.rep(e+1,1);return new X(e,e,s.concat(t),s.concat(t),g)},Ka.ellipseArc=function(a,b,c,d,e){var f=Ca.norm(b),g=Ca.norm(c);b=Ca.normalized(b),c=Ca.normalized(c),e<d&&(e=2*Math.PI+d);var h=e-d,i=0;i=h<=Math.PI/2?1:h<=Math.PI?2:h<=3*Math.PI/2?3:4;var j=h/i,k=Math.cos(j/2),l=Ca.add(a,Ca.add(Ca.mul(f*Math.cos(d),b),Ca.mul(g*Math.sin(d),c))),m=Ca.sub(Ca.mul(Math.cos(d),c),Ca.mul(Math.sin(d),b)),n=[],o=Ca.zeros1d(2*i+3),p=0,q=d,r=Ca.zeros1d(2*i);n[0]=l,r[0]=1;for(var s=1,t=i+1;s<t;){var u=s++;q+=j;var v=Ca.add(a,Ca.add(Ca.mul(f*Math.cos(q),b),Ca.mul(g*Math.sin(q),c)));r[p+2]=1,n[p+2]=v;var w=Ca.sub(Ca.mul(Math.cos(q),c),Ca.mul(Math.sin(q),b)),x=Ja.rays(l,Ca.mul(1/Ca.norm(m),m),v,Ca.mul(1/Ca.norm(w),w)),y=Ca.add(l,Ca.mul(x.u0,m));r[p+1]=k,n[p+1]=y,p+=2,u<i&&(l=v,m=w)}for(var z=2*i+1,A=0;A<3;){var B=A++;o[B]=0,o[B+z]=1}switch(i){case 2:o[3]=o[4]=.5;break;case 3:o[3]=o[4]=.3333333333333333,o[5]=o[6]=.6666666666666666;break;case 4:o[3]=o[4]=.25,o[5]=o[6]=.5,o[7]=o[8]=.75}return new W(2,o,Ia.homogenize1d(n,r))},Ka.arc=function(a,b,c,d,e,f){return Ka.ellipseArc(a,Ca.mul(d,Ca.normalized(b)),Ca.mul(d,Ca.normalized(c)),e,f)},Ka.polyline=function(a){for(var b=[0,0],c=0,d=0,e=a.length-1;d<e;){var f=d++;c+=Ca.dist(a[f],a[f+1]),b.push(c)}b.push(c),b=Ca.mul(1/c,b);for(var g,h=[],i=0,j=a.length;i<j;){i++;h.push(1)}return g=h,new W(1,b,Ia.homogenize1d(a.slice(0),g))},Ka.extrudedSurface=function(a,b,c){for(var d=[[],[],[]],e=[[],[],[]],f=Ia.dehomogenize1d(c.controlPoints),g=Ia.weight1d(c.controlPoints),h=Ca.mul(b,a),i=Ca.mul(.5*b,a),j=0,k=f.length;j<k;){var l=j++;d[2][l]=f[l],d[1][l]=Ca.add(i,f[l]),d[0][l]=Ca.add(h,f[l]),e[0][l]=g[l],e[1][l]=g[l],e[2][l]=g[l]}return new X(2,c.degree,[0,0,0,1,1,1],c.knots,Ia.homogenize2d(d,e))},Ka.cylindricalSurface=function(a,b,c,d,e){var f=Ca.cross(a,b),g=(2*Math.PI,Ka.arc(c,b,f,e,0,2*Math.PI));return Ka.extrudedSurface(a,d,g)},Ka.revolvedSurface=function(a,b,c,d){var e,f,g=Ia.dehomogenize1d(a.controlPoints),h=Ia.weight1d(a.controlPoints);d<=Math.PI/2?(e=1,f=Ca.zeros1d(6+2*(e-1))):d<=Math.PI?(e=2,f=Ca.zeros1d(6+2*(e-1)),f[3]=f[4]=.5):d<=3*Math.PI/2?(e=3,f=Ca.zeros1d(6+2*(e-1)),f[3]=f[4]=.3333333333333333,f[5]=f[6]=.6666666666666666):(e=4,f=Ca.zeros1d(6+2*(e-1)),f[3]=f[4]=.25,f[5]=f[6]=.5,f[7]=f[8]=.75);for(var i=d/e,j=3+2*(e-1),k=0;k<3;){var l=k++;f[l]=0,f[j+l]=1}for(var m=Math.cos(i/2),n=0,o=Ca.zeros1d(e+1),p=Ca.zeros1d(e+1),q=Ca.zeros3d(2*e+1,g.length,3),r=Ca.zeros2d(2*e+1,g.length),s=1,t=e+1;s<t;){var u=s++;n+=i,p[u]=Math.cos(n),o[u]=Math.sin(n)}for(var v=0,w=g.length;v<w;){var x=v++,y=Ba.rayClosestPoint(g[x],b,c),z=Ca.sub(g[x],y),A=Ca.norm(z),B=Ca.cross(c,z);A>S.EPSILON&&(z=Ca.mul(1/A,z),B=Ca.mul(1/A,B)),q[0][x]=g[x];var C=g[x];r[0][x]=h[x];for(var D=B,E=0,F=1,G=e+1;F<G;){var H,I=F++;H=0==A?y:Ca.add(y,Ca.add(Ca.mul(A*p[I],z),Ca.mul(A*o[I],B))),q[E+2][x]=H,r[E+2][x]=h[x];var J=Ca.sub(Ca.mul(p[I],B),Ca.mul(o[I],z));if(0==A)q[E+1][x]=y;else{var K=Ja.rays(C,Ca.mul(1/Ca.norm(D),D),H,Ca.mul(1/Ca.norm(J),J)),L=Ca.add(C,Ca.mul(K.u0,D));q[E+1][x]=L}r[E+1][x]=m*h[x],E+=2,I<e&&(C=H,D=J)}}return new X(2,a.degree,f,a.knots,Ia.homogenize2d(q,r))},Ka.sphericalSurface=function(a,b,c,d){var e=Ka.arc(a,Ca.mul(-1,b),c,d,0,Math.PI);return Ka.revolvedSurface(e,a,b,2*Math.PI)},Ka.conicalSurface=function(a,b,c,d,e){var f=2*Math.PI,g=1,h=[Ca.add(c,Ca.mul(d,a)),Ca.add(c,Ca.mul(e,b))],i=[0,0,1,1],j=[1,1],k=new W(g,i,Ia.homogenize1d(h,j));return Ka.revolvedSurface(k,c,a,f)},Ka.rationalInterpCurve=function(a,b,c,d,e){if(null==c&&(c=!1),null==b&&(b=3),a.length<b+1)throw new C("You need to supply at least degree + 1 points! You only supplied "+a.length+" points.");for(var f=[0],g=1,h=a.length;g<h;){var i=g++,j=Ca.norm(Ca.sub(a[i],a[i-1])),k=f[f.length-1];f.push(k+j)}for(var l=f[f.length-1],m=0,n=f.length;m<n;){var o=m++;f[o]=f[o]/l}var p,q=Ca.rep(b+1,0),r=null!=d&&null!=e;p=r?0:1;var s;s=r?f.length-b+1:f.length-b;for(var t=p;t<s;){for(var u=t++,v=0,w=0;w<b;){var x=w++;v+=f[u+x]}q.push(1/b*v)}var y,z=q.concat(Ca.rep(b+1,1)),A=[];y=r?a.length+1:a.length-1;var B;B=r?1:0;var D;D=r?a.length-(b-1):a.length-(b+1);for(var E=0;E<f.length;){var F=f[E];++E;var G=Ia.knotSpanGivenN(y,b,F,z),H=Ia.basisFunctionsGivenKnotSpanIndex(G,F,b,z),I=G-b,J=Ca.zeros1d(I),K=Ca.zeros1d(D-I);A.push(J.concat(H).concat(K))}if(r){var L=A[0].length-2,M=[-1,1].concat(Ca.zeros1d(L)),N=Ca.zeros1d(L).concat([-1,1]);P.spliceAndInsert(A,1,0,M),P.spliceAndInsert(A,A.length-1,0,N)}for(var O=a[0].length,Q=[],R=(1-z[z.length-b-2])/b,S=z[b+1]/b,T=0;T<O;){var U,V=[T++];if(r){U=[a[0][V[0]]],U.push(S*d[V[0]]);for(var X=1,Y=a.length-1;X<Y;){var Z=X++;U.push(a[Z][V[0]])}U.push(R*e[V[0]]),U.push(P.last(a)[V[0]])}else U=a.map(function(a){return function(b){return b[a[0]]}}(V));var $=ta.solve(A,U);Q.push($)}var _=ta.transpose(Q);if(!c){var aa=Ca.rep(_.length,1);_=Ia.homogenize1d(_,aa)}return new W(b,z,_)};var La=b.eval.Modify=function(){};g["verb.eval.Modify"]=La,La.__name__=["verb","eval","Modify"],La.curveReverse=function(a){return new W(a.degree,La.knotsReverse(a.knots),P.reversed(a.controlPoints))},La.surfaceReverse=function(a,b){return null==b&&(b=!1),b?new X(a.degreeU,a.degreeV,a.knotsU,La.knotsReverse(a.knotsV),function(b){for(var c,d=[],e=0,f=a.controlPoints;e<f.length;){var g=f[e];++e,d.push(P.reversed(g))}return c=d}(this)):new X(a.degreeU,a.degreeV,La.knotsReverse(a.knotsU),a.knotsV,P.reversed(a.controlPoints))},La.knotsReverse=function(a){for(var b=P.first(a),c=(P.last(a),[b]),d=a.length,e=1;e<d;){var f=e++;c.push(c[f-1]+(a[d-f]-a[d-f-1]))}return c},La.unifyCurveKnotVectors=function(a){a=a.map(Ka.clonedCurve);for(var b=j.fold(a,function(a,b){return La.imax(a.degree,b)},0),c=0,d=a.length;c<d;){var e=c++;a[e].degree<b&&(a[e]=La.curveElevateDegree(a[e],b))}for(var f,g=[],h=0;h<a.length;){var i=a[h];++h,g.push(new aa(P.first(i.knots),P.last(i.knots)))}f=g;for(var k=0,l=a.length;k<l;){var m=k++,n=[f[m].min];a[m].knots=a[m].knots.map(function(a){return function(b){return b-a[0]}}(n))}for(var o=f.map(function(a){return a.max-a.min}),p=j.fold(o,function(a,b){return Math.max(a,b)},0),q=0,r=a.length;q<r;){var s=q++,t=[p/o[s]];a[s].knots=a[s].knots.map(function(a){return function(b){return b*a[0]}}(t))}for(var u=j.fold(a,function(a,b){return Ca.sortedSetUnion(a.knots,b)},[]),v=0,w=a.length;v<w;){var x=v++,y=Ca.sortedSetSub(u,a[x].knots);0==y.length&&(a[x]=a[x]),a[x]=La.curveKnotRefine(a[x],y)}return a},La.imin=function(a,b){return a<b?a:b},La.imax=function(a,b){return a>b?a:b},La.curveElevateDegree=function(a,b){if(b<=a.degree)return a;var c,d=a.knots.length-a.degree-2,e=a.degree,f=a.knots,g=a.controlPoints,h=b-a.degree,i=a.controlPoints[0].length,j=Ca.zeros2d(e+h+1,e+1),k=[],l=[],m=[],n=d+e+1,o=b,p=Math.floor(o/2),q=[],r=[];j[0][0]=1,j[o][e]=1;for(var s=1,t=p+1;s<t;)for(var u=s++,v=1/Q.get(o,u),w=La.imin(e,u),x=La.imax(0,u-h),y=w+1;x<y;){var z=x++;j[u][z]=v*Q.get(e,z)*Q.get(h,u-z)}for(var A=p+1;A<o;)for(var B=A++,C=La.imin(e,B),D=La.imax(0,B-h),E=C+1;D<E;){var F=D++;j[B][F]=j[o-B][e-F]}var G=o,H=o+1,I=-1,J=e,K=e+1,L=1,M=f[0];q[0]=g[0];for(var N=0,O=o+1;N<O;){var P=N++;r[P]=M}for(var R=0,S=e+1;R<S;){var T=R++;k[T]=g[T]}for(;K<n;){for(var U=K;K<n&&f[K]==f[K+1];)K+=1;var V=K-U+1,X=f[K],Y=I;I=e-V;var Z;Z=Y>0?Math.floor((Y+2)/2):1;var $;if($=I>0?Math.floor(o-(I+1)/2):o,I>0){for(var _=X-M,aa=[],ba=e;ba>V;)aa[ba-V-1]=_/(f[J+ba]-M),ba--;for(var ca=1,da=I+1;ca<da;){for(var ea=ca++,fa=I-ea,ga=V+ea,ha=e;ha>=ga;)k[ha]=Ca.add(Ca.mul(aa[ha-ga],k[ha]),Ca.mul(1-aa[ha-ga],k[ha-1])),ha--;m[fa]=k[e]}}for(var ia=Z,ja=o+1;ia<ja;){var ka=ia++;l[ka]=Ca.zeros1d(i);for(var la=La.imin(e,ka),ma=La.imax(0,ka-h),na=la+1;ma<na;){var oa=ma++;l[ka]=Ca.add(l[ka],Ca.mul(j[ka][oa],k[oa]))}}if(Y>1)for(var pa=H-2,qa=H,ra=X-M,sa=(X-r[H-1])/ra,ta=1;ta<Y;){for(var ua=ta++,va=pa,wa=qa,xa=wa-H+1;wa-va>ua;){if(va<L){var ya=(X-r[va])/(M-r[va]);q[va]=Ca.lerp(ya,q[va],q[va-1])}if(wa>=Z){if(wa-ua<=H-o+Y){var za=(X-r[wa-ua])/ra;l[xa]=Ca.lerp(za,l[xa],l[xa+1])}}else l[xa]=Ca.lerp(sa,l[xa],l[xa+1]);va+=1,wa-=1,xa-=1}pa-=1,qa+=1}if(J!=e)for(var Aa=0,Ba=o-Y;Aa<Ba;){Aa++;r[H]=M,H+=1}for(var Da=Z,Ea=$+1;Da<Ea;){var Fa=Da++;q[L]=l[Fa],L+=1}if(K<n){for(var Ga=0;Ga<I;){var Ha=Ga++;k[Ha]=m[Ha]}for(var Ia=I,Ja=e+1;Ia<Ja;){
var Ka=Ia++;k[Ka]=g[K-e+Ka]}J=K,K+=1,M=X}else for(var Ma=0,Na=o+1;Ma<Na;){var Oa=Ma++;r[H+Oa]=X}}return c=G-o-1,new W(b,r,q)},La.rationalSurfaceTransform=function(a,b){for(var c=Ia.dehomogenize2d(a.controlPoints),d=0,e=c.length;d<e;)for(var f=d++,g=0,h=c[f].length;g<h;){var i=g++,j=c[f][i];j.push(1),c[f][i]=ta.dot(b,j).slice(0,j.length-1)}return new X(a.degreeU,a.degreeV,a.knotsU.slice(),a.knotsV.slice(),Ia.homogenize2d(c,Ia.weight2d(a.controlPoints)))},La.rationalCurveTransform=function(a,b){for(var c=Ia.dehomogenize1d(a.controlPoints),d=0,e=c.length;d<e;){var f=d++,g=c[f];g.push(1),c[f]=ta.dot(b,g).slice(0,g.length-1)}return new W(a.degree,a.knots.slice(),Ia.homogenize1d(c,Ia.weight1d(a.controlPoints)))},La.surfaceKnotRefine=function(a,b,c){var d,e,f,g=[];c?(f=a.controlPoints,d=a.knotsV,e=a.degreeV):(f=ta.transpose(a.controlPoints),d=a.knotsU,e=a.degreeU);for(var h=null,i=0;i<f.length;){var j=f[i];++i,h=La.curveKnotRefine(new W(e,d,j),b),g.push(h.controlPoints)}var k=h.knots;return c?new X(a.degreeU,a.degreeV,a.knotsU.slice(),k,g):(g=ta.transpose(g),new X(a.degreeU,a.degreeV,k,a.knotsV.slice(),g))},La.decomposeCurveIntoBeziers=function(a){for(var b=a.degree,c=a.controlPoints,d=a.knots,e=Da.knotMultiplicities(d),f=b+1,g=0;g<e.length;){var h=e[g];if(++g,h.mult<f){var i=Ca.rep(f-h.mult,h.knot),j=La.curveKnotRefine(new W(b,d,c),i);d=j.knots,c=j.controlPoints}}for(var k=(d.length/f-1,2*f),l=[],m=0;m<c.length;){var n=d.slice(m,m+k),o=c.slice(m,m+f);l.push(new W(b,n,o)),m+=f}return l},La.curveKnotRefine=function(a,b){if(0==b.length)return Ka.clonedCurve(a);for(var c=a.degree,d=a.controlPoints,e=a.knots,f=d.length-1,g=f+c+1,h=b.length-1,i=Ia.knotSpan(c,b[0],e),j=Ia.knotSpan(c,b[h],e),k=[],l=[],m=0,n=i-c+1;m<n;){var o=m++;k[o]=d[o]}for(var p=j-1,q=f+1;p<q;){var r=p++;k[r+h+1]=d[r]}for(var s=0,t=i+1;s<t;){var u=s++;l[u]=e[u]}for(var v=j+c,w=g+1;v<w;){var x=v++;l[x+h+1]=e[x]}for(var y=j+c-1,z=j+c+h,A=h;A>=0;){for(;b[A]<=e[y]&&y>i;)k[z-c-1]=d[y-c-1],l[z]=e[y],z-=1,y-=1;k[z-c-1]=k[z-c];for(var B=1,C=c+1;B<C;){var D=B++,E=z-c+D,F=l[z+D]-b[A];Math.abs(F)<S.EPSILON?k[E-1]=k[E]:(F/=l[z+D]-e[y-c+D],k[E-1]=Ca.add(Ca.mul(F,k[E-1]),Ca.mul(1-F,k[E])))}l[z]=b[A],z-=1,A--}return new W(c,l,k)},La.curveKnotInsert=function(a,b,c){for(var d=a.degree,e=a.controlPoints,f=a.knots,g=0,h=e.length,i=Ia.knotSpan(d,b,f),j=[],k=[],l=[],m=1,n=i+1;m<n;){var o=m++;k[o]=f[o]}for(var p=1,q=c+1;p<q;){var r=p++;k[i+r]=b}for(var s=i+1,t=f.length;s<t;){var u=s++;k[u+c]=f[u]}for(var v=0,w=i-d+1;v<w;){var x=v++;l[x]=e[x]}for(var y=i-g;y<h;){var z=y++;l[z+c]=e[z]}for(var A=0,B=d-g+1;A<B;){var C=A++;j[C]=e[i-d+C]}for(var D=0,E=0,F=1,G=c+1;F<G;){var H=F++;D=i-d+H;for(var I=0,J=d-H-g+1;I<J;){var K=I++;E=(b-f[D+K])/(f[K+i+1]-f[D+K]),j[K]=Ca.add(Ca.mul(E,j[K+1]),Ca.mul(1-E,j[K]))}l[D]=j[0],l[i+c-H-g]=j[d-H-g]}for(var L=D+1,M=i-g;L<M;){var N=L++;l[N]=j[N-D]}return new W(d,k,l)};var Ma=b.eval.Tess=function(){};g["verb.eval.Tess"]=Ma,Ma.__name__=["verb","eval","Tess"],Ma.rationalCurveRegularSample=function(a,b,c){return Ma.rationalCurveRegularSampleRange(a,a.knots[0],P.last(a.knots),b,c)},Ma.rationalCurveRegularSampleRange=function(a,b,c,d,e){d<1&&(d=2);for(var f=[],g=(c-b)/(d-1),h=0,i=0;i<d;){var j=i++;h=b+g*j,e?f.push([h].concat(Ia.rationalCurvePoint(a,h))):f.push(Ia.rationalCurvePoint(a,h))}return f},Ma.rationalCurveAdaptiveSample=function(a,b,c){if(null==c&&(c=!1),null==b&&(b=1e-6),1==a.degree){if(c){for(var d=[],e=0,f=a.controlPoints.length;e<f;){var g=e++;d.push([a.knots[g+1]].concat(Ia.dehomogenize(a.controlPoints[g])))}return d}return a.controlPoints.map(Ia.dehomogenize)}return Ma.rationalCurveAdaptiveSampleRange(a,a.knots[0],P.last(a.knots),b,c)},Ma.rationalCurveAdaptiveSampleRange=function(a,b,c,d,e){var f=Ia.rationalCurvePoint(a,b),g=Ia.rationalCurvePoint(a,c),h=.5+.2*Math.random(),i=b+(c-b)*h,j=Ia.rationalCurvePoint(a,i),k=Ca.sub(f,g),l=Ca.sub(f,j);if(Ca.dot(k,k)<d&&Ca.dot(l,l)>d||!Ba.threePointsAreFlat(f,j,g,d)){var m=b+.5*(c-b),n=Ma.rationalCurveAdaptiveSampleRange(a,b,m,d,e),o=Ma.rationalCurveAdaptiveSampleRange(a,m,c,d,e);return n.slice(0,-1).concat(o)}return e?[[b].concat(f),[c].concat(g)]:[f,g]},Ma.rationalSurfaceNaive=function(a,b,c){b<1&&(b=1),c<1&&(c=1);for(var d=(a.degreeU,a.degreeV,a.controlPoints,a.knotsU),e=a.knotsV,f=P.last(d)-d[0],g=P.last(e)-e[0],h=f/b,i=g/c,j=[],k=[],l=[],m=0,n=b+1;m<n;)for(var o=m++,p=0,q=c+1;p<q;){var r=p++,s=o*h,t=r*i;k.push([s,t]);var u=Ia.rationalSurfaceDerivatives(a,s,t,1),v=u[0][0];j.push(v);var w=Ca.normalized(Ca.cross(u[1][0],u[0][1]));l.push(w)}for(var x=[],y=0;y<b;)for(var z=y++,A=0;A<c;){var B=A++,C=z*(c+1)+B,D=(z+1)*(c+1)+B,E=D+1,F=C+1,G=[C,D,E],H=[C,E,F];x.push(G),x.push(H)}return new Y(x,j,l,k)},Ma.divideRationalSurfaceAdaptive=function(a,b){null==b&&(b=new Na),null!=b.minDivsU?b.minDivsU=b.minDivsU:b.minDivsU=1,null!=b.minDivsV?b.minDivsU=b.minDivsV:b.minDivsU=1,null!=b.refine?b.refine=b.refine:b.refine=!0;var c,d=2*(a.controlPoints.length-1),e=2*(a.controlPoints[0].length-1);c=b.minDivsU>d?b.minDivsU=b.minDivsU:b.minDivsU=d;var f;f=b.minDivsV>e?b.minDivsV=b.minDivsV:b.minDivsV=e;for(var g=P.last(a.knotsU),h=a.knotsU[0],i=P.last(a.knotsV),j=a.knotsV[0],k=(g-h)/c,l=(i-j)/f,m=[],n=[],o=0,p=f+1;o<p;){for(var q=o++,r=[],s=0,t=c+1;s<t;){var u=s++,v=h+k*u,w=j+l*q,x=Ia.rationalSurfaceDerivatives(a,v,w,1),y=Ca.normalized(Ca.cross(x[0][1],x[1][0]));r.push(new ia(x[0][0],y,[v,w],-1,Ca.isZero(y)))}n.push(r)}for(var z=0;z<f;)for(var A=z++,B=0;B<c;){var C=B++,D=[n[f-A-1][C],n[f-A-1][C+1],n[f-A][C+1],n[f-A][C]];m.push(new Oa(a,D))}if(!b.refine)return m;for(var E=0;E<f;)for(var F=E++,G=0;G<c;){var H=G++,I=F*c+H,J=Ma.north(I,F,H,c,f,m),K=Ma.east(I,F,H,c,f,m),L=Ma.south(I,F,H,c,f,m),M=Ma.west(I,F,H,c,f,m);m[I].neighbors=[L,K,J,M],m[I].divide(b)}return m},Ma.north=function(a,b,c,d,e,f){return 0==b?null:f[a-d]},Ma.south=function(a,b,c,d,e,f){return b==e-1?null:f[a+d]},Ma.east=function(a,b,c,d,e,f){return c==d-1?null:f[a+1]},Ma.west=function(a,b,c,d,e,f){return 0==c?null:f[a-1]},Ma.triangulateAdaptiveRefinementNodeTree=function(a){for(var b=Y.empty(),c=0;c<a.length;){var d=a[c];++c,d.triangulate(b)}return b},Ma.rationalSurfaceAdaptive=function(a,b){b=null!=b?b:new Na;var c=Ma.divideRationalSurfaceAdaptive(a,b);return Ma.triangulateAdaptiveRefinementNodeTree(c)};var Na=b.core.AdaptiveRefinementOptions=function(){this.minDivsV=1,this.minDivsU=1,this.refine=!0,this.maxDepth=10,this.minDepth=0,this.normTol=.025};g["verb.eval.AdaptiveRefinementOptions"]=Na,Na.__name__=["verb","eval","AdaptiveRefinementOptions"],Na.prototype={__class__:Na};var Oa=b.core.AdaptiveRefinementNode=function(a,b,c){if(this.srf=a,null==c?this.neighbors=[null,null,null,null]:this.neighbors=c,this.corners=b,null==this.corners){var d=a.knotsU[0],e=P.last(a.knotsU),f=a.knotsV[0],g=P.last(a.knotsV);this.corners=[ia.fromUv(d,f),ia.fromUv(e,f),ia.fromUv(e,g),ia.fromUv(d,g)]}};g["verb.eval.AdaptiveRefinementNode"]=Oa,Oa.__name__=["verb","eval","AdaptiveRefinementNode"],Oa.prototype={isLeaf:function(){return null==this.children},center:function(){return null!=this.centerPoint?this.centerPoint:this.evalSrf(this.u05,this.v05)},evalCorners:function(){this.u05=(this.corners[0].uv[0]+this.corners[2].uv[0])/2,this.v05=(this.corners[0].uv[1]+this.corners[2].uv[1])/2;for(var a=0;a<4;){var b=a++;if(null==this.corners[b].point){var c=this.corners[b];this.evalSrf(c.uv[0],c.uv[1],c)}}},evalSrf:function(a,b,c){var d=Ia.rationalSurfaceDerivatives(this.srf,a,b,1),e=d[0][0],f=Ca.cross(d[0][1],d[1][0]),g=Ca.isZero(f);return g||(f=Ca.normalized(f)),null!=c?(c.degen=g,c.point=e,c.normal=f,c):new ia(e,f,[a,b],-1,g)},getEdgeCorners:function(a){if(this.isLeaf())return[this.corners[a]];if(this.horizontal)switch(a){case 0:return this.children[0].getEdgeCorners(0);case 1:return this.children[0].getEdgeCorners(1).concat(this.children[1].getEdgeCorners(1));case 2:return this.children[1].getEdgeCorners(2);case 3:return this.children[1].getEdgeCorners(3).concat(this.children[0].getEdgeCorners(3))}switch(a){case 0:return this.children[0].getEdgeCorners(0).concat(this.children[1].getEdgeCorners(0));case 1:return this.children[1].getEdgeCorners(1);case 2:return this.children[1].getEdgeCorners(2).concat(this.children[0].getEdgeCorners(2));case 3:return this.children[0].getEdgeCorners(3)}return null},getAllCorners:function(a){var b=[this.corners[a]];if(null==this.neighbors[a])return b;var c=this.neighbors[a].getEdgeCorners((a+2)%4),d=a%2,e=S.EPSILON,f=this,g=[function(a){return a.uv[0]>f.corners[0].uv[0]+e&&a.uv[0]<f.corners[2].uv[0]-e},function(a){return a.uv[1]>f.corners[0].uv[1]+e&&a.uv[1]<f.corners[2].uv[1]-e}],h=c.filter(g[d]);return h.reverse(),b.concat(h)},midpoint:function(a){if(null==this.midPoints&&(this.midPoints=[null,null,null,null]),null!=this.midPoints[a])return this.midPoints[a];switch(a){case 0:this.midPoints[0]=this.evalSrf(this.u05,this.corners[0].uv[1]);break;case 1:this.midPoints[1]=this.evalSrf(this.corners[1].uv[0],this.v05);break;case 2:this.midPoints[2]=this.evalSrf(this.u05,this.corners[2].uv[1]);break;case 3:this.midPoints[3]=this.evalSrf(this.corners[0].uv[0],this.v05)}return this.midPoints[a]},hasBadNormals:function(){return this.corners[0].degen||this.corners[1].degen||this.corners[2].degen||this.corners[3].degen},fixNormals:function(){for(var a=this.corners.length,b=0;b<a;){var c=b++;this.corners[c];if(this.corners[c].degen){var d=this.corners[(c+1)%a],e=this.corners[(c+3)%a];d.degen?this.corners[c].normal=e.normal:this.corners[c].normal=d.normal}}},shouldDivide:function(a,b){if(b<a.minDepth)return!0;if(b>=a.maxDepth)return!1;if(this.hasBadNormals())return this.fixNormals(),!1;if(this.splitVert=Ca.normSquared(Ca.sub(this.corners[0].normal,this.corners[1].normal))>a.normTol||Ca.normSquared(Ca.sub(this.corners[2].normal,this.corners[3].normal))>a.normTol,this.splitHoriz=Ca.normSquared(Ca.sub(this.corners[1].normal,this.corners[2].normal))>a.normTol||Ca.normSquared(Ca.sub(this.corners[3].normal,this.corners[0].normal))>a.normTol,this.splitVert||this.splitHoriz)return!0;var c=this.center();return Ca.normSquared(Ca.sub(c.normal,this.corners[0].normal))>a.normTol||Ca.normSquared(Ca.sub(c.normal,this.corners[1].normal))>a.normTol||Ca.normSquared(Ca.sub(c.normal,this.corners[2].normal))>a.normTol||Ca.normSquared(Ca.sub(c.normal,this.corners[3].normal))>a.normTol},divide:function(a){null==a&&(a=new Na),null==a.normTol&&(a.normTol=.085),null==a.minDepth&&(a.minDepth=0),null==a.maxDepth&&(a.maxDepth=10),this._divide(a,0,!0)},_divide:function(a,b,c){if(this.evalCorners(),this.shouldDivide(a,b)){if(b++,this.splitVert&&!this.splitHoriz?c=!1:!this.splitVert&&this.splitHoriz&&(c=!0),this.horizontal=c,this.horizontal){var d=[this.corners[0],this.corners[1],this.midpoint(1),this.midpoint(3)],e=[this.midpoint(3),this.midpoint(1),this.corners[2],this.corners[3]];this.children=[new Oa(this.srf,d),new Oa(this.srf,e)],this.children[0].neighbors=[this.neighbors[0],this.neighbors[1],this.children[1],this.neighbors[3]],this.children[1].neighbors=[this.children[0],this.neighbors[1],this.neighbors[2],this.neighbors[3]]}else{var f=[this.corners[0],this.midpoint(0),this.midpoint(2),this.corners[3]],g=[this.midpoint(0),this.corners[1],this.corners[2],this.midpoint(2)];this.children=[new Oa(this.srf,f),new Oa(this.srf,g)],this.children[0].neighbors=[this.neighbors[0],this.children[1],this.neighbors[2],this.neighbors[3]],this.children[1].neighbors=[this.neighbors[0],this.neighbors[1],this.neighbors[2],this.children[0]]}for(var h=0,i=this.children;h<i.length;){var j=i[h];++h,j._divide(a,b,!c)}}},triangulate:function(a){if(null==a&&(a=Y.empty()),this.isLeaf())return this.triangulateLeaf(a);for(var b=0,c=this.children;b<c.length;){var d=c[b];if(++b,null==d)break;d.triangulate(a)}return a},triangulateLeaf:function(a){for(var b=a.points.length,c=[],d=[],e=0,f=0;f<4;){var g=f++,h=this.getAllCorners(g);2==h.length&&(e=g+1);for(var i=0,j=h.length;i<j;){var k=i++;c.push(h[k])}}for(var l=0;l<c.length;){var m=c[l];++l,m.id==-1?(a.uvs.push(m.uv),a.points.push(m.point),a.normals.push(m.normal),m.id=b,d.push(b),b++):d.push(m.id)}if(4==c.length)return a.faces.push([d[0],d[3],d[1]]),a.faces.push([d[3],d[2],d[1]]),a;if(5==c.length){var n=d.length;return a.faces.push([d[e],d[(e+2)%n],d[(e+1)%n]]),a.faces.push([d[(e+4)%n],d[(e+3)%n],d[e]]),a.faces.push([d[e],d[(e+3)%n],d[(e+2)%n]]),a}var o=this.center();a.uvs.push(o.uv),a.points.push(o.point),a.normals.push(o.normal);for(var p=a.points.length-1,q=0,r=c.length-1;q<c.length;)a.faces.push([p,d[q],d[r]]),r=q++;return a},__class__:Oa};var Pa=b.exe.Dispatcher=function(){};g["verb.exe.Dispatcher"]=Pa,Pa.__name__=["verb","exe","Dispatcher"],Pa.init=function(){Pa._init||(Pa._workerPool=new Qa(Pa.THREADS),Pa._init=!0)},Pa.dispatchMethod=function(a,b,c){Pa.init();var d=new I,e=function(a){d.resolve(a)};return Pa._workerPool.addWork(q.getClassName(a),b,c,e),new J(d)};var Qa=b.exe.WorkerPool=function(a,b){null==b&&(b="verb.js"),null==a&&(a=1),this._callbacks=new v,this._working=new v,this._pool=[],this._queue=[];for(var c=0;c<a;){var d;c++;try{d=new Worker(Qa.basePath+b)}catch(e){e instanceof C&&(e=e.val),d=new Worker(Qa.basePath+b.substring(0,-3)+".min.js")}this._pool.push(d)}};g["verb.exe.WorkerPool"]=Qa,Qa.__name__=["verb","exe","WorkerPool"],Qa.prototype={addWork:function(a,b,c,d){var e=new Ra(a,b,c);this._callbacks.set(e.id,d),this._queue.push(e),this.processQueue()},processQueue:function(){for(var b=this;this._queue.length>0&&this._pool.length>0;){var c=this._queue.shift(),d=[c.id],e=[this._pool.shift()];this._working.h[d[0]]=e[0],e[0].onmessage=function(c,d){return function(e){b._working.remove(d[0]),b._pool.push(c[0]);try{b._callbacks.h.hasOwnProperty(d[0])&&(b._callbacks.h[d[0]](e.data.result),b._callbacks.remove(d[0]))}catch(f){f instanceof C&&(f=f.val),a.log(f)}b.processQueue()}}(e,d),e[0].postMessage(c)}},__class__:Qa};var Ra=function(a,b,c){this.className=a,this.methodName=b,this.args=c,this.id=Ra.uuid++};g["verb.exe._WorkerPool.Work"]=Ra,Ra.__name__=["verb","exe","_WorkerPool","Work"],Ra.prototype={__class__:Ra};var Sa=function(){};g["verb.geom.ICurve"]=Sa,Sa.__name__=["verb","geom","ICurve"],Sa.__interfaces__=[za],Sa.prototype={__class__:Sa};var Ta=b.geom.NurbsCurve=function(a){this._data=Fa.isValidNurbsCurveData(a)};g["verb.geom.NurbsCurve"]=Ta,Ta.__name__=["verb","geom","NurbsCurve"],Ta.__interfaces__=[Sa],Ta.byKnotsControlPointsWeights=function(a,b,c,d){return new Ta(new W(a,b.slice(),Ia.homogenize1d(c,d)))},Ta.byPoints=function(a,b){return null==b&&(b=3),new Ta(Ka.rationalInterpCurve(a,b))},Ta.__super__=T,Ta.prototype=d(T.prototype,{degree:function(){return this._data.degree},knots:function(){return this._data.knots.slice(0)},controlPoints:function(){return Ia.dehomogenize1d(this._data.controlPoints)},weights:function(){return Ia.weight1d(this._data.controlPoints)},asNurbs:function(){return new W(this.degree(),this.knots(),Ia.homogenize1d(this.controlPoints(),this.weights()))},clone:function(){return new Ta(this._data)},domain:function(){return new aa(P.first(this._data.knots),P.last(this._data.knots))},transform:function(a){return new Ta(La.rationalCurveTransform(this._data,a))},transformAsync:function(a){return Pa.dispatchMethod(La,"rationalCurveTransform",[this._data,a]).then(function(a){return new Ta(a)})},point:function(a){return Ia.rationalCurvePoint(this._data,a)},pointAsync:function(a){return Pa.dispatchMethod(Ia,"rationalCurvePoint",[this._data,a])},tangent:function(a){return Ia.rationalCurveTangent(this._data,a)},tangentAsync:function(a){return Pa.dispatchMethod(Ia,"rationalCurveTangent",[this._data,a])},derivatives:function(a,b){return null==b&&(b=1),Ia.rationalCurveDerivatives(this._data,a,b)},derivativesAsync:function(a,b){return null==b&&(b=1),Pa.dispatchMethod(Ia,"rationalCurveDerivatives",[this._data,a,b])},closestPoint:function(a){return Da.rationalCurveClosestPoint(this._data,a)},closestPointAsync:function(a){return Pa.dispatchMethod(Da,"rationalCurveClosestPoint",[this._data,a])},closestParam:function(a){return Da.rationalCurveClosestParam(this._data,a)},closestParamAsync:function(a){return Pa.dispatchMethod(Da,"rationalCurveClosestParam",[this._data,a])},length:function(){return Da.rationalCurveArcLength(this._data)},lengthAsync:function(){return Pa.dispatchMethod(Da,"rationalCurveArcLength",[this._data])},lengthAtParam:function(a){return Da.rationalCurveArcLength(this._data,a)},lengthAtParamAsync:function(){return Pa.dispatchMethod(Da,"rationalCurveArcLength",[this._data])},paramAtLength:function(a,b){return Da.rationalCurveParamAtArcLength(this._data,a,b)},paramAtLengthAsync:function(a,b){return Pa.dispatchMethod(Da,"rationalCurveParamAtArcLength",[this._data,a,b])},divideByEqualArcLength:function(a){return Ga.rationalCurveByEqualArcLength(this._data,a)},divideByEqualArcLengthAsync:function(a){return Pa.dispatchMethod(Ga,"rationalCurveByEqualArcLength",[this._data,a])},divideByArcLength:function(a){return Ga.rationalCurveByArcLength(this._data,a)},divideByArcLengthAsync:function(a){return Pa.dispatchMethod(Ga,"rationalCurveByArcLength",[this._data,a])},split:function(a){return Ga.curveSplit(this._data,a).map(function(a){return new Ta(a)})},splitAsync:function(a){return Pa.dispatchMethod(Ga,"curveSplit",[this._data,a]).then(function(a){return a.map(function(a){return new Ta(a)})})},reverse:function(){return new Ta(La.curveReverse(this._data))},reverseAsync:function(){return Pa.dispatchMethod(La,"curveReverse",[this._data]).then(function(a){return new Ta(a)})},tessellate:function(a){return Ma.rationalCurveAdaptiveSample(this._data,a,!1)},tessellateAsync:function(a){return Pa.dispatchMethod(Ma,"rationalCurveAdaptiveSample",[this._data,a,!1])},__class__:Ta});var Ua=b.geom.Arc=function(a,b,c,d,e,f){Ta.call(this,Ka.arc(a,b,c,d,e,f)),this._center=a,this._xaxis=b,this._yaxis=c,this._radius=d,this._minAngle=e,this._maxAngle=f};g["verb.geom.Arc"]=Ua,Ua.__name__=["verb","geom","Arc"],Ua.__super__=Ta,Ua.prototype=d(Ta.prototype,{center:function(){return this._center},xaxis:function(){return this._xaxis},yaxis:function(){return this._yaxis},radius:function(){return this._radius},minAngle:function(){return this._minAngle},maxAngle:function(){return this._maxAngle},__class__:Ua});var Va=b.geom.BezierCurve=function(a,b){Ta.call(this,Ka.rationalBezierCurve(a,b))};g["verb.geom.BezierCurve"]=Va,Va.__name__=["verb","geom","BezierCurve"],Va.__super__=Ta,Va.prototype=d(Ta.prototype,{__class__:Va});var Wa=b.geom.Circle=function(a,b,c,d){Ua.call(this,a,b,c,d,0,2*Math.PI)};g["verb.geom.Circle"]=Wa,Wa.__name__=["verb","geom","Circle"],Wa.__super__=Ua,Wa.prototype=d(Ua.prototype,{__class__:Wa});var Xa=function(){};g["verb.geom.ISurface"]=Xa,Xa.__name__=["verb","geom","ISurface"],Xa.__interfaces__=[za],Xa.prototype={__class__:Xa};var Ya=b.geom.NurbsSurface=function(a){this._data=Fa.isValidNurbsSurfaceData(a)};g["verb.geom.NurbsSurface"]=Ya,Ya.__name__=["verb","geom","NurbsSurface"],Ya.__interfaces__=[Xa],Ya.byKnotsControlPointsWeights=function(a,b,c,d,e,f){return new Ya(new X(a,b,c,d,Ia.homogenize2d(e,f)))},Ya.byCorners=function(a,b,c,d){return new Ya(Ka.fourPointSurface(a,b,c,d))},Ya.byLoftingCurves=function(a,b){return new Ya(Ka.loftedSurface(function(b){for(var c,d=[],e=0;e<a.length;){var f=a[e];++e,d.push(f.asNurbs())}return c=d}(this),b))},Ya.__super__=T,Ya.prototype=d(T.prototype,{degreeU:function(){return this._data.degreeU},degreeV:function(){return this._data.degreeV},knotsU:function(){return this._data.knotsU.slice(0)},knotsV:function(){return this._data.knotsV.slice(0)},controlPoints:function(){return Ia.dehomogenize2d(this._data.controlPoints)},weights:function(){return Ia.weight2d(this._data.controlPoints)},asNurbs:function(){return new X(this.degreeU(),this.degreeV(),this.knotsU(),this.knotsV(),Ia.homogenize2d(this.controlPoints(),this.weights()))},clone:function(){return new Ya(this.asNurbs())},domainU:function(){return new aa(P.first(this._data.knotsU),P.last(this._data.knotsU))},domainV:function(){return new aa(P.first(this._data.knotsV),P.last(this._data.knotsV))},point:function(a,b){return Ia.rationalSurfacePoint(this._data,a,b)},pointAsync:function(a,b){return Pa.dispatchMethod(Ia,"rationalSurfacePoint",[this._data,a,b])},normal:function(a,b){return Ia.rationalSurfaceNormal(this._data,a,b)},normalAsync:function(a,b){return Pa.dispatchMethod(Ia,"rationalSurfaceNormal",[this._data,a,b])},derivatives:function(a,b,c){return null==c&&(c=1),Ia.rationalSurfaceDerivatives(this._data,a,b,c)},derivativesAsync:function(a,b,c){return null==c&&(c=1),Pa.dispatchMethod(Ia,"rationalSurfaceDerivatives",[this._data,a,b,c])},closestParam:function(a){return Da.rationalSurfaceClosestParam(this._data,a)},closestParamAsync:function(a){return Pa.dispatchMethod(Da,"rationalSurfaceClosestParam",[this._data,a])},closestPoint:function(a){return Da.rationalSurfaceClosestPoint(this._data,a)},closestPointAsync:function(a){return Pa.dispatchMethod(Da,"rationalSurfaceClosestPoint",[this._data,a])},split:function(a,b){return null==b&&(b=!1),Ga.surfaceSplit(this._data,a,b).map(function(a){return new Ya(a)})},splitAsync:function(a,b){return null==b&&(b=!1),Pa.dispatchMethod(Ga,"surfaceSplit",[this._data,a,b]).then(function(a){return a.map(function(a){return new Ya(a)})})},reverse:function(a){return null==a&&(a=!1),new Ya(La.surfaceReverse(this._data,a))},reverseAsync:function(a){return null==a&&(a=!1),Pa.dispatchMethod(La,"surfaceReverse",[this._data,a]).then(function(a){return new Ya(a)})},isocurve:function(a,b){return null==b&&(b=!1),new Ta(Ka.surfaceIsocurve(this._data,a,b))},isocurveAsync:function(a,b){return null==b&&(b=!1),Pa.dispatchMethod(Ka,"surfaceIsocurve",[this._data,a,b]).then(function(a){return new Ta(a)})},boundaries:function(a){return Ka.surfaceBoundaryCurves(this._data).map(function(a){return new Ta(a)})},boundariesAsync:function(a){return Pa.dispatchMethod(Ka,"surfaceBoundaryCurves",[this._data]).then(function(a){return a.map(function(a){return new Ta(a)})})},tessellate:function(a){return Ma.rationalSurfaceAdaptive(this._data,a)},tessellateAsync:function(a){return Pa.dispatchMethod(Ma,"rationalSurfaceAdaptive",[this._data,a])},transform:function(a){return new Ya(La.rationalSurfaceTransform(this._data,a))},transformAsync:function(a){return Pa.dispatchMethod(La,"rationalSurfaceTransform",[this._data,a]).then(function(a){return new Ya(a)})},__class__:Ya});var Za=b.geom.ConicalSurface=function(a,b,c,d,e){Ya.call(this,Ka.conicalSurface(a,b,c,d,e)),this._axis=a,this._xaxis=b,this._base=c,this._height=d,this._radius=e};g["verb.geom.ConicalSurface"]=Za,Za.__name__=["verb","geom","ConicalSurface"],Za.__super__=Ya,Za.prototype=d(Ya.prototype,{axis:function(){return this._axis},xaxis:function(){return this._xaxis},base:function(){return this._base},height:function(){return this._height},radius:function(){return this._radius},__class__:Za});var $a=b.geom.CylindricalSurface=function(a,b,c,d,e){Ya.call(this,Ka.cylindricalSurface(a,b,c,d,e)),this._axis=a,this._xaxis=b,this._base=c,this._height=d,this._radius=e};g["verb.geom.CylindricalSurface"]=$a,$a.__name__=["verb","geom","CylindricalSurface"],$a.__super__=Ya,$a.prototype=d(Ya.prototype,{axis:function(){return this._axis},xaxis:function(){return this._xaxis},base:function(){return this._base},height:function(){return this._height},radius:function(){return this._radius},__class__:$a});var _a=b.geom.EllipseArc=function(a,b,c,d,e){Ta.call(this,Ka.ellipseArc(a,b,c,d,e)),this._center=a,this._xaxis=b,this._yaxis=c,this._minAngle=d,this._maxAngle=e};g["verb.geom.EllipseArc"]=_a,_a.__name__=["verb","geom","EllipseArc"],_a.__super__=Ta,_a.prototype=d(Ta.prototype,{center:function(){return this._center},xaxis:function(){return this._xaxis},yaxis:function(){return this._yaxis},minAngle:function(){return this._minAngle},maxAngle:function(){return this._maxAngle},__class__:_a});var ab=b.geom.Ellipse=function(a,b,c){_a.call(this,a,b,c,0,2*Math.PI)};g["verb.geom.Ellipse"]=ab,ab.__name__=["verb","geom","Ellipse"],ab.__super__=_a,ab.prototype=d(_a.prototype,{__class__:ab});var bb=b.geom.ExtrudedSurface=function(a,b){Ya.call(this,Ka.extrudedSurface(Ca.normalized(b),Ca.norm(b),a.asNurbs())),this._profile=a,this._direction=b};g["verb.geom.ExtrudedSurface"]=bb,bb.__name__=["verb","geom","ExtrudedSurface"],bb.__super__=Ya,bb.prototype=d(Ya.prototype,{profile:function(){return this._profile},direction:function(){return this._direction},__class__:bb});var cb=b.geom.Intersect=function(){};g["verb.geom.Intersect"]=cb,cb.__name__=["verb","geom","Intersect"],cb.curves=function(a,b,c){return null==c&&(c=.001),Ja.curves(a.asNurbs(),b.asNurbs(),c)},cb.curvesAsync=function(a,b,c){return null==c&&(c=.001),Pa.dispatchMethod(Ja,"curves",[a.asNurbs(),b.asNurbs(),c])},cb.curveAndSurface=function(a,b,c){return null==c&&(c=.001),Ja.curveAndSurface(a.asNurbs(),b.asNurbs(),c)},cb.curveAndSurfaceAsync=function(a,b,c){return null==c&&(c=.001),Pa.dispatchMethod(Ja,"curveAndSurface",[a.asNurbs(),b.asNurbs(),c])},cb.surfaces=function(a,b,c){return null==c&&(c=.001),Ja.surfaces(a.asNurbs(),b.asNurbs(),c).map(function(a){return new Ta(a)})},cb.surfacesAsync=function(a,b,c){return null==c&&(c=.001),Pa.dispatchMethod(Ja,"surfaces",[a.asNurbs(),b.asNurbs(),c]).then(function(a){return a.map(function(a){return new Ta(a)})})};var db=b.geom.Line=function(a,b){Ta.call(this,Ka.polyline([a,b])),this._start=a,this._end=b};g["verb.geom.Line"]=db,db.__name__=["verb","geom","Line"],db.__super__=Ta,db.prototype=d(Ta.prototype,{start:function(){return this._start},end:function(){return this._end},__class__:db});var eb=b.geom.RevolvedSurface=function(a,b,c,d){Ya.call(this,Ka.revolvedSurface(a.asNurbs(),b,c,d)),this._profile=a,this._center=b,this._axis=c,this._angle=d};g["verb.geom.RevolvedSurface"]=eb,eb.__name__=["verb","geom","RevolvedSurface"],eb.__super__=Ya,eb.prototype=d(Ya.prototype,{profile:function(){return this._profile},center:function(){return this._center},axis:function(){return this._center},angle:function(){return this._angle},__class__:eb});var fb=b.geom.SphericalSurface=function(a,b){Ya.call(this,Ka.sphericalSurface(a,[0,0,1],[1,0,0],b)),this._center=a,this._radius=b};g["verb.geom.SphericalSurface"]=fb,fb.__name__=["verb","geom","SphericalSurface"],fb.__super__=Ya,fb.prototype=d(Ya.prototype,{center:function(){return this._center},radius:function(){return this._radius},__class__:fb});var gb=b.geom.SweptSurface=function(a,b){Ya.call(this,Ka.rationalTranslationalSurface(a.asNurbs(),b.asNurbs())),this._profile=a,this._rail=b};g["verb.geom.SweptSurface"]=gb,gb.__name__=["verb","geom","SweptSurface"],gb.__super__=Ya,gb.prototype=d(Ya.prototype,{profile:function(){return this._profile},rail:function(){return this._rail},__class__:gb});var hb,ib=0;g.Math=Math,String.prototype.__class__=g.String=String,String.__name__=["String"],g.Array=Array,Array.__name__=["Array"],Date.prototype.__class__=g.Date=Date,Date.__name__=["Date"];var jb=g.Int={__name__:["Int"]},kb=g.Dynamic={__name__:["Dynamic"]},lb=g.Float=Number;lb.__name__=["Float"];var mb=g.Bool=Boolean;mb.__ename__=["Bool"];var nb=g.Class={__name__:["Class"]},ob={};null==Array.prototype.map&&(Array.prototype.map=function(a){for(var b=[],c=0,d=this.length;c<d;){var e=c++;b[e]=a(this[e])}return b}),null==Array.prototype.filter&&(Array.prototype.filter=function(a){for(var b=[],c=0,d=this.length;c<d;){var e=c++,f=this[e];a(f)&&b.push(f)}return b});var pb={},qb=c.ArrayBuffer||E;null==qb.prototype.slice&&(qb.prototype.slice=E.sliceImpl);var rb=(c.DataView||F,c.Uint8Array||G._new);!function(a,b){function c(a){return o[n]=d.apply(b,a),n++}function d(a){var c=[].slice.call(arguments,1);return function(){"function"==typeof a?a.apply(b,c):new Function(""+a)()}}function e(a){if(p)setTimeout(d(e,a),0);else{var b=o[a];if(b){p=!0;try{b()}finally{f(a),p=!1}}}}function f(a){delete o[a]}function g(){m=function(){var a=c(arguments);return process.nextTick(d(e,a)),a}}function h(){if(a.postMessage&&!a.importScripts){var b=!0,c=a.onmessage;return a.onmessage=function(){b=!1},a.postMessage("","*"),a.onmessage=c,b}}function i(){var b="setImmediate$"+Math.random()+"$",d=function(c){c.source===a&&"string"==typeof c.data&&0===c.data.indexOf(b)&&e(+c.data.slice(b.length))};a.addEventListener?a.addEventListener("message",d,!1):a.attachEvent("onmessage",d),m=function(){var d=c(arguments);return a.postMessage(b+d,"*"),d}}function j(){var a=new MessageChannel;a.port1.onmessage=function(a){var b=a.data;e(b)},m=function(){var b=c(arguments);return a.port2.postMessage(b),b}}function k(){var a=q.documentElement;m=function(){var b=c(arguments),d=q.createElement("script");return d.onreadystatechange=function(){e(b),d.onreadystatechange=null,a.removeChild(d),d=null},a.appendChild(d),b}}function l(){m=function(){var a=c(arguments);return setTimeout(d(e,a),0),a}}if(!a.setImmediate){var m,n=1,o={},p=!1,q=a.document,r=Object.getPrototypeOf&&Object.getPrototypeOf(a);r=r&&r.setTimeout?r:a,"[object process]"==={}.toString.call(a.process)?g():h()?i():a.MessageChannel?j():q&&"onreadystatechange"in q.createElement("script")?k():l(),r.setImmediate=m,r.clearImmediate=f}}(new Function("return this")()),t.USE_CACHE=!1,t.USE_ENUM_INDEX=!1,t.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",u.DEFAULT_RESOLVER=q,u.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",w.count=0,B.i64tmp=function(a){var b,c=new s(0,0);return b=c}(this),D.__toStr={}.toString,G.BYTES_PER_ELEMENT=1,M.queue=new k,Q.memo=new v,S.TOLERANCE=1e-6,S.EPSILON=1e-10,S.VERSION="2.0.0",Da.Tvalues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],
Da.Cvalues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],Pa.THREADS=1,Pa._init=!1,Qa.basePath="",Ra.uuid=0,O.main()}("undefined"!=typeof console?console:{log:function(){}},a,"undefined"!=typeof e?e:"undefined"!=typeof b?b:"undefined"!=typeof self?self:this),a});
/* axios v0.19.0 | (c) 2019 by Matt Zabriskie */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.axios=t():e.axios=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";function r(e){var t=new i(e),n=s(i.prototype.request,t);return o.extend(n,i.prototype,t),o.extend(n,t),n}var o=n(2),s=n(3),i=n(5),a=n(22),u=n(11),c=r(u);c.Axios=i,c.create=function(e){return r(a(c.defaults,e))},c.Cancel=n(23),c.CancelToken=n(24),c.isCancel=n(10),c.all=function(e){return Promise.all(e)},c.spread=n(25),e.exports=c,e.exports.default=c},function(e,t,n){"use strict";function r(e){return"[object Array]"===j.call(e)}function o(e){return"[object ArrayBuffer]"===j.call(e)}function s(e){return"undefined"!=typeof FormData&&e instanceof FormData}function i(e){var t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer}function a(e){return"string"==typeof e}function u(e){return"number"==typeof e}function c(e){return"undefined"==typeof e}function f(e){return null!==e&&"object"==typeof e}function p(e){return"[object Date]"===j.call(e)}function d(e){return"[object File]"===j.call(e)}function l(e){return"[object Blob]"===j.call(e)}function h(e){return"[object Function]"===j.call(e)}function m(e){return f(e)&&h(e.pipe)}function y(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}function g(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}function x(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)}function v(e,t){if(null!==e&&"undefined"!=typeof e)if("object"!=typeof e&&(e=[e]),r(e))for(var n=0,o=e.length;n<o;n++)t.call(null,e[n],n,e);else for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(null,e[s],s,e)}function w(){function e(e,n){"object"==typeof t[n]&&"object"==typeof e?t[n]=w(t[n],e):t[n]=e}for(var t={},n=0,r=arguments.length;n<r;n++)v(arguments[n],e);return t}function b(){function e(e,n){"object"==typeof t[n]&&"object"==typeof e?t[n]=b(t[n],e):"object"==typeof e?t[n]=b({},e):t[n]=e}for(var t={},n=0,r=arguments.length;n<r;n++)v(arguments[n],e);return t}function E(e,t,n){return v(t,function(t,r){n&&"function"==typeof t?e[r]=S(t,n):e[r]=t}),e}var S=n(3),R=n(4),j=Object.prototype.toString;e.exports={isArray:r,isArrayBuffer:o,isBuffer:R,isFormData:s,isArrayBufferView:i,isString:a,isNumber:u,isObject:f,isUndefined:c,isDate:p,isFile:d,isBlob:l,isFunction:h,isStream:m,isURLSearchParams:y,isStandardBrowserEnv:x,forEach:v,merge:w,deepMerge:b,extend:E,trim:g}},function(e,t){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t){/*!
	 * Determine if an object is a Buffer
	 *
	 * @author   Feross Aboukhadijeh <https://feross.org>
	 * @license  MIT
	 */
e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},function(e,t,n){"use strict";function r(e){this.defaults=e,this.interceptors={request:new i,response:new i}}var o=n(2),s=n(6),i=n(7),a=n(8),u=n(22);r.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{},e.url=arguments[0]):e=e||{},e=u(this.defaults,e),e.method=e.method?e.method.toLowerCase():"get";var t=[a,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)n=n.then(t.shift(),t.shift());return n},r.prototype.getUri=function(e){return e=u(this.defaults,e),s(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},o.forEach(["delete","get","head","options"],function(e){r.prototype[e]=function(t,n){return this.request(o.merge(n||{},{method:e,url:t}))}}),o.forEach(["post","put","patch"],function(e){r.prototype[e]=function(t,n,r){return this.request(o.merge(r||{},{method:e,url:t,data:n}))}}),e.exports=r},function(e,t,n){"use strict";function r(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var o=n(2);e.exports=function(e,t,n){if(!t)return e;var s;if(n)s=n(t);else if(o.isURLSearchParams(t))s=t.toString();else{var i=[];o.forEach(t,function(e,t){null!==e&&"undefined"!=typeof e&&(o.isArray(e)?t+="[]":e=[e],o.forEach(e,function(e){o.isDate(e)?e=e.toISOString():o.isObject(e)&&(e=JSON.stringify(e)),i.push(r(t)+"="+r(e))}))}),s=i.join("&")}if(s){var a=e.indexOf("#");a!==-1&&(e=e.slice(0,a)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}},function(e,t,n){"use strict";function r(){this.handlers=[]}var o=n(2);r.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},r.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},r.prototype.forEach=function(e){o.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=r},function(e,t,n){"use strict";function r(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var o=n(2),s=n(9),i=n(10),a=n(11),u=n(20),c=n(21);e.exports=function(e){r(e),e.baseURL&&!u(e.url)&&(e.url=c(e.baseURL,e.url)),e.headers=e.headers||{},e.data=s(e.data,e.headers,e.transformRequest),e.headers=o.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),o.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]});var t=e.adapter||a.adapter;return t(e).then(function(t){return r(e),t.data=s(t.data,t.headers,e.transformResponse),t},function(t){return i(t)||(r(e),t&&t.response&&(t.response.data=s(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,n){"use strict";var r=n(2);e.exports=function(e,t,n){return r.forEach(n,function(n){e=n(e,t)}),e}},function(e,t){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";function r(e,t){!s.isUndefined(e)&&s.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function o(){var e;return"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process)?e=n(13):"undefined"!=typeof XMLHttpRequest&&(e=n(13)),e}var s=n(2),i=n(12),a={"Content-Type":"application/x-www-form-urlencoded"},u={adapter:o(),transformRequest:[function(e,t){return i(t,"Accept"),i(t,"Content-Type"),s.isFormData(e)||s.isArrayBuffer(e)||s.isBuffer(e)||s.isStream(e)||s.isFile(e)||s.isBlob(e)?e:s.isArrayBufferView(e)?e.buffer:s.isURLSearchParams(e)?(r(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):s.isObject(e)?(r(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};u.headers={common:{Accept:"application/json, text/plain, */*"}},s.forEach(["delete","get","head"],function(e){u.headers[e]={}}),s.forEach(["post","put","patch"],function(e){u.headers[e]=s.merge(a)}),e.exports=u},function(e,t,n){"use strict";var r=n(2);e.exports=function(e,t){r.forEach(e,function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])})}},function(e,t,n){"use strict";var r=n(2),o=n(14),s=n(6),i=n(17),a=n(18),u=n(15);e.exports=function(e){return new Promise(function(t,c){var f=e.data,p=e.headers;r.isFormData(f)&&delete p["Content-Type"];var d=new XMLHttpRequest;if(e.auth){var l=e.auth.username||"",h=e.auth.password||"";p.Authorization="Basic "+btoa(l+":"+h)}if(d.open(e.method.toUpperCase(),s(e.url,e.params,e.paramsSerializer),!0),d.timeout=e.timeout,d.onreadystatechange=function(){if(d&&4===d.readyState&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in d?i(d.getAllResponseHeaders()):null,r=e.responseType&&"text"!==e.responseType?d.response:d.responseText,s={data:r,status:d.status,statusText:d.statusText,headers:n,config:e,request:d};o(t,c,s),d=null}},d.onabort=function(){d&&(c(u("Request aborted",e,"ECONNABORTED",d)),d=null)},d.onerror=function(){c(u("Network Error",e,null,d)),d=null},d.ontimeout=function(){c(u("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",d)),d=null},r.isStandardBrowserEnv()){var m=n(19),y=(e.withCredentials||a(e.url))&&e.xsrfCookieName?m.read(e.xsrfCookieName):void 0;y&&(p[e.xsrfHeaderName]=y)}if("setRequestHeader"in d&&r.forEach(p,function(e,t){"undefined"==typeof f&&"content-type"===t.toLowerCase()?delete p[t]:d.setRequestHeader(t,e)}),e.withCredentials&&(d.withCredentials=!0),e.responseType)try{d.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&d.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){d&&(d.abort(),c(e),d=null)}),void 0===f&&(f=null),d.send(f)})}},function(e,t,n){"use strict";var r=n(15);e.exports=function(e,t,n){var o=n.config.validateStatus;!o||o(n.status)?e(n):t(r("Request failed with status code "+n.status,n.config,null,n.request,n))}},function(e,t,n){"use strict";var r=n(16);e.exports=function(e,t,n,o,s){var i=new Error(e);return r(i,t,n,o,s)}},function(e,t){"use strict";e.exports=function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},function(e,t,n){"use strict";var r=n(2),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,s,i={};return e?(r.forEach(e.split("\n"),function(e){if(s=e.indexOf(":"),t=r.trim(e.substr(0,s)).toLowerCase(),n=r.trim(e.substr(s+1)),t){if(i[t]&&o.indexOf(t)>=0)return;"set-cookie"===t?i[t]=(i[t]?i[t]:[]).concat([n]):i[t]=i[t]?i[t]+", "+n:n}}),i):i}},function(e,t,n){"use strict";var r=n(2);e.exports=r.isStandardBrowserEnv()?function(){function e(e){var t=e;return n&&(o.setAttribute("href",t),t=o.href),o.setAttribute("href",t),{href:o.href,protocol:o.protocol?o.protocol.replace(/:$/,""):"",host:o.host,search:o.search?o.search.replace(/^\?/,""):"",hash:o.hash?o.hash.replace(/^#/,""):"",hostname:o.hostname,port:o.port,pathname:"/"===o.pathname.charAt(0)?o.pathname:"/"+o.pathname}}var t,n=/(msie|trident)/i.test(navigator.userAgent),o=document.createElement("a");return t=e(window.location.href),function(n){var o=r.isString(n)?e(n):n;return o.protocol===t.protocol&&o.host===t.host}}():function(){return function(){return!0}}()},function(e,t,n){"use strict";var r=n(2);e.exports=r.isStandardBrowserEnv()?function(){return{write:function(e,t,n,o,s,i){var a=[];a.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),r.isString(o)&&a.push("path="+o),r.isString(s)&&a.push("domain="+s),i===!0&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},function(e,t){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var r=n(2);e.exports=function(e,t){t=t||{};var n={};return r.forEach(["url","method","params","data"],function(e){"undefined"!=typeof t[e]&&(n[e]=t[e])}),r.forEach(["headers","auth","proxy"],function(o){r.isObject(t[o])?n[o]=r.deepMerge(e[o],t[o]):"undefined"!=typeof t[o]?n[o]=t[o]:r.isObject(e[o])?n[o]=r.deepMerge(e[o]):"undefined"!=typeof e[o]&&(n[o]=e[o])}),r.forEach(["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"],function(r){"undefined"!=typeof t[r]?n[r]=t[r]:"undefined"!=typeof e[r]&&(n[r]=e[r])}),n}},function(e,t){"use strict";function n(e){this.message=e}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,e.exports=n},function(e,t,n){"use strict";function r(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var n=this;e(function(e){n.reason||(n.reason=new o(e),t(n.reason))})}var o=n(23);r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var e,t=new r(function(t){e=t});return{token:t,cancel:e}},e.exports=r},function(e,t){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}}])});

'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var b=function(){};b.prototype=a;return new b};
$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(c){}return!1};$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;
$jscomp.inherits=function(a,b){a.prototype=$jscomp.objectCreate(b.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var c=$jscomp.setPrototypeOf;c(a,b)}else for(c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.superClass_=b.prototype};$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};
$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("String.prototype.repeat",function(a){return a?a:function(b){var a=$jscomp.checkStringArgs(this,null,"repeat");if(0>b||1342177279<b)throw new RangeError("Invalid count value");b|=0;for(var d="";b;)if(b&1&&(d+=a),b>>>=1)a+=a;return d}},"es6","es3");$jscomp.stringPadding=function(a,b){a=void 0!==a?String(a):" ";return 0<b&&a?a.repeat(Math.ceil(b/a.length)).substring(0,b):""};
$jscomp.polyfill("String.prototype.padStart",function(a){return a?a:function(b,a){var c=$jscomp.checkStringArgs(this,null,"padStart");return $jscomp.stringPadding(a,b-c.length)+c}},"es8","es3");$jscomp.polyfill("String.prototype.padEnd",function(a){return a?a:function(b,a){var c=$jscomp.checkStringArgs(this,null,"padStart");return c+$jscomp.stringPadding(a,b-c.length)}},"es8","es3");
$jscomp.polyfill("Math.clz32",function(a){return a?a:function(b){b=Number(b)>>>0;if(0===b)return 32;var a=0;0===(b&4294901760)&&(b<<=16,a+=16);0===(b&4278190080)&&(b<<=8,a+=8);0===(b&4026531840)&&(b<<=4,a+=4);0===(b&3221225472)&&(b<<=2,a+=2);0===(b&2147483648)&&a++;return a}},"es6","es3");$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},b=Object.create(new $jscomp.global.Proxy(a,{get:function(c,d,e){return c==a&&"q"==d&&e==b}}));return!0===b.q}catch(c){return!1}};
$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};
$jscomp.polyfill("WeakMap",function(a){function b(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),d=new a([[b,2],[c,3]]);if(2!=d.get(b)||3!=d.get(c))return!1;d.delete(b);d.set(c,4);return!d.has(b)&&4==d.get(c)}catch(m){return!1}}function c(b){$jscomp.owns(b,e)||$jscomp.defineProperty(b,e,{value:{}})}function d(b){var a=Object[b];a&&(Object[b]=function(b){c(b);return a(b)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;
var e="$jscomp_hidden_"+Math.random();d("freeze");d("preventExtensions");d("seal");var f=0,h=function(b){this.id_=(f+=Math.random()+1).toString();if(b){$jscomp.initSymbol();$jscomp.initSymbolIterator();b=$jscomp.makeIterator(b);for(var a;!(a=b.next()).done;)a=a.value,this.set(a[0],a[1])}};h.prototype.set=function(b,a){c(b);if(!$jscomp.owns(b,e))throw Error("WeakMap key fail: "+b);b[e][this.id_]=a;return this};h.prototype.get=function(b){return $jscomp.owns(b,e)?b[e][this.id_]:void 0};h.prototype.has=
function(b){return $jscomp.owns(b,e)&&$jscomp.owns(b[e],this.id_)};h.prototype.delete=function(b){return $jscomp.owns(b,e)&&$jscomp.owns(b[e],this.id_)?delete b[e][this.id_]:!1};return h},"es6","es3");$jscomp.polyfill("String.prototype.endsWith",function(a){return a?a:function(b,a){var c=$jscomp.checkStringArgs(this,b,"endsWith");b+="";void 0===a&&(a=c.length);a=Math.max(0,Math.min(a|0,c.length));for(var e=b.length;0<e&&0<a;)if(c[--a]!=b[--e])return!1;return 0>=e}},"es6","es3");
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6","es3");
$jscomp.polyfill("Object.is",function(a){return a?a:function(b,a){return b===a?0!==b||1/b===1/a:b!==b&&a!==a}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(b,a){var c=this;c instanceof String&&(c=String(c));var e=c.length;a=a||0;for(0>a&&(a=Math.max(a+e,0));a<e;a++){var f=c[a];if(f===b||Object.is(f,b))return!0}return!1}},"es7","es3");
$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(b,a){return-1!==$jscomp.checkStringArgs(this,b,"includes").indexOf(b,a||0)}},"es6","es3");$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.findIndex",function(a){return a?a:function(b,a){return $jscomp.findInternal(this,b,a).i}},"es6","es3");
$jscomp.polyfill("Number.isNaN",function(a){return a?a:function(b){return"number"===typeof b&&isNaN(b)}},"es6","es3");$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function c(b){return b instanceof e?b:new e(function(a,c){a(b)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(b){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(b);return this};b.prototype.asyncExecuteBatch_=function(){var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})};var d=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(b){d(b,
0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var b=this.batch_;this.batch_=[];for(var a=0;a<b.length;++a){var c=b[a];b[a]=null;try{c()}catch(l){this.asyncThrow_(l)}}}this.batch_=null};b.prototype.asyncThrow_=function(b){this.asyncExecuteFunction(function(){throw b;})};var e=function(b){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var a=this.createResolveAndReject_();try{b(a.resolve,a.reject)}catch(k){a.reject(k)}};e.prototype.createResolveAndReject_=
function(){function b(b){return function(d){c||(c=!0,b.call(a,d))}}var a=this,c=!1;return{resolve:b(this.resolveTo_),reject:b(this.reject_)}};e.prototype.resolveTo_=function(b){if(b===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(b instanceof e)this.settleSameAsPromise_(b);else{a:switch(typeof b){case "object":var a=null!=b;break a;case "function":a=!0;break a;default:a=!1}a?this.resolveToNonPromiseObj_(b):this.fulfill_(b)}};e.prototype.resolveToNonPromiseObj_=function(b){var a=
void 0;try{a=b.then}catch(k){this.reject_(k);return}"function"==typeof a?this.settleSameAsThenable_(a,b):this.fulfill_(b)};e.prototype.reject_=function(b){this.settle_(2,b)};e.prototype.fulfill_=function(b){this.settle_(1,b)};e.prototype.settle_=function(b,a){if(0!=this.state_)throw Error("Cannot settle("+b+", "+a+"): Promise already settled in state"+this.state_);this.state_=b;this.result_=a;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var b=
0;b<this.onSettledCallbacks_.length;++b)f.asyncExecute(this.onSettledCallbacks_[b]);this.onSettledCallbacks_=null}};var f=new b;e.prototype.settleSameAsPromise_=function(b){var a=this.createResolveAndReject_();b.callWhenSettled_(a.resolve,a.reject)};e.prototype.settleSameAsThenable_=function(b,a){var c=this.createResolveAndReject_();try{b.call(a,c.resolve,c.reject)}catch(l){c.reject(l)}};e.prototype.then=function(b,a){function c(b,a){return"function"==typeof b?function(a){try{d(b(a))}catch(q){f(q)}}:
a}var d,f,g=new e(function(b,a){d=b;f=a});this.callWhenSettled_(c(b,d),c(a,f));return g};e.prototype.catch=function(b){return this.then(void 0,b)};e.prototype.callWhenSettled_=function(b,a){function c(){switch(d.state_){case 1:b(d.result_);break;case 2:a(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(c)};e.resolve=c;e.reject=function(b){return new e(function(a,c){c(b)})};e.race=function(b){return new e(function(a,
d){for(var e=$jscomp.makeIterator(b),f=e.next();!f.done;f=e.next())c(f.value).callWhenSettled_(a,d)})};e.all=function(b){var a=$jscomp.makeIterator(b),d=a.next();return d.done?c([]):new e(function(b,e){function f(a){return function(c){g[a]=c;h--;0==h&&b(g)}}var g=[],h=0;do g.push(void 0),h++,c(d.value).callWhenSettled_(f(g.length-1),e),d=a.next();while(!d.done)})};return e},"es6","es3");
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(b,a){var c=$jscomp.checkStringArgs(this,b,"startsWith");b+="";var e=c.length,f=b.length;a=Math.max(0,Math.min(a|0,c.length));for(var h=0;h<f&&a<e;)if(c[a++]!=b[h++])return!1;return h>=f}},"es6","es3");$jscomp.assign="function"==typeof Object.assign?Object.assign:function(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c];if(d)for(var e in d)$jscomp.owns(d,e)&&(a[e]=d[e])}return a};
$jscomp.polyfill("Object.assign",function(a){return a||$jscomp.assign},"es6","es3");$jscomp.polyfill("Object.setPrototypeOf",function(a){return a||$jscomp.setPrototypeOf},"es6","es5");
$jscomp.polyfill("Array.from",function(a){return a?a:function(b,a,d){$jscomp.initSymbolIterator();a=null!=a?a:function(b){return b};var c=[],f=b[Symbol.iterator];if("function"==typeof f)for(b=f.call(b);!(f=b.next()).done;)c.push(a.call(d,f.value));else{f=b.length;for(var h=0;h<f;h++)c.push(a.call(d,b[h]))}return c}},"es6","es3");$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(b,a){return $jscomp.findInternal(this,b,a).v}},"es6","es3");
$jscomp.polyfill("Number.MAX_SAFE_INTEGER",function(){return 9007199254740991},"es6","es3");$jscomp.polyfill("Number.MIN_SAFE_INTEGER",function(){return-9007199254740991},"es6","es3");$jscomp.polyfill("Promise.prototype.finally",function(a){return a?a:function(b){return this.then(function(a){return Promise.resolve(b()).then(function(){return a})},function(a){return Promise.resolve(b()).then(function(){throw a;})})}},"es8","es3");
$jscomp.polyfill("Math.sign",function(a){return a?a:function(b){b=Number(b);return 0===b||isNaN(b)?b:0<b?1:-1}},"es6","es3");$jscomp.polyfill("Object.values",function(a){return a?a:function(b){var a=[],d;for(d in b)$jscomp.owns(b,d)&&a.push(b[d]);return a}},"es8","es3");$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(b,a){return a})}},"es8","es3");var module$src$polyfills$CustomEvent={default:{}};
(function(){function a(b,a){a=a||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");c.initCustomEvent(b,a.bubbles,a.cancelable,a.detail);return c}if("function"===typeof window.CustomEvent)return!1;window.Event&&"function"===typeof window.Event&&(a.prototype=window.Event.prototype);window.CustomEvent=a})();var module$node_modules$tinycolor2$tinycolor={default:function(a,b){a=a?a:"";b=b||{};if(a instanceof module$node_modules$tinycolor2$tinycolor.default)return a;if(!(this instanceof module$node_modules$tinycolor2$tinycolor.default))return new module$node_modules$tinycolor2$tinycolor.default(a,b);var c=inputToRGB$$module$node_modules$tinycolor2$tinycolor(a);this._originalInput=a;this._r=c.r;this._g=c.g;this._b=c.b;this._a=c.a;this._roundA=mathRound$$module$node_modules$tinycolor2$tinycolor(100*this._a)/
100;this._format=b.format||c.format;this._gradientType=b.gradientType;1>this._r&&(this._r=mathRound$$module$node_modules$tinycolor2$tinycolor(this._r));1>this._g&&(this._g=mathRound$$module$node_modules$tinycolor2$tinycolor(this._g));1>this._b&&(this._b=mathRound$$module$node_modules$tinycolor2$tinycolor(this._b));this._ok=c.ok;this._tc_id=tinyCounter$$module$node_modules$tinycolor2$tinycolor++}},Math$$module$node_modules$tinycolor2$tinycolor=Math,trimLeft$$module$node_modules$tinycolor2$tinycolor=
/^\s+/,trimRight$$module$node_modules$tinycolor2$tinycolor=/\s+$/,tinyCounter$$module$node_modules$tinycolor2$tinycolor=0,mathRound$$module$node_modules$tinycolor2$tinycolor=Math$$module$node_modules$tinycolor2$tinycolor.round,mathMin$$module$node_modules$tinycolor2$tinycolor=Math$$module$node_modules$tinycolor2$tinycolor.min,mathMax$$module$node_modules$tinycolor2$tinycolor=Math$$module$node_modules$tinycolor2$tinycolor.max,mathRandom$$module$node_modules$tinycolor2$tinycolor=Math$$module$node_modules$tinycolor2$tinycolor.random;
module$node_modules$tinycolor2$tinycolor.default.prototype={isDark:function(){return 128>this.getBrightness()},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var a=this.toRgb();return(299*a.r+587*a.g+114*a.b)/1E3},getLuminance:function(){var a=this.toRgb();var b=a.r/255;var c=a.g/255;a=a.b/255;b=.03928>=b?b/12.92:
Math$$module$node_modules$tinycolor2$tinycolor.pow((b+.055)/1.055,2.4);c=.03928>=c?c/12.92:Math$$module$node_modules$tinycolor2$tinycolor.pow((c+.055)/1.055,2.4);a=.03928>=a?a/12.92:Math$$module$node_modules$tinycolor2$tinycolor.pow((a+.055)/1.055,2.4);return.2126*b+.7152*c+.0722*a},setAlpha:function(a){this._a=boundAlpha$$module$node_modules$tinycolor2$tinycolor(a);this._roundA=mathRound$$module$node_modules$tinycolor2$tinycolor(100*this._a)/100;return this},toHsv:function(){var a=rgbToHsv$$module$node_modules$tinycolor2$tinycolor(this._r,
this._g,this._b);return{h:360*a.h,s:a.s,v:a.v,a:this._a}},toHsvString:function(){var a=rgbToHsv$$module$node_modules$tinycolor2$tinycolor(this._r,this._g,this._b),b=mathRound$$module$node_modules$tinycolor2$tinycolor(360*a.h),c=mathRound$$module$node_modules$tinycolor2$tinycolor(100*a.s);a=mathRound$$module$node_modules$tinycolor2$tinycolor(100*a.v);return 1==this._a?"hsv("+b+", "+c+"%, "+a+"%)":"hsva("+b+", "+c+"%, "+a+"%, "+this._roundA+")"},toHsl:function(){var a=rgbToHsl$$module$node_modules$tinycolor2$tinycolor(this._r,
this._g,this._b);return{h:360*a.h,s:a.s,l:a.l,a:this._a}},toHslString:function(){var a=rgbToHsl$$module$node_modules$tinycolor2$tinycolor(this._r,this._g,this._b),b=mathRound$$module$node_modules$tinycolor2$tinycolor(360*a.h),c=mathRound$$module$node_modules$tinycolor2$tinycolor(100*a.s);a=mathRound$$module$node_modules$tinycolor2$tinycolor(100*a.l);return 1==this._a?"hsl("+b+", "+c+"%, "+a+"%)":"hsla("+b+", "+c+"%, "+a+"%, "+this._roundA+")"},toHex:function(a){return rgbToHex$$module$node_modules$tinycolor2$tinycolor(this._r,
this._g,this._b,a)},toHexString:function(a){return"#"+this.toHex(a)},toHex8:function(a){return rgbaToHex$$module$node_modules$tinycolor2$tinycolor(this._r,this._g,this._b,this._a,a)},toHex8String:function(a){return"#"+this.toHex8(a)},toRgb:function(){return{r:mathRound$$module$node_modules$tinycolor2$tinycolor(this._r),g:mathRound$$module$node_modules$tinycolor2$tinycolor(this._g),b:mathRound$$module$node_modules$tinycolor2$tinycolor(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+
mathRound$$module$node_modules$tinycolor2$tinycolor(this._r)+", "+mathRound$$module$node_modules$tinycolor2$tinycolor(this._g)+", "+mathRound$$module$node_modules$tinycolor2$tinycolor(this._b)+")":"rgba("+mathRound$$module$node_modules$tinycolor2$tinycolor(this._r)+", "+mathRound$$module$node_modules$tinycolor2$tinycolor(this._g)+", "+mathRound$$module$node_modules$tinycolor2$tinycolor(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:mathRound$$module$node_modules$tinycolor2$tinycolor(100*
bound01$$module$node_modules$tinycolor2$tinycolor(this._r,255))+"%",g:mathRound$$module$node_modules$tinycolor2$tinycolor(100*bound01$$module$node_modules$tinycolor2$tinycolor(this._g,255))+"%",b:mathRound$$module$node_modules$tinycolor2$tinycolor(100*bound01$$module$node_modules$tinycolor2$tinycolor(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+mathRound$$module$node_modules$tinycolor2$tinycolor(100*bound01$$module$node_modules$tinycolor2$tinycolor(this._r,
255))+"%, "+mathRound$$module$node_modules$tinycolor2$tinycolor(100*bound01$$module$node_modules$tinycolor2$tinycolor(this._g,255))+"%, "+mathRound$$module$node_modules$tinycolor2$tinycolor(100*bound01$$module$node_modules$tinycolor2$tinycolor(this._b,255))+"%)":"rgba("+mathRound$$module$node_modules$tinycolor2$tinycolor(100*bound01$$module$node_modules$tinycolor2$tinycolor(this._r,255))+"%, "+mathRound$$module$node_modules$tinycolor2$tinycolor(100*bound01$$module$node_modules$tinycolor2$tinycolor(this._g,
255))+"%, "+mathRound$$module$node_modules$tinycolor2$tinycolor(100*bound01$$module$node_modules$tinycolor2$tinycolor(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":1>this._a?!1:hexNames$$module$node_modules$tinycolor2$tinycolor[rgbToHex$$module$node_modules$tinycolor2$tinycolor(this._r,this._g,this._b,!0)]||!1},toFilter:function(a){var b="#"+rgbaToArgbHex$$module$node_modules$tinycolor2$tinycolor(this._r,this._g,this._b,this._a),c=b,d=this._gradientType?
"GradientType = 1, ":"";a&&(a=(0,module$node_modules$tinycolor2$tinycolor.default)(a),c="#"+rgbaToArgbHex$$module$node_modules$tinycolor2$tinycolor(a._r,a._g,a._b,a._a));return"progid:DXImageTransform.Microsoft.gradient("+d+"startColorstr="+b+",endColorstr="+c+")"},toString:function(a){var b=!!a;a=a||this._format;var c=!1,d=1>this._a&&0<=this._a;if(!b&&d&&("hex"===a||"hex6"===a||"hex3"===a||"hex4"===a||"hex8"===a||"name"===a))return"name"===a&&0===this._a?this.toName():this.toRgbString();"rgb"===
a&&(c=this.toRgbString());"prgb"===a&&(c=this.toPercentageRgbString());if("hex"===a||"hex6"===a)c=this.toHexString();"hex3"===a&&(c=this.toHexString(!0));"hex4"===a&&(c=this.toHex8String(!0));"hex8"===a&&(c=this.toHex8String());"name"===a&&(c=this.toName());"hsl"===a&&(c=this.toHslString());"hsv"===a&&(c=this.toHsvString());return c||this.toHexString()},clone:function(){return(0,module$node_modules$tinycolor2$tinycolor.default)(this.toString())},_applyModification:function(a,b){a=a.apply(null,[this].concat([].slice.call(b)));
this._r=a._r;this._g=a._g;this._b=a._b;this.setAlpha(a._a);return this},lighten:function(){return this._applyModification(lighten$$module$node_modules$tinycolor2$tinycolor,arguments)},brighten:function(){return this._applyModification(brighten$$module$node_modules$tinycolor2$tinycolor,arguments)},darken:function(){return this._applyModification(darken$$module$node_modules$tinycolor2$tinycolor,arguments)},desaturate:function(){return this._applyModification(desaturate$$module$node_modules$tinycolor2$tinycolor,
arguments)},saturate:function(){return this._applyModification(saturate$$module$node_modules$tinycolor2$tinycolor,arguments)},greyscale:function(){return this._applyModification(greyscale$$module$node_modules$tinycolor2$tinycolor,arguments)},spin:function(){return this._applyModification(spin$$module$node_modules$tinycolor2$tinycolor,arguments)},_applyCombination:function(a,b){return a.apply(null,[this].concat([].slice.call(b)))},analogous:function(){return this._applyCombination(analogous$$module$node_modules$tinycolor2$tinycolor,
arguments)},complement:function(){return this._applyCombination(complement$$module$node_modules$tinycolor2$tinycolor,arguments)},monochromatic:function(){return this._applyCombination(monochromatic$$module$node_modules$tinycolor2$tinycolor,arguments)},splitcomplement:function(){return this._applyCombination(splitcomplement$$module$node_modules$tinycolor2$tinycolor,arguments)},triad:function(){return this._applyCombination(triad$$module$node_modules$tinycolor2$tinycolor,arguments)},tetrad:function(){return this._applyCombination(tetrad$$module$node_modules$tinycolor2$tinycolor,
arguments)}};module$node_modules$tinycolor2$tinycolor.default.fromRatio=function(a,b){if("object"==typeof a){var c={},d;for(d in a)a.hasOwnProperty(d)&&(c[d]="a"===d?a[d]:convertToPercentage$$module$node_modules$tinycolor2$tinycolor(a[d]));a=c}return(0,module$node_modules$tinycolor2$tinycolor.default)(a,b)};
function inputToRGB$$module$node_modules$tinycolor2$tinycolor(a){var b={r:0,g:0,b:0},c=1,d,e=d=!1;"string"==typeof a&&(a=stringInputToObject$$module$node_modules$tinycolor2$tinycolor(a));"object"==typeof a&&(isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(a.r)&&isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(a.g)&&isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(a.b)?(b=rgbToRgb$$module$node_modules$tinycolor2$tinycolor(a.r,a.g,a.b),d=!0,e="%"===String(a.r).substr(-1)?"prgb":
"rgb"):isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(a.h)&&isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(a.s)&&isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(a.v)?(b=convertToPercentage$$module$node_modules$tinycolor2$tinycolor(a.s),d=convertToPercentage$$module$node_modules$tinycolor2$tinycolor(a.v),b=hsvToRgb$$module$node_modules$tinycolor2$tinycolor(a.h,b,d),d=!0,e="hsv"):isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(a.h)&&isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(a.s)&&
isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(a.l)&&(b=convertToPercentage$$module$node_modules$tinycolor2$tinycolor(a.s),d=convertToPercentage$$module$node_modules$tinycolor2$tinycolor(a.l),b=hslToRgb$$module$node_modules$tinycolor2$tinycolor(a.h,b,d),d=!0,e="hsl"),a.hasOwnProperty("a")&&(c=a.a));c=boundAlpha$$module$node_modules$tinycolor2$tinycolor(c);return{ok:d,format:a.format||e,r:mathMin$$module$node_modules$tinycolor2$tinycolor(255,mathMax$$module$node_modules$tinycolor2$tinycolor(b.r,
0)),g:mathMin$$module$node_modules$tinycolor2$tinycolor(255,mathMax$$module$node_modules$tinycolor2$tinycolor(b.g,0)),b:mathMin$$module$node_modules$tinycolor2$tinycolor(255,mathMax$$module$node_modules$tinycolor2$tinycolor(b.b,0)),a:c}}
function rgbToRgb$$module$node_modules$tinycolor2$tinycolor(a,b,c){return{r:255*bound01$$module$node_modules$tinycolor2$tinycolor(a,255),g:255*bound01$$module$node_modules$tinycolor2$tinycolor(b,255),b:255*bound01$$module$node_modules$tinycolor2$tinycolor(c,255)}}
function rgbToHsl$$module$node_modules$tinycolor2$tinycolor(a,b,c){a=bound01$$module$node_modules$tinycolor2$tinycolor(a,255);b=bound01$$module$node_modules$tinycolor2$tinycolor(b,255);c=bound01$$module$node_modules$tinycolor2$tinycolor(c,255);var d=mathMax$$module$node_modules$tinycolor2$tinycolor(a,b,c),e=mathMin$$module$node_modules$tinycolor2$tinycolor(a,b,c),f=(d+e)/2;if(d==e)var h=e=0;else{var g=d-e;e=.5<f?g/(2-d-e):g/(d+e);switch(d){case a:h=(b-c)/g+(b<c?6:0);break;case b:h=(c-a)/g+2;break;
case c:h=(a-b)/g+4}h/=6}return{h:h,s:e,l:f}}
function hslToRgb$$module$node_modules$tinycolor2$tinycolor(a,b,c){function d(b,a,c){0>c&&(c+=1);1<c&&--c;return c<1/6?b+6*(a-b)*c:.5>c?a:c<2/3?b+(a-b)*(2/3-c)*6:b}a=bound01$$module$node_modules$tinycolor2$tinycolor(a,360);b=bound01$$module$node_modules$tinycolor2$tinycolor(b,100);c=bound01$$module$node_modules$tinycolor2$tinycolor(c,100);if(0===b)c=b=a=c;else{var e=.5>c?c*(1+b):c+b-c*b,f=2*c-e;c=d(f,e,a+1/3);b=d(f,e,a);a=d(f,e,a-1/3)}return{r:255*c,g:255*b,b:255*a}}
function rgbToHsv$$module$node_modules$tinycolor2$tinycolor(a,b,c){a=bound01$$module$node_modules$tinycolor2$tinycolor(a,255);b=bound01$$module$node_modules$tinycolor2$tinycolor(b,255);c=bound01$$module$node_modules$tinycolor2$tinycolor(c,255);var d=mathMax$$module$node_modules$tinycolor2$tinycolor(a,b,c),e=mathMin$$module$node_modules$tinycolor2$tinycolor(a,b,c),f=d-e;if(d==e)var h=0;else{switch(d){case a:h=(b-c)/f+(b<c?6:0);break;case b:h=(c-a)/f+2;break;case c:h=(a-b)/f+4}h/=6}return{h:h,s:0===
d?0:f/d,v:d}}function hsvToRgb$$module$node_modules$tinycolor2$tinycolor(a,b,c){a=6*bound01$$module$node_modules$tinycolor2$tinycolor(a,360);b=bound01$$module$node_modules$tinycolor2$tinycolor(b,100);c=bound01$$module$node_modules$tinycolor2$tinycolor(c,100);var d=Math$$module$node_modules$tinycolor2$tinycolor.floor(a),e=a-d;a=c*(1-b);var f=c*(1-e*b);b=c*(1-(1-e)*b);d%=6;return{r:255*[c,f,a,a,b,c][d],g:255*[b,c,c,f,a,a][d],b:255*[a,a,b,c,c,f][d]}}
function rgbToHex$$module$node_modules$tinycolor2$tinycolor(a,b,c,d){a=[pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(a).toString(16)),pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(b).toString(16)),pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(c).toString(16))];return d&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==
a[2].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0):a.join("")}
function rgbaToHex$$module$node_modules$tinycolor2$tinycolor(a,b,c,d,e){a=[pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(a).toString(16)),pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(b).toString(16)),pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(c).toString(16)),pad2$$module$node_modules$tinycolor2$tinycolor(convertDecimalToHex$$module$node_modules$tinycolor2$tinycolor(d))];return e&&
a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}
function rgbaToArgbHex$$module$node_modules$tinycolor2$tinycolor(a,b,c,d){return[pad2$$module$node_modules$tinycolor2$tinycolor(convertDecimalToHex$$module$node_modules$tinycolor2$tinycolor(d)),pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(a).toString(16)),pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(b).toString(16)),pad2$$module$node_modules$tinycolor2$tinycolor(mathRound$$module$node_modules$tinycolor2$tinycolor(c).toString(16))].join("")}
module$node_modules$tinycolor2$tinycolor.default.equals=function(a,b){return a&&b?(0,module$node_modules$tinycolor2$tinycolor.default)(a).toRgbString()==(0,module$node_modules$tinycolor2$tinycolor.default)(b).toRgbString():!1};module$node_modules$tinycolor2$tinycolor.default.random=function(){return module$node_modules$tinycolor2$tinycolor.default.fromRatio({r:mathRandom$$module$node_modules$tinycolor2$tinycolor(),g:mathRandom$$module$node_modules$tinycolor2$tinycolor(),b:mathRandom$$module$node_modules$tinycolor2$tinycolor()})};
function desaturate$$module$node_modules$tinycolor2$tinycolor(a,b){b=0===b?0:b||10;a=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toHsl();a.s-=b/100;a.s=clamp01$$module$node_modules$tinycolor2$tinycolor(a.s);return(0,module$node_modules$tinycolor2$tinycolor.default)(a)}
function saturate$$module$node_modules$tinycolor2$tinycolor(a,b){b=0===b?0:b||10;a=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toHsl();a.s+=b/100;a.s=clamp01$$module$node_modules$tinycolor2$tinycolor(a.s);return(0,module$node_modules$tinycolor2$tinycolor.default)(a)}function greyscale$$module$node_modules$tinycolor2$tinycolor(a){return(0,module$node_modules$tinycolor2$tinycolor.default)(a).desaturate(100)}
function lighten$$module$node_modules$tinycolor2$tinycolor(a,b){b=0===b?0:b||10;a=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toHsl();a.l+=b/100;a.l=clamp01$$module$node_modules$tinycolor2$tinycolor(a.l);return(0,module$node_modules$tinycolor2$tinycolor.default)(a)}
function brighten$$module$node_modules$tinycolor2$tinycolor(a,b){b=0===b?0:b||10;a=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toRgb();a.r=mathMax$$module$node_modules$tinycolor2$tinycolor(0,mathMin$$module$node_modules$tinycolor2$tinycolor(255,a.r-mathRound$$module$node_modules$tinycolor2$tinycolor(255*-(b/100))));a.g=mathMax$$module$node_modules$tinycolor2$tinycolor(0,mathMin$$module$node_modules$tinycolor2$tinycolor(255,a.g-mathRound$$module$node_modules$tinycolor2$tinycolor(255*-(b/
100))));a.b=mathMax$$module$node_modules$tinycolor2$tinycolor(0,mathMin$$module$node_modules$tinycolor2$tinycolor(255,a.b-mathRound$$module$node_modules$tinycolor2$tinycolor(255*-(b/100))));return(0,module$node_modules$tinycolor2$tinycolor.default)(a)}
function darken$$module$node_modules$tinycolor2$tinycolor(a,b){b=0===b?0:b||10;a=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toHsl();a.l-=b/100;a.l=clamp01$$module$node_modules$tinycolor2$tinycolor(a.l);return(0,module$node_modules$tinycolor2$tinycolor.default)(a)}function spin$$module$node_modules$tinycolor2$tinycolor(a,b){a=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toHsl();b=(a.h+b)%360;a.h=0>b?360+b:b;return(0,module$node_modules$tinycolor2$tinycolor.default)(a)}
function complement$$module$node_modules$tinycolor2$tinycolor(a){a=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toHsl();a.h=(a.h+180)%360;return(0,module$node_modules$tinycolor2$tinycolor.default)(a)}
function triad$$module$node_modules$tinycolor2$tinycolor(a){var b=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toHsl(),c=b.h;return[(0,module$node_modules$tinycolor2$tinycolor.default)(a),(0,module$node_modules$tinycolor2$tinycolor.default)({h:(c+120)%360,s:b.s,l:b.l}),(0,module$node_modules$tinycolor2$tinycolor.default)({h:(c+240)%360,s:b.s,l:b.l})]}
function tetrad$$module$node_modules$tinycolor2$tinycolor(a){var b=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toHsl(),c=b.h;return[(0,module$node_modules$tinycolor2$tinycolor.default)(a),(0,module$node_modules$tinycolor2$tinycolor.default)({h:(c+90)%360,s:b.s,l:b.l}),(0,module$node_modules$tinycolor2$tinycolor.default)({h:(c+180)%360,s:b.s,l:b.l}),(0,module$node_modules$tinycolor2$tinycolor.default)({h:(c+270)%360,s:b.s,l:b.l})]}
function splitcomplement$$module$node_modules$tinycolor2$tinycolor(a){var b=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toHsl(),c=b.h;return[(0,module$node_modules$tinycolor2$tinycolor.default)(a),(0,module$node_modules$tinycolor2$tinycolor.default)({h:(c+72)%360,s:b.s,l:b.l}),(0,module$node_modules$tinycolor2$tinycolor.default)({h:(c+216)%360,s:b.s,l:b.l})]}
function analogous$$module$node_modules$tinycolor2$tinycolor(a,b,c){b=b||6;c=c||30;var d=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toHsl();c=360/c;a=[(0,module$node_modules$tinycolor2$tinycolor.default)(a)];for(d.h=(d.h-(c*b>>1)+720)%360;--b;)d.h=(d.h+c)%360,a.push((0,module$node_modules$tinycolor2$tinycolor.default)(d));return a}
function monochromatic$$module$node_modules$tinycolor2$tinycolor(a,b){b=b||6;var c=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toHsv();a=c.h;var d=c.s;c=c.v;for(var e=[],f=1/b;b--;)e.push((0,module$node_modules$tinycolor2$tinycolor.default)({h:a,s:d,v:c})),c=(c+f)%1;return e}
module$node_modules$tinycolor2$tinycolor.default.mix=function(a,b,c){c=0===c?0:c||50;a=(0,module$node_modules$tinycolor2$tinycolor.default)(a).toRgb();b=(0,module$node_modules$tinycolor2$tinycolor.default)(b).toRgb();c/=100;return(0,module$node_modules$tinycolor2$tinycolor.default)({r:(b.r-a.r)*c+a.r,g:(b.g-a.g)*c+a.g,b:(b.b-a.b)*c+a.b,a:(b.a-a.a)*c+a.a})};
module$node_modules$tinycolor2$tinycolor.default.readability=function(a,b){a=(0,module$node_modules$tinycolor2$tinycolor.default)(a);b=(0,module$node_modules$tinycolor2$tinycolor.default)(b);return(Math$$module$node_modules$tinycolor2$tinycolor.max(a.getLuminance(),b.getLuminance())+.05)/(Math$$module$node_modules$tinycolor2$tinycolor.min(a.getLuminance(),b.getLuminance())+.05)};
module$node_modules$tinycolor2$tinycolor.default.isReadable=function(a,b,c){a=module$node_modules$tinycolor2$tinycolor.default.readability(a,b);b=!1;c=validateWCAG2Parms$$module$node_modules$tinycolor2$tinycolor(c);switch(c.level+c.size){case "AAsmall":case "AAAlarge":b=4.5<=a;break;case "AAlarge":b=3<=a;break;case "AAAsmall":b=7<=a}return b};
module$node_modules$tinycolor2$tinycolor.default.mostReadable=function(a,b,c){var d=null,e=0;c=c||{};var f=c.includeFallbackColors;var h=c.level;var g=c.size;for(var k=0;k<b.length;k++){var l=module$node_modules$tinycolor2$tinycolor.default.readability(a,b[k]);l>e&&(e=l,d=(0,module$node_modules$tinycolor2$tinycolor.default)(b[k]))}if(module$node_modules$tinycolor2$tinycolor.default.isReadable(a,d,{level:h,size:g})||!f)return d;c.includeFallbackColors=!1;return module$node_modules$tinycolor2$tinycolor.default.mostReadable(a,
["#fff","#000"],c)};
var names$$module$node_modules$tinycolor2$tinycolor=module$node_modules$tinycolor2$tinycolor.default.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",
darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",
forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",
lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",
moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",
seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},hexNames$$module$node_modules$tinycolor2$tinycolor=module$node_modules$tinycolor2$tinycolor.default.hexNames=flip$$module$node_modules$tinycolor2$tinycolor(names$$module$node_modules$tinycolor2$tinycolor);
function flip$$module$node_modules$tinycolor2$tinycolor(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&(b[a[c]]=c);return b}function boundAlpha$$module$node_modules$tinycolor2$tinycolor(a){a=parseFloat(a);if(isNaN(a)||0>a||1<a)a=1;return a}
function bound01$$module$node_modules$tinycolor2$tinycolor(a,b){isOnePointZero$$module$node_modules$tinycolor2$tinycolor(a)&&(a="100%");var c=isPercentage$$module$node_modules$tinycolor2$tinycolor(a);a=mathMin$$module$node_modules$tinycolor2$tinycolor(b,mathMax$$module$node_modules$tinycolor2$tinycolor(0,parseFloat(a)));c&&(a=parseInt(a*b,10)/100);return 1E-6>Math$$module$node_modules$tinycolor2$tinycolor.abs(a-b)?1:a%b/parseFloat(b)}
function clamp01$$module$node_modules$tinycolor2$tinycolor(a){return mathMin$$module$node_modules$tinycolor2$tinycolor(1,mathMax$$module$node_modules$tinycolor2$tinycolor(0,a))}function parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(a){return parseInt(a,16)}function isOnePointZero$$module$node_modules$tinycolor2$tinycolor(a){return"string"==typeof a&&-1!=a.indexOf(".")&&1===parseFloat(a)}
function isPercentage$$module$node_modules$tinycolor2$tinycolor(a){return"string"===typeof a&&-1!=a.indexOf("%")}function pad2$$module$node_modules$tinycolor2$tinycolor(a){return 1==a.length?"0"+a:""+a}function convertToPercentage$$module$node_modules$tinycolor2$tinycolor(a){1>=a&&(a=100*a+"%");return a}function convertDecimalToHex$$module$node_modules$tinycolor2$tinycolor(a){return Math$$module$node_modules$tinycolor2$tinycolor.round(255*parseFloat(a)).toString(16)}
function convertHexToDecimal$$module$node_modules$tinycolor2$tinycolor(a){return parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(a)/255}
var matchers$$module$node_modules$tinycolor2$tinycolor=function(){return{CSS_UNIT:/(?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?)/,rgb:/rgb[\s|\(]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))\s*\)?/,rgba:/rgba[\s|\(]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))\s*\)?/,hsl:/hsl[\s|\(]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))\s*\)?/,
hsla:/hsla[\s|\(]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))\s*\)?/,hsv:/hsv[\s|\(]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))\s*\)?/,hsva:/hsva[\s|\(]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))[,|\s]+((?:[-\+]?\d*\.\d+%?)|(?:[-\+]?\d+%?))\s*\)?/,
hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function isValidCSSUnit$$module$node_modules$tinycolor2$tinycolor(a){return!!matchers$$module$node_modules$tinycolor2$tinycolor.CSS_UNIT.exec(a)}
function stringInputToObject$$module$node_modules$tinycolor2$tinycolor(a){a=a.replace(trimLeft$$module$node_modules$tinycolor2$tinycolor,"").replace(trimRight$$module$node_modules$tinycolor2$tinycolor,"").toLowerCase();var b=!1;if(names$$module$node_modules$tinycolor2$tinycolor[a])a=names$$module$node_modules$tinycolor2$tinycolor[a],b=!0;else if("transparent"==a)return{r:0,g:0,b:0,a:0,format:"name"};var c;return(c=matchers$$module$node_modules$tinycolor2$tinycolor.rgb.exec(a))?{r:c[1],g:c[2],b:c[3]}:
(c=matchers$$module$node_modules$tinycolor2$tinycolor.rgba.exec(a))?{r:c[1],g:c[2],b:c[3],a:c[4]}:(c=matchers$$module$node_modules$tinycolor2$tinycolor.hsl.exec(a))?{h:c[1],s:c[2],l:c[3]}:(c=matchers$$module$node_modules$tinycolor2$tinycolor.hsla.exec(a))?{h:c[1],s:c[2],l:c[3],a:c[4]}:(c=matchers$$module$node_modules$tinycolor2$tinycolor.hsv.exec(a))?{h:c[1],s:c[2],v:c[3]}:(c=matchers$$module$node_modules$tinycolor2$tinycolor.hsva.exec(a))?{h:c[1],s:c[2],v:c[3],a:c[4]}:(c=matchers$$module$node_modules$tinycolor2$tinycolor.hex8.exec(a))?
{r:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[1]),g:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[2]),b:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[3]),a:convertHexToDecimal$$module$node_modules$tinycolor2$tinycolor(c[4]),format:b?"name":"hex8"}:(c=matchers$$module$node_modules$tinycolor2$tinycolor.hex6.exec(a))?{r:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[1]),g:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[2]),b:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[3]),
format:b?"name":"hex"}:(c=matchers$$module$node_modules$tinycolor2$tinycolor.hex4.exec(a))?{r:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[1]+""+c[1]),g:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[2]+""+c[2]),b:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[3]+""+c[3]),a:convertHexToDecimal$$module$node_modules$tinycolor2$tinycolor(c[4]+""+c[4]),format:b?"name":"hex8"}:(c=matchers$$module$node_modules$tinycolor2$tinycolor.hex3.exec(a))?{r:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[1]+
""+c[1]),g:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[2]+""+c[2]),b:parseIntFromHex$$module$node_modules$tinycolor2$tinycolor(c[3]+""+c[3]),format:b?"name":"hex"}:!1}function validateWCAG2Parms$$module$node_modules$tinycolor2$tinycolor(a){a=a||{level:"AA",size:"small"};var b=(a.level||"AA").toUpperCase();a=(a.size||"small").toLowerCase();"AA"!==b&&"AAA"!==b&&(b="AA");"small"!==a&&"large"!==a&&(a="small");return{level:b,size:a}};var module$src$externals$three={};try{module$src$externals$three.default=eval("THREE")}catch(a){"function"===typeof require&&(module$src$externals$three.default=eval("require('three')"))};var module$src$polyfills$padStart={default:{}};String.prototype.padStart||(String.prototype.padStart=function(a,b){a>>=0;b=String("undefined"!==typeof b?b:" ");if(this.length>a)return String(this);a-=this.length;a>b.length&&(b+=b.repeat(a/b.length));return b.slice(0,a)+String(this)});var module$src$polyfills$padEnd={default:{}};String.prototype.padEnd||(String.prototype.padEnd=function(a,b){a>>=0;b=String("undefined"!==typeof b?b:" ");if(this.length>a)return String(this);a-=this.length;a>b.length&&(b+=b.repeat(a/b.length));return String(this)+b.slice(0,a)});var module$src$shared$util$toTinyColor={},tinycolor$$module$src$shared$util$toTinyColor=module$node_modules$tinycolor2$tinycolor.default;
if(void 0===module$node_modules$tinycolor2$tinycolor.default.prototype.toThreeColor){var THREE$$module$src$shared$util$toTinyColor=module$src$externals$three.default;module$node_modules$tinycolor2$tinycolor.default.prototype.toThreeColor=function(){return new module$src$externals$three.default.Color(this.toRgbString())};module$node_modules$tinycolor2$tinycolor.default.prototype.toArray=function(){return[this._r,this._g,this._b,255*this._a]}}
module$src$shared$util$toTinyColor.default=function(a,b){if(a.hasOwnProperty("getOriginalInput"))return a;var c=null;b&&(c=(0,module$node_modules$tinycolor2$tinycolor.default)(b));if("number"===typeof a)return a=a.toString(16),b=a.length,3>b?a=a.padStart(3,0):6>b?a=a.padStart(6,0):8>b&&(a=a.padEnd(8,0)),a=(0,module$node_modules$tinycolor2$tinycolor.default)(a),a.isValid()?a:c;if(a.isColor&&"function"==typeof a.getHexString)return a=(0,module$node_modules$tinycolor2$tinycolor.default)(a.getHexString()),
a.isValid()?a:c;if(Array.isArray(a)&&(3==a.length||4==a.length)){b=!0;for(var d=0;3>d;++d)a[d]=parseFloat(a[d]),isNaN(a[d])&&(b=!1);if(!b)return c;b=(0,module$node_modules$tinycolor2$tinycolor.default)({r:Math.max(0,Math.min(a[0],255)),g:Math.max(0,Math.min(a[1],255)),b:Math.max(0,Math.min(a[2],255))});4==a.length&&(a=parseFloat(a[3]),isNaN(a)||b.setAlpha(Math.max(0,Math.min(a,255))/255));return b.isValid()?b:c}if("string"!==typeof a)return a=(0,module$node_modules$tinycolor2$tinycolor.default)(a),
a.isValid()?a:c;a=a.replace("0x","#");if(null!==a.match(/^#[a-f0-9]{6}$/i))return a=(0,module$node_modules$tinycolor2$tinycolor.default)(a+"ff"),a.isValid()?a:c;if(null!==a.match(/^#[a-f0-9]{8}$/i))return a=(0,module$node_modules$tinycolor2$tinycolor.default)(a),a.isValid()?a:c;if(null!==a.match(/^#[a-f0-9]{7}$/i))return a=(0,module$node_modules$tinycolor2$tinycolor.default)(a.slice(0,7)+"0"+a.slice(-1)),a.isValid()?a:c;a=(0,module$node_modules$tinycolor2$tinycolor.default)(a);return a.isValid()?
a:c};var module$src$shared$util$atobtoa={default:{}};module$src$shared$util$atobtoa.default.btoaUTF8=function(a,b){return originalBtoa$$module$src$shared$util$atobtoa((b?"\u00ef\u00bb\u00bf":"")+a.replace(/[\x80-\uD7ff\uDC00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]?/g,btoaReplacer$$module$src$shared$util$atobtoa))};
module$src$shared$util$atobtoa.default.atobUTF8=function(a,b){b||"\u00ef\u00bb\u00bf"!==a.substring(0,3)||(a=a.substring(3));return originalAtob$$module$src$shared$util$atobtoa(a).replace(/[\xc0-\xff][\x80-\xbf]*/g,atobReplacer$$module$src$shared$util$atobtoa)};
var log$$module$src$shared$util$atobtoa=Math.log,LN2$$module$src$shared$util$atobtoa=Math.LN2,clz32$$module$src$shared$util$atobtoa=Math.clz32||function(a){return 31-log$$module$src$shared$util$atobtoa(a>>>0)/LN2$$module$src$shared$util$atobtoa|0},fromCharCode$$module$src$shared$util$atobtoa=String.fromCharCode,originalAtob$$module$src$shared$util$atobtoa=atob,originalBtoa$$module$src$shared$util$atobtoa=btoa;
function btoaReplacer$$module$src$shared$util$atobtoa(a){var b=a.charCodeAt(0);if(55296<=b&&56319>=b){var c=a.charCodeAt(1);if(c===c&&56320<=c&&57343>=c){if(b=1024*(b-55296)+c-56320+65536,65535<b)return fromCharCode$$module$src$shared$util$atobtoa(240|b>>>18,128|b>>>12&63,128|b>>>6&63,128|b&63)}else return fromCharCode$$module$src$shared$util$atobtoa(239,191,189)}return 127>=b?a:2047>=b?fromCharCode$$module$src$shared$util$atobtoa(192|b>>>6,128|b&63):fromCharCode$$module$src$shared$util$atobtoa(224|
b>>>12,128|b>>>6&63,128|b&63)}function atobReplacer$$module$src$shared$util$atobtoa(a){var b=a.charCodeAt(0)<<24,c=clz32$$module$src$shared$util$atobtoa(~b),d=0,e=a.length,f="";if(5>c&&e>=c){b=b<<c>>>24+c;for(d=1;d<c;++d)b=b<<6|a.charCodeAt(d)&63;65535>=b?f+=fromCharCode$$module$src$shared$util$atobtoa(b):1114111>=b?(b-=65536,f+=fromCharCode$$module$src$shared$util$atobtoa((b>>10)+55296,(b&1023)+56320)):d=0}for(;d<e;++d)f+="\ufffd";return f};var module$src$shared$util$CopyManager={default:{}};Object.defineProperty(module$src$shared$util$CopyManager.default,"__esModule",{value:!0});
var CopyManager$$module$src$shared$util$CopyManager=function(){function a(){this._nanString="___NaN___";this._negInfinity="___NegInfinity___";this._posInfinity="___PosInfinity___";this._replaceRegex=/\]$/;this._splitRegex=/[.[\]]+/;this._copyId=0}a.prototype.deepCopy=function(b,a){var c=this;void 0===a&&(a=[]);if("object"!==typeof b)return b;Array.isArray(a)||(a=[a]);if(0===a.length){var e=new WeakMap,f={},h=JSON.stringify(b,function(b,a){return c.deepCopyReplacer(b,a,e,f)});return JSON.parse(h,function(b,
a){return c.deepCopyReviver(b,a,f)})}h=[];if(this.getPaths(b,h,"",a)||0===h.length)return this.deepCopy(b);for(var g={},k=function(c){var d=l.getAtPath(b,c);if(a.every(function(b){return c===b||c.endsWith("."+b)?!1:!0}))if(Array.isArray(d)){var e=d;d=[];for(var f=0;f<e.length;f++)d.push(l.deepCopy(e[f],a))}else d=l.deepCopy(d);l.forceAtPath(g,c,d)},l=this,m=0;m<h.length;m++)k(h[m]);return g};a.prototype.deepCopyReplacer=function(b,a,d,e){void 0===d&&(d=null);void 0===e&&(e=null);if("number"===typeof a&&
isNaN(a))return this._nanString;if(a===Number.POSITIVE_INFINITY)return this._posInfinity;if(a===Number.NEGATIVE_INFINITY)return this._negInfinity;if(null!==d&&"object"===typeof a&&a)if(!d.has(a))b=this.createCopyId(),d.set(a,b),e[b]=a;else if(null!==e&&null!==d)return b=d.get(a);return a};a.prototype.deepCopyReviver=function(a,c,d){void 0===d&&(d=null);if("string"===typeof c){if(c===this._nanString)return Number.NaN;if(c===this._posInfinity)return Number.POSITIVE_INFINITY;if(c===this._negInfinity)return Number.NEGATIVE_INFINITY;
if(null!==d&&d[c])return d[c]}return c};a.prototype.createCopyId=function(){return"___Copy___:"+this._copyId++};a.prototype.forceAt=function(a,c,d){if(void 0!==a&&"object"===typeof a){var b=c.pop();if("string"===typeof b)return 0<c.length&&(a=c.reduce(function(a,b){return a&&void 0!==a[b]&&"object"===typeof a[b]?a[b]:a[b]={}},a)),a[b]=d}};a.prototype.forceAtPath=function(a,c,d){c=c.replace(this._replaceRegex,"").split(this._splitRegex);return this.forceAt(a,c,d)};a.prototype.getAt=function(a,c){return c.reduce(function(a,
b){return a&&void 0!==a[b]?a[b]:void 0},a)};a.prototype.getAtPath=function(a,c){c=c.replace(/\]$/,"").split(/[.[\]]+/);return this.getAt(a,c)};a.prototype.getPaths=function(a,c,d,e,f){var b=this;void 0===c&&(c=[]);void 0===d&&(d="");void 0===e&&(e=[]);void 0===f&&(f=!1);Array.isArray(c)||(c=[]);"string"!==typeof d&&(d="");Array.isArray(e)||(e=[]);"boolean"!==typeof f&&(f=!1);if(void 0===a||null===a||"object"!==typeof a||Array.isArray(a))return!0;if(f){var g=[];for(var k in a)g.push(k)}else g=Object.keys(a);
if(0===g.length)return!0;g.forEach(function(g){var h=0===d.length?g:d+"."+g;e.includes(g)?c.push(h):b.getPaths(a[g],c,h,e,f)&&c.push(h)});return!1};return a}();module$src$shared$util$CopyManager.default.CopyManagerInstance=new CopyManager$$module$src$shared$util$CopyManager;var module$src$shared$util$GlobalUtils={},TOTINYCOLOR$$module$src$shared$util$GlobalUtils=module$src$shared$util$toTinyColor.default,THREE$$module$src$shared$util$GlobalUtils=module$src$externals$three.default,ATOBTOA$$module$src$shared$util$GlobalUtils=module$src$shared$util$atobtoa.default,CopyManagerInstance$$module$src$shared$util$GlobalUtils=module$src$shared$util$CopyManager.default.CopyManagerInstance,GlobalUtils$$module$src$shared$util$GlobalUtils=function(){var a=this,b="undefined"!==typeof window&&
window.navigator&&-1<window.navigator.userAgent.indexOf("Trident"),c=b||"undefined"!==typeof document&&"function"===typeof document.getElementById&&window&&"function"===typeof window.Event,d=!1;var e=c?(d=parent!==window)?document.referrer:window.location.origin:"direct";this.runningInIE=function(){return b};this.runningInBrowser=function(){return c};this.runningInIframe=function(){return d};this.embeddingOrigin=function(){return e+""};this.getNodeAttribute=function(a,b,d){return c&&a&&!Array.isArray(a)&&
"function"===typeof a.hasAttribute&&a.hasAttribute(b)?a.getAttribute(b):d};this.getBooleanNodeAttribute=function(a,b,d){return c&&a&&!Array.isArray(a)&&"function"===typeof a.hasAttribute&&a.hasAttribute(b)?this.toBoolean(a.getAttribute(b),d):d};this.parseQueryString=function(a,b){b=void 0===b?!1:b;a=a.split("&");for(var c={},d=0;d<a.length;d++){var e=a[d].split("="),f=decodeURIComponent(e[0]);e=decodeURIComponent(e[1]);"undefined"===typeof c[f]?c[f]=e:b&&("string"===typeof c[f]?c[f]=[c[f],e]:c[f].push(e))}return c};
this.guessMimeTypeFromFilename=function(a){a=a.toLowerCase();var b="";a.endsWith(".dxf")?b="application/dxf":a.endsWith(".obj")?b="application/wavefront-obj":a.endsWith(".csv")&&(b="text/csv");return b};this.storageAvailable=function(a){try{var b=window[a];b.setItem("__storage_test__","__storage_test__");b.removeItem("__storage_test__");return!0}catch(g){return g instanceof DOMException&&(22===g.code||1014===g.code||"QuotaExceededError"===g.name||"NS_ERROR_DOM_QUOTA_REACHED"===g.name)&&0!==b.length}};
this.isArrayOfType=function(a,b){return Array.isArray(a)?-1===a.findIndex(function(a){return typeof a!==b}):!1};this.deepCopyReplacer=function(a,b){return module$src$shared$util$CopyManager.default.CopyManagerInstance.deepCopyReplacer(a,b)};this.deepCopyReviver=function(a,b){return module$src$shared$util$CopyManager.default.CopyManagerInstance.deepCopyReviver(a,b)};this.deepCopy=function(a,b){return module$src$shared$util$CopyManager.default.CopyManagerInstance.deepCopy(a,b)};this.setIfUndefined=
function(a,b){return"undefined"===typeof a?b:a};this.inject=function(a,b,c){void 0===c&&(c=!0);Object.keys(a).forEach(function(d){if(c||!b.hasOwnProperty(d))b[d]=a[d]});return b};this.defineHiddenProperty=function(a,b){Object.defineProperty(this,a,{enumerable:!1,configurable:!1,writable:!0,value:b})};this.defineConstantProperty=function(a,b){Object.defineProperty(this,a,{enumerable:!0,configurable:!1,writable:!1,value:b})};this.stringChecksum=function(a){var b=0,c=a.length,d;if(0===c)return b;for(d=
0;d<c;d++){var e=a.charCodeAt(d);b=(b<<5)-b+e;b&=b}return b};this.toNumber=function(a,b){a=Number(a);Number.isNaN(a)&&(a=b);return a};this.toBoolean=function(a,b){"boolean"!==typeof b&&(b=!1);return"boolean"===typeof a?a:"string"===typeof a?(a=a.toLowerCase(),b?"false"===a||"0"===a?!1:!0:"true"===a||"1"===a?!0:!1):!!a};this.createRandomId=function(){return Math.random().toString(36).substring(2,15)};this.getAt=function(a,b){return module$src$shared$util$CopyManager.default.CopyManagerInstance.getAt(a,
b)};this.getAtPath=function(a,b){return module$src$shared$util$CopyManager.default.CopyManagerInstance.getAtPath(a,b)};this.setAt=function(a,b,c,d){var e=b.pop();if("string"===typeof e&&(0<b.length&&(a=b.reduce(function(a,b){return a&&void 0!==a[b]?a[b]:void 0},a)),a&&(void 0!==a[e]||d)))return a[e]=c};this.setAtPath=function(b,c,d,e){c=c.replace(/\]$/,"").split(/[.[\]]+/);return a.setAt(b,c,d,e)};this.forceAt=function(a,b,c){return module$src$shared$util$CopyManager.default.CopyManagerInstance.forceAt(a,
b,c)};this.forceAtPath=function(a,b,c){return module$src$shared$util$CopyManager.default.CopyManagerInstance.forceAtPath(a,b,c)};this.deleteAt=function(a,b){var c=b.pop();if("string"===typeof c&&(0<b.length&&(a=b.reduce(function(a,b){return a&&void 0!==a[b]?a[b]:void 0},a)),a))return b=a[c],delete a[c],b};this.deleteAtPath=function(b,c){c=c.replace(/\]$/,"").split(/[.[\]]+/);return a.deleteAt(b,c)};this.getPaths=function(a,b,c,d,e){return module$src$shared$util$CopyManager.default.CopyManagerInstance.getPaths(a,
b,c,d,e)};this.defaults=function(b,c,d){if(Array.isArray(c))return c.reduce(function(b,c){return a.defaults(b,c,d)},b);for(var e in c)b.hasOwnProperty(e)?Array.isArray(b[e])||"object"!==typeof b[e]||"object"!==typeof c[e]?d&&(b[e]=a.deepCopy(c[e])):a.defaults(b[e],c[e],d):b[e]=a.deepCopy(c[e]);return b};this.cartesianToPolar=function(a,b,c){var d=Math.sqrt(Math.pow(a,2)+Math.pow(b,2)+Math.pow(c,2));return[d,Math.acos(c/d),Math.atan2(b,a)]};this.polarToCartesian=function(a,b,c){return[a*Math.sin(b)*
Math.cos(c),a*Math.sin(b)*Math.sin(c),a*Math.cos(b)]};this.check={string:function(a){return"string"===typeof a||a instanceof String},number:function(a){return("number"===typeof a||a instanceof Number)&&!isNaN(a)},float:function(a){return("number"===typeof a||a instanceof Number)&&!isNaN(a)},notnegative:function(a){return("number"===typeof a||a instanceof Number)&&0<=a},notpositive:function(a){return("number"===typeof a||a instanceof Number)&&0>=a},negative:function(a){return("number"===typeof a||
a instanceof Number)&&0>a},positive:function(a){return("number"===typeof a||a instanceof Number)&&0<a},factor:function(a){return("number"===typeof a||a instanceof Number)&&0<=a&&1>=a},color:function(a){return null!==(0,module$src$shared$util$toTinyColor.default)(a)},integer:function(a){return("number"===typeof a||a instanceof Number)&&!isNaN(a)&&a===parseInt(a,10)},boolean:function(a){return"boolean"===typeof a||a instanceof Boolean},object:function(a){return void 0!==a&&"object"===typeof a},function:function(a){return void 0!==
a&&"function"===typeof a},hexadecimal:function(b){if(a.typeCheck(b,"string")){b=b.replace("#","");var c=parseInt(b,16);return!(!b.endsWith(c.toString(16))||0>c||16777215<c)}return a.typeCheck(b,"number")?!(0>b||16777215<b):!1},vector2obj:function(b){return!b.x&&0!==b.x||!b.y&&0!==b.y?!1:a.typeCheck(b.x,"number")&&a.typeCheck(b.y,"number")?!0:!1},vector2arr:function(b){return Array.isArray(b)&&2<=b.length?a.typeCheck(b[0],"number")&&a.typeCheck(b[1],"number")?!0:!1:!1},vector2any:function(b){return a.typeCheck(b,
"vector2arr")||a.typeCheck(b,"vector2obj")?!0:!1},vector3obj:function(b){return!b.x&&0!==b.x||!b.y&&0!==b.y||!b.z&&0!==b.z?!1:a.typeCheck(b.x,"number")&&a.typeCheck(b.y,"number")&&a.typeCheck(b.z,"number")?!0:!1},vector3arr:function(b){return Array.isArray(b)&&3<=b.length?a.typeCheck(b[0],"number")&&a.typeCheck(b[1],"number")&&a.typeCheck(b[2],"number")?!0:!1:!1},vector3any:function(b){return a.typeCheck(b,"vector3arr")||a.typeCheck(b,"vector3obj")?!0:!1},matrix4x4obj:function(b){return!b.a&&0!==
b.a||!b.b&&0!==b.b||!b.c&&0!==b.c||!b.d&&0!==b.d||!b.e&&0!==b.e||!b.f&&0!==b.f||!b.g&&0!==b.g||!b.h&&0!==b.h||!b.i&&0!==b.i||!b.j&&0!==b.j||!b.k&&0!==b.k||!b.l&&0!==b.l||!b.m&&0!==b.m||!b.n&&0!==b.n||!b.o&&0!==b.o||!b.p&&0!==b.p?!1:a.typeCheck(b.a,"number")&&a.typeCheck(b.b,"number")&&a.typeCheck(b.c,"number")&&a.typeCheck(b.d,"number")&&a.typeCheck(b.e,"number")&&a.typeCheck(b.f,"number")&&a.typeCheck(b.g,"number")&&a.typeCheck(b.h,"number")&&a.typeCheck(b.i,"number")&&a.typeCheck(b.j,"number")&&
a.typeCheck(b.k,"number")&&a.typeCheck(b.l,"number")&&a.typeCheck(b.m,"number")&&a.typeCheck(b.n,"number")&&a.typeCheck(b.o,"number")&&a.typeCheck(b.p,"number")?!0:!1},matrix4x4arr:function(b){return Array.isArray(b)&&16<=b.length?a.typeCheck(b[0],"number")&&a.typeCheck(b[1],"number")&&a.typeCheck(b[2],"number")&&a.typeCheck(b[3],"number")&&a.typeCheck(b[4],"number")&&a.typeCheck(b[5],"number")&&a.typeCheck(b[6],"number")&&a.typeCheck(b[7],"number")&&a.typeCheck(b[8],"number")&&a.typeCheck(b[9],"number")&&
a.typeCheck(b[10],"number")&&a.typeCheck(b[11],"number")&&a.typeCheck(b[12],"number")&&a.typeCheck(b[13],"number")&&a.typeCheck(b[14],"number")&&a.typeCheck(b[15],"number")?!0:!1:!1},matrix4x4any:function(b){return a.typeCheck(b,"matrix4x4arr")||a.typeCheck(b,"matrix4x4obj")?!0:!1},box3any:function(b){return b.min&&b.max&&a.typeCheck(b.min,"vector3any")&&a.typeCheck(b.max,"vector3any")?!0:!1}};this.typeCheck=function(b,a,c,d,e){for(var f=[],g=4;g<arguments.length;++g)f[g-4]=arguments[g];if(void 0===
b){g="The given input is undefined.";var h=!1}else null===b?(g="The given input is null.",h=!1):(a=a.toLowerCase(),this.check[a]?g=(h=this.check[a](b))?"":"Value "+b+" is not a "+a:(g="No type check available for type "+a+". The possible types are ["+Object.getOwnPropertyNames(this.check).map(function(b){return" "+b})+" ]. Choose one of them.",h=!1));"function"===typeof c&&!1===h&&(d?c.apply(null,[d,g].concat($jscomp.arrayFromIterable(f))):c.apply(null,[g].concat($jscomp.arrayFromIterable(f))));return h};
this.waitForTimeout=function(b){return new Promise(function(a){setInterval(a,b)})};this.toVector3=function(b){if(b.isVector3)return b;if(Array.isArray(b)&&2<=b.length){var a=new module$src$externals$three.default.Vector3;a.fromArray(b);return a}return new module$src$externals$three.default.Vector3(b.x,b.y,b.z)};this.versionStringLowerThan=function(b,a){b=b.split(".");a=a.split(".");if(b.length>a.length)for(var c=a.length;c<b.length;c++)a.push("0");else if(b.length<a.length)for(c=b.length;c<a.length;c++)b.push("0");
b.reverse();a.reverse();var d=1;b.forEach(function(b){return d=b.length>d?b.length:d});a.forEach(function(b){return d=b.length>d?b.length:d});c=function(b,a,c){return b+Math.pow(10,c*d)*a};b=b.reduce(c,0);a=a.reduce(c,0);return b<a};this.ArrayToObject=function(b){if(!Array.isArray(b))return null;var a,c=b.length,d={};for(a=0;a<c;a++)d[""+a]=b[a];return d};this.ObjectToArray=function(b){if(null===b||"object"!==typeof b)return null;var a,c=[];for(a=0;;a++){var d=""+a;if(!b.hasOwnProperty(d))break;c.push(b[d])}return c};
this.toTinyColor=module$src$shared$util$toTinyColor.default;this.atobUTF8=module$src$shared$util$atobtoa.default.atobUTF8;this.btoaUTF8=module$src$shared$util$atobtoa.default.btoaUTF8;return this};module$src$shared$util$GlobalUtils.default=new GlobalUtils$$module$src$shared$util$GlobalUtils;var module$build$build_data={default:{}};module$build$build_data.default.build_version="2.17.0";module$build$build_data.default.build_date="2019-10-18T08:00:11.699Z";module$build$build_data.default.build_branch="2.17.0";module$build$build_data.default.build_commit="84c8930529b006314445d67424b7d17f6c9f833c";var module$src$api$v2$ApiReflectorV2_1={},GLOBAL_UTILS$$module$src$api$v2$ApiReflectorV2_1=module$src$shared$util$GlobalUtils.default,FUNCTION_PREFIX$$module$src$api$v2$ApiReflectorV2_1="___fn_",INCLUDE_PROTOTYPE$$module$src$api$v2$ApiReflectorV2_1=!1;
module$src$api$v2$ApiReflectorV2_1.default=function(a,b,c,d){if(b.startsWith("http://")){var e=b.substring(7);var f="http://"}else b.startsWith("https://")?(e=b.substring(8),f="https://"):e=null;e&&(b=e.indexOf("/"),0<=b&&(e=e.substring(0,b)),e=f+e);d=d||"sdv-iframe";var h={},g={};"boolean"!==typeof c&&(c=!1);var k=function(b){b.iframeId=d;c&&console.log("POSTING MSG",b);e&&a.postMessage(b,e)},l=function(b){c&&console.log("RECEIVING MSG",b);if(e){var a=b.origin;if(a!==e)c&&console.log("ORIGIN MISMATCH",
a,e);else{var f=b.data;if(f&&"object"===typeof f&&"string"===typeof f.id&&f.iframeId===d&&f.token)if(f.restore)r(f.restore,f.id)?k({id:f.id,token:f.token,result:!0}):k({id:f.id,token:f.token,error:"Restoring object failed"});else if(h.hasOwnProperty(f.id))if(a=h[f.id],f.command){b=module$src$shared$util$GlobalUtils.default.getAtPath(a,f.command);if("function"!==typeof b&&(f.command.endsWith("Async")&&(b=module$src$shared$util$GlobalUtils.default.getAtPath(a,f.command.slice(0,-5))),"function"!==typeof b)){c&&
console.log("Could not find function "+f.id);return}a=Array.isArray(f.arguments)?f.arguments:null;null===a&&"string"===typeof f.arguments_id&&h.hasOwnProperty(f.arguments_id)&&(a=module$src$shared$util$GlobalUtils.default.ObjectToArray(h[f.arguments_id]));c&&console.log("Calling function with arguments",b,a);b=b.apply(null,a);b instanceof Promise?b.then(function(b){b.err&&b.err instanceof Error?k({id:f.id,token:f.token,error:b.err.message}):k({id:f.id,token:f.token,result:b})},function(b){b instanceof
Error?k({id:f.id,token:f.token,error:b.message}):k({id:f.id,token:f.token,error:b})}):k({id:f.id,token:f.token,result:b})}else f.hasOwnProperty("result")?g.hasOwnProperty(f.token)&&(g[f.token].resolve(f.result),delete g[f.token]):f.error&&g.hasOwnProperty(f.token)&&(g[f.token].reject({err:Error(f.error)}),delete g[f.token]);else c&&console.log("Could not find object "+f.id)}}else c&&console.log("NO TARGET ORIGIN TO CHECK AGAINST")},m=function(b,a,c){var d=[],e={};module$src$shared$util$GlobalUtils.default.getPaths(b,
d,"",[],INCLUDE_PROTOTYPE$$module$src$api$v2$ApiReflectorV2_1);c="boolean"===typeof c?c:!1;d=d.filter(function(b){return b.endsWith("Async")?!0:!d.includes(b+"Async")});d.forEach(function(a){var d=module$src$shared$util$GlobalUtils.default.getAtPath(b,a);"function"===typeof d?a.endsWith("Async")||c?module$src$shared$util$GlobalUtils.default.forceAtPath(e,a,FUNCTION_PREFIX$$module$src$api$v2$ApiReflectorV2_1+a):a.endsWith("removeEventListener")||module$src$shared$util$GlobalUtils.default.forceAtPath(e,
a+"Async",FUNCTION_PREFIX$$module$src$api$v2$ApiReflectorV2_1+a+"Async"):module$src$shared$util$GlobalUtils.default.forceAtPath(e,a,d)});h[a]=b;return u({id:a,restore:e})},n=function(b){var a=[];module$src$shared$util$GlobalUtils.default.getPaths(b,a,"",[],INCLUDE_PROTOTYPE$$module$src$api$v2$ApiReflectorV2_1);return!a.every(function(a){return"function"===typeof module$src$shared$util$GlobalUtils.default.getAtPath(b,a)?!1:!0})},r=function(b,a){if(h.hasOwnProperty(a))return null;var c=[],d={};module$src$shared$util$GlobalUtils.default.getPaths(b,
c,"",[],INCLUDE_PROTOTYPE$$module$src$api$v2$ApiReflectorV2_1);c.forEach(function(c){var e=module$src$shared$util$GlobalUtils.default.getAtPath(b,c);"string"===typeof e?e.startsWith(FUNCTION_PREFIX$$module$src$api$v2$ApiReflectorV2_1)?module$src$shared$util$GlobalUtils.default.forceAtPath(d,c,p(a,c)):module$src$shared$util$GlobalUtils.default.forceAtPath(d,c,e):module$src$shared$util$GlobalUtils.default.forceAtPath(d,c,e)});return h[a]=d},u=function(b){var a=module$src$shared$util$GlobalUtils.default.createRandomId();
b.token=a;k(b);return new Promise(function(b,c){g[a]={resolve:b,reject:c}})},p=function(b,a){return function(){var c=Array.prototype.slice.call(arguments),d=module$src$shared$util$GlobalUtils.default.ArrayToObject(c);if(n(d)){console.log("argsobj needs reflection:",d);var e=module$src$shared$util$GlobalUtils.default.createRandomId();return m(d,e,!0).then(function(){return u({id:b,command:a,arguments_id:e})})}return u({id:b,command:a,arguments:c})}};window.addEventListener("message",l,!1);f=function(){};
f.prototype.reflect=function(b,a){return m(b,a)};f.prototype.get=function(b){return h.hasOwnProperty(b)?h[b]:null};f.prototype.destroy=function(){window.removeEventListener("message",l,!1)};f.prototype.receiveMessage=function(b){l(b)};return new f};var module$src$shared$constants$LoggingConstants={},loggingLevels$$module$src$shared$constants$LoggingConstants={NONE:-1,ERROR:0,WARN:1,INFO:2,DEBUG:3,LVLBITS:3,LOG_TO_SERVER:8,ERROR_S:8,WARN_S:9,INFO_S:10,DEBUG_S:11},defaultSettings$$module$src$shared$constants$LoggingConstants={loggingLevel:loggingLevels$$module$src$shared$constants$LoggingConstants.NONE},loggingConstants$$module$src$shared$constants$LoggingConstants={loggingLevels:loggingLevels$$module$src$shared$constants$LoggingConstants,defaultSettings:defaultSettings$$module$src$shared$constants$LoggingConstants},
GlobalUtils$$module$src$shared$constants$LoggingConstants=module$src$shared$util$GlobalUtils.default;module$src$shared$constants$LoggingConstants.default=module$src$shared$util$GlobalUtils.default.deepCopy(loggingConstants$$module$src$shared$constants$LoggingConstants);var module$src$shared$constants$MessagingConstants={},GlobalUtils$$module$src$shared$constants$MessagingConstants=module$src$shared$util$GlobalUtils.default,messageTopics$$module$src$shared$constants$MessagingConstants={AR:"ar",DATA:"data",EXPORT:"export",EXPORT_AVAILABLE:"export.available",EXPORT_REGISTER:"export.register",EXPORT_REGISTERED:"export.registered",EXPORT_UPDATE:"export.update",EXPORT_STATUS:"export.status",PARAMETER:"parameter",PARAMETER_REGISTER:"parameter.register",PARAMETER_REGISTERED:"parameter.registered",
PARAMETER_UPDATE:"parameter.update",PARAMETER_VALUE_UPDATE:"parameter.value.update",PLUGIN:"plugin",PLUGIN_ACTIVE:"plugin.active",PLUGIN_FAILED:"plugin.failed",PLUGIN_LOADED:"plugin.loaded",PLUGIN_REGISTERED:"plugin.registered",PLUGIN_UNLOADED:"plugin.unloaded",PROCESS:"process",SETTINGS:"settings",SETTINGS_REGISTER:"settings.register",SETTINGS_UPDATE:"settings.update",SETTINGS_REGISTERED:"settings.registered",SCENE:"scene",SCENE_ANCHOR:"scene.anchor",SCENE_ANCHOR_ADD:"scene.anchor.add",SCENE_ANCHOR_REMOVE:"scene.anchor.remove",
SCENE_CAMERA:"scene.camera",SCENE_CAMERA_START:"scene.camera.start",SCENE_CAMERA_MOVE:"scene.camera.move",SCENE_CAMERA_END:"scene.camera.end",SCENE_DRAG:"scene.drag",SCENE_DRAG_START:"scene.drag.start",SCENE_DRAG_MOVE:"scene.drag.move",SCENE_DRAG_END:"scene.drag.end",SCENE_FRAMERATE:"scene.framerate",SCENE_HOVER:"scene.hover",SCENE_HOVER_ON:"scene.hover.on",SCENE_HOVER_OVER:"scene.hover.over",SCENE_HOVER_OFF:"scene.hover.off",SCENE_RENDER:"scene.render",SCENE_RENDER_BEAUTY:"scene.render.beauty",SCENE_RENDER_BEAUTY_START:"scene.render.beauty.start",
SCENE_RENDER_BEAUTY_CANCEL:"scene.render.beauty.cancel",SCENE_RENDER_BEAUTY_END:"scene.render.beauty.end",SCENE_SELECT:"scene.select",SCENE_SELECT_ON:"scene.select.on",SCENE_SELECT_OFF:"scene.select.off",SCENE_SUBSCENE:"scene.subscene",SCENE_SUBSCENE_INIT:"scene.subscene.init",SCENE_SUBSCENE_OUTPUTVERSION:"scene.subscene.outputversion",SCENE_SUBSCENE_READY:"scene.subscene.ready",SCENE_SUBSCENE_PUBLISHED:"scene.subscene.published",SCENE_VISIBILITY:"scene.visibility",SCENE_VISIBILITY_ON:"scene.visibility.on",
SCENE_VISIBILITY_OFF:"scene.visibility.off",STATUS:"status",STATUS_BUSY:"status.busy",STATUS_IDLE:"status.idle",STATUS_MESSAGE:"status.message",STATUS_FAILED:"status.failed",VIEWPORTS:"viewports",VIEWPORTS_CREATED:"viewports.created",VIEWPORTS_DESTROYED:"viewports.destroyed"},messageDataTypes$$module$src$shared$constants$MessagingConstants={GENERIC:"generic",ANCHOR_CREATE_IMAGE:"anchor.create.image",ANCHOR_UPDATE:"anchor.update",APP_SETTINGS:"app.settings",APP_STATUS:"app.status",DATA:"data",EXPORT_DEFINITION:"export.definition",
EXPORT_RESULT:"export.result",EXPORT_STATUS:"export.status",OBJECT_PLACEMENT:"object.placement",PARAMETER_DEFINITION:"parameter.definition",PARAMETER_UPDATE:"parameter.update",PLUGIN_RUNTIME_ID:"plugin.runtimeId",PROCESS_ERROR:"process.error",PROCESS_ABORT:"process.abort",PROCESS_FORK:"process.fork",PROCESS_STATUS:"process.status",PROCESS_SUCCESS:"process.success",STATUS_TRACKING:"status.tracking",STATUS_MAPPING:"status.mapping",SCENE_CAMERA:"scene.camera",SCENE_INTERACTION:"scene.interaction",SCENE_ANCHORDATA:"scene.anchordata",
SETTINGS_UPDATE:"settings.update",SUBSCENE_UPDATE:"subscene.update",SUBSCENE_OUTPUTVERSION_JSON:"subscene.outputversion.json",SUBSCENE_OUTPUTVERSION_OBJ:"subscene.outputversion.obj",SUBSCENE_INIT:"subscene.init",STATUS_MESSAGE:"status.message"},makeMessageToken$$module$src$shared$constants$MessagingConstants=function(a,b){var c={};"string"===typeof a?c.id=a+"":null!==a&&"object"===typeof a&&("string"===typeof a.id&&(c.id=a.id+""),"string"===typeof a.creator&&(c.creator=a.creator+""),"number"===typeof a.serial&&
(c.serial=a.serial+""),c.payload=a.payload,c.attributes=a.attributes);if("string"!==typeof c.id||0===c.id.length)c.id=module$src$shared$util$GlobalUtils.default.createRandomId();"string"!==typeof c.creator&&"string"===typeof b&&(c.creator=b+"");"number"!==typeof c.serial&&(c.serial=Date.now());return c},loggingConstants$$module$src$shared$constants$MessagingConstants=module$src$shared$constants$LoggingConstants.default,loggingLevels$$module$src$shared$constants$MessagingConstants=module$src$shared$constants$LoggingConstants.default.loggingLevels,
defaultSettings$$module$src$shared$constants$MessagingConstants={messageLoggingLevel:loggingLevels$$module$src$shared$constants$MessagingConstants.NONE},messagingConstants$$module$src$shared$constants$MessagingConstants={messageTopics:messageTopics$$module$src$shared$constants$MessagingConstants,messageDataTypes:messageDataTypes$$module$src$shared$constants$MessagingConstants,defaultSettings:defaultSettings$$module$src$shared$constants$MessagingConstants};
module$src$shared$constants$MessagingConstants.default=module$src$shared$util$GlobalUtils.default.deepCopy(messagingConstants$$module$src$shared$constants$MessagingConstants);module$src$shared$constants$MessagingConstants.default.makeMessageToken=makeMessageToken$$module$src$shared$constants$MessagingConstants;var module$src$app$ViewerAppConstants={},loggingConstants$$module$src$app$ViewerAppConstants=module$src$shared$constants$LoggingConstants.default,loggingLevels$$module$src$app$ViewerAppConstants=module$src$shared$constants$LoggingConstants.default.loggingLevels,messagingConstants$$module$src$app$ViewerAppConstants=module$src$shared$constants$MessagingConstants.default,messageTopics$$module$src$app$ViewerAppConstants=module$src$shared$constants$MessagingConstants.default.messageTopics,messageDataTypes$$module$src$app$ViewerAppConstants=
module$src$shared$constants$MessagingConstants.default.messageDataTypes,DEFAULT_MATERIAL$$module$src$app$ViewerAppConstants={name:"Default material",version:"2.0",bumpAmplitude:1,color:[211,211,211,255],metalness:0,roughness:1},showSceneModes$$module$src$app$ViewerAppConstants={INSTANT:0,ON_SHOW:1,ON_FIRST_PLUGIN:2,ON_ALL_PLUGINS:3},defaultSettings$$module$src$app$ViewerAppConstants={blurSceneWhenBusy:!0,defaultMaterial:DEFAULT_MATERIAL$$module$src$app$ViewerAppConstants,ignoreSuperseded:!0,hasRestoredSettings:!1,
loggingLevel:loggingLevels$$module$src$app$ViewerAppConstants.NONE,messageLoggingLevel:loggingLevels$$module$src$app$ViewerAppConstants.NONE,showMessages:!0,commitParameters:!1,commitSettings:!1,showScene:!1,showSceneMode:showSceneModes$$module$src$app$ViewerAppConstants.ON_FIRST_PLUGIN,showSceneTransition:"1s",strictMode:!1,ar:{enableCameraSync:!1,enableLightingEstimation:!0,enableTouchControls:!0,enableTouchControlRotation:!0,enableAutomaticPlacement:!0,defaultHitTestType:"existingPlaneUsingGeometry"}},
viewerAppConstants$$module$src$app$ViewerAppConstants={loggingLevels:loggingLevels$$module$src$app$ViewerAppConstants,messageTopics:messageTopics$$module$src$app$ViewerAppConstants,messageDataTypes:messageDataTypes$$module$src$app$ViewerAppConstants,showSceneModes:showSceneModes$$module$src$app$ViewerAppConstants,defaultSettings:defaultSettings$$module$src$app$ViewerAppConstants},GlobalUtils$$module$src$app$ViewerAppConstants=module$src$shared$util$GlobalUtils.default;
module$src$app$ViewerAppConstants.default=module$src$shared$util$GlobalUtils.default.deepCopy(viewerAppConstants$$module$src$app$ViewerAppConstants);var module$src$externals$axios={};try{module$src$externals$axios.default=eval("axios")}catch(a){"function"===typeof require&&(module$src$externals$axios.default=eval("require('axios')"))};var module$src$plugins$comm$CommPluginConstants={},baseUrl$$module$src$plugins$comm$CommPluginConstants="https://model-view.shapediver.com:443",defaultSettings$$module$src$plugins$comm$CommPluginConstants={modelViewUrl:baseUrl$$module$src$plugins$comm$CommPluginConstants,ajaxTimeout:3E4,ignoreSuperseded:!0},commPluginConstants$$module$src$plugins$comm$CommPluginConstants={defaultSettings:defaultSettings$$module$src$plugins$comm$CommPluginConstants},GlobalUtils$$module$src$plugins$comm$CommPluginConstants=
module$src$shared$util$GlobalUtils.default;module$src$plugins$comm$CommPluginConstants.default=module$src$shared$util$GlobalUtils.default.deepCopy(commPluginConstants$$module$src$plugins$comm$CommPluginConstants);var module$src$shared$constants$PluginConstantsGlobal={},pluginCapabilities$$module$src$shared$constants$PluginConstantsGlobal={NONE:0,SHAPEDIVER_MODEL_VIEW:1,INTERACTIVE:2,DRAGANDDROP:3,MESSAGECALLBACKS:4,LOGGING:5,SETTINGS:6,DEFAULTPARAM:7},pluginStatuses$$module$src$shared$constants$PluginConstantsGlobal={NONE:"none",READY:"ready",FAILED:"failed",LOADED:"loaded",ACTIVE:"active",UNLOADED:"unloaded"},setParameterResults$$module$src$shared$constants$PluginConstantsGlobal={PARAM_NOT_FOUND:"param_not_found",
NO_VALUE:"no_value",VALUE_REJECT:"value_reject",VALUE_EXISTS:"value_exists",VALUE_OK:"value_ok",PLUGIN_NOT_FOUND:"plugin_not_found",UPLOAD_FAILED:"upload_failed",ERROR:"error",LIVE:"live",CACHE:"cache",LOAD:"load",ABORT:"abort"},requestExportResults$$module$src$shared$constants$PluginConstantsGlobal={EXPORT_NOT_FOUND:"export_not_found",PLUGIN_NOT_FOUND:"plugin_not_found",ERROR:"error",CACHE:"cache",LOAD:"load",ABORT:"abort"},pluginConstants$$module$src$shared$constants$PluginConstantsGlobal={pluginCapabilities:pluginCapabilities$$module$src$shared$constants$PluginConstantsGlobal,
pluginStatuses:pluginStatuses$$module$src$shared$constants$PluginConstantsGlobal,setParameterResults:setParameterResults$$module$src$shared$constants$PluginConstantsGlobal,requestExportResults:requestExportResults$$module$src$shared$constants$PluginConstantsGlobal},GlobalUtils$$module$src$shared$constants$PluginConstantsGlobal=module$src$shared$util$GlobalUtils.default;module$src$shared$constants$PluginConstantsGlobal.default=module$src$shared$util$GlobalUtils.default.deepCopy(pluginConstants$$module$src$shared$constants$PluginConstantsGlobal);var module$src$plugins$PluginConstants={},loggingConstants$$module$src$plugins$PluginConstants=module$src$shared$constants$LoggingConstants.default,loggingLevels$$module$src$plugins$PluginConstants=module$src$shared$constants$LoggingConstants.default.loggingLevels,messagingConstants$$module$src$plugins$PluginConstants=module$src$shared$constants$MessagingConstants.default,messageTopics$$module$src$plugins$PluginConstants=module$src$shared$constants$MessagingConstants.default.messageTopics,messageDataTypes$$module$src$plugins$PluginConstants=
module$src$shared$constants$MessagingConstants.default.messageDataTypes,pluginConstantsGlobal$$module$src$plugins$PluginConstants=module$src$shared$constants$PluginConstantsGlobal.default,defaultSettings$$module$src$plugins$PluginConstants={loggingLevel:loggingLevels$$module$src$plugins$PluginConstants.NONE},pluginConstants$$module$src$plugins$PluginConstants={loggingLevels:loggingLevels$$module$src$plugins$PluginConstants,messageTopics:messageTopics$$module$src$plugins$PluginConstants,messageDataTypes:messageDataTypes$$module$src$plugins$PluginConstants,
pluginCapabilities:module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities,pluginStatuses:module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses,setParameterResults:module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults,requestExportResults:module$src$shared$constants$PluginConstantsGlobal.default.requestExportResults,defaultSettings:defaultSettings$$module$src$plugins$PluginConstants},GlobalUtils$$module$src$plugins$PluginConstants=module$src$shared$util$GlobalUtils.default;
module$src$plugins$PluginConstants.default=module$src$shared$util$GlobalUtils.default.deepCopy(pluginConstants$$module$src$plugins$PluginConstants);var module$src$shared$mixins$GlobalMixin={default:function(){this.jsify=function(a){return JSON.stringify(a,null,0)};return this}};var module$src$shared$messages$MessagePrototype={},GlobalUtils$$module$src$shared$messages$MessagePrototype=module$src$shared$util$GlobalUtils.default;
module$src$shared$messages$MessagePrototype.default=function(a,b,c){var d=this;this.origin={};this.parts=[];this.addPart=function(b,a){void 0!==b&&d.parts.push({type:b,data:a})};this.addPart(a,b);this.getPartsByType=function(b){return d.parts.filter(function(a){return a.type===b})};this.getUniquePartByType=function(b){b=d.getPartsByType(b);if(1===b.length)return b[0]};this.token={};"string"===typeof c&&0<c.length?this.token={id:c}:null!==c&&"object"===typeof c&&"string"===typeof c.id&&0<c.id.length?
this.token=c:this.token.id=module$src$shared$util$GlobalUtils.default.createRandomId();if(void 0===this.token.serial||"number"!==typeof this.token.serial)this.token.serial=Date.now();this.date=Date.now();return this};var module$src$shared$mixins$SettingsMixin={},GlobalUtils$$module$src$shared$mixins$SettingsMixin=module$src$shared$util$GlobalUtils.default,MessagePrototype$$module$src$shared$mixins$SettingsMixin=module$src$shared$messages$MessagePrototype.default,messagingConstants$$module$src$shared$mixins$SettingsMixin=module$src$shared$constants$MessagingConstants.default;
module$src$shared$mixins$SettingsMixin.default=function(a,b,c,d){var e=this,f="function"===typeof e.warn?e.warn:function(){};if(void 0===a||"object"!==typeof a)a={};if(void 0===b||"object"!==typeof b)b={};var h=module$src$shared$util$GlobalUtils.default.deepCopy(a,d);module$src$shared$util$GlobalUtils.default.defaults(h,b);this.getSettings=function(b){if(void 0===b||!Array.isArray(b))return module$src$shared$util$GlobalUtils.default.deepCopy(h);var a={};b.forEach(function(b){e.hasSetting(b)&&module$src$shared$util$GlobalUtils.default.forceAtPath(a,
b,e.getSetting(b))});return a};this.getSetting=function(b){return module$src$shared$util$GlobalUtils.default.deepCopy(module$src$shared$util$GlobalUtils.default.getAtPath(h,b))};this.getSettingShallow=function(b){return module$src$shared$util$GlobalUtils.default.getAtPath(h,b)};this.hasSetting=function(b){return void 0!==module$src$shared$util$GlobalUtils.default.getAtPath(h,b)};var g={},k=0;this.registerHook=function(b,a){b||(b=".*");if("string"===typeof b)b.startsWith("^")||(b="^"+b),b.endsWith("$")||
(b+="$"),b=RegExp(b);else if(!(b instanceof RegExp))return;if("function"===typeof a){var c=k;g[k++]={r:b,cb:a};return c}};this.deregisterHook=function(b){if(!g.hasOwnProperty(b))return!1;delete g[b];return!0};this.deregisterAllHooks=function(){for(var b in g)delete g[b];return!0};var l={},m=0;this.registerNotifier=function(b,a){b||(b=".*");if("string"===typeof b)b.startsWith("^")||(b="^"+b),b.endsWith("$")||(b+="$"),b=RegExp(b);else if(!(b instanceof RegExp))return;if("function"===typeof a){var c=
m;l[m++]={r:b,cb:a};return c}};this.deregisterNotifier=function(b){if(!l.hasOwnProperty(b))return!1;delete l[b];return!0};this.deregisterAllNotifiers=function(){for(var b in l)delete l[b];return!0};this.forceSetting=function(b,a){module$src$shared$util$GlobalUtils.default.forceAtPath(h,b,module$src$shared$util$GlobalUtils.default.deepCopy(a));return!0};this.updateSetting=function(b,a){if(!Object.keys(g).every(function(c){c=g[c];if(!c.r.test(b))return!0;c=c.cb(a,b);c instanceof Promise&&f("SettingsMixin.updateSetting",
"A hook for "+b+" returned a Promise, which is always a truthy value, use SettingsMixin.updateSettingAsync instead for updates to this key");return c}))return!1;var c=e.getSetting(b);module$src$shared$util$GlobalUtils.default.forceAtPath(h,b,module$src$shared$util$GlobalUtils.default.deepCopy(a));Object.keys(l).forEach(function(d){d=l[d];if(d.r.test(b))try{d.cb(b,c,a)}catch(q){f("SettingsMixin.updateSetting","A notifier for setting "+d.r.toString()+" threw an exception",q)}});return!0};this.updateSettingAsync=
function(b,a){var c=[];return Object.keys(g).every(function(d){d=g[d];if(!d.r.test(b))return!0;d=d.cb(a,b);return d instanceof Promise?(c.push(d),!0):d})?Promise.all(c).then(function(c){if(c.every(function(b){return b})){var d=e.getSetting(b);module$src$shared$util$GlobalUtils.default.forceAtPath(h,b,module$src$shared$util$GlobalUtils.default.deepCopy(a));Object.keys(l).forEach(function(c){c=l[c];if(c.r.test(b))try{c.cb(b,d,a)}catch(v){f("SettingsMixin.updateSettingAsync","A notifier for setting "+
c.r.toString()+" threw an exception",v)}});return!0}return!1},function(){return!1}):Promise.resolve(!1)};this.updateSettings=function(b,a){"boolean"!==typeof a&&(a=!1);var c=!0;if(void 0===b||"object"!==typeof b)return c;var d=[];module$src$shared$util$GlobalUtils.default.getPaths(b,d);d.forEach(function(d){a&&e.hasSetting(d)||e.updateSetting(d,module$src$shared$util$GlobalUtils.default.getAtPath(b,d))||(c=!1)});return c};this.updateSettingsAsync=function(){f("SettingsMixin.updateSettingsAsync","to be implemented");
return Promise.reject(Error("SettingsMixin.updateSettingsAsyncto be implemented"))};this.isSettingPersistent=function(){return!1};this.getSection=function(b){var a=e.getSettingShallow(b);return void 0===a||"object"!==typeof a?!1:{getSettings:function(a){if(void 0===a||!Array.isArray(a))return a=e.getSettings([b]),module$src$shared$util$GlobalUtils.default.getAtPath(a,b);a=module$src$shared$util$GlobalUtils.default.deepCopy(a);for(var c=0;c<a.length;c++)a[c]=b+"."+a[c];return e.getSettings(a)},getSetting:function(a){return e.getSetting(b+
"."+a)},getSettingShallow:function(a){return e.getSettingShallow(b+"."+a)},forceSetting:function(a,c){return e.forceSetting(b+"."+a,c)},hasSetting:function(a){return e.hasSetting(b+"."+a)},registerHook:function(a,c){if("string"!==typeof a)return!1;a.startsWith("^")&&(a=a.substring(1));var d=b.length+1;return e.registerHook(b+"."+a,function(b,a){return c(b,a.substring(d))})},deregisterHook:function(b){return e.deregisterHook(b)},registerNotifier:function(a,c){if("string"!==typeof a)return!1;a.startsWith("^")&&
(a=a.substring(1));var d=b.length+1;return e.registerNotifier(b+"."+a,function(b,a,e){return c(b.substring(d),a,e)})},deregisterNotifier:function(b){return e.deregisterNotifier(b)},updateSetting:function(a,c){return e.updateSetting(b+"."+a,c)},updateSettingAsync:function(a,c){return e.updateSettingAsync(b+"."+a,c)},updateSettings:function(a,c){"boolean"!==typeof c&&(c=!1);var d=!0;if(void 0===a||"object"!==typeof a)return d;var f=[];module$src$shared$util$GlobalUtils.default.getPaths(a,f);f.forEach(function(f){var g=
b+"."+f;c&&e.hasSetting(g)||e.updateSetting(g,module$src$shared$util$GlobalUtils.default.getAtPath(a,f))||(d=!1)});return d},updateSettingsAsync:function(){f("SettingsMixin.updateSettingsAsync","to be implemented");return Promise.reject(Error("SettingsMixin.updateSettingsAsyncto be implemented"))},isSettingPersistent:function(a){return e.isSettingPersistent(b+"."+a)},getSection:function(a){return e.getSection(b+"."+a)}}};module$src$shared$util$GlobalUtils.default.typeCheck(c,"string")&&e.registerNotifier("",
function(b,a,d){b=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SETTINGS_UPDATE,{key:b,valueNew:d,valueOld:a,namespace:c});e.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SETTINGS_UPDATE,b)});return this};var module$src$shared$mixins$LoggingMixin={},loggingConstants$$module$src$shared$mixins$LoggingMixin=module$src$shared$constants$LoggingConstants.default;
module$src$shared$mixins$LoggingMixin.default=function(){var a=this;this.getLoggingLevelName=function(b){var a=b.toString();Object.keys(module$src$shared$constants$LoggingConstants.default.loggingLevels).every(function(c){return module$src$shared$constants$LoggingConstants.default.loggingLevels[c]===b?(a=c,!1):!0});return a};this.logToConsole=function(){var b=1===arguments.length?[arguments[0]]:Array.apply(null,arguments),a=b[0]&module$src$shared$constants$LoggingConstants.default.loggingLevels.LVLBITS,
d=b[1];b=b.slice(2);a===module$src$shared$constants$LoggingConstants.default.loggingLevels.ERROR?console.error.apply(console,["ERROR."+d,":"].concat($jscomp.arrayFromIterable(b))):a===module$src$shared$constants$LoggingConstants.default.loggingLevels.WARN?console.warn.apply(console,["WARN."+d,":"].concat($jscomp.arrayFromIterable(b))):a===module$src$shared$constants$LoggingConstants.default.loggingLevels.INFO?console.log.apply(console,["INFO."+d,":"].concat($jscomp.arrayFromIterable(b))):a===module$src$shared$constants$LoggingConstants.default.loggingLevels.DEBUG?
console.log.apply(console,["DEBUG."+d,":"].concat($jscomp.arrayFromIterable(b))):console.log.apply(console,["UNKNOWN."+d,":"].concat($jscomp.arrayFromIterable(b)))};this.log=function(){(arguments[0]&module$src$shared$constants$LoggingConstants.default.loggingLevels.LVLBITS)<=a.getLoggingLevel()&&a.logToConsole.apply(a,arguments)};this.error=function(){a.log.apply(a,[module$src$shared$constants$LoggingConstants.default.loggingLevels.ERROR].concat($jscomp.arrayFromIterable(arguments)))};this.warn=function(){a.log.apply(a,
[module$src$shared$constants$LoggingConstants.default.loggingLevels.WARN].concat($jscomp.arrayFromIterable(arguments)))};this.info=function(){a.log.apply(a,[module$src$shared$constants$LoggingConstants.default.loggingLevels.INFO].concat($jscomp.arrayFromIterable(arguments)))};this.debug=function(){a.log.apply(a,[module$src$shared$constants$LoggingConstants.default.loggingLevels.DEBUG].concat($jscomp.arrayFromIterable(arguments)))};this.setLoggingLevel=function(b){return a.updateSetting("loggingLevel",
b)};this.getLoggingLevel=function(){return a.getSetting("loggingLevel")};return this};var module$src$shared$mixins$MessagingMixin={},messagingConstants$$module$src$shared$mixins$MessagingMixin=module$src$shared$constants$MessagingConstants.default,loggingConstants$$module$src$shared$mixins$MessagingMixin=module$src$shared$constants$LoggingConstants.default;
module$src$shared$mixins$MessagingMixin.default=function(){var a=this;this.messageToLog=function(b,c){var d=a.getSetting("messageLoggingLevel");d!==module$src$shared$constants$LoggingConstants.default.loggingLevels.NONE&&a.log(d,b,c)};this.messageToPubSub=function(b,a,d,e){e&&"string"===typeof e.prefix&&(b=e.prefix.concat(".",b));e&&"string"===typeof e.postfix&&(b=b.concat(".",e.postfix));d.publish(b,a)};this.message=function(b,c){a.messageToLog(b,c)};this.hasSetting("messageLoggingLevel")||a.updateSetting("messageLoggingLevel",
module$src$shared$constants$MessagingConstants.default.defaultSettings.messageLoggingLevel);return this};var module$src$externals$expo_three={default:null};var module$src$externals$expo_asset_utils={default:null};var module$src$shared$util$stringChecksum={default:function(a){var b=0,c=a.length,d;if(0===c)return b;for(d=0;d<c;d++){var e=a.charCodeAt(d);b=(b<<5)-b+e;b&=b}return b}};var module$src$shared$util$getImageBase64={},AXIOS$$module$src$shared$util$getImageBase64=module$src$externals$axios.default,_converterEngine$$module$src$shared$util$getImageBase64=function(a){a=new Uint8Array(a);for(var b=a.length,c=[];b--;)c[b]=String.fromCharCode(a[b]);return window.btoa(c.join(""))};
module$src$shared$util$getImageBase64.default=function(a){return(0,module$src$externals$axios.default)({method:"GET",url:a,responseType:"arraybuffer"}).then(function(b){var a=_converterEngine$$module$src$shared$util$getImageBase64(b.data);return Promise.resolve({data:a,contentType:b.headers["content-type"]})})};var module$src$shared$singletons$TextureLoader={},AXIOS$$module$src$shared$singletons$TextureLoader=module$src$externals$axios.default,THREE$$module$src$shared$singletons$TextureLoader=module$src$externals$three.default,EXPOTHREE$$module$src$shared$singletons$TextureLoader=module$src$externals$expo_three.default,EXPOASSETUTILS$$module$src$shared$singletons$TextureLoader=module$src$externals$expo_asset_utils.default,ATOBTOA$$module$src$shared$singletons$TextureLoader=module$src$shared$util$atobtoa.default,
textureCache$$module$src$shared$singletons$TextureLoader={},TextureLoader$$module$src$shared$singletons$TextureLoader=function(){this.loadTexture=function(b,c,d){return window&&window.navigator&&-1!==window.navigator.userAgent.indexOf("Safari")&&-1===window.navigator.userAgent.indexOf("Chrome")?a(b,c,d).then(function(){return a(b,c,d)}):a(b,c,d)};var a=function(b,a,d){a=a||{};d=d||{};var c=function(b){b.wrapS=module$src$externals$three.default.RepeatWrapping;b.wrapT=module$src$externals$three.default.RepeatWrapping;
var c=a.offset||[0,0];b.offset=new module$src$externals$three.default.Vector2(c[0],c[1]);c=a.repeat||[1,1];b.repeat=new module$src$externals$three.default.Vector2(c[0],c[1]);b.rotation=a.rotation||0;c=a.center||[0,0];b.center=new module$src$externals$three.default.Vector2(c[0],c[1]);b.uvTransform=new module$src$externals$three.default.Matrix3;b.uvTransform.identity().translate(-b.center.x,-b.center.y).rotate(b.rotation).scale(b.repeat.x,b.repeat.y).translate(b.center.x,b.center.y).translate(b.offset.x,
b.offset.y);b.needsUpdate=!0;return b};if("object"===typeof b&&null!==b&&1===b.nodeType&&"string"===typeof b.nodeName&&"CANVAS"===b.nodeName.toUpperCase()){var f=new module$src$externals$three.default.CanvasTexture(b);"function"!==typeof b._addTexture&&function(){var a=[];b._addTexture=function(b){return a.push(b)};Object.defineProperty(b,"needsUpdate",{set:function(b){return b&&a.forEach(function(b){return b.needsUpdate=!0})}})}();b._addTexture(f);return Promise.resolve(c(f))}if("string"!==typeof b)return Promise.reject(Error("Input is not a string"));
var h="_"+(0,module$src$shared$util$stringChecksum.default)(b);if(textureCache$$module$src$shared$singletons$TextureLoader.hasOwnProperty(h))return textureCache$$module$src$shared$singletons$TextureLoader[h].then(function(b){var a=b.clone();module$src$externals$expo_three.default&&module$src$externals$expo_asset_utils.default&&b.isDataTexture&&!a.isDataTexture&&(a.isDataTexture=!0);return c(a)});var g=null,k=null,l=null,m=null;textureCache$$module$src$shared$singletons$TextureLoader[h]=Promise.resolve().then(function(){if("data:"==
b.substring(0,5))return m=!0,g=b.substring(b.indexOf(":")+1,b.indexOf(";")),l=-1!==b.indexOf("base64"),k=b.substring(b.indexOf(",")+1),Promise.resolve();m=!1;var a={method:"GET",url:b,headers:{}};d.authorization&&(a.headers.Authorization=d.authorization);return(0,module$src$externals$axios.default)(a).then(function(b){g=b.headers["content-type"];-1<g.indexOf(";")&&(g=g.substr(0,g.indexOf(";")));k=b.data;l=!1;return Promise.resolve()},function(b){b.scope="TextureLoader._loadTexture";b.msg=b.response?
"Loading texture failed with HTTP status code "+b.response.status:b.request?"Loading texture failed, no response from the server":"Loading texture failed, unknown error";return Promise.reject(b)})}).then(function(){var a,c;if(["image/jpeg","image/png","image/gif","image/bmp"].includes(g))return new Promise(function(a,c){if(module$src$externals$expo_three.default&&module$src$externals$expo_asset_utils.default){var d=g.split("/")[1].replace("e","");module$src$externals$expo_asset_utils.default.resolveAsync(b,
{fileName:"H"+h.toString()+"."+d}).then(function(b){module$src$externals$expo_three.default.loadTextureAsync({asset:b}).then(function(b){b.minFilter=module$src$externals$three.default.LinearFilter;a(b)},function(b){b.scope="TextureLoader._loadTexture";b.msg="EXPOTHREE.loadAsync failed";c(b)})},function(b){b.scope="TextureLoader._loadTexture";b.msg="EXPOASSETUTILS.resolveAsync failed";c(b)})}else(new module$src$externals$three.default.TextureLoader).load(b,function(b){a(b)},function(){},function(b){b.scope=
"TextureLoader._loadTexture";b.msg="Texture file loading failed";c(b)})});if("image/svg+xml"===g){if(window&&window.navigator&&window.navigator.userAgent&&0<window.navigator.userAgent.indexOf("Trident/")){var d=Error("SVG textures not supported by Internet Explorer 11. Skipping the texture.");d.scope="TextureLoader._loadTexture";return Promise.reject(d)}var e=null;m?l?e=module$src$shared$util$atobtoa.default.atobUTF8(k):(e=k,e=(" "+e).slice(1)):e=k;d=document.createElement("DIV");d.id="svgc";d.innerHTML=
e;var f=d.getElementsByTagName("svg"),t=[],v=[];for(d=0;d<f.length;++d){for(a=0;2>a;++a){var w=f[d].getElementsByTagName(["image","img"][a]);for(c=0;c<w.length;++c)"data:"!=w[c].href.baseVal.substring(0,5)&&t.push(w[c].href.baseVal)}c=f[d].getElementsByTagName("style");for(a=0;a<c.length;++a){w=/@import\x20url\(\s*(.*?)\s*\);/g;for(var x=void 0;null!==(x=w.exec(c[a].innerHTML));)v.push(x[1]);v=v.filter(function(b,a,c){return c.indexOf(b)===a})}}f=[];w=function(b){return new Promise(function(a,c){0<
t[b].length?(0,module$src$shared$util$getImageBase64.default)(t[b]).then(function(c){e=e.replace(t[b],"data:"+c.contentType+";base64,"+c.data);a()}).catch(function(b){c(b)}):a()})};for(d=0;d<t.length;++d)c=w(d),f.push(c);w=function(c){return new Promise(function(d,f){module$src$externals$axios.default.get(c).then(function(b){return b.data}).then(function(g){for(var h=[],l=/url\(\s*(.*?)\s*\)/g,m;null!==(m=l.exec(g));)h.push(m[1]);l=[];m=function(b){return new Promise(function(a,c){(0,module$src$shared$util$getImageBase64.default)(b).then(function(c){c=
"data:"+c.contentType+";base64,"+c.data;0<b.length&&(g=g.replace(b,c));a()}).catch(function(){c(Error("Error converting "+b+" to base64"))})})};for(a=0;a<h.length;++a)l.push(m(h[a]));return Promise.all(l).then(function(){return g}).then(function(a){0<b.length&&(e=e.replace("@import url("+c+");",a));d()}).catch(function(){f(Error("Error converting CSS string."))})})})};for(d=0;d<v.length;++d)c=w(v[d]),f.push(c);return Promise.all(f).then(function(){return new Promise(function(b,a){var c="data:image/svg+xml,"+
encodeURIComponent(e),d=document.createElement("canvas");d.width=2048;d.height=2048;var f=d.getContext("2d"),g=new Image;g.onload=function(){f.drawImage(g,0,0,2048,2048);var a=new module$src$externals$three.default.Texture(d);b(a)};g.onerror=function(b){a(b)};g.crossOrigin="Anonymous";g.src=c})})}return Promise.reject(Error("Unkonwn content-type "+g+" when downloading "+b))});return textureCache$$module$src$shared$singletons$TextureLoader[h].then(function(b){var a=b.clone();module$src$externals$expo_three.default&&
module$src$externals$expo_asset_utils.default&&b.isDataTexture&&!a.isDataTexture&&(a.isDataTexture=!0);return c(a)})}};module$src$shared$singletons$TextureLoader.default=new TextureLoader$$module$src$shared$singletons$TextureLoader;var module$src$plugins$PluginPrototype={},pluginConstants$$module$src$plugins$PluginPrototype=module$src$plugins$PluginConstants.default,GlobalUtils$$module$src$plugins$PluginPrototype=module$src$shared$util$GlobalUtils.default,GlobalMixin$$module$src$plugins$PluginPrototype=module$src$shared$mixins$GlobalMixin.default,SettingsMixin$$module$src$plugins$PluginPrototype=module$src$shared$mixins$SettingsMixin.default,LoggingMixin$$module$src$plugins$PluginPrototype=module$src$shared$mixins$LoggingMixin.default,
MessagingMixin$$module$src$plugins$PluginPrototype=module$src$shared$mixins$MessagingMixin.default,MessagePrototype$$module$src$plugins$PluginPrototype=module$src$shared$messages$MessagePrototype.default,TextureLoader$$module$src$plugins$PluginPrototype=module$src$shared$singletons$TextureLoader.default,THREE$$module$src$plugins$PluginPrototype=module$src$externals$three.default;
module$src$plugins$PluginPrototype.default=function(a){var b=this;this.pluginConstants=module$src$plugins$PluginConstants.default;this.GlobalUtils=module$src$shared$util$GlobalUtils.default;this.MessagePrototype=module$src$shared$messages$MessagePrototype.default;b.TextureLoader=module$src$shared$singletons$TextureLoader.default;b.THREE=module$src$externals$three.default;module$src$shared$mixins$GlobalMixin.default.call(this);if(void 0===a.runtimeId||"string"!==typeof a.runtimeId)a.runtimeId=module$src$shared$util$GlobalUtils.default.createRandomId();
module$src$shared$mixins$SettingsMixin.default.call(this,a,b.pluginConstants.defaultSettings);this.registerHook("runtimeId",function(){return!1});module$src$shared$mixins$LoggingMixin.default.call(this);module$src$shared$mixins$MessagingMixin.default.call(this);this.getRuntimeId=function(){return b.getSetting("runtimeId")};this.load=function(a){b.updateSettings(a);return!0};this.getStatus=function(){};this.setStatus=function(){};(function(){var a=b.pluginConstants.pluginStatuses.READY;b.getStatus=
function(){return module$src$shared$util$GlobalUtils.default.deepCopy(a)};b.setStatus=function(c){if(a!==c){var d=b.pluginConstants.messageTopics.PLUGIN_FAILED;c===b.pluginConstants.pluginStatuses.FAILED?d=b.pluginConstants.messageTopics.PLUGIN_FAILED:c===b.pluginConstants.pluginStatuses.LOADED?d=b.pluginConstants.messageTopics.PLUGIN_LOADED:c===b.pluginConstants.pluginStatuses.ACTIVE?d=b.pluginConstants.messageTopics.PLUGIN_ACTIVE:c===b.pluginConstants.pluginStatuses.UNLOADED&&(d=b.pluginConstants.messageTopics.PLUGIN_UNLOADED);
var f=new module$src$shared$messages$MessagePrototype.default(b.pluginConstants.messageDataTypes.PLUGIN_RUNTIME_ID,b.getRuntimeId());b.message(d,f);a=c}}}).call(this);this.getStatusDescription=function(){return{id:b.getRuntimeId(),status:b.getStatus(),name:b.getName(),shortName:b.getShortName()}};return this};var module$src$plugins$comm$CommPlugin={},axios$$module$src$plugins$comm$CommPlugin=module$src$externals$axios.default,commPluginConstants$$module$src$plugins$comm$CommPlugin=module$src$plugins$comm$CommPluginConstants.default,pluginConstantsGlobal$$module$src$plugins$comm$CommPlugin=module$src$shared$constants$PluginConstantsGlobal.default,pluginPrototype$$module$src$plugins$comm$CommPlugin=module$src$plugins$PluginPrototype.default,messagingConstants$$module$src$plugins$comm$CommPlugin=module$src$shared$constants$MessagingConstants.default,
loggingConstants$$module$src$plugins$comm$CommPlugin=module$src$shared$constants$LoggingConstants.default,GlobalUtils$$module$src$plugins$comm$CommPlugin=module$src$shared$util$GlobalUtils.default,MessagePrototype$$module$src$plugins$comm$CommPlugin=module$src$shared$messages$MessagePrototype.default,VIEWER_INSTANCE_ID$$module$src$plugins$comm$CommPlugin=module$src$shared$util$GlobalUtils.default.createRandomId();
module$src$plugins$comm$CommPlugin.default=function(a){var b=this;"string"===typeof a.modelViewUrl&&0<a.modelViewUrl.length&&("eu-central-1"===a.modelViewUrl?a.modelViewUrl="https://sdeuc1.eu-central-1.shapediver.com":"us-east-1"===a.modelViewUrl?a.modelViewUrl="https://model-view.shapediver.com":"us-east-1-test"===a.modelViewUrl?a.modelViewUrl="https://sdtest.us-east-1.shapediver.com":a.modelViewUrl.startsWith("http")||(a.modelViewUrl="https://"+a.modelViewUrl));var c=module$src$shared$util$GlobalUtils.default.createRandomId();
module$src$plugins$PluginPrototype.default.call(this,module$src$shared$util$GlobalUtils.default.inject(module$src$plugins$comm$CommPluginConstants.default.defaultSettings,module$src$shared$util$GlobalUtils.default.deepCopy(a),!1));var d=module$src$externals$axios.default.create({timeout:b.getSettingShallow("ajaxTimeout")});b.getSettingShallow("authorization")&&(d.defaults.headers.common.Authorization=b.getSetting("authorization"));if(this.hasSetting("ticket")){var e={},f=[module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities.SHAPEDIVER_MODEL_VIEW],
h={},g=function(a,c){return(new t(a)).then(function(a){if(a.hasOwnProperty("msg")){var d=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE,{message:a.msg,scope:"Customization reply",messageLevel:module$src$shared$constants$LoggingConstants.default.loggingLevels.ERROR});b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_MESSAGE,d)}if(!a.hasOwnProperty("outputs"))return Promise.reject("Invalid customization reply");
var e=Object.keys(a.outputs);d=[];var f=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_INIT,e.length,c);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_INIT,f);f=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{state:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_INIT,
progress:.25},c);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,f);f={};e=$jscomp.makeIterator(e);for(var g=e.next();!g.done;f={outputId:f.outputId},g=e.next())f.outputId=g.value,g=(new Promise(function(d){return function(e,f){var g=a.outputs[d.outputId];if(g.hasOwnProperty("content"))e(g);else{var l=g.version;h[d.outputId]=l;var m=function(){return u(d.outputId,l).then(function(a){if(b.getSettingShallow("ignoreSuperseded")&&h[d.outputId]!==l)a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT,
"Subscene obsolete because of newer request",c),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,a),e();else{if(a.hasOwnProperty("msg")){var g=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE,{message:a.msg,scope:"Cache reply",messageLevel:module$src$shared$constants$LoggingConstants.default.loggingLevels.WARN});b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_MESSAGE,
g)}a.hasOwnProperty("outputs")&&a.outputs.hasOwnProperty(d.outputId)?(a=a.outputs[d.outputId],a.hasOwnProperty("version")&&a.version===l?a.hasOwnProperty("delay")?setTimeout(function(){m()},Math.max(100,parseInt(a.delay))):a.hasOwnProperty("content")?(a.id=d.outputId,e(a)):f(Error("No content nor delay in cache reply")):f(Error("Invalid cache reply"))):f(Error("Invalid cache reply"))}})};m()}}}(f))).then(function(a){return function(d){if(d){d.id=a.outputId;if(d.hasOwnProperty("msg")){var e=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE,
{message:d.msg,scope:"Output",messageLevel:module$src$shared$constants$LoggingConstants.default.loggingLevels.WARN});b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_MESSAGE,e)}e=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_OUTPUTVERSION_JSON,d,c);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_OUTPUTVERSION,e);return d}}}(f)),
d.push(g);return Promise.all(d)})},k=function(a,c,d){var e=function(c){if(!c.hasOwnProperty("exports")||!c.exports.hasOwnProperty(a))return Promise.reject("Unexpected reply to export request");var f=c.exports[a];if(!f.hasOwnProperty("delay"))return f;c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{data:f},d);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,c);c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_STATUS,
f,d);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_STATUS,c);return module$src$shared$util$GlobalUtils.default.waitForTimeout(Math.max(1E3,parseInt(f.delay))).then(function(){return q(a,f.version).then(e)})};return p(a,c).then(e)},l=function(){return r().then(function(a){b.debug("CommPlugin.initSession","Received session init reply",a);if(a.hasOwnProperty("msg")){var c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE,
{message:a.msg,scope:"Session init",messageLevel:module$src$shared$constants$LoggingConstants.default.loggingLevels.ERROR});b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_MESSAGE,c)}a.hasOwnProperty("config")&&(c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.APP_SETTINGS,a.config),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SETTINGS_REGISTER,c));
a.hasOwnProperty("parameters")&&(c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_DEFINITION,a.parameters),a.hasOwnProperty("config")&&c.addPart(module$src$shared$constants$MessagingConstants.default.messageDataTypes.APP_SETTINGS,a.config),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PARAMETER_REGISTER,c));a.hasOwnProperty("exports")&&(c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_DEFINITION,
a.exports),a.hasOwnProperty("config")&&c.addPart(module$src$shared$constants$MessagingConstants.default.messageDataTypes.APP_SETTINGS,a.config),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_REGISTER,c));b.getStatus()!==module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.ACTIVE&&b.setStatus(module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.ACTIVE)}).catch(function(a){b.error("CommPlugin.initSession","Session init failed",
a);b.setStatus(module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.FAILED);a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE,{messageScope:a.serverMessage||"Session initialisation failed"});b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_FAILED,a)})},m=null,n=function(a,f,g,h){var l={method:f,url:a,headers:{}};g&&(l.data=g);l.headers["X-ShapeDiver-Origin"]=
module$src$shared$util$GlobalUtils.default.embeddingOrigin();l.headers["X-ShapeDiver-CommPluginId"]=c;l.headers["X-ShapeDiver-ViewerId"]=VIEWER_INSTANCE_ID$$module$src$plugins$comm$CommPlugin;h&&(l.headers["Content-Type"]=h);b.getSettingShallow("authorization")&&(l.headers.Authorization=b.getSetting("authorization"));return d(l).then(function(a){a=a.data;if(a.hasOwnProperty("actions")){a.actions.forEach(function(b){b.hasOwnProperty("method")&&b.hasOwnProperty("href")&&b.hasOwnProperty("name")&&(e[b.name]=
b)});if(e.hasOwnProperty("default")){var c=e.default.href.replace("/default","");c!==m&&(m=c,b.debug("CommPlugin.modelViewAjax","Setting base URL to",m))}delete a.actions}a.hasOwnProperty("templates")&&delete a.templates;return a},function(c){if(c.response){var d="",e="",l=c.response.data;switch(c.response.status){case 400:d="Bad request";break;case 401:d="Unauthorized";break;case 403:d="Forbidden";break;case 410:return e=module$src$shared$util$GlobalUtils.default.deepCopy(m),r().then(function(){var b=
a.replace(e,m);return n(b,f,g,h)},function(a){b.setStatus(module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.FAILED);var c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE,{messageScope:a.serverMessage||"Session initialisation failed"});b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_FAILED,c);return Promise.reject(a)});case 413:d="Payload too large";
break;case 500:d="Internal server error";break;default:d="Communication failed with HTTP status"}var p="Request error: "+d+" ("+c.response.status+")";d=Error(d);l&&l.message&&(d.serverMessage=l.message,p+=", "+l.message);b.error("CommPlugin.modelViewAjax",p,c);return Promise.reject(d)}if(c.request)return b.error("CommPlugin.modelViewAjax","Request error (no response)",c),Promise.reject(Error("Request error (no response)"));b.error("CommPlugin.modelViewAjax","Request error (unknown)",c);return Promise.reject(Error("Request error (unknown)"))})},
r=function(){var a=b.getSettingShallow("modelViewUrl");return a?n(a+"/ticket/"+b.getSettingShallow("ticket"),"POST"):Promise.reject(Error("Base url not defined."))},u=function(b,a){return new Promise(function(c,d){e.hasOwnProperty("cache")&&e.cache.hasOwnProperty("method")&&e.cache.hasOwnProperty("href")?(d={},d[b]=a,c(n(e.cache.href,e.cache.method,d,"application/json"))):d(Error('Action "cache" is missing'))})},p=function(b,a){return new Promise(function(c,d){e.hasOwnProperty("export")&&e.export.hasOwnProperty("method")&&
e.export.hasOwnProperty("href")||d(Error('Action "export" is missing'));c(n(e.export.href,e.export.method,{exports:{id:b},parameters:a},"application/json"))})},q=function(b,a){return new Promise(function(c,d){e.hasOwnProperty("export-cache")&&e["export-cache"].hasOwnProperty("method")&&e["export-cache"].hasOwnProperty("href")?(d={},d[b]=a,c(n(e["export-cache"].href,e["export-cache"].method,d,"application/json"))):d(Error('Action "export-cache" is missing'))})},t=function(b){return new Promise(function(a,
c){e.hasOwnProperty("customize")&&e.customize.hasOwnProperty("method")&&e.customize.hasOwnProperty("href")||c(Error('Action "customize" is missing'));a(n(e.customize.href,e.customize.method,b,"application/json"))})};this.getName=function(){return"ShapeDiver Communications Plugin"};this.getShortName=function(){return"CommPlugin"};this.getCapabilities=function(){var b=module$src$shared$util$GlobalUtils.default.deepCopy(f);e.hasOwnProperty("log")&&b.push(module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities.LOGGING);
e.hasOwnProperty("configure")&&b.push(module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities.SETTINGS);e.hasOwnProperty("defaultparam")&&b.push(module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities.DEFAULTPARAM);return b};this.getMessageCallbacks=function(){return{}};this.load=function(a){b.updateSettings(a);l();b.debug("CommPlugin.load",'Loaded plugin "'+b.getName()+'" with capabilities '+JSON.stringify(b.getCapabilities())+" and runtime id "+b.getRuntimeId());
b.setStatus(module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.LOADED);return!0};this.logToServer=function(){var a=1===arguments.length?[arguments[0]]:Array.apply(null,arguments),c=a[0]&module$src$shared$constants$LoggingConstants.default.loggingLevels.LVLBITS,d=a[1],f=a.slice(2);0<f.length&&"string"===typeof f[0]&&(d+=": "+f[0],f=f.slice(1));return new Promise(function(a,g){e.hasOwnProperty("log")&&e.log.hasOwnProperty("method")&&e.log.hasOwnProperty("href")||g(Error("CommPlugin.logToServer: Session did not provide log action"));
var h={level:2-Math.max(Math.min(c,2),0),message:d};1===f.length?h.err=f[0]:1<f.length&&(h.err={messages:f});n(e.log.href,e.log.method,h,"application/json").then(function(b){a(b)},function(a){a="CommPlugin.logToServer: Log message rejected by server "+b.jsify(a);g(Error(a))})})};this.setParameterValue=function(){b.warn("CommPlugin.setParameterValue","Not supported");return module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.ERROR};this.setMultipleParameterValues=function(){b.warn("CommPlugin.setMultipleParameterValues",
"Not supported");return module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.ERROR};this.setAllParameterValues=function(a,c){if(b.getStatus()!==module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.ACTIVE)return a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,"Plugin not active",c),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,
a),module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.ERROR;g(a,c).catch(function(a){a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,a,c);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,a)});return module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.LOAD};this.fileUpload=function(b){if(!e.hasOwnProperty("upload"))throw Error("CommPlugin.fileUpload: no upload action");
return n(e.upload.href,e.upload.method,b.request,"application/json").then(function(a){var c={},e=[],f;for(f in b.data){var g=a[f];if(!g||!module$src$shared$util$GlobalUtils.default.typeCheck(g.id,"string")||!module$src$shared$util$GlobalUtils.default.typeCheck(g.href,"string"))throw Error("CommPlugin.fileUpload: invalid response");c[f]=g.id;g={method:"PUT",url:g.href,data:b.data[f],headers:{},transformRequest:[function(b,a){delete a.common.Authorization;delete a.Authorization;return b}]};g.headers["Content-Type"]=
b.request[f].format;e.push(d(g))}return Promise.all(e).then(function(){return c})})};this.requestExport=function(a,c,d){if(b.getStatus()!==module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.ACTIVE)return a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,"Plugin not active",d),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,a),module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.ERROR;
k(a,c,d).then(function(a){var c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_RESULT,a,d);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_AVAILABLE,c);c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS,"Export available",d);c.addPart(module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_RESULT,
a);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,c)},function(a){a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,a,d);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,a)});b.debug("CommPlugin.requestExport","Called with export "+a+", kvps "+b.jsify(c)+", token "+b.jsify(d));return b.pluginConstants.requestExportResults.LOAD};
this.saveSettings=function(b){return e.hasOwnProperty("configure")?n(e.configure.href,e.configure.method,b,"application/json"):Promise.resolve(!1)};this.saveDefaultParameterValues=function(b){return e.hasOwnProperty("defaultparam")?n(e.defaultparam.href,e.defaultparam.method,b,"application/json").then(function(){return!0}):Promise.resolve(!1)};this.registerHook("modelViewUrl",function(){return!1});this.registerHook("ticket",function(){return!1});this.setStatus(module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.READY)}else b.error("CommPlugin.CommPlugin",
"Plugin was initialized without a ticket."),b.setStatus(module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.FAILED)};var module$src$api$apps$sd_controls$constants$sd_controls_constants_types={default:{}};Object.defineProperty(module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default,"__esModule",{value:!0});var TYPES$$module$src$api$apps$sd_controls$constants$sd_controls_constants_types;
(function(a){a.SLIDER="slider";a.STRING="string";a.BOOLEAN="boolean";a.COLOR="color";a.BUTTON="button";a.DROPDOWN="dropdown";a.CHECKLIST="form";a.FILE="file";a.MULTIPLE="multiple";a.VECTOR3="vector3";a.MODAL="modal"})(TYPES$$module$src$api$apps$sd_controls$constants$sd_controls_constants_types=module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES||(module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES={}));var module$src$api$apps$sd_controls$settings$lights$sd_controls_setting={default:{}};Object.defineProperty(module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default,"__esModule",{value:!0});
module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting=function(){function a(b,c,d,e,f,h,g,k,l){void 0===c&&(c=null);void 0===h&&(h=1);void 0===g&&(g=1);void 0===k&&(k={});void 0===l&&(l=!1);this.api=b;this.setting=c;this.type=d;this.name=e;this.desc=f;this.groupId=h;this.orderId=g;this.properties=k;this.custom=l;this.id=0;this.menuElements=[];this.isSaved=!1;this.old=!0;a.resolveId(this);if(!this.type)throw Error("Missing type");if(!this.name)throw Error("Missing name");
this.custom||(this.defval=b.getSetting(c));this.properties&&Object.assign(this,this.properties)}a.prototype.registerMenuElement=function(b){this.menuElements.push(b)};a.prototype.getMenuElements=function(){return this.menuElements};a.resolveId=function(b){b.id=a.id++};a.id=0;return a}();var module$src$interfaces$api$apps$sd_controls$interfaces={default:{}};Object.defineProperty(module$src$interfaces$api$apps$sd_controls$interfaces.default,"__esModule",{value:!0});var ControlElementSize$$module$src$interfaces$api$apps$sd_controls$interfaces;
(function(a){a[a.QTR_WIDTH=0]="QTR_WIDTH";a[a.HALF_WIDTH=1]="HALF_WIDTH";a[a.FULL_WIDTH=2]="FULL_WIDTH"})(ControlElementSize$$module$src$interfaces$api$apps$sd_controls$interfaces=module$src$interfaces$api$apps$sd_controls$interfaces.default.ControlElementSize||(module$src$interfaces$api$apps$sd_controls$interfaces.default.ControlElementSize={}));var ViewerMode$$module$src$interfaces$api$apps$sd_controls$interfaces;
(function(a){a.PORTRAIT="portrait";a.LANDSCAPE="landscape"})(ViewerMode$$module$src$interfaces$api$apps$sd_controls$interfaces=module$src$interfaces$api$apps$sd_controls$interfaces.default.ViewerMode||(module$src$interfaces$api$apps$sd_controls$interfaces.default.ViewerMode={}));var LightEvents$$module$src$interfaces$api$apps$sd_controls$interfaces;
(function(a){a.ADD="add";a.REMOVE="removed";a.CLEAR_LIGHTS="clear.lights";a.DROPDOWN_CUSTOM_UPDATE="dropdown.customUpdate"})(LightEvents$$module$src$interfaces$api$apps$sd_controls$interfaces=module$src$interfaces$api$apps$sd_controls$interfaces.default.LightEvents||(module$src$interfaces$api$apps$sd_controls$interfaces.default.LightEvents={}));var SettingsGroups$$module$src$interfaces$api$apps$sd_controls$interfaces;
(function(a){a[a.WORLD=1]="WORLD";a[a.LIGHTS=2]="LIGHTS";a[a.BACKGROUND=3]="BACKGROUND";a[a.CAMERA=4]="CAMERA"})(SettingsGroups$$module$src$interfaces$api$apps$sd_controls$interfaces=module$src$interfaces$api$apps$sd_controls$interfaces.default.SettingsGroups||(module$src$interfaces$api$apps$sd_controls$interfaces.default.SettingsGroups={}));var module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_definition={default:{}},__extends$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_definition=this&&module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_definition.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return a(b,
c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_definition.default,"__esModule",{value:!0});
var sd_controls_constants_types_1$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_definition=module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default,sd_controls_setting_1$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_definition=module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default,interfaces_1$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_definition=module$src$interfaces$api$apps$sd_controls$interfaces.default;
module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_definition.default.LightDefinitionSetting=function(a){function b(b,d,e,f,h,g,k,l){var c=a.call(this,b,"light.definition",module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.MULTIPLE,f,h,g,k,null,!0)||this;c.controlsContext=d;c.settings=e;c.lightDef=l;c.isLightUpdateRegistered=!1;c.isSettingRemovable=!0;c.light=!0;c.controlsContext.controlsEvents.on(module$src$interfaces$api$apps$sd_controls$interfaces.default.LightEvents.ADD,
function(){return c.registerLightUpdate()});return c}__extends$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_definition(b,a);b.prototype.close=function(){this.getMenuElements().forEach(function(b){return b.close()})};b.prototype.onClick=function(){this.controlsContext.shapeDiverDragControls.makeLightDraggable(this.lightDef.id);this.registerLightUpdate()};b.prototype.remove=function(){this.api.scene.lights.removeLight(this.lightDef.id);this.controlsContext.controlsEvents.trigger(module$src$interfaces$api$apps$sd_controls$interfaces.default.LightEvents.REMOVE,
{name:this.lightDef.id,setting:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.MULTIPLE});this.controlsContext.shapeDiverDragControls.clearOnLightUpdateEvents(this.lightDef.id)};b.prototype.findChangedProperties=function(b){var a=this,c=[];Object.keys(b.properties).forEach(function(d){var e=b.properties[d];if("object"===typeof e)for(var f=Object.keys(e),k=0;k<f.length;k++){var l=f[k];if(a.lightDef.properties[d]&&e[l]!=a.lightDef.properties[d][l]){c.push(d);break}}else e!=
a.lightDef.properties[d]&&c.push(d)});return c};b.prototype.registerLightUpdate=function(){var b=this;if(!this.isLightUpdateRegistered)this.controlsContext.shapeDiverDragControls.onLightUpdate(this.lightDef.id,function(a){b.updateInputElements(a);return a});this.isLightUpdateRegistered=!0};b.prototype.updateInputElements=function(b){var a=this;this.findChangedProperties(b).forEach(function(c){var d=a.settings[c];a.lightDef.properties[c]=b.properties[c];d.getMenuElements().forEach(function(a){a.onSettingUpdate(b.properties[c])})})};
return b}(module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting);var module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property={default:{}},__extends$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property=this&&module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return a(b,c)};
return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__importDefault$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property=this&&module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property.default.__importDefault||function(a){return a&&a.__esModule?a:{"default":a}};
Object.defineProperty(module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property.default,"__esModule",{value:!0});
var sd_controls_constants_types_1$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property=module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default,toTinyColor_1$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property=__importDefault$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property(module$src$shared$util$toTinyColor.default),sd_controls_setting_1$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property=
module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default,interfaces_1$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property=module$src$interfaces$api$apps$sd_controls$interfaces.default;
module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property.default.LightPropertySetting=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.light=!0;return b}__extends$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property(b,a);Object.defineProperty(b.prototype,"lightId",{get:function(){return this._lightId},set:function(b){this._lightId=b},enumerable:!0,configurable:!0});b.prototype.fireDragControlsUpdate=function(){var b=
this.getLightDef();this.controlsContext.shapeDiverDragControls.updateLight(b)};b.prototype.getLightDef=function(){return this.api.scene.lights.getLight(this.lightId).data};return b}(module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting);
module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property.default.SliderLightPropertySetting=function(a){function b(b,d,e,f,h,g,k,l){void 0===h&&(h=null);void 0===l&&(l=0);h=a.call(this,b,e.id,module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.SLIDER,null!=h?h:f,null,module$src$interfaces$api$apps$sd_controls$interfaces.default.SettingsGroups.LIGHTS)||this;h.api=b;h.controlsContext=d;h.lightProperty=f;h.min=g;h.max=k;h.decimalplaces=l;h.lightId=
e.id;h.defval=e.properties[f];return h}__extends$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property(b,a);b.prototype.customUpdate=function(b,a){b=this.getLightDef();b.properties[this.lightProperty]=Number(a);this.api.scene.lights.updateLight(b)};return b}(module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property.default.LightPropertySetting);
module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property.default.ColorLightPropertySetting=function(a){function b(b,d,e,f,h){void 0===h&&(h=null);h=a.call(this,b,e.id,module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.COLOR,null!=h?h:f,null,module$src$interfaces$api$apps$sd_controls$interfaces.default.SettingsGroups.LIGHTS)||this;h.api=b;h.controlsContext=d;h.lightProperty=f;h.lightId=e.id;b=toTinyColor_1$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property.default(e.properties[f]);
b.setAlpha(1);h.defval=b.toString();h.valueConversion={update:"value",f:function(b,a){a=toTinyColor_1$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property.default(a.value);if("color"===b.inputComponent.type)return a.toHexString()+"FF";$("#"+this.slugId+"-color").spectrum("set",a.toRgbString());return""+a.toRgbString()}};return h}__extends$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property(b,a);b.prototype.customUpdate=function(b,a){b=
this.getLightDef();b.properties[this.lightProperty]=a;this.api.scene.lights.updateLight(b)};return b}(module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property.default.LightPropertySetting);
module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property.default.Vector3LightPropertySetting=function(a){function b(b,d,e,f,h,g,k,l,m){void 0===h&&(h=null);void 0===g&&(g=2);void 0===k&&(k=.01);h=a.call(this,b,e.id,module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.VECTOR3,null!=h?h:f,null,module$src$interfaces$api$apps$sd_controls$interfaces.default.SettingsGroups.LIGHTS)||this;h.api=b;h.controlsContext=d;h.lightProperty=f;h.decimalPlaces=
g;h.step=k;h.min=l;h.max=m;h.lightId=e.id;h.defval=e.properties[f];return h}__extends$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property(b,a);b.prototype.customUpdate=function(b,a,e,f){b=e.srcElement.getAttribute("data-component");e=this.getLightDef();e.properties[this.lightProperty][b]=a;this.api.scene.lights.updateLight(e);this.fireDragControlsUpdate();e=this.api.scene.lights.getLight(e.id).data;f.onSettingUpdate(e.properties[this.lightProperty])};return b}(module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property.default.LightPropertySetting);
module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property.default.BooleanLightPropertySetting=function(a){function b(b,d,e,f,h){void 0===h&&(h=null);h=a.call(this,b,e.id,module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.BOOLEAN,null!=h?h:f,null,module$src$interfaces$api$apps$sd_controls$interfaces.default.SettingsGroups.LIGHTS)||this;h.api=b;h.controlsContext=d;h.lightProperty=f;h.lightId=e.id;h.defval=e.properties[f];return h}__extends$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property(b,
a);b.prototype.customUpdate=function(b,a){b=this.getLightDef();b.properties[this.lightProperty]=a;this.api.scene.lights.updateLight(b)};return b}(module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property.default.LightPropertySetting);var module$src$api$apps$sd_controls$settings$sd_controls_settings_html_helpers={default:{}};Object.defineProperty(module$src$api$apps$sd_controls$settings$sd_controls_settings_html_helpers.default,"__esModule",{value:!0});
module$src$api$apps$sd_controls$settings$sd_controls_settings_html_helpers.default.HTMLSettingsHelper=function(){function a(){}a.createAlert=function(b){return'<div class="uk-alert-danger" uk-alert>\n              <a class="uk-alert-close" uk-close></a>\n              <p>'+b+"</p>\n            </div>"};return a}();var module$src$api$apps$sd_controls$settings$lights$CreateSaveLightSceneModalSetting={default:{}},__extends$$module$src$api$apps$sd_controls$settings$lights$CreateSaveLightSceneModalSetting=this&&module$src$api$apps$sd_controls$settings$lights$CreateSaveLightSceneModalSetting.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return a(b,c)};return function(b,
c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$settings$lights$CreateSaveLightSceneModalSetting.default,"__esModule",{value:!0});
var sd_controls_setting_1$$module$src$api$apps$sd_controls$settings$lights$CreateSaveLightSceneModalSetting=module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default,sd_controls_constants_types_1$$module$src$api$apps$sd_controls$settings$lights$CreateSaveLightSceneModalSetting=module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default,sd_controls_settings_html_helpers_1$$module$src$api$apps$sd_controls$settings$lights$CreateSaveLightSceneModalSetting=module$src$api$apps$sd_controls$settings$sd_controls_settings_html_helpers.default,
interfaces_1$$module$src$api$apps$sd_controls$settings$lights$CreateSaveLightSceneModalSetting=module$src$interfaces$api$apps$sd_controls$interfaces.default;
module$src$api$apps$sd_controls$settings$lights$CreateSaveLightSceneModalSetting.default.CreateSaveLightSceneModalSetting=function(a){function b(b,d){b=a.call(this,b,"save.lights.scene",module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.MODAL,"Save Light Scene","Store the current lighting settings in a new light scene definition.",module$src$interfaces$api$apps$sd_controls$interfaces.default.SettingsGroups.LIGHTS,Number.POSITIVE_INFINITY)||this;b.settingsContext=d;
b.overwriteContent='<label>The scene already exists. Do you want to overwrite it?</label>\n                          <p class="uk-text-right">\n                            <button id="jq-add-lights-scene-modal-confirm" data-overwrite="true" class="uk-button uk-button-primary  sd-control-button-confirm" type="button">Yes</button>\n                            <button id="jq-add-lights-scene-modal-overwrite-cancel" class="uk-button uk-button-default" type="button">No</button>\n                          </p>';
b.modalConfirmId="jq-add-lights-scene-modal-confirm";b.modalId="jq-add-lights-scene-modal";b.defval=!1;b.modalContent=b.createModalContent(b.getNameContent());return b}__extends$$module$src$api$apps$sd_controls$settings$lights$CreateSaveLightSceneModalSetting(b,a);b.prototype.customUpdate=function(b){var a=this;b=document.getElementById(this.modalConfirmId).getAttribute("data-overwrite");var c=this.api.scene.lights.getAllLightScenes().data,f=document.getElementById("jq-add-lights-scene-name");f&&
(this._name=f.value);if(!b)if(f=document.getElementById("jq-add-lights-scenes-alert"),this._name){if(this.isDefaultOrLegacyScene(this._name)){f&&(f.innerHTML=module$src$api$apps$sd_controls$settings$sd_controls_settings_html_helpers.default.HTMLSettingsHelper.createAlert('Light scene "'+this._name+'" cannot be overriden or saved. Please use another name for light scene'));return}f&&(f.innerHTML="")}else{f&&(f.innerHTML=module$src$api$apps$sd_controls$settings$sd_controls_settings_html_helpers.default.HTMLSettingsHelper.createAlert("Please specify a name for the light scene"));
return}b||!c.some(function(b){return b==a._name})?(this.api.scene.lights.saveLightScene(this._name),UIkit.modal("#jq-add-lights-scene-modal").hide(),document.getElementById("jq-add-lights-scenes-content").innerHTML=this.getNameContent(),this.settingsContext.settings["lights.lightScene"].getMenuElements().forEach(function(b){var c=a.api.scene.lights.getAllLightScenes().data,d;for(d=0;d<c.length&&c[d]!==name;d++);b.createChoices(c,d)})):(document.getElementById("jq-add-lights-scenes-content").innerHTML=
this.overwriteContent,document.getElementById("jq-add-lights-scene-modal-overwrite-cancel").onclick=function(){document.getElementById("jq-add-lights-scenes-content").innerHTML=a.getNameContent();a.getMenuElements().forEach(function(b){return b.rebindConfirmEvent()});a.onModalOpen(null)})};b.prototype.onModalOpen=function(b){var a=this.api.scene.lights.getLightScene().data;b=this.resolveNameIfDuplicate("scene");this.api.scene.lights.getAllLightScenes().data.some(function(b){return b===a.id})&&(b=
this.resolveNameIfDuplicate(a.id));var c=document.getElementById("jq-add-lights-scene-name");null!==c&&(c.value=b,b=document.getElementById("jq-add-lights-scene-existing"),null===b||this.isDefaultOrLegacyScene(a.id)||(b.value=a.id));this.bindExistingSceneDropdownChanged()};b.prototype.registerMenuElement=function(b){a.prototype.registerMenuElement.call(this,b);b.onModalOpen=this.onModalOpen.bind(this)};b.prototype.bindExistingSceneDropdownChanged=function(){var b=document.getElementById("jq-add-lights-scene-existing");
null!==b&&(b.onchange=function(){return document.getElementById("jq-add-lights-scene-name").value=b.value})};b.prototype.createModalContent=function(b){return'<div class="uk-modal-dialog uk-modal-body">\n            <h2 class="uk-modal-title">Save Light Scene</h2>\n\n              <form id="jq-add-lights-scenes-content" class="uk-form-horizontal">\n                '+b+'\n              </form>\n              <div id="jq-add-lights-scenes-alert">\n\n              </div>\n            </div>'};b.prototype.getNameContent=
function(){var b=this,a=this.api.scene.lights.getAllLightScenes().data.filter(function(a){return!b.isDefaultOrLegacyScene(a)}),e=this.api.scene.lights.getLightScene().data,f="";0<a.length&&(f='<div class="uk-margin">\n                              <label class="uk-form-label" for="form-horizontal-select">Saved Scenes:</label>\n                              <div class="uk-form-controls">\n                                  <select class="uk-select" id="jq-add-lights-scene-existing">\n                                      '+
a.map(function(c){return"<option "+(b.isDefaultOrLegacyScene(c)?"disabled":"")+" "+(a.some(function(b){return b===e.id})?"selected":"")+">"+c+"</option>"}).join("")+"\n                                  </select>\n                              </div>\n                            </div>");return f+'\n            <div class="uk-margin">\n              <label class="uk-form-label" for="form-horizontal-text">Save Current Scene As:</label>\n              <div class="uk-form-controls">\n                  <input id="jq-add-lights-scene-name" class="uk-input" type="text" placeholder="type name ...">\n              </div>\n            </div>\n            <p class="uk-text-right">\n              <button class="uk-button uk-button-default uk-modal-close" type="button">Cancel</button>\n              <button id="jq-add-lights-scene-modal-confirm" class="uk-button uk-button-primary sd-control-button-confirm" type="button">Save</button>\n            </p>'};
b.prototype.isDefaultOrLegacyScene=function(b){return"default"===b||"legacy"===b};b.prototype.moveNameIndex=function(b){var a=b.lastIndexOf("_");if(-1<a){var c=b.substr(a+1);if(0==isNaN(c))return c=Number(c),c++,b=b.replace(b.substr(a),""),b+"_"+c}return b+"_1"};b.prototype.resolveNameIfDuplicate=function(b){var a=this.api.scene.lights.getAllLightScenes().data;if(a.some(function(a){return a==b}))for(;a.some(function(a){return a==b});)b=this.moveNameIndex(b);return b};return b}(module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting);var module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util={default:{}};
module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement=function(a,b){a=document.createElement(a);var c,d,e;for(c in b){var f=b[c];if("classList"===c)if(Array.isArray(f)){var h=0;for(e=f.length;h<e;h++)a.classList.add(f[h])}else a.classList.add(f);else if("parent"===c)f.appendChild(a);else if("attributes"===c)for(d in f)a.setAttribute(d,f[d]);else void 0!==f&&null!==f&&(a[c]=f)}return a};
module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener=function(a,b,c,d,e,f,h,g){var k,l=h||0,m,n;h=function(e){a||_destroy();c.valueConversion.update&&c.valueConversion.f?(m=d[c.valueConversion.update],n=c.valueConversion.f(c,d,e)):m="string"===typeof c.valueConversion?n=d[c.valueConversion]:n=c.valueConversion(c,d,e);f(m,e)&&(clearTimeout(k),k=setTimeout(function(){var d=!0;if("function"===typeof g){var f={val1:m,val2:n};d=g(f,e);m=
f.val1;n=f.val2}d&&(!0===c.parameter?c.parametersQueue&&c.parametersQueue.use?c.parametersQueue.add(c,b,n):(a.parameters.updateAsync({id:b,value:n}),c.setStackToLast()):!0===c.export?a.exports.requestAsync({id:b}):"function"===typeof c.customUpdate?c.customUpdate(b,n,e,c):(a.updateSettingAsync(b,n),c.setStackToLast()))},l))};d.addEventListener(e,h);return h};
module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.isMobileDevice=function(){var a=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||
/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,
4)))_isMobile$$module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util=!0;return _isMobile$$module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util};
module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.isMobileOrTabletDevice=function(){var a=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,
4)))_isMobileOrTable$$module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util=!0;return _isMobileOrTable$$module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util};module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.isIPadOrIPhone=function(){var a=window.navigator.userAgent;return a.match(/iPad/i)||a.match(/iPhone/i)};
module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.isEventSupported=function(a,b){var c={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};b=document.createElement(b||c||"div");a="on"+a;c=a in b;c||(b.setAttribute(a,"return;"),c="function"==typeof b[a]);return c};
module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.domSupportsHtml5Color=function(){try{return colorInput=document.createElement("input"),colorInput.type="color",colorInput.value="!","color"===colorInput.type&&"!"!==colorInput.value}catch(a){return!1}};var _isMobile$$module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util=!1,_isMobileOrTable$$module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util=!1;var module$src$api$apps$sd_controls$components$util$sd_controls_components_util_util={default:{}};module$src$api$apps$sd_controls$components$util$sd_controls_components_util_util.default.hide=function(a,b){return b?a.classList.add("sdv-hidden"):a.classList.remove("sdv-hidden")};var module$src$api$apps$sd_controls$components$base$sd_controls_components_base={default:{}},__importDefault$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base=this&&module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.__importDefault||function(a){return a&&a.__esModule?a:{"default":a}};Object.defineProperty(module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default,"__esModule",{value:!0});
var sd_controls_components_util_util_1$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base=__importDefault$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base(module$src$api$apps$sd_controls$components$util$sd_controls_components_util_util.default),sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base=__importDefault$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base(module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default),
createDOMElement$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base=sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.createDomElement,IS_MOBILE_DEVICE$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base=sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.isMobileDevice(),IS_MOBILE_OR_TABLET_DEVICE$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base=
sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.isMobileOrTabletDevice(),IS_IPAD_OR_IPHONE$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base=sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.isIPadOrIPhone(),WRAP_CLASS$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base="uk-text-truncate",_slugify$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base=
function(){function a(a,d){void 0===d&&(d=null);"string"!==typeof a&&(a+="");d="string"===typeof d?{replacement:d}:d||{};a=a.split("").reduce(function(a,c){return a+(b[c]||c).replace(d.remove||/[^\w\s$*_+~.()''!\-:@]/g,"")},"").replace(/^\s+|\s+$/g,"").replace(/[-\s]+/g,d.replacement||"-").replace("#{replacement}$","");return d.lower?a.toLowerCase():a}var b=JSON.parse('{"$":"dollar","&":"and","<":"less",">":"greater","|":"or","\u00a2":"cent","\u00a3":"pound","\u00a4":"currency","\u00a5":"yen","\u00a9":"(c)","\u00aa":"a","\u00ae":"(r)","\u00ba":"o","\u00c0":"A","\u00c1":"A","\u00c2":"A","\u00c3":"A","\u00c4":"A","\u00c5":"A","\u00c6":"AE","\u00c7":"C","\u00c8":"E","\u00c9":"E","\u00ca":"E","\u00cb":"E","\u00cc":"I","\u00cd":"I","\u00ce":"I","\u00cf":"I","\u00d0":"D","\u00d1":"N","\u00d2":"O","\u00d3":"O","\u00d4":"O","\u00d5":"O","\u00d6":"O","\u00d8":"O","\u00d9":"U","\u00da":"U","\u00db":"U","\u00dc":"U","\u00dd":"Y","\u00de":"TH","\u00df":"ss","\u00e0":"a","\u00e1":"a","\u00e2":"a","\u00e3":"a","\u00e4":"a","\u00e5":"a","\u00e6":"ae","\u00e7":"c","\u00e8":"e","\u00e9":"e","\u00ea":"e","\u00eb":"e","\u00ec":"i","\u00ed":"i","\u00ee":"i","\u00ef":"i","\u00f0":"d","\u00f1":"n","\u00f2":"o","\u00f3":"o","\u00f4":"o","\u00f5":"o","\u00f6":"o","\u00f8":"o","\u00f9":"u","\u00fa":"u","\u00fb":"u","\u00fc":"u","\u00fd":"y","\u00fe":"th","\u00ff":"y","\u0100":"A","\u0101":"a","\u0102":"A","\u0103":"a","\u0104":"A","\u0105":"a","\u0106":"C","\u0107":"c","\u010c":"C","\u010d":"c","\u010e":"D","\u010f":"d","\u0110":"DJ","\u0111":"dj","\u0112":"E","\u0113":"e","\u0116":"E","\u0117":"e","\u0118":"e","\u0119":"e","\u011a":"E","\u011b":"e","\u011e":"G","\u011f":"g","\u0122":"G","\u0123":"g","\u0128":"I","\u0129":"i","\u012a":"i","\u012b":"i","\u012e":"I","\u012f":"i","\u0130":"I","\u0131":"i","\u0136":"k","\u0137":"k","\u013b":"L","\u013c":"l","\u0141":"L","\u0142":"l","\u0143":"N","\u0144":"n","\u0145":"N","\u0146":"n","\u0147":"N","\u0148":"n","\u0150":"O","\u0151":"o","\u0152":"OE","\u0153":"oe","\u0158":"R","\u0159":"r","\u015a":"S","\u015b":"s","\u015e":"S","\u015f":"s","\u0160":"S","\u0161":"s","\u0162":"T","\u0163":"t","\u0164":"T","\u0165":"t","\u0168":"U","\u0169":"u","\u016a":"u","\u016b":"u","\u016e":"U","\u016f":"u","\u0170":"U","\u0171":"u","\u0172":"U","\u0173":"u","\u0179":"Z","\u017a":"z","\u017b":"Z","\u017c":"z","\u017d":"Z","\u017e":"z","\u0192":"f","\u01a0":"O","\u01a1":"o","\u01af":"U","\u01b0":"u","\u01c8":"LJ","\u01c9":"lj","\u01cb":"NJ","\u01cc":"nj","\u0218":"S","\u0219":"s","\u021a":"T","\u021b":"t","\u02da":"o","\u0386":"A","\u0388":"E","\u0389":"H","\u038a":"I","\u038c":"O","\u038e":"Y","\u038f":"W","\u0390":"i","\u0391":"A","\u0392":"B","\u0393":"G","\u0394":"D","\u0395":"E","\u0396":"Z","\u0397":"H","\u0398":"8","\u0399":"I","\u039a":"K","\u039b":"L","\u039c":"M","\u039d":"N","\u039e":"3","\u039f":"O","\u03a0":"P","\u03a1":"R","\u03a3":"S","\u03a4":"T","\u03a5":"Y","\u03a6":"F","\u03a7":"X","\u03a8":"PS","\u03a9":"W","\u03aa":"I","\u03ab":"Y","\u03ac":"a","\u03ad":"e","\u03ae":"h","\u03af":"i","\u03b0":"y","\u03b1":"a","\u03b2":"b","\u03b3":"g","\u03b4":"d","\u03b5":"e","\u03b6":"z","\u03b7":"h","\u03b8":"8","\u03b9":"i","\u03ba":"k","\u03bb":"l","\u03bc":"m","\u03bd":"n","\u03be":"3","\u03bf":"o","\u03c0":"p","\u03c1":"r","\u03c2":"s","\u03c3":"s","\u03c4":"t","\u03c5":"y","\u03c6":"f","\u03c7":"x","\u03c8":"ps","\u03c9":"w","\u03ca":"i","\u03cb":"y","\u03cc":"o","\u03cd":"y","\u03ce":"w","\u0401":"Yo","\u0402":"DJ","\u0404":"Ye","\u0406":"I","\u0407":"Yi","\u0408":"J","\u0409":"LJ","\u040a":"NJ","\u040b":"C","\u040f":"DZ","\u0410":"A","\u0411":"B","\u0412":"V","\u0413":"G","\u0414":"D","\u0415":"E","\u0416":"Zh","\u0417":"Z","\u0418":"I","\u0419":"J","\u041a":"K","\u041b":"L","\u041c":"M","\u041d":"N","\u041e":"O","\u041f":"P","\u0420":"R","\u0421":"S","\u0422":"T","\u0423":"U","\u0424":"F","\u0425":"H","\u0426":"C","\u0427":"Ch","\u0428":"Sh","\u0429":"Sh","\u042a":"U","\u042b":"Y","\u042c":"","\u042d":"E","\u042e":"Yu","\u042f":"Ya","\u0430":"a","\u0431":"b","\u0432":"v","\u0433":"g","\u0434":"d","\u0435":"e","\u0436":"zh","\u0437":"z","\u0438":"i","\u0439":"j","\u043a":"k","\u043b":"l","\u043c":"m","\u043d":"n","\u043e":"o","\u043f":"p","\u0440":"r","\u0441":"s","\u0442":"t","\u0443":"u","\u0444":"f","\u0445":"h","\u0446":"c","\u0447":"ch","\u0448":"sh","\u0449":"sh","\u044a":"u","\u044b":"y","\u044c":"","\u044d":"e","\u044e":"yu","\u044f":"ya","\u0451":"yo","\u0452":"dj","\u0454":"ye","\u0456":"i","\u0457":"yi","\u0458":"j","\u0459":"lj","\u045a":"nj","\u045b":"c","\u045f":"dz","\u0490":"G","\u0491":"g","\u0e3f":"baht","\u10d0":"a","\u10d1":"b","\u10d2":"g","\u10d3":"d","\u10d4":"e","\u10d5":"v","\u10d6":"z","\u10d7":"t","\u10d8":"i","\u10d9":"k","\u10da":"l","\u10db":"m","\u10dc":"n","\u10dd":"o","\u10de":"p","\u10df":"zh","\u10e0":"r","\u10e1":"s","\u10e2":"t","\u10e3":"u","\u10e4":"f","\u10e5":"k","\u10e6":"gh","\u10e7":"q","\u10e8":"sh","\u10e9":"ch","\u10ea":"ts","\u10eb":"dz","\u10ec":"ts","\u10ed":"ch","\u10ee":"kh","\u10ef":"j","\u10f0":"h","\u1e9e":"SS","\u1ea0":"A","\u1ea1":"a","\u1ea2":"A","\u1ea3":"a","\u1ea4":"A","\u1ea5":"a","\u1ea6":"A","\u1ea7":"a","\u1ea8":"A","\u1ea9":"a","\u1eaa":"A","\u1eab":"a","\u1eac":"A","\u1ead":"a","\u1eae":"A","\u1eaf":"a","\u1eb0":"A","\u1eb1":"a","\u1eb2":"A","\u1eb3":"a","\u1eb4":"A","\u1eb5":"a","\u1eb6":"A","\u1eb7":"a","\u1eb8":"E","\u1eb9":"e","\u1eba":"E","\u1ebb":"e","\u1ebc":"E","\u1ebd":"e","\u1ebe":"E","\u1ebf":"e","\u1ec0":"E","\u1ec1":"e","\u1ec2":"E","\u1ec3":"e","\u1ec4":"E","\u1ec5":"e","\u1ec6":"E","\u1ec7":"e","\u1ec8":"I","\u1ec9":"i","\u1eca":"I","\u1ecb":"i","\u1ecc":"O","\u1ecd":"o","\u1ece":"O","\u1ecf":"o","\u1ed0":"O","\u1ed1":"o","\u1ed2":"O","\u1ed3":"o","\u1ed4":"O","\u1ed5":"o","\u1ed6":"O","\u1ed7":"o","\u1ed8":"O","\u1ed9":"o","\u1eda":"O","\u1edb":"o","\u1edc":"O","\u1edd":"o","\u1ede":"O","\u1edf":"o","\u1ee0":"O","\u1ee1":"o","\u1ee2":"O","\u1ee3":"o","\u1ee4":"U","\u1ee5":"u","\u1ee6":"U","\u1ee7":"u","\u1ee8":"U","\u1ee9":"u","\u1eea":"U","\u1eeb":"u","\u1eec":"U","\u1eed":"u","\u1eee":"U","\u1eef":"u","\u1ef0":"U","\u1ef1":"u","\u1ef2":"Y","\u1ef3":"y","\u1ef4":"Y","\u1ef5":"y","\u1ef6":"Y","\u1ef7":"y","\u1ef8":"Y","\u1ef9":"y","\u2018":"\'","\u2019":"\'","\u201c":"\\"","\u201d":"\\"","\u2020":"+","\u2022":"*","\u2026":"...","\u20a0":"ecu","\u20a2":"cruzeiro","\u20a3":"french franc","\u20a4":"lira","\u20a5":"mill","\u20a6":"naira","\u20a7":"peseta","\u20a8":"rupee","\u20a9":"won","\u20aa":"new shequel","\u20ab":"dong","\u20ac":"euro","\u20ad":"kip","\u20ae":"tugrik","\u20af":"drachma","\u20b0":"penny","\u20b1":"peso","\u20b2":"guarani","\u20b3":"austral","\u20b4":"hryvnia","\u20b5":"cedi","\u20b9":"indian rupee","\u20bd":"russian ruble","\u2120":"sm","\u2122":"tm","\u2202":"d","\u2206":"delta","\u2211":"sum","\u221e":"infinity","\u2665":"love","\u5143":"yuan","\u5186":"yen","\ufdfc":"rial"}');
a.extend=function(a){for(var c in a)b[c]=a[c]};return a}();
module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.MenuComponent=function(){function a(b,a,d,e){this.type=b;this.param=a;this.controlsContext=d;this.rowParent=e;this.newName=this.customUpdate=null;this.hidden=this.inContentEditMode=this.wasEdited=!1;this.inputComponent=null;this.valueStack=[];this.currentValue=this._previousValue=null;this.isChanged=!1;this.id=a.id;this.plugin=a.plugin;this.groupId=a.groupId?a.groupId:null;this.isMobileDevice=IS_MOBILE_DEVICE$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base;
this.isMobileOrTabletDevice=IS_MOBILE_OR_TABLET_DEVICE$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base;this.isIPadOrIPhone=IS_IPAD_OR_IPHONE$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base;this.order=a.order;this.name=a.name;this.newName=null;this.hidden=this.inContentEditMode=this.wasEdited=!1;this.setting=d.options&&d.options.settings?a.setting:null;this.light=this.param?this.param.light:!1;this.slugId=d.runtimeId+"_"+_slugify$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base(a.id);
this.parametersQueue=d.parametersQueue;this.settingsQueue=d.settingsQueue;a.customUpdate&&(this.customUpdate=function(b,c,d,e){a.customUpdate(b,c,d,e)});a.update&&(this.customUpdate=function(b,c,d,e){a.update(b,c,d,e)});-1===d.plugins.indexOf(a.plugin)&&d.plugins.push(a.plugin);this.createRow(b,a,e)}a.prototype.createRow=function(b,a,d){this.row=createDOMElement$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base("div",{id:this.slugId+"-controlmenu-row",name:this.slugId+"-controlmenu-row",
parent:d||this.controlsContext.container,classList:["sd-max-width-1","uk-padding-small","uk-margin-remove","sdv-control-panel-row-border"],attributes:{"uk-grid":'margin: "";'}});this.label=createDOMElement$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base("label",{id:this.slugId+"-label",parent:this.row,innerHTML:a.name,classList:["uk-width-expand","uk-form-label","uk-text-small","uk-margin-small-bottom","uk-padding-remove","uk-text-uppercase",WRAP_CLASS$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base],
attributes:{for:"slider"===this.slugId+"-"+b?"range":b,"param-id":a.id,title:a.desc?a.desc:a.name}});this.controlsContext.options&&this.controlsContext.options.editMode&&this.label.classList.add("sdv-edit-mode");this.inputContainer=createDOMElement$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base("div",{classList:["uk-width-1-1","uk-padding-remove"],parent:this.row})};a.prototype.pushToValueStack=function(b){this.valueStack.push(b)};a.prototype.setStackToLast=function(){var b=
this.valueStack.pop();void 0!==b?(this.valueStack=[b],this.currentValue=b):this.valueStack=[]};a.prototype.setToInitalValueAndClearStack=function(){var b=this.valueStack[0];this.valueStack=[];void 0!==b&&(this._previousValue=b,this.update(b))};a.prototype.insertBefore=function(b){this.row.parentNode&&this.row.parentNode.insertBefore(this.row,b.row)};a.prototype.isCurrentValueSameAsInital=function(){return this.currentValue===this.valueStack[0]};a.prototype.update=function(b,a){if(this.inputComponent)return this.currentValue=
this.inputComponent.value=b,this.pushToValueStack(b),!0;throw Error("Input component not defined. Type of: "+this.type);};a.prototype.hide=function(b){this.hidden=b;this.inputComponent&&sd_controls_components_util_util_1$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.hide(this.inputComponent,b)};a.prototype.toggleHide=function(){this.hide(!this.hidden)};a.prototype.disable=function(b){b?this.inputComponent.setAttribute("disabled","true"):this.inputComponent.removeAttribute("disabled")};
a.prototype.setEditable=function(b){b?(this.label.classList.remove(WRAP_CLASS$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base),this.label.addEventListener("input",function(b){this.wasEdited=!0;this.newName=b.target.innerText}.bind(this)),this.label.contentEditable="true"):(this.label.classList.add(WRAP_CLASS$$module$src$api$apps$sd_controls$components$base$sd_controls_components_base),this.label.contentEditable="false");this.inContentEditMode=b};a.prototype.onSettingUpdate=
function(b){this.inputComponent.value=b};return a}();var module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider={default:{}},__extends$$module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider=this&&module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};
return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__importDefault$$module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider=this&&module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider.default.__importDefault||function(a){return a&&a.__esModule?a:{"default":a}};
Object.defineProperty(module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider.default,"__esModule",{value:!0});
var sd_controls_components_dom_dom_util_js_1$$module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider=__importDefault$$module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider(module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default),sd_controls_components_util_util_1$$module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider=__importDefault$$module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider(module$src$api$apps$sd_controls$components$util$sd_controls_components_util_util.default),
sd_controls_components_base_1$$module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider=module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default;
module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider.default.SliderInputMenuComponent=function(a){function b(b,d,e,f,h){var c=a.call(this,d,e,f,h)||this;c.updateKeyUp=function(b,a){if(a.which||a.keyCode)return 13==a.which||13==a.keyCode};c.defaultVal=e.defval;c.minVal=Number(e.min);c.maxVal=Number(e.max);d=null==e.decimalplaces?0:"Even"==e.type||"Odd"==e.type?2:"Int"==e.type||"Odd"==e.type||"Even"==e.type?1:Math.pow(.1,e.decimalplaces);c.decimalPlaces=e.decimalplaces?
Number(e.decimalplaces):0;c.pushToValueStack(c.defaultVal);c.currentValue=c.defaultVal;c._previousValue=c.currentValue;c.cInputRange=sd_controls_components_dom_dom_util_js_1$$module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider.default.createDomElement("input",{attributes:{type:"range",name:c.slugId+"-range",min:c.minVal,max:c.maxVal,step:d,value:c.defaultVal,tabIndex:-1},id:c.slugId+"-range",parent:c.inputContainer,value:c.defaultVal,classList:["uk-range","uk-width-2-3",
"uk-form-small","sd-input-range"]});c.isMobileOrTabletDevice&&c.cInputRange.classList.add("sd-input-range-mobile");c.isIPadOrIPhone?c.cInputRange.classList.add("ios-padding-left"):c.cInputRange.classList.add("uk-padding-remove-left");c.cInputNumber=sd_controls_components_dom_dom_util_js_1$$module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider.default.createDomElement("input",{id:c.slugId+"-number",parent:c.inputContainer,value:c.defaultVal,classList:["uk-input",
"uk-width-1-3","uk-form-small","sd-input-number"],attributes:{type:"number",name:c.slugId+"-number",min:c.minVal,max:c.maxVal,step:d}});c.valueConversion=e.valueConversion?e.valueConversion:"value";sd_controls_components_dom_dom_util_js_1$$module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider.default.setDomElementEventListener(f.api,b,c,c.cInputRange,"change",c.update.bind(c));e=sd_controls_components_dom_dom_util_js_1$$module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider.default.isEventSupported("input",
"input")?"input":"change";sd_controls_components_dom_dom_util_js_1$$module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider.default.setDomElementEventListener(f.api,b,c,c.cInputNumber,e,c.update.bind(c),1E3,c.parameterValidation.bind(c));sd_controls_components_dom_dom_util_js_1$$module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider.default.setDomElementEventListener(f.api,b,c,c.cInputNumber,"focusout",c.update.bind(c),10,c.parameterValidation.bind(c));
sd_controls_components_dom_dom_util_js_1$$module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider.default.setDomElementEventListener(f.api,b,c,c.cInputNumber,"keyup",c.updateKeyUp.bind(c),10,c.parameterValidation.bind(c));c.cInputRange.addEventListener("input",function(){return c.cInputNumber.value=c.cInputRange.value});c.param.hasOwnProperty("registerMenuElement")&&c.param.registerMenuElement(c);return c}__extends$$module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider(b,
a);b.prototype.hide=function(b){a.prototype.hide.call(this,b);sd_controls_components_util_util_1$$module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider.default.hide(this.cInputRange,b);sd_controls_components_util_util_1$$module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider.default.hide(this.cInputNumber,b)};b.prototype.formatValue=function(b){return Number(b).toFixed(this.decimalPlaces)};b.prototype.update=function(b){this.onSettingUpdate(b);
return!0};b.prototype.parameterValidation=function(b){var a=Number(b.val1);a=Number.isNaN(a)?this._previousValue||this.defaultVal:this.formatValue(a);this.onSettingUpdate(a);this.currentValue<this.minVal?this.currentValue=this.minVal:this.currentValue>this.maxVal&&(this.currentValue=this.maxVal);this.cInputRange.value=this.currentValue;this.cInputNumber.value=this.currentValue;if(this._previousValue==this.currentValue)return!1;b.val1=this.currentValue;this._previousValue=b.val2=this.currentValue;
return!0};b.prototype.isCurrentValueSameAsInital=function(){return Number(this.currentValue)===Number(this.valueStack[0])};b.prototype.onSettingUpdate=function(b){this.currentValue=Number(b);this.pushToValueStack(this.currentValue);this.cInputNumber.value=b;this.cInputRange.value=b};return b}(module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.MenuComponent);var module$src$api$apps$sd_controls$components$component_string$sd_controls_components_string_input={default:{}},__extends$$module$src$api$apps$sd_controls$components$component_string$sd_controls_components_string_input=this&&module$src$api$apps$sd_controls$components$component_string$sd_controls_components_string_input.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&
(b[c]=a[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__importDefault$$module$src$api$apps$sd_controls$components$component_string$sd_controls_components_string_input=this&&module$src$api$apps$sd_controls$components$component_string$sd_controls_components_string_input.default.__importDefault||function(a){return a&&a.__esModule?a:{"default":a}};
Object.defineProperty(module$src$api$apps$sd_controls$components$component_string$sd_controls_components_string_input.default,"__esModule",{value:!0});
var sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_string$sd_controls_components_string_input=__importDefault$$module$src$api$apps$sd_controls$components$component_string$sd_controls_components_string_input(module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default),sd_controls_components_base_1$$module$src$api$apps$sd_controls$components$component_string$sd_controls_components_string_input=module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default;
module$src$api$apps$sd_controls$components$component_string$sd_controls_components_string_input.default.StringInptMenuComponent=function(a){function b(b,d,e,f,h){d=a.call(this,d,e,f,h)||this;h=e.defval;var c=parseInt(e.max);d.inputComponent=sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_string$sd_controls_components_string_input.default.createDomElement("input",{id:d.slugId+"-text",parent:d.inputContainer,maxLength:c,value:h,classList:["uk-input","uk-form-small"],
attributes:{type:"text",name:d.slugId+"-text"}});d._valueConversion=e.valueConversion?e.valueConversion:"value";sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_string$sd_controls_components_string_input.default.setDomElementEventListener(f.api,b,d,d.inputComponent,"input",d.update.bind(d),1E3);return d}__extends$$module$src$api$apps$sd_controls$components$component_string$sd_controls_components_string_input(b,a);Object.defineProperty(b.prototype,"valueConversion",
{get:function(){return this._valueConversion},enumerable:!0,configurable:!0});return b}(module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.MenuComponent);var module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input={default:{}},__extends$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input=this&&module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&
(b[c]=a[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__importDefault$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input=this&&module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default.__importDefault||function(a){return a&&a.__esModule?a:{"default":a}};
Object.defineProperty(module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default,"__esModule",{value:!0});
var sd_controls_components_base_1$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input=module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default,sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input=__importDefault$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input(module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default),
sd_controls_components_util_util_1$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input=__importDefault$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input(module$src$api$apps$sd_controls$components$util$sd_controls_components_util_util.default);
module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default.BooleanInputMenuComponent=function(a){function b(b,d,e,f,h){var c=a.call(this,d,e,f,h)||this;c.events=[];c.disableIds=e.disableIds;c.disableOn=e.disableOn;d=void 0==e.strue?null:e.strue;h=void 0==e.sfalse?null:e.sfalse;var k="true"==e.defval||1==e.defval;c.pushToValueStack(k);c.currentValue=k;c._previousValue=c.currentValue;null==d?(c.container=sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default.createDomElement("label",
{id:c.slugId+"_-checkbox-label",parent:c.inputContainer,classList:"sdv-control-panel-control",className:"sdv-control-panel-boolean-input-checkbox-label",attributes:{for:c.slugId+"-checkbox","data-friendly-name":c.param.name}}),c.cInputCheckbox=sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default.createDomElement("input",{id:c.slugId+"-checkbox",parent:c.container,checked:k,classList:["shapediver-viewer-element",
"sdv-control-panel-boolean-input-checkbox","sdv-control-panel-control"],attributes:{type:"checkbox",name:c.slugId+"-checkbox"}}),c.cInputCheckboxContainer=sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default.createDomElement("div",{id:c.slugId+"-checkbox-helper",parent:c.container,classList:"sdv-control-panel-boolean-input-boxhelper",attributes:{for:c.slugId+"-checkbox"}}),c.valueConversion=e.valueConversion?
e.valueConversion:"checked",sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default.setDomElementEventListener(f.api,b,c,c.cInputCheckbox,"change",c.update.bind(c))):(c.container=sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default.createDomElement("form",{id:c.slugId+"-form",parent:c.inputContainer,classList:["sdv-control-panel-boolean-input-form",
"sdv-control-panel-control"]}),c.label.setAttribute("for",c.slugId+"-form"),sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default.createDomElement("label",{id:c.slugId+"-label-true",parent:c.container,innerHTML:d,classList:"sdv-control-panel-boolean-input-radio-label"}),c.cInputCheckboxTrue=sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default.createDomElement("input",
{id:c.slugId+"-radio-true",parent:c.container,innerHTML:d,checked:k,value:"true",classList:"sdv-control-panel-boolean-input-radio",attributes:{type:"radio",name:c.slugId+"-radio-true"}}),sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default.createDomElement("label",{id:c.slugId+"-label-false",parent:c.container,innerHTML:h,classList:"sdv-control-panel-boolean-input-radio-label"}),c.cInputCheckboxFalse=sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default.createDomElement("input",
{id:c.slugId+"-radio-false",parent:c.container,innerHTML:h,checked:!k,value:"true",classList:"sdv-control-panel-boolean-input-radio",attributes:{type:"radio",name:c.slugId+"-radio-false"}}),c.valueConversion=e.valueConversion?e.valueConversion:"checked",sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default.setDomElementEventListener(c.id,c,c.cInputCheckboxTrue,"change",c.update.bind(c)),c.cInputCheckboxFalse.onchange=
function(){c.cInputCheckboxTrue.checked=!c.cInputCheckboxFalse.checked;if(c.cInputCheckboxFalse.checked)c.cInputCheckboxTrue.onchange(!0)},c.container.appendChild(sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default.createMenuElement("br")));return c}__extends$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input(b,a);b.prototype.hide=function(b){a.prototype.hide.call(this,
b);this.cInputCheckbox&&sd_controls_components_util_util_1$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default.hide(this.cInputCheckbox,b);this.cInputCheckboxContainer&&sd_controls_components_util_util_1$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default.hide(this.cInputCheckboxContainer,b);this.cInputCheckboxTrue&&sd_controls_components_util_util_1$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default.hide(this.cInputCheckboxFalse,
b);this.cInputCheckboxFalse&&sd_controls_components_util_util_1$$module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default.hide(this.cInputCheckboxTrue,b)};b.prototype.onSettingUpdate=function(b){this.pushToValueStack(b);this.cInputCheckbox&&(this.cInputCheckbox.checked=b);this.cInputCheckboxTrue&&(this.cInputCheckboxTrue.checked=b);this.cInputCheckboxFalse&&(this.cInputCheckboxFalse.checked=!b)};b.prototype.update=function(b){var a=this;this.pushToValueStack(b);
this.currentValue=b;this.cInputCheckbox&&(this.cInputCheckbox.checked=b);this.cInputCheckboxTrue&&(this.cInputCheckboxTrue.checked=b);this.cInputCheckboxFalse&&(this.cInputCheckboxFalse.checked=!b);this.disableIds&&0<this.disableIds.length&&this.controlsContext.controls.filter(function(b){return a.disableIds.includes(b.id)},this).forEach(function(c){return c.disable(b===a.disableOn)},this);return!0};return b}(module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.MenuComponent);var module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input={default:{}},__extends$$module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input=this&&module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&
(b[c]=a[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__importDefault$$module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input=this&&module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input.default.__importDefault||function(a){return a&&a.__esModule?a:{"default":a}};
Object.defineProperty(module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input.default,"__esModule",{value:!0});
var sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input=__importDefault$$module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input(module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default),sd_controls_components_util_util_1$$module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input=__importDefault$$module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input(module$src$api$apps$sd_controls$components$util$sd_controls_components_util_util.default),
sd_controls_components_base_1$$module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input=module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default,toTinyColor_1$$module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input=__importDefault$$module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input(module$src$shared$util$toTinyColor.default);
module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input.default.ColorInputMenuComponent=function(a){function b(b,d,e,f,h){var c=a.call(this,d,e,f,h)||this;d=e.defval;d=toTinyColor_1$$module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input.default(d);f.useSpectrum?(c.inputComponent=sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input.default.createDomElement("input",
{id:c.slugId+"-color",parent:c.inputContainer,classList:["uk-hidden"],attributes:{name:c.slugId+"-color"}}),c.inputComponent.setAttribute("type","text"),c.pushToValueStack(d.toRgbString()),$("#"+c.slugId+"-color").spectrum({color:d.toRgbString(),replacerClassName:"uk-padding-remove",showInput:!0,showInitial:!0,preferredFormat:"rgb",change:function(b){c.inputComponent.setAttribute("value",b.toHexString());b=document.createEvent("Event");b.initEvent("change",!1,!0);c.inputComponent.dispatchEvent(b)}}),
c.colorPicker=c.row.getElementsByClassName("sp-replacer")[0]):(c.inputComponent=sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input.default.createDomElement("input",{id:c.slugId+"-color",parent:c.inputContainer,classList:["uk-input","uk-form-small","uk-form-width-xsmall"],attributes:{name:c.slugId+"-color"}}),c.inputComponent.setAttribute("type","color"),c.inputComponent.value=d.toHexString(),c.pushToValueStack(c.inputComponent.value),
c.colorPicker=c.inputComponent);c.valueConversion=e.valueConversion?e.valueConversion:"value";sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input.default.setDomElementEventListener(f.api,b,c,c.inputComponent,"change",c.update.bind(c),10,null);return c}__extends$$module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input(b,a);b.prototype.hide=function(b){a.prototype.hide.call(this,b);
this.colorPicker&&sd_controls_components_util_util_1$$module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input.default.hide(this.colorPicker,b)};b.prototype.update=function(b){b=toTinyColor_1$$module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input.default(b);"color"===this.inputComponent.type?(this.inputComponent.value=b.toHexString(),this.pushToValueStack(this.inputComponent.value),this.currentValue=this.inputComponent.value):
(b=b.toRgbString(),this.pushToValueStack(b),this.currentValue=b,$("#"+this.slugId+"-color").spectrum("set",b));return!0};b.prototype.onSettingUpdate=function(b){this.update(b)};return b}(module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.MenuComponent);var module$src$api$apps$sd_controls$components$component_button$sd_controls_components_button_input={default:function(a,b,c,d,e){module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.MenuComponent.call(this,b,c,d,e);b=c.name;this.row.removeChild(this.label);this.inputComponent=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("button",{id:this.slugId+"_button",parent:this.inputContainer,innerHTML:b,classList:"uk-button uk-button-default uk-button-small uk-width-expand text-transform-none uk-padding-remove sd-control-button".split(" "),
attributes:{type:"button",name:this.slugId+"_button"}});this.valueConversion=c.valueConversion?c.valueConversion:"none";(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener)(d.api,a,this,this.inputComponent,"click",this.update.bind(this))}},MenuComponent$$module$src$api$apps$sd_controls$components$component_button$sd_controls_components_button_input=module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.MenuComponent,
createDOMElement$$module$src$api$apps$sd_controls$components$component_button$sd_controls_components_button_input=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement,setDomElementEventListener$$module$src$api$apps$sd_controls$components$component_button$sd_controls_components_button_input=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener;
module$src$api$apps$sd_controls$components$component_button$sd_controls_components_button_input.default.prototype=Object.create(module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.MenuComponent.prototype);module$src$api$apps$sd_controls$components$component_button$sd_controls_components_button_input.default.prototype.update=function(){return this.inContentEditMode?!1:!0};
module$src$api$apps$sd_controls$components$component_button$sd_controls_components_button_input.default.prototype.setEditable=function(a){a?(this.inputComponent.contentEditable=!0,this.inputComponent.addEventListener("input",function(b){this.wasEdited=!0;this.newName=b.target.innerText}.bind(this))):this.inputComponent.removeAttribute("disabled");this.inContentEditMode=a};var module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input={default:{}},__extends$$module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input=this&&module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&
(b[c]=a[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__importDefault$$module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input=this&&module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input.default.__importDefault||function(a){return a&&a.__esModule?a:{"default":a}};
Object.defineProperty(module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input.default,"__esModule",{value:!0});
var sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input=__importDefault$$module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input(module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default),sd_controls_components_base_1$$module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input=module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default,
interfaces_1$$module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input=module$src$interfaces$api$apps$sd_controls$interfaces.default;
module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input.default.DropdownInputMenuComponent=function(a){function b(b,d,e,f,h){d=a.call(this,d,e,f,h)||this;d.choices=e.choices;h=e.defval;d.inputComponent=sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input.default.createDomElement("select",{id:d.slugId+"-form",parent:d.inputContainer,classList:["uk-select","uk-form-small",
"uk-width-expand"]});d.valueConversion=e.valueConversion?e.valueConversion:"selectedIndex";sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input.default.setDomElementEventListener(f.api,b,d,d.inputComponent,"change",d.update.bind(d));d.createChoices(d.choices,d.valueConversion.i?d.valueConversion.i(d,h):h);e.registerMenuElement&&e.registerMenuElement(d);return d}__extends$$module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input(b,
a);b.prototype.createChoices=function(b,a){this.choices=b;this.inputComponent.innerHTML="";for(var c=0;c<this.choices.length;c++)this["cOption"+c]=sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input.default.createDomElement("option",{id:this.slugId+"-option-"+c,parent:this.inputComponent,innerHTML:b[c],value:c,classList:[],attributes:{name:this.slugId+"-option-"+c,selected:c==a}});this.inputComponent.value=a.toString()};
b.prototype.onSettingUpdate=function(b){a.prototype.onSettingUpdate.call(this,b);this.customUpdate&&(this.currentValue=this.choices[b],this.controlsContext.controlsEvents.trigger(module$src$interfaces$api$apps$sd_controls$interfaces.default.LightEvents.DROPDOWN_CUSTOM_UPDATE,this))};b.prototype.update=function(b){this.pushToValueStack(b);this.currentValue=this.inputComponent.value=b;for(var a=0;a<this.choices.length;a++)this["cOption"+a].selected=a===b?!0:!1;return!0};return b}(module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.MenuComponent);var module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu={default:function(a,b,c,d,e){module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.MenuComponent.call(this,b,c,d,e);b=c.choices;e=c.defval;var f,h;this.pushToValueStack(e);this.cForm=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("form",{id:this.slugId+"-form",parent:this.inputContainer,classList:[STRING_SDVCP$$module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu+
"dropdown-input-form",STRING_SDVCPC$$module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu]});this.inputComponent=[];var g=0;for(h=b.length;g<h;++g){var k=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("div",{parent:this.cForm});k=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("label",{id:this.slugId+"-label-"+g,parent:k,innerHTML:b[g],
classList:[STRING_SDVCP$$module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu+"checklist-input-checkbox-label"]});var l=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("input",{id:this.slugId+"-checkbox-"+g,parent:k,innerHTML:b[g],value:g,attributes:{type:"checkbox",name:this.slugId+"-checkbox-"+g}});(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("div",
{id:this.slugId+"-checkbox-helper",parent:k,classList:STRING_SDVCP$$module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu+"checklist-input-boxhelper",attributes:{"for":this.slugId+"-checkbox-"+g}});l.checked=e.includes(g);this.inputComponent.push(l);this.valueConversion=c.valueConversion?c.valueConversion:function(){var b=[];for(f=0;f<this.inputComponent.length;++f)this.inputComponent[f].checked&&b.push(f);return b};(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener)(d.api,
a,this,l,"change",this.update.bind(this))}}},createDOMElement$$module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement,setDomElementEventListener$$module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener,
controlsUtil$$module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu=module$src$api$apps$sd_controls$components$util$sd_controls_components_util_util.default,MenuComponent$$module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu=module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.MenuComponent,STRING_SDVCP$$module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu=
"sdv-control-panel-",STRING_SDVCPC$$module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu="sdv-control-panel-control";module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu.default.prototype=Object.create(module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.MenuComponent.prototype);
module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu.default.prototype.hide=function(a){this.hidden=a;module$src$api$apps$sd_controls$components$util$sd_controls_components_util_util.default.hide(this.cForm,a)};
module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu.default.prototype.update=function(a){this.pushToValueStack(a);this.currentValue=a;for(var b=0,c=this.inputComponent.length;b<c;++b)this.inputComponent[b].checked=a.includes(b);return!0};var module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file={default:function(a,b,c,d,e){module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.MenuComponent.call(this,b,c,d,e);log$$module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file.showMessage=d.options&&d.options.showMessage?d.options.showMessage:function(){};b=c.name;var f=null;this.label.innerHTML="Select file\u2026";this.inputComponent=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("button",
{id:this.slugId+"_button",parent:this.inputContainer,innerHTML:b,classList:"uk-button uk-button-default uk-button-small uk-width-expand text-transform-none uk-padding-remove sd-control-button".split(" "),attributes:{type:"button",name:this.slugId+"_button"}});this.fileinput=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement)("input",{id:this.slugId+"_fileinput",parent:this.inputContainer,style:"display:none",accept:c.format.join(","),attributes:{type:"file",
name:this.slugId+"_fileinput"}});this.fileinput.style.display="none";this.inputComponent.addEventListener("click",function(){this.fileinput.click()}.bind(this));this.valueConversion=function(b,a){return f&&0<f.length?(b=f[0],f=null,b):0<a.files.length?a.files[0]:""};this.checkMimeType=function(b){return c.format.includes(b)};this.getParamDef=function(){return c};this.checkSize=function(b){return b<=c.max};this.clear=function(){f=null;this.pushToValueStack(null);this.currentValue=null;0<this.fileinput.files.length?
this.fileinput.value=null:this.change_handler()};this.change_handler=(0,module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener)(d.api,a,this,this.fileinput,"change",this.update.bind(this));a=function(b){b.stopPropagation();b.preventDefault()};this.inputComponent.addEventListener("dragenter",a,!1);this.inputComponent.addEventListener("dragover",a,!1);this.inputComponent.addEventListener("drop",function(b){b.stopPropagation();b.preventDefault();
b.dataTransfer&&(f=b.dataTransfer.files);this.change_handler()},!1)}},createDOMElement$$module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement,setDomElementEventListener$$module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.setDomElementEventListener,
GLOBAL_UTILS$$module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file=module$src$shared$util$GlobalUtils.default,MenuComponent$$module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file=module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.MenuComponent,log$$module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file={showMessage:function(){}};
module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file.default.prototype=Object.create(module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.MenuComponent.prototype);module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file.default.prototype.uploadError=function(){this.label.innerHTML="upload failed";this.label.classList.add("uk-text-danger")};
module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file.default.prototype.removeUploadError=function(){this.label.innerHTML="";this.label.classList.remove("uk-text-danger")};
module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file.default.prototype.update=function(a){var b=this;if(this.inContentEditMode)return!1;this.pushToValueStack(a);this.currentValue=a;if(a instanceof File){a._type=0<a.type.length?a.type:module$src$shared$util$GlobalUtils.default.guessMimeTypeFromFilename(a.name);if(!this.checkMimeType(a._type))return this.uploadError(),log$$module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file.showMessage("warning",
"Allowed file types: "+this.getParamDef().format.join(", ")),!1;if(!this.checkSize(a.size))return this.uploadError(),log$$module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file.showMessage("warning","Maximum file size: "+this.getParamDef().max+" bytes"),!1;this.removeUploadError();this.label.innerHTML='<div uk-spinner="ratio: 0.5"></div>';this.fileName=a.name}else"string"===typeof a&&0<a.length?(this.label.innerHTML=this.fileName?22<this.fileName.length?this.fileName.substr(0,
20)+"... \u274c":this.fileName+"  \u274c":"Saved file  \u274c",this.label.onclick=function(){b.clear()}):(this.label.innerHTML="Select file\u2026",this.label.onclick=null);return!0};
module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file.default.prototype.setEditable=function(a){a?(this.inputComponent.contentEditable=!0,this.inputComponent.addEventListener("input",function(b){this.wasEdited=!0;this.newName=b.target.innerText}.bind(this))):this.inputComponent.contentEditable=!1;this.inContentEditMode=a};var module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion={default:{}},__extends$$module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion=this&&module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&
(b[c]=a[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__awaiter$$module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion=this&&module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion.default.__awaiter||function(a,b,c,d){function e(b){return b instanceof c?b:new c(function(a){a(b)})}return new (c||(c=Promise))(function(c,
h){function f(b){try{l(d.next(b))}catch(n){h(n)}}function k(b){try{l(d["throw"](b))}catch(n){h(n)}}function l(b){b.done?c(b.value):e(b.value).then(f,k)}l((d=d.apply(a,b||[])).next())})},__generator$$module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion=this&&module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion.default.__generator||function(a,b){function c(b){return function(a){return d([b,a])}}function d(c){if(f)throw new TypeError("Generator is already executing.");
for(;e;)try{if(f=1,h&&(g=c[0]&2?h["return"]:c[0]?h["throw"]||((g=h["return"])&&g.call(h),0):h.next)&&!(g=g.call(h,c[1])).done)return g;if(h=0,g)c=[c[0]&2,g.value];switch(c[0]){case 0:case 1:g=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(g=e.trys,g=0<g.length&&g[g.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3]))e.label=c[1];else if(6===c[0]&&e.label<g[1])e.label=
g[1],g=c;else if(g&&e.label<g[2])e.label=g[2],e.ops.push(c);else{g[2]&&e.ops.pop();e.trys.pop();continue}}c=b.call(a,e)}catch(m){c=[6,m],h=0}finally{f=g=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},f,h,g,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k},__importDefault$$module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion=
this&&module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion.default.__importDefault||function(a){return a&&a.__esModule?a:{"default":a}};Object.defineProperty(module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion.default,"__esModule",{value:!0});
var sd_controls_components_dom_dom_util_js_1$$module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion=__importDefault$$module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion(module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default),sd_controls_components_base_js_1$$module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion=module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default;
module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion.default.AccordionInputMenuComponent=function(a){function b(b,d,e,f,h){b=a.call(this,d,e,f,h)||this;b.rows=[];return b}__extends$$module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion(b,a);b.prototype.close=function(){return __awaiter$$module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion(this,void 0,void 0,function(){var b,
a=this;return __generator$$module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion(this,function(c){switch(c.label){case 0:return[4,this.isOpen()];case 1:return b=c.sent(),[2,new Promise(function(c){b&&UIkit.accordion(a.parametersEl.parentNode).toggle(0);c()})]}})})};b.prototype.createRow=function(b,a,e){var c=this;this.rowId=this.slugId+"-controlmenu-row";this.row=sd_controls_components_dom_dom_util_js_1$$module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion.default.createDomElement("div",
{id:this.rowId,name:this.rowId,parent:e||this.controlsContext.container,classList:["uk-margin-remove","uk-padding-remove","sd-max-width-1"],attributes:{"uk-grid":'margin: "";'}});this.ulElem=sd_controls_components_dom_dom_util_js_1$$module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion.default.createDomElement("ul",{parent:this.row,attributes:{"uk-accordion":"multiple: false"},classList:["uk-width-1-1"]});this.parametersEl=sd_controls_components_dom_dom_util_js_1$$module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion.default.createDomElement("li",
{parent:this.ulElem,classList:["jq-accordion-control-li"],attributes:{"data-setting-type":a.type}});this.ulElem.onclick=function(b){c.closeOthers();if(a.onClick)a.onClick(c)};e=this.slugId+"-multiple-remove";this.label=sd_controls_components_dom_dom_util_js_1$$module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion.default.createDomElement("a",{id:this.slugId+"-a",parent:this.parametersEl,innerHTML:(this.param.isSettingRemovable?'<span id="'+e+'" uk-icon="icon: close; ratio: 0.8;"></span>':
"")+" "+a.name,classList:"uk-accordion-title uk-width-expand uk-form-label uk-text-uppercase uk-text-small uk-padding-small sdv-control-panel-row-border".split(" "),attributes:{for:"slider"===this.slugId+"-"+b?"range":b,"param-id":a.id}});this.param.isSettingRemovable&&document.getElementById(e).addEventListener("click",function(){return c.removeDiv()});this.accordionContent=sd_controls_components_dom_dom_util_js_1$$module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion.default.createDomElement("div",
{parent:this.parametersEl,classList:["uk-accordion-content","uk-margin-remove"],attributes:{"uk-grid":""}});this.controlsContext.options&&this.controlsContext.options.editMode&&this.label.classList.remove("sdv-edit-mode");a.registerMenuElement&&a.registerMenuElement(this)};b.prototype.createSubElements=function(b){var a=this,c=this.param;Object.keys(c.settings).forEach(function(d){d=b(c.settings[d].type,c.settings[d],a.controlsContext,a.accordionContent);a.rows.push(d);d.label.classList.add("uk-margin-small-left");
d.label.classList.remove("uk-text-uppercase");d.inputComponent?d.inputComponent.classList.add("uk-margin-small-left"):d.container?d.container.classList.add("uk-margin-small-left"):d.inputContainer&&d.inputContainer.classList.add("uk-margin-small-left");d.colorPicker&&d.colorPicker.classList.add("uk-margin-small-left")})};b.prototype.closeOthers=function(){var b=this;Array.from(document.getElementsByClassName("jq-accordion-control-li")).forEach(function(a){a.getAttribute("data-setting-type")!=b.param.type||
b.parametersEl.isSameNode(a)||a.classList.contains("uk-open")&&UIkit.accordion(a.parentNode).toggle(0)})};b.prototype.isOpen=function(){return __awaiter$$module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion(this,void 0,void 0,function(){var b=this;return __generator$$module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion(this,function(a){return[2,new Promise(function(a){window.setTimeout(function(){return a(b.parametersEl.classList.contains("uk-open"))},
50)})]})})};b.prototype.open=function(){return __awaiter$$module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion(this,void 0,void 0,function(){return __generator$$module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion(this,function(b){switch(b.label){case 0:return this.closeOthers(),[4,this.isOpen()];case 1:return b.sent()||UIkit.accordion(this.parametersEl.parentNode).toggle(0),[2,new Promise(function(b){return b()})]}})})};
b.prototype.removeDiv=function(){document.getElementById(this.rowId).remove();this.param.remove()};return b}(module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.MenuComponent);var module$src$api$apps$sd_controls$components$component_vector3$sd_controls_components_vector3_input={default:{}},__extends$$module$src$api$apps$sd_controls$components$component_vector3$sd_controls_components_vector3_input=this&&module$src$api$apps$sd_controls$components$component_vector3$sd_controls_components_vector3_input.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&
(b[c]=a[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__importDefault$$module$src$api$apps$sd_controls$components$component_vector3$sd_controls_components_vector3_input=this&&module$src$api$apps$sd_controls$components$component_vector3$sd_controls_components_vector3_input.default.__importDefault||function(a){return a&&a.__esModule?a:{"default":a}};
Object.defineProperty(module$src$api$apps$sd_controls$components$component_vector3$sd_controls_components_vector3_input.default,"__esModule",{value:!0});
var sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_vector3$sd_controls_components_vector3_input=__importDefault$$module$src$api$apps$sd_controls$components$component_vector3$sd_controls_components_vector3_input(module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default),sd_controls_components_base_1$$module$src$api$apps$sd_controls$components$component_vector3$sd_controls_components_vector3_input=module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default;
module$src$api$apps$sd_controls$components$component_vector3$sd_controls_components_vector3_input.default.Vector3InputMenuComponent=function(a){function b(b,d,e,f,h){b=a.call(this,d,e,f,h)||this;b.valueConversion="value";b.min=e.min;b.max=e.max;b.step=e.step;b.decimalPlaces=e.decimalPlaces;d=e.defval;b.defval=d;b.currentValue=d;b._previousValue={};Object.assign(b._previousValue,b.currentValue);b.inputContainer.setAttribute("uk-grid","");b.xContainer=sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_vector3$sd_controls_components_vector3_input.default.createDomElement("div",
{classList:["uk-width-3-3","uk-padding-remove-left","vector3-container","uk-form-custom"],parent:b.inputContainer});b.cInputNumberXLabel=sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_vector3$sd_controls_components_vector3_input.default.createDomElement("label",{parent:b.xContainer,innerHTML:"X",classList:["vector3-label"],attributes:{for:b.slugId+"-number-x"}});b.cInputNumberX=b.createMenuInputElement("x",b.xContainer);b.yContainer=sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_vector3$sd_controls_components_vector3_input.default.createDomElement("div",
{classList:["uk-width-3-3","uk-padding-remove-left","vector3-container","uk-form-custom"],parent:b.inputContainer});b.cInputNumberYLabel=sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_vector3$sd_controls_components_vector3_input.default.createDomElement("label",{parent:b.yContainer,innerHTML:"Y",classList:["vector3-label"],attributes:{for:b.slugId+"-number-y"}});b.cInputNumberY=b.createMenuInputElement("y",b.yContainer);b.zContainer=sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_vector3$sd_controls_components_vector3_input.default.createDomElement("div",
{classList:["uk-width-3-3","uk-padding-remove-left","vector3-container","uk-form-custom"],parent:b.inputContainer});b.cInputNumberZLabel=sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_vector3$sd_controls_components_vector3_input.default.createDomElement("label",{parent:b.zContainer,innerHTML:"Z",classList:["vector3-label"],attributes:{for:b.slugId+"-number-z"}});b.cInputNumberZ=b.createMenuInputElement("z",b.zContainer);b.cInputNumberX.value=d.x.toFixed(b.decimalPlaces);
b.cInputNumberY.value=d.y.toFixed(b.decimalPlaces);b.cInputNumberZ.value=d.z.toFixed(b.decimalPlaces);b.setChangeEventListener(b.cInputNumberX);b.setFocusOutEventListener(b.cInputNumberX);b.setKeyUpEventListener(b.cInputNumberX);b.setChangeEventListener(b.cInputNumberY);b.setFocusOutEventListener(b.cInputNumberY);b.setKeyUpEventListener(b.cInputNumberY);b.setChangeEventListener(b.cInputNumberZ);b.setFocusOutEventListener(b.cInputNumberZ);b.setKeyUpEventListener(b.cInputNumberZ);e.registerMenuElement(b);
return b}__extends$$module$src$api$apps$sd_controls$components$component_vector3$sd_controls_components_vector3_input(b,a);b.prototype.onSettingUpdate=function(b){this.cInputNumberX.value=b.x.toFixed(this.decimalPlaces);this.cInputNumberY.value=b.y.toFixed(this.decimalPlaces);this.cInputNumberZ.value=b.z.toFixed(this.decimalPlaces)};b.prototype.update=function(b,a){return!0};b.prototype.createMenuInputElement=function(b,a){var c={type:"number",name:this.slugId+"-number-"+b,"data-component":b};this.step&&
(c.step=this.step);this.min&&(c.min=this.min);this.max&&(c.max=this.max);return sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_vector3$sd_controls_components_vector3_input.default.createDomElement("input",{id:this.slugId+"-number-"+b,parent:a,value:this.defval[b],classList:["uk-input","uk-form-small","sd-input-number","uk-width-2-3"],attributes:c})};b.prototype.formatValue=function(b){return parseFloat(b)};b.prototype.parameterValidation=function(b,a){var c=
b.val1;c=this.formatValue(c);a=a.srcElement.getAttribute("data-component");this.currentValue[a]=c;this["cInputNumber"+a.toUpperCase()].value=c;if(this._previousValue[a]==this.currentValue[a])return!1;b.val1=c;b.val2=c;this._previousValue[a]=this.currentValue[a];return!0};b.prototype.setChangeEventListener=function(b){var a=sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_vector3$sd_controls_components_vector3_input.default.isEventSupported("input","input")?
"input":"change";sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_vector3$sd_controls_components_vector3_input.default.setDomElementEventListener(this.controlsContext.api,this.id,this,b,a,this.update.bind(this),1E3,this.parameterValidation.bind(this))};b.prototype.setFocusOutEventListener=function(b){this.controlsContext.api;this.id;this;b;"focusout";this.update.bind(this);10;this.parameterValidation.bind(this)};b.prototype.setKeyUpEventListener=function(b){sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_vector3$sd_controls_components_vector3_input.default.setDomElementEventListener(this.controlsContext.api,
this.id,this,b,"keyup",this.updateKeyUp.bind(this),10,this.parameterValidation.bind(this))};b.prototype.updateKeyUp=function(b,a){if(a.which||a.keyCode)return 13==a.which||13==a.keyCode};return b}(module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.MenuComponent);var module$src$api$apps$sd_controls$components$component_modal$ModalInputMenuComponent={default:{}},__extends$$module$src$api$apps$sd_controls$components$component_modal$ModalInputMenuComponent=this&&module$src$api$apps$sd_controls$components$component_modal$ModalInputMenuComponent.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return a(b,c)};return function(b,
c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__importDefault$$module$src$api$apps$sd_controls$components$component_modal$ModalInputMenuComponent=this&&module$src$api$apps$sd_controls$components$component_modal$ModalInputMenuComponent.default.__importDefault||function(a){return a&&a.__esModule?a:{"default":a}};
Object.defineProperty(module$src$api$apps$sd_controls$components$component_modal$ModalInputMenuComponent.default,"__esModule",{value:!0});
var sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_modal$ModalInputMenuComponent=__importDefault$$module$src$api$apps$sd_controls$components$component_modal$ModalInputMenuComponent(module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default),sd_controls_components_base_js_1$$module$src$api$apps$sd_controls$components$component_modal$ModalInputMenuComponent=module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default;
module$src$api$apps$sd_controls$components$component_modal$ModalInputMenuComponent.default.ModalInputMenuComponent=function(a){function b(b,d,e,f,h){var c=a.call(this,d,e,f,h)||this;c._param=e;if(!e.modalId)throw Error("Mising modal id.");if(!e.modalContent)throw Error("Missing modal content.");if(!e.modalConfirmId)throw Error("Missing modal confirm id.");b=e.name;c.row.removeChild(c.label);c.modal=sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_modal$ModalInputMenuComponent.default.createDomElement("div",
{id:e.modalId,parent:document.getElementsByTagName("body")[0],innerHTML:e.modalContent,attributes:{"uk-modal":""}});c.inputComponent=sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$components$component_modal$ModalInputMenuComponent.default.createDomElement("button",{id:c.slugId+"_button",parent:c.inputContainer,innerHTML:b,classList:"uk-button uk-button-default uk-button-small uk-width-expand text-transform-none uk-padding-remove sd-control-button".split(" "),attributes:{type:"button",
name:c.slugId+"_button","uk-toggle":"target: #"+e.modalId}});c.inputComponent.addEventListener("click",function(){if(c.onModalOpen)c.onModalOpen(c.modal);c.registerModelConfirmClick(e.modalConfirmId)});e.registerMenuElement&&e.registerMenuElement(c);c.valueConversion=e.valueConversion?e.valueConversion:"none";return c}__extends$$module$src$api$apps$sd_controls$components$component_modal$ModalInputMenuComponent(b,a);b.prototype.rebindConfirmEvent=function(){this.registerModelConfirmClick(this._param.modalConfirmId)};
b.prototype.registerModelConfirmClick=function(b){var a=this;document.getElementById(b).onclick=function(){a.customUpdate(null,null,null,a);a.registerModelConfirmClick(b)}};return b}(module$src$api$apps$sd_controls$components$base$sd_controls_components_base.default.MenuComponent);var module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory={default:{}};
module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory.default.createMenuElement=function(a,b,c,d){void 0===d&&(d=null);if(!c.api)throw Error("Controls context needs to have api property.");if(!c.container)throw Error("Controls context needs to have container property.");if(!c.plugins)throw Error("Controls context needs to have plugins property.");if(!c.runtimeId)throw Error("Controls context needs to have runtimeId property.");a=new MenuElementConstructors$$module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory[a](c.options&&
c.options.settings?b.setting:b.id,a,b,c,d);a instanceof module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion.default.AccordionInputMenuComponent&&a.createSubElements(module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory.default.createMenuElement);c.controls.push(a);return a};Object.defineProperty(module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory.default,"__esModule",{value:!0});
var sd_controls_components_slider_1$$module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory=module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider.default,sd_controls_components_string_input_1$$module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory=module$src$api$apps$sd_controls$components$component_string$sd_controls_components_string_input.default,BooleanCom$$module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory=
module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default,sd_controls_components_color_input_1$$module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory=module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input.default,Button$$module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory=module$src$api$apps$sd_controls$components$component_button$sd_controls_components_button_input.default,
sd_controls_components_dropdown_input_1$$module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory=module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input.default,Form$$module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory=module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu.default,FileCom$$module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory=
module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file.default,sd_controls_components_accordion_1$$module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory=module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion.default,sd_controls_components_vector3_input_1$$module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory=module$src$api$apps$sd_controls$components$component_vector3$sd_controls_components_vector3_input.default,
ModalInputMenuComponent_1$$module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory=module$src$api$apps$sd_controls$components$component_modal$ModalInputMenuComponent.default,MenuElementConstructors$$module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory={slider:module$src$api$apps$sd_controls$components$component_slider$sd_controls_components_slider.default.SliderInputMenuComponent,string:module$src$api$apps$sd_controls$components$component_string$sd_controls_components_string_input.default.StringInptMenuComponent,
boolean:module$src$api$apps$sd_controls$components$component_boolean$sd_controls_components_boolean_input.default.BooleanInputMenuComponent,color:module$src$api$apps$sd_controls$components$component_color$sd_controls_components_color_input.default.ColorInputMenuComponent,button:module$src$api$apps$sd_controls$components$component_button$sd_controls_components_button_input.default,dropdown:module$src$api$apps$sd_controls$components$component_dropdown$sd_controls_components_dropdown_input.default.DropdownInputMenuComponent,
form:module$src$api$apps$sd_controls$components$component_checklist$sd_controls_components_checklist_menu.default,file:module$src$api$apps$sd_controls$components$component_file$sd_controls_components_file.default,multiple:module$src$api$apps$sd_controls$components$component_accordion$sd_controls_components_accordion.default.AccordionInputMenuComponent,vector3:module$src$api$apps$sd_controls$components$component_vector3$sd_controls_components_vector3_input.default.Vector3InputMenuComponent,modal:module$src$api$apps$sd_controls$components$component_modal$ModalInputMenuComponent.default.ModalInputMenuComponent};var module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_scene_load_dropdown={default:{}},__extends$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_scene_load_dropdown=this&&module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_scene_load_dropdown.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&
(b[c]=a[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_scene_load_dropdown.default,"__esModule",{value:!0});
var sd_controls_menu_element_factory_1$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_scene_load_dropdown=module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory.default,sd_controls_constants_types_1$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_scene_load_dropdown=module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default,sd_controls_setting_1$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_scene_load_dropdown=
module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default,interfaces_1$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_scene_load_dropdown=module$src$interfaces$api$apps$sd_controls$interfaces.default;
module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_scene_load_dropdown.default.LoadLightSceneDropdownSetting=function(a){function b(b,d,e){b=a.call(this,b,"lights.lightScene",module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.DROPDOWN,"Load Light Scene","Load one of the stored light scene definitions",module$src$interfaces$api$apps$sd_controls$interfaces.default.SettingsGroups.LIGHTS,Number.POSITIVE_INFINITY)||this;b.controlsContext=d;b.settingsContext=
e;b.createInitalLightsCalled=!1;b.valueConversion={update:"selectedIndex",f:function(b,a){return a.options[a.selectedIndex].innerHTML},i:function(b,a){return b.choices.indexOf(a)}};b.choices=b.api.scene.lights.getAllLightScenes().data;return b}__extends$$module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_scene_load_dropdown(b,a);b.prototype.createLightElements=function(){if(!this.createInitalLightsCalled){this.createInitalLightsCalled=!0;this.controlsContext.controlsEvents.trigger(module$src$interfaces$api$apps$sd_controls$interfaces.default.LightEvents.CLEAR_LIGHTS);
this.choices=this.api.scene.lights.getAllLightScenes().data;for(var b=this.api.scene.lights.getLightScene().data.id,a=0,e=this.getMenuElements();a<e.length;a++){var f=e[a];this.choices.includes(b)&&f.createChoices(this.choices,this.valueConversion.i(f,b))}this.createLights(b)}};b.prototype.customUpdate=function(b,a,e,f){this.controlsContext.controlsEvents.trigger(module$src$interfaces$api$apps$sd_controls$interfaces.default.LightEvents.CLEAR_LIGHTS);this.choices=b=this.api.scene.lights.getAllLightScenes().data;
f.createChoices(b,this.valueConversion.i(f,a));this.createLights(a)};b.prototype.createLights=function(b){var a=this,c=[];this.choices.includes(b)?(this.api.scene.lights.setLightSceneFromID(b).data,c=this.api.scene.lights.getLightScene(b).data.lights):c=this.api.scene.lights.getLightScene().data.lights;Object.keys(c).forEach(function(b){b=c[b];var d=a.settingsContext.createLightSetting(b);a.settingsContext.settings[b.id]=d;b=module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory.default.createMenuElement(d.type,
d,a.controlsContext,a.controlsContext.groups.getGroup(d.groupId));b.row.parentNode.insertBefore(b.row,a.settingsContext.settings["add.lights.scene"].getMenuElements()[0].row);a.controlsContext.controlsEvents.trigger(module$src$interfaces$api$apps$sd_controls$interfaces.default.LightEvents.ADD,b)})};return b}(module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting);var module$src$api$apps$sd_controls$settings$lights$AddLightModalSetting={default:{}},__extends$$module$src$api$apps$sd_controls$settings$lights$AddLightModalSetting=this&&module$src$api$apps$sd_controls$settings$lights$AddLightModalSetting.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return a(b,c)};return function(b,c){function d(){this.constructor=
b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$settings$lights$AddLightModalSetting.default,"__esModule",{value:!0});
var sd_controls_constants_types_1$$module$src$api$apps$sd_controls$settings$lights$AddLightModalSetting=module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default,sd_controls_settings_html_helpers_1$$module$src$api$apps$sd_controls$settings$lights$AddLightModalSetting=module$src$api$apps$sd_controls$settings$sd_controls_settings_html_helpers.default,sd_controls_menu_element_factory_1$$module$src$api$apps$sd_controls$settings$lights$AddLightModalSetting=module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory.default,
sd_controls_setting_1$$module$src$api$apps$sd_controls$settings$lights$AddLightModalSetting=module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default,interfaces_1$$module$src$api$apps$sd_controls$settings$lights$AddLightModalSetting=module$src$interfaces$api$apps$sd_controls$interfaces.default;
module$src$api$apps$sd_controls$settings$lights$AddLightModalSetting.default.AddLightModalSetting=function(a){function b(b,d,e){b=a.call(this,b,"scene.add.light",module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.MODAL,"Add Light","Define a new light source in the scene",module$src$interfaces$api$apps$sd_controls$interfaces.default.SettingsGroups.LIGHTS,Number.POSITIVE_INFINITY,null,!0)||this;b.controlsContext=d;b.settingsContext=e;b.modalConfirmId="jq-add-light-modal-confirm";
b.modalId="jq-add-light-modal";b.defval=!1;b.modalContent=b.getModalString();return b}__extends$$module$src$api$apps$sd_controls$settings$lights$AddLightModalSetting(b,a);b.prototype.customUpdate=function(b,a,e,f){b=document.getElementById("jq-add-light-name").value;a=document.getElementById("jq-add-light-alert");b?(a&&(a.innerHTML=""),a=document.getElementById("jq-add-light-type").value,b=this.resolveNameIfDuplicate(b),this.api.scene.lights.updateLight({id:b,type:this.api.scene.lights.LIGHTTYPE[a],
properties:{}}),b=this.api.scene.lights.getLight(b).data,a=this.settingsContext.createLightSetting(b),this.settingsContext.settings[b.id]=a,a=module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory.default.createMenuElement(a.type,a,this.controlsContext,this.controlsContext.groups.getGroup(a.groupId)),a.row.parentNode.insertBefore(a.row,f.row),this.controlsContext.controlsEvents.trigger(module$src$interfaces$api$apps$sd_controls$interfaces.default.LightEvents.ADD,a),UIkit.modal(document.getElementById("jq-add-light-modal")).hide(),
this.settingsContext.settings[b.id].getMenuElements().forEach(function(b){return b.open()}),this.controlsContext.shapeDiverDragControls.makeLightDraggableAndZoomAsync(b.id),window.setTimeout(this.setNameFieldAccordingToSelectedType.bind(this),2E3)):a&&(a.innerHTML=module$src$api$apps$sd_controls$settings$sd_controls_settings_html_helpers.default.HTMLSettingsHelper.createAlert("Please specify a name for the new light"))};b.prototype.registerMenuElement=function(b){a.prototype.registerMenuElement.call(this,
b);this.bindLightTypeChangeEvent()};b.prototype.setNameFieldAccordingToSelectedType=function(){var b=document.getElementById("jq-add-light-type");document.getElementById("jq-add-light-name").value=this.resolveNameIfDuplicate(b.value)};b.prototype.bindLightTypeChangeEvent=function(){var b=this;document.getElementById("jq-add-light-type").onchange=function(){return b.setNameFieldAccordingToSelectedType()};this.setNameFieldAccordingToSelectedType()};b.prototype.getModalString=function(){return'\n    <div class="uk-modal-dialog uk-modal-body">\n\n    <h2 class="uk-modal-title">Add Light</h2>\n\n      <form class="uk-form-horizontal" onsubmit="return false"> \n        <div class="uk-margin">\n          <label class="uk-form-label" for="form-horizontal-select">Type:</label>\n          <div class="uk-form-controls">\n              <select class="uk-select" id="jq-add-light-type">\n                  '+
Object.keys(this.api.scene.lights.LIGHTTYPE).map(function(b){return"<option>"+b+"</option>"}).join("")+'\n              </select>\n          </div>\n        </div>\n        <div class="uk-margin">\n          <label class="uk-form-label" for="form-horizontal-text">Name:</label>\n          <div class="uk-form-controls">\n              <input id="jq-add-light-name" class="uk-input" type="text" placeholder="type name ...">\n          </div>\n        </div>\n        <p class="uk-text-right">\n          <button class="uk-button uk-button-default uk-modal-close" type="button">Cancel</button>\n          <input id="jq-add-light-modal-confirm" class="uk-button uk-button-primary sd-control-button-confirm" type="submit" value="save">\n          <div id="jq-add-light-alert">\n\n          </div>\n        </p>\n      </form>\n    </div>'};
b.prototype.resolveNameIfDuplicate=function(b){if(this.api.scene.lights.getLightScene().data.lights[b]){for(var a=1;this.settingsContext.settings[b+("_"+a)];)a++;b+="_"+a}return b};return b}(module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting);var module$src$api$apps$sd_controls$enums$enums={default:{}};Object.defineProperty(module$src$api$apps$sd_controls$enums$enums.default,"__esModule",{value:!0});var ControlParameterType$$module$src$api$apps$sd_controls$enums$enums;
(function(a){a.STRING="string";a.CHECKBOX="checkbox";a.VECTOR3="vector3";a.BUTTON="button";a.CHECKLIST="checklist";a.GROUP="group";a.COLOR="color";a.DROPDOWN="dropdown";a.FILE="file";a.MODAL="modal";a.SLIDER="slider";a.STATICHTML="statichtml"})(ControlParameterType$$module$src$api$apps$sd_controls$enums$enums=module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType||(module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType={}));var module$src$api$apps$sd_controls$settings$sd_controls_settings={default:{}},__importDefault$$module$src$api$apps$sd_controls$settings$sd_controls_settings=this&&module$src$api$apps$sd_controls$settings$sd_controls_settings.default.__importDefault||function(a){return a&&a.__esModule?a:{"default":a}};Object.defineProperty(module$src$api$apps$sd_controls$settings$sd_controls_settings.default,"__esModule",{value:!0});
var sd_controls_constants_types_1$$module$src$api$apps$sd_controls$settings$sd_controls_settings=module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default,toTinyColor_1$$module$src$api$apps$sd_controls$settings$sd_controls_settings=__importDefault$$module$src$api$apps$sd_controls$settings$sd_controls_settings(module$src$shared$util$toTinyColor.default),sd_controls_settings_light_definition_1$$module$src$api$apps$sd_controls$settings$sd_controls_settings=module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_definition.default,
sd_controls_settings_light_property_1$$module$src$api$apps$sd_controls$settings$sd_controls_settings=module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property.default,CreateSaveLightSceneModalSetting_1$$module$src$api$apps$sd_controls$settings$sd_controls_settings=module$src$api$apps$sd_controls$settings$lights$CreateSaveLightSceneModalSetting.default,sd_controls_settings_light_scene_load_dropdown_1$$module$src$api$apps$sd_controls$settings$sd_controls_settings=module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_scene_load_dropdown.default,
sd_controls_setting_1$$module$src$api$apps$sd_controls$settings$sd_controls_settings=module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default,AddLightModalSetting_1$$module$src$api$apps$sd_controls$settings$sd_controls_settings=module$src$api$apps$sd_controls$settings$lights$AddLightModalSetting.default,enums_1$$module$src$api$apps$sd_controls$settings$sd_controls_settings=module$src$api$apps$sd_controls$enums$enums.default;
module$src$api$apps$sd_controls$settings$sd_controls_settings.default.SDControlsSettings=function(){function a(b,a){this.api=b;this.controlsContext=a;this.settings={};b={"documentation.general":{new:!0,content:'<div class="uk-text-center uk-padding-small uk-width-1-1 uk-background-muted"><span>General&nbsp;<a href="https://www.shapediver.com/support/viewer/settings/general" class="sdv-control-brand-color" target="_blank" uk-icon="icon:question"></a></span></div>',id:"documentation.general",type:module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.STATICHTML,
groupId:1,orderId:0},"documentation.lights":{new:!0,content:'<div class="uk-text-center uk-padding-small uk-width-1-1 uk-background-muted"><span>Lighting&nbsp;<a href="https://www.shapediver.com/support/viewer/settings/lighting" class="sdv-control-brand-color" target="_blank" uk-icon="icon:question"></a></span></div>',id:"documentation.lights",type:module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.STATICHTML,groupId:2,orderId:0},"documentation.environment":{new:!0,content:'<div class="uk-text-center uk-padding-small uk-width-1-1 uk-background-muted"><span>Environment&nbsp;<a href="https://www.shapediver.com/support/viewer/settings/environment" class="sdv-control-brand-color" target="_blank" uk-icon="icon:question"></a></span></div>',
id:"documentation.environment",type:module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.STATICHTML,groupId:3,orderId:0},"documentation.camera":{new:!0,content:'<div class="uk-text-center uk-padding-small uk-width-1-1 uk-background-muted"><span>Camera&nbsp;<a href="https://www.shapediver.com/support/viewer/settings/camera" class="sdv-control-brand-color" target="_blank" uk-icon="icon:question"></a></span></div>',id:"documentation.camera",type:module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.STATICHTML,
groupId:4,orderId:0},"render.shadows":new module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting(b,"render.shadows",module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.BOOLEAN,"Shadows",b.getSettingDefinitions()["scene.render.shadows"].description,1,1),"render.ambientOcclusion":new module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting(b,"render.ambientOcclusion",module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.BOOLEAN,
"Ambient Occlusion",b.getSettingDefinitions()["scene.render.ambientOcclusion"].description,1,2),bumpAmplitude:new module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting(b,"defaultMaterial.bumpAmplitude",module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.SLIDER,"Bump Amplitude",b.getSettingDefinitions()["defaultMaterial.bumpAmplitude"].description,1,11,{max:1.000001,decimalplaces:3,valueConversion:function(b,a){return parseFloat(a.value)}}),
groundPlane:new module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting(b,"groundPlaneVisibility",module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.BOOLEAN,"Ground plane",b.getSettingDefinitions()["scene.groundPlaneVisibility"].description,1,4),grid:new module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting(b,"gridVisibility",module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.BOOLEAN,
"Grid",b.getSettingDefinitions()["scene.gridVisibility"].description,1,5),defaultMaterialColor:{defval:b.getSetting("defaultMaterial.color"),id:5,order:6,groupId:1,setting:"defaultMaterial.color",name:"Default Material Color",desc:b.getSettingDefinitions()["defaultMaterial.color"].description,type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.COLOR,valueConversion:{update:"value",f:function(b,a){a=toTinyColor_1$$module$src$api$apps$sd_controls$settings$sd_controls_settings.default(a.value);
if("color"===b.inputComponent.type)return a.toHexString();$("#"+this.slugId+"-color").spectrum("set",a.toRgbString());return a.toRgbString()}}},pointSize:{defval:b.getSetting("render.pointSize"),id:14,order:4,groupId:1,setting:"render.pointSize",name:"Point Size",desc:b.getSettingDefinitions()["scene.render.pointSize"].description,type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.SLIDER,min:.001,max:100.000001,decimalplaces:3,valueConversion:function(b,a){return parseFloat(a.value)}},
commitParameters:new module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting(b,"commitParameters",module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.BOOLEAN,"Parameter validation",b.getSettingDefinitions().commitParameters.description,1,8),topView:new module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting(b,"camera.cameraTypes.active",module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.BOOLEAN,
"Top View",b.getSettingDefinitions()["scene.camera.cameraTypes.active"].description,4,1,{valueConversion:{update:"value",f:function(b,a){return a.checked?1:0},i:function(b,a){return 1===a?!0:!1}}}),"camera.cameraTypes.perspective.fov":new module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting(b,"camera.cameraTypes.perspective.fov",module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.SLIDER,"Field of View",b.getSettingDefinitions()["scene.camera.cameraTypes.perspective.fov"].description,
4,2,{min:10,max:90,decimalplaces:0,valueConversion:function(b,a){return parseFloat(a.value)}}),"camera.controls.orbit.enableZoom":new module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting(b,"camera.controls.orbit.enableZoom",module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.BOOLEAN,"Disable Zoom",b.getSettingDefinitions()["scene.camera.controls.orbit.enableZoom"].description,4,3,{defval:!b.getSetting("camera.controls.orbit.enableZoom"),
valueConversion:{update:"value",f:function(b,a){return!a.checked},i:function(b,a){return!a}}}),"camera.controls.orbit.zoomSpeed":{defval:b.getSetting("camera.controls.orbit.zoomSpeed"),id:17,order:3,groupId:4,setting:"camera.controls.orbit.zoomSpeed",name:"Zoom Speed",desc:b.getSettingDefinitions()["scene.camera.controls.orbit.zoomSpeed"].description,type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.SLIDER,min:0,max:1.000001,decimalplaces:2,valueConversion:function(b,
a){return parseFloat(a.value)}},"camera.controls.orbit.enablePan":new module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting(b,"camera.controls.orbit.enablePan",module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.BOOLEAN,"Disable Pan",b.getSettingDefinitions()["scene.camera.controls.orbit.enablePan"].description,4,5,{defval:!b.getSetting("camera.controls.orbit.enablePan"),valueConversion:{update:"value",f:function(b,a){return!a.checked},
i:function(b,a){return!a}}}),"camera.controls.orbit.panSpeed":{defval:b.getSetting("camera.controls.orbit.panSpeed"),id:19,order:5,groupId:4,setting:"camera.controls.orbit.panSpeed",name:"Pan Speed",desc:b.getSettingDefinitions()["scene.camera.controls.orbit.panSpeed"].description,type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.SLIDER,min:0,max:1.000001,decimalplaces:2,valueConversion:function(b,a){return parseFloat(a.value)}},enableRotation:new module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting(b,
"camera.controls.orbit.enableRotation",module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.BOOLEAN,"Disable Rotation",b.getSettingDefinitions()["scene.camera.controls.orbit.enableRotation"].description,4,7,{defval:!b.getSetting("camera.controls.orbit.enableRotation"),valueConversion:{update:"value",f:function(b,a){return!a.checked},i:function(b,a){return!a}}}),"camera.controls.orbit.rotationSpeed":{defval:b.getSetting("camera.controls.orbit.rotationSpeed"),id:21,order:7,
groupId:4,setting:"camera.controls.orbit.rotationSpeed",name:"Rotation Speed",desc:b.getSettingDefinitions()["scene.camera.controls.orbit.rotationSpeed"].description,type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.SLIDER,min:0,max:1.000001,decimalplaces:2,valueConversion:function(b,a){return parseFloat(a.value)}},"camera.controls.orbit.autoRotationSpeed":{defval:b.getSetting("camera.controls.orbit.autoRotationSpeed"),id:22,order:8,groupId:4,setting:"camera.controls.orbit.autoRotationSpeed",
desc:b.getSettingDefinitions()["scene.camera.controls.orbit.autoRotationSpeed"].description,name:"Auto Rotation",type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.SLIDER,min:-10,max:10.000001,decimalplaces:2,valueConversion:function(b,a){return parseFloat(a.value)}},damping:{defval:b.getSetting("scene.camera.controls.orbit.damping"),id:23,order:9,groupId:4,setting:"scene.camera.controls.orbit.damping",name:"Damping Factor",desc:b.getSettingDefinitions()["scene.camera.controls.orbit.damping"].description,
type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.SLIDER,min:0,max:10.000001,decimalplaces:2,valueConversion:function(b,a){return parseFloat(a.value)}},"camera.zoomExtentsFactor":{defval:b.getSetting("camera.zoomExtentsFactor"),id:25,order:11,groupId:4,setting:"camera.zoomExtentsFactor",name:"Zoom Factor",desc:b.getSettingDefinitions()["scene.camera.zoomExtentsFactor"].description,type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.SLIDER,
min:.1,max:10.000001,decimalplaces:2,valueConversion:function(b,a){return parseFloat(a.value)}},"camera.autoAdjust":new module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting(b,"camera.autoAdjust",module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.BOOLEAN,"Camera adjust",b.getSettingDefinitions()["scene.camera.autoAdjust"].description,4,12),"camera.cameraMovementDuration":{defval:b.getSetting("camera.cameraMovementDuration"),id:26,order:13,
groupId:4,setting:"camera.cameraMovementDuration",name:"Adjust duration [msec]",desc:b.getSettingDefinitions()["scene.camera.cameraMovementDuration"].description,type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.SLIDER,min:0,max:2500,decimalplaces:0,valueConversion:function(b,a){return parseFloat(a.value)}},"camera.revertAtMouseUp":new module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting(b,"camera.revertAtMouseUp",module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.BOOLEAN,
"Camera revert",b.getSettingDefinitions()["scene.camera.revertAtMouseUp"].description,4,14),"camera.revertAtMouseUpDuration":{defval:b.getSetting("camera.revertAtMouseUpDuration"),id:29,order:15,groupId:4,setting:"camera.revertAtMouseUpDuration",name:"Revert duration [msec]",desc:b.getSettingDefinitions()["scene.camera.revertAtMouseUpDuration"].description,type:module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.SLIDER,min:0,max:2500,decimalplaces:0,valueConversion:function(b,
a){return parseFloat(a.value)}}};Object.assign(this.settings,b);this.createBackgroundSettings();this.createLightSettings()}a.prototype.createLightSetting=function(b){var a=this.api,d={},e=0,f;for(f in b.properties)switch(f){case "intensity":d[f]=new module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property.default.SliderLightPropertySetting(a,this.controlsContext,b,f,null,0,5,1);break;case "angle":case "penumbra":d[f]=new module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property.default.SliderLightPropertySetting(a,
this.controlsContext,b,f,null,0,Math.PI/2,2);break;case "distance":d[f]=new module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property.default.SliderLightPropertySetting(a,this.controlsContext,b,f);break;case "decay":d[f]=new module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property.default.SliderLightPropertySetting(a,this.controlsContext,b,f,null,0,2,2);break;case "color":d[f]=new module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property.default.ColorLightPropertySetting(a,
this.controlsContext,b,f);break;case "groundColor":d[f]=new module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property.default.ColorLightPropertySetting(a,this.controlsContext,b,f,"Ground Color");break;case "skyColor":d[f]=new module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property.default.ColorLightPropertySetting(a,this.controlsContext,b,f,"Sky Color");break;case "direction":case "position":case "target":d[f]=new module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property.default.Vector3LightPropertySetting(a,
this.controlsContext,b,f,null,2,.01);break;case "castShadow":d[f]=new module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_property.default.BooleanLightPropertySetting(a,this.controlsContext,b,f,"Cast Shadow")}return new module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_definition.default.LightDefinitionSetting(a,this.controlsContext,d,b.id,null,2,e++,b)};a.prototype.createBackgroundSettings=function(){var b=this.api;this.settings["render.clearColor"]=
new module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting(b,"render.clearColor",module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.COLOR,"Background Color","Background color of the viewer if no environment is visible",3,1,{valueConversion:{update:"value",f:function(b,a){a=toTinyColor_1$$module$src$api$apps$sd_controls$settings$sd_controls_settings.default(a.value);if("color"===b.inputComponent.type)return a.toHexString();$("#"+this.slugId+
"-color").spectrum("set",a.toRgbString());return a.toRgbString()}}});this.settings["render.clearAlpha"]=new module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting(b,"render.clearAlpha",module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.SLIDER,"Background Alpha","Background transparency of the viewer if no environment is visible",3,2,{min:0,max:1,decimalplaces:2,valueConversion:function(b,a){return parseFloat(a.value)}});this.settings["material.environmentMapAsBackground"]=
new module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting(b,"material.environmentMapAsBackground",module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.BOOLEAN,"Show Environment","Make the environment map visible",3,3);this.settings["material.environmentMap1"]=new module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting(b,"material.environmentMap",module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.DROPDOWN,
"Choose Environment","Choose an environment map",3,4,{choices:"none default default_bw blurred_lights georgentor georgentor_blur georgentor_blue_blur georgentor_bw_blur levelsets lythwood_field mountains ocean piazza_san_marco residential_garden room_abstract_1 sky storage_room storm subway_entrance subway_entrance_bw_blur white yokohama".split(" "),valueConversion:{update:"selectedIndex",f:function(b,a){return a.options[a.selectedIndex].innerHTML},i:function(b,a){return b.choices.indexOf(a.toLowerCase())}}});
this.settings["material.environmentMapResolution"]=new module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting(b,"material.environmentMapResolution",module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.DROPDOWN,"Environment resolution","Choose the pixel resolution of the environment map",3,5,{choices:["256","512","1024","2048"],valueConversion:{update:"selectedIndex",f:function(b,a){return a.options[a.selectedIndex].innerHTML},i:function(b,
a){return b.choices.indexOf(a)}}});this.settings["material.environmentMap2"]=new module$src$api$apps$sd_controls$settings$lights$sd_controls_setting.default.Setting(b,"material.environmentMap",module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.STRING,"Custom Environment","Enter the url of a custom cube map",3,6,{max:500})};a.prototype.createLightSettings=function(){var b=this.api;this.settings["add.lights.scene"]=new module$src$api$apps$sd_controls$settings$lights$AddLightModalSetting.default.AddLightModalSetting(b,
this.controlsContext,this);this.controlsContext.options.editMode&&(this.settings["save.lights.scene"]=new module$src$api$apps$sd_controls$settings$lights$CreateSaveLightSceneModalSetting.default.CreateSaveLightSceneModalSetting(b,this));this.settings["lights.lightScene"]=new module$src$api$apps$sd_controls$settings$lights$sd_controls_settings_light_scene_load_dropdown.default.LoadLightSceneDropdownSetting(b,this.controlsContext,this)};return a}();var module$src$api$apps$sd_controls$settings$GroupSettings={default:{}};Object.defineProperty(module$src$api$apps$sd_controls$settings$GroupSettings.default,"__esModule",{value:!0});
var sd_controls_components_dom_dom_util_1$$module$src$api$apps$sd_controls$settings$GroupSettings=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default,interfaces_1$$module$src$api$apps$sd_controls$settings$GroupSettings=module$src$interfaces$api$apps$sd_controls$interfaces.default,Icon$$module$src$api$apps$sd_controls$settings$GroupSettings=function(){function a(b){this.html='<a><span uk-icon="'+b+'"></span></a>'}a.prototype.toString=function(){return this.html};
return a}(),groupSettings$$module$src$api$apps$sd_controls$settings$GroupSettings=[{groupId:module$src$interfaces$api$apps$sd_controls$interfaces.default.SettingsGroups.WORLD,icon:new Icon$$module$src$api$apps$sd_controls$settings$GroupSettings("world")},{groupId:module$src$interfaces$api$apps$sd_controls$interfaces.default.SettingsGroups.LIGHTS,icon:new Icon$$module$src$api$apps$sd_controls$settings$GroupSettings("bolt")},{groupId:module$src$interfaces$api$apps$sd_controls$interfaces.default.SettingsGroups.BACKGROUND,
icon:new Icon$$module$src$api$apps$sd_controls$settings$GroupSettings("image")},{groupId:module$src$interfaces$api$apps$sd_controls$interfaces.default.SettingsGroups.CAMERA,icon:new Icon$$module$src$api$apps$sd_controls$settings$GroupSettings("video-camera")}];
module$src$api$apps$sd_controls$settings$GroupSettings.default.GroupSetings=function(){function a(b){var a=this;this.groups={};var d=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement("ul",{parent:b,classList:["uk-margin-remove","uk-width-1-1","sdv-control-panel-row-border","shapediver-settings-tabs"],attributes:{"uk-tab":"swiping: false;"}}),e=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement("ul",
{parent:b,classList:["uk-switcher","uk-width-1-1","uk-margin-remove-top"]});groupSettings$$module$src$api$apps$sd_controls$settings$GroupSettings.forEach(function(b){var c=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement("li",{parent:d,classList:["uk-padding-remove","uk-width-1-4"],innerHTML:b.icon.toString()}),f=module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default.createDomElement("li",{parent:e,attributes:{"uk-grid":""},
classList:["uk-width-1-1","uk-margin-remove"]});a.groups[b.groupId]={contentEl:f,headerEl:c,id:b.groupId}})}a.prototype.getGroup=function(b){return this.groups[b].contentEl};a.prototype.headersClick=function(b){var a=this,d=function(c){e.groups[c].headerEl.addEventListener("click",function(){return b(a.groups[c].id)})},e=this,f;for(f in this.groups)d(f)};return a}();/*
 MIT
*/
var module$src$shared$util$Sortable={};
module$src$shared$util$Sortable.default=function(){function a(b,a){if(!b||!b.nodeType||1!==b.nodeType)throw"Sortable: `el` must be HTMLElement, and not "+{}.toString.call(b);this.el=b;this.options=a=q({},a);b[M]=this;var c={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(b.nodeName)?"li":">*",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",ignore:"a, img",filter:null,animation:0,setData:function(b,a){b.setData("Text",
a.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1},e;for(e in c)e in a||(a[e]=c[e]);T(a);for(var f in this)"_"===f.charAt(0)&&(this[f]=this[f].bind(this));this.nativeDraggable=a.forceFallback?!1:P;d(b,"mousedown",this._onTapStart);d(b,"touchstart",this._onTapStart);this.nativeDraggable&&(d(b,"dragover",this),d(b,"dragenter",this));Q.push(this._onDragOver);a.store&&this.sort(a.store.get(this))}function b(b){x&&
x.state!==b&&(h(x,"display",b?"none":""),!b&&x.state&&y.insertBefore(x,t),x.state=b)}function c(b,a,c){if(b){c=c||N;a=a.split(".");var d=a.shift().toUpperCase(),e=new RegExp("\\s("+a.join("|")+")(?=\\s)","g");do if(">*"===d&&b.parentNode===c||!(""!==d&&b.nodeName.toUpperCase()!=d||a.length&&((" "+b.className+" ").match(e)||[]).length!=a.length))return b;while(b!==c&&(b=b.parentNode))}return null}function d(b,a,c){b.addEventListener(a,c,!1)}function e(b,a,c){b.removeEventListener(a,c,!1)}function f(b,
a,c){if(b)if(b.classList)b.classList[c?"add":"remove"](a);else{var d=(" "+b.className+" ").replace(J," ").replace(" "+a+" "," ");b.className=(d+(c?" "+a:"")).replace(J," ")}}function h(b,a,c){var d=b&&b.style;if(d){if(void 0===c)return N.defaultView&&N.defaultView.getComputedStyle?c=N.defaultView.getComputedStyle(b,""):b.currentStyle&&(c=b.currentStyle),void 0===a?c:c[a];a in d||(a="-webkit-"+a);d[a]=c+("string"===typeof c?"":"px")}}function g(b,a,c){if(b){b=b.getElementsByTagName(a);a=0;var d=b.length;
if(c)for(;a<d;a++)c(b[a],a);return b}return[]}function k(b,a,c,d,e,f,g){var l=N.createEvent("Event"),h=(b||a[M]).options,p="on"+c.charAt(0).toUpperCase()+c.substr(1);l.initEvent(c,!0,!0);l.to=a;l.from=e||a;l.item=d||a;l.clone=x;l.oldIndex=f;l.newIndex=g;a.dispatchEvent(l);h[p]&&h[p].call(b,l)}function l(b,a,c,d,e,f){var g=b[M],l=g.options.onMove,h;var p=N.createEvent("Event");p.initEvent("move",!0,!0);p.to=a;p.from=b;p.dragged=c;p.draggedRect=d;p.related=e||a;p.relatedRect=f||a.getBoundingClientRect();
b.dispatchEvent(p);l&&(h=l.call(g,p));return h}function m(b){b.draggable=!1}function n(){V=!1}function r(b){b=b.tagName+b.className+b.src+b.href+b.textContent;for(var a=b.length,c=0;a--;)c+=b.charCodeAt(a);return c.toString(36)}function u(b){var a=0;if(!b||!b.parentNode)return-1;for(;b&&(b=b.previousElementSibling);)"TEMPLATE"!==b.nodeName.toUpperCase()&&a++;return a}function p(b,a){var c,d;return function(){void 0===c&&(c=arguments,d=this,setTimeout(function(){1===c.length?b.call(d,c[0]):b.apply(d,
c);c=void 0},a))}}function q(b,a){if(b&&a)for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}var t,v,w,x,y,A,z,B,D,G,F,E,I,C,L={},H,K,S,J=/\s+/g,M="Sortable"+(new Date).getTime(),O=window,N=O.document,R=O.parseInt,P=!!("draggable"in N.createElement("div")),W=function(b){b=N.createElement("x");b.style.cssText="pointer-events:auto";return"auto"===b.style.pointerEvents}(),V=!1,U=Math.abs,Q=[],X=p(function(b,a,c){if(c&&a.scroll){var d=a.scrollSensitivity,e=a.scrollSpeed,f=b.clientX;b=b.clientY;
var g=window.innerWidth,l=window.innerHeight;if(B!==c&&(z=a.scroll,B=c,!0===z)){z=c;do if(z.offsetWidth<z.scrollWidth||z.offsetHeight<z.scrollHeight)break;while(z=z.parentNode)}if(z){var h=z;a=z.getBoundingClientRect();var p=(U(a.right-f)<=d)-(U(a.left-f)<=d);var m=(U(a.bottom-b)<=d)-(U(a.top-b)<=d)}p||m||(p=(g-f<=d)-(f<=d),m=(l-b<=d)-(b<=d),(p||m)&&(h=O));if(L.vx!==p||L.vy!==m||L.el!==h)L.el=h,L.vx=p,L.vy=m,clearInterval(L.pid),h&&(L.pid=setInterval(function(){h===O?O.scrollTo(O.pageXOffset+p*e,
O.pageYOffset+m*e):(m&&(h.scrollTop+=m*e),p&&(h.scrollLeft+=p*e))},24))}},30),T=function(b){var a=b.group;a&&"object"==typeof a||(a=b.group={name:a});["pull","put"].forEach(function(b){b in a||(a[b]=!0)});b.groups=" "+a.name+(a.put.join?" "+a.put.join(" "):"")+" "};a.prototype={constructor:a,_onTapStart:function(b){var a=this,d=this.el,e=this.options,f=b.touches&&b.touches[0],g=(f||b).target,l=g,h=e.filter;if(!("mousedown"===b.type&&0!==b.button||e.disabled)&&(g=c(g,e.draggable,d))){E=u(g);if("function"===
typeof h){if(h.call(this,b,g,this)){k(a,l,"filter",g,d,E);b.preventDefault();return}}else if(h&&(h=h.split(",").some(function(b){if(b=c(l,b.trim(),d))return k(a,b,"filter",g,d,E),!0}))){b.preventDefault();return}e.handle&&!c(l,e.handle,d)||this._prepareDragStart(b,f,g)}},_prepareDragStart:function(b,a,c){var e=this,h=e.el,l=e.options,p=h.ownerDocument;c&&!t&&c.parentNode===h&&(H=b,y=h,t=c,v=t.parentNode,A=t.nextSibling,C=l.group,b=function(){e._disableDelayedDrag();t.draggable=!0;f(t,e.options.chosenClass,
!0);e._triggerDragStart(a)},l.ignore.split(",").forEach(function(b){g(t,b.trim(),m)}),d(p,"mouseup",e._onDrop),d(p,"touchend",e._onDrop),d(p,"touchcancel",e._onDrop),l.delay?(d(p,"mouseup",e._disableDelayedDrag),d(p,"touchend",e._disableDelayedDrag),d(p,"touchcancel",e._disableDelayedDrag),d(p,"mousemove",e._disableDelayedDrag),d(p,"touchmove",e._disableDelayedDrag),e._dragStartTimer=setTimeout(b,l.delay)):b())},_disableDelayedDrag:function(){var b=this.el.ownerDocument;clearTimeout(this._dragStartTimer);
e(b,"mouseup",this._disableDelayedDrag);e(b,"touchend",this._disableDelayedDrag);e(b,"touchcancel",this._disableDelayedDrag);e(b,"mousemove",this._disableDelayedDrag);e(b,"touchmove",this._disableDelayedDrag)},_triggerDragStart:function(b){b?(H={target:t,clientX:b.clientX,clientY:b.clientY},this._onDragStart(H,"touch")):this.nativeDraggable?(d(t,"dragend",this),d(y,"dragstart",this._onDragStart)):this._onDragStart(H,!0);try{N.selection?N.selection.empty():window.getSelection().removeAllRanges()}catch(Z){}},
_dragStarted:function(){y&&t&&(f(t,this.options.ghostClass,!0),a.active=this,k(this,y,"start",t,y,E))},_emulateDragOver:function(){if(K&&(this._lastX!==K.clientX||this._lastY!==K.clientY)){this._lastX=K.clientX;this._lastY=K.clientY;W||h(w,"display","none");var b=N.elementFromPoint(K.clientX,K.clientY),a=b,c=" "+this.options.group.name,d=Q.length;if(a){do{if(a[M]&&-1<a[M].options.groups.indexOf(c)){for(;d--;)Q[d]({clientX:K.clientX,clientY:K.clientY,target:b,rootEl:a});break}b=a}while(a=a.parentNode)
}W||h(w,"display","")}},_onTouchMove:function(b){if(H){a.active||this._dragStarted();this._appendGhost();var c=b.touches?b.touches[0]:b,d=c.clientX-H.clientX,e=c.clientY-H.clientY;d=b.touches?"translate3d("+d+"px,"+e+"px,0)":"translate("+d+"px,"+e+"px)";S=!0;K=c;h(w,"webkitTransform",d);h(w,"mozTransform",d);h(w,"msTransform",d);h(w,"transform",d);b.preventDefault()}},_appendGhost:function(){if(!w){var b=t.getBoundingClientRect(),a=h(t),c=this.options;w=t.cloneNode(!0);f(w,c.ghostClass,!1);f(w,c.fallbackClass,
!0);h(w,"top",b.top-R(a.marginTop,10));h(w,"left",b.left-R(a.marginLeft,10));h(w,"width",b.width);h(w,"height",b.height);h(w,"opacity","0.8");h(w,"position","fixed");h(w,"zIndex","100000");h(w,"pointerEvents","none");c.fallbackOnBody&&N.body.appendChild(w)||y.appendChild(w);a=w.getBoundingClientRect();h(w,"width",2*b.width-a.width);h(w,"height",2*b.height-a.height)}},_onDragStart:function(b,a){b=b.dataTransfer;var c=this.options;this._offUpEvents();"clone"==C.pull&&(x=t.cloneNode(!0),h(x,"display",
"none"),y.insertBefore(x,t));a?("touch"===a?(d(N,"touchmove",this._onTouchMove),d(N,"touchend",this._onDrop),d(N,"touchcancel",this._onDrop)):(d(N,"mousemove",this._onTouchMove),d(N,"mouseup",this._onDrop)),this._loopId=setInterval(this._emulateDragOver,50)):(b&&(b.effectAllowed="move",c.setData&&c.setData.call(this,b,t)),d(N,"drop",this),setTimeout(this._dragStarted,0))},_onDragOver:function(a){var d=this.el,e;var f=this.options;var g=f.group;var p=g.put,m=C===g,k=f.sort;void 0!==a.preventDefault&&
(a.preventDefault(),!f.dragoverBubble&&a.stopPropagation());S=!0;if(C&&!f.disabled&&(m?k||(e=!y.contains(t)):C.pull&&p&&(C.name===g.name||p.indexOf&&~p.indexOf(C.name)))&&(void 0===a.rootEl||a.rootEl===this.el)&&(X(a,f,this.el),!V))if(g=c(a.target,f.draggable,d),f=t.getBoundingClientRect(),e)b(!0),x||A?y.insertBefore(t,x||A):k||y.appendChild(t);else if(!(e=0===d.children.length||d.children[0]===w)&&(e=d===a.target)&&(g=d.lastElementChild,e=g.getBoundingClientRect(),e=g=(5<a.clientY-(e.top+e.height)||
5<a.clientX-(e.right+e.width))&&g),e){if(g){if(g.animated)return;q=g.getBoundingClientRect()}b(m);!1!==l(y,d,t,f,g,q)&&(t.contains(d)||(d.appendChild(t),v=d),this._animate(f,t),g&&this._animate(q,g))}else if(g&&!g.animated&&g!==t&&void 0!==g.parentNode[M]){D!==g&&(D=g,G=h(g),F=h(g.parentNode));var q=g.getBoundingClientRect(),r=q.right-q.left,u=q.bottom-q.top;k=/left|right|inline/.test(G.cssFloat+G.display)||"flex"==F.display&&0===F["flex-direction"].indexOf("row");e=g.offsetWidth>t.offsetWidth;p=
g.offsetHeight>t.offsetHeight;r=.5<(k?(a.clientX-q.left)/r:(a.clientY-q.top)/u);a=g.nextElementSibling;u=l(y,d,t,f,g,q);!1!==u&&(V=!0,setTimeout(n,30),b(m),1===u||-1===u?m=1===u:k?(m=t.offsetTop,k=g.offsetTop,m=m===k?g.previousElementSibling===t&&!e||r&&e:k>m):m=a!==t&&!p||r&&p,t.contains(d)||(m&&!a?d.appendChild(t):g.parentNode.insertBefore(t,m?a:g)),v=t.parentNode,this._animate(f,t),this._animate(q,g))}},_animate:function(b,a){var c=this.options.animation;if(c){var d=a.getBoundingClientRect();h(a,
"transition","none");h(a,"transform","translate3d("+(b.left-d.left)+"px,"+(b.top-d.top)+"px,0)");h(a,"transition","all "+c+"ms");h(a,"transform","translate3d(0,0,0)");clearTimeout(a.animated);a.animated=setTimeout(function(){h(a,"transition","");h(a,"transform","");a.animated=!1},c)}},_offUpEvents:function(){var b=this.el.ownerDocument;e(N,"touchmove",this._onTouchMove);e(b,"mouseup",this._onDrop);e(b,"touchend",this._onDrop);e(b,"touchcancel",this._onDrop)},_onDrop:function(b){var c=this.el,d=this.options;
clearInterval(this._loopId);clearInterval(L.pid);clearTimeout(this._dragStartTimer);e(N,"mousemove",this._onTouchMove);this.nativeDraggable&&(e(N,"drop",this),e(c,"dragstart",this._onDragStart));this._offUpEvents();if(b){S&&(b.preventDefault(),!d.dropBubble&&b.stopPropagation());w&&w.parentNode.removeChild(w);if(t&&(this.nativeDraggable&&e(t,"dragend",this),m(t),f(t,this.options.ghostClass,!1),f(t,this.options.chosenClass,!1),y!==v?(I=u(t),0<=I&&(k(null,v,"sort",t,y,E,I),k(this,y,"sort",t,y,E,I),
k(null,v,"add",t,y,E,I),k(this,y,"remove",t,y,E,I))):(x&&x.parentNode.removeChild(x),t.nextSibling!==A&&(I=u(t),0<=I&&(k(this,y,"update",t,y,E,I),k(this,y,"sort",t,y,E,I)))),a.active)){if(null===I||-1===I)I=E;k(this,y,"end",t,y,E,I);this.save()}y=t=v=w=A=x=z=B=H=K=S=I=D=G=C=a.active=null}},handleEvent:function(b){var a=b.type;"dragover"===a||"dragenter"===a?t&&(this._onDragOver(b),b.dataTransfer&&(b.dataTransfer.dropEffect="move"),b.preventDefault()):"drop"!==a&&"dragend"!==a||this._onDrop(b)},toArray:function(){for(var b=
[],a,d=this.el.children,e=0,f=d.length,g=this.options;e<f;e++)a=d[e],c(a,g.draggable,this.el)&&b.push(a.getAttribute(g.dataIdAttr)||r(a));return b},sort:function(b){var a={},d=this.el;this.toArray().forEach(function(b,e){e=d.children[e];c(e,this.options.draggable,d)&&(a[b]=e)},this);b.forEach(function(b){a[b]&&(d.removeChild(a[b]),d.appendChild(a[b]))})},save:function(){var b=this.options.store;b&&b.set(this)},closest:function(b,a){return c(b,a||this.options.draggable,this.el)},option:function(b,
a){var c=this.options;if(void 0===a)return c[b];c[b]=a;"group"===b&&T(c)},destroy:function(){var b=this.el;b[M]=null;e(b,"mousedown",this._onTapStart);e(b,"touchstart",this._onTapStart);this.nativeDraggable&&(e(b,"dragover",this),e(b,"dragenter",this));Array.prototype.forEach.call(b.querySelectorAll("[draggable]"),function(b){b.removeAttribute("draggable")});Q.splice(Q.indexOf(this._onDragOver),1);this._onDrop();this.el=b=null}};a.utils={on:d,off:e,css:h,find:g,is:function(b,a){return!!c(b,a,b)},
extend:q,throttle:p,closest:c,toggleClass:f,index:u};a.create=function(b,c){return new a(b,c)};a.version="1.4.2";return a}();var module$src$modules$shapediver_lights_drag_controls$src$enums$enums={default:{}};Object.defineProperty(module$src$modules$shapediver_lights_drag_controls$src$enums$enums.default,"__esModule",{value:!0});var LightControlsEvents$$module$src$modules$shapediver_lights_drag_controls$src$enums$enums;
(function(a){a.UPDATED="updated"})(LightControlsEvents$$module$src$modules$shapediver_lights_drag_controls$src$enums$enums=module$src$modules$shapediver_lights_drag_controls$src$enums$enums.default.LightControlsEvents||(module$src$modules$shapediver_lights_drag_controls$src$enums$enums.default.LightControlsEvents={}));var module$src$modules$shapediver_generic_event$GenericEvent={default:{}};Object.defineProperty(module$src$modules$shapediver_generic_event$GenericEvent.default,"__esModule",{value:!0});
module$src$modules$shapediver_generic_event$GenericEvent.default.GenericEvent=function(){function a(b){var a=this;void 0===b&&(b=[]);this.handlers={};b.forEach(function(b){return a.handlers[b]=[]})}a.prototype.on=function(b,a){this.handlers[b]||(this.handlers[b]=[]);this.handlers[b].push(a)};a.prototype.off=function(b,a){this.handlers[b]=this.handlers[b].splice(0).filter(function(b){return b!==a})};a.prototype.clear=function(b){this.handlers[b]=[]};a.prototype.trigger=function(b,a){this.handlers[b]||
(this.handlers[b]=[]);this.handlers[b].forEach(function(b){return b(a)})};return a}();var module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper={default:{}},__awaiter$$module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper=this&&module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper.default.__awaiter||function(a,b,c,d){function e(b){return b instanceof c?b:new c(function(a){a(b)})}return new (c||(c=Promise))(function(c,h){function f(b){try{l(d.next(b))}catch(n){h(n)}}function k(b){try{l(d["throw"](b))}catch(n){h(n)}}
function l(b){b.done?c(b.value):e(b.value).then(f,k)}l((d=d.apply(a,b||[])).next())})},__generator$$module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper=this&&module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper.default.__generator||function(a,b){function c(b){return function(a){return d([b,a])}}function d(c){if(f)throw new TypeError("Generator is already executing.");for(;e;)try{if(f=1,h&&(g=c[0]&2?h["return"]:c[0]?h["throw"]||((g=h["return"])&&g.call(h),
0):h.next)&&!(g=g.call(h,c[1])).done)return g;if(h=0,g)c=[c[0]&2,g.value];switch(c[0]){case 0:case 1:g=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(g=e.trys,g=0<g.length&&g[g.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3]))e.label=c[1];else if(6===c[0]&&e.label<g[1])e.label=g[1],g=c;else if(g&&e.label<g[2])e.label=g[2],e.ops.push(c);else{g[2]&&e.ops.pop();e.trys.pop();
continue}}c=b.call(a,e)}catch(m){c=[6,m],h=0}finally{f=g=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},f,h,g,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k};Object.defineProperty(module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper.default,"__esModule",{value:!0});
module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper.default.ApiLightHelperWrapper=function(){function a(b){this.api=b}a.prototype.addAnchorAddListener=function(b){this.api.scene.addEventListener(this.api.scene.EVENTTYPE.ANCHOR_ADD,b)};a.prototype.addAnchorRemoveListener=function(b){this.api.scene.addEventListener(this.api.scene.EVENTTYPE.ANCHOR_REMOVE,b)};a.prototype.addDragEndListener=function(b){this.api.scene.addEventListener(this.api.scene.EVENTTYPE.DRAG_END,b)};a.prototype.addDragMoveListener=
function(b){this.api.scene.addEventListener(this.api.scene.EVENTTYPE.DRAG_MOVE,b)};a.prototype.addDragStartListener=function(b){this.api.scene.addEventListener(this.api.scene.EVENTTYPE.DRAG_START,b)};a.prototype.appendElementToVieweport=function(b,a){this.api.viewports.get(b).getContainer().appendChild(a)};a.prototype.convertTo2D=function(b){return this.api.scene.convertTo2D(b).data[0]};a.prototype.createInteractionsGroup=function(){return this.api.scene.updateInteractionGroups([{id:"dragGroup",selectable:!1,
draggable:!0,hoverable:!1}])};a.prototype.getLight=function(b){return this.api.scene.lights.getLight(b).data};a.prototype.getLightScene=function(){return this.api.scene.lights.getLightScene().data};a.prototype.getLightHelpersVisible=function(){return this.lightHelpersVisible};a.prototype.getSceneBoundingBox=function(){return this.api.scene.getBoundingBox().data};a.prototype.isDirectionalLight=function(b){return b.type===this.api.scene.lights.LIGHTTYPE.DIRECTIONAL};a.prototype.isPointLight=function(b){return b.type===
this.api.scene.lights.LIGHTTYPE.POINT};a.prototype.isSpotLight=function(b){return b.type===this.api.scene.lights.LIGHTTYPE.SPOT};a.prototype.removeAsync=function(b){return __awaiter$$module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper(this,void 0,void 0,function(){return __generator$$module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper(this,function(a){return[2,this.api.scene.removeAsync(b,"lightHelpers")]})})};a.prototype.setLightHelpers=function(b){this.api.updateSettingAsync("scene.lights.helper",
b);this.lightHelpersVisible=b};a.prototype.toggleGeometry=function(b){this.api.scene.toggleGeometry([],b)};a.prototype.updateAsync=function(b){return __awaiter$$module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper(this,void 0,void 0,function(){var a,d,e,f;return __generator$$module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper(this,function(c){switch(c.label){case 0:return a="scene.camera.autoAdjust",(d=this.api.getSetting(a))?[4,this.api.updateSettingAsync(a,
!1)]:[3,2];case 1:return c.sent(),e=this.api.scene.updateAsync(b,"lightHelpers"),f=this.api.scene.addEventListener(this.api.scene.EVENTTYPE.SUBSCENE_PUBLISHED,function(){this.api.updateSettingAsync(a,!0);this.api.scene.removeEventListener(f.data[0])}),[2,e];case 2:return[2,this.api.scene.updateAsync(b,"lightHelpers")]}})})};a.prototype.updateLight=function(b){return this.api.scene.lights.updateLight(b).data};a.prototype.zoomAsync=function(b){this.api.scene.camera.zoomAsync(b)};return a}();var module$src$modules$shapediver_lights_drag_controls$src$CreateDefinitions={default:{}};Object.defineProperty(module$src$modules$shapediver_lights_drag_controls$src$CreateDefinitions.default,"__esModule",{value:!0});
module$src$modules$shapediver_lights_drag_controls$src$CreateDefinitions.default.CreateDefinitions=function(){function a(b){this.three=b}a.prototype.createAnchorAssetDefinition=function(){return{id:"anchor",group:"anchor_group",content:[{format:"anchor",data:[{version:"1.0",location:{x:0,y:0,z:0},format:"light_anchor",data:{text:null}}]}]}};a.prototype.createGeometryAssetDefinition=function(){return{id:"geometry",group:"geometry_group",interactionGroup:"dragGroup",interactionMode:"global",content:[{format:"three",
data:{threeObject:null}}]}};return a}();var module$src$modules$shapediver_lights_drag_controls$src$DragControlsCache={default:{}};Object.defineProperty(module$src$modules$shapediver_lights_drag_controls$src$DragControlsCache.default,"__esModule",{value:!0});
module$src$modules$shapediver_lights_drag_controls$src$DragControlsCache.default.DragControlsCache=function(){function a(b){this._apiWrapper=b;this._anchors={};this._geometry={};this._obj={};this._svgs={}}a.prototype.clear=function(b,a,d){var c=this;b&&Object.keys(this._svgs).forEach(function(b){document.getElementById(c._svgs[b].id).remove();delete c._svgs[b]});if(d||a)b=function(b){Object.keys(b).forEach(function(a){c._apiWrapper.removeAsync({id:b[a].id});delete b[a]})},d&&b(this._geometry),a&&
b(this._anchors)};a.prototype.clearWithKey=function(b,a,d,e){var c=this;if(e||d){var h=function(a){c._apiWrapper.removeAsync({id:b});delete a[b]};e&&h(this._geometry);d&&h(this._anchors)}a&&delete this._svgs[b]};a.prototype.get=function(b,a){b=this.getLightDefPropertyKey(b,a);return this.getFromKey(b)};a.prototype.getAllAsArray=function(b,a,d){var c=[],f=function(b){return Object.keys(b).forEach(function(a){return c.push(b[a])})};b&&f(this._svgs);a&&f(this._anchors);d&&f(this._geometry);return c};
a.prototype.getFromKey=function(b){this._obj.anchor=this._anchors[b];this._obj.svg=this._svgs[b];this._obj.geometry=this._geometry[b];return this._obj};a.prototype.put=function(b,a,d,e,f){b=this.getLightDefPropertyKey(b,a);this.putWithkey(b,d,e,f)};a.prototype.putWithkey=function(b,a,d,e){a&&(this._svgs[b]=a);d&&(this._anchors[b]=d);e&&(this._geometry[b]=e)};a.prototype.getLightDefPropertyKey=function(b,a){return b.type+"_"+b.id+"_"+a};return a}();var module$src$modules$shapediver_lights_drag_controls$src$DragControlsScenePathHelper={default:{}};Object.defineProperty(module$src$modules$shapediver_lights_drag_controls$src$DragControlsScenePathHelper.default,"__esModule",{value:!0});
module$src$modules$shapediver_lights_drag_controls$src$DragControlsScenePathHelper.default.DragControlsScenePathHelper=function(){function a(){}a.prototype.extractLightIdFromPath=function(b){b=b.substring(b.indexOf("_")+1);return b.substring(0,b.lastIndexOf("_"))};a.prototype.extractPropertyFromPath=function(b){return b.substring(b.lastIndexOf("_")+1)};return a}();var module$src$modules$shapediver_lights_drag_controls$src$LightControls={default:{}};Object.defineProperty(module$src$modules$shapediver_lights_drag_controls$src$LightControls.default,"__esModule",{value:!0});
var enums_1$$module$src$modules$shapediver_lights_drag_controls$src$LightControls=module$src$modules$shapediver_lights_drag_controls$src$enums$enums.default,GenericEvent_1$$module$src$modules$shapediver_lights_drag_controls$src$LightControls=module$src$modules$shapediver_generic_event$GenericEvent.default,ApiLightHelperWrapper_1$$module$src$modules$shapediver_lights_drag_controls$src$LightControls=module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper.default,CreateDefinitions_1$$module$src$modules$shapediver_lights_drag_controls$src$LightControls=
module$src$modules$shapediver_lights_drag_controls$src$CreateDefinitions.default,DragControlsCache_1$$module$src$modules$shapediver_lights_drag_controls$src$LightControls=module$src$modules$shapediver_lights_drag_controls$src$DragControlsCache.default,DragControlsScenePathHelper_1$$module$src$modules$shapediver_lights_drag_controls$src$LightControls=module$src$modules$shapediver_lights_drag_controls$src$DragControlsScenePathHelper.default;
module$src$modules$shapediver_lights_drag_controls$src$LightControls.default.LightControls=function(){function a(b,a){this.three=a;this._chevronString='<polyline fill="none" stroke="#000" stroke-width="1.03" points="10 6 14 10 10 14"></polyline><polyline fill="none" stroke="#000" stroke-width="1.03" points="6 6 10 10 6 14"></polyline>';this._events=new module$src$modules$shapediver_generic_event$GenericEvent.default.GenericEvent;this._offsets={};this._polygonString='<polygon fill="none" stroke="#000" stroke-width="1.01" points="10 2 12.63 7.27 18.5 8.12 14.25 12.22 15.25 18 10 15.27 4.75 18 5.75 12.22 1.5 8.12 7.37 7.27"></polygon>';
this._svgScaling=2E3;this._currentScale=50;this._isEnabled=this._dragging=!1;this._apiWrapper=new module$src$modules$shapediver_lights_drag_controls$src$ApiLightHelperWrapper.default.ApiLightHelperWrapper(b);this._createDefinitions=new module$src$modules$shapediver_lights_drag_controls$src$CreateDefinitions.default.CreateDefinitions(this.three);this._dragControlsCache=new module$src$modules$shapediver_lights_drag_controls$src$DragControlsCache.default.DragControlsCache(this._apiWrapper);this._scenePathHelper=
new module$src$modules$shapediver_lights_drag_controls$src$DragControlsScenePathHelper.default.DragControlsScenePathHelper;this.addEventListeners()}Object.defineProperty(a.prototype,"events",{get:function(){return this._events},enumerable:!0,configurable:!0});a.prototype.disableDragging=function(){this._dragControlsCache.clear(!1,!0,!0)};a.prototype.enableDragging=function(b){var a=this,d=this._apiWrapper.getLight(b);if(d){if(this._apiWrapper.isSpotLight(d)){var e=d.type+"_"+b+"_position",f=this.createAssetDefinition(e,
d.properties.position);b=d.type+"_"+b+"_target";var h=this.createAssetDefinition(b,d.properties.target);this._dragControlsCache.put(d,"position",null,f.anchorAssetDefinition,f.geometryAssetDefinition);this._dragControlsCache.put(d,"target",null,h.anchorAssetDefinition,h.geometryAssetDefinition);this._offsets[e]=new this.three.Vector3(d.properties.position.x,d.properties.position.y,d.properties.position.z);this._offsets[b]=new this.three.Vector3(d.properties.target.x,d.properties.target.y,d.properties.target.z)}else this._apiWrapper.isPointLight(d)?
(e=d.type+"_"+b+"_position",f=this.createAssetDefinition(e,d.properties.position),this._dragControlsCache.put(d,"position",null,f.anchorAssetDefinition,f.geometryAssetDefinition),this._offsets[e]=new this.three.Vector3(d.properties.position.x,d.properties.position.y,d.properties.position.z)):this._apiWrapper.isDirectionalLight(d)&&(f=this.getBoundingSphere(),e=f.center,f=f.radius,h=(new this.three.Vector3(d.properties.direction.x,d.properties.direction.y,d.properties.direction.z)).normalize(),h.multiplyScalar(2.35*
f),h.add(e),e=d.type+"_"+b+"_position",f=this.createAssetDefinition(e,h),this._dragControlsCache.put(d,"position",null,f.anchorAssetDefinition,f.geometryAssetDefinition),this._offsets[e]=h);d=this._dragControlsCache.getAllAsArray(!1,!0,!0);this._apiWrapper.updateAsync(d).then(function(b){var c=[];a._dragControlsCache.getAllAsArray(!1,!1,!0).forEach(function(a){b.data.forEach(function(b){b.id==a.id&&c.push(b.scenePath)})});a._apiWrapper.toggleGeometry(c)})}};a.prototype.makeLightDraggableAndZoomAsync=
function(b){this.makeLightDraggable(b);this._apiWrapper.zoomAsync(this.getSceneAndLightBoundingBox())};a.prototype.makeLightDraggable=function(b){if(!this._isEnabled){var a=this._apiWrapper.getSceneBoundingBox();this._dist=.025*a.min.distanceTo(a.max);this._apiWrapper.createInteractionsGroup();this._isEnabled=!0}this.disableDragging();this.enableDragging(b)};a.prototype.makeLightDraggableAndZoom=function(b){this.makeLightDraggable(b);this._apiWrapper.zoomAsync(this.getSceneAndLightBoundingBox())};
a.prototype.update=function(b){this.makeLightDraggable(b.id)};a.prototype.useLightHelpers=function(b){this._apiWrapper.setLightHelpers(b);this._dragControlsCache.getAllAsArray(!0,!1,!1).forEach(function(a){return a.style.visibility=b?"visible":"hidden"});!1===b&&this.disableDragging()};a.prototype.zoomAsync=function(){this._apiWrapper.zoomAsync(this.getSceneAndLightBoundingBox())};a.prototype.addEventListeners=function(){var b=this;this._apiWrapper.addAnchorAddListener(function(a){for(var c=0,e=a.anchors.length;c<
e;c++){var f=a.anchors[c];if("light_anchor"===f.format){var h=f.viewport+"-shapediver-lights-domElements";b._domEl=document.getElementById(h);b._domEl||(b._domEl=document.createElement("div"),b._domEl.style.pointerEvents="none",b._domEl.style.position="absolute",b._domEl.style.width="100%",b._domEl.style.height="100%",b._domEl.style.top="0",b._domEl.style.left="0",b._domEl.id=h,b._apiWrapper.appendElementToVieweport(f.viewport,b._domEl));h=document.createElementNS("http://www.w3.org/2000/svg","svg");
h.style.position="absolute";h.style.color="#000000";h.style.cursor="pointer";h.setAttribute("viewBox","0 0 20 20");h.setAttribute("width","20");h.setAttribute("height","20");if(f.data.text.includes("position"))h.appendChild(b.createPolygonElement());else{var g=b.createPolylineHtmlElements();h.appendChild(g[0]);h.appendChild(g[1])}h.id=f.data.text;(g=b._dragControlsCache.getFromKey(h.id).svg)&&b._domEl.removeChild(g);b._domEl.appendChild(h);b._dragControlsCache.putWithkey(h.id,h);var k=b._offsets[f.data.text];
b._domRect=b._domEl.getBoundingClientRect();var l=g=void 0;k?(g=new b.three.Vector3(f.location.x,f.location.y,f.location.z),k=b._apiWrapper.convertTo2D(g),g=k.clientX,l=k.clientY):(g=f.clientX,l=f.clientY);b.setSvgPositionAndScale(h,g,l);f.updateFunction(function(a){if(!b._dragging){b._currentScale=1/(a.distance/b._dist)*b._svgScaling;var c=b._dragControlsCache.getFromKey(a.data.text).svg;b.setSvgPositionAndScale(c,a.clientX,a.clientY)}})}}});this._apiWrapper.addAnchorRemoveListener(function(a){for(var c=
0,e=a.anchors.length;c<e;c++){var f=a.anchors[c];if("light_anchor"===f.format){var h=document.getElementById(f.viewport+"-shapediver-lights-domElements");f=f.data.text;var g=b._dragControlsCache.getFromKey(f).svg;b._dragControlsCache.clearWithKey(f,!0,!1,!1);h.removeChild(g)}}});this._apiWrapper.addDragStartListener(function(a){b._dragging=!0;a=b._apiWrapper.getSceneBoundingBox();a=new b.three.Box3(a.min,a.max);b._boundingSphere=new b.three.Sphere;a.getBoundingSphere(b._boundingSphere)});this._apiWrapper.addDragMoveListener(function(a){var c=
a.scenePath.substring(a.scenePath.indexOf(".lightHelperGeometry_")+21),e=b._offsets[c],f=b._scenePathHelper.extractPropertyFromPath(c);c=b.getLightDefinitionFromItemId(c);a=a.obj.position.clone().add(e);b.handlePositionAndLightDefinitionFromDirectionalLight(a,c);e=b._apiWrapper.convertTo2D(a);var h=b._dragControlsCache.get(c,f).svg;b.setSvgPositionAndScale(h,e.clientX,e.clientY);c.properties[f]={x:a.x,y:a.y,z:a.z};b._apiWrapper.updateLight(c);b._events.trigger(module$src$modules$shapediver_lights_drag_controls$src$enums$enums.default.LightControlsEvents.UPDATED,
c)});this._apiWrapper.addDragEndListener(function(a){b._dragging=!1;var c=[],e=a.scenePath.substring(a.scenePath.indexOf(".lightHelperGeometry_")+21),f=b._offsets[e];f=a.obj.position.clone().add(f);var h=!1;a=b.getLightDefinitionFromItemId(e);if(b._apiWrapper.isDirectionalLight(a)){new b.three.Vector3(0,0,0);h=b.getBoundingSphere();f=h.center;h=h.radius;var g=(new b.three.Vector3(a.properties.direction.x,a.properties.direction.y,a.properties.direction.z)).normalize();g.multiplyScalar(2.35*h);f=g.add(f);
h=!0}g=b.createAssetDefinition(e,f);h&&(c.push(g.geometryAssetDefinition),b._offsets[e]=new b.three.Vector3(f.x,f.y,f.z));b._dragControlsCache.put(a,"position",null,g.anchorAssetDefinition,h?g.geometryAssetDefinition:null);c.push(g.anchorAssetDefinition);b._apiWrapper.updateAsync(c)})};a.prototype.createAssetDefinition=function(b,a){var c=new this.three.Mesh(new this.three.SphereGeometry(this._dist,2,2),new this.three.MeshBasicMaterial({color:16776960,opacity:0,transparent:!0}));c.geometry.applyMatrix((new this.three.Matrix4).makeTranslation(a.x,
a.y,a.z));var e=this._createDefinitions.createGeometryAssetDefinition();e.id="lightHelperGeometry_"+b;e.content[0].data.threeObject=c;c=this._createDefinitions.createAnchorAssetDefinition();c.id="lightHelperAnchor_"+b;c.content[0].data[0].location=a;c.content[0].data[0].data.text=b;return{geometryAssetDefinition:e,anchorAssetDefinition:c}};a.prototype.createPolygonElement=function(){var b=document.createElementNS("http://www.w3.org/2000/svg","polygon");b.setAttribute("fill","none");b.setAttribute("stroke",
"#000");b.setAttribute("stroke-width","1.03");b.setAttribute("points","10 2 12.63 7.27 18.5 8.12 14.25 12.22 15.25 18 10 15.27 4.75 18 5.75 12.22 1.5 8.12 7.37 7.27");return b};a.prototype.createPolylineHtmlElements=function(){var b=document.createElementNS("http://www.w3.org/2000/svg","polyline");b.setAttribute("fill","none");b.setAttribute("stroke","#000");b.setAttribute("stroke-width","1.03");b.setAttribute("points","10 6 14 10 10 14");var a=document.createElementNS("http://www.w3.org/2000/svg",
"polyline");a.setAttribute("fill","none");a.setAttribute("stroke","#000");a.setAttribute("stroke-width","1.03");a.setAttribute("points","6 6 10 10 6 14");return[b,a]};a.prototype.getBoundingSphere=function(b){void 0===b&&(b=!1);if(!this._boundingSphere||b)b=this._apiWrapper.getSceneBoundingBox(),b=new this.three.Box3(b.min,b.max),this._boundingSphere=new this.three.Sphere,b.getBoundingSphere(this._boundingSphere);return this._boundingSphere};a.prototype.getLightDefinitionFromItemId=function(b){return this._apiWrapper.getLight(this._scenePathHelper.extractLightIdFromPath(b))};
a.prototype.getSceneAndLightBoundingBox=function(){var b=this._apiWrapper.getSceneBoundingBox();b=new this.three.Box3(b.min,b.max);var a=b.getBoundingSphere(),d=a.center;a=a.radius;var e=this._apiWrapper.getLightScene().lights,f;for(f in e){var h=e[f];this._apiWrapper.isSpotLight(h)&&b.union((new this.three.Box3).setFromPoints([new this.three.Vector3(h.properties.position.x,h.properties.position.y,h.properties.position.z),d.clone().add(d.clone().sub(new this.three.Vector3(h.properties.position.x,
h.properties.position.y,h.properties.position.z))),new this.three.Vector3(h.properties.target.x,h.properties.target.y,h.properties.target.z),d.clone().add(d.clone().sub(new this.three.Vector3(h.properties.target.x,h.properties.target.y,h.properties.target.z)))]));this._apiWrapper.isDirectionalLight(h)&&b.union((new this.three.Box3).setFromPoints([d.clone().add((new this.three.Vector3(h.properties.direction.x,h.properties.direction.y,h.properties.direction.z)).normalize().multiplyScalar(2.35*a)),d.clone().add((new this.three.Vector3(h.properties.direction.x,
h.properties.direction.y,h.properties.direction.z)).normalize().multiplyScalar(-2.35*a))]));this._apiWrapper.isPointLight(h)&&b.union((new this.three.Box3).setFromPoints([new this.three.Vector3(h.properties.position.x,h.properties.position.y,h.properties.position.z),d.clone().add(d.clone().sub(new this.three.Vector3(h.properties.position.x,h.properties.position.y,h.properties.position.z)))]))}return b};a.prototype.handlePositionAndLightDefinitionFromDirectionalLight=function(b,a){if(this._apiWrapper.isDirectionalLight(a)){var c=
this.getBoundingSphere(),e=c.center;c=c.radius;a.properties.direction=(new this.three.Vector3(b.x,b.y,b.z)).sub(new this.three.Vector3(e.x,e.y,e.z)).normalize();a=a.properties.direction.clone();a.multiplyScalar(2.35*c);e=(new this.three.Vector3(e.x,e.y,e.z)).add(a);b.x=e.x;b.y=e.y;b.z=e.z}};a.prototype.setSvgPositionAndScale=function(b,a,d){if(b.firstElementChild||b.innerHTML){a=a-this._currentScale/2-this._domRect.left;d=d-this._currentScale/2-this._domRect.top;var c=this._domEl.clientWidth-b.clientWidth,
f=this._domEl.clientHeight-b.clientHeight;c=!(0>a||a>c||0>d||d>f);this._apiWrapper.getLightHelpersVisible()&&c?(b.style.visibility="visible",b.setAttribute("width",this._currentScale),b.setAttribute("height",this._currentScale),b.style.left=a+"px",b.style.top=d+"px"):b.style.visibility="hidden"}};return a}();var module$src$modules$shapediver_lights_drag_controls$app={default:{}};Object.defineProperty(module$src$modules$shapediver_lights_drag_controls$app.default,"__esModule",{value:!0});var LightControls_1$$module$src$modules$shapediver_lights_drag_controls$app=module$src$modules$shapediver_lights_drag_controls$src$LightControls.default,enums_1$$module$src$modules$shapediver_lights_drag_controls$app=module$src$modules$shapediver_lights_drag_controls$src$enums$enums.default;
module$src$modules$shapediver_lights_drag_controls$app.default.ShapeDiverDragControls=function(){function a(b,a){var c=this;this.api=b;this.three=a;this.registeredLightEvents={};this.controls=new module$src$modules$shapediver_lights_drag_controls$src$LightControls.default.LightControls(b,a);this.controls.events.on(module$src$modules$shapediver_lights_drag_controls$src$enums$enums.default.LightControlsEvents.UPDATED,function(b){if(c.registeredLightEvents[b.id])c.registeredLightEvents[b.id](b)})}a.prototype.clearOnLightUpdateEvents=
function(b){delete this.registeredLightEvents[b]};a.prototype.makeLightDraggable=function(b){this.controls.makeLightDraggable(b)};a.prototype.makeLightDraggableAndZoomAsync=function(b){this.controls.makeLightDraggableAndZoomAsync(b)};a.prototype.onLightUpdate=function(b,a){this.registeredLightEvents[b]=a};a.prototype.updateLight=function(b){this.controls.update(b)};a.prototype.useLightHelpers=function(b){this.controls.useLightHelpers(b)};a.prototype.zoomAsync=function(){this.controls.zoomAsync()};
return a}();var module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver={default:{}},__awaiter$$module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver=this&&module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver.default.__awaiter||function(a,b,c,d){function e(b){return b instanceof c?b:new c(function(a){a(b)})}return new (c||(c=Promise))(function(c,h){function f(b){try{l(d.next(b))}catch(n){h(n)}}function k(b){try{l(d["throw"](b))}catch(n){h(n)}}function l(b){b.done?
c(b.value):e(b.value).then(f,k)}l((d=d.apply(a,b||[])).next())})},__generator$$module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver=this&&module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver.default.__generator||function(a,b){function c(b){return function(a){return d([b,a])}}function d(c){if(f)throw new TypeError("Generator is already executing.");for(;e;)try{if(f=1,h&&(g=c[0]&2?h["return"]:c[0]?h["throw"]||((g=h["return"])&&g.call(h),0):h.next)&&!(g=g.call(h,
c[1])).done)return g;if(h=0,g)c=[c[0]&2,g.value];switch(c[0]){case 0:case 1:g=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(g=e.trys,g=0<g.length&&g[g.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3]))e.label=c[1];else if(6===c[0]&&e.label<g[1])e.label=g[1],g=c;else if(g&&e.label<g[2])e.label=g[2],e.ops.push(c);else{g[2]&&e.ops.pop();e.trys.pop();continue}}c=b.call(a,
e)}catch(m){c=[6,m],h=0}finally{f=g=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},f,h,g,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k};Object.defineProperty(module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver.default,"__esModule",{value:!0});
module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver.default.SDControlsDependenciesResolver=function(){function a(b){this._useSpectrum=b;this._dependenciesPromise=null;this.resolveDependenciesAsync()}a.prototype.resolveDependenciesAsync=function(){return __awaiter$$module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver(this,void 0,void 0,function(){var b=this;return __generator$$module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver(this,function(a){null==
this._dependenciesPromise&&(this._dependenciesPromise=new Promise(function(a){return __awaiter$$module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver(b,void 0,void 0,function(){return __generator$$module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver(this,function(b){switch(b.label){case 0:return this._useSpectrum?[4,this.resolveScript("sdv-jquery","https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js","sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=")]:
[3,3];case 1:return b.sent(),[4,this.resolveScript("sdv-spectrum","https://viewer.shapediver.com/external/spectrum.js?v=1908130856")];case 2:b.sent(),b.label=3;case 3:return a(!0),[2]}})})}));return[2,this._dependenciesPromise]})})};a.prototype.resolveLink=function(b,a,d){return __awaiter$$module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver(this,void 0,void 0,function(){return __generator$$module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver(this,function(c){return[2,
new Promise(function(c){var e=document.getElementById(b);null==e&&(e=document.createElement("link"),e.id=b,e.rel="stylesheet",e.type="text/css",e.media="all",e.crossOrigin="anonymous",d&&(e.integrity=d),e.addEventListener("load",function(){e.setAttribute("loaded","true");c(!0)}),document.head.appendChild(e),e.href=a);"true"===e.getAttribute("loaded")?c(!0):e.addEventListener("load",function(){e.setAttribute("loaded","true");c(!0)})})]})})};a.prototype.resolveScript=function(b,a,d){return __awaiter$$module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver(this,
void 0,void 0,function(){return __generator$$module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver(this,function(c){return[2,new Promise(function(c){var e=document.getElementById(b);null==e&&(e=document.createElement("script"),e.id=b,e.crossOrigin="anonymous",d&&(e.integrity=d),e.addEventListener("load",function(){e.setAttribute("loaded","true");c(!0)}),document.head.appendChild(e),e.src=a);"true"==e.getAttribute("loaded")?c(!0):e.addEventListener("load",function(){e.setAttribute("loaded",
"true");c(!0)})})]})})};return a}();var module$src$api$apps$sd_controls$custom_components$BaseCustomComponent={default:{}};Object.defineProperty(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default,"__esModule",{value:!0});
module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent=function(){function a(b,a,d,e,f,h){void 0===h&&(h=!1);this._type=b;this._id=a;this._parameterDefinition=d;this._parent=e;this._domManager=f;this._editMode=h;this._children=[];this._labelClasses="uk-width-expand uk-form-label uk-text-small uk-margin-small-bottom uk-padding-remove uk-text-uppercase uk-text-truncate".split(" ");this._inputContainerClasses=["uk-width-1-1","uk-padding-remove"];this._rowId=
this._id+"-controlmenu-row";this._labelId=this._id+"-label";this._inputContainerId=this._id+"-input-container"}Object.defineProperty(a.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"inputComponent",{get:function(){return this._inputComponent},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"label",
{get:function(){return this._label},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"order",{get:function(){return this._parameterDefinition.order||1},set:function(b){this._parameterDefinition.order=b},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"row",{get:function(){return this._row},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0});a.prototype.destroy=function(){this._row.remove()};
a.prototype.insertBefore=function(b){this.row.parentNode&&this.row.parentNode.insertBefore(this.row,b.row)};a.prototype.createElement=function(){this.createRow();this.createLabel();this.createInputContainer();this.createInput()};a.prototype.createInputContainer=function(){this._inputContainer=this._domManager.createDomElement("div",this._inputContainerId,this._row,this._inputContainerClasses)};a.prototype.createLabel=function(){this._label=this._domManager.createDomElement("label",this._labelId,this._row,
this._labelClasses,{title:this._parameterDefinition.name});this._label.innerHTML=this._parameterDefinition.name;this._editMode&&this._label.classList.add("sdv-edit-mode")};a.prototype.createRow=function(){this._row=this._domManager.createDomElement("div",this._rowId,this._parent,["sd-max-width-1","uk-padding-small","uk-margin-remove","sdv-control-panel-row-border"],{"uk-grid":'margin: "";'})};return a}();var module$src$api$apps$sd_controls$custom_components$StringInputCustomComponent={default:{}},__extends$$module$src$api$apps$sd_controls$custom_components$StringInputCustomComponent=this&&module$src$api$apps$sd_controls$custom_components$StringInputCustomComponent.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return a(b,c)};return function(b,c){function d(){this.constructor=
b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$custom_components$StringInputCustomComponent.default,"__esModule",{value:!0});
var enums_1$$module$src$api$apps$sd_controls$custom_components$StringInputCustomComponent=module$src$api$apps$sd_controls$enums$enums.default,BaseCustomComponent_1$$module$src$api$apps$sd_controls$custom_components$StringInputCustomComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default,interfaces_1$$module$src$api$apps$sd_controls$custom_components$StringInputCustomComponent=module$src$interfaces$api$apps$sd_controls$interfaces.default;
module$src$api$apps$sd_controls$custom_components$StringInputCustomComponent.default.StringInputCustomComponent=function(a){function b(b,d,e,f,h){void 0===h&&(h=!1);d=a.call(this,module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.STRING,b,d,e,f,h)||this;d._inputAttributes={type:"text"};d._inputClassList=["uk-input","uk-form-small"];d._inputId=b+"-text";d.createElement();d.createInputEvents();return d}__extends$$module$src$api$apps$sd_controls$custom_components$StringInputCustomComponent(b,
a);Object.defineProperty(b.prototype,"size",{get:function(){return module$src$interfaces$api$apps$sd_controls$interfaces.default.ControlElementSize.QTR_WIDTH},enumerable:!0,configurable:!0});b.prototype.createInput=function(){this._inputAttributes.name=this._inputId+"-text";this._inputComponent=this._domManager.createDomElement("input",this._inputId,this._inputContainer,this._inputClassList,this._inputAttributes);this._parameterDefinition.max&&(this._inputComponent.maxLength=this._parameterDefinition.max);
this._parameterDefinition.value&&(this._inputComponent.value=this._parameterDefinition.value)};b.prototype.createInputEvents=function(){this._domManager.setDomEventListener(this._inputComponent,"input",1E3,this.update.bind(this))};b.prototype.update=function(b,a){this._parameterDefinition.update(b)};return b}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$custom_components$BooleanInputCustomComponent={default:{}},__extends$$module$src$api$apps$sd_controls$custom_components$BooleanInputCustomComponent=this&&module$src$api$apps$sd_controls$custom_components$BooleanInputCustomComponent.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return a(b,c)};return function(b,
c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$custom_components$BooleanInputCustomComponent.default,"__esModule",{value:!0});
var enums_1$$module$src$api$apps$sd_controls$custom_components$BooleanInputCustomComponent=module$src$api$apps$sd_controls$enums$enums.default,BaseCustomComponent_1$$module$src$api$apps$sd_controls$custom_components$BooleanInputCustomComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default,interfaces_1$$module$src$api$apps$sd_controls$custom_components$BooleanInputCustomComponent=module$src$interfaces$api$apps$sd_controls$interfaces.default;
module$src$api$apps$sd_controls$custom_components$BooleanInputCustomComponent.default.BooleanInputCustomComponent=function(a){function b(b,d,e,f,h){void 0===h&&(h=!1);d=a.call(this,module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.CHECKBOX,b,d,e,f,h)||this;d._inputId=b+"-checkbox";d._forName=d.id+"-checkbox";d.createElement();d.createInputEvents();return d}__extends$$module$src$api$apps$sd_controls$custom_components$BooleanInputCustomComponent(b,a);Object.defineProperty(b.prototype,
"inputCheckboxContainer",{get:function(){return this._inputCheckboxContainer},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"size",{get:function(){return module$src$interfaces$api$apps$sd_controls$interfaces.default.ControlElementSize.QTR_WIDTH},enumerable:!0,configurable:!0});b.prototype.createInput=function(){this._boolContainer=this._domManager.createDomElement("label",this.id+"-checkbox-label",this._inputContainer,["sdv-control-panel-boolean-input-checkbox-label"],{for:this._forName,
"data-friendly-name":this._parameterDefinition.name});this._inputComponent=this._domManager.createDomElement("input",this._inputId,this._boolContainer,["shapediver-viewer-element","sdv-control-panel-control","sdv-control-panel-boolean-input-checkbox"],{type:"checkbox",name:this._forName});this._inputCheckboxContainer=this._domManager.createDomElement("div",this.id+"-checkbox-helper",this._boolContainer,["sdv-control-panel-boolean-input-boxhelper"],{for:this._forName});this._parameterDefinition.value&&
(this._inputComponent.value=this._parameterDefinition.value)};b.prototype.createInputEvents=function(){this._domManager.setDomEventListener(this._inputComponent,"change",10,this.update.bind(this))};b.prototype.update=function(b,a){this._parameterDefinition.update(a.srcElement.checked)};return b}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$custom_components$Vector3CustomComponent={default:{}},__extends$$module$src$api$apps$sd_controls$custom_components$Vector3CustomComponent=this&&module$src$api$apps$sd_controls$custom_components$Vector3CustomComponent.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return a(b,c)};return function(b,c){function d(){this.constructor=
b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$custom_components$Vector3CustomComponent.default,"__esModule",{value:!0});
var BaseCustomComponent_1$$module$src$api$apps$sd_controls$custom_components$Vector3CustomComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default,enums_1$$module$src$api$apps$sd_controls$custom_components$Vector3CustomComponent=module$src$api$apps$sd_controls$enums$enums.default,interfaces_1$$module$src$api$apps$sd_controls$custom_components$Vector3CustomComponent=module$src$interfaces$api$apps$sd_controls$interfaces.default;
module$src$api$apps$sd_controls$custom_components$Vector3CustomComponent.default.Vector3CustomComponent=function(a){function b(b,d,e,f,h){void 0===h&&(h=!1);b=a.call(this,module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.VECTOR3,b,d,e,f,h)||this;b._step=1;b._inputContainerClasses=["uk-width-1-1","uk-padding-remove","uk-margin-remove"];b._parameterDefinition.step&&(b._step=b._parameterDefinition.step);b._value={x:0,y:0,z:0};b._parameterDefinition.value&&(d=b._parameterDefinition.value,
b._value={x:d.x||0,y:d.y||0,z:d.z||0});b.createElement();b.createInputEvents();return b}__extends$$module$src$api$apps$sd_controls$custom_components$Vector3CustomComponent(b,a);Object.defineProperty(b.prototype,"inputComponent",{get:function(){return this._inputContainer},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"size",{get:function(){return module$src$interfaces$api$apps$sd_controls$interfaces.default.ControlElementSize.QTR_WIDTH},enumerable:!0,configurable:!0});b.prototype.createInput=
function(){this._inputContainer.setAttribute("uk-grid","");this._xContainer=this.createContainerElement("x");this._yContainer=this.createContainerElement("y");this._zContainer=this.createContainerElement("z");this._xLabel=this.createLabelElement("x",this._xContainer);this._yLabel=this.createLabelElement("y",this._yContainer);this._zLabel=this.createLabelElement("z",this._zContainer);this._xInput=this.createInputElement("x",this._xContainer);this._yInput=this.createInputElement("y",this._yContainer);
this._zInput=this.createInputElement("z",this._zContainer)};b.prototype.createInputEvents=function(){this._domManager.setDomEventListener(this._xInput,"input",1E3,this.update.bind(this));this._domManager.setDomEventListener(this._yInput,"input",1E3,this.update.bind(this));this._domManager.setDomEventListener(this._zInput,"input",1E3,this.update.bind(this));this._domManager.setDomEventListener(this._xInput,"focusout",10,this.update.bind(this));this._domManager.setDomEventListener(this._yInput,"focusout",
10,this.update.bind(this));this._domManager.setDomEventListener(this._zInput,"focusout",10,this.update.bind(this));this._domManager.setDomEventListener(this._xInput,"keyup",10,this.updateKeyUp.bind(this));this._domManager.setDomEventListener(this._yInput,"keyup",10,this.updateKeyUp.bind(this));this._domManager.setDomEventListener(this._zInput,"keyup",10,this.updateKeyUp.bind(this))};b.prototype.update=function(b,a){a=a.srcElement.getAttribute("data-component");this._value[a]=Number(Number(b).toFixed(this._step));
this._parameterDefinition.update(this._value)};b.prototype.createContainerElement=function(b){return this._domManager.createDomElement("div",this.id+"-vector-"+b+"-container",this._inputContainer,["uk-width-3-3","uk-padding-remove-left","vector3-container","uk-form-custom"])};b.prototype.createInputElement=function(b,a){var c={type:"number",name:this.id+"-number-"+b,"data-component":b};this._parameterDefinition.step&&(c.step=this._parameterDefinition.step);this._parameterDefinition.min&&(c.min=this._parameterDefinition.min);
this._parameterDefinition.max&&(c.max=this._parameterDefinition.max);a=this._domManager.createDomElement("input",this.id+"-number-"+b,a,["uk-input","uk-form-small","sd-input-number","uk-width-2-3"],c);a.value=this._value[b];return a};b.prototype.createLabelElement=function(b,a){a=this._domManager.createDomElement("label",this.id+"-vector-"+b+"-label",a,["vector3-label"],{for:this.id+"-number-"+b});a.innerHTML=b.toUpperCase();return a};b.prototype.updateKeyUp=function(b,a){!a.which&&!a.keyCode||13!=
a.which&&13!=a.keyCode||this.update(b,a)};return b}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$custom_components$ButtonCustomComponent={default:{}},__extends$$module$src$api$apps$sd_controls$custom_components$ButtonCustomComponent=this&&module$src$api$apps$sd_controls$custom_components$ButtonCustomComponent.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return a(b,c)};return function(b,c){function d(){this.constructor=
b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$custom_components$ButtonCustomComponent.default,"__esModule",{value:!0});
var interfaces_1$$module$src$api$apps$sd_controls$custom_components$ButtonCustomComponent=module$src$interfaces$api$apps$sd_controls$interfaces.default,BaseCustomComponent_1$$module$src$api$apps$sd_controls$custom_components$ButtonCustomComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default,enums_1$$module$src$api$apps$sd_controls$custom_components$ButtonCustomComponent=module$src$api$apps$sd_controls$enums$enums.default;
module$src$api$apps$sd_controls$custom_components$ButtonCustomComponent.default.ButtonCustomComponent=function(a){function b(b,d,e,f,h){void 0===h&&(h=!1);d=a.call(this,module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.BUTTON,b,d,e,f,h)||this;d._inputId=b+"-text";d.createElement();d.createInputEvents();return d}__extends$$module$src$api$apps$sd_controls$custom_components$ButtonCustomComponent(b,a);Object.defineProperty(b.prototype,"size",{get:function(){return module$src$interfaces$api$apps$sd_controls$interfaces.default.ControlElementSize.QTR_WIDTH},
enumerable:!0,configurable:!0});b.prototype.createInput=function(){this._row.removeChild(this._label);var b=this.id+"-button";this._inputComponent=this._domManager.createDomElement("button",b,this._inputContainer,"uk-button uk-button-default uk-button-small uk-width-expand text-transform-none uk-padding-remove sd-control-button".split(" "),{type:"button",name:b});this._inputComponent.innerHTML=this._parameterDefinition.name};b.prototype.createInputEvents=function(){this._domManager.setDomEventListener(this._inputComponent,
"click",10,this.update.bind(this))};b.prototype.update=function(b,a){this._parameterDefinition.update(!0)};return b}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$custom_components$ChecklistCustomComponent={default:{}},__extends$$module$src$api$apps$sd_controls$custom_components$ChecklistCustomComponent=this&&module$src$api$apps$sd_controls$custom_components$ChecklistCustomComponent.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return a(b,c)};return function(b,c){function d(){this.constructor=
b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$custom_components$ChecklistCustomComponent.default,"__esModule",{value:!0});
var interfaces_1$$module$src$api$apps$sd_controls$custom_components$ChecklistCustomComponent=module$src$interfaces$api$apps$sd_controls$interfaces.default,BaseCustomComponent_1$$module$src$api$apps$sd_controls$custom_components$ChecklistCustomComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default,enums_1$$module$src$api$apps$sd_controls$custom_components$ChecklistCustomComponent=module$src$api$apps$sd_controls$enums$enums.default;
module$src$api$apps$sd_controls$custom_components$ChecklistCustomComponent.default.ChecklistCustomComponent=function(a){function b(b,d,e,f,h){void 0===h&&(h=!1);d=a.call(this,module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.CHECKLIST,b,d,e,f,h)||this;d._choices=[];d._currentValues=[];d._preselectedValues=[];d._inputComponents=[];d._inputId=b+"-checklist";Array.isArray(d._parameterDefinition.choices)&&(d._choices=d._parameterDefinition.choices);Array.isArray(d._parameterDefinition.value)&&
(d._preselectedValues=d._parameterDefinition.value);d.createElement();d.createInputEvents();return d}__extends$$module$src$api$apps$sd_controls$custom_components$ChecklistCustomComponent(b,a);Object.defineProperty(b.prototype,"inputComponent",{get:function(){return this._form},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"size",{get:function(){return module$src$interfaces$api$apps$sd_controls$interfaces.default.ControlElementSize.HALF_WIDTH},enumerable:!0,configurable:!0});b.prototype.createInput=
function(){this._form=this._domManager.createDomElement("form",this.id+"-form",this._inputContainer,["sdv-control-panel-control","sdv-control-panel-dropdown-input-form"]);for(var b=0;b<this._choices.length;b++){var a=this._choices[b],e=this._domManager.createDomElement("div",null,this._form);e=this._domManager.createDomElement("label",this.id+"-label-"+b,e,["sdv-control-panel-checklist-input-checkbox-label"]);e.innerHTML=a;var f=this.id+"-checkbox-"+b,h=this._domManager.createDomElement("input",f,
e,[],{type:"checkbox",name:f});h.innerHTML=a;h.value=a;h.checked=this._preselectedValues.includes(a);h.checked&&this._currentValues.push(a);this._domManager.createDomElement("div",this.id+"-checkbox-helper",e,["sdv-control-panel-checklist-input-boxhelper"],{for:f});this._inputComponents.push(h)}};b.prototype.createInputEvents=function(){for(var b=0;b<this._inputComponents.length;b++)this._domManager.setDomEventListener(this._inputComponents[b],"change",10,this.update.bind(this))};b.prototype.update=
function(b,a){this._currentValues.includes(b)?this._currentValues.splice(this._currentValues.indexOf(b),1):this._currentValues.push(b);this._parameterDefinition.update(this._currentValues)};return b}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$custom_components$ColorCustomComponent={default:{}},__extends$$module$src$api$apps$sd_controls$custom_components$ColorCustomComponent=this&&module$src$api$apps$sd_controls$custom_components$ColorCustomComponent.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return a(b,c)};return function(b,c){function d(){this.constructor=
b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$custom_components$ColorCustomComponent.default,"__esModule",{value:!0});
var BaseCustomComponent_1$$module$src$api$apps$sd_controls$custom_components$ColorCustomComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default,enums_1$$module$src$api$apps$sd_controls$custom_components$ColorCustomComponent=module$src$api$apps$sd_controls$enums$enums.default,interfaces_1$$module$src$api$apps$sd_controls$custom_components$ColorCustomComponent=module$src$interfaces$api$apps$sd_controls$interfaces.default;
module$src$api$apps$sd_controls$custom_components$ColorCustomComponent.default.ColorCustomComponent=function(a){function b(b,d,e,f,h,g,k){void 0===k&&(k=!1);d=a.call(this,module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.COLOR,b,d,e,f,k)||this;d._useSpectrum=h;d._sdTinyColorFactory=g;d._inputId=b+"-color";d._defaultValue=g.createTinyColor(d._parameterDefinition.value);d.createElement();d.createInputEvents();return d}__extends$$module$src$api$apps$sd_controls$custom_components$ColorCustomComponent(b,
a);Object.defineProperty(b.prototype,"colorPicker",{get:function(){return this._colorPicker},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"size",{get:function(){return module$src$interfaces$api$apps$sd_controls$interfaces.default.ControlElementSize.QTR_WIDTH},enumerable:!0,configurable:!0});b.prototype.createInput=function(){this._useSpectrum?this.createSpectrumControls():this.createNonSpectrumControls()};b.prototype.createInputEvents=function(){this._domManager.setDomEventListener(this._inputComponent,
"change",10,this.update.bind(this))};b.prototype.update=function(b,a){this._parameterDefinition.update(b)};b.prototype.createNonSpectrumControls=function(){this._inputComponent=this._domManager.createDomElement("input",this._inputId,this._inputContainer,["uk-input","uk-form-small","uk-form-width-xsmall"],{name:this._inputId});this._inputComponent.setAttribute("type","color");this._inputComponent.value=this._defaultValue.toHexString();this._colorPicker=this._inputComponent};b.prototype.createSpectrumControls=
function(){var b=this;this._inputComponent=this._domManager.createDomElement("input",this._inputId,this._inputContainer,["uk-hidden"],{type:"text"});$("#"+this._inputId).spectrum({color:this._defaultValue.toRgbString(),replacerClassName:"uk-padding-remove",showInput:!0,showInitial:!0,preferredFormat:"rgb",change:function(a){b._inputComponent.setAttribute("value",a.toHexString());a=document.createEvent("Event");a.initEvent("change",!1,!0);b._inputComponent.dispatchEvent(a)}});this._colorPicker=this.row.getElementsByClassName("sp-replacer")[0]};
return b}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$custom_components$DropdownCustomComponent={default:{}},__extends$$module$src$api$apps$sd_controls$custom_components$DropdownCustomComponent=this&&module$src$api$apps$sd_controls$custom_components$DropdownCustomComponent.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return a(b,c)};return function(b,c){function d(){this.constructor=
b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$custom_components$DropdownCustomComponent.default,"__esModule",{value:!0});
var BaseCustomComponent_1$$module$src$api$apps$sd_controls$custom_components$DropdownCustomComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default,interfaces_1$$module$src$api$apps$sd_controls$custom_components$DropdownCustomComponent=module$src$interfaces$api$apps$sd_controls$interfaces.default,enums_1$$module$src$api$apps$sd_controls$custom_components$DropdownCustomComponent=module$src$api$apps$sd_controls$enums$enums.default;
module$src$api$apps$sd_controls$custom_components$DropdownCustomComponent.default.DropdownCustomComponent=function(a){function b(b,d,e,f,h){void 0===h&&(h=!1);d=a.call(this,module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.DROPDOWN,b,d,e,f,h)||this;d._choicesElements={};d._inputId=b+"-form";d._choices=d._parameterDefinition.choices;d.createElement();d.createInputEvents();return d}__extends$$module$src$api$apps$sd_controls$custom_components$DropdownCustomComponent(b,a);Object.defineProperty(b.prototype,
"size",{get:function(){return module$src$interfaces$api$apps$sd_controls$interfaces.default.ControlElementSize.HALF_WIDTH},enumerable:!0,configurable:!0});b.prototype.createInput=function(){this._inputComponent=this._domManager.createDomElement("select",this._inputId,this._inputContainer,["uk-select","uk-form-small","uk-width-expand"]);for(var b in this._choices){var a=this.id+"-option-"+b;a=this._domManager.createDomElement("option",a,this._inputComponent,[],{name:a});a.innerHTML=this._choices[b];
a.selected=this._choices[b]==this._parameterDefinition.value;this._choicesElements["cOption"+b]=a}this._inputComponent.value=this._parameterDefinition.value};b.prototype.createInputEvents=function(){this._domManager.setDomEventListener(this._inputComponent,"change",10,this.update.bind(this))};b.prototype.update=function(b,a){this._parameterDefinition.update(b)};return b}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$custom_components$FileCustomComponent={default:{}},__extends$$module$src$api$apps$sd_controls$custom_components$FileCustomComponent=this&&module$src$api$apps$sd_controls$custom_components$FileCustomComponent.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return a(b,c)};return function(b,c){function d(){this.constructor=
b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$custom_components$FileCustomComponent.default,"__esModule",{value:!0});
var BaseCustomComponent_1$$module$src$api$apps$sd_controls$custom_components$FileCustomComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default,enums_1$$module$src$api$apps$sd_controls$custom_components$FileCustomComponent=module$src$api$apps$sd_controls$enums$enums.default,interfaces_1$$module$src$api$apps$sd_controls$custom_components$FileCustomComponent=module$src$interfaces$api$apps$sd_controls$interfaces.default,SDFile$$module$src$api$apps$sd_controls$custom_components$FileCustomComponent=
function(a){function b(){return null!==a&&a.apply(this,arguments)||this}__extends$$module$src$api$apps$sd_controls$custom_components$FileCustomComponent(b,a);Object.defineProperty(b.prototype,"sdtype",{get:function(){return this._type},set:function(b){this._type=b},enumerable:!0,configurable:!0});return b}(File);
module$src$api$apps$sd_controls$custom_components$FileCustomComponent.default.FileCustomComponent=function(a){function b(b,d,e,f,h,g){void 0===g&&(g=!1);b=a.call(this,module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.FILE,b,d,e,f,g)||this;b._fileHelper=h;b._inputId=b.id+"-button";b.createElement();b.createInputEvents();return b}__extends$$module$src$api$apps$sd_controls$custom_components$FileCustomComponent(b,a);Object.defineProperty(b.prototype,"size",{get:function(){return module$src$interfaces$api$apps$sd_controls$interfaces.default.ControlElementSize.QTR_WIDTH},
enumerable:!0,configurable:!0});b.prototype.createInput=function(){this._inputComponent=this._domManager.createDomElement("button",this._inputId,this._inputContainer,"uk-button uk-button-default uk-button-small uk-width-expand text-transform-none uk-padding-remove sd-control-button".split(" "),{type:"button",name:this._inputId});this._inputComponent.innerHTML="Select file...";var b=this._id+"-file";this._fileInput=this._domManager.createDomElement("input",b,this._inputContainer,[],{type:"file",name:b});
this._fileInput.style.display="none";this._fileInput.multiple=!0;this._parameterDefinition.accept&&(b=this._parameterDefinition.accept,"string"===typeof b&&(b=[b]),this._fileInput.accept=b.join(","))};b.prototype.createInputEvents=function(){var b=this;this._domManager.setDomEventListener(this._inputComponent,"click",10,function(){return b._fileInput.click()});this._domManager.setDomEventListener(this._fileInput,"change",10,this.update.bind(this));this.inputComponent.addEventListener("dragenter",
this.dragHandler,!1);this.inputComponent.addEventListener("dragover",this.dragHandler,!1);this.inputComponent.addEventListener("drop",this.dropHandler,!1)};b.prototype.update=function(b,a){this._parameterDefinition.update(this._fileInput.files)};b.prototype.dragHandler=function(b){b.stopPropagation();b.preventDefault()};b.prototype.dropHandler=function(b){this.dragHandler(b);b.dataTransfer&&(this._fileList=b.dataTransfer.files)};return b}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$custom_components$ModalCustomComponent={default:{}},__extends$$module$src$api$apps$sd_controls$custom_components$ModalCustomComponent=this&&module$src$api$apps$sd_controls$custom_components$ModalCustomComponent.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return a(b,c)};return function(b,c){function d(){this.constructor=
b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$custom_components$ModalCustomComponent.default,"__esModule",{value:!0});
var BaseCustomComponent_1$$module$src$api$apps$sd_controls$custom_components$ModalCustomComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default,enums_1$$module$src$api$apps$sd_controls$custom_components$ModalCustomComponent=module$src$api$apps$sd_controls$enums$enums.default,interfaces_1$$module$src$api$apps$sd_controls$custom_components$ModalCustomComponent=module$src$interfaces$api$apps$sd_controls$interfaces.default;
module$src$api$apps$sd_controls$custom_components$ModalCustomComponent.default.ModalCustomComponent=function(a){function b(b,d,e,f,h){void 0===h&&(h=!1);b=a.call(this,module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.MODAL,b,d,e,f,h)||this;b._inputId="button_"+b.id;b._modalId="shapediver_modal_"+b.id;b.createElement();b.createInputEvents();return b}__extends$$module$src$api$apps$sd_controls$custom_components$ModalCustomComponent(b,a);Object.defineProperty(b.prototype,"size",
{get:function(){return module$src$interfaces$api$apps$sd_controls$interfaces.default.ControlElementSize.QTR_WIDTH},enumerable:!0,configurable:!0});b.prototype.destory=function(){a.prototype.destroy.call(this);this._modalElem.remove()};b.prototype.createInput=function(){this._inputComponent=this._domManager.createDomElement("button",this._inputId,this._inputContainer,"uk-button uk-button-default uk-button-small uk-width-expand text-transform-none uk-padding-remove sd-control-button".split(" "),{type:"button",
name:this._inputId,"uk-toggle":"target: #"+this._modalId});this._inputComponent.innerHTML=this._parameterDefinition.name;this._modalElem=this._domManager.createDomElement("div",this._modalId,document.getElementsByTagName("body")[0],[],{"uk-modal":""});this._modalElem.innerHTML='<div class="uk-modal-dialog uk-modal-body">'+this._parameterDefinition.modalContent+"</div>"};b.prototype.createInputEvents=function(){};b.prototype.createLabel=function(){};b.prototype.update=function(b,a){};return b}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$custom_components$SliderCustomComponent={default:{}},__extends$$module$src$api$apps$sd_controls$custom_components$SliderCustomComponent=this&&module$src$api$apps$sd_controls$custom_components$SliderCustomComponent.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return a(b,c)};return function(b,c){function d(){this.constructor=
b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$custom_components$SliderCustomComponent.default,"__esModule",{value:!0});
var enums_1$$module$src$api$apps$sd_controls$custom_components$SliderCustomComponent=module$src$api$apps$sd_controls$enums$enums.default,BaseCustomComponent_1$$module$src$api$apps$sd_controls$custom_components$SliderCustomComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default,interfaces_1$$module$src$api$apps$sd_controls$custom_components$SliderCustomComponent=module$src$interfaces$api$apps$sd_controls$interfaces.default;
module$src$api$apps$sd_controls$custom_components$SliderCustomComponent.default.SliderCustomComponent=function(a){function b(b,d,e,f,h){void 0===h&&(h=!1);d=a.call(this,module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.SLIDER,b,d,e,f,h)||this;d._maxVal=100;d._minVal=0;d._step=1;d._value=0;d._inputId=b+"-number";d._inputRangeId=b+"-range";d._parameterDefinition.min&&(d._minVal=d._parameterDefinition.min);d._parameterDefinition.max&&(d._maxVal=d._parameterDefinition.max);d._parameterDefinition.value&&
(d._value=d._parameterDefinition.value);d._parameterDefinition.step&&(d._step=d._parameterDefinition.step);d._parameterDefinition.delay&&(d._delay=d._parameterDefinition.delay);d.createElement();d.createInputEvents();return d}__extends$$module$src$api$apps$sd_controls$custom_components$SliderCustomComponent(b,a);Object.defineProperty(b.prototype,"inputContainer",{get:function(){return this._inputContainer},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"inputRange",{get:function(){return this._inputRange},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"size",{get:function(){return module$src$interfaces$api$apps$sd_controls$interfaces.default.ControlElementSize.HALF_WIDTH},enumerable:!0,configurable:!0});b.prototype.createInput=function(){this.createRangeInput();this.createNumberInput()};b.prototype.createInputEvents=function(){var b=this._domManager.isEventSupported("input","input")?"input":"change";this._domManager.setDomEventListener(this._inputComponent,b,this._delay,this.update.bind(this));
this._domManager.setDomEventListener(this._inputComponent,"focusout",this._delay,this.update.bind(this));this._domManager.setDomEventListener(this._inputComponent,"keyup",this._delay,this.updateKeyUp.bind(this));this._domManager.setDomEventListener(this._inputRange,"input",this._delay,this.update.bind(this))};b.prototype.update=function(b,a){if("focusout"!==a.type||b!=this._inputComponent.value)this._inputComponent.value=b,this._inputRange.value=b,this._parameterDefinition.update(b)};b.prototype.createNumberInput=
function(){this._inputComponent=this._domManager.createDomElement("input",this._inputId,this._inputContainer,["uk-input","uk-width-1-3","uk-form-small","sd-input-number"],{min:this._minVal,max:this._maxVal,step:this._step,type:"number",name:this._inputId,value:this._value||"0"})};b.prototype.createRangeInput=function(){this._inputRange=this._domManager.createDomElement("input",this._inputRangeId,this._inputContainer,["uk-range","uk-width-2-3","uk-form-small","sd-input-range"],{type:"range",name:this._inputRangeId,
min:this._minVal,max:this._maxVal,step:this._step,value:this._value||"0",tabIndex:"-1"});this._domManager.userAgentIsMobileOrTabletDevice&&this._inputRange.classList.add("sd-input-range-mobile");this._domManager.userAgentIsIPadOrIPhone?this._inputRange.classList.add("ios-padding-left"):this._inputRange.classList.add("uk-padding-remove-left")};b.prototype.updateKeyUp=function(b,a){!a.which&&!a.keyCode||13!=a.which&&13!=a.keyCode||this.update(b,a)};return b}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$custom_components$GroupCustomComponent={default:{}},__extends$$module$src$api$apps$sd_controls$custom_components$GroupCustomComponent=this&&module$src$api$apps$sd_controls$custom_components$GroupCustomComponent.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return a(b,c)};return function(b,c){function d(){this.constructor=
b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$custom_components$GroupCustomComponent.default,"__esModule",{value:!0});
var BaseCustomComponent_1$$module$src$api$apps$sd_controls$custom_components$GroupCustomComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default,enums_1$$module$src$api$apps$sd_controls$custom_components$GroupCustomComponent=module$src$api$apps$sd_controls$enums$enums.default,interfaces_1$$module$src$api$apps$sd_controls$custom_components$GroupCustomComponent=module$src$interfaces$api$apps$sd_controls$interfaces.default;
module$src$api$apps$sd_controls$custom_components$GroupCustomComponent.default.GroupCustomComponent=function(a){function b(b,d,e,f,h,g){void 0===g&&(g=!1);b=a.call(this,module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.GROUP,b,d,e,f,g)||this;b._controlsFactory=h;b._accordionType="custom-parameter";b._rowId=b.id+"-controlmenu-row";b.createElement();b.createInputEvents();return b}__extends$$module$src$api$apps$sd_controls$custom_components$GroupCustomComponent(b,a);Object.defineProperty(b.prototype,
"size",{get:function(){return module$src$interfaces$api$apps$sd_controls$interfaces.default.ControlElementSize.FULL_WIDTH},enumerable:!0,configurable:!0});b.prototype.createInput=function(){var b=this;this._inputComponent=this._domManager.createDomElement("div",null,this._parametersEl,["uk-accordion-content","uk-margin-remove"],{"uk-grid":""});this._parameterDefinition.parameters.forEach(function(a){a=b._controlsFactory.createUserDefinedParameter(a,b._inputComponent,!1);b.children.push(a);a.label&&
a.label.classList.remove("uk-text-uppercase")})};b.prototype.createInputEvents=function(){this._domManager.setDomEventListener(this._ulElem,"click",10,this.closeOthers.bind(this));this._domManager.setDomEventListener(this._ulElem,"click",10,this.update.bind(this))};b.prototype.createLabel=function(){this._label=this._domManager.createDomElement("a",this.id+"-a",this._parametersEl,"uk-accordion-title uk-width-expand uk-form-label uk-text-uppercase uk-text-small uk-padding-small sdv-control-panel-row-border".split(" "));
this._label.innerHTML=this._parameterDefinition.name};b.prototype.createRow=function(){this._row=this._domManager.createDomElement("row",this._rowId,this._parent,["uk-margin-remove","uk-padding-remove","sd-max-width-1"],{"uk-grid":'margin: "";'});this._ulElem=this._domManager.createDomElement("ul",null,this._row,["uk-width-1-1"],{"uk-accordion":"multiple: false"});this._parametersEl=this._domManager.createDomElement("li",null,this._ulElem,["jq-accordion-control-li"],{"data-setting-type":this._accordionType})};
b.prototype.update=function(b,a){};b.prototype.closeOthers=function(){var b=this;Array.from(document.getElementsByClassName("jq-accordion-control-li")).forEach(function(a){a.getAttribute("data-setting-type")!=b._accordionType||b._parametersEl.isSameNode(a)||a.classList.contains("uk-open")&&UIkit.accordion(a.parentNode).toggle(0)})};return b}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$custom_components$StaticHTMLCustomComponent={default:{}},__extends$$module$src$api$apps$sd_controls$custom_components$StaticHTMLCustomComponent=this&&module$src$api$apps$sd_controls$custom_components$StaticHTMLCustomComponent.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return a(b,c)};return function(b,c){function d(){this.constructor=
b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$custom_components$StaticHTMLCustomComponent.default,"__esModule",{value:!0});
var enums_1$$module$src$api$apps$sd_controls$custom_components$StaticHTMLCustomComponent=module$src$api$apps$sd_controls$enums$enums.default,BaseCustomComponent_1$$module$src$api$apps$sd_controls$custom_components$StaticHTMLCustomComponent=module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default,interfaces_1$$module$src$api$apps$sd_controls$custom_components$StaticHTMLCustomComponent=module$src$interfaces$api$apps$sd_controls$interfaces.default;
module$src$api$apps$sd_controls$custom_components$StaticHTMLCustomComponent.default.StaticHTMLCustomComponent=function(a){function b(b,d,e,f,h){void 0===h&&(h=!1);b=a.call(this,module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.STATICHTML,b,d,e,f,h)||this;b.createElement();return b}__extends$$module$src$api$apps$sd_controls$custom_components$StaticHTMLCustomComponent(b,a);Object.defineProperty(b.prototype,"size",{get:function(){return module$src$interfaces$api$apps$sd_controls$interfaces.default.ControlElementSize.FULL_WIDTH},
enumerable:!0,configurable:!0});b.prototype.createElement=function(){this.createRow();this.row.innerHTML=this._parameterDefinition.content;this.row.classList.remove("uk-padding-small","uk-margin-remove");this.row.classList.add("uk-padding-remove-left","uk-margin-remove-left","uk-margin-remove-top")};b.prototype.createInput=function(){};b.prototype.createInputEvents=function(){};b.prototype.update=function(b,a){};return b}(module$src$api$apps$sd_controls$custom_components$BaseCustomComponent.default.BaseCustomComponent);var module$src$api$apps$sd_controls$settings_components$BaseSettingComponent={default:{}};Object.defineProperty(module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default,"__esModule",{value:!0});
module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default.BaseSettingComponent=function(){function a(b,a){this._settingDefinition=b;this._component=a}Object.defineProperty(a.prototype,"children",{get:function(){return this._component.children},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"groupId",{get:function(){return this._settingDefinition.groupId},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"id",{get:function(){return this._settingDefinition.id},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"inputComponent",{get:function(){return this._component.inputComponent},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"label",{get:function(){return this._component.label},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"order",{get:function(){return this._component.order},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"row",{get:function(){return this._component.row},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._component.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"type",{get:function(){return this._component.type},enumerable:!0,configurable:!0});a.prototype.destroy=function(){this._component.destroy()};a.prototype.insertBefore=function(b){this._component.insertBefore(b)};return a}();var module$src$api$apps$sd_controls$settings_components$StaticHTMLSettingComponent={default:{}},__extends$$module$src$api$apps$sd_controls$settings_components$StaticHTMLSettingComponent=this&&module$src$api$apps$sd_controls$settings_components$StaticHTMLSettingComponent.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return a(b,c)};return function(b,
c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$settings_components$StaticHTMLSettingComponent.default,"__esModule",{value:!0});var BaseSettingComponent_1$$module$src$api$apps$sd_controls$settings_components$StaticHTMLSettingComponent=module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default;
module$src$api$apps$sd_controls$settings_components$StaticHTMLSettingComponent.default.StaticHTMLSettingComponent=function(a){function b(b,d,e){return a.call(this,b,e.createUserDefinedParameter(b,d,!1))||this}__extends$$module$src$api$apps$sd_controls$settings_components$StaticHTMLSettingComponent(b,a);return b}(module$src$api$apps$sd_controls$settings_components$BaseSettingComponent.default.BaseSettingComponent);var module$src$api$apps$sd_controls$managers$SDControlsComponentFactory={default:{}};Object.defineProperty(module$src$api$apps$sd_controls$managers$SDControlsComponentFactory.default,"__esModule",{value:!0});
var StringInputCustomComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$custom_components$StringInputCustomComponent.default,BooleanInputCustomComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$custom_components$BooleanInputCustomComponent.default,Vector3CustomComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$custom_components$Vector3CustomComponent.default,
ButtonCustomComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$custom_components$ButtonCustomComponent.default,ChecklistCustomComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$custom_components$ChecklistCustomComponent.default,enums_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$enums$enums.default,ColorCustomComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=
module$src$api$apps$sd_controls$custom_components$ColorCustomComponent.default,DropdownCustomComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$custom_components$DropdownCustomComponent.default,FileCustomComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$custom_components$FileCustomComponent.default,ModalCustomComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=
module$src$api$apps$sd_controls$custom_components$ModalCustomComponent.default,SliderCustomComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$custom_components$SliderCustomComponent.default,GroupCustomComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$custom_components$GroupCustomComponent.default,StaticHTMLCustomComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=
module$src$api$apps$sd_controls$custom_components$StaticHTMLCustomComponent.default,StaticHTMLSettingComponent_1$$module$src$api$apps$sd_controls$managers$SDControlsComponentFactory=module$src$api$apps$sd_controls$settings_components$StaticHTMLSettingComponent.default;
module$src$api$apps$sd_controls$managers$SDControlsComponentFactory.default.SDControlsComponentFactory=function(){function a(b,a,d,e){this._domManager=b;this._tinyColorFactory=a;this._fileHelper=d;this._useSpectrum=e}a.prototype.createUserDefinedParameter=function(b,a,d){var c=b.type,f=this.generateUUID();switch(c){case module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.STRING:return new module$src$api$apps$sd_controls$custom_components$StringInputCustomComponent.default.StringInputCustomComponent(f,
b,a,this._domManager,d);case module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.CHECKBOX:return new module$src$api$apps$sd_controls$custom_components$BooleanInputCustomComponent.default.BooleanInputCustomComponent(f,b,a,this._domManager,d);case module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.VECTOR3:return new module$src$api$apps$sd_controls$custom_components$Vector3CustomComponent.default.Vector3CustomComponent(f,b,a,this._domManager,d);case module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.BUTTON:return new module$src$api$apps$sd_controls$custom_components$ButtonCustomComponent.default.ButtonCustomComponent(f,
b,a,this._domManager,d);case module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.CHECKLIST:return new module$src$api$apps$sd_controls$custom_components$ChecklistCustomComponent.default.ChecklistCustomComponent(f,b,a,this._domManager,d);case module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.GROUP:return new module$src$api$apps$sd_controls$custom_components$GroupCustomComponent.default.GroupCustomComponent(f,b,a,this._domManager,this,d);case module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.COLOR:return new module$src$api$apps$sd_controls$custom_components$ColorCustomComponent.default.ColorCustomComponent(f,
b,a,this._domManager,this._useSpectrum,this._tinyColorFactory);case module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.DROPDOWN:return new module$src$api$apps$sd_controls$custom_components$DropdownCustomComponent.default.DropdownCustomComponent(f,b,a,this._domManager,d);case module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.FILE:return new module$src$api$apps$sd_controls$custom_components$FileCustomComponent.default.FileCustomComponent(f,b,a,this._domManager,
this._fileHelper,d);case module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.MODAL:return new module$src$api$apps$sd_controls$custom_components$ModalCustomComponent.default.ModalCustomComponent(f,b,a,this._domManager,d);case module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.SLIDER:return new module$src$api$apps$sd_controls$custom_components$SliderCustomComponent.default.SliderCustomComponent(f,b,a,this._domManager,d);case module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.STATICHTML:return new module$src$api$apps$sd_controls$custom_components$StaticHTMLCustomComponent.default.StaticHTMLCustomComponent(f,
b,a,this._domManager,d)}throw Error("Cannot create input component of type  "+b.type);};a.prototype.createSetting=function(b,a){switch(b.type){case module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.STATICHTML:return new module$src$api$apps$sd_controls$settings_components$StaticHTMLSettingComponent.default.StaticHTMLSettingComponent(b,a,this)}throw Error("Cannot create setting component of type "+b.type);};a.prototype.generateUUID=function(){var b=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,
function(a){var c=(b+16*Math.random())%16|0;b=Math.floor(b/16);return("x"===a?c:c&3|8).toString(16)})};return a}();var module$src$api$apps$sd_controls$managers$SDControlsResizeManager={default:{}},__extends$$module$src$api$apps$sd_controls$managers$SDControlsResizeManager=this&&module$src$api$apps$sd_controls$managers$SDControlsResizeManager.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,
c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$managers$SDControlsResizeManager.default,"__esModule",{value:!0});
var interfaces_1$$module$src$api$apps$sd_controls$managers$SDControlsResizeManager=module$src$interfaces$api$apps$sd_controls$interfaces.default,ShapeDiverRowSizeDoesNotExists$$module$src$api$apps$sd_controls$managers$SDControlsResizeManager=function(a){function b(b){return a.call(this,"Row size "+b+' does not exist. Possible sizes are "1,2,4"')||this}__extends$$module$src$api$apps$sd_controls$managers$SDControlsResizeManager(b,a);return b}(Error),Rows$$module$src$api$apps$sd_controls$managers$SDControlsResizeManager=
function(){function a(){this._elements=[];this._currentRow=[];this._spaceTaken=0}Object.defineProperty(a.prototype,"isFull",{get:function(){return this.rowSize>=a.MAX_SIZE},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"rowSize",{get:function(){for(var b=0,a=0,d=this._currentRow;a<d.length;a++)b+=d[a][1];return b},enumerable:!0,configurable:!0});a.prototype.addElement=function(b,c){this._spaceTaken+c>a.MAX_SIZE&&(this.resolveRow(),this._currentRow=[],this._spaceTaken=0);this._spaceTaken+=
c;this._currentRow.push([b,c])};a.prototype.finalize=function(){if(this.isFull){var b=this._currentRow.pop();this.resolveRow();this._currentRow=[b]}this.resolveRow();return this._elements};a.prototype.resolveRow=function(){var b=this;if(!this.isFull){for(var a=0;a<this._currentRow.length;a++){var d=this._currentRow[a];if(d[1]==module$src$interfaces$api$apps$sd_controls$interfaces.default.ControlElementSize.QTR_WIDTH&&(d[1]=module$src$interfaces$api$apps$sd_controls$interfaces.default.ControlElementSize.HALF_WIDTH,
this.isFull))break}if(!this.isFull)for(a=0;a<this._currentRow.length&&(d=this._currentRow[a],d[1]!=module$src$interfaces$api$apps$sd_controls$interfaces.default.ControlElementSize.HALF_WIDTH||(d[1]=module$src$interfaces$api$apps$sd_controls$interfaces.default.ControlElementSize.FULL_WIDTH,!this.isFull));a++);}this._currentRow.forEach(function(a){return b._elements.push(a)});this._currentRow=[]};a.MAX_SIZE=4;return a}();
module$src$api$apps$sd_controls$managers$SDControlsResizeManager.default.SDControlsResizeManager=function(){function a(b){var a;this._isMobileDevice=b;this._possibleClasses={landscape:["sd-landscape-max-width"],fullWidth:["uk-width-1-1","sd-max-width-4"],quarter:["uk-width-1-4","sd-max-width-1"],half:["uk-width-1-2","sd-max-width-2"],all:"uk-width-1-1 uk-width-1-2 uk-width-1-4 uk-width-expand sd-max-width-1 sd-max-width-2 sd-max-width-4".split(" ")};this._spacesRequiredMap=(a={},a[module$src$interfaces$api$apps$sd_controls$interfaces.default.ControlElementSize.QTR_WIDTH]=
1,a[module$src$interfaces$api$apps$sd_controls$interfaces.default.ControlElementSize.HALF_WIDTH]=2,a[module$src$interfaces$api$apps$sd_controls$interfaces.default.ControlElementSize.FULL_WIDTH]=4,a);this._isClientSizeSmall=!1}a.prototype.resize=function(b,a,d){a=a===module$src$interfaces$api$apps$sd_controls$interfaces.default.ViewerMode.LANDSCAPE;this.adjustSpaceRequiredAccordingToClientWidth(d);this.resizeHandle(b,a)};a.prototype.addClassesToElem=function(b,a){this._possibleClasses.all.forEach(function(a){b.row.classList.contains(a)&&
b.row.classList.remove(a)});a.forEach(function(a){return b.row.classList.add(a)})};a.prototype.adjustSpaceRequiredAccordingToClientWidth=function(b){this._isClientSizeSmall=b<a.CLIENT_WIDTH_ADJUST_SIZE;this._spacesRequiredMap[module$src$interfaces$api$apps$sd_controls$interfaces.default.ControlElementSize.HALF_WIDTH]=this._isClientSizeSmall?4:2;this._spacesRequiredMap[module$src$interfaces$api$apps$sd_controls$interfaces.default.ControlElementSize.QTR_WIDTH]=this._isClientSizeSmall?2:1};a.prototype.handleFullWidth=
function(b){for(var a=0;a<b.length;a++)this.addClassesToElem(b[a],this._possibleClasses.landscape)};a.prototype.handleResizable=function(b){for(var a=function(b){d._possibleClasses.all.forEach(function(a){return b.row.classList.remove(a)})},d=this,e=0;e<b.length;e++){var f=b[e];a(f)}a=new Rows$$module$src$api$apps$sd_controls$managers$SDControlsResizeManager;for(e=0;e<b.length;e++)f=b[e],a.addElement(f,this._spacesRequiredMap[f.size]);b=0;for(f=a.finalize();b<f.length;b++)switch(a=f[b],a[1]){case 1:this.addClassesToElem(a[0],
this._possibleClasses.quarter);break;case 2:this.addClassesToElem(a[0],this._possibleClasses.half);break;case 4:this.addClassesToElem(a[0],this._possibleClasses.fullWidth);break;default:throw new ShapeDiverRowSizeDoesNotExists$$module$src$api$apps$sd_controls$managers$SDControlsResizeManager(a[1]);}};a.prototype.resizeHandle=function(b,a){a?this.handleFullWidth(b):this.handleResizable(b);for(var c=0;c<b.length;c++)this.resizeHandle(b[c].children,a)};a.CLIENT_WIDTH_ADJUST_SIZE=640;return a}();var module$src$api$apps$sd_controls$SDControlsManager={default:{}},__awaiter$$module$src$api$apps$sd_controls$SDControlsManager=this&&module$src$api$apps$sd_controls$SDControlsManager.default.__awaiter||function(a,b,c,d){function e(b){return b instanceof c?b:new c(function(a){a(b)})}return new (c||(c=Promise))(function(c,h){function f(b){try{l(d.next(b))}catch(n){h(n)}}function k(b){try{l(d["throw"](b))}catch(n){h(n)}}function l(b){b.done?c(b.value):e(b.value).then(f,k)}l((d=d.apply(a,b||[])).next())})},
__generator$$module$src$api$apps$sd_controls$SDControlsManager=this&&module$src$api$apps$sd_controls$SDControlsManager.default.__generator||function(a,b){function c(b){return function(a){return d([b,a])}}function d(c){if(f)throw new TypeError("Generator is already executing.");for(;e;)try{if(f=1,h&&(g=c[0]&2?h["return"]:c[0]?h["throw"]||((g=h["return"])&&g.call(h),0):h.next)&&!(g=g.call(h,c[1])).done)return g;if(h=0,g)c=[c[0]&2,g.value];switch(c[0]){case 0:case 1:g=c;break;case 4:return e.label++,
{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(g=e.trys,g=0<g.length&&g[g.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3]))e.label=c[1];else if(6===c[0]&&e.label<g[1])e.label=g[1],g=c;else if(g&&e.label<g[2])e.label=g[2],e.ops.push(c);else{g[2]&&e.ops.pop();e.trys.pop();continue}}c=b.call(a,e)}catch(m){c=[6,m],h=0}finally{f=g=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e=
{label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},f,h,g,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k},__spreadArrays$$module$src$api$apps$sd_controls$SDControlsManager=this&&module$src$api$apps$sd_controls$SDControlsManager.default.__spreadArrays||function(){for(var a=0,b=0,c=arguments.length;b<c;b++)a+=arguments[b].length;a=Array(a);var d=0;for(b=0;b<c;b++)for(var e=arguments[b],f=0,h=e.length;f<
h;f++,d++)a[d]=e[f];return a};Object.defineProperty(module$src$api$apps$sd_controls$SDControlsManager.default,"__esModule",{value:!0});
var SDControlsDependenciesResolver_1$$module$src$api$apps$sd_controls$SDControlsManager=module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver.default,SDControlsComponentFactory_1$$module$src$api$apps$sd_controls$SDControlsManager=module$src$api$apps$sd_controls$managers$SDControlsComponentFactory.default,SDControlsResizeManager_1$$module$src$api$apps$sd_controls$SDControlsManager=module$src$api$apps$sd_controls$managers$SDControlsResizeManager.default;
module$src$api$apps$sd_controls$SDControlsManager.default.SDControlsManager=function(){function a(b,a,d,e){var c=this;this._controlsContext=b;this._container=a;this._sortManager=d;this._controlsContracts=e;this._userControls=[];this._dependenciesResolved=!1;this._parameterControls=[];this._dependenciesResolver=new module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver.default.SDControlsDependenciesResolver(b.useSpectrum);this._inputComponentsFactory=new module$src$api$apps$sd_controls$managers$SDControlsComponentFactory.default.SDControlsComponentFactory(this._controlsContext.domManager,
b.sdTinyColorFactory,b.fileHelper,b.useSpectrum);this._resizeManager=new module$src$api$apps$sd_controls$managers$SDControlsResizeManager.default.SDControlsResizeManager(this._controlsContext.isMobileDevice);this._container.addEventListener("viewer-resized",function(b){return c.viewerResized(b)})}Object.defineProperty(a.prototype,"componentFactory",{get:function(){return this._inputComponentsFactory},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"controlsContracts",{get:function(){return this._controlsContracts},
enumerable:!0,configurable:!0});a.prototype.createUserDefinedParameter=function(b){return __awaiter$$module$src$api$apps$sd_controls$SDControlsManager(this,void 0,void 0,function(){var a,d;return __generator$$module$src$api$apps$sd_controls$SDControlsManager(this,function(c){switch(c.label){case 0:this._controlsContracts.controlParameterDefinitionContract(b);if(!0===this._dependenciesResolved)return[3,2];a=this;return[4,this._dependenciesResolver.resolveDependenciesAsync()];case 1:a._dependenciesResolved=
c.sent(),c.label=2;case 2:return d=this._inputComponentsFactory.createUserDefinedParameter(b,this._controlsContext.container,this._controlsContext.editMode),this._userControls.push(d),this._sortManager.sort(__spreadArrays$$module$src$api$apps$sd_controls$SDControlsManager(this._userControls)),[2,new Promise(function(b){return b(d.id)})]}})})};a.prototype.removeUserDefinedParameter=function(b){return this.removeParameter(this._userControls,b)};a.prototype.resort=function(){this._sortManager.sort(__spreadArrays$$module$src$api$apps$sd_controls$SDControlsManager(this._userControls))};
a.prototype.removeParameter=function(b,a){for(var c=b.length-1;0<=c;c--){var e=b[c];if(e.children&&0<e.children.length&&this.removeParameter(e.children,a))return!0;if(e.id===a)return b.splice(c,1),e.destroy(),!0}return!1};a.prototype.viewerResized=function(b){this._resizeManager.resize(this._userControls,b.detail.mode,b.detail.clientWidth)};return a}();var module$src$api$apps$sd_controls$managers$SDControlsDomManager={default:{}};Object.defineProperty(module$src$api$apps$sd_controls$managers$SDControlsDomManager.default,"__esModule",{value:!0});
module$src$api$apps$sd_controls$managers$SDControlsDomManager.default.SDControlsDomManager=function(){function a(){this._mobileOrTabletRegex=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/;this._mobileOrTabletRegex2=
/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i;
this._mobileRegex=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i;this._mobileRegex2=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i;
this._userAgent=navigator.userAgent||navigator.vendor||window.opera;this._isTableOrMobileDevice=this._isMobileDevice=this._isIPadOrIPhone=null}Object.defineProperty(a.prototype,"userAgentIsIPadOrIPhone",{get:function(){null===this._isIPadOrIPhone&&(this._isIPadOrIPhone=/iPad/i.test(this._userAgent)||/iPhone/i.test(this._userAgent));return this._isIPadOrIPhone},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"userAgentIsMobileDevice",{get:function(){null===this._isMobileDevice&&(this._isMobileDevice=
this._mobileRegex.test(this._userAgent)||this._mobileRegex2.test(this._userAgent.substr(0,4)));return this._isMobileDevice},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"userAgentIsMobileOrTabletDevice",{get:function(){null===this._isTableOrMobileDevice&&(this._isTableOrMobileDevice=this._mobileOrTabletRegex.test(this._userAgent)||this._mobileOrTabletRegex2.test(this._userAgent.substr(0,4)));return this._isTableOrMobileDevice},enumerable:!0,configurable:!0});a.prototype.createDomElement=
function(b,a,d,e,f){void 0===e&&(e=[]);void 0===f&&(f={});var c=document.createElement(b);a&&(c.id=a);d&&d.appendChild(c);e.forEach(function(b){return c.classList.add(b)});for(var g in f)c.setAttribute(g,f[g]);return c};a.prototype.isEventSupported=function(b,a){a=document.createElement(a);b="on"+b;var c=b in a;c||(a.setAttribute(b,"return;"),c="function"==typeof a[b]);a.remove();return c};a.prototype.setDomEventListener=function(b,a,d,e){void 0===d&&(d=null);if(d){var c=null;b.addEventListener(a,
function(a){var f=b.value;null!==c&&clearTimeout(c);c=setTimeout(function(){c=null;e(f,a)},d)})}else b.addEventListener(a,function(a){return e(b.value,a)})};return a}();var module$src$modules$shapediver_tiny_color$SDTinyColorFactory={default:{}},__extends$$module$src$modules$shapediver_tiny_color$SDTinyColorFactory=this&&module$src$modules$shapediver_tiny_color$SDTinyColorFactory.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=
null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),__importDefault$$module$src$modules$shapediver_tiny_color$SDTinyColorFactory=this&&module$src$modules$shapediver_tiny_color$SDTinyColorFactory.default.__importDefault||function(a){return a&&a.__esModule?a:{"default":a}};Object.defineProperty(module$src$modules$shapediver_tiny_color$SDTinyColorFactory.default,"__esModule",{value:!0});
var tinycolor2_1$$module$src$modules$shapediver_tiny_color$SDTinyColorFactory=__importDefault$$module$src$modules$shapediver_tiny_color$SDTinyColorFactory(module$node_modules$tinycolor2$tinycolor.default),SDTinyColorInstance$$module$src$modules$shapediver_tiny_color$SDTinyColorFactory=function(a){function b(b,d){return a.call(this,b,d)||this}__extends$$module$src$modules$shapediver_tiny_color$SDTinyColorFactory(b,a);return b}(tinycolor2_1$$module$src$modules$shapediver_tiny_color$SDTinyColorFactory.default);
module$src$modules$shapediver_tiny_color$SDTinyColorFactory.default.SDTinyColorFactory=function(){function a(){}a.prototype.createTinyColor=function(b,a){return new SDTinyColorInstance$$module$src$modules$shapediver_tiny_color$SDTinyColorFactory(b,a)};return a}();var module$src$modules$shapediver_file_helper$SDFileHelper={default:{}};Object.defineProperty(module$src$modules$shapediver_file_helper$SDFileHelper.default,"__esModule",{value:!0});module$src$modules$shapediver_file_helper$SDFileHelper.default.SDFileHelper=function(){function a(){}a.prototype.guessMimeTypeFromFilename=function(b){b=b.toLowerCase();var a="";b.endsWith(".dxf")?a="application/dxf":b.endsWith(".obj")?a="application/wavefront-obj":b.endsWith(".csv")&&(a="text/csv");return a};return a}();var module$src$api$apps$sd_controls$commit_queues$SDCommitQueue={default:{}},__importDefault$$module$src$api$apps$sd_controls$commit_queues$SDCommitQueue=this&&module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default.__importDefault||function(a){return a&&a.__esModule?a:{"default":a}};Object.defineProperty(module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default,"__esModule",{value:!0});
var sd_controls_components_dom_dom_util_js_1$$module$src$api$apps$sd_controls$commit_queues$SDCommitQueue=__importDefault$$module$src$api$apps$sd_controls$commit_queues$SDCommitQueue(module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default);
module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default.SDCommitQueueBase=function(){function a(b,a,d){var c=this;this._api=b;this._numOfElementsForCommit=0;this._queue={};this._container=sd_controls_components_dom_dom_util_js_1$$module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default.createDomElement("div",{parent:a,classList:["sd-commit-container","uk-margin-remove"],attributes:{"uk-grid":""}});this.use=d&&(d.defval||1==d);b="uk-button uk-button-default uk-button-small uk-width-1-2 sd-commit-button uk-padding-remove".split(" ");
this._commitBtn=sd_controls_components_dom_dom_util_js_1$$module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default.createDomElement("button",{parent:this.container,innerHTML:"Apply",classList:b});this._cancelBtn=sd_controls_components_dom_dom_util_js_1$$module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default.createDomElement("button",{parent:this.container,innerHTML:"cancel",classList:b});this._commitBtn.onclick=function(){return c.execute()};this._cancelBtn.onclick=function(){return c.clear()};
this.enableDisableCommitButtons()}Object.defineProperty(a.prototype,"api",{get:function(){return this._api},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"queue",{get:function(){return this._queue},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"use",{get:function(){return this._use},set:function(b){b?(this.container.removeAttribute("hidden"),this._use=!0):(this.container.setAttribute("hidden","true"),this._use=!1)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"container",{get:function(){return this._container},enumerable:!0,configurable:!0});a.prototype.clear=function(){for(var b in this._queue){var a=this._queue[b].menuEl;a.setToInitalValueAndClearStack();a.isChanged=!1;this.removeCommitClass(a)}this._queue={};this._numOfElementsForCommit=0;this.enableDisableCommitButtons()};a.prototype.add=function(b,a,d){this._queue[a]={menuEl:b,val:d};b.isCurrentValueSameAsInital()?(this.removeCommitClass(b),!0===b.isChanged&&(this._numOfElementsForCommit--,b.isChanged=
!1)):(this.addCommitClass(b),!1===b.isChanged&&(b.isChanged=!0,this._numOfElementsForCommit++));this.enableDisableCommitButtons()};a.prototype.addCommitClass=function(b){b.row.classList.add("sd-commit")};a.prototype.enableDisableCommitButtons=function(){0<this._numOfElementsForCommit?(this._commitBtn.removeAttribute("disabled"),this._cancelBtn.removeAttribute("disabled")):(this._commitBtn.setAttribute("disabled","true"),this._cancelBtn.setAttribute("disabled","true"))};a.prototype.removeCommitClass=
function(b){b.row.classList.remove("sd-commit")};return a}();var module$src$api$apps$sd_controls$commit_queues$SDCommitParametersQueue={default:{}},__extends$$module$src$api$apps$sd_controls$commit_queues$SDCommitParametersQueue=this&&module$src$api$apps$sd_controls$commit_queues$SDCommitParametersQueue.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return a(b,c)};return function(b,c){function d(){this.constructor=
b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$commit_queues$SDCommitParametersQueue.default,"__esModule",{value:!0});var SDCommitQueue_1$$module$src$api$apps$sd_controls$commit_queues$SDCommitParametersQueue=module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default;
module$src$api$apps$sd_controls$commit_queues$SDCommitParametersQueue.default.SDCommitParametersQueue=function(a){function b(b,d,e){var c=a.call(this,b,d,e)||this;b.addEventListener(b.EVENTTYPE.SETTINGS_UPDATE,function(b){"commitParameters"===b.settings.key&&(c.use=b.settings.valueNew,c.clear())});return c}__extends$$module$src$api$apps$sd_controls$commit_queues$SDCommitParametersQueue(b,a);b.prototype.execute=function(){var b=[],a;for(a in this.queue){var e=this.queue[a];b.push({id:a,value:e.val});
e.menuEl.setStackToLast()}this.api.parameters.updateAsync(b);this.clear()};return b}(module$src$api$apps$sd_controls$commit_queues$SDCommitQueue.default.SDCommitQueueBase);var module$src$api$apps$sd_controls$managers$SDControlsSortManager={default:{}};Object.defineProperty(module$src$api$apps$sd_controls$managers$SDControlsSortManager.default,"__esModule",{value:!0});
var SDControlsSortManager$$module$src$api$apps$sd_controls$managers$SDControlsSortManager=function(){function a(){}a.prototype.sort=function(b){if(0<b.length){b.sort(function(b,a){return b.order-a.order});var a=b.length-1,d=b[a];if(0===a)d.children&&0<d.children.length&&this.sort(d.children);else for(;0<a;){d.children&&0<d.children.length&&this.sort(d.children);var e=b[--a];e.insertBefore(d);d=e}}};return a}();
module$src$api$apps$sd_controls$managers$SDControlsSortManager.default.SDControlsSortManagerInstance=new SDControlsSortManager$$module$src$api$apps$sd_controls$managers$SDControlsSortManager;var module$src$api$apps$sd_controls$managers$SDControlComponentContracts={default:{}},__extends$$module$src$api$apps$sd_controls$managers$SDControlComponentContracts=this&&module$src$api$apps$sd_controls$managers$SDControlComponentContracts.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,a){b.__proto__=a}||function(b,a){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return a(b,c)};return function(b,c){function d(){this.constructor=
b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$api$apps$sd_controls$managers$SDControlComponentContracts.default,"__esModule",{value:!0});
var enums_1$$module$src$api$apps$sd_controls$managers$SDControlComponentContracts=module$src$api$apps$sd_controls$enums$enums.default,ControlParameterDefinitionMissingPropertyError$$module$src$api$apps$sd_controls$managers$SDControlComponentContracts=function(a){function b(b,d){return a.call(this,"Custom parameter definition of type "+b.type+" is missing property "+d)||this}__extends$$module$src$api$apps$sd_controls$managers$SDControlComponentContracts(b,a);return b}(Error),ControlParameterDefinitionWrongPropertyTypeError$$module$src$api$apps$sd_controls$managers$SDControlComponentContracts=
function(a){function b(b,d,e,f){return a.call(this,"Custom parameter definition property "+d+" has a wrong type assigned. Expected type: "+f+", current type: "+e+". Parameter type: "+b.type)||this}__extends$$module$src$api$apps$sd_controls$managers$SDControlComponentContracts(b,a);return b}(Error),SDControlComponentsContracts$$module$src$api$apps$sd_controls$managers$SDControlComponentContracts=function(){function a(){}a.prototype.controlParameterDefinitionContract=function(b){this.checkProperty(b,
"type","string");b.type===module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.CHECKBOX?this.checkboxContract(b):b.type===module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.STRING?this.stringContract(b):b.type===module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.BUTTON?this.buttonContract(b):b.type===module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.CHECKLIST?this.checklistContract(b):b.type===module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.COLOR?
this.colorContract(b):b.type===module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.DROPDOWN?this.dropdownContract(b):b.type===module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.FILE?this.fileContract(b):b.type===module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.MODAL?this.modalContract(b):b.type===module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.GROUP?this.multipleContract(b):b.type===module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.SLIDER?
this.sliderContract(b):b.type===module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.VECTOR3?this.vectorContract(b):b.type===module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.STATICHTML&&this.staticHTMLContract(b)};a.prototype.settingDefinitionContract=function(b){this.checkProperty(b,"type","string");this.checkProperty(b,"id","string");b.type===module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.STATICHTML&&this.staticHTMLContract(b)};
a.prototype.buttonContract=function(b){this.checkProperty(b,"update","function")};a.prototype.checkArrayProperty=function(b,a){this.checkProperty(b,a,"object");if(!Array.isArray(b[a]))throw new ControlParameterDefinitionWrongPropertyTypeError$$module$src$api$apps$sd_controls$managers$SDControlComponentContracts(b,a,typeof b[a],"array");};a.prototype.checkProperty=function(b,a,d){if(!b.hasOwnProperty(a))throw new ControlParameterDefinitionMissingPropertyError$$module$src$api$apps$sd_controls$managers$SDControlComponentContracts(b,
a);if(d&&typeof b[a]!==d)throw new ControlParameterDefinitionWrongPropertyTypeError$$module$src$api$apps$sd_controls$managers$SDControlComponentContracts(b,a,typeof b[a],d);};a.prototype.checkboxContract=function(b){this.checkProperty(b,"update","function")};a.prototype.checklistContract=function(b){this.checkProperty(b,"update","function");this.checkArrayProperty(b,"choices")};a.prototype.colorContract=function(b){this.checkProperty(b,"update","function")};a.prototype.dropdownContract=function(b){this.checkProperty(b,
"update","function");this.checkArrayProperty(b,"choices")};a.prototype.fileContract=function(b){this.checkProperty(b,"update","function")};a.prototype.modalContract=function(b){this.checkProperty(b,"modalContent","string")};a.prototype.multipleContract=function(b){this.checkArrayProperty(b,"parameters")};a.prototype.sliderContract=function(b){this.checkProperty(b,"update","function")};a.prototype.staticHTMLContract=function(b){this.checkProperty(b,"content","string")};a.prototype.stringContract=function(b){this.checkProperty(b,
"update","function")};a.prototype.vectorContract=function(b){this.checkProperty(b,"update","function")};return a}();module$src$api$apps$sd_controls$managers$SDControlComponentContracts.default.SDControlComponentsContractsInstance=new SDControlComponentsContracts$$module$src$api$apps$sd_controls$managers$SDControlComponentContracts;var module$src$api$apps$SDControls={default:{}};
module$src$api$apps$SDControls.default.default=function(a,b,c,d){function e(){var b,a=w,d=a&&a.detail&&640>a.detail.clientWidth,e="landscape"===(a&&a.detail?a.detail.mode:"landscape"),f=(b={},b[module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.SLIDER]=d?4:2,b[module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.STRING]=d?2:1,b[module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.BOOLEAN]=d?2:1,b[module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.COLOR]=
d?2:1,b[module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.BUTTON]=d?2:1,b[module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.DROPDOWN]=d?4:2,b[module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.CHECKLIST]=d?4:2,b[module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.FILE]=d?2:1,b[module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.MULTIPLE]=
4,b[module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.VECTOR3]=d?4:2,b[module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.MODAL]=d?2:1,b[module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.VECTOR3]=d?4:2,b[module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType.STATICHTML]=4,b),g="uk-width-1-1 uk-width-1-2 uk-width-1-4 uk-width-expand sd-max-width-1 sd-max-width-2 sd-max-width-4 sd-landscape-max-width".split(" "),
h=function(b){for(var a=0,d=[],l=function(){var b=0,c=function(a,c){d.filter(function(b){return b.spaceReq===a}).forEach(function(d){g.forEach(function(b){return d.domEl.classList.remove(b)});d.domEl.classList.add("uk-width-1-"+c);d.domEl.classList.add("sd-max-width-"+a);b+=d.spaceReq})};c(4,1);c(2,2);c(1,4);4>b&&(c=d.find(function(b){return b.domEl.classList.contains("uk-width-1-4")})||d.find(function(b){return b.domEl.classList.contains("uk-width-1-2")}))&&(c=c.domEl.classList,c.contains("uk-width-1-2")&&
!c.contains("uk-width-1-4")&&(c.remove("uk-width-1-2"),c.remove("sd-max-width-2"),c.remove("sd-max-width-1"),c.add("uk-width-expand"),c.add("uk-max-width-expand")),c.contains("uk-width-1-4")&&(c.remove("uk-width-1-4"),c.remove("sd-max-width-1")),c.add(2<b?"uk-width-1-2":"uk-width-expand"),c.add(2<b?"sd-max-width-2":"sd-max-width-expand"));for(;0<d.length;)d.pop();a=0},p={},m=0;m<b.length;m++){var n=b[m],k="defaultKey";n.groupId&&(k=n.groupId);p[k]||(p[k]=[]);p[k].push(n)}Object.keys(p).forEach(function(b){var m=
p[b].filter(function(b){return!b.hidden||c.editMode}),n=m.length;b=function(b){var c=m[b],p=c.row;if(e)g.forEach(function(b){p.classList.remove(b);p.classList.add("uk-width-1-1");p.classList.add("sd-landscape-max-width")});else{var k=f[c.type];a+=k;4>=a?(d.push({domEl:p,spaceReq:k}),b===n-1&&l()):4<a&&(l(),d.push({domEl:p,spaceReq:k}),a=k,b===n-1&&l())}c.rows&&h(c.rows)};for(var k=0;k<n;k++)b(k)})};h(z);c.settings||(q._controlsManager._parameterControls=z);E.setAttribute("uk-height-match","")}function f(){for(;x.firstChild;)x.removeChild(x.firstChild);
A.length=0;z.length=0;B.length=0}function h(){var b=v("i",{classList:["sdv-control-brand-color","uk-margin-left"],attributes:{"uk-icon":"icon: file-edit; ratio: 0.7;"}});b.edit=!0;G.firstChild.appendChild(b);b.onclick=function(){if(b.edit){b.edit=!b.edit;b.setAttribute("uk-icon","icon: check; ratio: 0.7;");for(var a=0,c=z.length;a<c;a++){var d=z[a];d.setEditable(!0)}}else for(b.edit=!b.edit,b.setAttribute("uk-icon","icon: file-edit; ratio: 0.7;"),a=0,c=z.length;a<c;a++)d=z[a],d.setEditable(!1)};Sortable_1$$module$src$api$apps$SDControls.default.create(E,
{handle:".jq-sdv-sort-bars",onEnd:function(b){var a=b.oldIndex;b=b.newIndex;null!=a&&null!=b&&a!=b&&z.splice(b,0,z.splice(a,1)[0])}})}function g(){null!=F&&window.clearTimeout(F);F=window.setTimeout(function(){var b;z.sort(function(b,a){return b.order-a.order});var a=0;for(b=z.length;a<b;a++)(c&&c.editMode||!z[a].hidden)&&E.appendChild(z[a].row)},1E3)}function k(b,a){if(b[a]){var d=Object.keys(b[a])[0],e=b[a][d];if(A.includes(d))l(b,a);else if((b=y[a+"."+e.type+"."+e.visualization])||(b=y[a+"."+e.type]),
b||(b=y[a]),b){e.menuElementType=b;e.hidden=void 0===e.hidden?!1:e.hidden;e.order=void 0===e.order?Number.MAX_SAFE_INTEGER:e.order;e.isParameter="parameter"===a;var f=module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory.default.createMenuElement(e.menuElementType,e,p);f[a]=!0;z.push(f);A.push(d);c&&c.editMode&&(f.hideIcon=v("i",{id:f.slugId+"-hide-icon",attributes:{"uk-icon":"icon: ban; ratio: 0.6;"},classList:["uk-float-right","uk-margin-remove","uk-padding-remove-right",
"sdv-control-brand-color"]}),f.sortIcon=v("i",{id:f.slugId+"-sort-icon",attributes:{"uk-icon":"icon: move; ratio: 0.8;"},classList:["sdv-control-brand-color","uk-padding-remove-left","uk-margin-small-right","jq-sdv-sort-bars","uk-width-auto"]}),f.hideIcon.onclick=function(){f.toggleHide()},f.inputContainer.classList.remove("uk-width-1-1"),f.inputContainer.classList.add("uk-width-expand"),f.type===module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.BUTTON?(a=v("div",
{classList:"uk-width-1-1"}),a.appendChild(f.hideIcon),f.row.insertBefore(a,f.row.childNodes[0])):(a=v("div",{classList:"uk-width-1-1"}),a.appendChild(f.hideIcon),f.row.insertBefore(a,f.label)),f.row.insertBefore(f.sortIcon,f.inputContainer),x.classList.add("sdv-control-panel-edit-mode"));f.row.parentNode===E&&E.removeChild(f.row);g()}}}function l(b,a){if(b[a]){var d=b[a]&&b[a].id,e=d?b[a].id:Object.keys(b[a])[0];d=d?b[a]:b[a][e];if(A.includes(e)){for(b=z.length-1;0<=b;b--)if(a=z[b],a.id===e){void 0!==
d.hidden&&(a.hide(d.hidden),!c.editMode&&d.hidden&&a.row&&a.row.parentNode&&(a.row.parentNode.removeChild(a.row),z.slice(b,1)));void 0!==d.order&&(a.order=d.order);void 0!==d.name&&a.name!==d.name&&(a.name=d.name,a.type===module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.BUTTON||a.type===module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default.TYPES.FILE?a.inputComponent.innerHTML="<span>"+a.name+"</span>":a.label.innerHTML=a.name);break}g()}else k(b,
a)}}function m(b){var a,c,d,e;if(b.parameter){var f=0;for(d=B.length;f<d;f++){var g=B[f];if(a=b.parameter[g])for(c in a){var h=0;for(e=z.length;h<e;h++){var l=z[h];l.plugin===g&&l.id===c&&l.update(a[c])}}}}}function n(){if(d&&"function"===typeof d.onElementCreated)d.onElementCreated()}function r(b){if(b.settings){var a=b.settings.key;b=b.settings.valueNew;for(var c=0;c<z.length;c++){var d=z[c];if(d.setting===a)if(d.valueConversion&&d.valueConversion.i)d.onSettingUpdate(d.valueConversion.i(d,b));else d.onSettingUpdate(b)}}}
function u(){return __awaiter$$module$src$api$apps$SDControls(this,void 0,void 0,function(){return __generator$$module$src$api$apps$SDControls(this,function(b){return[2,p.sdDepenenciesResolver.resolveDependenciesAsync()]})})}var p={fileHelper:new module$src$modules$shapediver_file_helper$SDFileHelper.default.SDFileHelper,sdDepenenciesResolver:new module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver.default.SDControlsDependenciesResolver(!(sd_controls_components_dom_dom_util_1$$module$src$api$apps$SDControls.default.domSupportsHtml5Color()&&
sd_controls_components_dom_dom_util_1$$module$src$api$apps$SDControls.default.isMobileDevice())),sdTinyColorFactory:new module$src$modules$shapediver_tiny_color$SDTinyColorFactory.default.SDTinyColorFactory,controlsEvents:new module$src$modules$shapediver_generic_event$GenericEvent.default.GenericEvent([module$src$interfaces$api$apps$sd_controls$interfaces.default.LightEvents.ADD,module$src$interfaces$api$apps$sd_controls$interfaces.default.LightEvents.CLEAR_LIGHTS,module$src$interfaces$api$apps$sd_controls$interfaces.default.LightEvents.REMOVE,
module$src$interfaces$api$apps$sd_controls$interfaces.default.LightEvents.DROPDOWN_CUSTOM_UPDATE]),domManager:new module$src$api$apps$sd_controls$managers$SDControlsDomManager.default.SDControlsDomManager,useSpectrum:!(sd_controls_components_dom_dom_util_1$$module$src$api$apps$SDControls.default.domSupportsHtml5Color()&&sd_controls_components_dom_dom_util_1$$module$src$api$apps$SDControls.default.isMobileDevice()),isMobileDevice:sd_controls_components_dom_dom_util_1$$module$src$api$apps$SDControls.default.isMobileDevice(),
controls:[],shapeDiverDragControls:null,api:a,container:null,plugins:null,runtimeId:null,options:c,groups:null,parametersQueue:null,editMode:c&&c.editMode},q=new ShapeDiverControls$$module$src$api$apps$SDControls(p,b);p.options||(p.options={editMode:!1});var t={"uk-grid":"","uk-height-match":""},v=sd_controls_components_dom_dom_util_1$$module$src$api$apps$SDControls.default.createDomElement,w=null;b.addEventListener("viewer-resized",function(b){w=b;e()});var x=b,y={"parameter.Int":"slider","parameter.Odd":"slider",
"parameter.Even":"slider","parameter.Float":"slider","parameter.String":"string","parameter.Bool":"boolean","parameter.Color":"color","parameter.StringList.checklist":"form","parameter.StringList.sequence":"dropdown","parameter.StringList.cycle":"dropdown","parameter.StringList.dropdown":"dropdown","parameter.File":"file",export:"button"},A=[],z=[],B=[],D=p.api.getRuntimeId(),G;p.controlsEvents.on(module$src$interfaces$api$apps$sd_controls$interfaces.default.LightEvents.REMOVE,function(b){var a=z.find(function(a){return a.setting==
b.setting&&a.name==b.name});a&&(a.row.remove(),a=z.indexOf(function(a){return a.setting==b.setting&&a.name==b.name}),z=z.splice(a,1));e()});p.controlsEvents.on(module$src$interfaces$api$apps$sd_controls$interfaces.default.LightEvents.ADD,function(b){var a=z.find(function(a){return a.setting==b.setting&&a.name==b.name});a&&(a.row.remove(),z=z.filter(function(a){return!(a.setting==b.setting&&a.name==b.name)}));z.push(b);e()});p.controlsEvents.on(module$src$interfaces$api$apps$sd_controls$interfaces.default.LightEvents.CLEAR_LIGHTS,
function(){z.forEach(function(b){b.light&&b.row.remove()});z=z.filter(function(b){return!b.light})});var F=null;var E=document.createElement("div");Object.keys(t).forEach(function(b){E.setAttribute(b,t[b])});["sdv-control-panel-row-container","uk-child-width-1-1","uk-margin-remove"].forEach(function(b){E.classList.add(b)});p.container=E;p.plugins=B;p.runtimeId=D;(function(){return __awaiter$$module$src$api$apps$SDControls(this,void 0,void 0,function(){var b,d,e,g,t,F,w,B,y,A,R,P;return __generator$$module$src$api$apps$SDControls(this,
function(H){switch(H.label){case 0:if(!c||!c.settings)return[3,2];b=(new module$src$api$apps$sd_controls$settings$sd_controls_settings.default.SDControlsSettings(p.api,p)).settings;d=[];e=!1;u().then(function(){return e=!0});p.api.addEventListener("settings.update",function(b){e?r(b):d.push(new Promise(function(a){u().then(function(){a(b)})}))});return[4,u()];case 1:H.sent();G=v("button",{id:D+"_sd-control-panel-main-accordion-settings",parent:x,classList:"sd-control-panel-accordion"});v("div",{id:D+
"_settings-text",parent:G,innerHTML:"VIEWER SETTINGS",classList:["shapediver-viewer-element","sd-control-panel-accordion-text"]});x.appendChild(E);p.api.addEventListener&&p.api.addEventListener(p.api.viewports.EVENTTYPE.DESTROYED,function(b){"destroyed"===b.type&&f()});g=new module$src$api$apps$sd_controls$settings$GroupSettings.default.GroupSetings(p.container);p.groups=g;p.shapeDiverDragControls=new module$src$modules$shapediver_lights_drag_controls$app.default.ShapeDiverDragControls(p.api,THREE);
t={};for(F in b)w=b[F],t[w.groupId]||(t[w.groupId]=[]),t[w.groupId].push(w);for(F in t)B=t[F].sort(function(b,a){return b.order-a.order}),B.forEach(function(b){b.new?(q.controlsManager.controlsContracts.settingDefinitionContract(b),z.push(q.controlsManager.componentFactory.createSetting(b,g.getGroup(b.groupId)))):z.push(module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory.default.createMenuElement(b.type,b,p,g.getGroup(b.groupId)))});g.headersClick(function(a){for(var c in b){var d=
b[c];"function"===typeof d.close&&d.close();"function"===typeof d.createLightElements&&d.createLightElements()}a===module$src$interfaces$api$apps$sd_controls$interfaces.default.SettingsGroups.LIGHTS?(p.shapeDiverDragControls.useLightHelpers(!0),p.shapeDiverDragControls.zoomAsync()):p.shapeDiverDragControls.useLightHelpers(!1)});n();for(y in d)d[y].then(function(b){r(b)});return[3,3];case 2:G=v("button",{id:D+"_sd-control-panel-main-accordion-parameters",parent:x,classList:"sd-control-panel-accordion"}),
A=v("div",{id:D+"_settings-text",parent:G,innerHTML:"MODEL PARAMETERS",classList:["shapediver-viewer-element","sd-control-panel-accordion-text"]}),x.appendChild(E),c&&c.editMode&&(A.style.width="80%"),c&&c.editMode&&h(),p.parametersQueue=new module$src$api$apps$sd_controls$commit_queues$SDCommitParametersQueue.default.SDCommitParametersQueue(a,x,c.commitParameters),R=null,P=function(){window.clearTimeout(R);R=window.setTimeout(function(){n()},1E3)},p.api.parameters.addEventListener(p.api.parameters.EVENTTYPE.REGISTERED,
function(b){u().then(function(){k(b,"parameter");P()})}),p.api.parameters.addEventListener(p.api.parameters.EVENTTYPE.UPDATE,function(b){u().then(function(){l(b,"parameter")})}),p.api.parameters.addEventListener(p.api.parameters.EVENTTYPE.VALUE_UPDATE,m),p.api.exports.addEventListener(p.api.exports.EVENTTYPE.REGISTERED,function(b){u().then(function(){k(b,"export");P()})}),p.api.exports.addEventListener(p.api.exports.EVENTTYPE.UPDATE,function(b){u().then(function(){l(b,"export")})}),H.label=3;case 3:return[2]}})})})();
q=new ShapeDiverControls$$module$src$api$apps$SDControls(p,b);return{destroy:f,save:function(){if(c&&!0===c.editMode)for(var b=0,a=z.length;b<a;b++){var d=z[b],e={id:d.id,hidden:d.hidden,name:null,order:null};d.wasEdited&&null!==d.newName&&d.newName!==d.name&&(e.name=d.newName);d.order!==b&&(e.order=b);1<Object.keys(e).length&&(!0===d.parameter?p.api.parameters.updateProperties(e):!0===d.export&&p.api.exports.updateProperties(e));d.name=d.label.innerHTML;d.order=b}},parameterTypes:q.parameterTypes,
createParameter:function(b){return q.createParameter(b)},removeParameter:function(b){return q.removeParameter(b)}}};
var __awaiter$$module$src$api$apps$SDControls=this&&module$src$api$apps$SDControls.default.__awaiter||function(a,b,c,d){function e(b){return b instanceof c?b:new c(function(a){a(b)})}return new (c||(c=Promise))(function(c,h){function f(b){try{l(d.next(b))}catch(n){h(n)}}function k(b){try{l(d["throw"](b))}catch(n){h(n)}}function l(b){b.done?c(b.value):e(b.value).then(f,k)}l((d=d.apply(a,b||[])).next())})},__generator$$module$src$api$apps$SDControls=this&&module$src$api$apps$SDControls.default.__generator||
function(a,b){function c(b){return function(a){return d([b,a])}}function d(c){if(f)throw new TypeError("Generator is already executing.");for(;e;)try{if(f=1,h&&(g=c[0]&2?h["return"]:c[0]?h["throw"]||((g=h["return"])&&g.call(h),0):h.next)&&!(g=g.call(h,c[1])).done)return g;if(h=0,g)c=[c[0]&2,g.value];switch(c[0]){case 0:case 1:g=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(g=e.trys,g=0<g.length&&
g[g.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3]))e.label=c[1];else if(6===c[0]&&e.label<g[1])e.label=g[1],g=c;else if(g&&e.label<g[2])e.label=g[2],e.ops.push(c);else{g[2]&&e.ops.pop();e.trys.pop();continue}}c=b.call(a,e)}catch(m){c=[6,m],h=0}finally{f=g=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},f,h,g,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===
typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k},__importDefault$$module$src$api$apps$SDControls=this&&module$src$api$apps$SDControls.default.__importDefault||function(a){return a&&a.__esModule?a:{"default":a}};Object.defineProperty(module$src$api$apps$SDControls.default,"__esModule",{value:!0});
var sd_controls_settings_1$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$settings$sd_controls_settings.default,sd_controls_components_dom_dom_util_1$$module$src$api$apps$SDControls=__importDefault$$module$src$api$apps$SDControls(module$src$api$apps$sd_controls$components$dom$sd_controls_components_dom_dom_util.default),sd_controls_menu_element_factory_1$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$components$util$sd_controls_menu_element_factory.default,GroupSettings_1$$module$src$api$apps$SDControls=
module$src$api$apps$sd_controls$settings$GroupSettings.default,Sortable_1$$module$src$api$apps$SDControls=__importDefault$$module$src$api$apps$SDControls(module$src$shared$util$Sortable.default),app_1$$module$src$api$apps$SDControls=module$src$modules$shapediver_lights_drag_controls$app.default,sd_controls_constants_types_1$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$constants$sd_controls_constants_types.default,SDControlsManager_1$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$SDControlsManager.default,
SDControlsDomManager_1$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$managers$SDControlsDomManager.default,SDTinyColorFactory_1$$module$src$api$apps$SDControls=module$src$modules$shapediver_tiny_color$SDTinyColorFactory.default,SDControlsDependenciesResolver_1$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$managers$SDControlsDependenciesResolver.default,SDFileHelper_1$$module$src$api$apps$SDControls=module$src$modules$shapediver_file_helper$SDFileHelper.default,
GenericEvent_1$$module$src$api$apps$SDControls=module$src$modules$shapediver_generic_event$GenericEvent.default,SDCommitParametersQueue_1$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$commit_queues$SDCommitParametersQueue.default,interfaces_1$$module$src$api$apps$SDControls=module$src$interfaces$api$apps$sd_controls$interfaces.default,SDControlsSortManager_1$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$managers$SDControlsSortManager.default,SDControlComponentContracts_1$$module$src$api$apps$SDControls=
module$src$api$apps$sd_controls$managers$SDControlComponentContracts.default,enums_1$$module$src$api$apps$SDControls=module$src$api$apps$sd_controls$enums$enums.default,ShapeDiverControls$$module$src$api$apps$SDControls=function(){function a(b,a){this._controlsContext=b;this._controlsManager=new module$src$api$apps$sd_controls$SDControlsManager.default.SDControlsManager(b,a,module$src$api$apps$sd_controls$managers$SDControlsSortManager.default.SDControlsSortManagerInstance,module$src$api$apps$sd_controls$managers$SDControlComponentContracts.default.SDControlComponentsContractsInstance)}
Object.defineProperty(a.prototype,"controlsManager",{get:function(){return this._controlsManager},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"parameterTypes",{get:function(){return module$src$api$apps$sd_controls$enums$enums.default.ControlParameterType},enumerable:!0,configurable:!0});a.prototype.mapParameterDefinition=function(b){var a=this;if(b.link){var d=b.link,e=d.choiceMap;if(b.type===this.parameterTypes.SLIDER||b.type===this.parameterTypes.STRING||b.type===this.parameterTypes.VECTOR3)b.delay=
"number"===typeof b.delay?Math.max(b.delay,500):500;b.update=b.type===this.parameterTypes.CHECKLIST?function(c){c=c.map(function(a){a=b.choices.indexOf(a);return e&&e.length>a?e[a]:a});a._controlsContext.api.parameters.updateAsync({id:d.id,idOrName:d.idOrName,name:d.name,plugin:d.plugin,value:c})}:b.type===this.parameterTypes.DROPDOWN?function(c){c=b.choices.indexOf(c);c=e&&e.length>c?e[c]:c;a._controlsContext.api.parameters.updateAsync({id:d.id,idOrName:d.idOrName,name:d.name,plugin:d.plugin,value:c})}:
function(b){a._controlsContext.api.parameters.updateAsync({id:d.id,idOrName:d.idOrName,name:d.name,plugin:d.plugin,value:b})}}};a.prototype.createParameter=function(b){return __awaiter$$module$src$api$apps$SDControls(this,void 0,void 0,function(){var a=this;return __generator$$module$src$api$apps$SDControls(this,function(c){b.type===this.parameterTypes.GROUP?b.parameters.forEach(function(b){a.mapParameterDefinition(b)}):this.mapParameterDefinition(b);return[2,this._controlsManager.createUserDefinedParameter(b)]})})};
a.prototype.removeParameter=function(b){return this._controlsManager.removeUserDefinedParameter(b)};a.prototype.resort=function(){this._controlsManager.resort()};return a}();var module$src$api$apps$DomElementManager={default:function(a){var b={},c={};a.scene.addEventListener(a.scene.EVENTTYPE.ANCHOR_ADD,function(b){if(b.anchors)for(var a=0,c=b.anchors.length;a<c;a++)d(b.anchors[a])});a.scene.addEventListener(a.scene.EVENTTYPE.ANCHOR_REMOVE,function(b){if(b.anchors)for(var a=0,c=b.anchors.length;a<c;a++)e(b.anchors[a])});var d=function(d){if(!d.format||!c[d.format])return null;var e=document.getElementById(d.viewport+"-shapediver-domElements");e||(e=document.createElement("div"),
e.id=d.viewport+"-shapediver-domElements",e.classList.add("shapediver-domElements"),a.viewports.get(d.viewport).getContainer().appendChild(e));var f=c[d.format];e=f.add(e,d);b[d.scenePath]=e;d.updateFunction(f.update);return e};var e=function(a){if(!b[a.scenePath]||!a.format||!c[a.format])return null;c[a.format].remove(a)};var f=function(b,c){var d=c.data,e=(0,module$src$shared$util$toTinyColor.default)(d.color,"black");var f=document.createElement("div");f.type="text/css";f.style.display="none";
f.classList.add("shapediver-domElement");b.appendChild(f);b=document.createElement("span");b.style.color=e.toHexString();b.style.opacity=e.getAlpha();b.innerHTML=d.text;b.classList.add("shapediver-domElement-span");f.appendChild(b);if(d.textAlign)var g=d.textAlign;b.style.textAlign="right"===g||"center"===g?g:"left";return{domElement:f,api:a.viewports.get(c.viewport)}};var h=function(a){var c=b[a.scenePath].domElement,d=a.data;if(a.hidden&&!1!==d.hidden)c.style.display="none";else{c.style.display=
"";if(d.positioning){var e=d.positioning.horizontal;var f=d.positioning.vertical}d="right"===e?a.containerX-c.offsetWidth:"left"===e?a.containerX:a.containerX-c.offsetWidth/2;a="bottom"===f?a.containerY-c.offsetHeight:"top"===f?a.containerY:a.containerY-c.offsetHeight/2;c.style.left=d+"px";c.style.top=a+"px"}};var g=function(a){var c=b[a.scenePath].domElement;c.style.display="none";document.getElementById(b[a.scenePath].api.getViewportRuntimeId()+"-shapediver-domElements").removeChild(c)};c={tag2d:{add:f,
remove:g,update:h},text:{add:f,remove:g,update:h},image:{add:function(b,c){var d=c.data;var e=document.createElement("div");e.type="text/css";e.style.display="none";e.classList.add("shapediver-domElement");b.appendChild(e);b=document.createElement("img");e.appendChild(b);b.src=d.src;d.height&&(b.height=d.height);d.width&&(b.width=d.width);d.alt&&(b.alt=d.alt);return{domElement:e,api:a.viewports.get(c.viewport)}},remove:function(a){var c=b[a.scenePath].domElement;c.style.display="none";document.getElementById(b[a.scenePath].api.getViewportRuntimeId()+
"-shapediver-domElements").removeChild(c)},update:function(a){var c=b[a.scenePath].domElement,d=a.data;if(a.hidden&&!1!==d.hidden)c.style.display="none";else{c.style.display="";if(d.positioning){var e=d.positioning.horizontal;var f=d.positioning.vertical}d="right"===e?a.containerX-c.offsetWidth:"left"===e?a.containerX:a.containerX-c.offsetWidth/2;a="bottom"===f?a.containerY-c.offsetHeight:"top"===f?a.containerY:a.containerY-c.offsetHeight/2;c.style.left=d+"px";c.style.top=a+"px"}}}}}};var module$src$api$apps$UIkitViewportOverlays={},GLOBAL_UTILS$$module$src$api$apps$UIkitViewportOverlays=module$src$shared$util$GlobalUtils.default;
module$src$api$apps$UIkitViewportOverlays.default=function(a,b){if(!window.UIkit)return null;b=b||{};b.domElementIdPrefix=b.domElementIdPrefix||"sdv-container";b.hasOwnProperty("containerViewport")||(b.containerViewport=document.getElementById(b.domElementIdPrefix+"-viewport"));if(!b.containerViewport)return null;b.hasOwnProperty("containerControls")||(b.containerControls=document.getElementById(b.domElementIdPrefix+"-controls"));b.hasOwnProperty("containerSettings")||(b.containerSettings=document.getElementById(b.domElementIdPrefix+
"-settings"));b.resizeHandler=b.resizeHandler||function(){};var c={},d=b.containerViewport,e=b.containerControls,f=b.containerSettings,h=[];"brandedMode createButtons showControlsButton showSettingsButton showZoomButton showFullscreenButton showInitialSpinner showBusySpinner".split(" ").forEach(function(a){"boolean"!==typeof b[a]&&(b[a]=module$src$shared$util$GlobalUtils.default.getBooleanNodeAttribute(b.container,a.toLowerCase(),!0))});var g=document.createElement("ul");g.classList.add("uk-iconnav");
g.classList.add("shapediver-iconnav");var k=document.createElement("div");k.appendChild(g);d.appendChild(k);if(b.createButtons){var l=function(b,a,c){var d=document.createElement("li"),e=document.createElement("a");e.href="#";e.setAttribute("uk-icon","icon: "+b);"function"===typeof c&&(e.onclick=c);a||(d.style.display="none");d.appendChild(e);g.appendChild(d);return{li:d,a:e,onclick:c}};f&&(c.settings=l("pencil",b.showSettingsButton,function(c){"function"===typeof c.preventDefault&&c.preventDefault();
var d="none"===f.style.display?"":"none";f.style.display="boolean"===typeof c?c?"":"none":d;a&&a.scene&&"function"===typeof a.scene.render&&a.scene.render();b.resizeHandler()}),b.showSettingsInitial&&(f.style.display="",b.resizeHandler()));e&&(c.controls=l("settings",b.showControlsButton,function(c){"function"===typeof c.preventDefault&&c.preventDefault();var d="none"===e.style.display?"":"none";e.style.display="boolean"===typeof c?c?"":"none":d;a&&a.scene&&"function"===typeof a.scene.render&&a.scene.render();
b.resizeHandler()}),b.showControlsInitial&&(e.style.display="",b.resizeHandler()));if(a&&a.scene&&a.scene.camera&&"function"===typeof a.scene.camera.resetAsync){var m=0;c.zoom=l("camera",b.showZoomButton,function(c){"function"===typeof c.preventDefault&&c.preventDefault();b.zoomButtonResetsCamera?a.scene.camera.resetAsync({coordinates:"spherical"}):0!==m?(a.scene.camera.resetAsync({coordinates:"spherical"}),clearTimeout(m),m=0):(a.scene.camera.zoomAsync(),m=setTimeout(function(){m=0},500))});0===
a.getSetting("scene.camera.cameraMovementDuration")&&a.updateSettingAsync("scene.camera.cameraMovementDuration",1E3)}if(a&&"function"===typeof a.getSetting&&"function"===typeof a.updateSettingAsync){c.fullscreen=l("expand",b.showFullscreenButton,function(b){"function"===typeof b.preventDefault&&b.preventDefault();b=a.getSetting("scene.fullscreen");a.updateSettingAsync("scene.fullscreen",!b)});var n=function(){document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||
document.mozFullScreenElement?c.fullscreen.a.setAttribute("uk-icon","icon: shrink"):c.fullscreen.a.setAttribute("uk-icon","icon: expand")};document.addEventListener("webkitfullscreenchange",n);document.addEventListener("mozfullscreenchange",n);document.addEventListener("fullscreenchange",n)}}var r=function(b){b.style.position="absolute";b.style.top="50%";b.style.left="50%";b.style.transform="translateX(-50%) translateY(-50%)";b.style["-webkit-transform"]=b.style.transform};if(a&&a.scene&&b.showInitialSpinner){if(b.brandedMode){var u=
document.createElement("img");u.style.maxWidth="66%";u.style.maxHeight="66%";u.style.backgroundColor="none";u.src="https://viewer.shapediver.com/v2/img/logo_color.png"}else u=document.createElement("div"),u.setAttribute("uk-spinner","ratio: 2");r(u);d.parentNode.appendChild(u);var p=function(){u&&(d.parentNode.removeChild(u),u=null);q&&(a.scene.removeEventListener(q.data),q=null)};var q=a.scene.addEventListener(a.scene.EVENTTYPE.VISIBILITY_ON,p)}if(a&&a.state&&b.showBusySpinner){var t=function(b){b.classList.add("shapediver-spinner-busy");
b.setAttribute("uk-spinner","ratio: 1")},v;var w=document.createElement("div");t(w);k.appendChild(w);l=a.state.addEventListener(a.state.EVENTTYPE.BUSY,function(){w.style.display=""});l.data&&h.push(l.data);l=a.state.addEventListener(a.state.EVENTTYPE.IDLE,function(){w.style.display="none"});l.data&&h.push(l.data);var x=function(b,a){v?w.removeChild(v):(w.removeAttribute("uk-spinner"),w.classList.remove("uk-spinner","uk-icon"));b?(v=document.createElement("img"),v.src=b,a&&(a=Array.isArray(a)||[a],
a.forEach(function(b){w.classList.add(b)})),r(w),w.appendChild(v)):t(w)};var y=function(){}}var A=function(b,a){window.UIkit.notification({message:a,status:b||"primary",pos:"top-center"})};l=a.state.addEventListener(a.state.EVENTTYPE.MESSAGE,function(b){if(a.getSetting("showMessages")&&b.message){var c,d=b.messageLevel;"number"===typeof d&&(d&=7,d===window.SDVApp.constants.loggingLevels.WARN?c="warning":d>window.SDVApp.constants.loggingLevels.WARN?c="danger":d<window.SDVApp.constants.loggingLevels.WARN&&
(c="primary"));A(c,b.message)}});l.data&&h.push(l.data);l=function(b){"function"===typeof p&&p();a.updateSettingAsync("scene.show",!1);var c=document.createElement("div");r(c);c.classList.add("uk-text-middle");c.classList.add("uk-text-break");c.classList.add("uk-text-center");d.parentNode.appendChild(c);var e='<h1 class="uk-text-lead">We are sorry</h1>';b.messageScope&&(e+=b.messageScope);c.innerHTML=e};var z=a.state.get().data.failedStatusMessages;0<z.length?l(z[0]):(l=a.state.addEventListener(a.state.EVENTTYPE.FAILED,
l),l.data&&h.push(l.data));return{destroy:function(){k&&(d.removeChild(k),k=null);"function"===typeof p&&p();n&&(document.removeEventListener("webkitfullscreenchange",n),document.removeEventListener("mozfullscreenchange",n),document.removeEventListener("fullscreenchange",n));h.forEach(function(b){return a.removeEventListener(b)});k=null},toggleVisibility:function(b,a){c[b]&&(c[b].li.style.display=a?"":"none")},buttonOnClick:function(b,a){if(c[b])c[b].onclick(a)},setBusyGraphic:x,setBusyGraphicPosition:y,
showMessage:A}};var module$src$api$apps$UIkitExportModal={default:function(a,b){if(!a)return null;b=b||{};b.domElementIdPrefix||(b.domElementIdPrefix="sdv-container-modal-export");b.parentElement||(b.parentElement=document.getElementById("sdv-container")?document.getElementById("sdv-container"):document.body);b.UIkitOpts||(b.UIkitOpts={escClose:!0,bgClose:!1,container:document.getElementById("sdv-container")?"#sdv-container":!1});if(!window.UIkit)return null;var c,d,e,f,h,g=0,k,l=[],m,n=!1,r=b.parentElement,u=b.domElementIdPrefix,
p=[];(function(b){c=document.createElement("div");c.id=b;var a=document.createElement("div");a.classList.add("uk-modal-dialog");a.classList.add("uk-modal-body");c.appendChild(a);d=document.createElement("h2");d.id=b+"-title";d.classList.add("uk-modal-title");a.appendChild(d);e=document.createElement("p");e.id=b+"-prompt";a.appendChild(e);var g=document.createElement("p");g.classList.add("uk-text-right");a.appendChild(g);f=document.createElement("h2");f.id=b+"-button-cancel";f.type="button";f.classList.add("uk-button");
f.classList.add("uk-button-default");f.classList.add("uk-modal-close");g.appendChild(f);h=document.createElement("h2");h.id=b+"-button-ok";h.type="button";h.classList.add("uk-button");h.classList.add("uk-button-primary");g.appendChild(h);r.appendChild(c);return c})(u);var q=window.UIkit.modal("#"+u,b.UIkitOpts);var t=function(b){if(!b.export)return!1;var a=b.export;if(!b.token||!b.token.id||l.includes(b.token.id)||b.token.attributes&&b.token.attributes.silent||n&&k!==b.token.id)return!1;k=b.token.id;
d.innerHTML=a.name?'Export "'+a.name+'"':"Export";if(a.content||a.result)"download"===a.type?(e.innerHTML=a.filename&&0<a.content.length&&a.content[0].href?'File "'+a.filename+'" is available for download.':a.msg?a.msg:"File is available for download.",a.content&&0<a.content.length&&(b=a.content[0],b.size&&(e.innerHTML+="<br/>Download size: "+b.size+" bytes"),b.format&&(e.innerHTML+="<br/>File format: "+b.format))):e.innerHTML="email"===a.type?a.result.err?a.result.err:a.result.msg?a.result.msg:"Export has been finished.":
"shapeways"===a.type?a.result.err?a.result.err:a.result.msg?a.result.msg:"Export to ShapeWays has been finished.":"Export has been finished.";else{b="Processing, please wait...";a.msg&&(b=a.msg);for(var c=1;c<=g;c++)b+=".";e.innerHTML=b;g=(g+1)%4}a.content||a.result?(f.innerHTML="Cancel","download"===a.type?0<a.content.length&&a.content[0].href&&(h.innerHTML="Download",m=a.content[0].href):"shapeways"===a.type?a.result.err?h.innerHTML="Ok":a.result.href&&(h.innerHTML="Go to ShapeWays",m=a.result.href):
h.innerHTML="Ok",h.hidden=!(h.innerHTML&&0<h.innerHTML.length)):(f.innerHTML="Cancel",m="",h.innerHTML="",h.hidden=!0);return!0};b=a.exports.addEventListener(a.exports.EVENTTYPE.STATUS,function(b){t(b)&&(q.show(),n=!0)});b.data&&p.push(b.data);b=a.exports.addEventListener(a.exports.EVENTTYPE.AVAILABLE,function(b){t(b)&&(q.show(),n=!0)});b.data&&p.push(b.data);f.onclick=function(){k&&l.push(k);k=null;q.hide();n=!1};h.onclick=function(){k&&l.push(k);k=null;m&&(window.open(m,"_blank"),m="");q.hide();
n=!1};return{destroy:function(){h.onclick=null;f.onclick=null;r.removeChild(c);p.forEach(function(b){return a.export.removeEventListener(b)})}}}};var module$src$modules$shapediver_state_dashboard$StatePromise={default:{}},__awaiter$$module$src$modules$shapediver_state_dashboard$StatePromise=this&&module$src$modules$shapediver_state_dashboard$StatePromise.default.__awaiter||function(a,b,c,d){function e(b){return b instanceof c?b:new c(function(a){a(b)})}return new (c||(c=Promise))(function(c,h){function f(b){try{l(d.next(b))}catch(n){h(n)}}function k(b){try{l(d["throw"](b))}catch(n){h(n)}}function l(b){b.done?c(b.value):e(b.value).then(f,k)}
l((d=d.apply(a,b||[])).next())})},__generator$$module$src$modules$shapediver_state_dashboard$StatePromise=this&&module$src$modules$shapediver_state_dashboard$StatePromise.default.__generator||function(a,b){function c(b){return function(a){return d([b,a])}}function d(c){if(f)throw new TypeError("Generator is already executing.");for(;e;)try{if(f=1,h&&(g=c[0]&2?h["return"]:c[0]?h["throw"]||((g=h["return"])&&g.call(h),0):h.next)&&!(g=g.call(h,c[1])).done)return g;if(h=0,g)c=[c[0]&2,g.value];switch(c[0]){case 0:case 1:g=
c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(g=e.trys,g=0<g.length&&g[g.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3]))e.label=c[1];else if(6===c[0]&&e.label<g[1])e.label=g[1],g=c;else if(g&&e.label<g[2])e.label=g[2],e.ops.push(c);else{g[2]&&e.ops.pop();e.trys.pop();continue}}c=b.call(a,e)}catch(m){c=[6,m],h=0}finally{f=g=0}if(c[0]&5)throw c[1];return{value:c[0]?
c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},f,h,g,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k};Object.defineProperty(module$src$modules$shapediver_state_dashboard$StatePromise.default,"__esModule",{value:!0});
module$src$modules$shapediver_state_dashboard$StatePromise.default.State=function(){function a(){var b=this;this._resolved=!1;this._promise=new Promise(function(a,d){b._resolve=a;b._reject=d});this._promise.then(function(a){b._resolved=!0;return a})}Object.defineProperty(a.prototype,"resolved",{get:function(){return this._resolved},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"resolve",{get:function(){return this._resolve},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"reject",{get:function(){return this._reject},enumerable:!0,configurable:!0});a.prototype.then=function(b){return __awaiter$$module$src$modules$shapediver_state_dashboard$StatePromise(this,void 0,void 0,function(){return __generator$$module$src$modules$shapediver_state_dashboard$StatePromise(this,function(a){return[2,this._promise.then(b)]})})};return a}();var module$src$modules$shapediver_state_dashboard$StateDashboard={default:{}};Object.defineProperty(module$src$modules$shapediver_state_dashboard$StateDashboard.default,"__esModule",{value:!0});
var StatePromise_1$$module$src$modules$shapediver_state_dashboard$StateDashboard=module$src$modules$shapediver_state_dashboard$StatePromise.default,StateDashboard$$module$src$modules$shapediver_state_dashboard$StateDashboard=function(){function a(){this._firstTimeVisible=new module$src$modules$shapediver_state_dashboard$StatePromise.default.State;this._settingsLoaded=new module$src$modules$shapediver_state_dashboard$StatePromise.default.State}Object.defineProperty(a.prototype,"firstTimeVisible",{get:function(){return this._firstTimeVisible},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"settingsLoaded",{get:function(){return this._settingsLoaded},enumerable:!0,configurable:!0});return a}();module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary=function(){function a(){}a.getInstance=function(b){a.instances[b]||(a.instances[b]=new StateDashboard$$module$src$modules$shapediver_state_dashboard$StateDashboard);return a.instances[b]};a.instances={};return a}();var module$src$shared$pubsub$PubSub={default:function(a){function b(b){for(var a in b)if(b.hasOwnProperty(a))return!0;return!1}function c(b){return function(){throw b;}}function d(b,a,d){try{b(a,d)}catch(p){setTimeout(c(p),0)}}function e(b,a,c){b(a,c)}function f(b,a,c,f){var g=k[a];f=f?e:d;var h;if(k.hasOwnProperty(a))for(h in g)g.hasOwnProperty(h)&&f(g[h],b,c)}function h(b,a,c){return function(){var d=String(b),e=d.lastIndexOf(".");for(f(b,b,a,c);-1!==e;)d=d.substr(0,e),e=d.lastIndexOf("."),f(b,
d,a,c)}}function g(a,c,d,e){c=h(a,c,e);a=String(a);e=!(!k.hasOwnProperty(a)||!b(k[a]));for(var f=a.lastIndexOf(".");!e&&-1!==f;)a=a.substr(0,f),f=a.lastIndexOf("."),e=!(!k.hasOwnProperty(a)||!b(k[a]));if(!e)return!1;!0===d?c():setTimeout(c,0);return!0}var k={},l=-1,m=this;a=a||{};"boolean"!==typeof a.immediateExceptions&&(a.immediateExceptions=!1);m.publish=function(b,c){return g(b,c,!1,a.immediateExceptions)};m.publishSync=function(b,c){return g(b,c,!0,a.immediateExceptions)};m.subscribe=function(b,
a){if("function"!==typeof a)return!1;k.hasOwnProperty(b)||(k[b]={});var c="uid_"+String(++l);k[b][c]=a;return c};m.subscribeOnce=function(b,a){var c=m.subscribe(b,function(){m.unsubscribe(c);a.apply(this,arguments)});return m};m.clearAllSubscriptions=function(){k={}};m.clearSubscriptions=function(b){for(var a in k)k.hasOwnProperty(a)&&0===a.indexOf(b)&&delete k[a]};m.unsubscribe=function(b){var a;if((a="string"===typeof b)&&!(a=k.hasOwnProperty(b)))a:{for(var c in k)if(k.hasOwnProperty(c)&&0===c.indexOf(b)){a=
!0;break a}a=!1}var d=a;c=!d&&"string"===typeof b;a="function"===typeof b;var e=!1,f,g;if(d)m.clearSubscriptions(b);else{for(f in k)if(k.hasOwnProperty(f)){d=k[f];if(c&&d[b]){delete d[b];e=b;break}if(a)for(g in d)d.hasOwnProperty(g)&&d[g]===b&&(delete d[g],e=!0)}return e}}}};var module$src$app$partials$ViewerAppLoggingPartial={},VIEWERAPPCONSTANTS$$module$src$app$partials$ViewerAppLoggingPartial=module$src$app$ViewerAppConstants.default,PUBSUB$$module$src$app$partials$ViewerAppLoggingPartial=module$src$shared$pubsub$PubSub.default;
module$src$app$partials$ViewerAppLoggingPartial.default=function(){var a=this,b=new module$src$shared$pubsub$PubSub.default;this.subscribeToLogStream=function(a,c,d){if(!Array.isArray(a)){for(var e=[],f=0;f<=a;f++)e.push(f);a=e}Array.isArray(c)||(c=[c]);var h=[];a.forEach(function(a){c.forEach(function(c){var e=a.toString();0<c.length&&(e+="."+c);h.push(b.subscribe(e,d))})});return h};this.unsubscribeFromLogStream=function(a){a.forEach(function(a){b.unsubscribe(a)})};var c=function(b,c){var d=Number(b.slice(0,
1));b=b.slice(2);a.logToConsole.apply(a,[d,b].concat($jscomp.arrayFromIterable(c)))},d=this.subscribeToLogStream(a.getSetting("loggingLevel"),"",c);this.log=function(){var a=1===arguments.length?[arguments[0]]:Array.apply(null,arguments),c=a[0],d=a[1];a=a.slice(2);c=c.toString();"string"===typeof d&&0<d.length&&(c+="."+d);b.publish(c,[].concat($jscomp.arrayFromIterable(a)))};this.registerHook("loggingLevel",function(b){a.unsubscribeFromLogStream(d);d=a.subscribeToLogStream(b,"",c);a.log(module$src$app$ViewerAppConstants.default.loggingLevels.DEBUG,
"ViewerApp.loggingLevelUpdateHook","loggingLevel set from "+a.getLoggingLevelName(a.getSetting("loggingLevel"))+" to "+a.getLoggingLevelName(b));return!0})};var module$src$app$partials$ViewerAppMessagingPartial={},GLOBALUTILS$$module$src$app$partials$ViewerAppMessagingPartial=module$src$shared$util$GlobalUtils.default,MESSAGINGCONSTANTS$$module$src$app$partials$ViewerAppMessagingPartial=module$src$shared$constants$MessagingConstants.default,PUBSUB$$module$src$app$partials$ViewerAppMessagingPartial=module$src$shared$pubsub$PubSub.default;
module$src$app$partials$ViewerAppMessagingPartial.default=function(){var a=this,b=new module$src$shared$pubsub$PubSub.default;this.message=function(c,e){c=c===module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS&&e.token&&e.token.id?c+"."+e.token.id:c;a.messageToPubSub(c,e,b,{});a.messageToLog(c,e)};this.subscribeToMessageStream=function(a,c){Array.isArray(a)||(a=[a]);var d=[];a.forEach(function(a){d.push(b.subscribe(a,c))});return d};this.unsubscribeFromMessageStream=function(a){Array.isArray(a)||
(a=[a]);var c=!0;a.forEach(function(a){b.unsubscribe(a)||(c=!1)});return c};this.setupDispatching=function(b){var c=[];Object.keys(b).forEach(function(d){var e=b[d].partListeners;d=a.subscribeToMessageStream(d,function(b,c){Array.isArray(c.parts)||(c.parts=[],a.warn("ViewerAppMessagingPartial.setupDispatching","Message without data parts: "+JSON.stringify(c,null,0)));c.parts.forEach(function(d){e.forEach(function(e){if(d.type===e.type){var f=e.cb;"string"===typeof f&&0<f.length&&(f=module$src$shared$util$GlobalUtils.default.getAt(a,
f.split(".")));if("function"===typeof f){var g=[];g=Array.isArray(e.params)?e.params.map(function(a){if("type"===a)return d.type;if("data"===a)return d.data;if("token"===a)return c.token;if("origin"===a)return c.origin;if("topic"===a)return b;if("plugin"===a)return c.origin.plugin}):[c.token,d.data,d.type,c.origin];f=Promise.resolve(f.apply(a,g));f.then(function(b){!1===b&&a.debug("ViewerAppMessagingPartial.setupDispatching","Message callback returned false",e,g)});f.catch(function(b){a.error("ViewerAppMessagingPartial.setupDispatching",
"Error in message callback: "+b.message,b,e,g)})}}})})});c=c.concat(d)});return c};var c=[];this.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_FAILED,function(b,a){(b=a.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE))&&b.data&&c.push(b.data)});this.getFailedStatusMessages=function(){return c}};var module$src$app$partials$ViewerAppPluginManager={},pluginConstants$$module$src$app$partials$ViewerAppPluginManager=module$src$plugins$PluginConstants.default,MessagePrototype$$module$src$app$partials$ViewerAppPluginManager=module$src$shared$messages$MessagePrototype.default;
module$src$app$partials$ViewerAppPluginManager.default=function(){var a=this,b={},c=[],d=[];b.getStatusDescription=function(){var b=[];c.forEach(function(a){b.push(a.getStatusDescription())});return b};b.registerPlugin=function(e){if(e.getStatus()!==module$src$plugins$PluginConstants.default.pluginStatuses.READY)a.error("ViewerAppPluginManager.registerPlugin","Unexpected plugin status before loading: "+e.getStatus());else{var f=e.getRuntimeId();if(void 0!==b.getPluginByRuntimeId(f))a.error("ViewerAppPluginManager.registerPlugin",
"Plugin with runtime id "+f+" already loaded");else{e.log=function(){var b=1===arguments.length?[arguments[0]]:Array.apply(null,arguments),c=b[0],d=b[1];b=b.slice(2);d=e.getShortName()+"."+f+"."+d;a.log.apply(a,[c,d].concat($jscomp.arrayFromIterable(b)))};e.message=function(b,c){if(void 0===c.origin||"object"!==typeof c.origin)c.origin={};c.origin.plugin=f;void 0!==c.token&&"object"===typeof c.token&&void 0===c.token.creator&&(c.token.creator={plugin:f});a.message(b,c)};e.app={api:a.api};e.app.getContainer=
a.getContainer;var g=e.getCapabilities();g.includes(module$src$plugins$PluginConstants.default.pluginCapabilities.INTERACTIVE)&&(e.app.sceneGeometryManager=a.sceneGeometryManager,e.app.viewportManager=a.viewportManager);g.includes(module$src$plugins$PluginConstants.default.pluginCapabilities.DRAGANDDROP)&&(e.app.sceneGeometryManager=a.sceneGeometryManager,e.app.viewportManager=a.viewportManager);var h=[];if(g.includes(module$src$plugins$PluginConstants.default.pluginCapabilities.MESSAGECALLBACKS)&&
a.subscribeToMessageStream){g=e.getMessageCallbacks();for(var n in g){var r=a.subscribeToMessageStream(n,g[n]);h=h.concat(r)}}if(e.load({loggingLevel:a.getSetting("loggingLevel")}))if(e.getStatus()!==module$src$plugins$PluginConstants.default.pluginStatuses.LOADED&&e.getStatus()!==module$src$plugins$PluginConstants.default.pluginStatuses.ACTIVE)a.error("ViewerAppPluginManager.registerPlugin","Unexpected plugin status after loading: "+e.getStatus());else return a.message(module$src$plugins$PluginConstants.default.messageTopics.PLUGIN_REGISTERED,
new module$src$shared$messages$MessagePrototype.default(module$src$plugins$PluginConstants.default.messageDataTypes.PLUGIN_RUNTIME_ID,f)),a.info("ViewerAppPluginManager.registerPlugin",'Registered plugin "'+e.getName()+'" with capabilities '+JSON.stringify(e.getCapabilities())+" and runtime id "+e.getRuntimeId()),c.push(e),d.push(h),f;else a.error("ViewerAppPluginManager.registerPlugin",'Failed to load plugin "'+e.getName()+'" with runtime id '+f)}}};b.deregisterPlugin=function(b){var e=c.findIndex(function(a){return a.getRuntimeId()===
b});if(-1===e)return a.error("ViewerAppPluginManager.deregisterPlugin","Plugin with runtimeId "+b+" not found"),!1;a.unsubscribeFromMessageStream&&a.unsubscribeFromMessageStream(d[e]);var f=c.splice(e,1)[0];d.splice(e,1);a.info("ViewerAppPluginManager.deregisterPlugin",'Deregistered plugin "'+f.getName()+'" with capabilities '+JSON.stringify(f.getCapabilities())+" and runtime id "+f.getRuntimeId());return!0};b.getRuntimeIds=function(){for(var b=c.length,a=Array(c.length),d=0;d<b;d++)a[d]=c[d].getRuntimeId();
return a};b.getPluginByRuntimeId=function(b){return c.find(function(a){return a.getRuntimeId()===b})};b.getPluginByName=function(b){return c.find(function(a){return a.getName()===b})};b.getPluginByShortName=function(b){return c.find(function(a){return a.getShortName()===b})};b.getPluginByCapabilities=function(b){b||(b=[]);Array.isArray(b)||(b=[b]);return c.find(function(a){var c=a.getCapabilities();return b.every(function(b){return c.includes(b)})})};var e=999,f=Promise.resolve(),h=function(b,d){var g=
b.indexOf("."),m=Number(b.slice(0,g))&module$src$plugins$PluginConstants.default.loggingLevels.LVLBITS,n=b.slice(g+1),k=c.find(function(b){return b.getCapabilities().includes(module$src$plugins$PluginConstants.default.pluginCapabilities.LOGGING)});k?f=f.finally(function(){a.debug("ViewerAppPluginManager._logToServer","Logging to server",{loggingLevel:m,scope:n,data:d});Array.isArray(d)||(d=[d]);k.logToServer.apply(k,[m,n].concat($jscomp.arrayFromIterable(d))).catch(function(b){a.warn("ViewerAppPluginManager._logToServer",
b)});e=999}).finally(function(){return new Promise(function(b){setTimeout(b,9999)})}):(a.debug("ViewerAppPluginManager._logToServer","Delaying logging to server by "+e+"msec",{loggingLevel:m,scope:n,data:d}),setTimeout(h,e,b,d),e*=2)};"function"===typeof a.subscribeToLogStream&&a.subscribeToLogStream([module$src$plugins$PluginConstants.default.loggingLevels.ERROR_S,module$src$plugins$PluginConstants.default.loggingLevels.WARN_S,module$src$plugins$PluginConstants.default.loggingLevels.INFO_S,module$src$plugins$PluginConstants.default.loggingLevels.DEBUG_S],
"",h);return b};var module$src$shared$exceptions$MissingImplementationException={default:function(){}};module$src$shared$exceptions$MissingImplementationException.default.prototype.toString=function(){return"Missing implementation"};var module$src$shared$interfaces$ParameterInterface={},MissingImplementationException$$module$src$shared$interfaces$ParameterInterface=module$src$shared$exceptions$MissingImplementationException.default;
module$src$shared$interfaces$ParameterInterface.default=function(){this.setValue=function(){throw new module$src$shared$exceptions$MissingImplementationException.default;};this.parseValue=function(){throw new module$src$shared$exceptions$MissingImplementationException.default;};this.getValue=function(){throw new module$src$shared$exceptions$MissingImplementationException.default;};this.getValueString=function(){throw new module$src$shared$exceptions$MissingImplementationException.default;};this.checkValue=
function(){throw new module$src$shared$exceptions$MissingImplementationException.default;};this.isValid=function(){throw new module$src$shared$exceptions$MissingImplementationException.default;};this.getDefinition=function(){throw new module$src$shared$exceptions$MissingImplementationException.default;}};var module$src$shared$types$ShapeDiverParameters={default:{}},GlobalUtils$$module$src$shared$types$ShapeDiverParameters=module$src$shared$util$GlobalUtils.default,toTinyColor$$module$src$shared$types$ShapeDiverParameters=module$src$shared$util$toTinyColor.default,uuidv4Regex$$module$src$shared$types$ShapeDiverParameters=/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,defaultSettings$$module$src$shared$types$ShapeDiverParameters={strictMode:!0},CommonParameter$$module$src$shared$types$ShapeDiverParameters=
function(a){var b=this;module$src$shared$mixins$GlobalMixin.default.call(this);module$src$shared$interfaces$ParameterInterface.default.call(this);var c=function(b,a){return Array.isArray(b)&&"array"===a||typeof b===a?!0:!1};void 0===a||"object"!==typeof a?a=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(a=module$src$shared$util$GlobalUtils.default.deepCopy(a),module$src$shared$util$GlobalUtils.default.defaults(a,defaultSettings$$module$src$shared$types$ShapeDiverParameters));void 0===
a.isValid&&(a.isValid=!0);if(void 0===a.name||"string"!==typeof a.name||0===a.name.length)a.name="Generic parameter";if(void 0===a.valuetype||"string"!==typeof a.valuetype||0===a.valuetype.length)void 0!==a.defval?Array.isArray(a.defval)?a.valuetype="array":a.valuetype=typeof a.defval:(a.valuetype="number",a.isValid=!1);void 0!==a.defval&&c(a.defval,a.valuetype)||(a.defval=0,a.isValid=!1);void 0===a.value?a.value=a.defval:c(a.value,a.valuetype)||(a.isValid=!1);module$src$shared$mixins$SettingsMixin.default.call(this,
a);this.registerHook("valuetype",function(){return!1});this.registerHook("defval",function(a){return b.checkValue(a)});this.registerHook("value",function(a){return b.checkValue(a)});this.registerHook("isValid",function(){return!1});module$src$shared$mixins$LoggingMixin.default.call(this);this.isValid=function(){return b.getSetting("isValid")};this.checkValue=function(a){return c(a,b.getSettingShallow("valuetype"))};this.setValue=function(a){return b.updateSetting("value",a)};this.getValue=function(){return b.getSetting("value")};
this.getValueString=function(){return b.getValue().toString()};this.parseValue=function(a){if("string"!==typeof a)return!1;var c=b.getSettingShallow("valuetype");if("string"===c)return b.setValue(a);if("number"===c)return b.setValue(parseFloat(a));if("boolean"===c)return"false"===a.toLowerCase()?b.setValue(!1):b.setValue(!!a);if("object"===c||"array"===c)try{return b.setValue(JSON.Parse(a))}catch(f){return b.debug("CommonParameter.parseValue",f),!1}else return!1};this.isValueDifferent=function(a){var c=
b.getSettingShallow("valuetype"),d=b.getSettingShallow("value");return"array"===c||"object"===c?(c=JSON.stringify(d,null,0),a=JSON.stringify(a,null,0),c!==a):d!==a};b.toString=function(){var a='Parameter "'+b.getSetting("name")+'"';return a+="\n\tsettings: "+JSON.stringify(b.getSettings(),null,0)};this.acceptsBlobs=function(){return!1};this.checkBlob=function(a){if(!(b.acceptsBlobs()&&a instanceof Blob)||a.size>b.getSettingShallow("max"))return!1;a._type=0<a.type.length?a.type:module$src$shared$util$GlobalUtils.default.guessMimeTypeFromFilename(a.name);
return b.getSettingShallow("format").includes(a._type)?!0:!1};return this};module$src$shared$types$ShapeDiverParameters.default.CommonParameter=CommonParameter$$module$src$shared$types$ShapeDiverParameters;
var FloatParameter$$module$src$shared$types$ShapeDiverParameters=function(a){var b=this;void 0===a||"object"!==typeof a?a=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(a=module$src$shared$util$GlobalUtils.default.deepCopy(a),module$src$shared$util$GlobalUtils.default.defaults(a,defaultSettings$$module$src$shared$types$ShapeDiverParameters));void 0===a.isValid&&(a.isValid=!0);"boolean"!==typeof a.strictMode||a.strictMode||(["decimalplaces"].forEach(function(b){"string"===typeof a[b]&&
(a[b]=parseInt(a[b]))}),["min","max","defval","value"].forEach(function(b){"string"===typeof a[b]&&(a[b]=parseFloat(a[b]))}));if(void 0===a.name||"string"!==typeof a.name||0===a.name.length)a.name="Float parameter";a.valuetype="number";if(void 0===a.decimalplaces||"number"!==typeof a.decimalplaces||0>a.decimalplaces)a.decimalplaces=20;if(void 0===a.min||"number"!==typeof a.min)a.min=-Number.MAX_VALUE;if(void 0===a.max||"number"!==typeof a.max)a.max=Number.MAX_VALUE;a.min>a.max&&(a.min=a.max,a.isValid=
!1);if(void 0===a.defval||"number"!==typeof a.defval||a.defval<a.min||a.defval>a.max)a.defval=a.min,a.isValid=!1;if(void 0===a.value||"number"!==typeof a.value||a.value<a.min||a.value>a.max)a.value=a.defval;CommonParameter$$module$src$shared$types$ShapeDiverParameters.call(this,a);this.registerHook("decimalplaces",function(){return!1});this.registerHook("min",function(a){return b.getSettingShallow("value")>=a?!0:!1});this.registerHook("max",function(a){return b.getSettingShallow("value")<=a?!0:!1});
var c=this.setValue;this.setValue=function(a){"string"!==typeof a||b.getSettingShallow("strictMode")||(a=parseFloat(a));if("number"!==typeof a)return!1;var d=a,e=b.getSettingShallow("decimalplaces");e<Number.MAX_SAFE_INTEGER&&(d=parseFloat(a.toFixed(e)));return c(d)};this.getValueString=function(){var a=b.getSettingShallow("decimalplaces");return a<Number.MAX_SAFE_INTEGER?b.getValue().toFixed(a):b.getValue()};var d=this.checkValue;this.checkValue=function(a){"string"!==typeof a||b.getSettingShallow("strictMode")||
(a=parseFloat(a));return d(a)?a>=b.getSettingShallow("min")&&a<=b.getSettingShallow("max"):!1};this.getDefinition=function(){return b.getSettings("id name plugin note type decimalplaces defval group max min visualization _name order hidden".split(" "))};return this};module$src$shared$types$ShapeDiverParameters.default.FloatParameter=FloatParameter$$module$src$shared$types$ShapeDiverParameters;
var IntegerParameter$$module$src$shared$types$ShapeDiverParameters=function(a){void 0===a||"object"!==typeof a?a=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(a=module$src$shared$util$GlobalUtils.default.deepCopy(a),module$src$shared$util$GlobalUtils.default.defaults(a,defaultSettings$$module$src$shared$types$ShapeDiverParameters));void 0===a.isValid&&(a.isValid=!0);"boolean"!==typeof a.strictMode||a.strictMode||["decimalplaces","min","max","defval","value"].forEach(function(b){"string"===
typeof a[b]&&(a[b]=parseInt(a[b]))});if(void 0===a.name||"string"!==typeof a.name||0===a.name.length)a.name="Integer parameter";void 0===a.decimalplaces&&(a.decimalplaces=0);if("number"!==typeof a.decimalplaces||0!==a.decimalplaces)a.decimalplaces=0,a.isValid=!1;if(void 0===a.min||"number"!==typeof a.min)a.min=Number.MIN_SAFE_INTEGER;if(void 0===a.max||"number"!==typeof a.max)a.max=Number.MAX_SAFE_INTEGER;a.min>a.max&&(a.min=a.max,a.isValid=!1);if(void 0===a.defval||"number"!==typeof a.defval||a.defval<
a.min||a.defval>a.max||Math.round(a.defval)!==a.defval)a.defval=a.min,a.isValid=!1;if(void 0===a.value||"number"!==typeof a.value||a.value<a.min||a.value>a.max||Math.round(a.value)!==a.value)a.value=a.defval;FloatParameter$$module$src$shared$types$ShapeDiverParameters.call(this,a);return this};module$src$shared$types$ShapeDiverParameters.default.IntegerParameter=IntegerParameter$$module$src$shared$types$ShapeDiverParameters;
var EvenIntegerParameter$$module$src$shared$types$ShapeDiverParameters=function(a){void 0===a||"object"!==typeof a?a=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(a=module$src$shared$util$GlobalUtils.default.deepCopy(a),module$src$shared$util$GlobalUtils.default.defaults(a,defaultSettings$$module$src$shared$types$ShapeDiverParameters));void 0===a.isValid&&(a.isValid=!0);"boolean"!==typeof a.strictMode||a.strictMode||["decimalplaces","min","max","defval","value"].forEach(function(b){"string"===
typeof a[b]&&(a[b]=parseInt(a[b]))});if(void 0===a.name||"string"!==typeof a.name||0===a.name.length)a.name="Even integer parameter";if(void 0===a.min||"number"!==typeof a.min)a.min=Number.MIN_SAFE_INTEGER;if(void 0===a.max||"number"!==typeof a.max)a.max=Number.MAX_SAFE_INTEGER;a.min>a.max&&(a.min=a.max,a.isValid=!1);if(void 0===a.defval||"number"!==typeof a.defval||a.defval<a.min||a.defval>a.max||0!==a.defval%2)a.defval=a.min,a.isValid=!1;if(void 0===a.value||"number"!==typeof a.value||a.value<a.min||
a.value>a.max||0!==a.value%2)a.value=a.defval;IntegerParameter$$module$src$shared$types$ShapeDiverParameters.call(this,a);var b=this.checkValue;this.checkValue=function(a){return b(a)?0===a%2:!1};return this};module$src$shared$types$ShapeDiverParameters.default.EvenIntegerParameter=EvenIntegerParameter$$module$src$shared$types$ShapeDiverParameters;
var OddIntegerParameter$$module$src$shared$types$ShapeDiverParameters=function(a){void 0===a||"object"!==typeof a?a=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(a=module$src$shared$util$GlobalUtils.default.deepCopy(a),module$src$shared$util$GlobalUtils.default.defaults(a,defaultSettings$$module$src$shared$types$ShapeDiverParameters));void 0===a.isValid&&(a.isValid=!0);"boolean"!==typeof a.strictMode||a.strictMode||["decimalplaces","min","max","defval","value"].forEach(function(b){"string"===
typeof a[b]&&(a[b]=parseInt(a[b]))});if(void 0===a.name||"string"!==typeof a.name||0===a.name.length)a.name="Even integer parameter";if(void 0===a.min||"number"!==typeof a.min)a.min=Number.MIN_SAFE_INTEGER;if(void 0===a.max||"number"!==typeof a.max)a.max=Number.MAX_SAFE_INTEGER;a.min>a.max&&(a.min=a.max,a.isValid=!1);if(void 0===a.defval||"number"!==typeof a.defval||a.defval<a.min||a.defval>a.max||1!==Math.abs(a.defval%2))a.defval=a.min,a.isValid=!1;if(void 0===a.value||"number"!==typeof a.value||
a.value<a.min||a.value>a.max||1!==Math.abs(a.value%2))a.value=a.defval;IntegerParameter$$module$src$shared$types$ShapeDiverParameters.call(this,a);var b=this.checkValue;this.checkValue=function(a){return b(a)?1===Math.abs(a%2):!1};return this};module$src$shared$types$ShapeDiverParameters.default.OddIntegerParameter=OddIntegerParameter$$module$src$shared$types$ShapeDiverParameters;
var ValueListParameter$$module$src$shared$types$ShapeDiverParameters=function(a){var b=this;void 0===a||"object"!==typeof a?a=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(a=module$src$shared$util$GlobalUtils.default.deepCopy(a),module$src$shared$util$GlobalUtils.default.defaults(a,defaultSettings$$module$src$shared$types$ShapeDiverParameters));void 0===a.isValid&&(a.isValid=!0);"boolean"!==typeof a.strictMode||a.strictMode||["defval"].forEach(function(b){"string"===typeof a[b]&&
(a[b]=parseInt(a[b]))});if(void 0===a.name||"string"!==typeof a.name||0===a.name.length)a.name="Value list parameter";void 0!==a.choices&&Array.isArray(a.choices)||(a.choices=[],a.isValid=!1);a.min=0;a.max=a.choices.length-1;if(void 0===a.defval||"number"!==typeof a.defval||a.defval<a.min||a.defval>a.max)a.defval=a.min,a.isValid=!1;IntegerParameter$$module$src$shared$types$ShapeDiverParameters.call(this,a);this.registerHook("min",function(){return!1});this.registerHook("max",function(){return!1});
this.registerHook("choices",function(){return!1});this.getChoices=function(){return b.getSetting("choices")};this.getSelectedChoice=function(){return b.getSetting("choices")[b.getSettingShallow("value")]};this.getDefinition=function(){return b.getSettings("id name plugin note type choices defval group visualization _name order hidden".split(" "))};return this};module$src$shared$types$ShapeDiverParameters.default.ValueListParameter=ValueListParameter$$module$src$shared$types$ShapeDiverParameters;
var MultipleChoiceParameter$$module$src$shared$types$ShapeDiverParameters=function(a){var b=this,c=function(a,c,d){void 0===d&&(d=!0);if("string"===typeof a&&!d)if(!a.startsWith("[")&&a.includes(","))try{a=JSON.parse("["+a+"]")}catch(l){b.debug("MultipleChoiceParameter._checkValue",l);return}else if(a=parseInt(a),isNaN(a))return;if("number"===typeof a){if(0<=a&&a<=c)return[a]}else if(Array.isArray(a)){var e=[];if(a.every(function(b,f){if("string"===typeof b&&!d){b=parseInt(b);if(!isNaN(b))return!1;
a[f]=b}return"number"===typeof b&&0<=b&&b<=c&&-1===e.indexOf(b)?(e.push(b),!0):!1}))return e}};void 0===a||"object"!==typeof a?a=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(a=module$src$shared$util$GlobalUtils.default.deepCopy(a),module$src$shared$util$GlobalUtils.default.defaults(a,defaultSettings$$module$src$shared$types$ShapeDiverParameters));void 0===a.isValid&&(a.isValid=!0);var d=!0;"boolean"!==typeof a.strictMode||a.strictMode||(d=!1);if(void 0===a.name||"string"!==typeof a.name||
0===a.name.length)a.name="Multiple value list parameter";void 0!==a.choices&&Array.isArray(a.choices)||(a.choices=[],a.isValid=!1);a.min=0;a.max=a.choices.length-1;"string"===typeof a.defval&&!d||void 0!==a.defval&&("number"===typeof a.defval||Array.isArray(a.defval))?(a.defval=c(a.defval,a.max,d),void 0===a.defval&&(a.defval=[],a.isValid=!1)):(a.defval=[],a.isValid=!1);void 0===a.value&&(a.value=a.defval);"number"===typeof a.value||Array.isArray(a.value)?(a.value=c(a.value,a.max,d),void 0===a.value&&
(a.value=a.defval,a.isValid=!1)):(a.value=a.defval,a.isValid=!1);CommonParameter$$module$src$shared$types$ShapeDiverParameters.call(this,a);this.registerHook("min",function(){return!1});this.registerHook("max",function(){return!1});this.registerHook("choices",function(){return!1});this.getChoices=function(){return b.getSetting("choices")};this.getSelectedChoices=function(){var a=b.getSetting("choices"),c=[];b.getSettingShallow("value").forEach(function(b){c.push(a[b])});return c};this.checkValue=
function(a){return void 0!==c(a,b.getSettingShallow("max"),b.getSettingShallow("strictMode"))};this.getValueString=function(){var a=JSON.stringify(b.getValue(),null,0);a=a.replace("[","");return a=a.replace("]","")};var e=this.setValue;this.setValue=function(a){a=c(a,b.getSettingShallow("max"),b.getSettingShallow("strictMode"));return void 0===a?!1:e(a)};this.parseValue=function(a){a=c(a,b.getSettingShallow("max"),!1);return b.setValue(a)};this.getDefinition=function(){return b.getSettings("id name plugin note type choices defval group visualization _name order hidden".split(" "))};
return this};module$src$shared$types$ShapeDiverParameters.default.MultipleChoiceParameter=MultipleChoiceParameter$$module$src$shared$types$ShapeDiverParameters;
var StringParameter$$module$src$shared$types$ShapeDiverParameters=function(a){var b=this;void 0===a||"object"!==typeof a?a=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(a=module$src$shared$util$GlobalUtils.default.deepCopy(a),module$src$shared$util$GlobalUtils.default.defaults(a,defaultSettings$$module$src$shared$types$ShapeDiverParameters));a.valuetype="string";void 0===a.isValid&&(a.isValid=!0);"boolean"!==typeof a.strictMode||a.strictMode||["max"].forEach(function(b){"string"===
typeof a[b]&&(a[b]=parseInt(a[b]))});if(void 0===a.name||"string"!==typeof a.name||0===a.name.length)a.name="String parameter";if(void 0===a.max||"number"!==typeof a.max)a.max=Number.MAX_SAFE_INTEGER,a.isValid=!1;if(void 0===a.defval||"string"!==typeof a.defval)a.defval="",a.isValid=!1;a.defval.length>a.max&&(a.defval=a.defval.slice(0,a.max),a.isValid=!1);void 0!==a.value&&"string"!==typeof a.value&&(a.value=a.defval,a.isValid=!1);void 0!==a.value&&a.value.length>a.max&&(a.value=a.value.slice(0,a.max),
a.isValid=!1);CommonParameter$$module$src$shared$types$ShapeDiverParameters.call(this,a);var c=this.checkValue;this.checkValue=function(a){return c(a)?a.length<=b.getSettingShallow("max"):!1};this.getDefinition=function(){return b.getSettings("id name plugin note type defval group max _name order hidden".split(" "))};return this};module$src$shared$types$ShapeDiverParameters.default.StringParameter=StringParameter$$module$src$shared$types$ShapeDiverParameters;
var BooleanParameter$$module$src$shared$types$ShapeDiverParameters=function(a){var b=this;void 0===a||"object"!==typeof a?a=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(a=module$src$shared$util$GlobalUtils.default.deepCopy(a),module$src$shared$util$GlobalUtils.default.defaults(a,defaultSettings$$module$src$shared$types$ShapeDiverParameters));a.valuetype="boolean";void 0===a.isValid&&(a.isValid=!0);"boolean"!==typeof a.strictMode||a.strictMode||"string"!==typeof a.defval||("false"===
a.defval.toLowerCase()?a.defval=!1:"true"===a.defval.toLowerCase()?a.defval=!0:0>=parseInt(a.defval)?a.defval=!1:0<parseInt(a.defval)&&(a.defval=!0));if(void 0===a.name||"string"!==typeof a.name||0===a.name.length)a.name="Boolean parameter";if(void 0===a.defval||"boolean"!==typeof a.defval)a.defval=!1,a.isValid=!1;CommonParameter$$module$src$shared$types$ShapeDiverParameters.call(this,a);var c=this.checkValue;this.checkValue=function(a){if("string"===typeof a&&!b.getSettingShallow("strictMode"))if("true"===
a.toLowerCase())a=!0;else if("false"===a.toLowerCase())a=!1;else return!1;return c(a)};var d=this.setValue;this.setValue=function(a){if("string"===typeof a&&!b.getSettingShallow("strictMode"))if("true"===a.toLowerCase())a=!0;else if("false"===a.toLowerCase())a=!1;else return!1;return d(a)};this.getDefinition=function(){return b.getSettings("id name plugin note type defval group _name order hidden".split(" "))};return this};module$src$shared$types$ShapeDiverParameters.default.BooleanParameter=BooleanParameter$$module$src$shared$types$ShapeDiverParameters;
var ColorParameter$$module$src$shared$types$ShapeDiverParameters=function(a){var b=this,c=function(b){return b.toString("hex8").replace("#","0x")};void 0===a||"object"!==typeof a?a=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(a=module$src$shared$util$GlobalUtils.default.deepCopy(a),module$src$shared$util$GlobalUtils.default.defaults(a,defaultSettings$$module$src$shared$types$ShapeDiverParameters));a.max=Number.MAX_SAFE_INTEGER;void 0===a.isValid&&(a.isValid=!0);if(void 0===a.name||
"string"!==typeof a.name||0===a.name.length)a.name="Color parameter";void 0===a.defval&&(a.defval="white");var d=(0,module$src$shared$util$toTinyColor.default)(a.defval);null===d?(a.defval=(0,module$src$shared$util$toTinyColor.default)("white"),a.isValid=!1):a.defval=d;a.defval=c(a.defval);void 0===a.value?a.value=a.defval:(d=(0,module$src$shared$util$toTinyColor.default)(a.defval),null===d?(a.value=(0,module$src$shared$util$toTinyColor.default)("white"),a.isValid=!1):a.value=d);a.value=c(a.value);
StringParameter$$module$src$shared$types$ShapeDiverParameters.call(this,a);var e=this.setValue;this.setValue=function(b){b=(0,module$src$shared$util$toTinyColor.default)(b);return null===b?!1:e(c(b))};this.getValue=function(){return c((0,module$src$shared$util$toTinyColor.default)(b.getSettingShallow("value")))};this.getValueTinyColor=function(){return(0,module$src$shared$util$toTinyColor.default)(b.getSettingShallow("value"))};this.getValueString=function(){return b.getValue()};this.parseValue=function(a){return b.setValue(a)};
this.getDefinition=function(){return b.getSettings("id name plugin note type defval group _name order hidden".split(" "))};return this};module$src$shared$types$ShapeDiverParameters.default.ColorParameter=ColorParameter$$module$src$shared$types$ShapeDiverParameters;
var FileParameter$$module$src$shared$types$ShapeDiverParameters=function(a){var b=this;void 0===a||"object"!==typeof a?a=defaultSettings$$module$src$shared$types$ShapeDiverParameters:(a=module$src$shared$util$GlobalUtils.default.deepCopy(a),module$src$shared$util$GlobalUtils.default.defaults(a,defaultSettings$$module$src$shared$types$ShapeDiverParameters));void 0===a.isValid&&(a.isValid=!0);if(void 0===a.name||"string"!==typeof a.name||0===a.name.length)a.name="File parameter";"boolean"!==typeof a.strictMode||
a.strictMode||["max"].forEach(function(b){"string"===typeof a[b]&&(a[b]=parseInt(a[b]))});void 0===a.defval&&(a.defval="");"string"!==typeof a.defval&&(a.defval="",a.isValid=!1);void 0===a.value&&(a.value=a.defval);"string"!==typeof a.value&&(a.value="",a.isValid=!1);if(void 0===a.max||"number"!==typeof a.max)a.max=0,a.isValid=!1;module$src$shared$util$GlobalUtils.default.isArrayOfType(a.format,"string")||(a.format=[],a.isValid=!1);StringParameter$$module$src$shared$types$ShapeDiverParameters.call(this,
a);var c=function(b){return module$src$shared$util$GlobalUtils.default.typeCheck(b,"string")?""===b||uuidv4Regex$$module$src$shared$types$ShapeDiverParameters.test(b)||b.startsWith("http://")||b.startsWith("https://")?!0:!1:!1};this.checkValue=function(b){return c(b)};var d=this.setValue;this.setValue=function(b){return c(b)?d(b):!1};this.acceptsBlobs=function(){return!0};this.getDefinition=function(){return b.getSettings("id name plugin note type defval group _name order hidden max format".split(" "))};
return this};module$src$shared$types$ShapeDiverParameters.default.FileParameter=FileParameter$$module$src$shared$types$ShapeDiverParameters;
var ParameterFactory$$module$src$shared$types$ShapeDiverParameters=function(a){var b=this;module$src$shared$mixins$GlobalMixin.default.call(this);module$src$shared$mixins$SettingsMixin.default.call(this,a);module$src$shared$mixins$LoggingMixin.default.call(this);var c=module$src$shared$util$GlobalUtils.default.deepCopy(a),d={"float":FloatParameter$$module$src$shared$types$ShapeDiverParameters,"int":IntegerParameter$$module$src$shared$types$ShapeDiverParameters,even:EvenIntegerParameter$$module$src$shared$types$ShapeDiverParameters,
odd:OddIntegerParameter$$module$src$shared$types$ShapeDiverParameters,string:StringParameter$$module$src$shared$types$ShapeDiverParameters,color:ColorParameter$$module$src$shared$types$ShapeDiverParameters,"stringlist:sequence":ValueListParameter$$module$src$shared$types$ShapeDiverParameters,"stringlist:cycle":ValueListParameter$$module$src$shared$types$ShapeDiverParameters,"stringlist:dropdown":ValueListParameter$$module$src$shared$types$ShapeDiverParameters,"stringlist:checklist":MultipleChoiceParameter$$module$src$shared$types$ShapeDiverParameters,
bool:BooleanParameter$$module$src$shared$types$ShapeDiverParameters,file:FileParameter$$module$src$shared$types$ShapeDiverParameters};this.produce=function(a){a=module$src$shared$util$GlobalUtils.default.deepCopy(a);if(void 0===a.type||"string"!==typeof a.type)b.debug("ShapeDiverParameters~factory","type not defined");else{var e=d[(a.type+":"+a.visualization).toLowerCase()];if(void 0===e&&(e=d[a.type.toLowerCase()],void 0===e)){b.debug("ShapeDiverParameters~factory","type not known: "+a.type.toLowerCase());
return}try{a.hasOwnProperty("hidden")||(a.hidden=!1);module$src$shared$util$GlobalUtils.default.inject(c,a);var h=new e(a);if(h.isValid())return h;b.debug("ShapeDiverParameters~factory","created parameter not valid for "+b.jsify(a)+": "+b.jsify(h.getSettings())+", try to set strictMode to false")}catch(g){b.debug("ShapeDiverParameters~factory","exception creating parameter",a,g)}}};return this};module$src$shared$types$ShapeDiverParameters.default.ParameterFactory=ParameterFactory$$module$src$shared$types$ShapeDiverParameters;var module$src$app$partials$ViewerAppParameterManager={},GlobalUtils$$module$src$app$partials$ViewerAppParameterManager=module$src$shared$util$GlobalUtils.default,pluginConstants$$module$src$app$partials$ViewerAppParameterManager=module$src$shared$constants$PluginConstantsGlobal.default,messagingConstants$$module$src$app$partials$ViewerAppParameterManager=module$src$shared$constants$MessagingConstants.default,MessagePrototype$$module$src$app$partials$ViewerAppParameterManager=module$src$shared$messages$MessagePrototype.default;
module$src$app$partials$ViewerAppParameterManager.default=function(a){var b=this,c={},d=[],e=new module$src$shared$types$ShapeDiverParameters.default.ParameterFactory({strictMode:!1});if(a&&a.hasOwnProperty("pluginManager")&&a.pluginManager.hasOwnProperty("getPluginByRuntimeId"))var f=a.pluginManager;var h=[],g=[],k=function(b){if(h.length!==g.length){for(var a=[],d=[],e=g.length,f=Math.max(0,e-50),l=f;l<e;l++)a.push(h[g[l]]),d.push(l-f);g=d;h=a}b||(b=c.getParameterState());h.push(b);g.push(h.length-
1)};c.canGoBackInHistory=function(){return 0>=h.length||0>=g[g.length-1]?!1:!0};c.canGoForwardInHistory=function(){return 0>=h.length||g[g.length-1]>=h.length-1?!1:!0};c.goBackInHistory=function(b){if(!c.canGoBackInHistory())return!1;var a=g[g.length-1]-1;g.push(a);c.setMultipleParameterValues(h[a],b,!1,!0);return!0};c.goForwardInHistory=function(b){if(!c.canGoForwardInHistory())return!1;var a=g[g.length-1]+1;g.push(a);c.setMultipleParameterValues(h[a],b,!1,!0);return!0};c.registerMultipleParameters=
function(b,a){var d=[];Object.keys(b).forEach(function(e){var f=module$src$shared$util$GlobalUtils.default.deepCopy(b[e]);f.id=e;"time"!==f.type.toLowerCase()&&(e=c.registerParameter(f,a),void 0!==e&&d.push(e))});return d};c.registerParameter=function(a,f){if(void 0===f||"string"!==typeof f)b.debug("ViewerAppParameterManager.registerParameter","No plugin specified");else if(a&&"object"===typeof a){a.plugin=f;if(void 0===a.id||"string"!==typeof a.id)a.id=module$src$shared$util$GlobalUtils.default.createRandomId(),
b.debug("ViewerAppParameterManager.registerParameter","No id was specified, using "+a.id);if(void 0!==c.getUniqueParameterBySettings({id:a.id,plugin:f}))b.debug("ViewerAppParameterManager.registerParameter","Parameter with id "+a.id+" and plugin "+f+" already exists");else if(f=e.produce(a),void 0===f)b.debug("ViewerAppParameterManager.registerParameter","Parameter factory failed for definition",a);else return d.push(f),f={},f[a.id]=a,b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PARAMETER_REGISTERED,
new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_DEFINITION,f)),a.id}else b.debug("ViewerAppParameterManager.registerParameter","Definition of parameter missing")};c.updateParameter=function(a){if(!a||"object"!==typeof a)return b.debug("ViewerAppParameterManager.updateParameter","Definition of parameter missing"),!1;var c=n(a);if(void 0===c)return b.debug("ViewerAppParameterManager.updateParameter","Parameter not found",
a),!1;c=d[c];var e=c.getSetting("name");"string"===typeof a.name&&0<a.name.length&&a.name!==e&&(c.getSetting("_name")||c.updateSetting("_name",e),c.updateSetting("name",a.name));"number"===typeof a.order&&c.updateSetting("order",a.order);"boolean"===typeof a.hidden&&c.updateSetting("hidden",a.hidden);c.getDefinition();b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PARAMETER_UPDATE,new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_DEFINITION,
c.getDefinition()));return!0};c.updateMultipleParameters=function(b){Array.isArray(b)||(b=[b]);return b.every(function(b){return c.updateParameter(b)})};c.registerConfig=function(a,d){var e={};if(a.controlNames&&"object"===typeof a.controlNames){var f=a.controlNames;Object.keys(f).forEach(function(b){var a=c.getUniqueParameterBySettings({id:b,plugin:d});a&&(a.getSetting("_name")||a.updateSetting("_name",a.getSetting("name")),a.updateSetting("name",f[b]),e[a.getSettingShallow("id")]=a)})}if(a.controlOrder&&
Array.isArray(a.controlOrder))for(var g=a.controlOrder,h=0;h<g.length;h++){var l=c.getUniqueParameterBySettings({id:g[h],plugin:d});l&&(l.updateSetting("order",h),e[l.getSettingShallow("id")]=l)}if(a.parametersHidden&&Array.isArray(a.parametersHidden))for(a=a.parametersHidden,g=0;g<a.length;g++)if(h=c.getUniqueParameterBySettings({id:a[g],plugin:d}))h.updateSetting("hidden",!0),e[h.getSettingShallow("id")]=h;Object.keys(e).forEach(function(a){a=e[a].getDefinition();var c={};c[a.id]=a;b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PARAMETER_UPDATE,
new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_DEFINITION,c))});return!0};c.getConfig=function(b){b=c.getParameterDefinitionsAndValues({plugin:b});if(Array.isArray(b)){if(0===b.length)return{};var a={};b.forEach(function(b){module$src$shared$util$GlobalUtils.default.typeCheck(b.name,"string")&&module$src$shared$util$GlobalUtils.default.typeCheck(b._name,"string")&&(a.controlNames=a.controlNames||[],a.controlNames.push({id:b.id,
name:b.name}));module$src$shared$util$GlobalUtils.default.typeCheck(b.hidden,"boolean")&&b.hidden&&(a.parametersHidden=a.parametersHidden||[],a.parametersHidden.push(b.id));module$src$shared$util$GlobalUtils.default.typeCheck(b.order,"number")&&(a.controlOrder=a.controlOrder||[],a.controlOrder.push({id:b.id,order:b.order}))});return a}};c.deregisterParameter=function(a,c){var e={};e.id=a;void 0!==c&&(e.plugin=c);e=m(e);if(void 0===e)return b.error("ViewerAppParameterManager.deregisterParameter","Parameter with id "+
a+" and plugin "+c+" not found"),!1;c=d.splice(e,1)[0];b.info("ViewerAppParameterManager.deregisterParameter",'Deregistered parameter "'+c.getSetting("name")+'" with id '+a);return!0};c.getParameterById=function(b,a){var d={};d.id=b;void 0!==a&&(d.plugin=a);return c.getUniqueParameterBySettings(d)};c.getParameterByName=function(b,a){var d={};d.name=b;void 0!==a&&(d.plugin=a);return c.getUniqueParameterBySettings(d)};c.getParameterByIdOrName=function(b,a){var d={};d.id=b;void 0!==a&&(d.plugin=a);a=
c.getUniqueParameterBySettings(d);if(void 0!==a)return a;delete d.id;d.name=b;return c.getUniqueParameterBySettings(d)};c.getParametersBySettings=function(b){return d.filter(function(a){return Object.keys(b).every(function(c){return a.hasSetting(c)&&a.getSettingShallow(c)===b[c]?!0:!1})})};c.idsUnique=function(){var b=[];return d.every(function(a){a=a.getSetting("id");if(b.includes(a))return!1;b.push(a);return!0})};c.namesUnique=function(){var b=[];return d.every(function(a){a=a.getSetting("name");
if(b.includes(a))return!1;b.push(a);return!0})};var l=function(b){var a=[];d.forEach(function(c,d){Object.keys(b).every(function(a){return c.hasSetting(a)&&c.getSettingShallow(a)===b[a]?!0:!1})&&a.push(d)});return a},m=function(b){b=l(b);if(1===b.length)return b[0]};c.getUniqueParameterBySettings=function(b){b=c.getParametersBySettings(b);if(1===b.length)return b[0]};c.getParameterDefinitions=function(a){var e={};(void 0!==a&&"object"===typeof a?c.getParametersBySettings(a):d).forEach(function(a,
d){var f=a.getDefinition();f&&"object"===typeof f?(d=a.getSetting("id"),1<c.getParametersBySettings({id:d}).length&&(d=d+"__"+a.getSetting("plugin")),e[d]=f):b.debug("ViewerAppParameterManager.getParameterDefinitions","Could not get definition of parameter "+d)});return e};c.getParameterDefinitionsAndValues=function(a){a=void 0!==a&&"object"===typeof a?c.getParametersBySettings(a):d;var e=[];a.forEach(function(a,c){var d=a.getDefinition();d&&"object"===typeof d?(d.value=a.getValue(),e.push(d)):b.debug("ViewerAppParameterManager.getParameterDefinitionsAndValues",
"Could not get definition of parameter "+c)});e.sort(function(b,a){var c=b.plugin;var d=a.plugin;"number"===typeof b.order&&"number"===typeof a.order?(c+=Math.floor(1E3*b.order).toString().padStart(8,"0"),d+=Math.floor(1E3*a.order).toString().padStart(8,"0")):(c+=b.name,d+=a.name);return c<d?-1:c>d?1:0});return e};var n=function(b){if(b&&"object"===typeof b){var a={};void 0!==b.plugin&&"string"===typeof b.plugin&&(a.plugin=b.plugin);if(void 0!==b.id&&"string"===typeof b.id){a.id=b.id;var c=m(a);if(void 0!==
c)return c;delete a.id}if(void 0!==b.idOrName&&"string"===typeof b.idOrName){a.id=b.idOrName;c=m(a);if(void 0!==c)return c;delete a.id;a.name=b.idOrName;c=m(a);if(void 0!==c)return c;delete a.name}if(void 0!==b._name&&"string"===typeof b._name&&(a._name=b._name,c=m(a),void 0!==c)||void 0!==b.name&&"string"===typeof b.name&&(a.name=b.name,c=m(a),void 0!==c))return c}};c.updateRequiresPriorUpload=function(b){Array.isArray(b)||(b=[b]);for(var a=!1,c=0,e=b.length;c<e;c++){var f=b[c];if(f.value instanceof
Blob){f=n(f);if(void 0===f)return;d[f].acceptsBlobs()&&(a=!0)}}return a};c.priorUpload=function(a){var c={params:[],plugins:{}},e=function(b,a,d){c.err||(c.err=[]);c.err.push({code:b,msg:a,data:d})};if(!Array.isArray(a))return e(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.ERROR,"Not an array"),Promise.resolve(c);if(void 0===f)return e(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,"Plugin functionality not found"),b.debug("ViewerAppParameterManager.priorUpload",
"Plugin functionality not found"),Promise.resolve(c);for(var g={},h=0,l=a.length;h<l;h++){var m=a[h];if(m.value instanceof Blob){var k=n(m);if(void 0===k)return e(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PARAM_NOT_FOUND,"Could not find parameter",m),b.debug("ViewerAppParameterManager.priorUpload","Could not find parameter",m),Promise.resolve(c);k=d[k];m.id=k.getSetting("id");m.plugin=k.getSetting("plugin");if(!k.checkBlob(m.value))return e(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_REJECT,
"Blob size or type rejected",m),c.params.push({id:m.id,plugin:m.plugin,result:module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_REJECT}),b.debug("ViewerAppParameterManager.priorUpload","Blob size or type rejected"),Promise.resolve(c);g.hasOwnProperty(m.plugin)||(g[m.plugin]={request:{},data:{}});g[m.plugin].request[m.id]={format:m.value._type,size:m.value.size};g[m.plugin].data[m.id]=m.value;c.params.push({id:m.id,plugin:m.plugin,result:module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_OK})}}h=
[];var r=[],A;for(A in g){l=f.getPluginByRuntimeId(A);if(!l)return e(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,"Plugin not found",A),b.debug("ViewerAppParameterManager.priorUpload","Plugin "+A+" not found"),c.plugins[A]=module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,Promise.resolve(c);h.push(l.fileUpload(g[A]));r.push(A)}return Promise.all(h).then(function(b){for(var d={},e=0,f=b.length;e<f;d={plugin$118:d.plugin$118},
e++){d.plugin$118=r[e];var g=b[e],h={},l;for(l in g){h.id=l;var m=a.find(function(b,a){return function(c){return c.plugin===b.plugin$118&&c.id===a.id}}(d,h));if(!m)throw Error("ViewerAppParameterManager.priorUpload: internal error, parameter not found");m.value=g[h.id];h={id:h.id}}}return c},function(b){e(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.UPLOAD_FAILED,"Upload failed",b);return c})};c.setParameterValue=function(b,a){return c.setMultipleParameterValues([b],
a)};c.setMultipleParameterValues=function(a,e,h,l){void 0===h&&(h=!1);var m=c.getParameterState(),p={params:[],plugins:{}};e=module$src$shared$constants$MessagingConstants.default.makeMessageToken(e);p.token=e;var q=function(b,a,c){p.err||(p.err=[]);p.err.push({code:b,msg:a,data:c})},r=function(b,a,c){p.warn||(p.warn=[]);p.warn.push({code:b,msg:a,data:c})},u=[];a.forEach(function(a){var c=n(a);void 0===c?(q(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PARAM_NOT_FOUND,
"Could not find parameter",a),b.debug("ViewerAppParameterManager.setMultipleParameterValues","Could not find parameter",a)):(a.idx=c,c=d[c],a.id=c.getSetting("id"),a.plugin=c.getSetting("plugin"),u.includes(a.plugin)||u.push(a.plugin),void 0===a.value?(q(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.NO_VALUE,"Parameter value not set",a.value),p.params.push({id:a.id,plugin:a.plugin,result:module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.NO_VALUE}),
b.debug("ViewerAppParameterManager.setMultipleParameterValues","Parameter value not set",a,c)):c.checkValue(a.value)||(q(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_REJECT,"Parameter value rejected",a.value),p.params.push({id:a.id,plugin:a.plugin,result:module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_REJECT}),b.debug("ViewerAppParameterManager.setMultipleParameterValues","Parameter value rejected",a,c)))});if(p.err||p.warn)return p;
var A=!0,z=[];a.forEach(function(a){var c=d[a.idx];c.isValueDifferent(a.value)?(z.includes(a.plugin)||z.push(a.plugin),A=!1,c.setValue(a.value)?p.params.push({id:a.id,plugin:a.plugin,result:module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_OK}):(q(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_REJECT,"Parameter value rejected",a.value),p.params.push({id:a.id,plugin:a.plugin,result:module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_REJECT}),
b.debug("ViewerAppParameterManager.setMultipleParameterValues","Parameter value rejected",a,c))):p.params.push({id:a.id,plugin:a.plugin,result:module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.VALUE_EXISTS})});if(p.err)return h=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,p.err,e),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,h),p;h&&
(z=u);var B=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{busy:!1,progress:0},e);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,B);if(A&&!h)return h=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS,"All parameter values up to date",e),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,
h),p;0===g.length&&k(m);l||A||k();h=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{busy:!0,progress:0},e);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,h);var D={};if(1<z.length){h=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_FORK,[],e);l=(z.length+"").length;for(m=0;m<z.length;m++)B=
module$src$shared$util$GlobalUtils.default.deepCopy(e),B.id=e.id+"."+(Array(l).join("0")+m).slice(-l),D[z[m]]=B,h.parts[0].data.push(B.id);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,h)}else z.forEach(function(a){D[a]=module$src$shared$util$GlobalUtils.default.deepCopy(e)});var G={};z.forEach(function(c){var e=a.filter(function(a){return a.plugin===c});G[c]={};var g=G[c];e.forEach(function(a){g[a.id]=d[a.idx].getValue()});var h;if(void 0===f)r(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,
"Plugin functionality not found",c),b.warn("ViewerAppParameterManager.setMultipleParameterValues","Plugin functionality not found"),p.plugins[c]=module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND;else if(h=f.getPluginByRuntimeId(c)){var l={};h.getCapabilities().includes(module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities.PARTIAL_UPDATES)?(e.forEach(function(a){l[a.id]=d[a.idx].getValueString()}),e=h.setMultipleParameterValues(l,
D[c]),p.plugins[c]=e):(e.forEach(function(a){l[a.id]=d[a.idx].getValueString()}),d.forEach(function(a){var b=a.getSetting("id");c!==a.getSetting("plugin")||l.hasOwnProperty(b)||(l[b]=a.getValueString())}),e=h.setAllParameterValues(l,D[c]),p.plugins[c]=e)}else q(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,"Plugin not found",c),b.debug("ViewerAppParameterManager.setMultipleParameterValues","Plugin "+c+" not found"),p.plugins[c]=module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND});
h=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_UPDATE,G,e);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PARAMETER_VALUE_UPDATE,h);if(p.err||p.warn)h=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,p.err,e),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,
h);return p};c.getParameterValuesForPlugin=function(a,b){var d={};c.getParametersBySettings({plugin:a}).forEach(function(a){b?d[a.getSetting("id")]=a.getValueString():d[a.getSetting("id")]=a.getSetting("value")});return d};c.refreshPluginInitial=function(a,b){var d={plugins:{}};b=module$src$shared$constants$MessagingConstants.default.makeMessageToken(b);d.token=b;var e=function(a,b,c){d.err||(d.err=[]);d.err.push({code:a,msg:b,data:c})};if(void 0===f)return e(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,
"Plugin functionality not found",a),d.plugins[a]=module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,d;var g=f.getPluginByRuntimeId(a);return g?g.hasSetting("deferGeometryLoading")&&g.getSettingShallow("deferGeometryLoading")?(d.plugins[a]=module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.ABORT,d):c.refreshPlugin(a,b):(e(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,"Plugin not found",
a),d.plugins[a]=module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,d)};c.refreshPlugin=function(a,d){var e={plugins:{}};d=module$src$shared$constants$MessagingConstants.default.makeMessageToken(d);e.token=d;var g=function(a,b,c){e.err||(e.err=[]);e.err.push({code:a,msg:b,data:c})},h=[];c.getParametersBySettings({plugin:a}).forEach(function(b){h.push({id:b.getSetting("id"),value:b.getSetting("value"),plugin:a})});if(0>=h.length&&f){var l=f.getPluginByRuntimeId(a);
if(!l)return g(module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,"Plugin not found",a),e.plugins[a]=module$src$shared$constants$PluginConstantsGlobal.default.setParameterResults.PLUGIN_NOT_FOUND,e;g=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{busy:!0,progress:0},d);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,g);
e.plugins[a]=l.setAllParameterValues({},d);return e}return c.setMultipleParameterValues(h,d,!0)};c.getParameterValuesCompat=function(){var a={};d.forEach(function(b){a[b.getSettingShallow("id")]=b.getSetting("value")});return a};c.getParameterState=function(){var a=[];d.forEach(function(b){a.push({id:b.getSettingShallow("id"),plugin:b.getSettingShallow("plugin"),value:b.getSettingShallow("value")})});return a};return c};var module$src$app$partials$ViewerAppExportManager={},GlobalUtils$$module$src$app$partials$ViewerAppExportManager=module$src$shared$util$GlobalUtils.default,pluginConstants$$module$src$app$partials$ViewerAppExportManager=module$src$shared$constants$PluginConstantsGlobal.default,messagingConstants$$module$src$app$partials$ViewerAppExportManager=module$src$shared$constants$MessagingConstants.default,MessagePrototype$$module$src$app$partials$ViewerAppExportManager=module$src$shared$messages$MessagePrototype.default;
module$src$app$partials$ViewerAppExportManager.default=function(a){var b=this,c=a.pluginManager,d=a.parameterManager,e={},f=[];e.registerMultipleExports=function(a,b){Object.keys(a).forEach(function(c){var d=module$src$shared$util$GlobalUtils.default.deepCopy(a[c]);d.id=c;e.registerExport(d,b)});return[]};e.registerExport=function(a,c){if(void 0!==c&&module$src$shared$util$GlobalUtils.default.typeCheck(c,"string"))if(void 0===a||"object"!==typeof a)b.debug("ViewerAppExportManager.registerExport",
"Definition of export missing");else if(a.plugin=c,void 0!==a.id&&module$src$shared$util$GlobalUtils.default.typeCheck(a.id,"string")||(a.id=module$src$shared$util$GlobalUtils.default.createRandomId(),b.debug("ViewerAppExportManager.registerExport","No id was specified, using "+a.id)),void 0!==e.getUniqueExportByProperties({id:a.id,plugin:c}))b.debug("ViewerAppExportManager.registerExport","Export with id "+a.id+" and plugin "+c+" already exists");else return a.hasOwnProperty("hidden")||(a.hidden=
!1),void 0===a.name&&b.warn("ViewerAppExportManager.registerExport","Export without name:",a),f.push(a),c={},c[a.id]=module$src$shared$util$GlobalUtils.default.deepCopy(a),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_REGISTERED,new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_DEFINITION,c)),a.id;else b.debug("ViewerAppExportManager.registerExport","No plugin specified")};
e.registerConfig=function(a,c){var d={};if(void 0!==a.controlNames&&"object"===typeof a.controlNames){var f=a.controlNames;Object.keys(f).forEach(function(a){var b=e.getUniqueExportByProperties({id:a,plugin:c});b&&(void 0===b._name&&(b._name=module$src$shared$util$GlobalUtils.default.deepCopy(b.name)),b.name=module$src$shared$util$GlobalUtils.default.deepCopy(f[a]),d[b.id]=b)})}if(void 0!==a.controlOrder&&Array.isArray(a.controlOrder))for(var g=a.controlOrder,h=0;h<g.length;h++){var l=e.getUniqueExportByProperties({id:g[h],
plugin:c});l&&(l.order=h,d[l.id]=l)}if(void 0!==a.parametersHidden&&Array.isArray(a.parametersHidden))for(a=a.parametersHidden,g=0;g<a.length;g++)if(h=e.getUniqueExportByProperties({id:a[g],plugin:c}))h.hidden=!0,d[h.id]=h;Object.keys(d).forEach(function(a){a=module$src$shared$util$GlobalUtils.default.deepCopy(d[a]);var c={};c[a.id]=a;b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_UPDATE,new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_DEFINITION,
c))});return!0};e.getConfig=function(a){var b=e.getExportDefinitions();if(Array.isArray(b)){b=b.filter(function(b){return void 0===b.plugin||b.plugin===a});if(0===b.length)return{};var c={};b.forEach(function(a){module$src$shared$util$GlobalUtils.default.typeCheck(a.name,"string")&&module$src$shared$util$GlobalUtils.default.typeCheck(a._name,"string")&&(c.controlNames=c.controlNames||[],c.controlNames.push({id:a.id,name:a.name}));module$src$shared$util$GlobalUtils.default.typeCheck(a.hidden,"boolean")&&
a.hidden&&(c.parametersHidden=c.parametersHidden||[],c.parametersHidden.push(a.id));module$src$shared$util$GlobalUtils.default.typeCheck(a.order,"number")&&(c.controlOrder=c.controlOrder||[],c.controlOrder.push({id:a.id,order:a.order}))});return c}};e.updateExport=function(a){if(!a||"object"!==typeof a)return b.debug("ViewerAppExportManager.updateExport","Definition of export missing"),!1;var c=k(a);if(void 0===c)return b.debug("ViewerAppExportManager.updateExport","Export not found",a),!1;c=f[c];
"string"===typeof a.name&&0<a.name.length&&a.name!==c.name&&(void 0===c._name&&(c._name=module$src$shared$util$GlobalUtils.default.deepCopy(c.name)),c.name=module$src$shared$util$GlobalUtils.default.deepCopy(a.name));"number"===typeof a.order&&(c.order=a.order);"boolean"===typeof a.hidden&&(c.hidden=a.hidden);a=module$src$shared$util$GlobalUtils.default.deepCopy(c);c={};c[a.id]=a;b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_UPDATE,new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_DEFINITION,
c));return!0};e.updateMultipleExports=function(a){Array.isArray(a)||(a=[a]);return a.every(function(a){return e.updateExport(a)})};e.deregisterExport=function(a,c){var d={};d.id=a;void 0!==c&&(d.plugin=c);d=g(d);if(void 0===d)return b.error("ViewerAppExportManager.deregisterExport","Export with id "+a+" and plugin "+c+" not found"),!1;c=f.splice(d,1)[0];b.info("ViewerAppExportManager.deregisterExport",'Deregistered export "'+c.name+'" with id '+a);return!0};e.getExportById=function(a,b){var c={};
c.id=a;void 0!==b&&(c.plugin=b);return e.getUniqueExportByProperties(c)};e.getExportByName=function(a,b){var c={};c.name=a;void 0!==b&&(c.plugin=b);return e.getUniqueExportByProperties(c)};e.getExportByIdOrName=function(a,b){var c={};c.id=a;void 0!==b&&(c.plugin=b);b=e.getUniqueExportByProperties(c);if(void 0!==b)return b;delete c.id;c.name=a;return e.getUniqueExportByProperties(c)};e.getExportsByProperties=function(a){return f.filter(function(b){return Object.keys(a).every(function(c){return b.hasOwnProperty(c)&&
b[c]===a[c]?!0:!1})})};var h=function(a){var b=[];f.forEach(function(c,d){Object.keys(a).every(function(b){return c.hasOwnProperty(b)&&c[b]===a[b]?!0:!1})&&b.push(d)});return b},g=function(a){a=h(a);if(1===a.length)return a[0]};e.getUniqueExportByProperties=function(a){a=e.getExportsByProperties(a);if(1===a.length)return a[0]};e.getExportDefinitions=function(){var a=[];f.forEach(function(b){b=module$src$shared$util$GlobalUtils.default.deepCopy({id:b.id,name:b.name,type:b.type,plugin:b.plugin,group:b.group,
hidden:b.hidden,order:b.order,_name:b._name});a.push(b)});a.sort(function(a,b){var c=a.plugin;var d=b.plugin;"number"===typeof a.order&&"number"===typeof b.order?(c+=Math.floor(1E3*a.order).toString().padStart(8,"0"),d+=Math.floor(1E3*b.order).toString().padStart(8,"0")):(c+=a.name,d+=b.name);return c<d?-1:c>d?1:0});return a};var k=function(a){if(void 0!==a&&"object"===typeof a){var b={};void 0!==a.plugin&&"string"===typeof a.plugin&&(b.plugin=a.plugin);if(void 0!==a.id&&"string"===typeof a.id){b.id=
a.id;var c=g(b);if(void 0!==c)return c;delete b.id}if(void 0!==a.idOrName&&"string"===typeof a.idOrName){b.id=a.idOrName;c=g(b);if(void 0!==c)return c;delete b.id;b.name=a.idOrName;c=g(b);if(void 0!==c)return c;delete b.name}if(void 0!==a._name&&"string"===typeof a._name&&(b._name=a._name,c=g(b),void 0!==c)||void 0!==a.name&&"string"===typeof a.name&&(b.name=a.name,c=g(b),void 0!==c))return c}};e.getUniqueExportByRequestObject=function(a){a=k(a);if(void 0!==a)return module$src$shared$util$GlobalUtils.default.deepCopy(f[a])};
e.requestExport=function(a,e){e=module$src$shared$constants$MessagingConstants.default.makeMessageToken(e);var g=function(a,c){e&&(c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,c,e),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,c));return a},h=k(a);if(void 0===h)return b.error("ViewerAppExportManager.requestExport","Export not found",a),g(module$src$shared$constants$PluginConstantsGlobal.default.requestExportResults.EXPORT_NOT_FOUND,
"Export not found");a=f[h];h=d.getParameterValuesForPlugin(a.plugin,!0);if(void 0===c||void 0===c.getPluginByRuntimeId)return b.error("ViewerAppExportManager.requestExport","Plugin manager not found"),g(module$src$shared$constants$PluginConstantsGlobal.default.requestExportResults.PLUGIN_NOT_FOUND,"Plugin manager not found");var l=c.getPluginByRuntimeId(a.plugin);if(!l)return a="Plugin "+a.plugin+" not found",b.error("ViewerAppExportManager.requestExport",a),g(module$src$shared$constants$PluginConstantsGlobal.default.requestExportResults.PLUGIN_NOT_FOUND,
a);e&&(g=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{progress:0},e),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,g),g=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_STATUS,a,e),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_STATUS,g));
return l.requestExport(a.id,h,e)};return e};var module$src$3d$viewport$defaults$DefaultHighlights={default:[{apply:function(a,b){a.material&&(a.material.opacity*=b.opacity,a.material.transparent=!0)},remove:function(a,b){a.material&&(a.material.opacity*=1/b.opacity,a.material.transparent=!1)}},{apply:function(a,b){a.material&&(a.material.color.r+=b.color.r,a.material.color.g+=b.color.g,a.material.color.b+=b.color.b)},remove:function(a,b){a.material&&(a.material.color.r-=b.color.r,a.material.color.g-=b.color.g,a.material.color.b-=b.color.b)}}]};var module$src$3d$InteractionGroupManager={default:function(){var a,b=[],c=function(){a=this};c.prototype.InteractionGroup=function(a){var b={},c=a.name,d=a.selectable||!1,g=a.draggable||!1,k=a.hoverable||!1,l=a.selectionMode||"single",m=function(a){if(!a)return null;if("function"===typeof a.apply&&"function"===typeof a.remove)return a;a.name||(a.name="opacityHighlight");"opacityHighlight"==a.name?(a.apply=module$src$3d$viewport$defaults$DefaultHighlights.default[0].apply,a.remove=module$src$3d$viewport$defaults$DefaultHighlights.default[0].remove,
a.options)?a.options.opacity||(a.options.opacity=.5):a.options={opacity:.5}:"colorHighlight"==a.name&&(a.apply=module$src$3d$viewport$defaults$DefaultHighlights.default[1].apply,a.remove=module$src$3d$viewport$defaults$DefaultHighlights.default[1].remove,a.options?a.options.color=a.options.color?(0,module$src$shared$util$toTinyColor.default)(a.options.color,"red").toThreeColor():new module$src$externals$three.default.Color(1,0,0):a.options={color:new module$src$externals$three.default.Color(1,0,0)});
return a.apply&&a.remove?a:null},n={active:a.selectableHighlight&&a.selectableHighlight.active?m(a.selectableHighlight.active):null,passive:a.selectableHighlight&&a.selectableHighlight.passive?m(a.selectableHighlight.passive):null},r={active:a.draggableHighlight&&a.draggableHighlight.active?m(a.draggableHighlight.active):null,passive:a.draggableHighlight&&a.draggableHighlight.passive?m(a.draggableHighlight.passive):null},u={active:a.hoverableHighlight&&a.hoverableHighlight.active?m(a.hoverableHighlight.active):
null,passive:a.hoverableHighlight&&a.hoverableHighlight.passive?m(a.hoverableHighlight.passive):null};b.getName=function(){return c};b.isSelectable=function(){return d};b.isDraggable=function(){return g};b.isHoverable=function(){return k};b.getSelectionMode=function(){return l};b.getSelectableHighlight=function(){return n};b.getDraggableHighlight=function(){return r};b.getHoverableHighlight=function(){return u};return b};c.prototype.addInteractionGroup=function(c){return c.name&&!a.isInteractionGroup(c.name)?
(b.push(new a.InteractionGroup(c)),!0):!1};c.prototype.addOrReplaceInteractionGroup=function(c){b=b.filter(function(a){return a.getName()!==c.name});return a.addInteractionGroup(c)};c.prototype.isInteractionGroup=function(b){return null==a.getGroup(b)?!1:!0};c.prototype.getGroup=function(a){for(var c=0,d=b.length;c<d;c++)if(b[c].getName()==a)return b[c];return null};c.prototype.getGroups=function(){return b};return new c}};var module$src$3d$viewportManager$ViewportManagerThreeDManager={default:function(a,b){a.threeDManager={};a.threeDManager.adjustScene=function(){for(var a=0,d=b.length;a<d;a++)b[a].threeDManager.adjustScene()};a.threeDManager.fadeIn=function(a,d){for(var c=[],f=0,h=b.length;f<h;f++)c.push(b[f].threeDManager.fadeIn(a,d));return Promise.all(c)};a.threeDManager.fadeOut=function(a,d){for(var c=[],f=0,h=b.length;f<h;f++)c.push(b[f].threeDManager.fadeOut(a,d));return Promise.all(c)};a.threeDManager.updateInteractions=
function(a,d){for(var c=0,f=b.length;c<f;c++)b[c].threeDManager.updateInteractions(a,d)};a.threeDManager.removeFromInteractions=function(a){for(var c=0,e=b.length;c<e;c++)b[c].threeDManager.removeFromInteractions(a)};a.threeDManager.addMesh=function(a,d,e){for(var c=0,h=b.length;c<h;c++)b[c].threeDManager.addMesh(a,d[c],e)};a.threeDManager.removeMesh=function(a){for(var c=0,e=b.length;c<e;c++)b[c].threeDManager.removeMesh(a);a.geometry.dispose()};a.threeDManager.addAnchor=function(a,d){var c=[];d.viewports&&
0!==d.viewports.length&&(c=d.viewports);for(var f=0,h=b.length;f<h;f++)(c.includes(b[f].getViewportRuntimeId())||0===c.length)&&b[f].threeDManager.addAnchor(a,d)};a.threeDManager.removeAnchor=function(a){for(var c=0,e=b.length;c<e;c++)b[c].threeDManager.removeAnchor(a)};a.threeDManager.renderingHandler={};a.threeDManager.renderingHandler.render=function(){for(var a=0,d=b.length;a<d;a++)b[a].threeDManager.renderingHandler.render()};a.threeDManager.renderingHandler.setBlur=function(a,d){for(var c=0,
f=b.length;c<f;c++)b[c].threeDManager.renderingHandler.setBlur(a,d)};a.threeDManager.renderingHandler.registerForContinuousRendering=function(a,d){for(var c=0,f=b.length;c<f;c++)b[c].threeDManager.renderingHandler.registerForContinuousRendering(a,d)};a.threeDManager.renderingHandler.unregisterForContinuousRendering=function(a){for(var c=0,e=b.length;c<e;c++)b[c].threeDManager.renderingHandler.unregisterForContinuousRendering(a)};a.threeDManager.renderingHandler.containsContinuousRendering=function(a){for(var c=
[],e=0,f=b.length;e<f;e++)c.push(b[e].threeDManager.renderingHandler.containsContinuousRendering(a));return 1===c.length?c[0]:c};a.threeDManager.renderingHandler.updateShadowMap=function(){for(var a=0,d=b.length;a<d;a++)b[a].threeDManager.renderingHandler.updateShadowMap()};a.threeDManager.renderingHandler.keepUpdatingShadowMap=function(){for(var a=0,d=b.length;a<d;a++)b[a].threeDManager.renderingHandler.keepUpdatingShadowMap()};a.threeDManager.renderingHandler.stopUpdatingShadowMap=function(){for(var a=
0,d=b.length;a<d;a++)b[a].threeDManager.renderingHandler.stopUpdatingShadowMap()};a.threeDManager.materialHandler={};a.threeDManager.materialHandler.getMaterial=function(a,d,e,f,h){for(var c=[],k=0,l=b.length;k<l;k++)c.push(b[k].threeDManager.materialHandler.getMaterial(a,d,e,f,h));return c}}};var module$src$api$v2$ApiResponse={},GLOBALUTILS$$module$src$api$v2$ApiResponse=module$src$shared$util$GlobalUtils.default,ApiResponse$$module$src$api$v2$ApiResponse=function(a,b,c){this.payload=this.data=this.err=null;Array.isArray(a)||(a=[a]);for(var d=0;d<a.length;d++){var e=a[d];void 0!==e&&null!==e?module$src$shared$util$GlobalUtils.default.typeCheck(e,"string")?a[d]=Error(e):e instanceof Error?a[d]=e:e.hasOwnProperty("m")?(a[d]=Error(e.m),e.hasOwnProperty("d")&&(a[d].data=Error(e.d))):(a[d]=
Error(),a[d].data=e):null!==e&&(a[d]=null)}1===a.length&&void 0!==a[0]&&null!==a[0]?this.err=a[0]:1<a.length&&(this.err=a);void 0!==b&&null!==b&&(this.data=b);void 0!==c&&null!==c&&(this.payload=c)};module$src$api$v2$ApiResponse.default=function(a,b,c){return new ApiResponse$$module$src$api$v2$ApiResponse(a,b,c)};var module$src$3d$interfaces$api$LightApiInterface={default:function(){this.LIGHTTYPE={AMBIENT:"ambient",DIRECTIONAL:"directional",HEMISPHERE:"hemisphere",POINT:"point",SPOT:"spot",FLASH:"flash"};this.LIGHTSCENE={DEFAULT:"default",LEGACY:"legacy"}}};module$src$3d$interfaces$api$LightApiInterface.default.prototype.updateLight=function(a){};module$src$3d$interfaces$api$LightApiInterface.default.prototype.removeLight=function(a){};
module$src$3d$interfaces$api$LightApiInterface.default.prototype.getLight=function(a){};module$src$3d$interfaces$api$LightApiInterface.default.prototype.setLightSceneFromID=function(a){};module$src$3d$interfaces$api$LightApiInterface.default.prototype.setLightSceneFromDefinition=function(a){};module$src$3d$interfaces$api$LightApiInterface.default.prototype.getLightScene=function(a){};module$src$3d$interfaces$api$LightApiInterface.default.prototype.getAllLightScenes=function(){};
module$src$3d$interfaces$api$LightApiInterface.default.prototype.saveLightScene=function(a){};var module$src$3d$interfaces$api$CameraApiInterface={default:function(){this.TYPE={PERSPECTIVE:0,TOP:1,BOTTOM:2,RIGHT:3,LEFT:4,BACK:5,FRONT:6,AR:7};this.CONTROLTYPE={ORBIT:0,FPS:1,ORTHOGRAPHIC:2};this.EVENTTYPE={CAMERA_START:"start",CAMERA_MOVE:"move",CAMERA_END:"end"}}};module$src$3d$interfaces$api$CameraApiInterface.default.prototype.get=function(){};module$src$3d$interfaces$api$CameraApiInterface.default.prototype.updateAsync=function(a,b){};
module$src$3d$interfaces$api$CameraApiInterface.default.prototype.animateAsync=function(a,b){};module$src$3d$interfaces$api$CameraApiInterface.default.prototype.zoomAsync=function(a,b){};module$src$3d$interfaces$api$CameraApiInterface.default.prototype.resetAsync=function(a){};module$src$3d$interfaces$api$CameraApiInterface.default.prototype.updateMatrices=function(){};module$src$3d$interfaces$api$CameraApiInterface.default.prototype.addEventListener=function(a,b){};
module$src$3d$interfaces$api$CameraApiInterface.default.prototype.removeEventListener=function(){};var module$src$3d$viewportManager$ViewportManagerApi={},APIResponse$$module$src$3d$viewportManager$ViewportManagerApi=module$src$api$v2$ApiResponse.default,LightApiInterface$$module$src$3d$viewportManager$ViewportManagerApi=new module$src$3d$interfaces$api$LightApiInterface.default,CameraApiInterface$$module$src$3d$viewportManager$ViewportManagerApi=new module$src$3d$interfaces$api$CameraApiInterface.default;
module$src$3d$viewportManager$ViewportManagerApi.default=function(a,b){var c=function(a,c,f){var d=null;d=b;for(var e=[],k=0,l=d.length;k<l;k++){var m=d[k];a&&(m="camera"===a?m.camera:"lights"===a?m.lights:m);e.push(m[c].call.apply(m[c],[m].concat($jscomp.arrayFromIterable(f))))}1===d.length?e=e[0]:1<d.length&&e[0].constructor===(0,module$src$api$v2$ApiResponse.default)().constructor?e=(0,module$src$api$v2$ApiResponse.default)(e.map(function(a){return a.err}),e.map(function(a){return a.data}),e.map(function(a){return a.payload})):
1<d.length&&e[0]instanceof Promise&&(e=Promise.all(e).then(function(a){return(0,module$src$api$v2$ApiResponse.default)(a.map(function(a){return a.err}),a.map(function(a){return a.data}),a.map(function(a){return a.payload}))}));return e};a.api={getViewportRuntimeId:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"getViewportRuntimeId",b)},getContainer:function(a){for(var d=[],f=0;f<arguments.length;++f)d[f-0]=arguments[f];for(f=0;f<b.length;f++)if(b[f].getViewportRuntimeId()===
d[0])return d.splice(0,1),b[f].getContainer.apply(b[f],$jscomp.arrayFromIterable(d));return c(null,"getContainer",d)},getScreenshot:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"getScreenshot",b)},getScreenshotAsync:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"getScreenshotAsync",b)},render:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"render",b)},updateShadowMap:function(a){for(var b=
[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"updateShadowMap",b)},startContinuousRendering:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"startContinuousRendering",b)},stopContinuousRendering:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"stopContinuousRendering",b)},convertTo2D:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"convertTo2D",b)},pause:function(a){for(var b=
[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"pause",b)},resume:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"resume",b)},addEventListener:function(a){},removeEventListener:function(a){},getSettingDefinitions:function(){return b[0].getSettingDefinitions()},getSettings:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"getSettings",b)},getSetting:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=
arguments[d];return c(null,"getSetting",b)},updateSettingAsync:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"updateSettingAsync",b)},updateSettingsAsync:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"updateSettingsAsync",b)},setTransformation:function(a){for(var d=[],f=0;f<arguments.length;++f)d[f-0]=arguments[f];for(f=0;f<b.length;f++)if(b[f].getViewportRuntimeId()===d[0])return d.splice(0,1),b[f].setTransformation.apply(b[f],
$jscomp.arrayFromIterable(d));return c(null,"setTransformation",d)},getTransformation:function(a){for(var d=[],f=0;f<arguments.length;++f)d[f-0]=arguments[f];for(f=0;f<b.length;f++)if(b[f].getViewportRuntimeId()===d[0])return d.splice(0,1),b[f].getTransformation.apply(b[f],$jscomp.arrayFromIterable(d));return c(null,"getTransformation",d)},applyTransformation:function(a){for(var d=[],f=0;f<arguments.length;++f)d[f-0]=arguments[f];for(f=0;f<b.length;f++)if(b[f].getViewportRuntimeId()===d[0])return d.splice(0,
1),b[f].applyTransformation.apply(b[f],$jscomp.arrayFromIterable(d));return c(null,"applyTransformation",d)},resetTransformation:function(a){for(var d=[],f=0;f<arguments.length;++f)d[f-0]=arguments[f];for(f=0;f<b.length;f++)if(b[f].getViewportRuntimeId()===d[0])return d.splice(0,1),b[f].resetTransformation.apply(b[f],$jscomp.arrayFromIterable(d));return c(null,"resetTransformation",d)},setLiveTransformation:function(a){for(var d=[],f=0;f<arguments.length;++f)d[f-0]=arguments[f];for(f=0;f<b.length;f++)if(b[f].getViewportRuntimeId()===
d[0])return d.splice(0,1),b[f].setLiveTransformation.apply(b[f],$jscomp.arrayFromIterable(d));return c(null,"setLiveTransformation",d)},updateSelected:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"updateSelected",b)},getSelected:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"getSelected",b)},startExternalDragEvent:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"startExternalDragEvent",
b)},toggleGeometry:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c(null,"toggleGeometry",b)}};a.api.camera={addEventListener:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("camera","addEventListener",b)},removeEventListener:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("camera","removeEventListener",b)},get:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("camera",
"get",b)},updateAsync:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("camera","updateAsync",b)},animateAsync:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("camera","animateAsync",b)},zoomAsync:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("camera","zoomAsync",b)},resetAsync:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("camera","resetAsync",b)},updateMatrices:function(a){for(var b=
[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("camera","updateMatrices",b)},TYPE:CameraApiInterface$$module$src$3d$viewportManager$ViewportManagerApi.TYPE,CONTROLTYPE:CameraApiInterface$$module$src$3d$viewportManager$ViewportManagerApi.CONTROLTYPE,EVENTTYPE:CameraApiInterface$$module$src$3d$viewportManager$ViewportManagerApi.EVENTTYPE};a.api.lights={updateLight:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("lights","updateLight",b)},getLight:function(a){for(var b=
[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("lights","getLight",b)},removeLight:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("lights","removeLight",b)},setLightSceneFromID:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("lights","setLightSceneFromID",b)},setLightSceneFromDefinition:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("lights","setLightSceneFromDefinition",b)},getLightScene:function(a){for(var b=
[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("lights","getLightScene",b)},getAllLightScenes:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("lights","getAllLightScenes",b)},saveLightScene:function(a){for(var b=[],d=0;d<arguments.length;++d)b[d-0]=arguments[d];return c("lights","saveLightScene",b)},LIGHTTYPE:LightApiInterface$$module$src$3d$viewportManager$ViewportManagerApi.LIGHTTYPE,LIGHTSCENE:LightApiInterface$$module$src$3d$viewportManager$ViewportManagerApi.LIGHTSCENE}};var module$node_modules$$tweenjs$tween_js$src$Tween={},_Group$$module$node_modules$$tweenjs$tween_js$src$Tween=function(){this._tweens={};this._tweensAddedDuringUpdate={}};
_Group$$module$node_modules$$tweenjs$tween_js$src$Tween.prototype={getAll:function(){return Object.keys(this._tweens).map(function(a){return this._tweens[a]}.bind(this))},removeAll:function(){this._tweens={}},add:function(a){this._tweens[a.getId()]=a;this._tweensAddedDuringUpdate[a.getId()]=a},remove:function(a){delete this._tweens[a.getId()];delete this._tweensAddedDuringUpdate[a.getId()]},update:function(a,b){var c=Object.keys(this._tweens);if(0===c.length)return!1;for(a=void 0!==a?a:module$node_modules$$tweenjs$tween_js$src$Tween.default.now();0<
c.length;){this._tweensAddedDuringUpdate={};for(var d=0;d<c.length;d++){var e=this._tweens[c[d]];e&&!1===e.update(a)&&(e._isPlaying=!1,b||delete this._tweens[c[d]])}c=Object.keys(this._tweensAddedDuringUpdate)}return!0}};module$node_modules$$tweenjs$tween_js$src$Tween.default=new _Group$$module$node_modules$$tweenjs$tween_js$src$Tween;module$node_modules$$tweenjs$tween_js$src$Tween.default.Group=_Group$$module$node_modules$$tweenjs$tween_js$src$Tween;
module$node_modules$$tweenjs$tween_js$src$Tween.default._nextId=0;module$node_modules$$tweenjs$tween_js$src$Tween.default.nextId=function(){return module$node_modules$$tweenjs$tween_js$src$Tween.default._nextId++};
module$node_modules$$tweenjs$tween_js$src$Tween.default.now="undefined"===typeof self&&"undefined"!==typeof process&&process.hrtime?function(){var a=process.hrtime();return 1E3*a[0]+a[1]/1E6}:"undefined"!==typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()};
module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween=function(a,b){this._object=a;this._valuesStart={};this._valuesEnd={};this._valuesStartRepeat={};this._duration=1E3;this._repeat=0;this._repeatDelayTime=void 0;this._reversed=this._isPlaying=this._yoyo=!1;this._delayTime=0;this._startTime=null;this._easingFunction=module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Linear.None;this._interpolationFunction=module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation.Linear;
this._chainedTweens=[];this._onStartCallback=null;this._onStartCallbackFired=!1;this._onStopCallback=this._onCompleteCallback=this._onRepeatCallback=this._onUpdateCallback=null;this._group=b||module$node_modules$$tweenjs$tween_js$src$Tween.default;this._id=module$node_modules$$tweenjs$tween_js$src$Tween.default.nextId()};
module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},to:function(a,b){this._valuesEnd=Object.create(a);void 0!==b&&(this._duration=b);return this},duration:function(a){this._duration=a;return this},start:function(a){this._group.add(this);this._isPlaying=!0;this._onStartCallbackFired=!1;this._startTime=void 0!==a?"string"===typeof a?module$node_modules$$tweenjs$tween_js$src$Tween.default.now()+parseFloat(a):
a:module$node_modules$$tweenjs$tween_js$src$Tween.default.now();this._startTime+=this._delayTime;for(var b in this._valuesEnd){if(this._valuesEnd[b]instanceof Array){if(0===this._valuesEnd[b].length)continue;this._valuesEnd[b]=[this._object[b]].concat(this._valuesEnd[b])}void 0!==this._object[b]&&(this._valuesStart[b]=this._object[b],!1===this._valuesStart[b]instanceof Array&&(this._valuesStart[b]*=1),this._valuesStartRepeat[b]=this._valuesStart[b]||0)}return this},stop:function(){if(!this._isPlaying)return this;
this._group.remove(this);this._isPlaying=!1;null!==this._onStopCallback&&this._onStopCallback(this._object);this.stopChainedTweens();return this},end:function(){this.update(Infinity);return this},stopChainedTweens:function(){for(var a=0,b=this._chainedTweens.length;a<b;a++)this._chainedTweens[a].stop()},group:function(a){this._group=a;return this},delay:function(a){this._delayTime=a;return this},repeat:function(a){this._repeat=a;return this},repeatDelay:function(a){this._repeatDelayTime=a;return this},
yoyo:function(a){this._yoyo=a;return this},easing:function(a){this._easingFunction=a;return this},interpolation:function(a){this._interpolationFunction=a;return this},chain:function(){this._chainedTweens=arguments;return this},onStart:function(a){this._onStartCallback=a;return this},onUpdate:function(a){this._onUpdateCallback=a;return this},onRepeat:function(a){this._onRepeatCallback=a;return this},onComplete:function(a){this._onCompleteCallback=a;return this},onStop:function(a){this._onStopCallback=
a;return this},update:function(a){var b;if(a<this._startTime)return!0;!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0);var c=(a-this._startTime)/this._duration;c=0===this._duration||1<c?1:c;var d=this._easingFunction(c);for(b in this._valuesEnd)if(void 0!==this._valuesStart[b]){var e=this._valuesStart[b]||0,f=this._valuesEnd[b];f instanceof Array?this._object[b]=this._interpolationFunction(f,d):("string"===typeof f&&
(f="+"===f.charAt(0)||"-"===f.charAt(0)?e+parseFloat(f):parseFloat(f)),"number"===typeof f&&(this._object[b]=e+(f-e)*d))}null!==this._onUpdateCallback&&this._onUpdateCallback(this._object,c);if(1===c)if(0<this._repeat){isFinite(this._repeat)&&this._repeat--;for(b in this._valuesStartRepeat)"string"===typeof this._valuesEnd[b]&&(this._valuesStartRepeat[b]+=parseFloat(this._valuesEnd[b])),this._yoyo&&(c=this._valuesStartRepeat[b],this._valuesStartRepeat[b]=this._valuesEnd[b],this._valuesEnd[b]=c),this._valuesStart[b]=
this._valuesStartRepeat[b];this._yoyo&&(this._reversed=!this._reversed);this._startTime=void 0!==this._repeatDelayTime?a+this._repeatDelayTime:a+this._delayTime;null!==this._onRepeatCallback&&this._onRepeatCallback(this._object)}else{null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);a=0;for(b=this._chainedTweens.length;a<b;a++)this._chainedTweens[a].start(this._startTime+this._duration);return!1}return!0}};
module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing={Linear:{None:function(a){return a}},Quadratic:{In:function(a){return a*a},Out:function(a){return a*(2-a)},InOut:function(a){return 1>(a*=2)?.5*a*a:-.5*(--a*(a-2)-1)}},Cubic:{In:function(a){return a*a*a},Out:function(a){return--a*a*a+1},InOut:function(a){return 1>(a*=2)?.5*a*a*a:.5*((a-=2)*a*a+2)}},Quartic:{In:function(a){return a*a*a*a},Out:function(a){return 1- --a*a*a*a},InOut:function(a){return 1>(a*=2)?.5*a*a*a*a:-.5*((a-=2)*a*a*
a-2)}},Quintic:{In:function(a){return a*a*a*a*a},Out:function(a){return--a*a*a*a*a+1},InOut:function(a){return 1>(a*=2)?.5*a*a*a*a*a:.5*((a-=2)*a*a*a*a+2)}},Sinusoidal:{In:function(a){return 1-Math.cos(a*Math.PI/2)},Out:function(a){return Math.sin(a*Math.PI/2)},InOut:function(a){return.5*(1-Math.cos(Math.PI*a))}},Exponential:{In:function(a){return 0===a?0:Math.pow(1024,a-1)},Out:function(a){return 1===a?1:1-Math.pow(2,-10*a)},InOut:function(a){return 0===a?0:1===a?1:1>(a*=2)?.5*Math.pow(1024,a-1):
.5*(-Math.pow(2,-10*(a-1))+2)}},Circular:{In:function(a){return 1-Math.sqrt(1-a*a)},Out:function(a){return Math.sqrt(1- --a*a)},InOut:function(a){return 1>(a*=2)?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)}},Elastic:{In:function(a){return 0===a?0:1===a?1:-Math.pow(2,10*(a-1))*Math.sin(5*(a-1.1)*Math.PI)},Out:function(a){return 0===a?0:1===a?1:Math.pow(2,-10*a)*Math.sin(5*(a-.1)*Math.PI)+1},InOut:function(a){if(0===a)return 0;if(1===a)return 1;a*=2;return 1>a?-.5*Math.pow(2,10*(a-1))*Math.sin(5*
(a-1.1)*Math.PI):.5*Math.pow(2,-10*(a-1))*Math.sin(5*(a-1.1)*Math.PI)+1}},Back:{In:function(a){return a*a*(2.70158*a-1.70158)},Out:function(a){return--a*a*(2.70158*a+1.70158)+1},InOut:function(a){return 1>(a*=2)?.5*a*a*(3.5949095*a-2.5949095):.5*((a-=2)*a*(3.5949095*a+2.5949095)+2)}},Bounce:{In:function(a){return 1-module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Bounce.Out(1-a)},Out:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/
2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},InOut:function(a){return.5>a?.5*module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Bounce.In(2*a):.5*module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Bounce.Out(2*a-1)+.5}}};
module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation={Linear:function(a,b){var c=a.length-1,d=c*b,e=Math.floor(d),f=module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation.Utils.Linear;return 0>b?f(a[0],a[1],d):1<b?f(a[c],a[c-1],c-d):f(a[e],a[e+1>c?c:e+1],d-e)},Bezier:function(a,b){for(var c=0,d=a.length-1,e=Math.pow,f=module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation.Utils.Bernstein,h=0;h<=d;h++)c+=e(1-b,d-h)*e(b,h)*a[h]*f(d,h);return c},CatmullRom:function(a,
b){var c=a.length-1,d=c*b,e=Math.floor(d),f=module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation.Utils.CatmullRom;return a[0]===a[c]?(0>b&&(e=Math.floor(d=c*(1+b))),f(a[(e-1+c)%c],a[e],a[(e+1)%c],a[(e+2)%c],d-e)):0>b?a[0]-(f(a[0],a[0],a[1],a[1],-d)-a[0]):1<b?a[c]-(f(a[c],a[c],a[c-1],a[c-1],d-c)-a[c]):f(a[e?e-1:0],a[e],a[c<e+1?c:e+1],a[c<e+2?c:e+2],d-e)},Utils:{Linear:function(a,b,c){return(b-a)*c+a},Bernstein:function(a,b){var c=module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation.Utils.Factorial;
return c(a)/c(b)/c(a-b)},Factorial:function(){var a=[1];return function(b){var c=1;if(a[b])return a[b];for(var d=b;1<d;d--)c*=d;return a[b]=c}}(),CatmullRom:function(a,b,c,d,e){a=.5*(c-a);d=.5*(d-b);var f=e*e;return(2*b-2*c+a+d)*e*f+(-3*b+3*c-2*a-d)*f+a*e+b}}};var module$src$3d$interfaces$ThreeDManagerInterface={default:function(a){this.lightHandler=this.materialHandler=this.cameraHandler=this.renderingHandler=null;this.success=!0;module$src$shared$mixins$GlobalMixin.default.call(this);module$src$shared$util$GlobalUtils.default.inject(a.loggingHandler,this);module$src$shared$util$GlobalUtils.default.inject(a.messagingHandler,this)}};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.init=function(a){};
module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.adjustScene=function(){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.computeBoundingBox=function(a){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.pause=function(){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.resume=function(){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.destroy=function(){};
module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.reload=function(){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.addMesh=function(a,b,c){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.removeMesh=function(a){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.addAnchor=function(a,b){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.removeAnchor=function(a){};
module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.fadeIn=function(a,b){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.fadeOut=function(a,b){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.setLiveTransformation=function(a,b,c,d,e){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.updateInteractions=function(a,b){};module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.removeFromInteractions=function(a){};
module$src$3d$interfaces$ThreeDManagerInterface.default.prototype.toggleGeometry=function(){};var module$src$3d$viewport$ThreeDManagerConstants={},threeDManagerConstants$$module$src$3d$viewport$ThreeDManagerConstants,_convert=function(a,b){for(var c in a){if("value"===c)return _hasSubValue(a[c])?_convert(a[c],b):a[c];"desc"!==c&&(b[c]={},b[c]=_convert(a[c],b[c]))}return b},_hasSubValue=function(a){if("object"===typeof a)for(var b in a)if("value"===b||_hasSubValue(a[b]))return!0;return!1},GLOBAL_UTILS=module$src$shared$util$GlobalUtils.default,LOGGING_CONSTANTS=module$src$shared$constants$LoggingConstants.default,
LOGGING_LEVELS=module$src$shared$constants$LoggingConstants.default.loggingLevels,cameraViewTypes={MIN:0,PERSPECTIVE:0,TOP:1,BOTTOM:2,RIGHT:3,LEFT:4,BACK:5,FRONT:6,MAX:6},cameraControlsTypes={MIN:0,ORBIT:0,FPS:1,ORTHOGRAPHIC:2,MAX:2},settingsDefinition={show:{value:!1,setting:"show",desc:"Show / hide the scene",type:"boolean"},showTransition:{value:"1s"},duration:{value:0,setting:"duration",desc:"Set fade in / fade out duration",type:"number"},fullscreen:{value:!1,setting:"fullscreen",desc:"Enable / disable fullscreen mode",
type:"boolean"},gridVisibility:{value:!0,setting:"gridVisibility",desc:"Show / hide the grid",type:"boolean"},groundPlaneVisibility:{value:!0,setting:"groundPlaneVisibility",desc:"Show / hide the ground plane",type:"boolean"},groundPlaneReflectionVisibility:{value:!1,setting:"groundPlaneReflectionVisibility",desc:"Enable / disable the reflectivity of the groundplane ",type:"boolean"},groundPlaneReflectionThreshold:{value:.01,setting:"groundPlaneReflectionThreshold",desc:"Allows to control the distance to objects that are still reflected by the groundplane ",
type:function(a){return"number"===typeof a&&0<=a}},render:{ambientOcclusion:{value:!0,setting:"render.ambientOcclusion",desc:"Enable / disable ambient occlusion for rendering",type:"boolean"},beautyRenderDelay:{value:50,setting:"beautyRenderDelay",desc:"Amount of which the beauty rendering is delayed",type:"number"},clearColor:{value:"#ffffff",setting:"render.clearColor",desc:"Set background color",type:function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"color")?!0:!1}},clearAlpha:{value:1,
setting:"render.clearAlpha",desc:"Set background alpha value",type:function(a){return"number"===typeof a&&0<=a&&1>=a?!0:!1}},devicePixelRatio:{value:1},pointSize:{value:1,setting:"render.pointSize",desc:"Set size of point objects",type:function(a){return"number"===typeof a&&0<=a?!0:!1}},sao:{samples:{value:8},intensity:{value:.1},kernelRadius:{value:8},standardDev:{value:25}},shadows:{value:!0,setting:"render.shadows",desc:"Enable / disable shadows for rendering",type:"boolean"}},camera:{cameraTypes:{perspective:{default:{value:{position:{value:{x:0,
y:0,z:0},setting:"camera.cameraTypes.perspective.default.position",desc:"Default position for the perspective camera",type:"vector3any",transform:function(a){return module$src$shared$util$GlobalUtils.default.toVector3(a)}},target:{value:{x:0,y:0,z:0},setting:"camera.cameraTypes.perspective.default.target",desc:"Default target for the perspective camera",type:"vector3any",transform:function(a){return module$src$shared$util$GlobalUtils.default.toVector3(a)}}},setting:"camera.cameraTypes.perspective.default",
desc:"Default position and target for the perspective camera",type:function(a){return a&&module$src$shared$util$GlobalUtils.default.typeCheck(a.position,"vector3obj")&&module$src$shared$util$GlobalUtils.default.typeCheck(a.target,"vector3obj")}},fov:{value:45,setting:"camera.cameraTypes.perspective.fov",desc:"Camera frustum vertical field of view angle, unit degree, interval [0,180]",type:function(a){return"number"===typeof a&&0<a&&180>a?!0:!1}},controls:{value:cameraControlsTypes.ORBIT,setting:"camera.cameraTypes.perspective.controls",
desc:"Set camera control type",type:function(a){return"number"!==typeof a||a!==cameraControlsTypes.ORBIT&&a!==cameraControlsTypes.FPS?!1:!0}}},orthographic:{default:{value:{position:{value:{x:0,y:0,z:0},setting:"camera.cameraTypes.orthographic.default.position",desc:"Default position for the orthographic camera",type:"vector3any",transform:function(a){return module$src$shared$util$GlobalUtils.default.toVector3(a)}},target:{value:{x:0,y:0,z:0},setting:"camera.cameraTypes.orthographic.default.target",
desc:"Default target for the orthographic camera",type:"vector3any",transform:function(a){return module$src$shared$util$GlobalUtils.default.toVector3(a)}}},setting:"camera.cameraTypes.orthographic.default",desc:"Default position and target for the orthographic camera",type:function(a){return a&&module$src$shared$util$GlobalUtils.default.typeCheck(a.position,"vector3obj")&&module$src$shared$util$GlobalUtils.default.typeCheck(a.target,"vector3obj")}}},active:{value:cameraViewTypes.PERSPECTIVE,setting:"camera.cameraTypes.active",
desc:"Set camera type",type:function(a){return"number"===typeof a&&a>=cameraViewTypes.MIN&&a<=cameraViewTypes.MAX?!0:!1}}},controls:{orbit:{autoRotationSpeed:{value:0,setting:"camera.controls.orbit.autoRotationSpeed",desc:"Speed of autoration, can be negative, also refer to enableAutoRotation",type:"number"},damping:{value:.1,setting:"camera.controls.orbit.damping",desc:"How much to damp camera movements by the user",type:"notnegative"},enableAutoRotation:{value:!1,setting:"camera.controls.orbit.enableAutoRotation",
desc:"Enable / disable automatic rotation of the camera, also refer to autoRotationSpeed",type:"boolean"},enableKeyPan:{value:!1,setting:"camera.controls.orbit.enableKeyPan",desc:"Enable / disable panning using the keyboard, also refer to enablePan",type:"boolean"},enablePan:{value:!0,setting:"camera.controls.orbit.enablePan",desc:"Enable / disable panning in general, also refer to enableKeyPan",type:"boolean"},enableRotation:{value:!0,setting:"camera.controls.orbit.enableRotation",desc:"Enable / disable camera rotation",
type:"boolean"},enableZoom:{value:!0,setting:"camera.controls.orbit.enableZoom",desc:"Enable / disable zooming",type:"boolean"},input:{value:{keys:{up:38,down:40,left:37,right:39},mouse:{rotate:0,zoom:1,pan:2},touch:{rotate:1,zoom:2,pan:3}},setting:"camera.controls.orthographic.input",type:function(a){return!0}},keyPanSpeed:{value:.5,setting:"camera.controls.orbit.keyPanSpeed",desc:"Speed of panning when using the keyboard",type:"number"},movementSmoothness:{value:.5,setting:"camera.controls.orbit.movementSmoothness",
desc:"How much to the current movement is affected by the previous one",type:"notnegative"},restrictions:{position:{cube:{value:{min:{value:{x:-Infinity,y:-Infinity,z:-Infinity},setting:"camera.controls.orbit.restrictions.position.cube.min",desc:"Restriction of the camera position inside a cube, minimum corner of the cube",type:"vector3any"},max:{value:{x:Infinity,y:Infinity,z:Infinity},setting:"camera.controls.orbit.restrictions.position.cube.max",desc:"Restriction of the camera position inside a cube, maximum corner of the cube",
type:"vector3any"}},setting:"camera.controls.orbit.restrictions.position.cube",desc:"Restriction of the camera position inside a cube, minimum and maximum corner of the cube"},sphere:{value:{center:{value:{x:0,y:0,z:0},setting:"camera.controls.orbit.restrictions.position.sphere.center",desc:"Restriction of the camera position inside a sphere, center of the sphere",type:"vector3any"},radius:{value:Infinity,setting:"camera.controls.orbit.restrictions.position.sphere.radius",desc:"Restriction of the camera position inside a sphere, radius of the sphere",
type:"notnegative"}},setting:"camera.controls.orbit.restrictions.position.sphere",desc:"Restriction of the camera position inside a sphere, center and radius of the sphere"}},target:{cube:{value:{min:{value:{x:-Infinity,y:-Infinity,z:-Infinity},setting:"camera.controls.orbit.restrictions.target.cube.min",desc:"Restriction of the camera target inside a cube, minimum corner of the cube",type:"vector3any"},max:{value:{x:Infinity,y:Infinity,z:Infinity},setting:"camera.controls.orbit.restrictions.target.cube.max",
desc:"Restriction of the camera target inside a cube, maximum corner of the cube",type:"vector3any"}},setting:"camera.controls.orbit.restrictions.target.cube",desc:"Restriction of the camera target inside a cube, minimum and maximum corner of the cube"},sphere:{value:{center:{value:{x:0,y:0,z:0},setting:"camera.controls.orbit.restrictions.target.sphere.center",desc:"Restriction of the camera target inside a sphere, center of the sphere",type:"vector3any"},radius:{value:Infinity,setting:"camera.controls.orbit.restrictions.target.sphere.radius",
desc:"Restriction of the camera target inside a sphere, radius of the sphere",type:"notnegative"}},setting:"camera.controls.orbit.restrictions.target.sphere",desc:"Restriction of the camera target inside a sphere, center and radius of the sphere"}},rotation:{value:{minPolarAngle:{value:0,setting:"camera.controls.orbit.restrictions.rotation.minPolarAngle",desc:"Minimum polar angle of the camera position with respect to the camera target, unit degree, interval [0,180]",type:function(a){return"number"===
typeof a&&0<=a&&180>=a?!0:!1}},maxPolarAngle:{value:180,setting:"camera.controls.orbit.restrictions.rotation.maxPolarAngle",desc:"Maximum polar angle of the camera position with respect to the camera target, unit degree, interval [0,180]",type:function(a){return"number"===typeof a&&0<=a&&180>=a?!0:!1}},minAzimuthAngle:{value:-Infinity,setting:"camera.controls.orbit.restrictions.rotation.minAzimuthAngle",desc:"Minimum azimuth angle of the camera position with respect to the camera target, unit degree, interval [-180,180]",
type:"number"},maxAzimuthAngle:{value:Infinity,setting:"camera.controls.orbit.restrictions.rotation.maxAzimuthAngle",desc:"Maximum azimuth angle of the camera position with respect to the camera target, unit degree, interval [-180,180]",type:"number"}},setting:"camera.controls.orbit.restrictions.rotation",desc:"Minimum and maximum polar and azimuth angle of the camera position with respect to the camera target, unit degree",type:function(a){return a&&Object.keys(a).every(function(b){return"number"===
typeof a[b]})}},zoom:{value:{minDistance:{value:0,setting:"camera.controls.orbit.restrictions.zoom.minDistance",desc:"Minimum distance between camera position and target",type:"notnegative"},maxDistance:{value:Infinity,setting:"camera.controls.orbit.restrictions.zoom.maxDistance",desc:"Maximum distance between camera position and target",type:"notnegative"}},setting:"camera.controls.orbit.restrictions.zoom",desc:"Minimum and maximum distance between camera position and target",type:function(a){return a&&
module$src$shared$util$GlobalUtils.default.typeCheck(a.minDistance,"notnegative")&&module$src$shared$util$GlobalUtils.default.typeCheck(a.maxDistance,"notnegative")}}},rotationSpeed:{value:.5,setting:"camera.controls.orbit.rotationSpeed",desc:"Speed of camera rotation",type:"number"},panSpeed:{value:.5,setting:"camera.controls.orbit.panSpeed",desc:"Speed of panning",type:"number"},zoomSpeed:{value:.5,setting:"camera.controls.orbit.zoomSpeed",desc:"Speed of zooming",type:"notnegative"}},fps:{},orthographic:{damping:{value:.1,
setting:"camera.controls.orthographic.damping",desc:"How much to damp camera movements by the user",type:"notnegative"},enableKeyPan:{value:!1,setting:"camera.controls.orbit.enableKeyPan",desc:"Enable / disable panning using the keyboard, also refer to enablePan",type:"boolean"},enablePan:{value:!0,setting:"camera.controls.orthographic.enablePan",desc:"Enable / disable panning in general, also refer to enableKeyPan",type:"boolean"},enableZoom:{value:!0,setting:"camera.controls.orthographic.enableZoom",
desc:"Enable / disable zooming",type:"boolean"},input:{value:{keys:{up:38,down:40,left:37,right:39},mouse:{rotate:0,zoom:1,pan:2},touch:{rotate:-1,zoom:2,pan:1}},setting:"camera.controls.orthographic.input",type:function(a){return!0}},keyPanSpeed:{value:.5,setting:"camera.controls.orthographic.keyPanSpeed",desc:"Speed of panning when using the keyboard",type:"number"},movementSmoothness:{value:.5,setting:"camera.controls.orthographic.movementSmoothness",desc:"How much to the current movement is affected by the previous one",
type:"notnegative"},panSpeed:{value:.5,setting:"camera.controls.orthographic.panSpeed",desc:"Speed of panning",type:"number"},zoomSpeed:{value:.5,setting:"camera.controls.orthographic.zoomSpeed",desc:"Speed of zooming",type:"notnegative"}}},autoAdjust:{value:!1,setting:"camera.autoAdjust",desc:"Enable / disable that the camera adjusts to geometry updates",type:"boolean"},cameraMovementDuration:{value:0,setting:"camera.cameraMovementDuration",desc:"Default duration of camera movements",type:"notnegative"},
enableCameraControls:{value:!0,setting:"camera.enableCameraControls",desc:"Enable / disable camera controls",type:"boolean"},revertAtMouseUp:{value:!1,setting:"camera.revertAtMouseUp ",desc:"Enable / disable if the mouse should reset on mouse up",type:"boolean"},revertAtMouseUpDuration:{value:800,setting:"camera.revertAtMouseUpDuration",desc:"The duration of the transition of the revertAtMouseUp",type:"notnegative"},zoomExtentsFactor:{value:1,setting:"camera.zoomExtentsFactor",desc:"Factor to apply to the bounding box before zooming to extents",
type:"number"},autoRotationSpeed:{value:0},damping:{value:.1},defaults:{perspective:{value:{position:{value:{x:0,y:0,z:0}},target:{value:{x:0,y:0,z:0}}}},orthographic:{value:{position:{value:{x:0,y:0,z:0}},target:{value:{x:0,y:0,z:0}}}}},enableAutoRotation:{value:!1},enableKeyPan:{value:!1},enablePan:{value:!0},enableRotation:{value:!0},enableZoom:{value:!0},fov:{value:45},keyPanSpeed:{value:1},restrictions:{position:{cube:{value:{min:{value:{x:-Infinity,y:-Infinity,z:-Infinity}},max:{value:{x:Infinity,
y:Infinity,z:Infinity}}}},sphere:{value:{center:{value:{x:0,y:0,z:0}},radius:{value:Infinity}}}},target:{cube:{value:{min:{value:{x:-Infinity,y:-Infinity,z:-Infinity}},max:{value:{x:Infinity,y:Infinity,z:Infinity}}}},sphere:{value:{center:{value:{x:0,y:0,z:0}},radius:{value:Infinity}}}},rotation:{value:{minPolarAngle:{value:0},maxPolarAngle:{value:180},minAzimuthAngle:{value:-Infinity},maxAzimuthAngle:{value:Infinity}}},zoom:{value:{minDistance:{value:0},maxDistance:{value:Infinity}}}},rotationSpeed:{value:.5},
panSpeed:{value:.5},type:{value:cameraViewTypes.PERSPECTIVE},zoomSpeed:{value:1}},lights:{helper:{value:!1,setting:"lights.helpers",desc:"Show / hide the light helpers",type:"boolean"},lightScene:{value:"default",setting:"lights.lightScene"},lightScenes:{value:{},setting:"lights.lightScenes"}},material:{environmentMapAsBackground:{value:!1,setting:"material.environmentMapAsBackground",desc:"Show / hide the environment map in the background",type:"boolean"},environmentMap:{value:"none",setting:"material.environmentMap",
desc:"Name of the environment map to use, or an array of 6 image URLs making up the cube mapped environment map (px, nx, pz, nz, py, ny)",type:function(a){return"string"===typeof a||module$src$shared$util$GlobalUtils.default.isArrayOfType(a,"string")&&6===a.length}},environmentMapResolution:{value:"1024",setting:"material.environmentMapResolution",desc:"Image resolution to be used for the named environment maps (available resolutions: 256, 512, 1024)",type:function(a){return["256","512","1024","2048"].includes(a)}}}},
defaultSettings={};_convert(settingsDefinition,defaultSettings);threeDManagerConstants$$module$src$3d$viewport$ThreeDManagerConstants={settingsDefinition:settingsDefinition,defaultSettings:defaultSettings,loggingLevels:LOGGING_LEVELS,cameraViewTypes:cameraViewTypes};module$src$3d$viewport$ThreeDManagerConstants.default=module$src$shared$util$GlobalUtils.default.deepCopy(threeDManagerConstants$$module$src$3d$viewport$ThreeDManagerConstants);var module$src$3d$viewport$shaders$ShaderFile={default:{}};module$src$3d$viewport$shaders$ShaderFile.default.basic_vert="\nvarying vec2 vUv;\n\nvoid main() {\n\tvUv = uv;\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n\n";module$src$3d$viewport$shaders$ShaderFile.default.blend_frag="\nuniform sampler2D tStandard;\nuniform sampler2D tBeauty;\t\t\nuniform vec2 size;\nuniform float amount;\n\nvarying vec2 vUv;\n\nvoid main() {\n\tgl_FragColor =  texture2D(tStandard, vUv) * (1.0-amount) + texture2D(tBeauty, vUv) * amount;\n}\n\n";
module$src$3d$viewport$shaders$ShaderFile.default.blur_frag="\n#include <common>\n#include <packing>\n\nuniform sampler2D tAO;\nuniform sampler2D tDiffuse;\n\nuniform sampler2D tDepth;\n\nuniform float cameraNear;\nuniform float cameraFar;\nuniform vec2 size;\nuniform int orientation;\n\nuniform float sampleWeights[ KERNEL_RADIUS + 1 ];\n\nvarying vec2 vUv;\n\t\t\nconst float depthCutoff = 1.0;\n\nvoid main() {\n\tfloat depth = unpackRGBAToDepth( texture2D( tDepth, vUv ) );\n\tif( depth >= ( 1.0 - EPSILON ) ) {\n\t\tgl_FragColor = texture2D(tDiffuse, vUv);\n\t\treturn;\n\t}\n\n\tfloat centerViewZ = -perspectiveDepthToViewZ( depth, cameraNear, cameraFar );\n\tvec2 size = 1.0 / size;\n\n\tfloat weightSum = sampleWeights[0];\n\tvec4 sum = texture2D(tAO, vUv) * sampleWeights[0];\n\n\tvec2 position;\n\tfor(int i = 1; i <= KERNEL_RADIUS; i++){\n\t\tif(orientation == 0){\n\t\t\tposition = vec2(vUv.x - size.x*float(i), vUv.y);\n\t\t}else if(orientation == 1){\n\t\t\tposition = vec2(vUv.x, vUv.y - size.y*float(i));\n\t\t}\n\t\tfloat positionDepth = unpackRGBAToDepth( texture2D( tDepth, position ) );\n\t\tfloat viewZ = -perspectiveDepthToViewZ( positionDepth, cameraNear, cameraFar );\n\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) break;\n\t\tfloat weight = sampleWeights[i];\n\t\tsum += texture2D( tAO, position ) * weight;\n\t\tweightSum += weight;\n\t}\n\n\tfor(int i = 1; i <= KERNEL_RADIUS; i++){\n\t\tif(orientation == 0){\n\t\t\tposition = vec2(vUv.x + size.x*float(i), vUv.y);\n\t\t}else if(orientation == 1){\n\t\t\tposition = vec2(vUv.x, vUv.y + size.y*float(i));\n\t\t}\n\t\tfloat positionDepth = unpackRGBAToDepth( texture2D( tDepth, position ) );\n\t\tfloat viewZ = -perspectiveDepthToViewZ( positionDepth, cameraNear, cameraFar );\n\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) break;\n\t\tfloat weight = sampleWeights[i];\n\t\tsum += texture2D( tAO, position ) * weight;\n\t\tweightSum += weight;\n\t}\n\n\tif(orientation == 1){\n\t\tvec4 texel = texture2D(tDiffuse, vUv);\n\t\tgl_FragColor = (sum / weightSum) * texel;\n\t}else{\n\t\tgl_FragColor = (sum / weightSum);\n\t}\n}\n\n";
module$src$3d$viewport$shaders$ShaderFile.default.copy_frag="\nuniform float opacity;\nuniform sampler2D tDiffuse;\n\nvarying vec2 vUv;\n\nvoid main() {\nvec4 texel = texture2D( tDiffuse, vUv );\ngl_FragColor = opacity * texel;\n}\n\n";module$src$3d$viewport$shaders$ShaderFile.default.gem_frag="#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvarying vec4 initialPosition;\nvarying vec3 initialNormal;\n\nvarying vec3 frag_position;\nvarying vec3 frag_normal;\n\nuniform vec3 center;\nuniform float radius;\nuniform samplerCube sphericalNormalMap;\nuniform mat3 normalMatrix;\nuniform mat4 modelMatrix;\nuniform mat4 inverseModelMatrix;\nuniform mat3 inverseTransposeModelMatrix;\n\nuniform samplerCube impurityMap;\nuniform float impurityScale;\nuniform vec3 colorTransferBegin;\nuniform vec3 colorTransferEnd;\nuniform float refractionIndex;\nuniform float gamma;\nuniform float contrast;\nuniform float brightness;\nuniform float dispersion;\nuniform float tracingOpacity;\n\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradianceTemp( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * geometry.normal.x, geometry.normal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * geometry.normal.x, geometry.normal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevelTemp( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadianceTemp( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\tfloat specularMIPLevel = getSpecularMIPLevelTemp( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent ));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n\nvec3 calculateReflectedLight(vec3 position, vec3 normal, vec3 viewDir, PhysicalMaterial material, int depth) {\n\t\n\tGeometricContext currentGeometry;\n\tcurrentGeometry.position = (modelMatrix * vec4(position, 1.0)).xyz;\n\tcurrentGeometry.normal = normalize(inverseTransposeModelMatrix * normal);\n\tcurrentGeometry.viewDir = normalize(inverseTransposeModelMatrix * -viewDir);\n\n\tReflectedLight rLight;\n\tIncidentLight dLight;\n\n\tfloat temp = material.specularRoughness;\n\tmaterial.specularRoughness = 0.5;\n\n\t#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\t\tPointLight pointLight;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\t\tpointLight = pointLights[ i ];\n\t\t\tgetPointDirectLightIrradiance( pointLight, currentGeometry, dLight );\n\t\t\t#ifdef USE_SHADOWMAP\n\t\t\tdLight.color *= all( bvec2( pointLight.shadow, dLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t\t#endif\n\t\t\tRE_Direct( dLight, currentGeometry, material, rLight );\n\t\t}\n\t#endif\n\t#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\t\tSpotLight spotLight;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\t\tspotLight = spotLights[ i ];\n\t\t\tgetSpotDirectLightIrradiance( spotLight, currentGeometry, dLight );\n\t\t\t#ifdef USE_SHADOWMAP\n\t\t\tdLight.color *= all( bvec2( spotLight.shadow, dLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t\t#endif\n\t\t\tRE_Direct( dLight, currentGeometry, material, rLight );\n\t\t}\n\t#endif\n\t#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\t\tDirectionalLight directionalLight;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\t\tdirectionalLight = directionalLights[ i ];\n\t\t\tgetDirectionalDirectLightIrradiance( directionalLight, currentGeometry, dLight );\n\t\t\t#ifdef USE_SHADOWMAP\n\t\t\tdLight.color *= all( bvec2( directionalLight.shadow, dLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t\t#endif\n\t\t\tRE_Direct( dLight, currentGeometry, material, rLight );\n\t\t}\n\t#endif\n\tmaterial.specularRoughness = temp;\n\t\n\t#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\t\tRectAreaLight rectAreaLight;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\t\trectAreaLight = rectAreaLights[ i ];\n\t\t\tRE_Direct_RectArea( rectAreaLight, currentGeometry, material, rLight );\n\t\t}\n\t#endif\n\n\t#if defined( RE_IndirectDiffuse )\n\t\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t\t#pragma unroll_loop\n\t\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], currentGeometry );\n\t\t\t}\n\t\t#endif\n\t#endif\n\t#if defined( RE_IndirectSpecular )\n\t\tvec3 radiance = vec3( 0.0 );\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\n\n\t#if defined( RE_IndirectDiffuse )\n\t\t#ifdef USE_LIGHTMAP\n\t\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\t\tlightMapIrradiance *= PI;\n\t\t\t#endif\n\t\t\tirradiance += lightMapIrradiance;\n\t\t#endif\n\t\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tirradiance += getLightProbeIndirectIrradianceTemp( currentGeometry, maxMipLevel );\n\t\t#endif\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t\tradiance += getLightProbeIndirectRadianceTemp( currentGeometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t\t#ifndef STANDARD\n\t\t\tclearCoatRadiance += getLightProbeIndirectRadianceTemp( currentGeometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t\t#endif\n\t#endif\n\n\n\n\t#if defined( RE_IndirectDiffuse )\n\t\tRE_IndirectDiffuse( irradiance, currentGeometry, material, rLight );\n\t#endif\n\t#if defined( RE_IndirectSpecular )\n\t\tRE_IndirectSpecular( radiance, clearCoatRadiance, currentGeometry, material, rLight );\n\t#endif\n\n\tif(depth >= 0) {\n\t\tfloat frac = float(depth) / float(DEPTH);\n\t\trLight.indirectSpecular *= (1.0-frac) * colorTransferBegin + frac * colorTransferEnd;\n\t}\n\n\tvec3 color = rLight.indirectSpecular + rLight.directSpecular + rLight.indirectDiffuse + rLight.directDiffuse;\n\tcolor = pow(color, vec3(1.0/gamma)); // gamma\n\tcolor.rgb = ((color.rgb - 0.5) * max(contrast, 0.0)) + 0.5; // contrast\n\tcolor += vec3(brightness, brightness, brightness); // brightness\n\treturn color;\n}\n\nvec3 normalLookUp(vec3 dir) {\n\tvec4 s = textureCube(sphericalNormalMap, dir);\n\tif(s.a < 1.0/256.0) {\n\t\treturn normalize(vec3(-s.x, -s.y, -s.z));\n\t} else if(s.a < 3.0/256.0) {\n\t\treturn normalize(vec3(-s.x, -s.y, s.z));\n\t} else if(s.a < 5.0/256.0) {\n\t\treturn normalize(vec3(-s.x, s.y, -s.z));\n\t} else if(s.a < 7.0/256.0) {\n\t\treturn normalize(vec3(s.x, -s.y, -s.z));\n\t} else if(s.a < 9.0/256.0) {\n\t\treturn normalize(vec3(-s.x, s.y, s.z));\n\t} else if(s.a < 11.0/256.0) {\n\t\treturn normalize(vec3(s.x, -s.y, s.z));\n\t} else if(s.a < 13.0/256.0) {\n\t\treturn normalize(vec3(s.x, s.y, -s.z));\n\t} else {\n\t\treturn normalize(s.xyz);\n\t}\n}\n\n#ifdef USE_IMPURITY_MAP\n\tfloat impurityLookUp(vec3 dir) {\n\t\tvec3 c = textureCube(impurityMap, dir).rgb;\n\t\treturn (c.x + c.y + c.z) / 3.0;\n\t}\n#endif\n\nvec3 raySphereIntersection(vec3 o, vec3 d) {\n\n\tvec3 oc = o - center;\nfloat a = dot(d, d);\nfloat b = 2.0 * dot(oc, d);\nfloat c = dot(oc,oc) - radius*radius;\nfloat discriminant = b*b - 4.0*a*c;\nif(discriminant < 0.0){\nreturn vec3(0.0);\n}\nelse{\nreturn o +( (-b + sqrt(discriminant)) / (2.0*a)) * d;\n}\n}\n\nvec3 hueToSaturatedColor(float hue) {\nfloat r,g,b;\nif (hue < 0.25){\n\t\tfloat t = 1.0 - (hue / 0.25);\nr = 1.0;\ng = 1.0;\nb = t;\n\t} else if (hue < 0.5){\n\tfloat t = 1.0 - (hue - 0.25 / 0.25);\n\t\tr = 1.0;\ng = t;\nb = 0.0;\n\t} else if (hue < 0.75){\n\tfloat t = 1.0 - (hue - 0.5 / 0.25);\n\t\tr = t;\ng = 0.0;\nb = 1.0 - t;\n} else {\n\tfloat t = hue - 0.75 / 0.25;\nr = t;\ng = t;\nb = 1.0;\n}\nreturn vec3(r, g, b) / 0.5 + 0.5;\n}\n\nvoid main() {\n\tvec3 frag_normal_normalized = frag_normal;\n\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\n\tvec3 initialDirection = normalize( frag_position - (inverseModelMatrix*vec4(cameraPosition,1.0)).xyz );\n\n\n\tvec4 outgoingLight;\n\tfloat r_0 = (1.0-refractionIndex)/(1.0+refractionIndex);\n\tr_0 = r_0*r_0;\n\n\tfloat cos_theta_0 = -dot(initialDirection, frag_normal_normalized);\n\tfloat r_0_outside = (refractionIndex-1.0)/(refractionIndex+1.0);\n\tr_0_outside = r_0_outside*r_0_outside;\n\tfloat initialProbability = r_0_outside + (1.0 - r_0_outside)*pow(1.0 - cos_theta_0, 5.0);\n\n\t\t\t\t\n\toutgoingLight = vec4(calculateReflectedLight(frag_position, frag_normal_normalized, initialDirection, material, -1), 1.0);\n\tif(DEPTH > 0)\n\t\toutgoingLight *= initialProbability;\n\t\t\n\tvec3 tempColor;\n\n\t#ifdef DISPERSION\n\t\tconst int loop = 3;\n\t\tvec3 dispersionColor;\n\t#else\n\t\tconst int loop = 1;\n\t#endif\n\t\tfor(int j = 0; j < loop; j++){\n\t\t\tvec3 refractedDirection = refract(initialDirection, frag_normal_normalized, 1.0/refractionIndex + float(j)*dispersion);\n\t\t\tvec3 newPosition = raySphereIntersection(frag_position, refractedDirection);\n\t\t\tvec3 lookUpVector = normalize(newPosition - center);\n\t\t\tvec3 newNormal = normalLookUp(lookUpVector);\n\t\t\tvec3 newDirection = reflect(refractedDirection, newNormal);\n\n\t\t\tfloat currentProbability = 1.0;\n\n\t\t\t#ifdef USE_IMPURITY_MAP\n\t\t\t\tfloat impurityProbability = impurityLookUp(lookUpVector);\n\t\t\t\tcurrentProbability -= impurityProbability * impurityScale;\n\t\t\t\t//gl_FragColor = vec4(vec3(impurityProbability), 1.0);\n\t\t\t\t//return;\n\t\t\t#endif\n\t\t\t\n\t\t\t// if(0 == DEPTH) {\n\t\t\t// \tgl_FragColor = vec4(0.5 * newNormal + 0.5, 1.0);\n\t\t\t// \treturn;\n\t\t\t// }\n\n\t\t\ttempColor = vec3(0.0);\n\t\t\tfor(int i = 0; i < DEPTH; i++) {\n\t\t\t\t// small position correction to avoid artefacts\n\t\t\t\tnewPosition = newPosition - lookUpVector * 1e-6;\n\t\t\t\tnewPosition = raySphereIntersection(newPosition, newDirection);\n\t\t\t\tlookUpVector = normalize(newPosition - center);\n\t\t\t\tnewNormal = normalLookUp(lookUpVector);\n\t\t\t\n\t\t\t\tfloat cos_theta = dot(newDirection, newNormal);\n\t\t\t\tfloat ratio;\n\t\t\t\tif(cos_theta > 0.0) {\n\t\t\t\t\tratio = refractionIndex;\n\t\t\t\t} else {\n\t\t\t\t\tcos_theta = -cos_theta;\n\t\t\t\t\tratio = 1.0 / refractionIndex;\n\t\t\t\t}\n\t\t\t\tfloat cos_theta_2 = 1.0 - ratio*ratio * (1.0 - cos_theta*cos_theta);\n\t\t\t\tfloat probability = r_0 + (1.0 - r_0)*pow(1.0 - cos_theta, 5.0);\n\t\t\t\tif(cos_theta_2 < 0.0) probability = 0.0;\n\n\t\t\t\tvec3 refracted = refract(newDirection, newNormal*-1.0, 1.0/refractionIndex);\n\t\t\t\ttempColor += probability * currentProbability * calculateReflectedLight(newPosition, newNormal*-1.0, reflect(refracted, newNormal), material, i);\n\t\t\t\tif(i+1 == DEPTH)\n\t\t\t\t\ttempColor += (1.0 - probability) * currentProbability * calculateReflectedLight(newPosition, newNormal, newDirection, material, i);\n\n\t\t\t\tnewDirection = reflect(newDirection, newNormal);\n\n\t\t\t\t// if(i+1 == DEPTH) {\n\t\t\t\t// \tgl_FragColor = vec4(0.5 * newNormal + 0.5, 1.0);\n\t\t\t\t// \treturn;\n\t\t\t\t// }\n\n\t\t\t\tcurrentProbability *= (1.0 - probability);\n\t\t\t}\n\n\t\t\t#ifdef DISPERSION\n\t\t\t\tif(j == 0) {\n\t\t\t\t\tdispersionColor.r = tempColor.r;\t\n\t\t\t\t} else if(j == 1) {\n\t\t\t\t\tdispersionColor.g = tempColor.g;\t\n\t\t\t\t} else if(j == 2) {\n\t\t\t\t\tdispersionColor.b = tempColor.b;\t\n\t\t\t\t}\n\t\t\t\ttempColor = dispersionColor;\n\t\t\t#endif\n\t\t}\t\n\n\tif(DEPTH > 0)\n\t\toutgoingLight.rgb += (1.0 - initialProbability) * tempColor;\n\n\tfloat alpha = (1.0 - initialProbability) + initialProbability*tracingOpacity;\n\tgl_FragColor = vec4(outgoingLight.rgb, alpha*diffuseColor.a);\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n\n";
module$src$3d$viewport$shaders$ShaderFile.default.gem_vert="#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\nvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvarying vec3 frag_position;\nvarying vec3 frag_normal;\n\nvoid main() {\n#include <uv_vertex>\n#include <uv2_vertex>\n#include <color_vertex>\n#include <beginnormal_vertex>\n#include <morphnormal_vertex>\n#include <skinbase_vertex>\n#include <skinnormal_vertex>\n#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\nvNormal = normalize( transformedNormal );\n#endif\n#include <begin_vertex>\n#include <morphtarget_vertex>\n#include <skinning_vertex>\n#include <displacementmap_vertex>\n#include <project_vertex>\n#include <logdepthbuf_vertex>\n#include <clipping_planes_vertex>\nvViewPosition = - mvPosition.xyz;\nvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#include <shadowmap_vertex>\n#include <fog_vertex>\n\nfrag_position = position;\nfrag_normal = objectNormal;\n}\n\n";
module$src$3d$viewport$shaders$ShaderFile.default.normal_frag="varying highp vec3 vNormal;\n\nfloat decodeFloat(float f) {\n\tfloat r = mod(f, 1.0/255.0);\n\treturn /*r > 0.5/256.0 ? f + (1.0/256.0) - r : */f - r;\n}\n\nvec3 decodeVec3(vec3 v) {\n\treturn vec3(decodeFloat(v.x), decodeFloat(v.y), decodeFloat(v.z));\n}\n\nfloat signEncoding(vec3 v) {\n\tfloat code = 1.0;\n\t if(v.x < 0.0 && v.y < 0.0 && v.z < 0.0) {\n\t\tcode = 0.0;\n\t} else if (v.x < 0.0 && v.y < 0.0) {\n\t\tcode = 2.0/256.0;\n\t} else if (v.x < 0.0 && v.z < 0.0) {\n\t\tcode = 4.0/256.0;\n\t} else if (v.y < 0.0 && v.z < 0.0) {\n\t\tcode = 6.0/256.0;\n\t} else if (v.x < 0.0) {\n\t\tcode = 8.0/256.0;\n\t} else if (v.y < 0.0) {\n\t\tcode = 10.0/256.0;\n\t} else if (v.z < 0.0) {\n\t\tcode = 12.0/256.0;\n\t}\n\treturn code;\n}\n\nvoid main() {\n\tvec3 n = normalize(vNormal);\n\tgl_FragColor = vec4(decodeVec3(abs(n)), signEncoding(n));\n}\n\n";
module$src$3d$viewport$shaders$ShaderFile.default.normal_vert="varying vec3 vNormal;\n\nvoid main() {\nvNormal = normal;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n\n";module$src$3d$viewport$shaders$ShaderFile.default.refl_frag="uniform vec3 color;\nuniform sampler2D tDiffuse;\nuniform sampler2D tDepth;\nuniform vec3 worldPosition;\nuniform float far;\nuniform mat4 viewMatrixInv;\nvarying vec4 vUv;\nuniform float threshold;\n\nfloat blendOverlay( float base, float blend ) {\nreturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );\n}\n\nvec3 blendOverlay( vec3 base, vec3 blend ) {\nreturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );\n}\n\nfloat decompress(float a){\nreturn a < .5 ? -a * (far * 2.0) : (a-.5) * (far * 2.0);\n}\n\nvoid main() {\nfloat depth = ((decompress(texture2DProj(tDepth, vUv).a) - worldPosition.z) / far) * (1.0/threshold);\ngl_FragColor = vec4( blendOverlay( texture2DProj( tDiffuse, vUv ).rgb, color ), 1.0 - max(0.0, min(1.0, depth)) );\n}\n\n";
module$src$3d$viewport$shaders$ShaderFile.default.refl_vert="uniform mat4 textureMatrix;\nvarying vec4 vUv;\n\nvoid main() {\n\tvUv = textureMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n\n";module$src$3d$viewport$shaders$ShaderFile.default.sao_frag="\n#include <common>\n#include <packing>\n\nvarying vec2 vUv;\n\nuniform sampler2D tDepth;\nuniform sampler2D tNormal;\n\nuniform float cameraNear;\nuniform float cameraFar;\nuniform mat4 cameraProjectionMatrix;\nuniform mat4 cameraInverseProjectionMatrix;\n\nuniform vec2 size;\nuniform float intensity;\nuniform float scale;\nuniform float kernelRadius;\n\nvec3 getViewPosition(const in vec2 screenPosition, const in float depth, const in float viewZ) {\n\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];\n\tvec4 clipPosition = vec4((vec3(screenPosition, depth) - 0.5) * 2.0, 1.0);\n\tclipPosition *= clipW; // unprojection\n\n\treturn (cameraInverseProjectionMatrix * clipPosition).xyz;\n}\n\nfloat getOcclusion(const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition) {\n\tvec3 viewDelta = sampleViewPosition - centerViewPosition;\n\tfloat viewDistance = length(viewDelta);\n\tfloat scaledScreenDistance = scale * viewDistance;\n\treturn max(0.0, (dot(centerViewNormal, viewDelta))/scaledScreenDistance)/(1.0 + pow2(scaledScreenDistance));\n}\n\nfloat getAmbientOcclusion(const in vec3 centerViewPosition) {\n\tvec3 centerViewNormal = unpackRGBToNormal(texture2D(tNormal, vUv).xyz);\n\n\tfloat angle = rand(vUv) * PI2;\n\tvec2 radius = vec2(kernelRadius * (1.0/float(SAMPLES)))/size;\n\tvec2 radiusStep = radius;\n\tfloat occlusionSum = 0.0;\n\tfloat weightSum = 0.0;\n\tfloat angleStep = PI2 * 3.0/float(SAMPLES);\n\n\tfor(int i = 0; i < SAMPLES; i ++) {\n\t\tvec2 sampleUv = vUv + vec2(cos(angle), sin(angle)) * radius;\n\t\tradius += radiusStep;\n\t\tangle += PI2 * 3.0/float(SAMPLES);\n\n\t\tfloat sampleDepth = unpackRGBAToDepth(texture2D(tDepth, sampleUv));\n\t\tif(sampleDepth >= (1.0 - EPSILON)) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tfloat sampleViewZ = perspectiveDepthToViewZ(sampleDepth, cameraNear, cameraFar);\n\t\tvec3 sampleViewPosition = getViewPosition(sampleUv, sampleDepth, sampleViewZ);\n\t\tocclusionSum += getOcclusion(centerViewPosition, centerViewNormal, sampleViewPosition);\n\t\tweightSum += 1.0;\n\t}\n\n\tif(weightSum == 0.0) discard;\n\n\treturn occlusionSum * (intensity/weightSum);\n}\n\nvoid main() {\n\tfloat centerDepth = unpackRGBAToDepth(texture2D(tDepth, vUv));\n\tif(centerDepth >= (1.0 - EPSILON)) {\n\t\tdiscard;\n\t}\n\tfloat centerViewZ = perspectiveDepthToViewZ(centerDepth, cameraNear, cameraFar);\n\tvec3 viewPosition = getViewPosition(vUv, centerDepth, centerViewZ);\n\tfloat ao = 1.0 - getAmbientOcclusion(viewPosition);\n\tgl_FragColor = vec4(ao, ao, ao, 1);\n}\n\n";
module$src$3d$viewport$shaders$ShaderFile.default.simple_blur_frag="\nuniform sampler2D tDiffuse;\nuniform sampler2D tAO;\t\t\nuniform vec2 size;\nuniform int orientation;\n\nvarying vec2 vUv;\n\nvoid main() {\n\tvec4 sum = vec4( 0.0 );\n\tvec2 or = vec2(0,0);\n\n\tif(orientation==0){\n\t\tor = vec2(1,0);\n\t}else{\n\t\tor = vec2(0,1);\n\t}\n\tvec2 off = vec2(3.2307692308) * or;\n\tsum += texture2D(tAO, vUv) * 0.29411764705882354;\n\tsum += texture2D(tAO, vUv + (off / size)) * 0.35294117647058826;\n\tsum += texture2D(tAO, vUv - (off / size)) * 0.35294117647058826;\n\t\n\tif(orientation == 1){\n\t\tgl_FragColor =  texture2D( tDiffuse, vUv );\n\t\tgl_FragColor.xyz *= sum.x;\n\t}else{\n\t\tgl_FragColor = sum;\n\t}\n}\n\n";
module$src$3d$viewport$shaders$ShaderFile.default.standard_frag="#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\nuniform float clearCoat;\nuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\nvarying vec3 vNormal;\n#endif\nvarying vec4 worldPos;\n\nuniform float shadowOpacity;\nuniform float lightReflectivity;\n\nuniform float threeDNoiseScale;\nuniform float threeDNoiseDistanceFade;\nuniform float threeDNoiseOpacity;\nfloat threeDAmbient = 1.0;\n\n#if NUM_ADD_MAPS > 0\nuniform int mapsSize;\nuniform sampler2D additionalMaps0;\n#if NUM_ADD_MAPS > 1\nuniform sampler2D additionalMaps1;\n#endif\n#if NUM_ADD_MAPS > 2\nuniform sampler2D additionalMaps2;\n#endif\n#if NUM_ADD_MAPS > 3\nuniform sampler2D additionalMaps3;\n#endif\n#if NUM_ADD_MAPS > 4\nuniform sampler2D additionalMaps4;\n#endif\nuniform int mapPropertyType[NUM_ADD_MAPS];\nuniform vec3 mapPropertyColor[NUM_ADD_MAPS];\nuniform mat3 uvTransformAddMap[NUM_ADD_MAPS];\nvarying vec2 vUvOriginal;\n#endif\n\n#ifdef USE_RGBMAP\nuniform sampler2D rgbMap;\n#endif\n\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#if defined( USE_MAP )\nvarying vec2 vUvMap;\n#endif\n#if defined( USE_BUMPMAP )\nvarying vec2 vUvBumpMap;\n#endif\n#if defined( USE_NORMALMAP )\nvarying vec2 vUvNormalMap;\n#endif\n#if defined( USE_SPECULARMAP )\nvarying vec2 vUvSpecularMap;\n#endif\n#if defined( USE_ALPHAMAP )\nvarying vec2 vUvAlphaMap;\n#endif\n#if defined( USE_EMISSIVEMAP )\nvarying vec2 vUvEmissiveMap;\n#endif\n#if defined( USE_ROUGHNESSMAP )\nvarying vec2 vUvRoughnessMap;\n#endif\n#if defined( USE_METALNESSMAP )\nvarying vec2 vUvMetalnessMap;\n#endif\n\n\n\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_pars_fragment>\n\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\nvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\nvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n#ifdef ENVMAP_TYPE_CUBE\nvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n#ifdef LOD_BLACK_LIST\nvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n#else\n#ifdef TEXTURE_LOD_EXT\nvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n#else\nvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n#endif\n#endif\nenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\nvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\nvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n#else\nvec4 envMapColor = vec4( 0.0 );\n#endif\nreturn PI * envMapColor.rgb * envMapIntensity;\n}\nfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\nfloat maxMIPLevelScalar = float( maxMIPLevel );\nfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\nreturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n}\nvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n#ifdef ENVMAP_MODE_REFLECTION\nvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n#else\nvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n#endif\nreflectVec = inverseTransformDirection( reflectVec, viewMatrix );\nfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n#ifdef ENVMAP_TYPE_CUBE\nvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n#ifdef LOD_BLACK_LIST\nvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n#else\n#ifdef TEXTURE_LOD_EXT\nvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n#else\nvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n#endif\n#endif\nenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\nvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\nvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n#elif defined( ENVMAP_TYPE_EQUIREC )\nvec2 sampleUV;\nsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\nsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n#ifdef LOD_BLACK_LIST\nvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n#else\n#ifdef TEXTURE_LOD_EXT\nvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n#else\nvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n#endif\n#endif\n\nenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n#elif defined( ENVMAP_TYPE_SPHERE )\nvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n#ifdef LOD_BLACK_LIST\nvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n#else\n#ifdef TEXTURE_LOD_EXT\nvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n#else\nvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n#endif\n#endif\nenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n#endif\nreturn envMapColor.rgb * envMapIntensity;\n}\n#endif\n\n\n\n#include <fog_pars_fragment>\n#ifdef USE_3D_NOISE\n\tvec3 random3(vec3 c) {\n\t\tfloat j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));\n\t\tvec3 r;\n\t\tr.z = fract(512.0*j);\n\t\tj *= .125;\n\t\tr.x = fract(512.0*j);\n\t\tj *= .125;\n\t\tr.y = fract(512.0*j);\n\t\treturn r-0.5;\n\t}\n\n\tconst float F3 =  0.3333333;\n\tconst float G3 =  0.1666667;\n\tfloat snoise(vec3 p) {\n\t\tvec3 s = floor(p + dot(p, vec3(F3)));\n\t\tvec3 x = p - s + dot(s, vec3(G3));\n\t\t\n\t\tvec3 e = step(vec3(0.0), x - x.yzx);\n\t\tvec3 i1 = e*(1.0 - e.zxy);\n\t\tvec3 i2 = 1.0 - e.zxy*(1.0 - e);\n\t\t\t\n\t\tvec3 x1 = x - i1 + G3;\n\t\tvec3 x2 = x - i2 + 2.0*G3;\n\t\tvec3 x3 = x - 1.0 + 3.0*G3;\n\n\t\tvec4 w = vec4(dot(x, x), dot(x1, x1), dot(x2, x2), dot(x3, x3));\t\t\n\t\tw = max(0.6 - w, 0.0);\n\t\tw = w*w*w;\n\n\t\tvec4 d = vec4(dot(random3(s), x), dot(random3(s + i1), x1), dot(random3(s + i2), x2), dot(random3(s + 1.0), x3)) * w;\n\t\treturn dot(d, vec4(52.0));\n\t}\n#endif\n\n#ifdef USE_3D_NOISE_F999\n\tvec3 noise(vec3 m) { return vec3(0); }\n#endif\n\n#ifdef USE_3D_NOISE_F0\n\tvec3 noise(vec3 m) {\n\t\tvec3 i, n;\n\t\ti = m.xzx + m.y;\n\t\tn.x = snoise(i);\n\t\ti = m.yzy + m.x;\n\t\tn.y = snoise(i);\n\t\ti = m.zxy;\n\t\tn.z = snoise(i);\n\t\treturn normalize(n);\n\t}\n#endif\n\n#ifdef USE_3D_NOISE_F1\n\tvec3 noise(vec3 m) {\n\t\tvec3 i = m;\n\t\tm.x = snoise(i);\n\t\ti = vec3(m.yzx);\n\t\tm.y = snoise(i);\n\t\tm.z = cos(m.z*5.0);\n\t\treturn normalize(m);\n\t}\n#endif\n\n#ifdef USE_3D_NOISE_F2\n\tvec3 noise(vec3 m) {\n\t\tm.x = 0.3333333* cos(m.z);\n\t\tm.y = 0.3333333* sin(m.z)+snoise(vec3(m.z));\n\t\tm.z = 0.3333333* cos(m.z*5.0);\n\t\treturn normalize(m);\n\t}\n#endif\n\n#ifdef USE_3D_NOISE_F3\n\tvec3 noise(vec3 m) {\n\t\tvec3 i = vec3( m.z);\n\t\tm.x = 0.1333333* snoise(4.0*i);\n\t\ti = vec3(m.yzx);\n\t\tm.y = 0.05333333* snoise(4.0*i);\n\t\ti = vec3(m.zxy);\n\t\tm.z = 0.1333333* snoise(4.0*i);\n\t\treturn normalize(m);\n\t}\n#endif\n\n\n\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\nuniform float lightWorldSize;\nuniform float lightFrustum;\n\n#if defined(USE_SHADOWMAP)\n#ifdef USE_PCSS_SHADOW\n#define softShadowSamples 20\n#define near 25.0\nvec2 poissonDisk[softShadowSamples];\n\nvoid initPoissonSamples(const in vec2 randomSeed) {\nfloat angleStep = PI2 * 11.0/float(softShadowSamples);\nfloat angle = rand(randomSeed) * PI2;\nfloat radius = 1.0/float(softShadowSamples);\n\nfor(int i = 0; i < softShadowSamples; i ++) {\npoissonDisk[i] = vec2(cos(angle), sin(angle)) * pow(radius, 0.75);\nradius += 1.0/float(softShadowSamples);\nangle += angleStep;\n}\n}\n\nfloat penumbraSize(const in float zReceiver, const in float zBlocker) {\nreturn (zReceiver - zBlocker)/zBlocker;\n}\n\nfloat findBlocker(sampler2D shadowMap, const in vec2 uv, const in float zReceiver) {\nfloat searchRadius = (lightWorldSize/lightFrustum) * (zReceiver - near)/zReceiver;\nfloat blockerDepthSum = 0.0;\nint numBlockers = 0;\n\nfor(int i = 0; i < softShadowSamples; i++) {\nfloat shadowMapDepth = unpackRGBAToDepth(texture2D(shadowMap, uv + poissonDisk[i] * searchRadius));\nif (shadowMapDepth < zReceiver) {\nblockerDepthSum += shadowMapDepth;\nnumBlockers ++;\n}\n}\n\nif(numBlockers == 0) return -1.0;\nreturn blockerDepthSum/float(numBlockers);\n}\n\nfloat PCF_Filter(sampler2D shadowMap, vec2 uv, float zReceiver, float filterRadius) {\nfloat sum = 0.0;\nfor(int i = 0; i < softShadowSamples; i ++) {\nfloat depth = unpackRGBAToDepth(texture2D(shadowMap, uv + poissonDisk[ i ] * filterRadius));\nif(zReceiver <= depth) sum += 1.0;\n}\nfor(int i = 0; i < softShadowSamples; i ++) {\nfloat depth = unpackRGBAToDepth(texture2D(shadowMap, uv + -poissonDisk[ i ].yx * filterRadius));\nif(zReceiver <= depth) sum += 1.0;\n}\nreturn sum/(2.0 * float(softShadowSamples));\n}\n\nfloat PCSS (sampler2D shadowMap, vec4 coords) {\nvec2 uv = coords.xy;\nfloat zReceiver = coords.z;\n\ninitPoissonSamples(uv);\nfloat avgBlockerDepth = findBlocker(shadowMap, uv, zReceiver);\n\nif(avgBlockerDepth == -1.0) return 1.0;\n\nfloat penumbraRatio = penumbraSize(zReceiver, avgBlockerDepth);\nfloat filterRadius = penumbraRatio * (lightWorldSize/lightFrustum) * near/zReceiver;\n\nreturn PCF_Filter(shadowMap, uv, zReceiver, filterRadius);\n}\n#endif\n\n#if NUM_DIR_LIGHTS > 0\nuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\nvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n#endif\n\n\nfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\nreturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n}\nfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\nconst vec2 offset = vec2( 0.0, 1.0 );\nvec2 texelSize = vec2( 1.0 ) / size;\nvec2 centroidUV = floor( uv * size + 0.5 ) / size;\nfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\nfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\nfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\nfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\nvec2 f = fract( uv * size + 0.5 );\nfloat a = mix( lb, lt, f.y );\nfloat b = mix( rb, rt, f.y );\nfloat c = mix( a, b, f.x );\nreturn c;\n}\nfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\nshadowCoord.xyz /= shadowCoord.w;\nshadowCoord.z += shadowBias;\nbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\nbool inFrustum = all( inFrustumVec );\nbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\nbool frustumTest = all( frustumTestVec );\nif ( frustumTest ) {\n#if defined(USE_PCSS_SHADOW)\nreturn PCSS(shadowMap, shadowCoord);\n#elif defined( SHADOWMAP_TYPE_PCF )\nvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\nfloat dx0 = - texelSize.x * shadowRadius;\nfloat dy0 = - texelSize.y * shadowRadius;\nfloat dx1 = + texelSize.x * shadowRadius;\nfloat dy1 = + texelSize.y * shadowRadius;\nreturn (\ntexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\ntexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\ntexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\ntexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\ntexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\ntexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\ntexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\ntexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\ntexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n) * ( 1.0 / 9.0 );\n#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\nvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\nfloat dx0 = - texelSize.x * shadowRadius;\nfloat dy0 = - texelSize.y * shadowRadius;\nfloat dx1 = + texelSize.x * shadowRadius;\nfloat dy1 = + texelSize.y * shadowRadius;\nreturn (\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\ntexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n) * ( 1.0 / 9.0 );\n#else\nreturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n#endif\n}\nreturn 1.0;\n}\nvec2 cubeToUV( vec3 v, float texelSizeY ) {\nvec3 absV = abs( v );\nfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\nabsV *= scaleToCube;\nv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\nvec2 planar = v.xy;\nfloat almostATexel = 1.5 * texelSizeY;\nfloat almostOne = 1.0 - almostATexel;\nif ( absV.z >= almostOne ) {\nif ( v.z > 0.0 )\nplanar.x = 4.0 - v.x;\n} else if ( absV.x >= almostOne ) {\nfloat signX = sign( v.x );\nplanar.x = v.z * signX + 2.0 * signX;\n} else if ( absV.y >= almostOne ) {\nfloat signY = sign( v.y );\nplanar.x = v.x + 2.0 * signY + 2.0;\nplanar.y = v.z * signY - 2.0;\n}\nreturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n}\nfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\nvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\nvec3 lightToPosition = shadowCoord.xyz;\nvec3 bd3D = normalize( lightToPosition );\nfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\nvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\nreturn (\ntexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\ntexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\ntexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\ntexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\ntexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\ntexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\ntexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\ntexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\ntexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n) * ( 1.0 / 9.0 );\n#else\nreturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n#endif\n}\n#endif\n\n\n#ifdef USE_BUMPMAP\nuniform sampler2D bumpMap;\nuniform float bumpScale;\nvec2 dHdxy_fwd() {\nvec2 dSTdx = dFdx( vUvBumpMap );\nvec2 dSTdy = dFdy( vUvBumpMap );\nfloat Hll = bumpScale * texture2D( bumpMap, vUvBumpMap ).x;\nfloat dBx = bumpScale * texture2D( bumpMap, vUvBumpMap + dSTdx ).x - Hll;\nfloat dBy = bumpScale * texture2D( bumpMap, vUvBumpMap + dSTdy ).x - Hll;\nreturn vec2( dBx, dBy );\n}\nvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\nvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\nvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\nvec3 vN = surf_norm;\nvec3 R1 = cross( vSigmaY, vN );\nvec3 R2 = cross( vN, vSigmaX );\nfloat fDet = dot( vSigmaX, R1 );\nvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\nreturn normalize( abs( fDet ) * surf_norm - vGrad );\n}\n#endif\n\n\n#ifdef USE_NORMALMAP\nuniform sampler2D normalMap;\nuniform vec2 normalScale;\nvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\nvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\nvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\nvec2 st0 = dFdx( vUvNormalMap.st );\nvec2 st1 = dFdy( vUvNormalMap.st );\nvec3 S = normalize( q0 * st1.t - q1 * st0.t );\nvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\nvec3 N = normalize( surf_norm );\nvec3 mapN = texture2D( normalMap, vUvNormalMap ).xyz * 2.0 - 1.0;\nmapN.xy = normalScale * mapN.xy;\nmat3 tsn = mat3( S, T, N );\nreturn normalize( tsn * mapN );\n}\n#endif\n\n\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n#ifdef USE_COLOR\ndiffuseColor.rgb = vColor;\n#endif\n\n\n\n#if NUM_ADD_MAPS > 0\nvec4 texelColorAdd = texture2D( additionalMaps0, (uvTransformAddMap[0] * vec3(vUvOriginal, 1.0)).xy);\ntexelColorAdd = mapTexelToLinear( texelColorAdd );\n\nif(mapPropertyType[0] == 0){\ndiffuseColor = texelColorAdd.a * vec4(texelColorAdd.rgb, 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}else if(mapPropertyType[0] == 1){\ndiffuseColor = texelColorAdd.a * vec4(mapPropertyColor[0], 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}\n#endif\n#if NUM_ADD_MAPS > 1\n\ntexelColorAdd = texture2D( additionalMaps1, (uvTransformAddMap[1] * vec3(vUvOriginal, 1.0)).xy);\ntexelColorAdd = mapTexelToLinear( texelColorAdd );\n\nif(mapPropertyType[1] == 0){\ndiffuseColor = texelColorAdd.a * vec4(texelColorAdd.rgb, 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}else if(mapPropertyType[1] == 1){\ndiffuseColor = texelColorAdd.a * vec4(mapPropertyColor[1], 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}\n\n#endif\n#if NUM_ADD_MAPS > 2\n\ntexelColorAdd = texture2D( additionalMaps2, (uvTransformAddMap[2] * vec3(vUvOriginal, 1.0)).xy);\ntexelColorAdd = mapTexelToLinear( texelColorAdd );\n\nif(mapPropertyType[2] == 0){\ndiffuseColor = texelColorAdd.a * vec4(texelColorAdd.rgb, 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}else if(mapPropertyType[2] == 1){\ndiffuseColor = texelColorAdd.a * vec4(mapPropertyColor[2], 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}\n\n#endif\n#if NUM_ADD_MAPS > 3\n\ntexelColorAdd = texture2D( additionalMaps3, (uvTransformAddMap[3] * vec3(vUvOriginal, 1.0)).xy);\ntexelColorAdd = mapTexelToLinear( texelColorAdd );\n\nif(mapPropertyType[3] == 0){\ndiffuseColor = texelColorAdd.a * vec4(texelColorAdd.rgb, 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}else if(mapPropertyType[3] == 1){\ndiffuseColor = texelColorAdd.a * vec4(mapPropertyColor[3], 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}\n\n#endif\n#if NUM_ADD_MAPS > 4\n\ntexelColorAdd = texture2D( additionalMaps4, (uvTransformAddMap[4] * vec3(vUvOriginal, 1.0)).xy);\ntexelColorAdd = mapTexelToLinear( texelColorAdd );\n\nif(mapPropertyType[4] == 0){\ndiffuseColor = texelColorAdd.a * vec4(texelColorAdd.rgb, 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}else if(mapPropertyType[4] == 1){\ndiffuseColor = texelColorAdd.a * vec4(mapPropertyColor[4], 1.0) + (1.0 - texelColorAdd.a) * diffuseColor;\n}\n\n#endif\n\n#ifdef USE_MAP\nvec4 texelColor = texture2D( map, vUvMap );\ntexelColor = mapTexelToLinear( texelColor );\n\ndiffuseColor *= texelColor;\n#endif\n\n\n#ifdef USE_ALPHAMAP\ndiffuseColor.a *= texture2D( alphaMap, vUvAlphaMap ).g;\n#endif\n\n\n\t#include <alphatest_fragment>\nfloat roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n#ifdef USE_RGBMAP\nvec4 texelRoughness = texture2D( rgbMap, vUvRoughnessMap );\n#else\nvec4 texelRoughness = texture2D( roughnessMap, vUvRoughnessMap );\n#endif\nroughnessFactor *= texelRoughness.g;\n#endif\n\n\nfloat metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n#ifdef USE_RGBMAP\nvec4 texelMetalness = texture2D( rgbMap, vUvMetalnessMap );\n#else\nvec4 texelMetalness = texture2D( metalnessMap, vUvMetalnessMap );\n#endif\nmetalnessFactor *= texelMetalness.b;\n#endif\n\n\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n#ifdef USE_3D_NOISE\nvec3 threeDNoise = noise(worldPos.xyz / threeDNoiseScale);\nfloat op = threeDNoiseOpacity * (1.0 / (1.0 + vViewPosition.z * threeDNoiseDistanceFade));\nfloat dotP = dot(normal, threeDNoise);\nif(dotP < 0.0) threeDNoise *= -1.0;\n\ndotP = abs(dotP);\n\nnormal = (1.0 - op) * normal + op * threeDNoise;\nroughnessFactor += ((1.0 - roughnessFactor) * (1.0 - dotP)) * op;\nmetalnessFactor *= (1.0 - dotP * op);\n\nthreeDAmbient = min(1.0, (1.0 - op) + dotP * op);\ndiffuseColor.rgb *= min(1.0, (1.0 - op) + dotP * op);\n#endif\n\n\n\t#include <lights_physical_fragment>\n\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\nfloat invShadowAmount;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t// #ifdef USE_SHADOWMAP\n\t        // directLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t// #endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t//#ifdef USE_SHADOWMAP\n\t\t//#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\ninvShadowAmount = all(bvec2(directionalLight.shadow, directLight.visible)) ? getShadow(directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ]) : 1.0;\ndirectLight.color *= min((invShadowAmount + (1.0 - shadowOpacity)), 1.0);\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif\n\n\n\n#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#else\nvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\nreflectVec = inverseTransformDirection( reflectVec, viewMatrix );\nradiance += (vec3((reflectVec.z + 1.0) / 2.0) + 0.5) / 1.5;\n#endif\n\n\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\n\t#ifdef USE_3D_NOISE\n\t\treflectedLight.indirectDiffuse *= threeDAmbient;\n#endif\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular * lightReflectivity + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n\n\n";
module$src$3d$viewport$shaders$ShaderFile.default.standard_vert="#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nvarying vec4 worldPos;\n#include <common>\n#if defined( USE_MAP )\nvarying vec2 vUvMap;\nuniform mat3 uvTransformMap;\n#endif\n#if defined( USE_BUMPMAP )\nvarying vec2 vUvBumpMap;\nuniform mat3 uvTransformBumpMap;\n#endif\n#if defined( USE_NORMALMAP )\nvarying vec2 vUvNormalMap;\nuniform mat3 uvTransformNormalMap;\n#endif\n#if defined( USE_SPECULARMAP )\nvarying vec2 vUvSpecularMap;\nuniform mat3 uvTransformSpecularMap;\n#endif\n#if defined( USE_ALPHAMAP )\nvarying vec2 vUvAlphaMap;\nuniform mat3 uvTransformAlphaMap;\n#endif\n#if defined( USE_EMISSIVEMAP )\nvarying vec2 vUvEmissiveMap;\nuniform mat3 uvTransformEmissiveMap;\n#endif\n#if defined( USE_ROUGHNESSMAP )\nvarying vec2 vUvRoughnessMap;\nuniform mat3 uvTransformRoughnessMap;\n#endif\n#if defined( USE_METALNESSMAP )\nvarying vec2 vUvMetalnessMap;\nuniform mat3 uvTransformMetalnessMap;\n#endif\n\n#if NUM_ADD_MAPS > 0\nvarying vec2 vUvOriginal;\nuniform int mapsSize;\n#endif\n\n\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t// #if NUM_SPOT_LIGHTS > 0\n\t// \tuniform mat4 spotShadowMatrix[ 0 ];\n\t// \tvarying vec4 vSpotShadowCoord[ 0 ];\n\t// #endif\n\t// #if NUM_POINT_LIGHTS > 0\n\t// \tuniform mat4 pointShadowMatrix[ 0 ];\n\t// \tvarying vec4 vPointShadowCoord[ 0 ];\n\t// #endif\n#endif\n\n\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n#if defined( USE_MAP )\n\tvUvMap = (uvTransformMap * vec3(uv, 1)).xy;\n#endif\n#if defined( USE_BUMPMAP )\nvUvBumpMap = (uvTransformBumpMap * vec3(uv, 1)).xy;\n#endif\n#if defined( USE_NORMALMAP )\nvUvNormalMap = (uvTransformNormalMap * vec3(uv, 1)).xy;\n#endif\n#if defined( USE_SPECULARMAP )\n\tvUvSpecularMap = (uvTransformSpecularMap * vec3(uv, 1)).xy;\n#endif\n#if defined( USE_ALPHAMAP )\n\tvUvAlphaMap = (uvTransformAlphaMap * vec3(uv, 1)).xy;\n#endif\n#if defined( USE_EMISSIVEMAP )\n\tvUvEmissiveMap = (uvTransformEmissiveMap * vec3(uv, 1)).xy;\n#endif\n#if defined( USE_ROUGHNESSMAP )\n\tvUvRoughnessMap = (uvTransformRoughnessMap * vec3(uv, 1)).xy;\n#endif\n#if defined( USE_METALNESSMAP )\n\tvUvMetalnessMap = (uvTransformMetalnessMap * vec3(uv, 1)).xy;\n#endif\n\n#if NUM_ADD_MAPS > 0\n\tvUvOriginal = uv;\n#endif\n\n\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t// #if NUM_SPOT_LIGHTS > 0\n\t// #pragma unroll_loop\n\t// for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t// \tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t// }\n\t// #endif\n\t// #if NUM_POINT_LIGHTS > 0\n\t// #pragma unroll_loop\n\t// for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t// \tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t// }\n\t// #endif\n#endif\n\n\n\tworldPos = worldPosition;\n}\n\n";
module$src$3d$viewport$shaders$ShaderFile.default.world_z_frag="varying vec4 position_VS;\nuniform float far;\n\nfloat compress(float a){\nreturn a < 0.0 ? -a / (2.0 * far) : a / (2.0 * far) + .5;\n}\n\nvoid main() {\n\tgl_FragColor = vec4(1,1,1, compress(position_VS.z));\n}\n\n";module$src$3d$viewport$shaders$ShaderFile.default.world_z_vert="varying vec4 position_VS;\n\nvoid main() {\nposition_VS = modelMatrix * vec4( position, 1.0 );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n\n";var module$src$3d$viewport$materials$Reflector={},THREE$$module$src$3d$viewport$materials$Reflector=module$src$externals$three.default,Shaders$$module$src$3d$viewport$materials$Reflector=module$src$3d$viewport$shaders$ShaderFile.default;module$src$externals$three.default=module$src$externals$three.default;
module$src$externals$three.default.Reflector=function(a,b){module$src$externals$three.default.Mesh.call(this,a);this.type="Reflector";var c=this;b=b||{};a=void 0!==b.color?new module$src$externals$three.default.Color(b.color):new module$src$externals$three.default.Color(8355711);var d=b.textureWidth||512,e=b.textureHeight||512,f=b.clipBias||0,h=void 0!==b.recursion?b.recursion:0,g=new module$src$externals$three.default.Plane,k=new module$src$externals$three.default.Vector3,l=new module$src$externals$three.default.Vector3,
m=new module$src$externals$three.default.Vector3,n=new module$src$externals$three.default.Matrix4,r=new module$src$externals$three.default.Vector3(0,0,-1),u=new module$src$externals$three.default.Vector4,p=new module$src$externals$three.default.Vector4,q=new module$src$externals$three.default.Vector3,t=new module$src$externals$three.default.Vector3,v=new module$src$externals$three.default.Vector4,w=new module$src$externals$three.default.Matrix4,x=new module$src$externals$three.default.PerspectiveCamera,
y=new module$src$externals$three.default.WebGLRenderTarget(d,e,{minFilter:module$src$externals$three.default.LinearFilter,magFilter:module$src$externals$three.default.LinearFilter,format:module$src$externals$three.default.RGBFormat,stencilBuffer:!1});module$src$externals$three.default.Math.isPowerOfTwo(d)&&module$src$externals$three.default.Math.isPowerOfTwo(e)||(y.texture.generateMipmaps=!1);b={uniforms:{color:{type:"c",value:null},tDiffuse:{type:"t",value:null},tDepth:{type:"t",value:null},textureMatrix:{type:"m4",
value:null},worldPosition:{type:"v3",value:new module$src$externals$three.default.Vector3(0,0,0)},far:{type:"f",value:1},threshold:{type:"f",value:100}},fragmentShader:module$src$3d$viewport$shaders$ShaderFile.default.refl_frag,vertexShader:module$src$3d$viewport$shaders$ShaderFile.default.refl_vert};var A=new module$src$externals$three.default.ShaderMaterial(b),z=new module$src$externals$three.default.ShaderMaterial({uniforms:{far:{type:"f",value:1}},vertexShader:module$src$3d$viewport$shaders$ShaderFile.default.world_z_vert,
fragmentShader:module$src$3d$viewport$shaders$ShaderFile.default.world_z_frag}),B=new module$src$externals$three.default.WebGLRenderTarget(d,e,{minFilter:module$src$externals$three.default.NearestFilter,magFilter:module$src$externals$three.default.NearestFilter,format:module$src$externals$three.default.RGBAFormat,type:module$src$externals$three.default.FloatType});A.uniforms.tDiffuse.value=y.texture;A.uniforms.tDepth.value=B.texture;A.uniforms.color.value=a;A.uniforms.textureMatrix.value=w;A.uniforms.worldPosition.value=
l;A.uniforms.threshold.value=c.threshold=.01;this.material=A;this.material.transparent=!0;this.onBeforeRender=function(a,b,d){if("recursion"in d.userData){if(d.userData.recursion===h)return;d.userData.recursion++}A.uniforms.threshold.value=c.threshold;z.uniforms.far.value=d.far;A.uniforms.far.value=d.far;l.setFromMatrixPosition(c.matrixWorld);m.setFromMatrixPosition(d.matrixWorld);n.extractRotation(c.matrixWorld);k.set(0,0,1);k.applyMatrix4(n);q.subVectors(l,m);if(!(0<q.dot(k))){q.reflect(k).negate();
q.add(l);n.extractRotation(d.matrixWorld);r.set(0,0,-1);r.applyMatrix4(n);r.add(m);t.subVectors(l,r);t.reflect(k).negate();t.add(l);x.position.copy(q);x.up.set(0,1,0);x.up.applyMatrix4(n);x.up.reflect(k);x.lookAt(t);x.far=d.far;x.updateMatrixWorld();x.projectionMatrix.copy(d.projectionMatrix);x.userData.recursion=0;w.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);w.multiply(x.projectionMatrix);w.multiply(x.matrixWorldInverse);w.multiply(c.matrixWorld);g.setFromNormalAndCoplanarPoint(k,l);g.applyMatrix4(x.matrixWorldInverse);
u.set(g.normal.x,g.normal.y,g.normal.z,g.constant);var e=x.projectionMatrix;v.x=(Math.sign(u.x)+e.elements[8])/e.elements[0];v.y=(Math.sign(u.y)+e.elements[9])/e.elements[5];v.z=-1;v.w=(1+e.elements[10])/e.elements[14];u.multiplyScalar(2/u.dot(v));e.elements[2]=u.x;e.elements[6]=u.y;e.elements[10]=u.z+1-f;e.elements[14]=u.w;c.visible=!1;e=b.background;b.background=null;var F=a.getRenderTarget(),D=a.vr.enabled,G=a.shadowMap.autoUpdate,H=a.getClearColor().getHex(),K=a.getClearAlpha();a.vr.enabled=!1;
a.shadowMap.autoUpdate=!1;a.render(b,x,y,!0);a.setClearColor(16777215,1);b.overrideMaterial=z;a.render(b,x,B,!0);a.vr.enabled=D;a.shadowMap.autoUpdate=G;a.setClearColor(H,K);b.overrideMaterial=null;a.setRenderTarget(F);b.background=e;b=d.bounds;void 0!==b&&(d=a.getSize(),e=a.getPixelRatio(),p.x=b.x*d.width*e,p.y=b.y*d.height*e,p.z=b.z*d.width*e,p.w=b.w*d.height*e,a.state.viewport(p));c.visible=!0}};this.getRenderTarget=function(){return y}};module$src$externals$three.default.Reflector.prototype=Object.create(module$src$externals$three.default.Mesh.prototype);
module$src$externals$three.default.Reflector.prototype.constructor=module$src$externals$three.default.Reflector;var module$src$3d$viewport$helpers$ThreeDManagerHelpers={default:function(a,b){var c=a.pathUtils,d=a.scene,e=a.geometryNode,f,h=new module$src$externals$three.default.Object3D,g=new module$src$externals$three.default.Object3D,k=[],l=[],m=[],n=[],r=[],u=!1,p=!0,q=!0;a=function(){f=this;h.visible=!1;d.add(h);g.visible=!1;d.add(g)};a.prototype._createTransformationObject=function(a,b){b.pivot=b.pivot?new module$src$externals$three.default.Vector3(b.pivot.x,b.pivot.y,b.pivot.z):null;if("rotation"===b.type){var d=
{degree:0},f=(new module$src$externals$three.default.Vector3(b.rotationAxis.x,b.rotationAxis.y,b.rotationAxis.z)).normalize();var g=(new module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween(d,a)).to({degree:b.rotationDegree*Math.PI/180},b.duration);if(b.parent&&b.pivot)g.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4,h=new module$src$externals$three.default.Matrix4,l=new module$src$externals$three.default.Matrix4,p=c.getPathObject(e,b.parent);p&&(p.updateMatrix(!0),
p.updateMatrixWorld(!0),h=p.matrixWorld);l.makeTranslation(b.pivot.x,b.pivot.y,b.pivot.z);a.multiply(l);a.multiply((new module$src$externals$three.default.Matrix4).makeRotationAxis(f,d.degree));a.multiply((new module$src$externals$three.default.Matrix4).getInverse(l));g.transformationMatrix=h.multiply(a)});else if(b.parent)g.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4,h=new module$src$externals$three.default.Matrix4,l=c.getPathObject(e,b.parent);l&&(l.updateMatrix(!0),
l.updateMatrixWorld(!0),h=l.matrixWorld);a.multiply((new module$src$externals$three.default.Matrix4).makeRotationAxis(f,d.degree));g.transformationMatrix=h.multiply(a)});else if(b.pivot)g.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4,c=new module$src$externals$three.default.Matrix4;c.makeTranslation(b.pivot.x,b.pivot.y,b.pivot.z);a.multiply(c);a.multiply((new module$src$externals$three.default.Matrix4).makeRotationAxis(f,d.degree));a.multiply((new module$src$externals$three.default.Matrix4).getInverse(c));
g.transformationMatrix=a});else g.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4;a.multiply((new module$src$externals$three.default.Matrix4).makeRotationAxis(f,d.degree));g.transformationMatrix=a})}else if("translation"===b.type){var h={x:0,y:0,z:0};g=(new module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween(h,a)).to({x:b.translationVector.x,y:b.translationVector.y,z:b.translationVector.z},b.duration);if(b.parent)g.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4,
d=new module$src$externals$three.default.Matrix4,f=c.getPathObject(e,b.parent);f&&(f.updateMatrix(!0),f.updateMatrixWorld(!0),d=f.matrixWorld);a.makeTranslation(h.x,h.y,h.z);g.transformationMatrix=d.multiply(a)});else g.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4;a.makeTranslation(h.x,h.y,h.z);g.transformationMatrix=a})}else if("scaling"===b.type){var l={x:1,y:1,z:1};g=(new module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween(l,a)).to({x:b.scalingVector.x,y:b.scalingVector.y,
z:b.scalingVector.z},b.duration);if(b.parent&&b.pivot)g.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4,d=new module$src$externals$three.default.Matrix4,f=new module$src$externals$three.default.Matrix4,h=c.getPathObject(e,b.parent);h&&(h.updateMatrix(!0),h.updateMatrixWorld(!0),d=h.matrixWorld);f.makeTranslation(b.pivot.x,b.pivot.y,b.pivot.z);a.multiply(f);a.multiply((new module$src$externals$three.default.Matrix4).makeScale(l.x,l.y,l.z));a.multiply((new module$src$externals$three.default.Matrix4).getInverse(f));
g.transformationMatrix=d.multiply(a)});else if(b.parent)g.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4,d=new module$src$externals$three.default.Matrix4,f=c.getPathObject(e,b.parent);f&&(f.updateMatrix(!0),f.updateMatrixWorld(!0),d=f.matrixWorld);a.multiply((new module$src$externals$three.default.Matrix4).makeScale(l.x,l.y,l.z));g.transformationMatrix=d.multiply(a)});else if(b.pivot)g.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4,c=new module$src$externals$three.default.Matrix4;
c.makeTranslation(b.pivot.x,b.pivot.y,b.pivot.z);a.multiply(c);a.multiply((new module$src$externals$three.default.Matrix4).makeScale(l.x,l.y,l.z));a.multiply((new module$src$externals$three.default.Matrix4).getInverse(c));g.transformationMatrix=a});else g.onUpdate(function(){var a=new module$src$externals$three.default.Matrix4;a.multiply((new module$src$externals$three.default.Matrix4).makeScale(l.x,l.y,l.z));g.transformationMatrix=a})}g.transformationMatrix=new module$src$externals$three.default.Matrix4;
g.hasParent=!1;b.parent&&(g.hasParent=!0);g.gloablDuration=b.delay+b.duration;b.repeat&&(g.gloablDuration+=g.gloablDuration*b.repeat);b.repeat&&g.repeat(b.repeat);b.repeat&&b.yoyo&&g.yoyo(!0);g.onComplete(function(){g.stop()});g.delay(b.delay);g.easing(b.easing);return g};a.prototype.dispatchEvent=function(a){for(var c=new CustomEvent(a.type),d=$jscomp.makeIterator(a),e=d.next();!e.done;e=d.next())e=e.value,c[e]=a[e];b.renderingHandler.getDomElement().dispatchEvent(c);return c};a.prototype.initialize=
function(){u=!0};a.prototype.isInitialized=function(){return u};a.prototype.addMesh=function(a,b,c){l.push(a);m.push(b);k.push({mesh:a,material:b,properties:c})};a.prototype.removeMesh=function(a){for(var b={},c=0,d=k.length;c<d;b={mat:b.mat},c++)if(a===k[c].mesh){b.mat=m[c];l.splice(c,1);m.splice(c,1);k.splice(c,1);b.mat&&("alphaMap aoMap bumpMap displacementMap emissiveMap lightMap map metalnessMap normalMap roughnessMap rgbMap additionalMaps0 additionalMaps1 additionalMaps2 additionalMaps3 additionalMaps4 reflectionNormalMap dispersionMap reflectionMap".split(" ").forEach(function(a){return function(b){a.mat[b]&&
a.mat[b].dispose&&a.mat[b].dispose()}}(b)),b.mat.dispose());break}};a.prototype.addAnchor=function(a,c){var e={object:a,properties:Object.assign({lastPos:new module$src$externals$three.default.Vector2},c)};n.push(e);var g={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_ANCHOR_ADD,viewportRuntimeId:b.threeDManager.runtimeId,anchors:[]},h=b.renderingHandler.getSize().width,l=b.renderingHandler.getSize().height,p=b.cameraHandler.camera,m=b.renderingHandler.getCanvas().getBoundingClientRect(),
k=!1,q=new module$src$externals$three.default.Vector3,t=new module$src$externals$three.default.Vector3,r=new module$src$externals$three.default.Raycaster;a.updateMatrixWorld(!0);q.setFromMatrixPosition(a.matrixWorld);t.set(q.x,q.y,q.z);t.project(p);t.x=h/2*t.x+h/2;t.y=-(l/2*t.y)+l/2;t.x=0>t.x?Math.ceil(t.x):Math.floor(t.x);t.y=0>t.y?Math.ceil(t.y):Math.floor(t.y);if(1>=t.x||t.x>=h-1||1>=t.y||t.y>=l-1)k=!0;t.xPixel=t.x/devicePixelRatio;t.yPixel=t.y/devicePixelRatio;r.ray.direction.copy(q);r.ray.origin.set(0,
0,0);p.localToWorld(r.ray.origin);r.ray.direction.sub(r.ray.origin);var u=r.ray.direction.length();r.ray.direction.normalize();var v=Number.MAX_VALUE;d.traverseVisible(function(a){a instanceof module$src$externals$three.default.Mesh&&(a=r.intersectObject(a),a.length&&a[0].distance<v&&(v=a[0].distance))});p.getWorldDirection(q);p=r.ray.direction.dot(q);g.anchors.push(Object.assign({location:{x:a.position.x,y:a.position.y,z:a.position.z},containerX:t.xPixel,containerY:t.yPixel,containerWidth:h/devicePixelRatio,
containerHeight:l/devicePixelRatio,clientX:t.xPixel+m.left,clientY:t.yPixel+m.top,pageX:t.xPixel+m.left+window.pageXOffset,pageY:t.yPixel+m.top+window.pageYOffset,viewport:b.threeDManager.runtimeId,hidden:v<u,overflow:k,distance:u,viewingAngle:p,scenePath:c.path,format:c.format,data:c.data},{updateFunction:function(a){return e.properties.update=a}}));a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_ANCHORDATA,g);
b.threeDManager.message(g.type,a);f.dispatchEvent(g)};a.prototype.removeAnchor=function(a){var c,e={},g=0;for(c=n.length;g<c;e={raycaster:e.raycaster,closestIntersectionDistance:e.closestIntersectionDistance},g++)if(a===n[g].object){c=n[g];var h=c.properties;c={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_ANCHOR_REMOVE,viewportRuntimeId:b.threeDManager.runtimeId,anchors:[]};var l=b.renderingHandler.getSize().width,p=b.renderingHandler.getSize().height,m=b.cameraHandler.camera,
k=b.renderingHandler.getCanvas().getBoundingClientRect(),q=!1,t=new module$src$externals$three.default.Vector3,r=new module$src$externals$three.default.Vector3;e.raycaster=new module$src$externals$three.default.Raycaster;a.updateMatrixWorld(!0);t.setFromMatrixPosition(a.matrixWorld);r.set(t.x,t.y,t.z);r.project(m);r.x=l/2*r.x+l/2;r.y=-(p/2*r.y)+p/2;r.x=0>r.x?Math.ceil(r.x):Math.floor(r.x);r.y=0>r.y?Math.ceil(r.y):Math.floor(r.y);if(1>=r.x||r.x>=l-1||1>=r.y||r.y>=p-1)q=!0;r.xPixel=r.x/devicePixelRatio;
r.yPixel=r.y/devicePixelRatio;e.raycaster.ray.direction.copy(t);e.raycaster.ray.origin.set(0,0,0);m.localToWorld(e.raycaster.ray.origin);e.raycaster.ray.direction.sub(e.raycaster.ray.origin);var u=e.raycaster.ray.direction.length();e.raycaster.ray.direction.normalize();e.closestIntersectionDistance=Number.MAX_VALUE;d.traverseVisible(function(a){return function(b){b instanceof module$src$externals$three.default.Mesh&&(b=a.raycaster.intersectObject(b),b.length&&b[0].distance<a.closestIntersectionDistance&&
(a.closestIntersectionDistance=b[0].distance))}}(e));m.getWorldDirection(t);m=e.raycaster.ray.direction.dot(t);c.anchors.push({location:{x:a.position.x,y:a.position.y,z:a.position.z},containerX:r.xPixel,containerY:r.yPixel,containerWidth:l/devicePixelRatio,containerHeight:p/devicePixelRatio,clientX:r.xPixel+k.left,clientY:r.yPixel+k.top,pageX:r.xPixel+k.left+window.pageXOffset,pageY:r.yPixel+k.top+window.pageYOffset,viewport:b.threeDManager.runtimeId,hidden:e.closestIntersectionDistance<u,overflow:q,
distance:u,viewingAngle:m,scenePath:h.path,format:h.format,data:h.data});a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_ANCHORDATA,c);b.threeDManager.message(c.type,a);f.dispatchEvent(c);n.splice(g,1);break}};a.prototype.getMeshes=function(){return l};a.prototype.getMaterials=function(){return m};a.prototype.getMeshMaterialObjects=function(){return k};a.prototype.getAnchors=function(){return n};a.prototype.toggleMeshes=
function(a){for(var b=0,c=k.length;b<c;b++)a&&(k[b].mesh.material=k[b].material)};a.prototype.togglePointSize=function(a){e.traverse(function(c){c.hasOwnProperty("material")&&c instanceof module$src$externals$three.default.Points&&(c.material.size=a?b.threeDManager.getSetting("render.pointSize"):1)})};a.prototype.toggleGeometry=function(a,c){for(var d=0;d<a.length;d++)if(module$src$shared$util$GlobalUtils.default.typeCheck(a[d],"string")){var e=r.indexOf(a[d]);-1<e&&r.splice(e,1)}for(a=0;a<c.length;a++)module$src$shared$util$GlobalUtils.default.typeCheck(c[a],
"string")&&(r.includes(c[a])||r.push(c[a]));b.renderingHandler.updateShadowMap()};a.prototype.toggleHiddenGeometry=function(a){for(var b=0;b<r.length;b++){var d=c.getPathObject(e,r[b]);d&&(d.visible=!a,d.hiddenObject=a)}};a.prototype.addSceneObject=function(a){h.add(a)};a.prototype.removeSceneObject=function(a){h.remove(a)};a.prototype.setLiveTransformation=function(a,d,g,h,l){var p={};p.reset=h;p.duration=l;h=[];l=0;for(var m=d.length;l<m;l++){var k=c.getPathObject(e,d[l]);k&&h.push(k)}p.sceneObjects=
h;p.sceneObjectPaths=d;var q=[];p.maxDuration=0;p.hasParent=!1;d=0;for(h=g.length;d<h;d++)l=f._createTransformationObject(a,g[d]),p.maxDuration=Math.max(p.maxDuration,l.gloablDuration),p.hasParent=p.hasParent||l.hasParent,q.push(l);p.maxDuration===p.duration&&(p.duration=Infinity);p.tweens=q;p.start=function(){for(var a=0,b=q.length;a<b;a++)q[a].start()};p.prev=new module$src$externals$three.default.Matrix4;p.promise=new Promise(function(a,c){p.stopTransformation=function(){b.renderingHandler.unregisterForContinuousRendering("liveTransformationEvent");
!1===b.renderingHandler.containsContinuousRendering("liveTransformationEvent")&&(b.renderingHandler.stopUpdatingShadowMap(),b.renderingHandler.updateShadowMap());p.stopped=!0;a(!0)}});p.stopCalled=!1;p.stopAndReset=!1;p.stop=function(a){p.stopCalled=!0;p.stopAndReset=a};b.renderingHandler.keepUpdatingShadowMap();b.renderingHandler.registerForContinuousRendering("liveTransformationEvent");b.threeDManager.transformationGroups.push(p);return p};a.prototype.toggleSceneObjects=function(a){p=a;a||(h.visible=
a)};a.prototype.addViewportObject=function(a){g.add(a)};a.prototype.removeViewportObject=function(a){g.remove(a)};a.prototype.toggleViewportObjects=function(a){q=a;a||(g.visible=a)};a.prototype.toggleSceneBackground=function(a){b.materialHandler.getSceneBackground&&(d.background=a?b.materialHandler.getSceneBackground():null)};a.prototype.toggleViewportMatrix=function(a){e.applyMatrix(a?b.threeDManager.transformationMatrix:(new module$src$externals$three.default.Matrix4).getInverse(b.threeDManager.transformationMatrix,
!0));g.applyMatrix(a?b.threeDManager.transformationMatrix:(new module$src$externals$three.default.Matrix4).getInverse(b.threeDManager.transformationMatrix,!0))};a.prototype.toggleLiveTransformations=function(a,d){var f=[];if(a)for(var g=0;g<b.threeDManager.transformationGroups.length;g++){var h=b.threeDManager.transformationGroups[g];if(!h.stopped){h.initTime||(h.initTime=d);var l=h.tweens,p=h.sceneObjects,m=new module$src$externals$three.default.Matrix4,k=!1,q=0;for(a=l.length;q<a;q++){var n=l[q];
n.update(d);m.multiply(n.transformationMatrix);n.isPlaying()&&(k=!0)}h.active=!h.stopCalled&&k&&!(d>h.duration+h.initTime);l=0;for(a=p.length;l<a;l++)p[l]&&(p[l].parent||(k=c.getPathObject(e,h.sceneObjectPaths[l]),p[l]=k),p[l].applyMatrix(m),f.includes(p[l])||f.push(p[l]));h.prev.getInverse(m)}}else for(g=0;g<b.threeDManager.transformationGroups.length;g++)if(h=b.threeDManager.transformationGroups[g],!h.stopped){p=h.sceneObjects;a=!1;if(!1===h.active)for(m=0;m<b.threeDManager.transformationGroups.length;m++)b.threeDManager.transformationGroups[m].maxDuration===
h.maxDuration&&b.threeDManager.transformationGroups[m].initTime===h.initTime&&m<g&&!0!==b.threeDManager.transformationGroups[m].stopped&&(a=!0);if(!1===h.active&&!1===a){if(d>h.duration+h.initTime||h.stopCalled)for(m=h.tweens,l=0,a=m.length;l<a;l++)m[l].stop();m=0;for(a=p.length;m<a;m++)if(p[m]){l=new module$src$externals$three.default.Matrix4;if(!0===h.reset&&!0!==h.stopCalled||!0===h.stopAndReset)p[m].applyMatrix(h.prev);else{p[m].updateMatrix(!0);p[m].updateMatrixWorld(!0);k=!0;for(q=0;16>q;q++)l.elements[q]-
.001<p[m].matrix.elements[q]&&p[m].matrix.elements[q]<l.elements[q]+.001||(k=!1);k&&(p[m].matrix.identity(),p[m].matrixWorld.identity(),p[m].updateMatrix(!0),p[m].updateMatrixWorld(!0))}f.includes(p[m])||f.push(p[m])}h.stopTransformation()}else for(m=0,a=p.length;m<a;m++)p[m]&&(p[m].applyMatrix(h.prev),f.includes(p[m])||f.push(p[m]))}return f};a.prototype.toggleViewport=function(a,b){q&&(g.visible=a);p&&(h.visible=a);this.toggleHiddenGeometry(a);this.toggleMeshes(a);this.togglePointSize(a);this.toggleSceneBackground(a);
this.toggleViewportMatrix(a);b&&this.toggleLiveTransformations(a,b)};a.prototype.destroyViewport=function(){l.length=0;m.length=0;k.length=0;n.length=0;d.remove(h);d.remove(g)};return new a}};var module$src$3d$interfaces$handlers$RenderingHandlerInterface={default:function(){}};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.render=function(a){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.renderHidden=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.onResize=function(a,b){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.getSize=function(){};
module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.start=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.pause=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.resume=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.destroy=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.getScreenshot=function(){};
module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.getDomElement=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.getCanvas=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.getRendererInfo=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.setBlur=function(a,b){};
module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.registerForContinuousRendering=function(a,b){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.unregisterForContinuousRendering=function(a){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.containsContinuousRendering=function(a){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.updateShadowMap=function(){};
module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.keepUpdatingShadowMap=function(){};module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.prototype.stopUpdatingShadowMap=function(){};var module$src$3d$viewport$helpers$handlers$RenderingHandlerHelpers={default:function(a){var b,c,d,e,f,h,g,k,l=function(){b=this;h=new module$src$externals$three.default.Vector3;g=new module$src$externals$three.default.Vector3;k=new module$src$externals$three.default.Raycaster};l.prototype.createWebGLRenderer=function(a,g){var h={success:!0,message:"",messageLevel:module$src$shared$constants$LoggingConstants.default.loggingLevels.INFO};f=Object.assign({},g);d=a;try{var l=f.canvas;l||(l=document.createElementNS("http://www.w3.org/1999/xhtml",
"canvas"),l.id=("string"===typeof d.id&&0<d.id.length?d.id:"sdv-container-viewport")+"-canvas",d.appendChild(l),f.canvas=l);h.containerId=d.id;l.addEventListener("webglcontextlost",b.onContextLost,!1);l.addEventListener("webglcontextrestored",b.onContextRestore,!1);var p={alpha:f.alpha,depth:f.depth,stencil:f.stencil,antialias:f.antialias,premultipliedAlpha:f.premultipliedAlpha,preserveDrawingBuffer:f.preserveDrawingBuffer,powerPreference:f.powerPreference};c=l.getContext("webgl",p)||l.getContext("experimental-webgl",
p);if(null===c)if(c=l.getContext("webgl")||l.getContext("experimental-webgl"),null!==c)h.message="We were unable to get a WebGL context using the requested attributes, falling back to default attributes.",h.messageLevel=module$src$shared$constants$LoggingConstants.default.loggingLevels.WARN;else throw Error("We were unable to get a WebGL context.");void 0===c.getShaderPrecisionFormat&&(c.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}});f.context=c;e=new module$src$externals$three.default.WebGLRenderer(f);
h.renderer=e}catch(q){f.canvas&&((a=f.canvas.parentNode)&&a.removeChild(f.canvas),delete f.canvas),h.success=!1,h.message=q.message,h.messageLevel=module$src$shared$constants$LoggingConstants.default.loggingLevels.ERROR}return h};l.prototype.getWebGLContext=function(){return c};l.prototype.handleCreateWebGLRendererResponse=function(b,c,d,e){if(d=!0===c.success?d:e)c.messageScope=d;!1===c.success&&(e=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE,
c),a.threeDManager.message(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_FAILED,e));a.threeDManager.log(c.messageLevel,b,d,c.message);a.threeDManager.log(c.messageLevel|module$src$shared$constants$LoggingConstants.default.loggingLevels.LOG_TO_SERVER,b,{success:c.success,message:c.message,messageLevel:c.messageLevel,messageScope:c.messageScope,webglreport:c.webglreport});return!0===c.success};l.prototype.onContextLost=function(c){c.preventDefault();c.stopImmediatePropagation();
a.threeDManager&&(f.canvas&&(f.canvas.removeEventListener("webglcontextlost",b.onContextLost,!1),f.canvas.removeEventListener("webglcontextrestored",b.onContextRestore,!1),(c=f.canvas.parentNode)&&c.removeChild(f.canvas),delete f.canvas),c=b.createWebGLRenderer(d,f),b.handleCreateWebGLRendererResponse("onContextLost",c,"WebGL context was lost and could be restored","WebGL context was lost and could not be restored"),!1!==c.success&&a.threeDManager.reload())};l.prototype.onContextRestore=function(a){a.preventDefault();
a.stopImmediatePropagation()};l.prototype.processAnchors=function(b,c,d,e){var f,l=window.devicePixelRatio;if(0<e.length){var m=b.context.canvas;var n=m.width;var r=m.height}var u={};b=0;for(f=e.length;b<f;u={closestIntersectionDistance:u.closestIntersectionDistance},b++){var y=e[b];var A=y.object;y=y.properties;if(y.update){A.updateMatrixWorld(!0);h.setFromMatrixPosition(A.matrixWorld);g.set(h.x,h.y,h.z);g.project(d);g.x=n/2*g.x+n/2;g.y=-(r/2*g.y)+r/2;g.x=0>g.x?Math.ceil(g.x):Math.floor(g.x);g.y=
0>g.y?Math.ceil(g.y):Math.floor(g.y);var z=m.getBoundingClientRect(),B=!1;if(1>=g.x||g.x>=n-1||1>=g.y||g.y>=r-1)B=!0;g.xPixel=g.x/l;g.yPixel=g.y/l;k.ray.direction.copy(h);k.ray.origin.set(0,0,0);d.localToWorld(k.ray.origin);k.ray.direction.sub(k.ray.origin);var D=k.ray.direction.length();k.ray.direction.normalize();u.closestIntersectionDistance=Number.MAX_VALUE;c.traverseVisible(function(a){return function(b){b instanceof module$src$externals$three.default.Mesh&&(b=k.intersectObject(b),b.length&&
b[0].distance<a.closestIntersectionDistance&&(a.closestIntersectionDistance=b[0].distance))}}(u));d.getWorldDirection(h);var G=k.ray.direction.dot(h);A={location:{x:A.position.x,y:A.position.y,z:A.position.z},containerX:g.xPixel,containerY:g.yPixel,containerWidth:n/l,containerHeight:r/l,clientX:g.xPixel+z.left,clientY:g.yPixel+z.top,pageX:g.xPixel+z.left+window.pageXOffset,pageY:g.yPixel+z.top+window.pageYOffset,viewport:a.threeDManager.runtimeId,hidden:u.closestIntersectionDistance<D,overflow:B,
distance:D,viewingAngle:G,scenePath:y.path,format:y.format,data:y.data};y.lastPos.x=g.x;y.lastPos.y=g.y;y.update(A)}}};return new l}};var module$src$3d$viewport$passes$SSAAPass={},THREE$$module$src$3d$viewport$passes$SSAAPass=module$src$externals$three.default,Shaders$$module$src$3d$viewport$passes$SSAAPass=module$src$3d$viewport$shaders$ShaderFile.default;
module$src$3d$viewport$passes$SSAAPass.default=function(a){var b=new module$src$externals$three.default.ShaderMaterial({uniforms:{tDiffuse:{value:null},opacity:{value:1}},attributes:["position","uv"],vertexShader:module$src$3d$viewport$shaders$ShaderFile.default.basic_vert,fragmentShader:module$src$3d$viewport$shaders$ShaderFile.default.copy_frag});b.premultipliedAlpha=!0;b.transparent=!0;b.blending=module$src$externals$three.default.AdditiveBlending;b.depthTest=!1;b.depthWrite=!1;var c=new module$src$externals$three.default.OrthographicCamera(-1,
1,1,-1,0,1),d=new module$src$externals$three.default.Scene,e=new module$src$externals$three.default.Mesh(new module$src$externals$three.default.PlaneGeometry(2,2),b);e.frustumCulled=!1;d.add(e);var f=new module$src$externals$three.default.WebGLRenderTarget(a.width,a.height,{minFilter:module$src$externals$three.default.LinearFilter,magFilter:module$src$externals$three.default.LinearFilter,format:module$src$externals$three.default.RGBAFormat});f.texture.name="SSAAPass.sample";var h=[[[0,0]],[[4,4],
[-4,-4]],[[-2,-6],[6,-2],[-6,2],[2,6]],[[1,-3],[-1,3],[5,1],[-3,-5],[-5,5],[-7,-1],[3,7],[7,-7]],[[1,1],[-1,-3],[-3,2],[4,-1],[-5,-2],[2,5],[5,3],[3,-5],[-2,6],[0,-7],[-4,-6],[-6,4],[-8,0],[7,-4],[6,7],[-7,-8]],[[-4,-7],[-7,-5],[-3,-5],[-5,-4],[-1,-4],[-2,-2],[-6,-1],[-4,0],[-7,1],[-1,2],[-6,3],[-3,3],[-7,6],[-3,6],[-5,7],[-1,7],[5,-7],[1,-6],[6,-5],[4,-4],[2,-3],[7,-2],[1,-1],[4,-1],[2,1],[6,2],[0,4],[4,4],[2,5],[7,5],[5,6],[3,7]]];this.render=function(a,k,l,m,n){e=new module$src$externals$three.default.Mesh(new module$src$externals$three.default.PlaneGeometry(2,
2),b);e.frustumCulled=!1;d.children.length=0;d.add(e);var g=h[Math.max(0,Math.min(n,5))];n=a.autoClear;a.autoClear=!1;var u=a.getClearColor().getHex(),p=a.getClearAlpha(),q=1/g.length;b.uniforms.tDiffuse.value=f.texture;g.forEach(function(e,h){var n=q;l.setViewOffset&&l.setViewOffset(m.width,m.height,.0625*e[0],.0625*e[1],m.width,m.height);n+=.03125*(-.5+(h+.5)/g.length);b.uniforms.opacity.value=n;a.setClearColor(u,p);a.render(k,l,f,!0);0===h&&a.setClearColor(0,0);a.render(d,c,m,0===h)});d.remove(e);
e.geometry.dispose();e=void 0;l.clearViewOffset&&l.clearViewOffset();a.autoClear=n;a.setClearColor(u,p)};this.dispose=function(){f&&(f.dispose(),f=null)};this.setSize=function(a,b){f.setSize(a,b)}};var module$src$3d$viewport$passes$SaoPass={},THREE$$module$src$3d$viewport$passes$SaoPass=module$src$externals$three.default,Shaders$$module$src$3d$viewport$passes$SaoPass=module$src$3d$viewport$shaders$ShaderFile.default;
module$src$3d$viewport$passes$SaoPass.default=function(a){function b(a,b){for(var c=[],d=0;d<=b;d++)c.push(Math.exp(-(d*d)/(2*a*a))/(Math.sqrt(2*Math.PI)*a));return c}function c(a){n.uniforms.cameraNear.value=a.near;n.uniforms.cameraFar.value=a.far;n.uniforms.cameraProjectionMatrix.value=a.projectionMatrix;n.uniforms.cameraInverseProjectionMatrix.value.getInverse(a.projectionMatrix,!0);p.uniforms.cameraNear.value=a.near;p.uniforms.cameraFar.value=a.far;q.uniforms.cameraNear.value=a.near;q.uniforms.cameraFar.value=
a.far}var d=a.settings,e=new module$src$externals$three.default.MeshDepthMaterial;e.depthPacking=module$src$externals$three.default.RGBADepthPacking;e.blending=module$src$externals$three.default.NoBlending;e.side=module$src$externals$three.default.DoubleSide;var f=new module$src$externals$three.default.MeshNormalMaterial;f.blending=module$src$externals$three.default.NoBlending;f.side=module$src$externals$three.default.DoubleSide;var h=new module$src$externals$three.default.WebGLRenderTarget(a.width,
a.height,{minFilter:module$src$externals$three.default.NearestFilter,magFilter:module$src$externals$three.default.NearestFilter,format:module$src$externals$three.default.RGBAFormat}),g=h.clone(),k=h.clone(),l=h.clone(),m={defines:{SAMPLES:d.getSetting("samples")},uniforms:{tDepth:{type:"t",value:null},tNormal:{type:"t",value:null},cameraNear:{type:"f",value:1},cameraFar:{type:"f",value:100},cameraProjectionMatrix:{type:"m4",value:new module$src$externals$three.default.Matrix4},cameraInverseProjectionMatrix:{type:"m4",
value:new module$src$externals$three.default.Matrix4},scale:{type:"f",value:.1},kernelRadius:{type:"f",value:d.getSetting("kernelRadius")},size:{type:"v2",value:new module$src$externals$three.default.Vector2(a.width,a.height)},intensity:{type:"f",value:d.getSetting("intensity")}},attributes:["position","uv"],vertexShader:module$src$3d$viewport$shaders$ShaderFile.default.basic_vert,fragmentShader:module$src$3d$viewport$shaders$ShaderFile.default.sao_frag},n=new module$src$externals$three.default.ShaderMaterial(m);
n.uniforms.tDepth.value=g.texture;n.uniforms.tNormal.value=k.texture;n.needsUpdate=!1;m={KERNEL_RADIUS:d.getSetting("kernelRadius")};a={tAO:{type:"t",value:null},tDiffuse:{type:"t",value:null},tDepth:{type:"t",value:null},size:{type:"v2",value:new module$src$externals$three.default.Vector2(a.width,a.height)},sampleWeights:{type:"1fv",value:b(d.getSetting("standardDev"),d.getSetting("kernelRadius"))},orientation:{type:"i",value:0},cameraNear:{type:"f",value:10},cameraFar:{type:"f",value:1E3}};var r=
module$src$3d$viewport$shaders$ShaderFile.default.basic_vert,u=module$src$3d$viewport$shaders$ShaderFile.default.blur_frag,p=new module$src$externals$three.default.ShaderMaterial({uniforms:module$src$externals$three.default.UniformsUtils.clone(a),defines:m,vertexShader:r,fragmentShader:u});p.uniforms.tAO.value=h.texture;p.uniforms.tDepth.value=g.texture;p.uniforms.orientation.value=0;var q=new module$src$externals$three.default.ShaderMaterial({uniforms:module$src$externals$three.default.UniformsUtils.clone(a),
defines:m,vertexShader:r,fragmentShader:u});q.uniforms.tAO.value=l.texture;q.uniforms.tDepth.value=g.texture;q.uniforms.orientation.value=1;var t=new module$src$externals$three.default.OrthographicCamera(-1,1,1,-1,0,1),v=new module$src$externals$three.default.Scene,w=new module$src$externals$three.default.Mesh(new module$src$externals$three.default.PlaneGeometry(2,2),null);v.add(w);this.render=function(a,b,d,m,r){c(d);b.traverse(function(a){a.material&&!a.material.renderAO&&(a.wasItVisible=a.visible,
a.visible=!1)});q.uniforms.tDiffuse.value=m.texture;m=b.background;b.background=null;var u=a.getClearColor().getHex(),z=a.getClearAlpha();a.setClearColor(16777215);b.overrideMaterial=e;a.render(b,d,g,!0);a.setClearColor(7829503);b.overrideMaterial=f;a.render(b,d,k,!0);a.setClearColor(u,z);w.material=n;a.render(v,t,h,!0);w.material=p;a.render(v,t,l,!0);w.material=q;a.render(v,t,r,!0);b.overrideMaterial=null;b.background=m;b.traverse(function(a){a.material&&!a.material.renderAO&&(a.visible=a.wasItVisible)})};
d.registerHook("samples",function(a){n.defines.samples=a;n.needsUpdate=!0});d.registerHook("intensity",function(a){n.uniforms.intensity.value=a});d.registerHook("kernelRadius",function(a){p.defines.KERNEL_RADIUS=a;q.defines.KERNEL_RADIUS=a;p.uniforms.sampleWeights.value=b(d.getSetting("standardDev"),a);q.uniforms.sampleWeights.value=b(d.getSetting("standardDev"),a);p.needsUpdate=!0;q.needsUpdate=!0});d.registerHook("standardDev",function(a){p.uniforms.sampleWeights.value=b(a,d.getSetting("kernelRadius"));
q.uniforms.sampleWeights.value=b(a,d.getSetting("kernelRadius"))});this.setSize=function(a,b){n.uniforms.size.value.set(a,b);p.uniforms.size.value.set(a,b);q.uniforms.size.value.set(a,b);h.setSize(a,b);g.setSize(a,b);k.setSize(a,b);l.setSize(a,b)}};var module$src$3d$viewport$handlers$BeautyRenderHandler={default:function(a,b){var c=a.settings,d=a.scene,e=a.renderer,f,h=e.getPixelRatio(),g=e.getSize().width*h,k=e.getSize().height*h,l=!1,m=!1,n,r,u,p,q,t,v,w,x,y=0,A,z,B;h=function(){f=this;/(android)/i.test(navigator.userAgent)&&-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&(l=!0);m=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;n=new module$src$3d$viewport$passes$SSAAPass.default({width:g,height:k});r=new module$src$3d$viewport$passes$SaoPass.default({settings:c.getSection("sao"),
width:g,height:k});u=new module$src$externals$three.default.WebGLRenderTarget(g,k,{minFilter:module$src$externals$three.default.LinearFilter,magFilter:module$src$externals$three.default.LinearFilter,format:module$src$externals$three.default.RGBAFormat,stencilBuffer:!1});u.texture.name="hidden.rt";p=u.clone();p.texture.name="standard.rt";q=u.clone();q.texture.name="ssaa.rt";t=u.clone();t.texture.name="ao.rt";v=new module$src$externals$three.default.ShaderMaterial({uniforms:{tStandard:{value:null},
tBeauty:{value:null},size:{type:"v2",value:new module$src$externals$three.default.Vector2(512,512)},amount:{type:"f",value:0}},attributes:["position","uv"],vertexShader:module$src$3d$viewport$shaders$ShaderFile.default.basic_vert,fragmentShader:module$src$3d$viewport$shaders$ShaderFile.default.blend_frag});v.uniforms.tStandard.value=p.texture;v.uniforms.tBeauty.value=q.texture;v.uniforms.size.value.set(g,k);v.uniforms.amount.value=0;A=new module$src$externals$three.default.OrthographicCamera(-1,1,
1,-1,0,1);z=new module$src$externals$three.default.Scene;B=new module$src$externals$three.default.Mesh(new module$src$externals$three.default.PlaneGeometry(2,2),v);z.add(B)};h.prototype._setToggleSoftShadows=function(a){for(var c=b.threeDManager.helpers.getMeshMaterialObjects(),d=b.threeDManager._getExchangeMeshMaterialObjects(),e=0,f=c.length;e<f;e++){var g=c[e].mesh,h=c[e].material,l=void 0;if("ShapeDiverStandardMaterial"===h.type&&g.geometry&&"TextGeometry"!==g.geometry.type){for(var p=-1,m=0,
k=d.length;m<k;m++)if(d[m].mesh===g){p=m;l=d[m].material;break}-1===p&&(l=b.materialHandler.getMaterial(),l.deepCopy(h),l.defines.USE_PCSS_SHADOW="",l.softShadow=!0,p=d.length,d.push({mesh:g,material:l}));if(h.softShadow!==a){c[e].material=l;d[p].material=h;g.material=l;for(var q in h)"uuid"!==q&&"defines"!==q&&"vertexShader"!==q&&"fragmentShader"!==q&&"softShadow"!==q&&g.material[q]!==h[q]&&(g.material[q]=h[q]);for(var n in g.material.defines)"USE_PCSS_SHADOW"===n||g.material.defines[n]&&h.defines[n]||
(delete g.material.defines[n],g.material.needsUpdate=!0);for(var r in h.defines)"USE_PCSS_SHADOW"===r||g.material.defines[r]&&h.defines[r]||(g.material.defines[r]=h.defines[r],g.material.needsUpdate=!0)}}}};h.prototype._startBlending=function(a,g){b.renderingHandler.registerForContinuousRendering("beautyRenderBlending",!1);w=performance.now();y=0;v.uniforms.tStandard.value=a.texture;v.uniforms.tBeauty.value=g.texture;c.getSetting("shadows")&&f._setToggleSoftShadows(!1);e.render(d,b.cameraHandler.camera,
u,!0)};h.prototype.renderStandard=function(){e.render(d,b.cameraHandler.camera)};h.prototype.beautyRenderingActive=function(){var a=c.getSetting("shadows");return c.getSetting("ambientOcclusion")&&!m||a};h.prototype.renderBeauty=function(){var a=c.getSetting("shadows"),g=c.getSetting("ambientOcclusion");e.render(d,b.cameraHandler.camera);n.render(e,d,b.cameraHandler.camera,p,2);a&&f._setToggleSoftShadows(!0);g&&!m?(a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC,
{viewportRuntimeId:b.threeDManager.runtimeId}),b.threeDManager.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_RENDER_BEAUTY_START,a),n.render(e,d,b.cameraHandler.camera,q,2),r.render(e,d,b.cameraHandler.camera,q,t),e.render(d,b.cameraHandler.camera,u,!0),f._startBlending(p,t)):a?(a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC,{viewportRuntimeId:b.threeDManager.runtimeId}),
b.threeDManager.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_RENDER_BEAUTY_START,a),n.render(e,d,b.cameraHandler.camera,q,2),e.render(d,b.cameraHandler.camera,u,!0),f._startBlending(p,q)):e.render(d,b.cameraHandler.camera)};h.prototype.renderBlending=function(){v.uniforms.amount.value=y;e.render(z,A,null,!0);x=performance.now();var a=(x-w)/1E3;w=x;y+=Math.min(a/1.5,.1);1<=y&&(y=0,b.renderingHandler.unregisterForContinuousRendering("beautyRenderBlending"),a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC,
{viewportRuntimeId:b.threeDManager.runtimeId}),b.threeDManager.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_RENDER_BEAUTY_END,a))};h.prototype.renderHidden=function(){b.threeDManager&&b.cameraHandler&&b.cameraHandler.camera&&(b.threeDManager.helpers.toggleViewport(!0),e.render(d,b.cameraHandler.camera,u),b.threeDManager.helpers.toggleViewport(!1))};h.prototype.updateCustomUniforms=function(){d.traverse(function(a){if(a.material)if("ShapeDiverStandardMaterial"===
a.material.type){a.material.uniforms.lightWorldSize.value=a.material.lightWorldSize;a.material.uniforms.lightFrustum.value=a.material.lightFrustum;a.material.uniforms.shadowOpacity.value=a.material.shadowOpacity;a.material.uniforms.lightReflectivity.value=a.material.lightReflectivity;a.material.uniforms.rgbMap.value=a.material.rgbMap;a.material.uniforms.threeDNoiseOpacity.value=a.material.threeDNoiseOpacity;a.material.uniforms.threeDNoiseID.value=a.material.threeDNoiseID;a.material.uniforms.threeDNoiseScale.value=
a.material.threeDNoiseScale;a.material.uniforms.threeDNoiseDistanceFade.value=a.material.threeDNoiseDistanceFade;if(0<a.material.threeDNoiseOpacity&&""!==a.material.defines["USE_3D_NOISE_F"+a.material.threeDNoiseID]&&(0<=a.material.threeDNoiseID&&3>=a.material.threeDNoiseID||999===a.material.threeDNoiseID)){for(var b in a.material.defines)0===b.indexOf("USE_3D_NOISE_F")&&delete a.material.defines[b];a.material.defines["USE_3D_NOISE_F"+a.material.threeDNoiseID]="";a.material.needsUpdate=!0}if(0<a.material.threeDNoiseOpacity&&
""!==a.material.defines.USE_3D_NOISE)a.material.defines.USE_3D_NOISE="",a.material.needsUpdate=!0,-1===a.material.threeDNoiseID&&(a.material.threeDNoiseID=0,a.material.uniforms.threeDNoiseID.value=a.material.threeDNoiseID,a.material.defines.USE_3D_NOISE_F0="");else if(0>=a.material.threeDNoiseOpacity&&""===a.material.defines.USE_3D_NOISE){for(var c in a.material.defines)0===c.indexOf("USE_3D_NOISE_F")&&delete a.material.defines[c];delete a.material.defines.USE_3D_NOISE;a.material.needsUpdate=!0}a.material.map&&
(a.material.uniforms.uvTransformMap.value=a.material.map.uvTransform,a.material.map.matrix.identity());a.material.specularMap&&(a.material.uniforms.uvTransformSpecularMap.value=a.material.specularMap.uvTransform,a.material.specularMap.matrix.identity());a.material.normalMap&&(a.material.uniforms.uvTransformNormalMap.value=a.material.normalMap.uvTransform,a.material.normalMap.matrix.identity());a.material.bumpMap&&(a.material.uniforms.uvTransformBumpMap.value=a.material.bumpMap.uvTransform,a.material.bumpMap.matrix.identity());
a.material.roughnessMap&&(a.material.uniforms.uvTransformRoughnessMap.value=a.material.roughnessMap.uvTransform,a.material.roughnessMap.matrix=new module$src$externals$three.default.Matrix3);a.material.metalnessMap&&(a.material.uniforms.uvTransformMetalnessMap.value=a.material.metalnessMap.uvTransform,a.material.metalnessMap.matrix=new module$src$externals$three.default.Matrix3);a.material.alphaMap&&(a.material.uniforms.uvTransformAlphaMap.value=a.material.alphaMap.uvTransform,a.material.alphaMap.matrix.identity());
a.material.emissiveMap&&(a.material.uniforms.uvTransformEmissiveMap.value=a.material.emissiveMap.uvTransform,a.material.emissiveMap.matrix.identity());if(0!==a.material.mapsSize){a.material.uniforms.mapsSize.value=a.material.mapsSize;0<a.material.mapsSize&&a.material.defines.NUM_ADD_MAPS!==a.material.mapsSize&&(a.material.defines.NUM_ADD_MAPS=a.material.mapsSize,a.material.needsUpdate=!0);for(;5>a.material.mapPropertyType.length;)a.material.mapPropertyType.push(-1);for(;5>a.material.mapPropertyColor.length;)a.material.mapPropertyColor.push(new module$src$externals$three.default.Color(0));
for(;5>a.material.uvTransformAddMap.length;)a.material.uvTransformAddMap.push((new module$src$externals$three.default.Matrix3).identity());a.material.uniforms.mapPropertyType.value=a.material.mapPropertyType;a.material.uniforms.mapPropertyColor.value=a.material.mapPropertyColor;a.material.uniforms.uvTransformAddMap.value=a.material.uvTransformAddMap;b=0;for(c=a.material.mapsSize;b<c;b++)0===b&&(a.material.uniforms.additionalMaps0.value=a.material.additionalMaps0),1===b&&(a.material.uniforms.additionalMaps1.value=
a.material.additionalMaps1),2===b&&(a.material.uniforms.additionalMaps2.value=a.material.additionalMaps2),3===b&&(a.material.uniforms.additionalMaps3.value=a.material.additionalMaps3),4===b&&(a.material.uniforms.additionalMaps4.value=a.material.additionalMaps4)}else a.material.uniforms.mapsSize.value=0,0!==a.material.defines.NUM_ADD_MAPS&&(a.material.defines.NUM_ADD_MAPS=0,a.material.needsUpdate=!0);l&&""!==a.material.defines.LOD_BLACK_LIST&&(a.material.defines.LOD_BLACK_LIST="",a.material.needsUpdate=
!0)}else"ShapeDiverGemMaterial"===a.material.type&&(a.material.uniforms.refractionIndex.value=a.material.refractionIndex,a.material.uniforms.center.value=a.material.center,a.material.uniforms.radius.value=a.material.radius,a.material.uniforms.sphericalNormalMap.value=a.material.sphericalNormalMap,a.material.uniforms.dispersion.value=a.material.dispersion,a.material.uniforms.contrast.value=a.material.contrast,a.material.uniforms.gamma.value=a.material.gamma,a.material.uniforms.brightness.value=a.material.brightness,
a.material.uniforms.tracingOpacity.value=a.material.tracingOpacity,a.material.uniforms.impurityMap.value=a.material.impurityMap,a.material.uniforms.impurityScale.value=a.material.impurityScale,a.material.uniforms.colorTransferBegin.value=a.material.colorTransferBegin,a.material.uniforms.colorTransferEnd.value=a.material.colorTransferEnd,a.material.inverseModelMatrix=(new module$src$externals$three.default.Matrix4).getInverse(a.matrixWorld),a.material.uniforms.inverseModelMatrix.value=a.material.inverseModelMatrix,
a.material.inverseTransposeModelMatrix=(new module$src$externals$three.default.Matrix3).getNormalMatrix((new module$src$externals$three.default.Matrix4).getInverse(a.matrixWorld).transpose()),a.material.uniforms.inverseTransposeModelMatrix.value=a.material.inverseTransposeModelMatrix,a.material.defines.DEPTH!=a.material.depth&&(a.material.defines.DEPTH=a.material.depth,a.material.needsUpdate=!0),""===a.material.defines.DISPERSION&&0===a.material.dispersion&&(delete a.material.defines.DISPERSION,a.material.needsUpdate=
!0),""!==a.material.defines.DISPERSION&&0!==a.material.dispersion&&(a.material.defines.DISPERSION="",a.material.needsUpdate=!0),""===a.material.defines.USE_IMPURITY_MAP&&null===a.material.impurityMap&&(delete a.material.defines.USE_IMPURITY_MAP,a.material.needsUpdate=!0),""!==a.material.defines.USE_IMPURITY_MAP&&null!==a.material.impurityMap&&(a.material.defines.USE_IMPURITY_MAP="",a.material.needsUpdate=!0))})};h.prototype.setSize=function(a,b){var c=e.getPixelRatio();a*=c;b*=c;r.setSize(a,b);n.setSize(a,
b);u.setSize(a,b);p.setSize(a,b);q.setSize(a,b);t.setSize(a,b);v.uniforms.size.value.set(a,b)};return new h(a)}};var module$src$3d$viewport$handlers$RenderingHandler={default:function(a,b){var c=a.settings,d=a.scene,e=a.geometryNode,f=a.container,h=[],g,k,l=f.offsetWidth,m=f.offsetHeight,n=!1,r=-1,u=null,p,q,t=!1,v=!1,w=-1,x=null,y=null,A=!0,z=!1,B=!1,D=Date.now(),G=0,F=0,E=function(a,b,c){b!==c&&g.render()},I=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",b.threeDManager.warn,"RenderingHandler.Hook->shadows"))return!1;b.lightHandler.setToggleLightShadows(a);return!0},C=function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,
"boolean",b.threeDManager.warn,"RenderingHandler.Hook->ambientOcclusion")?!0:!1},L=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"color",b.threeDManager.warn,"RenderingHandler.Hook->clearColor"))return!1;a=(0,module$src$shared$util$toTinyColor.default)(a);null!==y?q.setClearColor(a.toThreeColor(),y):q.setClearColor(a.toThreeColor());g.render();return!0},H=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"notnegative",b.threeDManager.warn,"RenderingHandler.Hook->clearAlpha"))return!1;
y=a;q.setClearAlpha(a);g.render();return!0},K=function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"notnegative",b.threeDManager.warn,"RenderingHandler.Hook->pointSize")?!0:!1},S=function(){g.render()},J=function(){module$src$3d$interfaces$handlers$RenderingHandlerInterface.default.call(this);g=this;k=module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary.getInstance(b.threeDManager.viewerApi.getSetting("viewerRuntimeId"));p=new module$src$3d$viewport$helpers$handlers$RenderingHandlerHelpers.default(b);
var a=p.createWebGLRenderer(f,{antialias:!0,alpha:!0,preserveDrawingBuffer:!0});b.threeDManager.success=a.success;p.handleCreateWebGLRendererResponse("RenderingHandler",a,"WebGL context was created","WebGL context could not be created");if(!1===a.success)return null;q=a.renderer;q.setPixelRatio(window.devicePixelRatio);q.setSize(l,m,!0);q.setClearColor((0,module$src$shared$util$toTinyColor.default)(c.getSetting("clearColor"),"white").toThreeColor(),c.getSetting("clearAlpha"));q.shadowMap.enabled=
!0;q.shadowMap.autoUpdate=!1;q.shadowMap.needsUpdate=!0;q.shadowMap.type=module$src$externals$three.default.PCFShadowMap;q.gammaFactor=1;q.gammaInput=!1;q.gammaOutput=!0;q.textureUnitCount=a.renderer.context.getParameter(a.renderer.context.MAX_TEXTURE_IMAGE_UNITS);q.textureUnitCount||(q.textureUnitCount=8);q.depth=!1;window.onresize=function(){-1===w&&g.registerForContinuousRendering("registeredResizeEvent");clearTimeout(w);w=setTimeout(function(){w=-1;g.unregisterForContinuousRendering("registeredResizeEvent");
g.render()},250)};b.beautyRenderHandler=new module$src$3d$viewport$handlers$BeautyRenderHandler.default({settings:c,scene:d,geometryNode:e,renderer:q},b);b.threeDManager.beautyRenderHandler=b.beautyRenderHandler;b.threeDManager.viewerApi.state.addEventListener(b.threeDManager.viewerApi.state.EVENTTYPE.BUSY,function(){-1===h.indexOf("busyMode")&&g.registerForContinuousRendering("busyMode")});b.threeDManager.viewerApi.state.addEventListener(b.threeDManager.viewerApi.state.EVENTTYPE.IDLE,function(){g.unregisterForContinuousRendering("busyMode")});
c.registerNotifier("shadows",E);c.registerNotifier("ambientOcclusion",E);c.registerNotifier("pointSize",S);c.registerHook("shadows",I);c.registerHook("ambientOcclusion",C);c.registerHook("clearColor",L);c.registerHook("clearAlpha",H);c.registerHook("pointSize",K)};$jscomp.inherits(J,module$src$3d$interfaces$handlers$RenderingHandlerInterface.default);J.prototype._resizeEvent=function(){g.registerForContinuousRendering("unregisteredResizeEvent",!1);setTimeout(function(){g.unregisterForContinuousRendering("unregisteredResizeEvent")},
100)};J.prototype._beforeRender=function(a){q.clear();module$node_modules$$tweenjs$tween_js$src$Tween.default.update(a);b.cameraHandler.updateCameraControls(a-D);if(document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||document.mozFullScreenElement){var c=!0;if("true"==q.domElement.getAttribute("sdv-fullscreen")||null==q.domElement.parentNode){a=screen.width;var d=screen.height}else a=q.domElement.parentNode.offsetWidth,d=q.domElement.parentNode.offsetHeight}else c=
!1,a=q.domElement.parentNode.offsetWidth,d=q.domElement.parentNode.offsetHeight;if(a!==l||d!==m||n!==c)g._resizeEvent(),l=a,m=d,n=c,q.setSize(l,m,!0),b.cameraHandler.onResize(l,m),b.beautyRenderHandler.setSize(l,m);b.beautyRenderHandler.updateCustomUniforms();if(!0===t||!0===v)t=!1,q.shadowMap.needsUpdate=!0};J.prototype._getExtension=function(a){return q.extensions.get(a)};J.prototype._getTextureUnitCount=function(){return q.textureUnitCount};J.prototype._framerateMeasurement=function(a,c){0===a?
(G+=c,F++,1E3<G&&(F-=(G-1E3)/c,a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC,{type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_FRAMERATE,viewportRuntimeId:b.threeDManager.runtimeId,framerate:F}),b.threeDManager.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_FRAMERATE,a),F=G=0)):F=G=0};J.prototype.render=function(a){if(k.firstTimeVisible.resolved&&
!1!==z&&b.threeDManager&&q.domElement&&!1!==b.threeDManager.getSetting("show")&&A&&0!==a-D)if(u&&(clearTimeout(u),u=null),a){-1===r&&(D=a);g._framerateMeasurement(r,a-D);r=1===h.length&&-1!==h.indexOf("beautyRenderBlending")?2:0===h.length&&!0===B?1:0;B=!1;if(0===r&&-1!==h.indexOf("beautyRenderBlending")){g.unregisterForContinuousRendering("beautyRenderBlending");var e=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC);
b.threeDManager.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_RENDER_BEAUTY_CANCEL,e)}g._beforeRender(a);b.threeDManager.helpers.toggleViewport(!0,a);0==r?b.beautyRenderHandler.renderStandard():2==r?b.beautyRenderHandler.renderBlending():1==r&&b.beautyRenderHandler.renderBeauty();p.processAnchors(q,d,b.cameraHandler.camera,b.threeDManager.helpers.getAnchors());b.threeDManager.helpers.toggleViewport(!1,a);0<h.length?requestAnimationFrame(g.render):(0===r&&b.beautyRenderHandler.beautyRenderingActive()&&
(u=setTimeout(function(){B=!0;u=null;requestAnimationFrame(g.render)},c.getSetting("beautyRenderDelay"))),r=-1);D=a}else-1!==h.indexOf("beautyRenderBlending")?(g.unregisterForContinuousRendering("beautyRenderBlending"),a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC),b.threeDManager.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_RENDER_BEAUTY_CANCEL,a)):-1===r&&requestAnimationFrame(g.render)};
J.prototype.renderHidden=function(){b.beautyRenderHandler.renderHidden()};J.prototype.onResize=function(a,b){q.setSize(a,b)};J.prototype.getSize=function(){return q.getSize()};J.prototype.start=function(){z=!0};J.prototype.pause=function(){A=!1};J.prototype.resume=function(){A=!0;r=-1};J.prototype.destroy=function(){q.dispose();try{q.forceContextLoss()}catch(M){}};J.prototype.getScreenshot=function(){return q.domElement.toDataURL("image/png")};J.prototype.getDomElement=function(){return q.domElement};
J.prototype.getCanvas=function(){return q.context.canvas};J.prototype.getRendererInfo=function(){return q.info};J.prototype.setBlur=function(a,b){null!=b&&b.hasOwnProperty("duration")?(x=x||Promise.resolve(),x=x.then(function(){var c={r:a?0:3};return new Promise(function(d){(new module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween(c)).to({r:a?3:1},b.duration).onUpdate(function(){q.domElement.style.filter="blur("+c.r+"px)"}).onComplete(function(){q.domElement.style.filter=a?"blur(3px)":"";
d()}).start()})})):x=(x||Promise.resolve()).then(function(){q.domElement.style.filter=a?"blur(3px)":""})};J.prototype.registerForContinuousRendering=function(a,b){void 0!==a&&(h.includes("cameraMoving")&&"cameraMoving"===a||h.push(a),!1!==b&&g.render())};J.prototype.unregisterForContinuousRendering=function(a){a=h.indexOf(a);-1<a&&h.splice(a,1)};J.prototype.containsContinuousRendering=function(a){return-1===h.indexOf(a)?!1:!0};J.prototype.updateShadowMap=function(){t=!0};J.prototype.keepUpdatingShadowMap=
function(){v=!0};J.prototype.stopUpdatingShadowMap=function(){v=!1};J.prototype.getRenderer=function(){return q};return new J(a)}};var module$src$3d$viewport$helpers$handlers$MaterialHandlerHelpers={default:function(a,b){var c=b.nameSimple;b=function(){};b.prototype.checkMaterials=function(){var b=a.renderingHandler.getRendererInfo();if(b&&b.programs){b=b.programs;for(var e=0,f=b.length;e<f;e++){var h=b[e];if(h.diagnostics&&!1===h.diagnostics.runnable){if(h.name===c){var g={message:h,messageLevel:module$src$shared$constants$LoggingConstants.default.loggingLevels.ERROR,messageScope:"Shader program could not be created"},k=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE,
g);a.threeDManager.message(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS_FAILED,k);a.threeDManager.log(g.messageLevel,g.messageScope,g);a.threeDManager.log(g.messageLevel|module$src$shared$constants$LoggingConstants.default.loggingLevels.LOG_TO_SERVER,g.messageScope,g);a.threeDManager.viewerApi.viewports.destroy(a.threeDManager.runtimeId)}else{g=a.threeDManager.helpers.getMeshMaterialObjects();for(var l=0,m=g.length;l<m;l++)if(k=g[l],k.material.program&&k.material.program.id===
h.id){k.material=a.materialHandler.getSimpleMaterial(k.properties);break}}delete h.diagnostics}}}};return new b}};var module$src$3d$viewport$handlers$MaterialHandler={default:{}},__awaiter$$module$src$3d$viewport$handlers$MaterialHandler=this&&module$src$3d$viewport$handlers$MaterialHandler.default.__awaiter||function(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function f(a){try{l(d.next(a))}catch(n){h(n)}}function k(a){try{l(d["throw"](a))}catch(n){h(n)}}function l(a){a.done?c(a.value):e(a.value).then(f,k)}l((d=d.apply(a,b||[])).next())})},
__generator$$module$src$3d$viewport$handlers$MaterialHandler=this&&module$src$3d$viewport$handlers$MaterialHandler.default.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(f)throw new TypeError("Generator is already executing.");for(;e;)try{if(f=1,h&&(g=c[0]&2?h["return"]:c[0]?h["throw"]||((g=h["return"])&&g.call(h),0):h.next)&&!(g=g.call(h,c[1])).done)return g;if(h=0,g)c=[c[0]&2,g.value];switch(c[0]){case 0:case 1:g=c;break;case 4:return e.label++,{value:c[1],
done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(g=e.trys,g=0<g.length&&g[g.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3]))e.label=c[1];else if(6===c[0]&&e.label<g[1])e.label=g[1],g=c;else if(g&&e.label<g[2])e.label=g[2],e.ops.push(c);else{g[2]&&e.ops.pop();e.trys.pop();continue}}c=b.call(a,e)}catch(m){c=[6,m],h=0}finally{f=g=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(g[0]&
1)throw g[1];return g[1]},trys:[],ops:[]},f,h,g,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k},__importStar$$module$src$3d$viewport$handlers$MaterialHandler=this&&module$src$3d$viewport$handlers$MaterialHandler.default.__importStar||function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b["default"]=a;return b},__importDefault$$module$src$3d$viewport$handlers$MaterialHandler=
this&&module$src$3d$viewport$handlers$MaterialHandler.default.__importDefault||function(a){return a&&a.__esModule?a:{"default":a}};Object.defineProperty(module$src$3d$viewport$handlers$MaterialHandler.default,"__esModule",{value:!0});
var THREE$$module$src$3d$viewport$handlers$MaterialHandler=__importStar$$module$src$3d$viewport$handlers$MaterialHandler(module$src$externals$three.default),GLOBAL_UTILS$$module$src$3d$viewport$handlers$MaterialHandler=__importStar$$module$src$3d$viewport$handlers$MaterialHandler(module$src$shared$util$GlobalUtils.default),SHADERS$$module$src$3d$viewport$handlers$MaterialHandler=__importStar$$module$src$3d$viewport$handlers$MaterialHandler(module$src$3d$viewport$shaders$ShaderFile.default),MaterialHandlerHelpers_1$$module$src$3d$viewport$handlers$MaterialHandler=
__importDefault$$module$src$3d$viewport$handlers$MaterialHandler(module$src$3d$viewport$helpers$handlers$MaterialHandlerHelpers.default),MaterialHandlerInsance$$module$src$3d$viewport$handlers$MaterialHandler=function(){function a(a,c){var b=this;this._handlers=c;this._envMapFilenames="px nx pz nz py ny".split(" ");this._envMapNamesJPG="default default_bw blurred_lights georgentor georgentor_blur georgentor_blue_blur georgentor_bw_blur levelsets lythwood_field mountains ocean piazza_san_marco residential_garden room_abstract_1 sky storage_room storm subway_entrance subway_entrance_bw_blur white yokohama".split(" ");
this._envMapNamesPNG=[];this._envMapUrlPrefix="https://viewer.shapediver.com/v2/envmaps/";this._gemSphericalMaps={};this._textureUnitCount=0;this._usedEnvironmentMaps=[];this._active=!0;this._environmentMap=null;this._lightFrustum=6.5;this._lightWorldSize=.005;this._mipmapBlackListed=!1;this._settings=a.settings;this._pathUtils=a.pathUtils;this._scene=a.scene;this._helpers=new MaterialHandlerHelpers_1$$module$src$3d$viewport$handlers$MaterialHandler.default(c,{nameStandard:"ShapeDiverStandardMaterial",
nameSimple:"MeshPhongMaterial"});c.renderingHandler._getExtension("EXT_shader_texture_lod")||(this._mipmapBlackListed=!0);this._textureUnitCount=c.renderingHandler._getTextureUnitCount();this._settings.registerHook("environmentMap",function(a){return b.environmentMapHook(a)});this._settings.updateSettingAsync("environmentMap",this._settings.getSetting("environmentMap"));this._settings.registerHook("environmentMapAsBackground",this.environmentMapAsBackgroundHook.bind(this));this._settings.registerHook("environmentMapResolution",
this.environmentMapResolutionHook.bind(this))}a.prototype.adjustToBoundingSphere=function(a){this._lightWorldSize=a.radius/25*.005;this._lightFrustum=a.radius/25*6.5;a=this._handlers.threeDManager.helpers.getMaterials();for(var b=0,d=a.length;b<d;b++){var e=a[b];"ShapeDiverStandardMaterial"==e.type&&(e.lightWorldSize=this._lightWorldSize,e.lightFrustum=this._lightFrustum)}};a.prototype.compile=function(){this._handlers.beautyRenderHandler.renderHidden();this._helpers.checkMaterials()};a.prototype.createCubeNormalMap=
function(a,c,d){c=this.getTransformationPath(a)+c;if(this._gemSphericalMaps[c+"_"+d])return this._gemSphericalMaps[c+"_"+d];var b=new THREE$$module$src$3d$viewport$handlers$MaterialHandler.Scene,f=new THREE$$module$src$3d$viewport$handlers$MaterialHandler.CubeCamera(.001,1E4,d);f.renderTarget.texture.generateMipmaps=!1;f.renderTarget.texture.minFilter=THREE$$module$src$3d$viewport$handlers$MaterialHandler.NearestFilter;f.renderTarget.texture.magFilter=THREE$$module$src$3d$viewport$handlers$MaterialHandler.NearestFilter;
f.renderTarget.texture.format=THREE$$module$src$3d$viewport$handlers$MaterialHandler.RGBAFormat;b.add(f);if(!this._gemNormalMaterial){var h=THREE$$module$src$3d$viewport$handlers$MaterialHandler.UniformsUtils.merge([THREE$$module$src$3d$viewport$handlers$MaterialHandler.UniformsLib.common,{emissive:{value:new THREE$$module$src$3d$viewport$handlers$MaterialHandler.Color(0)},roughness:{value:.5},metalness:{value:0},envMapIntensity:{value:1}}]),g=SHADERS$$module$src$3d$viewport$handlers$MaterialHandler.normal_vert,
k=SHADERS$$module$src$3d$viewport$handlers$MaterialHandler.normal_frag;this._gemNormalMaterial=new THREE$$module$src$3d$viewport$handlers$MaterialHandler.ShaderMaterial({uniforms:THREE$$module$src$3d$viewport$handlers$MaterialHandler.UniformsUtils.clone(h),defines:{STANDARD:""},vertexShader:g,fragmentShader:k});this._gemNormalMaterial.blending=THREE$$module$src$3d$viewport$handlers$MaterialHandler.NoBlending;this._gemNormalMaterial.side=THREE$$module$src$3d$viewport$handlers$MaterialHandler.DoubleSide;
b.overrideMaterial=this._gemNormalMaterial}a=new THREE$$module$src$3d$viewport$handlers$MaterialHandler.Mesh(a.geometry.clone(),this._gemNormalMaterial);a.geometry.center();b.add(a);f.update(this._handlers.renderingHandler.getRenderer(),b);b.remove(a);this._gemSphericalMaps[c+"_"+d]=f.renderTarget.texture;return this._gemSphericalMaps[c+"_"+d]};a.prototype.destroy=function(){};a.prototype.getEnvironmentMap=function(){return this._environmentMap};a.prototype.getMaterial=function(a,c,d,e,f){null==a&&
(a={});!a.attributes&&c&&c.geometry&&c.geometry.attributes&&(a.attributes=Object.keys(c.geometry.attributes));"gem"===a.materialType?(e=this.createCubeNormalMap(c,d,a.resolution),c.geometry.boundingSphere||c.geometry.computeBoundingSphere(),f=c.geometry.boundingSphere.center,d=c.geometry.boundingSphere.radius,a.side=THREE$$module$src$3d$viewport$handlers$MaterialHandler.FrontSide,a=Object.assign({inverseModelMatrix:(new THREE$$module$src$3d$viewport$handlers$MaterialHandler.Matrix4).getInverse(c.matrixWorld),
inverseTransposeModelMatrix:(new THREE$$module$src$3d$viewport$handlers$MaterialHandler.Matrix3).getNormalMatrix((new THREE$$module$src$3d$viewport$handlers$MaterialHandler.Matrix4).getInverse(c.matrixWorld).transpose()),center:f,radius:d,sphericalNormalMap:e,envMap:a.environmentMap?a.environmentMap:this._environmentMap,customEnvMap:!!a.environmentMap},a),a=new THREE$$module$src$3d$viewport$handlers$MaterialHandler.ShapeDiverGemMaterial(a)):(a=new THREE$$module$src$3d$viewport$handlers$MaterialHandler.ShapeDiverStandardMaterial(Object.assign({textureUnitCount:this._textureUnitCount,
lightWorldSize:this._lightWorldSize,lightFrustum:this._lightFrustum,envMap:this._environmentMap,renderAO:!0},a)),e&&a.color.set(e.toRgbString()),f&&(a.vertexColors=THREE$$module$src$3d$viewport$handlers$MaterialHandler.VertexColors),this._handlers.lightHandler.reevaluateNumberOfShadowMaps(a.availableTextures));return a};a.prototype.getSceneBackground=function(){return this._sceneBackground};a.prototype.getSimpleMaterial=function(a){return new THREE$$module$src$3d$viewport$handlers$MaterialHandler.MeshPhongMaterial(Object.assign({shininess:a.metalness?
128*a.metalness:0},a))};a.prototype.pause=function(){this._active=!1};a.prototype.resume=function(){this._active=!0};a.prototype.setSceneBackground=function(a){this._sceneBackground=a};a.prototype.assignEnvironmentMap=function(a){this._settings.getSetting("environmentMapAsBackground")&&(this._sceneBackground=a.map);for(var b=this._handlers.threeDManager.helpers.getMaterials(),d=0,e=b.length;d<e;d++){var f=b[d];"ShapeDiverStandardMaterial"==f.type?f.envMap=a.map:"ShapeDiverGemMaterial"!=f.type||f.customEnvMap||
(f.envMap=a.map)}this._environmentMap=a.map;this._handlers.renderingHandler.render()};a.prototype.environmentMapAsBackgroundHook=function(a){if(!GLOBAL_UTILS$$module$src$3d$viewport$handlers$MaterialHandler.typeCheck(a,"boolean",this._handlers.threeDManager.warn,"MaterialHandler.Hook->environmentMapAsBackground"))return!1;if(this._handlers.threeDManager.getSetting("groundPlaneReflectionVisibility")&&a)return this._handlers.threeDManager.warn("MaterialHandler.Hook->environmentMapAsBackground","The ground plane reflection and the environment as background do not work together right now."),
!1;this._sceneBackground=a?this._environmentMap:null;this._handlers.renderingHandler.render();return!0};a.prototype.environmentMapHook=function(a,c){return __awaiter$$module$src$3d$viewport$handlers$MaterialHandler(this,void 0,void 0,function(){var b,e,f,h,g,k,l,m,n,r,u;return __generator$$module$src$3d$viewport$handlers$MaterialHandler(this,function(d){switch(d.label){case 0:b="MaterialHandler.setEnvironmentMap";if(void 0===a)return this._handlers.threeDManager.warn(b,"No input was provided, the environment map was not set."),
[2,Promise.resolve(!1)];if("none"===a)return this.assignEnvironmentMap({name:"none",map:null}),[2,Promise.resolve(!0)];if(GLOBAL_UTILS$$module$src$3d$viewport$handlers$MaterialHandler.typeCheck(a,"string")&&a.startsWith('["https')&&a.endsWith('"]')){g=a;try{a=JSON.parse(g)}catch(q){a=g}}k=c||this._settings.getSetting("environmentMapResolution");if(GLOBAL_UTILS$$module$src$3d$viewport$handlers$MaterialHandler.typeCheck(a,"string"))e=a.toLowerCase().replace(/ /g,"_"),f=e+k;else if(Array.isArray(a)){h=
a;if(6!==h.length)return this._handlers.threeDManager.warn(b,"The number of URLs was not 6, the environment map was not set."),[2,Promise.resolve(!1)];f=e=JSON.stringify(h,null,0)}l=0;for(m=this._usedEnvironmentMaps;l<m.length;l++)if(n=m[l],n.name===f)return this.assignEnvironmentMap(n),[2,Promise.resolve(!0)];if(void 0===h)if(h=[],r=void 0,0<=this._envMapNamesJPG.indexOf(e))for(r=0;r<this._envMapFilenames.length;r++)h.push(this._envMapUrlPrefix+k+"/"+e+"/"+this._envMapFilenames[r]+".jpg");else if(0<=
this._envMapNamesPNG.indexOf(e))for(r=0;r<this._envMapFilenames.length;r++)h.push(this._envMapUrlPrefix+k+"/"+e+"/"+this._envMapFilenames[r]+".png");else if(a.startsWith("https://")||a.startsWith("http://"))for(a.endsWith("/")||(a+="/"),r=0;r<this._envMapFilenames.length;r++)h.push(a+this._envMapFilenames[r]+".jpg");else return"none"!==a&&this._handlers.threeDManager.warn(b,"Environment map name not found, and not a base URL",a),[2,Promise.resolve(!1)];d.label=1;case 1:return d.trys.push([1,3,,4]),
[4,this.loadEnvironmentMap(f,h)];case 2:return u=d.sent(),this._usedEnvironmentMaps.push(u),this.assignEnvironmentMap(u),[2,Promise.resolve(!0)];case 3:return d.sent(),this._handlers.threeDManager.warn(b,"Was not able to load the environment map, the environment map was not set."),[2,Promise.resolve(!1)];case 4:return[2]}})})};a.prototype.environmentMapResolutionHook=function(a){if(!["256","512","1024","2048"].includes(a))return this._handlers.threeDManager.warn("MaterialHandler.setEnvironmentMapResolution",
"No valid input was provided, the environment map was not changed."),Promise.resolve(!1);var b=this._settings.getSetting("environmentMap");return"none"===b?Promise.resolve(!0):this.environmentMapHook(b,a)};a.prototype.getTransformationPath=function(a){a=this._pathUtils.getObjectPath(a);return a.substring(0,a.indexOf(".",a.indexOf("transformation_")))};a.prototype.loadEnvironmentMap=function(a,c){return new Promise(function(b,e){(new THREE$$module$src$3d$viewport$handlers$MaterialHandler.CubeTextureLoader).load(c,
function(c){c.format=THREE$$module$src$3d$viewport$handlers$MaterialHandler.RGBFormat;c.mapping=THREE$$module$src$3d$viewport$handlers$MaterialHandler.CubeReflectionMapping;this._mipmapBlackListed&&(c.generateMipmaps=!1,c.minFilter=THREE$$module$src$3d$viewport$handlers$MaterialHandler.LinearFilter,c.magFilter=THREE$$module$src$3d$viewport$handlers$MaterialHandler.LinearFilter);b({name:a,map:c})},null,function(a){e(a)})})};return a}();
module$src$3d$viewport$handlers$MaterialHandler.default.MaterialHandler=function(){function a(a,c){this._materialHandlerInstance=new MaterialHandlerInsance$$module$src$3d$viewport$handlers$MaterialHandler(a,c)}a.prototype.adjustToBoundingSphere=function(a){this._materialHandlerInstance.adjustToBoundingSphere(a)};a.prototype.compile=function(){this._materialHandlerInstance.compile()};a.prototype.destroy=function(){this._materialHandlerInstance.destroy()};a.prototype.getEnvironmentMap=function(){return this._materialHandlerInstance.getEnvironmentMap()};
a.prototype.getMaterial=function(a,c,d,e,f){return this._materialHandlerInstance.getMaterial(a,c,d,e,f)};a.prototype.getSceneBackground=function(){return this._materialHandlerInstance.getSceneBackground()};a.prototype.getSimpleMaterial=function(a){return this._materialHandlerInstance.getSimpleMaterial(a)};a.prototype.pause=function(){this._materialHandlerInstance.pause()};a.prototype.resume=function(){this._materialHandlerInstance.resume()};a.prototype.setSceneBackground=function(a){this._materialHandlerInstance.setSceneBackground(a)};
return a}();var module$src$3d$viewport$interfaces$ICameraHandler={default:{}};Object.defineProperty(module$src$3d$viewport$interfaces$ICameraHandler.default,"__esModule",{value:!0});var CameraType$$module$src$3d$viewport$interfaces$ICameraHandler;
(function(a){a[a.MIN=0]="MIN";a[a.PERSPECTIVE=0]="PERSPECTIVE";a[a.TOP=1]="TOP";a[a.BOTTOM=2]="BOTTOM";a[a.RIGHT=3]="RIGHT";a[a.LEFT=4]="LEFT";a[a.BACK=5]="BACK";a[a.FRONT=6]="FRONT";a[a.AR=7]="AR";a[a.MAX=7]="MAX"})(CameraType$$module$src$3d$viewport$interfaces$ICameraHandler=module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType||(module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType={}));var ControlType$$module$src$3d$viewport$interfaces$ICameraHandler;
(function(a){a[a.MIN=0]="MIN";a[a.ORBIT=0]="ORBIT";a[a.FPS=1]="FPS";a[a.ORTHOGRAPHIC=2]="ORTHOGRAPHIC";a[a.MAX=2]="MAX"})(ControlType$$module$src$3d$viewport$interfaces$ICameraHandler=module$src$3d$viewport$interfaces$ICameraHandler.default.ControlType||(module$src$3d$viewport$interfaces$ICameraHandler.default.ControlType={}));var CameraEventType$$module$src$3d$viewport$interfaces$ICameraHandler;
(function(a){a.CAMERA_START="start";a.CAMERA_MOVE="move";a.CAMERA_END="end"})(CameraEventType$$module$src$3d$viewport$interfaces$ICameraHandler=module$src$3d$viewport$interfaces$ICameraHandler.default.CameraEventType||(module$src$3d$viewport$interfaces$ICameraHandler.default.CameraEventType={}));var module$node_modules$detect_hover$lib$index={default:{}};Object.defineProperty(module$node_modules$detect_hover$lib$index.default,"__esModule",{value:!0});
module$node_modules$detect_hover$lib$index.default.default={update:function(){"undefined"!==typeof window&&"function"===typeof window.matchMedia&&(module$node_modules$detect_hover$lib$index.default.default.hover=window.matchMedia("(hover: hover)").matches,module$node_modules$detect_hover$lib$index.default.default.none=window.matchMedia("(hover: none)").matches||window.matchMedia("(hover: on-demand)").matches,module$node_modules$detect_hover$lib$index.default.default.anyHover=window.matchMedia("(any-hover: hover)").matches,
module$node_modules$detect_hover$lib$index.default.default.anyNone=window.matchMedia("(any-hover: none)").matches||window.matchMedia("(any-hover: on-demand)").matches)}};module$node_modules$detect_hover$lib$index.default.default.update();var module$node_modules$detect_pointer$lib$index={default:{}};Object.defineProperty(module$node_modules$detect_pointer$lib$index.default,"__esModule",{value:!0});
module$node_modules$detect_pointer$lib$index.default.default={update:function(){"undefined"!==typeof window&&"function"===typeof window.matchMedia&&(module$node_modules$detect_pointer$lib$index.default.default.fine=window.matchMedia("(pointer: fine)").matches,module$node_modules$detect_pointer$lib$index.default.default.coarse=window.matchMedia("(pointer: coarse)").matches,module$node_modules$detect_pointer$lib$index.default.default.none=window.matchMedia("(pointer: none)").matches,module$node_modules$detect_pointer$lib$index.default.default.anyFine=
window.matchMedia("(any-pointer: fine)").matches,module$node_modules$detect_pointer$lib$index.default.default.anyCoarse=window.matchMedia("(any-pointer: coarse)").matches,module$node_modules$detect_pointer$lib$index.default.default.anyNone=window.matchMedia("(any-pointer: none)").matches)}};module$node_modules$detect_pointer$lib$index.default.default.update();var module$node_modules$detect_touch_events$lib$index={default:{}};Object.defineProperty(module$node_modules$detect_touch_events$lib$index.default,"__esModule",{value:!0});module$node_modules$detect_touch_events$lib$index.default.default={update:function(){"undefined"!==typeof window&&(module$node_modules$detect_touch_events$lib$index.default.default.hasSupport="ontouchstart"in window,module$node_modules$detect_touch_events$lib$index.default.default.browserSupportsApi=!!window.TouchEvent)}};module$node_modules$detect_touch_events$lib$index.default.default.update();var module$node_modules$detect_passive_events$lib$index={default:{}};Object.defineProperty(module$node_modules$detect_passive_events$lib$index.default,"__esModule",{value:!0});
module$node_modules$detect_passive_events$lib$index.default.default={update:function(){if("undefined"!==typeof window&&"function"===typeof window.addEventListener){var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}}),c=function(){};window.addEventListener("testPassiveEventSupport",c,b);window.removeEventListener("testPassiveEventSupport",c,b);module$node_modules$detect_passive_events$lib$index.default.default.hasSupport=a}}};module$node_modules$detect_passive_events$lib$index.default.default.update();var module$node_modules$detect_it$lib$index={default:{}};Object.defineProperty(module$node_modules$detect_it$lib$index.default,"__esModule",{value:!0});
var _detectHover$$module$node_modules$detect_it$lib$index=module$node_modules$detect_hover$lib$index.default,_detectHover2$$module$node_modules$detect_it$lib$index=_interopRequireDefault$$module$node_modules$detect_it$lib$index(module$node_modules$detect_hover$lib$index.default),_detectPointer$$module$node_modules$detect_it$lib$index=module$node_modules$detect_pointer$lib$index.default,_detectPointer2$$module$node_modules$detect_it$lib$index=_interopRequireDefault$$module$node_modules$detect_it$lib$index(module$node_modules$detect_pointer$lib$index.default),
_detectTouchEvents$$module$node_modules$detect_it$lib$index=module$node_modules$detect_touch_events$lib$index.default,_detectTouchEvents2$$module$node_modules$detect_it$lib$index=_interopRequireDefault$$module$node_modules$detect_it$lib$index(module$node_modules$detect_touch_events$lib$index.default),_detectPassiveEvents$$module$node_modules$detect_it$lib$index=module$node_modules$detect_passive_events$lib$index.default,_detectPassiveEvents2$$module$node_modules$detect_it$lib$index=_interopRequireDefault$$module$node_modules$detect_it$lib$index(module$node_modules$detect_passive_events$lib$index.default);
function _interopRequireDefault$$module$node_modules$detect_it$lib$index(a){return a&&a.__esModule?a:{default:a}}
function determineDeviceType$$module$node_modules$detect_it$lib$index(a,b,c,d){return a&&(b||c)?"hybrid":a&&Object.keys(d.detectHover).filter(function(a){return"update"!==a}).every(function(a){return!1===d.detectHover[a]})&&Object.keys(d.detectPointer).filter(function(a){return"update"!==a}).every(function(a){return!1===d.detectPointer[a]})?window.navigator&&/android/.test(window.navigator.userAgent.toLowerCase())?"touchOnly":"hybrid":a?"touchOnly":"mouseOnly"}
module$node_modules$detect_it$lib$index.default.default={state:{detectHover:_detectHover2$$module$node_modules$detect_it$lib$index.default,detectPointer:_detectPointer2$$module$node_modules$detect_it$lib$index.default,detectTouchEvents:_detectTouchEvents2$$module$node_modules$detect_it$lib$index.default,detectPassiveEvents:_detectPassiveEvents2$$module$node_modules$detect_it$lib$index.default},update:function(){module$node_modules$detect_it$lib$index.default.default.state.detectHover.update();module$node_modules$detect_it$lib$index.default.default.state.detectPointer.update();
module$node_modules$detect_it$lib$index.default.default.state.detectTouchEvents.update();module$node_modules$detect_it$lib$index.default.default.state.detectPassiveEvents.update();module$node_modules$detect_it$lib$index.default.default.updateOnlyOwnProperties()},updateOnlyOwnProperties:function(){if("undefined"!==typeof window){module$node_modules$detect_it$lib$index.default.default.passiveEvents=module$node_modules$detect_it$lib$index.default.default.state.detectPassiveEvents.hasSupport||!1;module$node_modules$detect_it$lib$index.default.default.hasTouch=
module$node_modules$detect_it$lib$index.default.default.state.detectTouchEvents.hasSupport||!1;module$node_modules$detect_it$lib$index.default.default.deviceType=determineDeviceType$$module$node_modules$detect_it$lib$index(module$node_modules$detect_it$lib$index.default.default.hasTouch,module$node_modules$detect_it$lib$index.default.default.state.detectHover.anyHover,module$node_modules$detect_it$lib$index.default.default.state.detectPointer.anyFine,module$node_modules$detect_it$lib$index.default.default.state);
module$node_modules$detect_it$lib$index.default.default.hasMouse="touchOnly"!==module$node_modules$detect_it$lib$index.default.default.deviceType;module$node_modules$detect_it$lib$index.default.default.primaryInput="mouseOnly"===module$node_modules$detect_it$lib$index.default.default.deviceType&&"mouse"||"touchOnly"===module$node_modules$detect_it$lib$index.default.default.deviceType&&"touch"||module$node_modules$detect_it$lib$index.default.default.state.detectPointer.fine&&"mouse"||module$node_modules$detect_it$lib$index.default.default.state.detectPointer.coarse&&
"touch"||"mouse";var a;if(a=/windows/.test(window.navigator.userAgent.toLowerCase())&&/chrome/.test(window.navigator.userAgent.toLowerCase()))a=parseInt(/Chrome\/([0-9.]+)/.exec(navigator.userAgent)[1],10),a=59<=a&&62>a;a&&module$node_modules$detect_it$lib$index.default.default.hasTouch&&(module$node_modules$detect_it$lib$index.default.default.deviceType="hybrid",module$node_modules$detect_it$lib$index.default.default.hasMouse=!0,module$node_modules$detect_it$lib$index.default.default.primaryInput=
"mouse")}}};module$node_modules$detect_it$lib$index.default.default.updateOnlyOwnProperties();var module$src$3d$viewport$helpers$HooksAndNotifiers={default:{}};Object.defineProperty(module$src$3d$viewport$helpers$HooksAndNotifiers.default,"__esModule",{value:!0});module$src$3d$viewport$helpers$HooksAndNotifiers.default.registerHooksAndNotifiers=function(a,b,c,d){for(var e in c)b.registerHook(e,c[e].bind(a));for(e in d)b.registerNotifier(e,d[e].bind(a))};var module$src$3d$viewport$handlers$camera$hooks$CameraHooksAndNotifiers={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$hooks$CameraHooksAndNotifiers.default,"__esModule",{value:!0});var StateDashboard_1$$module$src$3d$viewport$handlers$camera$hooks$CameraHooksAndNotifiers=module$src$modules$shapediver_state_dashboard$StateDashboard.default;
module$src$3d$viewport$handlers$camera$hooks$CameraHooksAndNotifiers.default.CameraHooks={autoAdjust:function(a){var b=this;if(!this._globalUtils.typeCheck(a,"boolean",this._handlers.threeDManager.warn,"CameraHandler.Hook->autoAdjust"))return!1;a&&!this._autoAdjustEventListenerToken&&(this._autoAdjustEventListenerToken=this._handlers.threeDManager.viewerApi.scene.addEventListener(this._handlers.threeDManager.viewerApi.scene.EVENTTYPE.SUBSCENE_PUBLISHED,function(){b._settings.getSetting("autoAdjust")&&
b._handlers.threeDManager.getSetting("show")&&b.zoomExtents({default:!0})}));return!0},cameraMovementDuration:function(a){return!0},enableCameraControls:function(a){if(!this._globalUtils.typeCheck(a,"boolean",this._handlers.threeDManager.warn,"CameraHandler.Hook->enableCameraControls"))return!1;this._cameraControls.enabled=a;return!0},revertAtMouseUp:function(a){var b=this;if(!this._globalUtils.typeCheck(a,"boolean",this._handlers.threeDManager.warn,"CameraHandler.Hook->revertAtMouseUp"))return!1;
a=this._handlers.renderingHandler.getDomElement();this._revertAtMouseUpEventListenerToken||(this._revertAtMouseUpEventListenerToken=a.addEventListener("mouseup",function(){b._settings.getSetting("revertAtMouseUp")&&b.resetPositionAndTarget({duration:b._settings.getSetting("revertAtMouseUpDuration")})},this._detect_it.passiveEvents?{capture:!1,passive:!0}:!1));this._revertAtMouseOutEventListenerToken||(this._revertAtMouseOutEventListenerToken=a.addEventListener("mouseout",function(){b._settings.getSetting("revertAtMouseUp")&&
b.resetPositionAndTarget({duration:b._settings.getSetting("revertAtMouseUpDuration")})},this._detect_it.passiveEvents?{capture:!1,passive:!0}:!1));this._revertAtTouchEndEventListenerToken||(this._revertAtTouchEndEventListenerToken=a.addEventListener("touchend",function(){b._settings.getSetting("revertAtMouseUp")&&b.resetPositionAndTarget({duration:b._settings.getSetting("revertAtMouseUpDuration")})},this._detect_it.passiveEvents?{capture:!1,passive:!0}:!1));if(!this._revertAtMouseWheelEventListenerToken){var c=
0,d=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";this._revertAtMouseWheelEventListenerToken=a.addEventListener(d,function(){clearTimeout(c);b._settings.getSetting("revertAtMouseUp")&&(c=setTimeout(function(){b.resetPositionAndTarget({duration:b._settings.getSetting("revertAtMouseUpDuration")})},300))},this._detect_it.passiveEvents?{capture:!1,passive:!0}:!1)}return!0},revertAtMouseUpDuration:function(a){return!0},zoomExtentsFactor:function(a){return!0},defaults:function(a){return this._settings.updateSetting("defaults.perspective",
a.perspective)&&this._settings.updateSetting("defaults.orthographic",a.orthographic)},"defaults.perspective.position":function(a){return this._settings.updateSetting("cameraTypes.perspective.default.position",a)},"defaults.perspective.target":function(a){return this._settings.updateSetting("cameraTypes.perspective.default.target",a)},"defaults.perspective":function(a){5===a.position.x&&5===a.position.y&&5===a.position.z&&0===a.target.x&&0===a.target.y&&0===a.target.z&&(a.position={x:0,y:0,z:0});return this._settings.updateSetting("cameraTypes.perspective.default",
a)},"defaults.orthographic.position":function(a){return this._settings.updateSetting("cameraTypes.orthographic.default.position",a)},"defaults.orthographic.target":function(a){return this._settings.updateSetting("cameraTypes.orthographic.default.target",a)},"defaults.orthographic":function(a){5===a.position.x&&5===a.position.y&&5===a.position.z&&0===a.target.x&&0===a.target.y&&0===a.target.z&&(a.position={x:0,y:0,z:0});return this._settings.updateSetting("cameraTypes.orthographic.default",a)},fov:function(a){return this._settings.updateSetting("cameraTypes.perspective.fov",
a)},type:function(a){return this._settings.updateSetting("cameraTypes.active",a)},autoRotationSpeed:function(a){return this._settings.updateSetting("controls.orbit.autoRotationSpeed",a)},damping:function(a){return this._settings.updateSetting("controls.orbit.damping",a)},enableAutoRotation:function(a){return this._settings.updateSetting("controls.orbit.enableAutoRotation",a)},enableKeyPan:function(a){return this._settings.updateSetting("controls.orbit.enableKeyPan",a)},enablePan:function(a){return this._settings.updateSetting("controls.orbit.enablePan",
a)},enableRotation:function(a){return this._settings.updateSetting("controls.orbit.enableRotation",a)},enableZoom:function(a){return this._settings.updateSetting("controls.orbit.enableZoom",a)},keyPanSpeed:function(a){return this._settings.updateSetting("controls.orbit.keyPanSpeed",a)},"restrictions.position.cube.min":function(a){return this._settings.updateSetting("controls.orbit.restrictions.position.cube.min",a)},"restrictions.position.cube.max":function(a){return this._settings.updateSetting("controls.orbit.restrictions.position.cube.max",
a)},"restrictions.position.cube":function(a){return this._settings.updateSetting("controls.orbit.restrictions.position.cube",a)},"restrictions.position.sphere.center":function(a){return this._settings.updateSetting("controls.orbit.restrictions.position.sphere.center",a)},"restrictions.position.sphere.radius":function(a){return this._settings.updateSetting("controls.orbit.restrictions.position.sphere.radius",a)},"restrictions.position.sphere":function(a){return this._settings.updateSetting("controls.orbit.restrictions.position.sphere",
a)},"restrictions.target.cube.min":function(a){return this._settings.updateSetting("controls.orbit.restrictions.target.cube.min",a)},"restrictions.target.cube.max":function(a){return this._settings.updateSetting("controls.orbit.restrictions.target.cube.max",a)},"restrictions.target.cube":function(a){return this._settings.updateSetting("controls.orbit.restrictions.target.cube",a)},"restrictions.target.sphere.center":function(a){return this._settings.updateSetting("controls.orbit.restrictions.target.sphere.center",
a)},"restrictions.target.sphere.radius":function(a){return this._settings.updateSetting("controls.orbit.restrictions.target.sphere.radius",a)},"restrictions.target.sphere":function(a){return this._settings.updateSetting("controls.orbit.restrictions.target.sphere",a)},"restrictions.rotation.minPolarAngle":function(a){return this._settings.updateSetting("controls.orbit.restrictions.rotation.minPolarAngle",a)},"restrictions.rotation.maxPolarAngle":function(a){return this._settings.updateSetting("controls.orbit.restrictions.rotation.maxPolarAngle",
a)},"restrictions.rotation.minAzimuthAngle":function(a){return this._settings.updateSetting("controls.orbit.restrictions.rotation.minAzimuthAngle",a)},"restrictions.rotation.maxAzimuthAngle":function(a){return this._settings.updateSetting("controls.orbit.restrictions.rotation.maxAzimuthAngle",a)},"restrictions.rotation":function(a){return this._settings.updateSetting("controls.orbit.restrictions.rotation",a)},"restrictions.zoom.minDistance":function(a){return this._settings.updateSetting("controls.orbit.restrictions.zoom.minDistance",
a)},"restrictions.zoom.maxDistance":function(a){return this._settings.updateSetting("controls.orbit.restrictions.zoom.maxDistance",a)},"restrictions.zoom":function(a){return this._settings.updateSetting("controls.orbit.restrictions.zoom",a)},rotationSpeed:function(a){return this._settings.updateSetting("controls.orbit.rotationSpeed",a)},panSpeed:function(a){return this._settings.updateSetting("controls.orbit.panSpeed",a)},zoomSpeed:function(a){return this._settings.updateSetting("controls.orbit.zoomSpeed",
a)}};
module$src$3d$viewport$handlers$camera$hooks$CameraHooksAndNotifiers.default.CameraNotifiers={zoomExtentsFactor:function(){var a=module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary.getInstance(this._handlers.threeDManager.viewerApi.getSetting("viewerRuntimeId"));a.firstTimeVisible.resolved&&a.settingsLoaded.resolved&&this._active&&this.zoomExtents()},"cameraTypes.active":function(){return this._settings.forceSetting("type",this._settings.getSetting("cameraTypes.active"))},"cameraTypes.perspective.default.position":function(){return this._settings.forceSetting("defaults.perspective.position",
this._settings.getSetting("cameraTypes.perspective.default.position"))},"cameraTypes.perspective.default.target":function(){return this._settings.forceSetting("defaults.perspective.target",this._settings.getSetting("cameraTypes.perspective.default.target"))},"cameraTypes.perspective.default":function(){return this._settings.forceSetting("defaults.perspective",this._settings.getSetting("cameraTypes.perspective.default"))},"cameraTypes.orthographic.default.position":function(){return this._settings.forceSetting("defaults.orthographic.position",
this._settings.getSetting("cameraTypes.orthographic.default.position"))},"cameraTypes.orthographic.default.target":function(){return this._settings.forceSetting("defaults.orthographic.target",this._settings.getSetting("cameraTypes.orthographic.default.target"))},"cameraTypes.orthographic.default":function(){return this._settings.forceSetting("defaults.orthographic",this._settings.getSetting("cameraTypes.orthographic.default"))},"cameraTypes.perspective.fov":function(){return this._settings.forceSetting("fov",
this._settings.getSetting("cameraTypes.perspective.fov"))},"controls.orbit.autoRotationSpeed":function(){return this._settings.forceSetting("autoRotationSpeed",this._settings.getSetting("controls.orbit.autoRotationSpeed"))},"controls.orbit.damping":function(){return this._settings.forceSetting("damping",this._settings.getSetting("controls.orbit.damping"))},"controls.orbit.controls.orbit.enableAutoRotation":function(){return this._settings.forceSetting("enableAutoRotation",this._settings.getSetting("controls.orbit.enableAutoRotation"))},
"controls.orbit.enableKeyPan":function(){return this._settings.forceSetting("enableKeyPan",this._settings.getSetting("controls.orbit.enableKeyPan"))},"controls.orbit.enablePan":function(){return this._settings.forceSetting("enablePan",this._settings.getSetting("controls.orbit.enablePan"))},"controls.orbit.enableRotation":function(){return this._settings.forceSetting("enableRotation",this._settings.getSetting("controls.orbit.enableRotation"))},"controls.orbit.enableZoom":function(){return this._settings.forceSetting("enableZoom",
this._settings.getSetting("controls.orbit.enableZoom"))},"controls.orbit.keyPanSpeed":function(){return this._settings.forceSetting("keyPanSpeed",this._settings.getSetting("controls.orbit.keyPanSpeed"))},"controls.orbit.restrictions.position.cube.min":function(){return this._settings.forceSetting("restrictions.position.cube.min",this._settings.getSetting("controls.orbit.restrictions.position.cube.min"))},"controls.orbit.restrictions.position.cube.max":function(){return this._settings.forceSetting("restrictions.position.cube.max",
this._settings.getSetting("controls.orbit.restrictions.position.cube.max"))},"controls.orbit.restrictions.position.cube":function(){return this._settings.forceSetting("restrictions.position.cube",this._settings.getSetting("controls.orbit.restrictions.position.cube"))},"controls.orbit.restrictions.position.sphere.center":function(){return this._settings.forceSetting("restrictions.position.sphere.center",this._settings.getSetting("controls.orbit.restrictions.position.sphere.center"))},"controls.orbit.restrictions.position.sphere.radius":function(){return this._settings.forceSetting("restrictions.position.sphere.radius",
this._settings.getSetting("controls.orbit.restrictions.position.sphere.radius"))},"controls.orbit.restrictions.position.sphere":function(){return this._settings.forceSetting("restrictions.position.sphere",this._settings.getSetting("controls.orbit.restrictions.position.sphere"))},"controls.orbit.restrictions.target.cube.min":function(){return this._settings.forceSetting("restrictions.target.cube.min",this._settings.getSetting("controls.orbit.restrictions.target.cube.min"))},"controls.orbit.restrictions.target.cube.max":function(){return this._settings.forceSetting("restrictions.target.cube.max",
this._settings.getSetting("controls.orbit.restrictions.target.cube.max"))},"controls.orbit.restrictions.target.cube":function(){return this._settings.forceSetting("restrictions.target.cube",this._settings.getSetting("controls.orbit.restrictions.target.cube"))},"controls.orbit.restrictions.target.sphere.center":function(){return this._settings.forceSetting("restrictions.target.sphere.center",this._settings.getSetting("controls.orbit.restrictions.target.sphere.center"))},"controls.orbit.restrictions.target.sphere.radius":function(){return this._settings.forceSetting("restrictions.target.sphere.radius",
this._settings.getSetting("controls.orbit.restrictions.target.sphere.radius"))},"controls.orbit.restrictions.target.sphere":function(){return this._settings.forceSetting("restrictions.target.sphere",this._settings.getSetting("controls.orbit..restrictions.target.sphere"))},"controls.orbit.restrictions.rotation.minPolarAngle":function(){return this._settings.forceSetting("restrictions.rotation.minPolarAngle",this._settings.getSetting("controls.orbit.restrictions.rotation.minPolarAngle"))},"controls.orbit.restrictions.rotation.maxPolarAngle":function(){return this._settings.forceSetting("restrictions.rotation.maxPolarAngle",
this._settings.getSetting("controls.orbit.restrictions.rotation.maxPolarAngle"))},"controls.orbit.restrictions.rotation.minAzimuthAngle":function(){return this._settings.forceSetting("restrictions.rotation.minAzimuthAngle",this._settings.getSetting("controls.orbit.restrictions.rotation.minAzimuthAngle"))},"controls.orbit.restrictions.rotation.maxAzimuthAngle":function(){return this._settings.forceSetting("restrictions.rotation.maxAzimuthAngle",this._settings.getSetting("controls.orbit.restrictions.rotation.maxAzimuthAngle"))},
"controls.orbit.restrictions.rotation":function(){return this._settings.forceSetting("restrictions.rotation",this._settings.getSetting("controls.orbit.restrictions.rotation"))},"controls.orbit.restrictions.zoom.minDistance":function(){return this._settings.forceSetting("restrictions.zoom.minDistance",this._settings.getSetting("controls.orbit.restrictions.zoom.minDistance"))},"controls.orbit.restrictions.zoom.maxDistance":function(){return this._settings.forceSetting("restrictions.zoom.maxDistance",
this._settings.getSetting("controls.orbit.restrictions.zoom.maxDistance"))},"controls.orbit.restrictions.zoom":function(){return this._settings.forceSetting("restrictions.zoom",this._settings.getSetting("controls.orbit.restrictions.zoom"))},"controls.orbit.rotationSpeed":function(){return this._settings.forceSetting("rotationSpeed",this._settings.getSetting("controls.orbit.rotationSpeed"))},"controls.orbit.panSpeed":function(){return this._settings.forceSetting("panSpeed",this._settings.getSetting("controls.orbit.panSpeed"))},
"controls.orbit.zoomSpeed":function(){return this._settings.forceSetting("zoomSpeed",this._settings.getSetting("controls.orbit.zoomSpeed"))}};var module$src$3d$viewport$handlers$camera$BaseCameraHandler={default:{}},__importDefault$$module$src$3d$viewport$handlers$camera$BaseCameraHandler=this&&module$src$3d$viewport$handlers$camera$BaseCameraHandler.default.__importDefault||function(a){return a&&a.__esModule?a:{"default":a}};Object.defineProperty(module$src$3d$viewport$handlers$camera$BaseCameraHandler.default,"__esModule",{value:!0});
var THREE$$module$src$3d$viewport$handlers$camera$BaseCameraHandler=module$src$externals$three.default,MessagingConstants_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler=__importDefault$$module$src$3d$viewport$handlers$camera$BaseCameraHandler(module$src$shared$constants$MessagingConstants.default),MessagePrototype_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler=__importDefault$$module$src$3d$viewport$handlers$camera$BaseCameraHandler(module$src$shared$messages$MessagePrototype.default),
GlobalUtils_js_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler=__importDefault$$module$src$3d$viewport$handlers$camera$BaseCameraHandler(module$src$shared$util$GlobalUtils.default),detect_it_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler=__importDefault$$module$src$3d$viewport$handlers$camera$BaseCameraHandler(module$node_modules$detect_it$lib$index.default),HooksAndNotifiers_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler=module$src$3d$viewport$helpers$HooksAndNotifiers.default,
CameraHooksAndNotifiers_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler=module$src$3d$viewport$handlers$camera$hooks$CameraHooksAndNotifiers.default,StateDashboard_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler=module$src$modules$shapediver_state_dashboard$StateDashboard.default;
module$src$3d$viewport$handlers$camera$BaseCameraHandler.default.BaseCameraHandler=function(){function a(a,c){this._handlers=c;this._active=!0;this._cameraMatrix=new module$src$externals$three.default.Matrix4;this._eventListenerCounter=0;this.TWEEN_ID=this.CAMERA_MOVING_ID="cameraMoving";this._detect_it=detect_it_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler.default;this._globalUtils=GlobalUtils_js_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler.default;this._settings=a.settings;
this._geometryNode=a.geometryNode;this._container=a.container;this._sceneBS=new module$src$externals$three.default.Sphere(new module$src$externals$three.default.Vector3,1);this._firstTimeVisible=module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary.getInstance(c.threeDManager.viewerApi.getSetting("viewerRuntimeId")).firstTimeVisible;module$src$3d$viewport$helpers$HooksAndNotifiers.default.registerHooksAndNotifiers(this,this._settings,module$src$3d$viewport$handlers$camera$hooks$CameraHooksAndNotifiers.default.CameraHooks,
module$src$3d$viewport$handlers$camera$hooks$CameraHooksAndNotifiers.default.CameraNotifiers)}Object.defineProperty(a.prototype,"camera",{get:function(){return this._camera},enumerable:!0,configurable:!0});a.prototype.decreaseEventListenerCounter=function(){this._eventListenerCounter--};a.prototype.destroy=function(){};a.prototype.getPositionAndTarget=function(){return{position:this._globalUtils.deepCopy(this._cameraControls.position),target:this._globalUtils.deepCopy(this._cameraControls.target)}};
a.prototype.increaseEventListenerCounter=function(){this._eventListenerCounter++};a.prototype.pause=function(){this._active=!1;this._cameraControls.enabled=!1};a.prototype.resume=function(){this._active=!0;this._camera.updateProjectionMatrix();this._cameraControls.enabled=this._settings.getSetting("enableCameraControls");this._cameraControls.reset()};a.prototype.setViewAndProjectionMatrix=function(a,c){this._cameraMatrix.getInverse(a);this._cameraMatrix.decompose(this._camera.position,this._camera.quaternion,
this._camera.scale);this._camera.projectionMatrix.copy(c)};a.prototype.updateCameraControls=function(a){this._settings.getSetting("enableCameraControls")&&(this._cameraControls.update(a),this._handlers.renderingHandler.unregisterForContinuousRendering(this.CAMERA_MOVING_ID),this._cameraControls.isMoving()&&this._handlers.renderingHandler.registerForContinuousRendering(this.CAMERA_MOVING_ID,!1))};a.prototype.cameraMovementEventDispatch=function(a,c,d){if(0!==this._eventListenerCounter){if(a)if(c)var b=
MessagingConstants_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler.default.messageTopics.SCENE_CAMERA_MOVE;else d=0,b=MessagingConstants_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler.default.messageTopics.SCENE_CAMERA_START;else c&&(b=MessagingConstants_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler.default.messageTopics.SCENE_CAMERA_END);a=new MessagePrototype_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler.default(MessagingConstants_1$$module$src$3d$viewport$handlers$camera$BaseCameraHandler.default.messageDataTypes.SCENE_CAMERA,
{type:b,cameraDefinition:{position:this._cameraControls.position,target:this._cameraControls.target},duration:d});this._handlers.threeDManager.message(b,a)}};return a}();var module$src$3d$viewport$handlers$camera$controls$fps$FPSLogic={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$fps$FPSLogic.default,"__esModule",{value:!0});var THREE$$module$src$3d$viewport$handlers$camera$controls$fps$FPSLogic=module$src$externals$three.default;
module$src$3d$viewport$handlers$camera$controls$fps$FPSLogic.default.FPSLogic=function(){function a(a){this._controls=a;this._keysPressed=[]}a.prototype.move=function(a){this._keysPressed=a;this._controls.applyPositionMatrix(new module$src$externals$three.default.Matrix4,!0);this._controls.applyTargetMatrix(new module$src$externals$three.default.Matrix4,!0)};a.prototype.reset=function(){this._keysPressed=[]};a.prototype.rotate=function(a,c){var b=new module$src$externals$three.default.Vector3;this._controls.camera.getWorldDirection(b);
b.normalize();var e=(new module$src$externals$three.default.Vector3).crossVectors(this._controls.camera.up,b).normalize(),f=(new module$src$externals$three.default.Vector3).crossVectors(e,b).normalize(),h=this._controls.position,g=this._controls.target,k=h.distanceTo(g);b=b.clone();b.applyAxisAngle(f,Math.PI/180*a*.1);b.applyAxisAngle(e,Math.PI/180*c*.1);a=h.clone().add(b.multiplyScalar(k)).clone().sub(g);this._controls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,
a.y,a.z),!0)};a.prototype.update=function(a){var b=0,d=0,e=0;-1!==this._keysPressed.indexOf("w")&&d++;-1!==this._keysPressed.indexOf("a")&&b++;-1!==this._keysPressed.indexOf("s")&&d--; -1!==this._keysPressed.indexOf("d")&&b--; -1!==this._keysPressed.indexOf("shift")&&e--; -1!==this._keysPressed.indexOf("control")&&e++;if((0!==b||0!==d||0!==e)&&a){a/=16.6666;var f=new module$src$externals$three.default.Vector3;this._controls.camera.getWorldDirection(f);f.normalize();var h=(new module$src$externals$three.default.Vector3).crossVectors(this._controls.camera.up,
f).normalize(),g=(new module$src$externals$three.default.Vector3).crossVectors(h,f).normalize();d=f.clone().multiplyScalar(a*d*.5);d.add(h.clone().multiplyScalar(a*b*.5));d.add(g.clone().multiplyScalar(a*e*.5));this._controls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(d.x,d.y,d.z),!0);this._controls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(d.x,d.y,d.z),!0)}};return a}();var module$src$3d$viewport$handlers$camera$controls$fps$FPSManager={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$fps$FPSManager.default,"__esModule",{value:!0});var FPSLogic_1$$module$src$3d$viewport$handlers$camera$controls$fps$FPSManager=module$src$3d$viewport$handlers$camera$controls$fps$FPSLogic.default;
module$src$3d$viewport$handlers$camera$controls$fps$FPSManager.default.FPSManager=function(){function a(a,c,d,e){var b=this;this._settings=a;this._cameraControls=c;this._triggerRender=d;this._logWarning=e;this._activeLock=!1;this._keysPressed=[];this._storedSettings={};this._cameraLogic=new module$src$3d$viewport$handlers$camera$controls$fps$FPSLogic.default.FPSLogic(this._cameraControls);document.addEventListener("pointerlockchange",function(a){b._activeLock=!b._activeLock},!1);document.addEventListener("keyup",
function(a){a=b._keysPressed.indexOf(a.key.toLowerCase());-1<a&&(b._keysPressed.splice(a,1),b._cameraLogic.move(b._keysPressed))});this._cameraControls.registerCameraControls(this)}a.prototype.isWithinRestrictions=function(a,c){return!0};a.prototype.onKeyDown=function(a){-1===this._keysPressed.indexOf(a.key.toLowerCase())&&(this._keysPressed.push(a.key.toLowerCase()),this._cameraLogic.move(this._keysPressed))};a.prototype.onMouseDown=function(a){a.srcElement instanceof Element&&(!1===this._activeLock?
a.srcElement.requestPointerLock():document.exitPointerLock())};a.prototype.onMouseMove=function(a){!0===this._activeLock&&this._cameraLogic.rotate(a.movementX,a.movementY)};a.prototype.onMouseUp=function(a){};a.prototype.onMouseWheel=function(a){};a.prototype.onTouchEnd=function(a){};a.prototype.onTouchMove=function(a){};a.prototype.onTouchStart=function(a){};a.prototype.reset=function(){this._keysPressed=[];this._cameraLogic.reset()};a.prototype.restrict=function(a,c){return{position:a,target:c}};
a.prototype.update=function(a){this._cameraLogic.update(a)};return a}();var module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsEventDistribution={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsEventDistribution.default,"__esModule",{value:!0});
module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsEventDistribution.default.OrbitControlsEventDistribution=function(){function a(a,c,d){this._settings=a;this._controls=c;this._cameraLogic=d;this._active={rotation:!1,zoom:!1,pan:!1}}a.prototype.onDown=function(a){var b=this.convertInput(a),d=b.x;b=b.y;var e=a instanceof TouchEvent?a.touches.length:a.button,f=a instanceof TouchEvent?this._settings.getSetting("input").touch:this._settings.getSetting("input").mouse;e===f.rotate&&this._settings.getSetting("enableRotation")&&
(this._cameraLogic.rotate(d,b,this._active.rotation,a instanceof TouchEvent),this._active.rotation=!0,this._active.pan=!1,this._active.zoom=!1);e===f.pan&&this._settings.getSetting("enablePan")&&(this._cameraLogic.pan(d,b,this._active.pan,a instanceof TouchEvent),this._active.rotation=!1,this._active.pan=!0,this._active.zoom=!1);e===f.zoom&&this._settings.getSetting("enableZoom")&&(a instanceof TouchEvent&&2===this._settings.getSetting("input").touch.zoom&&(d=(a.touches[0].pageX-a.touches[1].pageX)/
window.innerWidth*(window.innerWidth/window.innerHeight),b=(a.touches[0].pageY-a.touches[1].pageY)/window.innerHeight),this._cameraLogic.zoom(d,b,this._active.zoom,a instanceof TouchEvent),this._active.rotation=!1,this._active.pan=!1,this._active.zoom=!0)};a.prototype.onKey=function(a){if(this._settings.getSetting("enableKeyPan"))switch(a.keyCode){case this._settings.getSetting("input").keys.up:this._cameraLogic.pan(0,0,!1,!1);this._cameraLogic.pan(0,.05*this._settings.getSetting("keyPanSpeed"),!0,
!1);a.preventDefault();a.stopPropagation();break;case this._settings.getSetting("input").keys.down:this._cameraLogic.pan(0,0,!1,!1);this._cameraLogic.pan(0,.05*-this._settings.getSetting("keyPanSpeed"),!0,!1);a.preventDefault();a.stopPropagation();break;case this._settings.getSetting("input").keys.left:this._cameraLogic.pan(0,0,!1,!1);this._cameraLogic.pan(.05*this._settings.getSetting("keyPanSpeed"),0,!0,!1);a.preventDefault();a.stopPropagation();break;case this._settings.getSetting("input").keys.right:this._cameraLogic.pan(0,
0,!1,!1),this._cameraLogic.pan(.05*-this._settings.getSetting("keyPanSpeed"),0,!0,!1),a.preventDefault(),a.stopPropagation()}};a.prototype.onKeyDown=function(a){this.onKey(a)};a.prototype.onMouseDown=function(a){this.onDown(a)};a.prototype.onMouseMove=function(a){this.onMove(a)};a.prototype.onMouseUp=function(a){this.onUp(a)};a.prototype.onMouseWheel=function(a){this.onWheel(a)};a.prototype.onMove=function(a){var b=this.convertInput(a),d=b.x;b=b.y;this._settings.getSetting("enableRotation")&&this._active.rotation&&
this._cameraLogic.rotate(d,b,this._active.rotation,a instanceof TouchEvent);this._settings.getSetting("enablePan")&&this._active.pan&&this._cameraLogic.pan(d,b,this._active.pan,a instanceof TouchEvent);this._settings.getSetting("enableZoom")&&this._active.zoom&&(a instanceof TouchEvent&&2===this._settings.getSetting("input").touch.zoom&&(d=(a.touches[0].pageX-a.touches[1].pageX)/window.innerWidth*(window.innerWidth/window.innerHeight),b=(a.touches[0].pageY-a.touches[1].pageY)/window.innerHeight),
this._cameraLogic.zoom(d,b,this._active.zoom,a instanceof TouchEvent))};a.prototype.onTouchEnd=function(a){this.onUp(a)};a.prototype.onTouchMove=function(a){this.onMove(a)};a.prototype.onTouchStart=function(a){this.onDown(a)};a.prototype.onUp=function(a){this._active.rotation=!1;this._active.zoom=!1;this._active.pan=!1};a.prototype.onWheel=function(a){if(this._settings.getSetting("enableZoom")){var b=0;void 0!==a.deltaY?b=-a.deltaY:void 0!==a.detail&&(b=-a.detail);0<Math.sign(b)?(this._cameraLogic.zoom(0,
0,!1,!1),this._cameraLogic.zoom(1,0,!0,!1)):(this._cameraLogic.zoom(1,0,!1,!1),this._cameraLogic.zoom(0,0,!0,!1))}};a.prototype.reset=function(){this._active={rotation:!1,zoom:!1,pan:!1}};a.prototype.convertInput=function(a){var b=window.innerWidth/window.innerHeight;return a instanceof MouseEvent?{x:a.clientX/window.innerWidth*b,y:a.clientY/window.innerHeight}:{x:a.touches[0].pageX/window.innerWidth*b,y:a.touches[0].pageY/window.innerHeight}};return a}();var module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsLogic={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsLogic.default,"__esModule",{value:!0});var THREE$$module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsLogic=module$src$externals$three.default;
module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsLogic.default.OrbitControlsLogic=function(){function a(a,c){var b=this;this._settings=a;this._controls=c;this._damping={rotation:{time:0,duration:0,theta:0,phi:0},zoom:{time:0,duration:0,delta:0},pan:{time:0,duration:0,offset:new module$src$externals$three.default.Vector3}};this._dollyStart=this._dollyEnd=this._dollyDelta=0;this._panDelta=new module$src$externals$three.default.Vector2;this._panEnd=new module$src$externals$three.default.Vector2;
this._panStart=new module$src$externals$three.default.Vector2;this._rotateDelta=new module$src$externals$three.default.Vector2;this._rotateEnd=new module$src$externals$three.default.Vector2;this._rotateStart=new module$src$externals$three.default.Vector2;this._settingsAdjustements={autoRotationSpeed:2*Math.PI/60/60,damping:1,movementSmoothness:1,panSpeed:2,rotationSpeed:Math.PI,zoomSpeed:.025};this._touchAdjustements={autoRotationSpeed:1,damping:1,movementSmoothness:1,panSpeed:1.5,rotationSpeed:2,
zoomSpeed:100};this._quat=(new module$src$externals$three.default.Quaternion).setFromUnitVectors(new module$src$externals$three.default.Vector3(0,0,1),new module$src$externals$three.default.Vector3(0,1,0));this._quatInverse=this._quat.clone().inverse();this._adjustedSettings={autoRotationSpeed:this._settings.getSetting("autoRotationSpeed")*this._settingsAdjustements.autoRotationSpeed,damping:this._settings.getSetting("damping")*this._settingsAdjustements.damping,movementSmoothness:this._settings.getSetting("movementSmoothness")*
this._settingsAdjustements.movementSmoothness,panSpeed:this._settings.getSetting("panSpeed")*this._settingsAdjustements.panSpeed,rotationSpeed:this._settings.getSetting("rotationSpeed")*this._settingsAdjustements.rotationSpeed,zoomSpeed:this._settings.getSetting("zoomSpeed")*this._settingsAdjustements.zoomSpeed};Object.keys(this._adjustedSettings).forEach(function(a){b._settings.registerHook(a,function(c){b._adjustedSettings[a]=c*b._settingsAdjustements[a];return!0})})}a.prototype.isWithinRestrictions=
function(a,c){var b=this._settings.getSetting("restrictions.position.cube"),e=this._settings.getSetting("restrictions.position.sphere");b=new module$src$externals$three.default.Box3(new module$src$externals$three.default.Vector3(b.min.x,b.min.y,b.min.z),new module$src$externals$three.default.Vector3(b.max.x,b.max.y,b.max.z));e=new module$src$externals$three.default.Sphere(new module$src$externals$three.default.Vector3(e.center.x,e.center.y,e.center.z),e.radius);var f=this._settings.getSetting("restrictions.target.cube"),
h=this._settings.getSetting("restrictions.target.sphere");f=new module$src$externals$three.default.Box3(new module$src$externals$three.default.Vector3(f.min.x,f.min.y,f.min.z),new module$src$externals$three.default.Vector3(f.max.x,f.max.y,f.max.z));h=new module$src$externals$three.default.Sphere(new module$src$externals$three.default.Vector3(h.center.x,h.center.y,h.center.z),h.radius);if(!(b.containsPoint(a)&&e.containsPoint(a)&&f.containsPoint(c)&&h.containsPoint(c)))return!1;b=a.distanceTo(c);if(b>
this._settings.getSetting("restrictions.zoom.maxDistance")||b<this._settings.getSetting("restrictions.zoom.minDistance"))return!1;b=this._settings.getSetting("restrictions.rotation.minPolarAngle")*(Math.PI/180);e=this._settings.getSetting("restrictions.rotation.maxPolarAngle")*(Math.PI/180);h=this._settings.getSetting("restrictions.rotation.minAzimuthAngle")*(Math.PI/180);f=this._settings.getSetting("restrictions.rotation.maxAzimuthAngle")*(Math.PI/180);if(-Infinity!==h||Infinity!==f||0!==b||180!==
e){var g=new module$src$externals$three.default.Vector3;g.copy(a).sub(c);g.applyQuaternion(this._quat);a=(new module$src$externals$three.default.Spherical).setFromVector3(g);if(a.theta<h||a.theta>f||a.phi<b||a.phi>e)return!1}return!0};a.prototype.pan=function(a,c,d,e){e&&(a/=window.devicePixelRatio,c/=window.devicePixelRatio);if(d){if(this._panEnd.set(a,c),this._panDelta.subVectors(this._panEnd,this._panStart),0!==this._panDelta.x||0!==this._panDelta.y)this._panStart.copy(this._panEnd),a=this.panDeltaToOffset(this._panDelta.multiplyScalar(this._adjustedSettings.panSpeed*
(e?this._touchAdjustements.panSpeed:1))),0<this._damping.pan.duration&&(a.x=0>a.x?Math.min(a.x,this._adjustedSettings.movementSmoothness*this._damping.pan.offset.x):Math.max(a.x,this._adjustedSettings.movementSmoothness*this._damping.pan.offset.x),a.y=0>a.y?Math.min(a.y,this._adjustedSettings.movementSmoothness*this._damping.pan.offset.y):Math.max(a.y,this._adjustedSettings.movementSmoothness*this._damping.pan.offset.y),a.z=0>a.z?Math.min(a.z,this._adjustedSettings.movementSmoothness*this._damping.pan.offset.z):
Math.max(a.z,this._adjustedSettings.movementSmoothness*this._damping.pan.offset.z)),e=1-Math.max(.01,Math.min(1,this._adjustedSettings.damping)),c=(Math.log(1/Math.abs(a.x))-5*Math.log(10))/Math.log(e),d=(Math.log(1/Math.abs(a.y))-5*Math.log(10))/Math.log(e),e=(Math.log(1/Math.abs(a.z))-5*Math.log(10))/Math.log(e),this._damping.pan.time=0,this._damping.pan.duration=16.6666*Math.max(c,Math.max(d,e)),this._damping.pan.offset=a.clone(),this._damping.rotation.duration=0,this._damping.zoom.duration=0,
this._controls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z),!0),this._controls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z),!0)}else this._panStart.set(a,c)};a.prototype.reset=function(){this._damping={rotation:{time:0,duration:0,theta:0,phi:0},zoom:{time:0,duration:0,delta:0},pan:{time:0,duration:0,offset:new module$src$externals$three.default.Vector3}};this._dollyStart=this._dollyEnd=this._dollyDelta=
0;this._panDelta=new module$src$externals$three.default.Vector2;this._panEnd=new module$src$externals$three.default.Vector2;this._panStart=new module$src$externals$three.default.Vector2;this._rotateDelta=new module$src$externals$three.default.Vector2;this._rotateEnd=new module$src$externals$three.default.Vector2;this._rotateStart=new module$src$externals$three.default.Vector2};a.prototype.restrict=function(a,c){var b=this._settings.getSetting("restrictions.position.cube"),e=this._settings.getSetting("restrictions.position.sphere");
b=new module$src$externals$three.default.Box3(new module$src$externals$three.default.Vector3(b.min.x,b.min.y,b.min.z),new module$src$externals$three.default.Vector3(b.max.x,b.max.y,b.max.z));e=new module$src$externals$three.default.Sphere(new module$src$externals$three.default.Vector3(e.center.x,e.center.y,e.center.z),e.radius);b.containsPoint(a)||b.clampPoint(a,a);e.containsPoint(a)||e.clampPoint(a,a);b=this._settings.getSetting("restrictions.target.cube");e=this._settings.getSetting("restrictions.target.sphere");
b=new module$src$externals$three.default.Box3(new module$src$externals$three.default.Vector3(b.min.x,b.min.y,b.min.z),new module$src$externals$three.default.Vector3(b.max.x,b.max.y,b.max.z));e=new module$src$externals$three.default.Sphere(new module$src$externals$three.default.Vector3(e.center.x,e.center.y,e.center.z),e.radius);b.containsPoint(c)||b.clampPoint(c,c);e.containsPoint(c)||e.clampPoint(c,c);b=a.distanceTo(c);if(b>this._settings.getSetting("restrictions.zoom.maxDistance")||b<this._settings.getSetting("restrictions.zoom.minDistance"))e=
new module$src$externals$three.default.Vector3,e.copy(a).sub(c).normalize(),a=Math.max(this._settings.getSetting("restrictions.zoom.minDistance"),Math.min(this._settings.getSetting("restrictions.zoom.maxDistance"),b)),a=c.clone().add(e.multiplyScalar(a));e=this._settings.getSetting("restrictions.rotation.minPolarAngle")*(Math.PI/180);b=this._settings.getSetting("restrictions.rotation.maxPolarAngle")*(Math.PI/180);var f=this._settings.getSetting("restrictions.rotation.minAzimuthAngle")*(Math.PI/180),
h=this._settings.getSetting("restrictions.rotation.maxAzimuthAngle")*(Math.PI/180);if(-Infinity!==f||Infinity!==h||0!==e||180!==b){var g=new module$src$externals$three.default.Vector3;g.copy(a).sub(c);g.applyQuaternion(this._quat);var k=(new module$src$externals$three.default.Spherical).setFromVector3(g);if(k.theta<f||k.theta>h||k.phi<e||k.phi>b)k.theta=Math.max(f,Math.min(h,k.theta)),k.phi=Math.max(e,Math.min(b,k.phi)),k.makeSafe(),g.setFromSpherical(k),g.applyQuaternion(this._quatInverse),a=g.add(c)}return{position:a,
target:c}};a.prototype.rotate=function(a,c,d,e){e&&(a/=window.devicePixelRatio,c/=window.devicePixelRatio);d?(this._rotateEnd.set(a,c),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart),this._rotateStart.copy(this._rotateEnd),0!=this._controls.domElement.clientWidth&&0!=this._controls.domElement.clientHeight&&(a=new module$src$externals$three.default.Spherical,e=this._adjustedSettings.rotationSpeed*(e?this._touchAdjustements.rotationSpeed:1),a.theta-=e*this._rotateDelta.x,a.phi-=e*this._rotateDelta.y,
0<this._damping.rotation.duration&&(a.theta+=(this._damping.rotation.theta-a.theta)*this._adjustedSettings.movementSmoothness,a.phi+=(this._damping.rotation.phi-a.phi)*this._adjustedSettings.movementSmoothness),e=this.rotationSphericalToOffset(a),d=1-Math.max(.01,Math.min(1,this._adjustedSettings.damping)),c=(Math.log(1/Math.abs(a.theta))-5*Math.log(10))/Math.log(d),d=(Math.log(1/Math.abs(a.phi))-5*Math.log(10))/Math.log(d),this._damping.rotation.time=0,this._damping.rotation.duration=16.6666*Math.max(c,
d),this._damping.rotation.theta=a.theta,this._damping.rotation.phi=a.phi,this._damping.pan.duration=0,this._damping.zoom.duration=0,this._controls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(e.x,e.y,e.z),!0))):this._rotateStart.set(a,c)};a.prototype.update=function(a,c){!0===c&&(this._damping.zoom.duration=0,this._damping.pan.duration=0,this._damping.rotation.duration=0);c=1-Math.max(.01,Math.min(1,this._adjustedSettings.damping));if(0<this._damping.pan.duration)if(this._damping.pan.time+
a>this._damping.pan.duration)this._damping.pan.time=this._damping.pan.duration,this._damping.pan.duration=0;else{this._damping.pan.time+=a;var b=this._damping.pan.time/16.6666;b=this._damping.pan.offset.clone().multiplyScalar(Math.pow(c,b));this._controls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(b.x,b.y,b.z));this._controls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(b.x,b.y,b.z))}else this._damping.pan.time=0;if(0<
this._damping.rotation.duration)if(this._damping.rotation.time+a>this._damping.rotation.duration)this._damping.rotation.time=this._damping.rotation.duration,this._damping.rotation.duration=0;else{this._damping.rotation.time+=a;b=this._damping.rotation.time/16.6666;var e=new module$src$externals$three.default.Spherical;e.theta=this._damping.rotation.theta*Math.pow(c,b);e.phi=this._damping.rotation.phi*Math.pow(c,b);b=this.rotationSphericalToOffset(e);this._controls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(b.x,
b.y,b.z))}else this._damping.rotation.time=0;0<this._damping.zoom.duration?this._damping.zoom.time+a>this._damping.zoom.duration?(this._damping.zoom.time=this._damping.zoom.duration,this._damping.zoom.duration=0):(this._damping.zoom.time+=a,b=this._damping.zoom.time/16.6666,b=this.zoomDistanceToOffset(this._damping.zoom.delta*Math.pow(c,b)),this._controls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(b.x,b.y,b.z))):this._damping.zoom.time=0;this._settings.getSetting("enableAutoRotation")&&
(e=new module$src$externals$three.default.Spherical(1,0,this._adjustedSettings.autoRotationSpeed),b=this.rotationSphericalToOffset(e),this._controls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(b.x,b.y,b.z)))};a.prototype.zoom=function(a,c,d,e){a=Math.sqrt(a*a+c*c);e&&(a/=window.devicePixelRatio);d?(this._dollyEnd=a,this._dollyDelta=this._dollyEnd-this._dollyStart,this._dollyStart=this._dollyEnd,0<this._damping.zoom.duration&&(this._dollyDelta=0>this._dollyDelta?
Math.min(this._dollyDelta,this._adjustedSettings.movementSmoothness*this._damping.zoom.delta):Math.max(this._dollyDelta,this._adjustedSettings.movementSmoothness*this._damping.zoom.delta)),d=-this._dollyDelta*this._adjustedSettings.zoomSpeed*(e?this._touchAdjustements.zoomSpeed:1),e=(Math.log(1/Math.abs(this._dollyDelta))-5*Math.log(10))/Math.log(1-Math.max(.01,Math.min(1,this._adjustedSettings.damping))),this._damping.zoom.time=0,this._damping.zoom.duration=16.6666*e,this._damping.zoom.delta=d,this._damping.rotation.duration=
0,this._damping.pan.duration=0,d=this.zoomDistanceToOffset(d),this._controls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(d.x,d.y,d.z),!0)):this._dollyStart=a};a.prototype.panDeltaToOffset=function(a){var b=new module$src$externals$three.default.Vector3,d=new module$src$externals$three.default.Vector3;b.copy(this._controls.getPositionWithManualUpdates()).sub(this._controls.getTargetWithManualUpdates());b=b.length();b*=Math.tan(this._controls.camera.fov/2*Math.PI/
180);var e=new module$src$externals$three.default.Vector3;e.setFromMatrixColumn(this._controls.camera.matrix,0);e.multiplyScalar(-(2*a.x*b));d.add(e);e=new module$src$externals$three.default.Vector3;e.setFromMatrixColumn(this._controls.camera.matrix,1);e.multiplyScalar(2*a.y*b);d.add(e);return d.clone()};a.prototype.rotationSphericalToOffset=function(a){var b=new module$src$externals$three.default.Vector3;b.copy(this._controls.getPositionWithManualUpdates()).sub(this._controls.getTargetWithManualUpdates());
b.applyQuaternion(this._quat);var d=(new module$src$externals$three.default.Spherical).setFromVector3(b);d.theta+=a.theta;d.phi+=a.phi;a=this._settings.getSetting("restrictions.rotation.minAzimuthAngle")*(Math.PI/180);var e=this._settings.getSetting("restrictions.rotation.maxAzimuthAngle")*(Math.PI/180);d.theta>Math.PI?(d.theta-=2*Math.PI,a>d.theta&&(d.theta+=2*Math.PI)):d.theta<-Math.PI&&(d.theta+=2*Math.PI,e<d.theta&&(d.theta-=2*Math.PI));d.makeSafe();b.setFromSpherical(d);b.applyQuaternion(this._quatInverse);
b.add(this._controls.getTargetWithManualUpdates());b.sub(this._controls.getPositionWithManualUpdates());return b.clone()};a.prototype.zoomDistanceToOffset=function(a){var b=new module$src$externals$three.default.Vector3;b.copy(this._controls.getPositionWithManualUpdates()).sub(this._controls.getTargetWithManualUpdates());return b.clone().multiplyScalar(a)};return a}();var module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsHooks={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsHooks.default,"__esModule",{value:!0});
module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsHooks.default.OrbitControlsHooks={autoRotationSpeed:function(a){if(!this._globalUtils.typeCheck(a,"float",this._logWarning,"OrbitControls.Hook->autoRotationSpeed"))return!1;0!==a?this._settings.updateSetting("enableAutoRotation",!0):this._settings.updateSetting("enableAutoRotation",!1);return!0},damping:function(a){return this._globalUtils.typeCheck(a,"notnegative",this._logWarning,"OrbitControls.Hook->damping")?!0:!1},enableAutoRotation:function(a){if(!this._globalUtils.typeCheck(a,
"boolean",this._logWarning,"OrbitControls.Hook->enableAutoRotation"))return!1;a&&this._triggerRender();return!0},enableKeyPan:function(a){return this._globalUtils.typeCheck(a,"boolean",this._logWarning,"OrbitControls.Hook->enableKeyPan")?!0:!1},enablePan:function(a){return this._globalUtils.typeCheck(a,"boolean",this._logWarning,"OrbitControls.Hook->enablePan")?!0:!1},enableRotation:function(a){return this._globalUtils.typeCheck(a,"boolean",this._logWarning,"OrbitControls.Hook->enableRotation")?!0:
!1},enableZoom:function(a){return this._globalUtils.typeCheck(a,"boolean",this._logWarning,"OrbitControls.Hook->enableZoom")?!0:!1},input:function(a){return!0},keyPanSpeed:function(a){return this._globalUtils.typeCheck(a,"number",this._logWarning,"OrbitControls.Hook->keyPanSpeed")?!0:!1},movementSmoothness:function(a){return this._globalUtils.typeCheck(a,"number",this._logWarning,"OrbitControls.Hook->movementSmoothness")?!0:!1},"restrictions.position.cube.min":function(a){var b=this._settings.getSetting("restrictions.position.cube");
b.min=a;return this._settings.updateSetting("restrictions.position.cube",b)},"restrictions.position.cube.max":function(a){var b=this._settings.getSetting("restrictions.position.cube");b.max=a;return this._settings.updateSetting("restrictions.position.cube",b)},"restrictions.position.cube":function(a){if(!this._globalUtils.typeCheck(a.min,"vector3any",this._logWarning,"OrbitControls.Hook->restrictions.position.cube")||!this._globalUtils.typeCheck(a.max,"vector3any",this._logWarning,"OrbitControls.Hook->restrictions.position.cube"))return!1;
this._triggerRender();return!0},"restrictions.position.sphere.center":function(a){var b=this._settings.getSetting("restrictions.position.sphere");b.center=a;return this._settings.updateSetting("restrictions.position.sphere",b)},"restrictions.position.sphere.radius":function(a){var b=this._settings.getSetting("restrictions.position.sphere");b.radius=a;return this._settings.updateSetting("restrictions.position.sphere",b)},"restrictions.position.sphere":function(a){if(!this._globalUtils.typeCheck(a.center,
"vector3any",this._logWarning,"OrbitControls.Hook->restrictions.position.sphere")||!this._globalUtils.typeCheck(a.radius,"notnegative",this._logWarning,"OrbitControls.Hook->restrictions.position.sphere"))return!1;this._triggerRender();return!0},"restrictions.target.cube.min":function(a){var b=this._settings.getSetting("restrictions.target.cube");b.min=a;return this._settings.updateSetting("restrictions.target.cube",b)},"restrictions.target.cube.max":function(a){var b=this._settings.getSetting("restrictions.target.cube");
b.max=a;return this._settings.updateSetting("restrictions.target.cube",b)},"restrictions.target.cube":function(a){if(!this._globalUtils.typeCheck(a.min,"vector3any",this._logWarning,"OrbitControls.Hook->restrictions.target.cube")||!this._globalUtils.typeCheck(a.max,"vector3any",this._logWarning,"OrbitControls.Hook->restrictions.target.cube"))return!1;this._triggerRender();return!0},"restrictions.target.sphere.center":function(a){var b=this._settings.getSetting("restrictions.target.sphere");b.center=
a;return this._settings.updateSetting("restrictions.target.sphere",b)},"restrictions.target.sphere.radius":function(a){var b=this._settings.getSetting("restrictions.target.sphere");b.radius=a;return this._settings.updateSetting("restrictions.target.sphere",b)},"restrictions.target.sphere":function(a){if(!this._globalUtils.typeCheck(a.center,"vector3any",this._logWarning,"OrbitControls.Hook->restrictions.target.sphere")||!this._globalUtils.typeCheck(a.radius,"notnegative",this._logWarning,"OrbitControls.Hook->restrictions.target.sphere"))return!1;
this._triggerRender();return!0},"restrictions.rotation.minPolarAngle":function(a){var b=this._settings.getSetting("restrictions.rotation");b.minPolarAngle=a;return this._settings.updateSetting("restrictions.rotation",b)},"restrictions.rotation.maxPolarAngle":function(a){var b=this._settings.getSetting("restrictions.rotation");b.maxPolarAngle=a;return this._settings.updateSetting("restrictions.rotation",b)},"restrictions.rotation.minAzimuthAngle":function(a){var b=this._settings.getSetting("restrictions.rotation");
b.minAzimuthAngle=a;return this._settings.updateSetting("restrictions.rotation",b)},"restrictions.rotation.maxAzimuthAngle":function(a){var b=this._settings.getSetting("restrictions.rotation");b.maxAzimuthAngle=a;return this._settings.updateSetting("restrictions.rotation",b)},"restrictions.rotation":function(a){if(!(this._globalUtils.typeCheck(a.minPolarAngle,"number",this._logWarning,"OrbitControls.Hook->restrictions.rotation")&&this._globalUtils.typeCheck(a.maxPolarAngle,"number",this._logWarning,
"OrbitControls.Hook->restrictions.rotation")&&this._globalUtils.typeCheck(a.minAzimuthAngle,"number",this._logWarning,"OrbitControls.Hook->restrictions.rotation")&&this._globalUtils.typeCheck(a.maxAzimuthAngle,"number",this._logWarning,"OrbitControls.Hook->restrictions.rotation")))return!1;this._triggerRender();return!0},"restrictions.zoom.minDistance":function(a){var b=this._settings.getSetting("restrictions.zoom");b.minDistance=a;return this._settings.updateSetting("restrictions.zoom",b)},"restrictions.zoom.maxDistance":function(a){var b=
this._settings.getSetting("restrictions.zoom");b.maxDistance=a;return this._settings.updateSetting("restrictions.zoom",b)},"restrictions.zoom":function(a){if(!this._globalUtils.typeCheck(a.minDistance,"number",this._logWarning,"OrbitControls.Hook->restrictions.zoom")||!this._globalUtils.typeCheck(a.maxDistance,"number",this._logWarning,"OrbitControls.Hook->restrictions.zoom"))return!1;this._triggerRender();return!0},rotationSpeed:function(a){return this._globalUtils.typeCheck(a,"float",this._logWarning,
"OrbitControls.Hook->rotationSpeed")?!0:!1},panSpeed:function(a){return this._globalUtils.typeCheck(a,"number",this._logWarning,"OrbitControls.Hook->panSpeed")?!0:!1},zoomSpeed:function(a){return this._globalUtils.typeCheck(a,"notnegative",this._logWarning,"OrbitControls.Hook->zoomSpeed")?!0:!1}};module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsHooks.default.OrbitControlsNotifiers={};var module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager={default:{}},__importDefault$$module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager=this&&module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager.default.__importDefault||function(a){return a&&a.__esModule?a:{"default":a}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager.default,"__esModule",{value:!0});
var GlobalUtils_js_1$$module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager=__importDefault$$module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager(module$src$shared$util$GlobalUtils.default),OrbitControlsEventDistribution_1$$module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager=module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsEventDistribution.default,OrbitControlsLogic_1$$module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager=
module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsLogic.default,OrbitControlsHooks_1$$module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager=module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsHooks.default,HooksAndNotifiers_1$$module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager=module$src$3d$viewport$helpers$HooksAndNotifiers.default;
module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager.default.OrbitControlsManager=function(){function a(a,c,d,e){this._settings=a;this._cameraControls=c;this._triggerRender=d;this._logWarning=e;this._globalUtils=GlobalUtils_js_1$$module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager.default;this._cameraLogic=new module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsLogic.default.OrbitControlsLogic(this._settings,this._cameraControls);this._cameraEventDistribution=
new module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsEventDistribution.default.OrbitControlsEventDistribution(this._settings,this._cameraControls,this._cameraLogic);this._cameraControls.registerCameraControls(this);module$src$3d$viewport$helpers$HooksAndNotifiers.default.registerHooksAndNotifiers(this,this._settings,module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsHooks.default.OrbitControlsHooks,module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsHooks.default.OrbitControlsNotifiers)}
a.prototype.isWithinRestrictions=function(a,c){return this._cameraLogic.isWithinRestrictions(a,c)};a.prototype.onKeyDown=function(a){this._cameraEventDistribution.onKeyDown(a)};a.prototype.onMouseDown=function(a){this._cameraEventDistribution.onMouseDown(a)};a.prototype.onMouseMove=function(a){this._cameraEventDistribution.onMouseMove(a)};a.prototype.onMouseUp=function(a){this._cameraEventDistribution.onMouseUp(a)};a.prototype.onMouseWheel=function(a){this._cameraEventDistribution.onMouseWheel(a)};
a.prototype.onTouchEnd=function(a){this._cameraEventDistribution.onTouchEnd(a)};a.prototype.onTouchMove=function(a){this._cameraEventDistribution.onTouchMove(a)};a.prototype.onTouchStart=function(a){this._cameraEventDistribution.onTouchStart(a)};a.prototype.reset=function(){this._cameraEventDistribution.reset();this._cameraLogic.reset()};a.prototype.restrict=function(a,c){return this._cameraLogic.restrict(a,c)};a.prototype.update=function(a,c){this._cameraLogic.update(a,c)};return a}();var module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers={default:{}},__awaiter$$module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers=this&&module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers.default.__awaiter||function(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function f(a){try{l(d.next(a))}catch(n){h(n)}}function k(a){try{l(d["throw"](a))}catch(n){h(n)}}
function l(a){a.done?c(a.value):e(a.value).then(f,k)}l((d=d.apply(a,b||[])).next())})},__generator$$module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers=this&&module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers.default.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(f)throw new TypeError("Generator is already executing.");for(;e;)try{if(f=1,h&&(g=c[0]&2?h["return"]:c[0]?h["throw"]||((g=h["return"])&&
g.call(h),0):h.next)&&!(g=g.call(h,c[1])).done)return g;if(h=0,g)c=[c[0]&2,g.value];switch(c[0]){case 0:case 1:g=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(g=e.trys,g=0<g.length&&g[g.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3]))e.label=c[1];else if(6===c[0]&&e.label<g[1])e.label=g[1],g=c;else if(g&&e.label<g[2])e.label=g[2],e.ops.push(c);else{g[2]&&e.ops.pop();
e.trys.pop();continue}}c=b.call(a,e)}catch(m){c=[6,m],h=0}finally{f=g=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},f,h,g,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k};Object.defineProperty(module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers.default,"__esModule",{value:!0});
var FPSManager_1$$module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers=module$src$3d$viewport$handlers$camera$controls$fps$FPSManager.default,OrbitControlsManager_1$$module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers=module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager.default,ICameraHandler_1$$module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers=module$src$3d$viewport$interfaces$ICameraHandler.default,
StateDashboard_1$$module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers=module$src$modules$shapediver_state_dashboard$StateDashboard.default;
module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers.default.PerspectiveCameraHooks={controls:function(a){if(a!==module$src$3d$viewport$interfaces$ICameraHandler.default.ControlType.ORBIT&&a!==module$src$3d$viewport$interfaces$ICameraHandler.default.ControlType.FPS)return this._handlers.threeDManager.warn("PerspectiveCameraHandler.Hook->controls","The specified control type is not permitted for this camera type."),!1;if(a===this._perspectiveSettings.getSetting("controls"))return!0;
a===module$src$3d$viewport$interfaces$ICameraHandler.default.ControlType.ORBIT?(document.exitPointerLock(),this._cameraControlsManager=new module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager.default.OrbitControlsManager(this._settings.getSection("controls.orbit"),this._cameraControls,this._handlers.renderingHandler.render,this._handlers.threeDManager.warn)):(this._cameraControlsManager=new module$src$3d$viewport$handlers$camera$controls$fps$FPSManager.default.FPSManager(this._settings.getSection("controls.fps"),
this._cameraControls,this._handlers.renderingHandler.render,this._handlers.threeDManager.warn),this._handlers.renderingHandler.getCanvas().requestPointerLock());return!0},"default.position":function(a){return this._globalUtils.typeCheck(a,"vector3obj",this._handlers.threeDManager.warn,"PerspectiveCameraHandler.Hook->default.position")?Promise.resolve(!0):Promise.resolve(!1)},"default.target":function(a){return this._globalUtils.typeCheck(a,"vector3obj",this._handlers.threeDManager.warn,"PerspectiveCameraHandler.Hook->default.target")?
Promise.resolve(!0):Promise.resolve(!1)},"default":function(a){return __awaiter$$module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers(this,void 0,void 0,function(){var b,c;return __generator$$module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers(this,function(d){switch(d.label){case 0:if(!this._globalUtils.typeCheck(a.position,"vector3obj",this._handlers.threeDManager.warn,"PerspectiveCameraHandler.Hook->default")||!this._globalUtils.typeCheck(a.target,
"vector3obj",this._handlers.threeDManager.warn,"PerspectiveCameraHandler.Hook->default"))return[2,Promise.resolve(!1)];b=module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary.getInstance(this._handlers.threeDManager.viewerApi.getSetting("viewerRuntimeId"));c=b.firstTimeVisible.resolved?this._settings.getSetting("cameraMovementDuration"):0;return 0!==a.position.x||0!==a.position.y||0!==a.position.z||0!==a.target.x||0!==a.target.y||0!==a.target.z?[3,2]:[4,this.zoomExtents({duration:c})];
case 1:return d.sent(),[3,4];case 2:return[4,this.setPositionAndTarget(a.position,a.target,{duration:c})];case 3:d.sent(),d.label=4;case 4:return[2,Promise.resolve(!0)]}})})},fov:function(a){if(!this._globalUtils.typeCheck(a,"notnegative",this._handlers.threeDManager.warn,"PerspectiveCameraHandler.Hook->fov"))return!1;10<this._camera.fov&&10>a?(this._camera.near=100*this._camera.near*a,this._camera.far=100*this._camera.far*a):10>this._camera.fov&&10<a&&(this._camera.near/=100*this._camera.fov,this._camera.far/=
100*this._camera.fov);this._camera.fov=a;this._camera.updateProjectionMatrix();this._handlers.renderingHandler.render();return!0}};module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers.default.PerspectiveCameraNotifiers={};var module$src$3d$viewport$handlers$camera$controls$CameraEventManager={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$CameraEventManager.default,"__esModule",{value:!0});
module$src$3d$viewport$handlers$camera$controls$CameraEventManager.default.CameraEventManager=function(){function a(a){this._controls=a;this._currentMousePosition={x:0,y:0};this.addEventListeners()}Object.defineProperty(a.prototype,"cameraControlsManager",{set:function(a){this._cameraControlsManager=a},enumerable:!0,configurable:!0});a.prototype.dispose=function(){this.removeEventListerners()};a.prototype.addEventListeners=function(){this._controls.domElement.addEventListener("mousewheel",this.onMouseWheel.bind(this),
{passive:!1});this._controls.domElement.addEventListener("MozMousePixelScroll",this.onMouseWheel.bind(this),{passive:!1});this._controls.domElement.addEventListener("mousedown",this.onMouseDown.bind(this),{passive:!1});this._controls.domElement.addEventListener("mousemove",this.onMouseMove.bind(this),{passive:!1});this._controls.domElement.addEventListener("mouseup",this.onMouseUp.bind(this),{passive:!1});this._controls.domElement.addEventListener("mouseout",this.onMouseUp.bind(this),{passive:!1});
this._controls.domElement.addEventListener("touchstart",this.onTouchStart.bind(this),{passive:!1});this._controls.domElement.addEventListener("touchmove",this.onTouchMove.bind(this),{passive:!1});this._controls.domElement.addEventListener("touchend",this.onTouchEnd.bind(this),{passive:!1});window.addEventListener("keydown",this.onKeyDown.bind(this),{passive:!1});window.addEventListener("mousemove",this.onKeyDownMousePositionHelper.bind(this),{passive:!1});this._controls.domElement.addEventListener("contextmenu",
this.onContextMenu.bind(this),{passive:!1})};a.prototype.onContextMenu=function(a){!1!==this._controls.enabled&&a.preventDefault()};a.prototype.onKeyDown=function(a){if(!1!==this._controls.enabled&&this._controls.domElement===document.elementFromPoint(this._currentMousePosition.x,this._currentMousePosition.y))this._cameraControlsManager.onKeyDown(a)};a.prototype.onKeyDownMousePositionHelper=function(a){this._currentMousePosition={x:a.pageX,y:a.pageY}};a.prototype.onMouseDown=function(a){!1!==this._controls.enabled&&
(a.preventDefault(),this._cameraControlsManager.onMouseDown(a))};a.prototype.onMouseMove=function(a){!1!==this._controls.enabled&&(a.preventDefault(),this._cameraControlsManager.onMouseMove(a))};a.prototype.onMouseUp=function(a){if(!1!==this._controls.enabled)this._cameraControlsManager.onMouseUp(a)};a.prototype.onMouseWheel=function(a){!1!==this._controls.enabled&&(a.preventDefault(),a.stopPropagation(),this._cameraControlsManager.onMouseWheel(a))};a.prototype.onTouchEnd=function(a){if(!1!==this._controls.enabled)this._cameraControlsManager.onTouchEnd(a)};
a.prototype.onTouchMove=function(a){if(!1!==this._controls.enabled)this._cameraControlsManager.onTouchMove(a)};a.prototype.onTouchStart=function(a){if(!1!==this._controls.enabled)this._cameraControlsManager.onTouchStart(a)};a.prototype.removeEventListerners=function(){this._controls.domElement.removeEventListener("mousewheel",this.onMouseWheel.bind(this),!1);this._controls.domElement.removeEventListener("MozMousePixelScroll",this.onMouseWheel.bind(this),!1);this._controls.domElement.removeEventListener("mousedown",
this.onMouseDown.bind(this),!1);this._controls.domElement.removeEventListener("mousemove",this.onMouseMove.bind(this),!1);this._controls.domElement.removeEventListener("mouseup",this.onMouseUp.bind(this),!1);this._controls.domElement.removeEventListener("mouseout",this.onMouseUp.bind(this),!1);this._controls.domElement.removeEventListener("touchstart",this.onTouchStart.bind(this),!1);this._controls.domElement.removeEventListener("touchmove",this.onTouchMove.bind(this),!1);this._controls.domElement.removeEventListener("touchend",
this.onTouchEnd.bind(this),!1);window.removeEventListener("keydown",this.onKeyDown.bind(this),!1);window.removeEventListener("mousemove",this.onKeyDownMousePositionHelper.bind(this),!1);this._controls.domElement.removeEventListener("contextmenu",this.onContextMenu.bind(this),!1)};return a}();var module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraLinearInterpolation={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraLinearInterpolation.default,"__esModule",{value:!0});var THREE$$module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraLinearInterpolation=module$src$externals$three.default;
module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraLinearInterpolation.default.CameraLinearInterpolation=function(){function a(a,c,d){this._cameraControls=a;this._from=c;this._to=d}a.prototype.onComplete=function(a){a=(new module$src$externals$three.default.Vector3(this._to.position.x,this._to.position.y,this._to.position.z)).sub(this._cameraControls.position);this._cameraControls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,
a.z));a=(new module$src$externals$three.default.Vector3(this._to.target.x,this._to.target.y,this._to.target.z)).sub(this._cameraControls.target);this._cameraControls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z))};a.prototype.onStop=function(a){};a.prototype.onUpdate=function(a){var b=this._from.position.clone().multiplyScalar(1-a.delta).add(this._to.position.clone().multiplyScalar(a.delta)).clone().sub(this._cameraControls.position);this._cameraControls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(b.x,
b.y,b.z));a=this._from.target.clone().multiplyScalar(1-a.delta).add(this._to.target.clone().multiplyScalar(a.delta)).clone().sub(this._cameraControls.target);this._cameraControls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z))};return a}();var module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraSphericalInterpolation={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraSphericalInterpolation.default,"__esModule",{value:!0});var THREE$$module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraSphericalInterpolation=module$src$externals$three.default;
module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraSphericalInterpolation.default.CameraSphericalInterpolation=function(){function a(a,c,d){this._cameraControls=a;this._from=c;this._to=d;this._radius_from=this._from.position.distanceTo(this._from.target);this._direction_from=this._from.position.clone().sub(this._from.target).normalize();this._radius_to=this._to.position.distanceTo(this._to.target);this._direction_to=this._to.position.clone().sub(this._to.target).normalize();
this._axis=this._direction_to.clone().cross(this._direction_from).normalize();this._c_angle=-Math.acos(this._direction_to.dot(this._direction_from))}a.prototype.onComplete=function(a){a=(new module$src$externals$three.default.Vector3(this._to.position.x,this._to.position.y,this._to.position.z)).sub(this._cameraControls.position);this._cameraControls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z));a=(new module$src$externals$three.default.Vector3(this._to.target.x,
this._to.target.y,this._to.target.z)).sub(this._cameraControls.target);this._cameraControls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z))};a.prototype.onStop=function(a){};a.prototype.onUpdate=function(a){var b=this._from.target.clone().multiplyScalar(1-a.delta).add(this._to.target.clone().multiplyScalar(a.delta)),d=b.clone().sub(this._cameraControls.target);this._cameraControls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(d.x,
d.y,d.z));d=this._c_angle*a.delta;d=this._direction_from.clone().applyAxisAngle(this._axis,d).normalize();a=b.clone().add(d.clone().multiplyScalar(this._radius_from*(1-a.delta)+this._radius_to*a.delta)).clone().sub(this._cameraControls.position);this._cameraControls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z))};return a}();var module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraCylindricalInterpolation={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraCylindricalInterpolation.default,"__esModule",{value:!0});var THREE$$module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraCylindricalInterpolation=module$src$externals$three.default;
module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraCylindricalInterpolation.default.CameraCylindricalInterpolation=function(){function a(a,c,d){this._cameraControls=a;this._from=c;this._to=d;this._h_from=this._from.position.z-this._from.target.z;this._from_position_heightAdjusted=new module$src$externals$three.default.Vector3(this._from.position.x,this._from.position.y,this._from.target.z);this._r_from=this._from_position_heightAdjusted.distanceTo(this._from.target);this._dir_from=
this._from_position_heightAdjusted.sub(this._from.target).normalize();this._h_to=this._to.position.z-this._to.target.z;this._to_position_heightAdjusted=new module$src$externals$three.default.Vector3(this._to.position.x,this._to.position.y,this._to.target.z);this._r_to=this._to_position_heightAdjusted.distanceTo(this._to.target);this._dir_to=this._to_position_heightAdjusted.sub(this._to.target).normalize();this._lorr=this._dir_to.clone().cross(this._dir_from);a=Math.min(1,Math.max(-1,this._dir_to.dot(this._dir_from)));
this._shortest_angle=0<Math.min(1,Math.max(-1,this._lorr.dot(new module$src$externals$three.default.Vector3(0,0,1))))?-Math.acos(a):Math.acos(a)}a.prototype.onComplete=function(a){a=(new module$src$externals$three.default.Vector3(this._to.position.x,this._to.position.y,this._to.position.z)).sub(this._cameraControls.position);this._cameraControls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z));a=(new module$src$externals$three.default.Vector3(this._to.target.x,
this._to.target.y,this._to.target.z)).sub(this._cameraControls.target);this._cameraControls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z))};a.prototype.onStop=function(a){};a.prototype.onUpdate=function(a){var b=this._from.target.clone().multiplyScalar(1-a.delta).add(this._to.target.clone().multiplyScalar(a.delta)),d=b.clone().sub(this._cameraControls.target);this._cameraControls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(d.x,
d.y,d.z));d=this._shortest_angle*a.delta;d=this._dir_from.clone().applyAxisAngle(new module$src$externals$three.default.Vector3(0,0,1),d);b=b.clone().add(d.clone().multiplyScalar(this._r_from*(1-a.delta)+this._r_to*a.delta));b.add(new module$src$externals$three.default.Vector3(0,0,this._h_from*(1-a.delta)+this._h_to*a.delta));a=b.clone().sub(this._cameraControls.position);this._cameraControls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z))};return a}();var module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraMultipleInterpolation={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraMultipleInterpolation.default,"__esModule",{value:!0});var THREE$$module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraMultipleInterpolation=module$src$externals$three.default;
module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraMultipleInterpolation.default.CameraMultipleInterpolation=function(){function a(a,c,d){this._cameraControls=a;this._path=c;this._interpolationFunction=d;this.end={position:{x:[],y:[],z:[]},target:{x:[],y:[],z:[]}};for(a=0;a<this._path.length;a++)this.end.position.x.push(this._path[a].position.x),this.end.position.y.push(this._path[a].position.y),this.end.position.z.push(this._path[a].position.z),this.end.target.x.push(this._path[a].target.x),
this.end.target.y.push(this._path[a].target.y),this.end.target.z.push(this._path[a].target.z)}a.prototype.onComplete=function(a){a=(new module$src$externals$three.default.Vector3(this._path[this._path.length-1].position.x,this._path[this._path.length-1].position.y,this._path[this._path.length-1].position.z)).sub(this._cameraControls.position);this._cameraControls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z));a=(new module$src$externals$three.default.Vector3(this._path[this._path.length-
1].target.x,this._path[this._path.length-1].target.y,this._path[this._path.length-1].target.z)).sub(this._cameraControls.target);this._cameraControls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z))};a.prototype.onStop=function(a){};a.prototype.onUpdate=function(a){var b=(new module$src$externals$three.default.Vector3(this._interpolationFunction(this.end.position.x,a.delta),this._interpolationFunction(this.end.position.y,a.delta),this._interpolationFunction(this.end.position.z,
a.delta))).clone().sub(this._cameraControls.position);this._cameraControls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(b.x,b.y,b.z));a=(new module$src$externals$three.default.Vector3(this._interpolationFunction(this.end.target.x,a.delta),this._interpolationFunction(this.end.target.y,a.delta),this._interpolationFunction(this.end.target.z,a.delta))).clone().sub(this._cameraControls.target);this._cameraControls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,
a.y,a.z))};return a}();var module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager={default:{}},__importDefault$$module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager=this&&module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager.default.__importDefault||function(a){return a&&a.__esModule?a:{"default":a}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager.default,"__esModule",{value:!0});
var TWEEN$$module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager=module$node_modules$$tweenjs$tween_js$src$Tween.default,GlobalUtils_js_1$$module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager=__importDefault$$module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager(module$src$shared$util$GlobalUtils.default),CameraLinearInterpolation_1$$module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager=module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraLinearInterpolation.default,
CameraSphericalInterpolation_1$$module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager=module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraSphericalInterpolation.default,CameraCylindricalInterpolation_1$$module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager=module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraCylindricalInterpolation.default,CameraMultipleInterpolation_1$$module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager=
module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraMultipleInterpolation.default;
module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager.default.CameraInterpolationManager=function(){function a(a){this._cameraControls=a;this._globalUtils=GlobalUtils_js_1$$module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager.default;this.Tween=function(){function a(a,b,c){var d=this;this._properties={delta:0};this._tween=new module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween(this._properties);this._tween.easing(a.easing);this._tween.to({delta:1},
a.duration);this._tween.onUpdate(function(a){b.onUpdate(a)});this._tween.onStop(function(a){if(b.onStop)b.onStop(a);d._resolve(!0)});this._tween.onComplete(function(a){if(b.onComplete)b.onComplete(a);c();d._resolve(!0)})}a.prototype.start=function(){var a=this;return new Promise(function(b){a._resolve=b;a._tween.start()})};a.prototype.stop=function(){this._tween.stop()};return a}();this._tween=null}a.prototype.active=function(){return this._tween?!0:!1};a.prototype.interpolate=function(a,c){var b=
this;void 0===c&&(c={});this._tween&&(this._tween.stop(),this._tween=null);c=this.optionsParser(c);this._tween=new this.Tween(c,2===a.length?this.getCameraInterpolation(a[0],a[1],c.coordinates):new module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraMultipleInterpolation.default.CameraMultipleInterpolation(this._cameraControls,a,c.interpolation),function(){b._tween=null});return this._tween.start()};a.prototype.stop=function(){this._tween&&this._tween.stop();this._tween=null};
a.prototype.getCameraInterpolation=function(a,c,d){switch(d){case "spherical":return new module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraSphericalInterpolation.default.CameraSphericalInterpolation(this._cameraControls,a,c);case "cylindrical":return new module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraCylindricalInterpolation.default.CameraCylindricalInterpolation(this._cameraControls,a,c);default:return new module$src$3d$viewport$handlers$camera$controls$interpolationMethods$CameraLinearInterpolation.default.CameraLinearInterpolation(this._cameraControls,
a,c)}};a.prototype.optionsParser=function(a){return{default:a.default||!1,duration:this._globalUtils.typeCheck(a.duration,"notnegative")?a.duration:0,easing:this._globalUtils.typeCheck(a.easing,"string")?this._globalUtils.getAtPath(module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing,a.easing)||module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Quartic.InOut:"function"===typeof a.easing?a.easing:module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Quartic.InOut,coordinates:"spherical"!==
a.coordinates&&"linear"!==a.coordinates&&"cylindrical"!==a.coordinates?"cylindrical":a.coordinates,interpolation:this._globalUtils.typeCheck(a.interpolation,"string")?this._globalUtils.getAtPath(module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation,a.interpolation)||module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation.CatmullRom:"function"===typeof a.interpolation?a.interpolation:module$node_modules$$tweenjs$tween_js$src$Tween.default.Interpolation.CatmullRom}};return a}();var module$src$3d$viewport$handlers$camera$controls$CameraControls={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$CameraControls.default,"__esModule",{value:!0});
var CameraEventManager_1$$module$src$3d$viewport$handlers$camera$controls$CameraControls=module$src$3d$viewport$handlers$camera$controls$CameraEventManager.default,CameraInterpolationManager_1$$module$src$3d$viewport$handlers$camera$controls$CameraControls=module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager.default,THREE$$module$src$3d$viewport$handlers$camera$controls$CameraControls=module$src$externals$three.default;
module$src$3d$viewport$handlers$camera$controls$CameraControls.default.CameraControls=function(){function a(a,c,d,e,f,h){this._camera=a;this._domElement=d;this._onChange=e;this._eventDispatch=f;this._adjustOrthographicSides=h;this._cameraInterpolationManager=new module$src$3d$viewport$handlers$camera$controls$CameraInterpolationManager.default.CameraInterpolationManager(this);this._moving=this._manualInteraction=!1;this._movingDuration=0;this._nonmanualInteraction=!1;this._position=new module$src$externals$three.default.Vector3;
this._target=new module$src$externals$three.default.Vector3;this._position=c.position.clone();this._target=c.target.clone();this._camera.position.set(this._position.x,this._position.y,this._position.z);this._camera.lookAt(this._target);this._cameraEventManager=new module$src$3d$viewport$handlers$camera$controls$CameraEventManager.default.CameraEventManager(this);this._manualInteractionMatrices={position:[],target:[]};this._nonmanualInteractionMatrices={position:[],target:[]}}Object.defineProperty(a.prototype,
"camera",{get:function(){return this._camera},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"domElement",{get:function(){return this._domElement},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"enabled",{get:function(){return this._enabled},set:function(a){a||(this._manualInteraction=!1,this._manualInteractionMatrices={position:[],target:[]},this._nonmanualInteraction=!1,this._nonmanualInteractionMatrices={position:[],target:[]},this._cameraInterpolationManager.active()&&
this._cameraInterpolationManager.stop(),this._cameraControlsManager&&this._cameraControlsManager.reset());this._enabled=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"position",{get:function(){return this.getPosition().clone()},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"target",{get:function(){return this.getTarget().clone()},enumerable:!0,configurable:!0});a.prototype.animate=function(a,c){if(c&&0===c.duration)return this.immediateUpdate(a[a.length-
1].position,a[a.length-1].target);this._manualInteraction=!1;this._manualInteractionMatrices={position:[],target:[]};this._onChange();return this._cameraInterpolationManager.interpolate(a,c)};a.prototype.applyPositionMatrix=function(a,c){void 0===c&&(c=!1);this._manualInteraction||c?(this._manualInteraction=!0,this._manualInteractionMatrices.position.push(a)):(this._nonmanualInteraction=!0,this._nonmanualInteractionMatrices.position.push(a));this._onChange()};a.prototype.applyTargetMatrix=function(a,
c){void 0===c&&(c=!1);this._manualInteraction||c?(this._manualInteraction=!0,this._manualInteractionMatrices.target.push(a)):(this._nonmanualInteraction=!0,this._nonmanualInteractionMatrices.target.push(a));this._onChange()};a.prototype.applyUpMatrix=function(a,c){throw Error("Method not implemented.");};a.prototype.dispose=function(){this._cameraEventManager.dispose()};a.prototype.getPositionWithManualUpdates=function(){var a=(new module$src$externals$three.default.Vector3).set(this._position.x,
this._position.y,this._position.z);if(this._manualInteraction)for(var c=this._manualInteractionMatrices.position.length-1;0<=c;c--)a.applyMatrix4(this._manualInteractionMatrices.position[c]);return a};a.prototype.getTargetWithManualUpdates=function(){var a=(new module$src$externals$three.default.Vector3).set(this._target.x,this._target.y,this._target.z);if(this._manualInteraction)for(var c=this._manualInteractionMatrices.target.length-1;0<=c;c--)a.applyMatrix4(this._manualInteractionMatrices.target[c]);
return a};a.prototype.isMoving=function(){return this._manualInteraction||this._nonmanualInteraction};a.prototype.isWithinRestrictions=function(a,c){return this._cameraControlsManager.isWithinRestrictions(a,c)};a.prototype.registerCameraControls=function(a){this._cameraControlsManager=a;this._cameraEventManager.cameraControlsManager=a};a.prototype.reset=function(){this._cameraInterpolationManager.active()&&this._cameraInterpolationManager.stop();this._cameraControlsManager&&this._cameraControlsManager.reset()};
a.prototype.update=function(a){if(this._enabled){var b=this._cameraControlsManager.restrict(this.getPosition(),this.getTarget()),d=b.target;this._position.copy(b.position);this._target.copy(d);this._camera.position.set(this._position.x,this._position.y,this._position.z);this._camera.lookAt(this._target);!0===this._manualInteraction&&this._cameraInterpolationManager.active()&&this._cameraInterpolationManager.stop();this._manualInteraction=!1;this._manualInteractionMatrices={position:[],target:[]};
this._nonmanualInteraction=this._cameraInterpolationManager.active();this._nonmanualInteractionMatrices={position:[],target:[]};this.camera.isOrthographicCamera&&this._adjustOrthographicSides();this._cameraControlsManager.update(a,this._nonmanualInteraction);this._eventDispatch(this._manualInteraction||this._nonmanualInteraction,this._moving,this._movingDuration+=a);this._moving=this._manualInteraction||this._nonmanualInteraction;this._moving||(this._movingDuration=0);(this._manualInteraction||this._nonmanualInteraction)&&
this._onChange()}};a.prototype.getPosition=function(){var a=(new module$src$externals$three.default.Vector3).set(this._position.x,this._position.y,this._position.z);if(this._manualInteraction)for(var c=this._manualInteractionMatrices.position.length-1;0<=c;c--)a.applyMatrix4(this._manualInteractionMatrices.position[c]);else if(this._nonmanualInteraction)for(c=this._nonmanualInteractionMatrices.position.length-1;0<=c;c--)a.applyMatrix4(this._nonmanualInteractionMatrices.position[c]);return a};a.prototype.getTarget=
function(){var a=(new module$src$externals$three.default.Vector3).set(this._target.x,this._target.y,this._target.z);if(this._manualInteraction)for(var c=this._manualInteractionMatrices.target.length-1;0<=c;c--)a.applyMatrix4(this._manualInteractionMatrices.target[c]);else if(this._nonmanualInteraction)for(c=this._nonmanualInteractionMatrices.target.length-1;0<=c;c--)a.applyMatrix4(this._nonmanualInteractionMatrices.target[c]);return a};a.prototype.immediateUpdate=function(a,c){a=this._cameraControlsManager.restrict(a,
c);this._position.copy(a.position);this._target.copy(a.target);this._camera.position.set(this._position.x,this._position.y,this._position.z);this._camera.lookAt(this._target);this._manualInteraction=!1;this._manualInteractionMatrices={position:[],target:[]};this._nonmanualInteraction=!1;this._nonmanualInteractionMatrices={position:[],target:[]};this._cameraInterpolationManager.active()&&this._cameraInterpolationManager.stop();this.camera.isOrthographicCamera&&this._adjustOrthographicSides();this._onChange();
return Promise.resolve(!0)};return a}();var module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler={default:{}},__extends$$module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler=this&&module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);
b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler.default,"__esModule",{value:!0});
var BaseCameraHandler_1$$module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler=module$src$3d$viewport$handlers$camera$BaseCameraHandler.default,THREE$$module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler=module$src$externals$three.default,HooksAndNotifiers_1$$module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler=module$src$3d$viewport$helpers$HooksAndNotifiers.default,PerspectiveCameraHooksAndNotifiers_1$$module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler=
module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers.default,CameraControls_1$$module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler=module$src$3d$viewport$handlers$camera$controls$CameraControls.default,OrbitControlsManager_1$$module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler=module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager.default;
module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler.default.PerspectiveCameraHandler=function(a){function b(b,d){var c=a.call(this,b,d)||this;c._defaultSettings={near:.01,far:100};c._perspectiveSettings=c._settings.getSection("cameraTypes.perspective");c._camera=new module$src$externals$three.default.PerspectiveCamera(c._perspectiveSettings.getSetting("fov"),c._container.offsetWidth/c._container.offsetHeight,c._defaultSettings.near,c._defaultSettings.far);c._camera.up.set(0,0,1);c._handlers.threeDManager.helpers.addSceneObject(c._camera);
b=c._perspectiveSettings.getSetting("default");0===b.position.x&&0===b.position.y&&0===b.position.z&&0===b.target.x&&0===b.target.y&&0===b.target.z&&(b=c.getZoomExtentsPosition());c._cameraControls=new module$src$3d$viewport$handlers$camera$controls$CameraControls.default.CameraControls(c._camera,b,c._handlers.renderingHandler.getDomElement(),function(){c._handlers.renderingHandler.registerForContinuousRendering(c.CAMERA_MOVING_ID)},c.cameraMovementEventDispatch.bind(c));c._cameraControlsManager=
new module$src$3d$viewport$handlers$camera$controls$orbit$OrbitControlsManager.default.OrbitControlsManager(c._settings.getSection("controls.orbit"),c._cameraControls,c._handlers.renderingHandler.render,c._handlers.threeDManager.warn);module$src$3d$viewport$helpers$HooksAndNotifiers.default.registerHooksAndNotifiers(c,c._perspectiveSettings,module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers.default.PerspectiveCameraHooks,module$src$3d$viewport$handlers$camera$hooks$PerspectiveCameraHooksAndNotifiers.default.PerspectiveCameraNotifiers);
return c}__extends$$module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler(b,a);b.prototype.activate=function(){this.resume();this._handlers.threeDManager.getSetting("material.environmentMapAsBackground")&&this._handlers.materialHandler.setSceneBackground(this._handlers.materialHandler.getEnvironmentMap())};b.prototype.adjustToBoundingSphere=function(a){this._sceneBS=a;this._camera.far=10>this._camera.fov?100*this._camera.fov*this._defaultSettings.far*a.radius:this._defaultSettings.far*a.radius;
this._camera.near=10>this._camera.fov?100*this._camera.fov*this._defaultSettings.near*a.radius:this._defaultSettings.near*a.radius;this._camera.updateProjectionMatrix()};b.prototype.deactivate=function(){this.pause()};b.prototype.getZoomExtentsPosition=function(a){this._camera.updateProjectionMatrix();var b=new module$src$externals$three.default.Box3;b=a||b.setFromObject(this._geometryNode);a=new module$src$externals$three.default.Vector3;b.getCenter(a);var c=new module$src$externals$three.default.Vector3;
c.subVectors(b.max,a);c.multiplyScalar(this._settings.getSetting("zoomExtentsFactor"));b=new module$src$externals$three.default.Box3((new module$src$externals$three.default.Vector3).subVectors(a,c),(new module$src$externals$three.default.Vector3).addVectors(a,c));c=new module$src$externals$three.default.Vector3;this._camera.getWorldDirection(c);var f=(new module$src$externals$three.default.Vector3).crossVectors(this._camera.up,c).normalize(),h=(new module$src$externals$three.default.Vector3).crossVectors(f,
c).normalize(),g=a.clone().add(c.clone().multiplyScalar(-1)),k=[];k.push(new module$src$externals$three.default.Vector3(b.min.x,b.min.y,b.min.z));k.push(new module$src$externals$three.default.Vector3(b.min.x,b.min.y,b.max.z));k.push(new module$src$externals$three.default.Vector3(b.min.x,b.max.y,b.min.z));k.push(new module$src$externals$three.default.Vector3(b.min.x,b.max.y,b.max.z));k.push(new module$src$externals$three.default.Vector3(b.max.x,b.min.y,b.min.z));k.push(new module$src$externals$three.default.Vector3(b.max.x,
b.min.y,b.max.z));k.push(new module$src$externals$three.default.Vector3(b.max.x,b.max.y,b.min.z));k.push(new module$src$externals$three.default.Vector3(b.max.x,b.max.y,b.max.z));b=c.clone().applyAxisAngle(f,this._camera.getEffectiveFOV()/2*(Math.PI/180));var l=c.clone().applyAxisAngle(f,-(this._camera.getEffectiveFOV()/2)*(Math.PI/180)),m=2*Math.atan(Math.tan(this._camera.getEffectiveFOV()*Math.PI/180/2)*this._camera.aspect),n=c.clone().applyAxisAngle(h,m/2);m=c.clone().applyAxisAngle(h,-m/2);var r=
new module$src$externals$three.default.Plane(f.clone(),0);r.setFromNormalAndCoplanarPoint(f,a);f=new module$src$externals$three.default.Plane(this._camera.up.clone(),0);f.setFromNormalAndCoplanarPoint(h.clone(),a);for(var u=h=0;u<k.length;u++){var p=new module$src$externals$three.default.Vector3;r.projectPoint(k[u],p);var q=p.clone().sub(g).normalize();if(c.dot(b)>c.dot(q)){var t=new module$src$externals$three.default.Vector3;p=b.dot(q)>l.dot(q)?new module$src$externals$three.default.Ray(p,b.clone().multiplyScalar(-1)):
new module$src$externals$three.default.Ray(p,l.clone().multiplyScalar(-1));p.intersectPlane(f,t);h=Math.max(h,a.distanceTo(t))}p=new module$src$externals$three.default.Vector3;f.projectPoint(k[u],p);q=p.clone().sub(g).normalize();c.dot(n)>c.dot(q)&&(t=new module$src$externals$three.default.Vector3,p=n.dot(q)>m.dot(q)?new module$src$externals$three.default.Ray(p,n.clone().multiplyScalar(-1)):new module$src$externals$three.default.Ray(p,m.clone().multiplyScalar(-1)),p.intersectPlane(r,t),h=Math.max(h,
a.distanceTo(t)))}g=a.clone().add(c.clone().multiplyScalar(-h));return{position:g.clone(),target:a.clone()}};b.prototype.onResize=function(a,b){this._camera.aspect=a/b;this._camera.setViewOffset(a,b,0,0,a,b);this._camera.updateProjectionMatrix()};b.prototype.resetPositionAndTarget=function(a){var b=this._perspectiveSettings.getSetting("default");0===b.position.x&&0===b.position.y&&0===b.position.z&&0===b.target.x&&0===b.target.y&&0===b.target.z&&(b=this.getZoomExtentsPosition());return this.setPositionAndTarget(b.position,
b.target,a)};b.prototype.setCameraPath=function(a,b){if(!a||!Array.isArray(a)||0===a.length)return Promise.resolve(!1);for(var c=[],d=0;d<a.length;d++){var h=a[d];if(!this._globalUtils.typeCheck(h.position,"vector3any",this._handlers.threeDManager.warn,"PerspectiveCameraHandler.setCameraPath")||!this._globalUtils.typeCheck(h.target,"vector3any",this._handlers.threeDManager.warn,"PerspectiveCameraHandler.setCameraPath"))return Promise.resolve(!1);c.push({position:this._globalUtils.toVector3(h.position),
target:this._globalUtils.toVector3(h.target)})}if(!this._cameraControls.isWithinRestrictions(c[c.length-1].position,c[c.length-1].target))return Promise.resolve(!1);b||(b={});b.duration=0<=b.duration?b.duration:this._settings.getSetting("cameraMovementDuration");b.default&&(this._perspectiveSettings.updateSetting("default.position",c[c.length-1].position),this._perspectiveSettings.updateSetting("default.target",c[c.length-1].target));!1===this._firstTimeVisible.resolved&&(b.duration=0);return this._cameraControls.animate(c,
b)};b.prototype.setPositionAndTarget=function(a,b,e){if(!this._globalUtils.typeCheck(a,"vector3any",this._handlers.threeDManager.warn,"PerspectiveCameraHandler.setPositionAndTarget")||!this._globalUtils.typeCheck(b,"vector3any",this._handlers.threeDManager.warn,"PerspectiveCameraHandler.setPositionAndTarget"))return Promise.resolve(!1);a=this._globalUtils.toVector3(a);b=this._globalUtils.toVector3(b);if(!this._cameraControls.isWithinRestrictions(a,b))return Promise.resolve(!1);e||(e={});e.duration=
0<=e.duration?e.duration:this._settings.getSetting("cameraMovementDuration");e.default&&(this._perspectiveSettings.updateSetting("default.position",a),this._perspectiveSettings.updateSetting("default.target",b));!1===this._firstTimeVisible.resolved&&(e.duration=0);return this._cameraControls.animate([{position:this._cameraControls.position.clone(),target:this._cameraControls.target.clone()},{position:a,target:b}],e)};b.prototype.zoomExtents=function(a,b){b=b?b instanceof module$src$externals$three.default.Box3?
b:this._globalUtils.typeCheck(b,"box3any")?new module$src$externals$three.default.Box3(this._globalUtils.toVector3(b.min),this._globalUtils.toVector3(b.max)):this._handlers.threeDManager.computeBoundingBox(b):this._handlers.threeDManager.computeBoundingBox();b=this.getZoomExtentsPosition(b);return this.setPositionAndTarget(b.position,b.target,a)};return b}(module$src$3d$viewport$handlers$camera$BaseCameraHandler.default.BaseCameraHandler);var module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers={default:{}},__awaiter$$module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers=this&&module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers.default.__awaiter||function(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function f(a){try{l(d.next(a))}catch(n){h(n)}}function k(a){try{l(d["throw"](a))}catch(n){h(n)}}
function l(a){a.done?c(a.value):e(a.value).then(f,k)}l((d=d.apply(a,b||[])).next())})},__generator$$module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers=this&&module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers.default.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(f)throw new TypeError("Generator is already executing.");for(;e;)try{if(f=1,h&&(g=c[0]&2?h["return"]:c[0]?h["throw"]||((g=h["return"])&&
g.call(h),0):h.next)&&!(g=g.call(h,c[1])).done)return g;if(h=0,g)c=[c[0]&2,g.value];switch(c[0]){case 0:case 1:g=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();e.trys.pop();continue;default:if(!(g=e.trys,g=0<g.length&&g[g.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3]))e.label=c[1];else if(6===c[0]&&e.label<g[1])e.label=g[1],g=c;else if(g&&e.label<g[2])e.label=g[2],e.ops.push(c);else{g[2]&&e.ops.pop();
e.trys.pop();continue}}c=b.call(a,e)}catch(m){c=[6,m],h=0}finally{f=g=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},f,h,g,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k};Object.defineProperty(module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers.default,"__esModule",{value:!0});
var StateDashboard_1$$module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers=module$src$modules$shapediver_state_dashboard$StateDashboard.default;
module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers.default.OrthographicCameraHooks={"default.position":function(a){return this._globalUtils.typeCheck(a,"vector3obj",this._handlers.threeDManager.warn,"OrthographicCameraHandler.Hook->default.position")?Promise.resolve(!0):Promise.resolve(!1)},"default.target":function(a){return this._globalUtils.typeCheck(a,"vector3obj",this._handlers.threeDManager.warn,"OrthographicCameraHandler.Hook->default.target")?Promise.resolve(!0):
Promise.resolve(!1)},"default":function(a){return __awaiter$$module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers(this,void 0,void 0,function(){var b,c;return __generator$$module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers(this,function(d){switch(d.label){case 0:if(!this._globalUtils.typeCheck(a.position,"vector3obj",this._handlers.threeDManager.warn,"OrthographicCameraHandler.Hook->default")||!this._globalUtils.typeCheck(a.target,"vector3obj",
this._handlers.threeDManager.warn,"OrthographicCameraHandler.Hook->default"))return[2,Promise.resolve(!1)];b=module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary.getInstance(this._handlers.threeDManager.viewerApi.getSetting("viewerRuntimeId"));c=b.firstTimeVisible.resolved?this._settings.getSetting("cameraMovementDuration"):0;return 0!==a.position.x||0!==a.position.y||0!==a.position.z||0!==a.target.x||0!==a.target.y||0!==a.target.z?[3,2]:[4,this.zoomExtents({duration:c})];
case 1:return d.sent(),[3,4];case 2:return[4,this.setPositionAndTarget(a.position,a.target,{duration:c})];case 3:d.sent(),d.label=4;case 4:return[2,Promise.resolve(!0)]}})})}};module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers.default.OrthographicCameraNotifiers={};var module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicEventDistribution={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicEventDistribution.default,"__esModule",{value:!0});
module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicEventDistribution.default.OrthographicEventDistribution=function(){function a(a,c,d){this._settings=a;this._controls=c;this._cameraLogic=d;this._active={zoom:!1,pan:!1}}a.prototype.onDown=function(a){var b=this.convertInput(a),d=b.x;b=b.y;var e=a instanceof TouchEvent?a.touches.length:a.button,f=a instanceof TouchEvent?this._settings.getSetting("input").touch:this._settings.getSetting("input").mouse;e===f.pan&&this._settings.getSetting("enablePan")&&
(this._cameraLogic.pan(d,b,this._active.pan,a instanceof TouchEvent),this._active.pan=!0,this._active.zoom=!1);e===f.zoom&&this._settings.getSetting("enableZoom")&&(a instanceof TouchEvent&&2===this._settings.getSetting("input").touch.zoom&&(d=(a.touches[0].pageX-a.touches[1].pageX)/window.innerWidth*(window.innerWidth/window.innerHeight),b=(a.touches[0].pageY-a.touches[1].pageY)/window.innerHeight),this._cameraLogic.zoom(d,b,this._active.zoom,a instanceof TouchEvent),this._active.pan=!1,this._active.zoom=
!0)};a.prototype.onKey=function(a){if(this._settings.getSetting("enableKeyPan"))switch(a.keyCode){case this._settings.getSetting("input").keys.up:this._cameraLogic.pan(0,0,!1,!1);this._cameraLogic.pan(0,.05*this._settings.getSetting("keyPanSpeed"),!0,!1);a.preventDefault();a.stopPropagation();break;case this._settings.getSetting("input").keys.down:this._cameraLogic.pan(0,0,!1,!1);this._cameraLogic.pan(0,.05*-this._settings.getSetting("keyPanSpeed"),!0,!1);a.preventDefault();a.stopPropagation();break;
case this._settings.getSetting("input").keys.left:this._cameraLogic.pan(0,0,!1,!1);this._cameraLogic.pan(.05*this._settings.getSetting("keyPanSpeed"),0,!0,!1);a.preventDefault();a.stopPropagation();break;case this._settings.getSetting("input").keys.right:this._cameraLogic.pan(0,0,!1,!1),this._cameraLogic.pan(.05*-this._settings.getSetting("keyPanSpeed"),0,!0,!1),a.preventDefault(),a.stopPropagation()}};a.prototype.onKeyDown=function(a){this.onKey(a)};a.prototype.onMouseDown=function(a){this.onDown(a)};
a.prototype.onMouseMove=function(a){this.onMove(a)};a.prototype.onMouseUp=function(a){this.onUp(a)};a.prototype.onMouseWheel=function(a){this.onWheel(a)};a.prototype.onMove=function(a){var b=this.convertInput(a),d=b.x;b=b.y;this._settings.getSetting("enablePan")&&this._active.pan&&this._cameraLogic.pan(d,b,this._active.pan,a instanceof TouchEvent);this._settings.getSetting("enableZoom")&&this._active.zoom&&(a instanceof TouchEvent&&2===this._settings.getSetting("input").touch.zoom&&(d=(a.touches[0].pageX-
a.touches[1].pageX)/window.innerWidth*(window.innerWidth/window.innerHeight),b=(a.touches[0].pageY-a.touches[1].pageY)/window.innerHeight),this._cameraLogic.zoom(d,b,this._active.zoom,a instanceof TouchEvent))};a.prototype.onTouchEnd=function(a){this.onUp(a)};a.prototype.onTouchMove=function(a){this.onMove(a)};a.prototype.onTouchStart=function(a){this.onDown(a)};a.prototype.onUp=function(a){this._active.zoom=!1;this._active.pan=!1};a.prototype.onWheel=function(a){if(this._settings.getSetting("enableZoom")){var b=
0;void 0!==a.deltaY?b=-a.deltaY:void 0!==a.detail&&(b=-a.detail);0<Math.sign(b)?(this._cameraLogic.zoom(0,0,!1,!1),this._cameraLogic.zoom(1,0,!0,!1)):(this._cameraLogic.zoom(1,0,!1,!1),this._cameraLogic.zoom(0,0,!0,!1))}};a.prototype.reset=function(){this._active={zoom:!1,pan:!1}};a.prototype.convertInput=function(a){var b=window.innerWidth/window.innerHeight;return a instanceof MouseEvent?{x:a.clientX/window.innerWidth*b,y:a.clientY/window.innerHeight}:{x:a.touches[0].pageX/window.innerWidth*b,y:a.touches[0].pageY/
window.innerHeight}};return a}();var module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicLogic={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicLogic.default,"__esModule",{value:!0});var THREE$$module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicLogic=module$src$externals$three.default;
module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicLogic.default.OrthographicLogic=function(){function a(a,c){var b=this;this._settings=a;this._controls=c;this._damping={rotation:{time:0,duration:0,theta:0,phi:0},zoom:{time:0,duration:0,delta:0},pan:{time:0,duration:0,offset:new module$src$externals$three.default.Vector3}};this._dollyStart=this._dollyEnd=this._dollyDelta=0;this._panDelta=new module$src$externals$three.default.Vector2;this._panEnd=new module$src$externals$three.default.Vector2;
this._panStart=new module$src$externals$three.default.Vector2;this._settingsAdjustements={damping:1,movementSmoothness:1,panSpeed:2,zoomSpeed:.025};this._touchAdjustements={damping:1,movementSmoothness:1,panSpeed:2,zoomSpeed:50};this._adjustedSettings={damping:this._settings.getSetting("damping")*this._settingsAdjustements.damping,movementSmoothness:this._settings.getSetting("movementSmoothness")*this._settingsAdjustements.movementSmoothness,panSpeed:this._settings.getSetting("panSpeed")*this._settingsAdjustements.panSpeed,
zoomSpeed:this._settings.getSetting("zoomSpeed")*this._settingsAdjustements.zoomSpeed};Object.keys(this._adjustedSettings).forEach(function(a){b._settings.registerHook(a,function(c){b._adjustedSettings[a]=c*b._settingsAdjustements[a];return!0})})}a.prototype.pan=function(a,c,d,e){e&&(a/=window.devicePixelRatio,c/=window.devicePixelRatio);if(d){if(this._panEnd.set(a,c),this._panDelta.subVectors(this._panEnd,this._panStart),0!==this._panDelta.x||0!==this._panDelta.y)this._panStart.copy(this._panEnd),
a=this.panDeltaToOffset(this._panDelta.multiplyScalar(this._adjustedSettings.panSpeed*(e?this._touchAdjustements.panSpeed:1))),0<this._damping.pan.duration&&(a.x=0>a.x?Math.min(a.x,this._adjustedSettings.movementSmoothness*this._damping.pan.offset.x):Math.max(a.x,this._adjustedSettings.movementSmoothness*this._damping.pan.offset.x),a.y=0>a.y?Math.min(a.y,this._adjustedSettings.movementSmoothness*this._damping.pan.offset.y):Math.max(a.y,this._adjustedSettings.movementSmoothness*this._damping.pan.offset.y),
a.z=0>a.z?Math.min(a.z,this._adjustedSettings.movementSmoothness*this._damping.pan.offset.z):Math.max(a.z,this._adjustedSettings.movementSmoothness*this._damping.pan.offset.z)),e=1-Math.max(.01,Math.min(1,this._adjustedSettings.damping)),c=(Math.log(1/Math.abs(a.x))-5*Math.log(10))/Math.log(e),d=(Math.log(1/Math.abs(a.y))-5*Math.log(10))/Math.log(e),e=(Math.log(1/Math.abs(a.z))-5*Math.log(10))/Math.log(e),this._damping.pan.time=0,this._damping.pan.duration=16.6666*Math.max(c,Math.max(d,e)),this._damping.pan.offset=
a.clone(),this._damping.zoom.duration=0,this._controls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z),!0),this._controls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z),!0)}else this._panStart.set(a,c)};a.prototype.reset=function(){this._damping={rotation:{time:0,duration:0,theta:0,phi:0},zoom:{time:0,duration:0,delta:0},pan:{time:0,duration:0,offset:new module$src$externals$three.default.Vector3}};
this._dollyStart=this._dollyEnd=this._dollyDelta=0;this._panDelta=new module$src$externals$three.default.Vector2;this._panEnd=new module$src$externals$three.default.Vector2;this._panStart=new module$src$externals$three.default.Vector2};a.prototype.update=function(a,c){!0===c&&(this._damping.zoom.duration=0,this._damping.pan.duration=0);var b=1-Math.max(.01,Math.min(1,this._adjustedSettings.damping));0<this._damping.pan.duration?this._damping.pan.time+a>this._damping.pan.duration?(this._damping.pan.time=
this._damping.pan.duration,this._damping.pan.duration=0):(this._damping.pan.time+=a,c=this._damping.pan.time/16.6666,c=this._damping.pan.offset.clone().multiplyScalar(Math.pow(b,c)),this._controls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(c.x,c.y,c.z)),this._controls.applyPositionMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(c.x,c.y,c.z))):this._damping.pan.time=0;0<this._damping.zoom.duration?this._damping.zoom.time+a>this._damping.zoom.duration?
(this._damping.zoom.time=this._damping.zoom.duration,this._damping.zoom.duration=0):(this._damping.zoom.time+=a,c=this._damping.zoom.time/16.6666,a=this._damping.zoom.delta*Math.pow(b,c),a=this._controls.getTargetWithManualUpdates().distanceTo(this._controls.getPositionWithManualUpdates())*(1-a),b=new module$src$externals$three.default.Vector3,c=new module$src$externals$three.default.Vector3,b.copy(this._controls.getTargetWithManualUpdates()).sub(this._controls.getPositionWithManualUpdates()).normalize(),
c.copy(this._controls.getPositionWithManualUpdates().clone().add(b.multiplyScalar(a))),c.sub(this._controls.getTargetWithManualUpdates()),this._controls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(c.x,c.y,c.z),!0)):this._damping.zoom.time=0};a.prototype.zoom=function(a,c,d,e){a=Math.sqrt(a*a+c*c);e&&(a/=window.devicePixelRatio);d?(this._dollyEnd=a,this._dollyDelta=this._dollyEnd-this._dollyStart,this._dollyStart=this._dollyEnd,0<this._damping.zoom.duration&&
(this._dollyDelta=0>this._dollyDelta?Math.min(this._dollyDelta,this._adjustedSettings.movementSmoothness*this._damping.zoom.delta):Math.max(this._dollyDelta,this._adjustedSettings.movementSmoothness*this._damping.zoom.delta)),d=this._dollyDelta*this._adjustedSettings.zoomSpeed*(e?this._touchAdjustements.zoomSpeed:1),e=(Math.log(1/Math.abs(this._dollyDelta))-5*Math.log(10))/Math.log(1-Math.max(.01,Math.min(1,this._adjustedSettings.damping))),this._damping.zoom.time=0,this._damping.zoom.duration=16.6666*
e,this._damping.zoom.delta=d,this._damping.pan.duration=0,d=this._controls.getTargetWithManualUpdates().distanceTo(this._controls.getPositionWithManualUpdates())*(1-d),e=new module$src$externals$three.default.Vector3,a=new module$src$externals$three.default.Vector3,e.copy(this._controls.getTargetWithManualUpdates()).sub(this._controls.getPositionWithManualUpdates()).normalize(),a.copy(this._controls.getPositionWithManualUpdates().clone().add(e.multiplyScalar(d))),a.sub(this._controls.getTargetWithManualUpdates()),
this._controls.applyTargetMatrix((new module$src$externals$three.default.Matrix4).makeTranslation(a.x,a.y,a.z),!0)):this._dollyStart=a};a.prototype.panDeltaToOffset=function(a){var b=new module$src$externals$three.default.Vector3,d=new module$src$externals$three.default.Vector3;b.copy(this._controls.getPositionWithManualUpdates()).sub(this._controls.getTargetWithManualUpdates());b=new module$src$externals$three.default.Vector3;b.setFromMatrixColumn(this._controls.camera.matrix,0);b.multiplyScalar(-(a.x*
(this._controls.camera.right-this._controls.camera.left)*.5/this._controls.camera.zoom));d.add(b);b=new module$src$externals$three.default.Vector3;b.setFromMatrixColumn(this._controls.camera.matrix,1);b.multiplyScalar(a.y*(this._controls.camera.right-this._controls.camera.left)*.5/this._controls.camera.zoom);d.add(b);return d.clone()};return a}();var module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicHooks={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicHooks.default,"__esModule",{value:!0});
module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicHooks.default.OrthographicControlsHooks={damping:function(a){return this._globalUtils.typeCheck(a,"notnegative",this._logWarning,"OrthographicControls.Hook->damping")?!0:!1},enableKeyPan:function(a){return this._globalUtils.typeCheck(a,"boolean",this._logWarning,"OrthographicControls.Hook->enableKeyPan")?!0:!1},enablePan:function(a){return this._globalUtils.typeCheck(a,"boolean",this._logWarning,"OrthographicControls.Hook->enablePan")?
!0:!1},enableZoom:function(a){return this._globalUtils.typeCheck(a,"boolean",this._logWarning,"OrthographicControls.Hook->enableZoom")?!0:!1},input:function(a){return!0},keyPanSpeed:function(a){return this._globalUtils.typeCheck(a,"number",this._logWarning,"OrthographicControls.Hook->keyPanSpeed")?!0:!1},movementSmoothness:function(a){return this._globalUtils.typeCheck(a,"number",this._logWarning,"OrthographicControls.Hook->movementSmoothness")?!0:!1},panSpeed:function(a){return this._globalUtils.typeCheck(a,
"number",this._logWarning,"OrthographicControls.Hook->panSpeed")?!0:!1},zoomSpeed:function(a){return this._globalUtils.typeCheck(a,"notnegative",this._logWarning,"OrthographicControls.Hook->zoomSpeed")?!0:!1}};module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicHooks.default.OrthographicControlsNotifiers={};var module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager={default:{}},__importDefault$$module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager=this&&module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager.default.__importDefault||function(a){return a&&a.__esModule?a:{"default":a}};Object.defineProperty(module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager.default,"__esModule",{value:!0});
var GlobalUtils_js_1$$module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager=__importDefault$$module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager(module$src$shared$util$GlobalUtils.default),OrthographicEventDistribution_1$$module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager=module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicEventDistribution.default,OrthographicLogic_1$$module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager=
module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicLogic.default,HooksAndNotifiers_1$$module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager=module$src$3d$viewport$helpers$HooksAndNotifiers.default,OrthographicHooks_1$$module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager=module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicHooks.default;
module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager.default.OrthographicManager=function(){function a(a,c,d,e){this._settings=a;this._cameraControls=c;this._triggerRender=d;this._logWarning=e;this._globalUtils=GlobalUtils_js_1$$module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager.default;this._cameraLogic=new module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicLogic.default.OrthographicLogic(this._settings,this._cameraControls);
this._cameraEventDistribution=new module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicEventDistribution.default.OrthographicEventDistribution(this._settings,this._cameraControls,this._cameraLogic);this._cameraControls.registerCameraControls(this);module$src$3d$viewport$helpers$HooksAndNotifiers.default.registerHooksAndNotifiers(this,this._settings,module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicHooks.default.OrthographicControlsHooks,module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicHooks.default.OrthographicControlsNotifiers)}
a.prototype.isWithinRestrictions=function(a,c){return!0};a.prototype.onKeyDown=function(a){this._cameraEventDistribution.onKeyDown(a)};a.prototype.onMouseDown=function(a){this._cameraEventDistribution.onMouseDown(a)};a.prototype.onMouseMove=function(a){this._cameraEventDistribution.onMouseMove(a)};a.prototype.onMouseUp=function(a){this._cameraEventDistribution.onMouseUp(a)};a.prototype.onMouseWheel=function(a){this._cameraEventDistribution.onMouseWheel(a)};a.prototype.onTouchEnd=function(a){this._cameraEventDistribution.onTouchEnd(a)};
a.prototype.onTouchMove=function(a){this._cameraEventDistribution.onTouchMove(a)};a.prototype.onTouchStart=function(a){this._cameraEventDistribution.onTouchStart(a)};a.prototype.reset=function(){this._cameraEventDistribution.reset();this._cameraLogic.reset()};a.prototype.restrict=function(a,c){return{position:a,target:c}};a.prototype.update=function(a,c){this._cameraLogic.update(a,c)};return a}();var module$src$3d$viewport$handlers$camera$OrthographicCameraHandler={default:{}},__extends$$module$src$3d$viewport$handlers$camera$OrthographicCameraHandler=this&&module$src$3d$viewport$handlers$camera$OrthographicCameraHandler.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,
c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(module$src$3d$viewport$handlers$camera$OrthographicCameraHandler.default,"__esModule",{value:!0});
var BaseCameraHandler_1$$module$src$3d$viewport$handlers$camera$OrthographicCameraHandler=module$src$3d$viewport$handlers$camera$BaseCameraHandler.default,THREE$$module$src$3d$viewport$handlers$camera$OrthographicCameraHandler=module$src$externals$three.default,HooksAndNotifiers_1$$module$src$3d$viewport$handlers$camera$OrthographicCameraHandler=module$src$3d$viewport$helpers$HooksAndNotifiers.default,OrthographicCameraHooksAndNotifiers_1$$module$src$3d$viewport$handlers$camera$OrthographicCameraHandler=
module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers.default,CameraControls_1$$module$src$3d$viewport$handlers$camera$OrthographicCameraHandler=module$src$3d$viewport$handlers$camera$controls$CameraControls.default,OrthographicManager_1$$module$src$3d$viewport$handlers$camera$OrthographicCameraHandler=module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager.default,ICameraHandler_1$$module$src$3d$viewport$handlers$camera$OrthographicCameraHandler=
module$src$3d$viewport$interfaces$ICameraHandler.default;
module$src$3d$viewport$handlers$camera$OrthographicCameraHandler.default.OrthographicCameraHandler=function(a){function b(b,d){var c=a.call(this,b,d)||this;c._defaultSettings={near:.01,far:1E4};c._orthographicSettings=c._settings.getSection("cameraTypes.orthographic");c._camera=new module$src$externals$three.default.OrthographicCamera(b.container.offsetWidth/b.container.offsetHeight,b.container.offsetWidth/b.container.offsetHeight,1,-1,c._defaultSettings.near,c._defaultSettings.far);c._camera.up.set(0,
0,1);c._camera.aspect=b.container.offsetWidth/b.container.offsetHeight;c._handlers.threeDManager.helpers.addSceneObject(c._camera);b=c._orthographicSettings.getSetting("default");0===b.position.x&&0===b.position.y&&0===b.position.z&&0===b.target.x&&0===b.target.y&&0===b.target.z&&(b=c.getZoomExtentsPosition());c._cameraControls=new module$src$3d$viewport$handlers$camera$controls$CameraControls.default.CameraControls(c._camera,b,c._handlers.renderingHandler.getDomElement(),function(){c._handlers.renderingHandler.registerForContinuousRendering(c.CAMERA_MOVING_ID)},
c.cameraMovementEventDispatch.bind(c),function(){var a=c._cameraControls.position.distanceTo(c._cameraControls.target)/2;c._camera.left=-a*c._camera.aspect;c._camera.bottom=-a;c._camera.right=a*c._camera.aspect;c._camera.top=a;c._camera.near=c._defaultSettings.near*a;c._camera.far=c._defaultSettings.far*a;c._camera.updateProjectionMatrix()});c._cameraControlsManager=new module$src$3d$viewport$handlers$camera$controls$orthographic$OrthographicManager.default.OrthographicManager(c._settings.getSection("controls.orthographic"),
c._cameraControls,c._handlers.renderingHandler.render,c._handlers.threeDManager.warn);module$src$3d$viewport$helpers$HooksAndNotifiers.default.registerHooksAndNotifiers(c,c._orthographicSettings,module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers.default.OrthographicCameraHooks,module$src$3d$viewport$handlers$camera$hooks$OrthographicCameraHooksAndNotifiers.default.OrthographicCameraNotifiers);return c}__extends$$module$src$3d$viewport$handlers$camera$OrthographicCameraHandler(b,
a);b.prototype.activate=function(){this.resume();this.zoomExtents({duration:0});this._camera.updateProjectionMatrix();this._handlers.materialHandler.setSceneBackground(null)};b.prototype.adjustToBoundingSphere=function(a){this._sceneBS=a;a=this._cameraControls.position.distanceTo(this._cameraControls.target)/2;this._camera.near=this._defaultSettings.near*a;this._camera.far=this._defaultSettings.far*a;this._camera.updateProjectionMatrix()};b.prototype.deactivate=function(){this.pause()};b.prototype.getZoomExtentsPosition=
function(a){var b=this._sceneBS;a&&a.getBoundingSphere(b);a=new module$src$externals$three.default.Vector3;var c=new module$src$externals$three.default.Vector3;switch(this._settings.getSetting("cameraTypes.active")){case module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.TOP:a.set(b.center.x,b.center.y,b.center.z+2*b.radius);break;case module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.BOTTOM:a.set(b.center.x,b.center.y,b.center.z-2*b.radius);break;case module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.RIGHT:a.set(b.center.x+
2*b.radius,b.center.y,b.center.z);break;case module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.LEFT:a.set(b.center.x-2*b.radius,b.center.y,b.center.z);break;case module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.BACK:a.set(b.center.x,b.center.y+2*b.radius,b.center.z);break;case module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.FRONT:a.set(b.center.x,b.center.y-2*b.radius,b.center.z);break;default:a.set(b.center.x,b.center.y,b.center.z+2*b.radius)}c.set(b.center.x,
b.center.y,b.center.z);return{position:a,target:c}};b.prototype.onResize=function(a,b){this._camera.aspect=a/b;this._camera.left=-this._sceneBS.radius*this._camera.aspect;this._camera.right=this._sceneBS.radius*this._camera.aspect;this._camera.updateProjectionMatrix()};b.prototype.resetPositionAndTarget=function(a){var b=this._orthographicSettings.getSetting("default");0===b.position.x&&0===b.position.y&&0===b.position.z&&0===b.target.x&&0===b.target.y&&0===b.target.z&&(b=this.getZoomExtentsPosition());
return this.setPositionAndTarget(b.position,b.target,a)};b.prototype.setCameraPath=function(a,b){if(!a||!Array.isArray(a)||0===a.length)return Promise.resolve(!1);b||(b={});b.duration=0<=b.duration?b.duration:this._settings.getSetting("cameraMovementDuration");for(var c=[],d=0;d<a.length;d++){var h=a[d];if(!this._globalUtils.typeCheck(h.position,"vector3any",this._handlers.threeDManager.warn,"OrthographicCameraHandler.setCameraPath")||!this._globalUtils.typeCheck(h.target,"vector3any",this._handlers.threeDManager.warn,
"OrthographicCameraHandler.setCameraPath"))return Promise.resolve(!1);var g=this._globalUtils.toVector3(h.position);h=this._globalUtils.toVector3(h.target);if(c.length+1===a.length){if(!this._cameraControls.isWithinRestrictions(g,h))return Promise.resolve(!1);b.default&&(this._orthographicSettings.updateSetting("default.position",g),this._orthographicSettings.updateSetting("default.target",h))}h=this.convertTargetForCurrentSide(g,h,g.distanceTo(h)/2,this._settings.getSetting("cameraTypes.active"));
c.push({position:g,target:h})}!1===this._firstTimeVisible.resolved&&(b.duration=0);return this._cameraControls.animate(c,b)};b.prototype.setPositionAndTarget=function(a,b,e){if(!this._globalUtils.typeCheck(a,"vector3any",this._handlers.threeDManager.warn,"OrthographicCameraHandler.setPositionAndTarget")||!this._globalUtils.typeCheck(b,"vector3any",this._handlers.threeDManager.warn,"OrthographicCameraHandler.setPositionAndTarget"))return Promise.resolve(!1);a=this._globalUtils.toVector3(a);b=this._globalUtils.toVector3(b);
e||(e={});e.duration=0<=e.duration?e.duration:this._settings.getSetting("cameraMovementDuration");e.coordinates="Linear";if(!this._cameraControls.isWithinRestrictions(a,b))return Promise.resolve(!1);e.default&&(this._orthographicSettings.updateSetting("default.position",a),this._orthographicSettings.updateSetting("default.target",b));b=this.convertTargetForCurrentSide(a,b,a.distanceTo(b)/2,this._settings.getSetting("cameraTypes.active"));var c=this._settings.getSetting("cameraTypes.active");this._camera.up.set(0,
c===module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.TOP?1:c===module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.BOTTOM?-1:0,c===module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.TOP||c===module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.BOTTOM?0:1);this._camera.updateProjectionMatrix();!1===this._firstTimeVisible.resolved&&(e.duration=0);return this._cameraControls.animate([{position:this._cameraControls.position.clone(),target:this._cameraControls.target.clone()},
{position:a,target:b}],e)};b.prototype.zoomExtents=function(a,b){b=b?b instanceof module$src$externals$three.default.Box3?b:this._globalUtils.typeCheck(b,"box3any")?new module$src$externals$three.default.Box3(this._globalUtils.toVector3(b.min),this._globalUtils.toVector3(b.max)):this._handlers.threeDManager.computeBoundingBox(b):this._handlers.threeDManager.computeBoundingBox();b=this.getZoomExtentsPosition(b);return this.setPositionAndTarget(b.position,b.target,a)};b.prototype.convertTargetForCurrentSide=
function(a,b,e,f){switch(f){case module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.TOP:b.set(a.x,a.y,a.z-2*e);break;case module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.BOTTOM:b.set(a.x,a.y,a.z+2*e);break;case module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.RIGHT:b.set(a.x-2*e,a.y,a.z);break;case module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.LEFT:b.set(a.x+2*e,a.y,a.z);break;case module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.BACK:b.set(a.x,
a.y-2*e,a.z);break;case module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.FRONT:b.set(a.x,a.y+2*e,a.z);break;default:b.set(a.x,a.y,a.z-2*e)}return b};return b}(module$src$3d$viewport$handlers$camera$BaseCameraHandler.default.BaseCameraHandler);var module$src$3d$viewport$handlers$camera$ProxyCameraHandler={default:{}};Object.defineProperty(module$src$3d$viewport$handlers$camera$ProxyCameraHandler.default,"__esModule",{value:!0});
var ICameraHandler_1$$module$src$3d$viewport$handlers$camera$ProxyCameraHandler=module$src$3d$viewport$interfaces$ICameraHandler.default,PerspectiveCameraHandler_1$$module$src$3d$viewport$handlers$camera$ProxyCameraHandler=module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler.default,OrthographicCameraHandler_1$$module$src$3d$viewport$handlers$camera$ProxyCameraHandler=module$src$3d$viewport$handlers$camera$OrthographicCameraHandler.default;
module$src$3d$viewport$handlers$camera$ProxyCameraHandler.default.ProxyCameraHandler=function(){function a(a,c){var b=this;this._handlers=c;this.activate=function(){};this.adjustToBoundingSphere=function(a){b._perspectiveCameraHandler.adjustToBoundingSphere(a);b._orthographicCameraHandler.adjustToBoundingSphere(a)};this.deactivate=function(){};this.decreaseEventListenerCounter=function(){return b._cameraHandler.decreaseEventListenerCounter()};this.destroy=function(){b._perspectiveCameraHandler.destroy();
b._orthographicCameraHandler.destroy()};this.getPositionAndTarget=function(){return b._cameraHandler.getPositionAndTarget()};this.getZoomExtentsPosition=function(a){return b._cameraHandler.getZoomExtentsPosition(a)};this.increaseEventListenerCounter=function(){return b._cameraHandler.increaseEventListenerCounter()};this.onResize=function(a,c){b._perspectiveCameraHandler.onResize(a,c);b._orthographicCameraHandler.onResize(a,c)};this.pause=function(){return b._cameraHandler.pause()};this.resetPositionAndTarget=
function(a){return b._cameraHandler.resetPositionAndTarget(a)};this.resume=function(){return b._cameraHandler.resume()};this.setCameraPath=function(a,c){return b._cameraHandler.setCameraPath(a,c)};this.setPositionAndTarget=function(a,c,d){return b._cameraHandler.setPositionAndTarget(a,c,d)};this.setViewAndProjectionMatrix=function(a,c){return b._cameraHandler.setViewAndProjectionMatrix(a,c)};this.updateCameraControls=function(a){return b._cameraHandler.updateCameraControls(a)};this.zoomExtents=function(a,
c){return b._cameraHandler.zoomExtents(a,c)};this._settings=a.settings;this._perspectiveCameraHandler=new module$src$3d$viewport$handlers$camera$PerspectiveCameraHandler.default.PerspectiveCameraHandler(a,this._handlers);this._orthographicCameraHandler=new module$src$3d$viewport$handlers$camera$OrthographicCameraHandler.default.OrthographicCameraHandler(a,this._handlers);this._cameraHandler=this._perspectiveCameraHandler;this._perspectiveCameraHandler.resume();this._orthographicCameraHandler.pause();
this._settings.registerNotifier("cameraTypes.active",function(){b._cameraHandler.deactivate();b._cameraHandler=b._settings.getSetting("cameraTypes.active")===module$src$3d$viewport$interfaces$ICameraHandler.default.CameraType.PERSPECTIVE?b._perspectiveCameraHandler:b._orthographicCameraHandler;b._cameraHandler.activate();b._handlers.renderingHandler.render();return!0})}Object.defineProperty(a.prototype,"camera",{get:function(){return this._cameraHandler.camera},enumerable:!0,configurable:!0});return a}();var module$src$3d$interfaces$handlers$LightHandlerInterface={default:function(){}};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.pause=function(){};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.resume=function(){};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.destroy=function(){};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.updateLight=function(a){};
module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.removeLight=function(a){};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.getLight=function(a){};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.setLightSceneFromID=function(a){};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.setLightSceneFromDefinition=function(a){};
module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.getLightScene=function(a){};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.getAllLightScene=function(){};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.saveLightScene=function(a){};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.adjustToBoundingSphere=function(a){};
module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.setToggleLightShadows=function(a){};module$src$3d$interfaces$handlers$LightHandlerInterface.default.prototype.toggleLights=function(a){};var module$src$3d$viewport$defaults$DefaultLights={},THREE$$module$src$3d$viewport$defaults$DefaultLights=module$src$externals$three.default,GLOBAL_UTILS$$module$src$3d$viewport$defaults$DefaultLights=module$src$shared$util$GlobalUtils.default,lightScenes$$module$src$3d$viewport$defaults$DefaultLights={"default":{id:"default",lights:{ambient0:{id:"ambient0",type:"ambient",properties:{color:16777215,intensity:.5}},directional0:{id:"directional0",type:"directional",properties:{color:16777215,intensity:.75,
direction:{x:.5774,y:-.5774,z:.5774},castShadow:!0}},directional1:{id:"directional1",type:"directional",properties:{color:16777215,intensity:.35,direction:{x:-.25,y:-1,z:1},castShadow:!1}}}},legacy:{id:"legacy",lights:{ambient0:{id:"ambient0",type:"ambient",properties:{color:6579300,intensity:1}},directional0:{id:"directional0",type:"directional",properties:{color:16777215,intensity:1,castShadow:!0,direction:{x:.5774,y:-.5774,z:.5774}}},flash:{id:"flash0",type:"flash",properties:{color:16777215,intensity:.4,
distance:0,angle:Math.PI/2,penumbra:5,decay:5}}}}},lightProperties$$module$src$3d$viewport$defaults$DefaultLights={ambient:{color:{type:"color",default:16777215},intensity:{type:"notnegative",default:.5}},directional:{color:{type:"color",default:16777215},intensity:{type:"notnegative",default:.5},castShadow:{type:"boolean",default:!1},direction:{type:"vector3any",default:{x:-1,y:0,z:1}}},hemisphere:{skyColor:{type:"color",default:16777215},groundColor:{type:"color",default:16777215},intensity:{type:"notnegative",
default:.5}},point:{color:{type:"color",default:16777215},intensity:{type:"notnegative",default:.5},distance:{type:"notnegative",default:0},decay:{type:"notnegative",default:2},position:{type:"vector3any",default:{x:0,y:0,z:0}}},spot:{color:{type:"color",default:16777215},intensity:{type:"notnegative",default:.5},distance:{type:"notnegative",default:0},angle:{type:"notnegative",default:Math.PI/4},penumbra:{type:"notnegative",default:.5},decay:{type:"notnegative",default:1},position:{type:"vector3any",
default:{x:1,y:1,z:1}},target:{type:"vector3any",default:{x:0,y:0,z:0}}},flash:{color:{type:"color",default:16777215},intensity:{type:"notnegative",default:.4},distance:{type:"notnegative",default:0},angle:{type:"notnegative",default:Math.PI/2},penumbra:{type:"notnegative",default:5},decay:{type:"notnegative",default:5}}},lightTypes$$module$src$3d$viewport$defaults$DefaultLights={AMBIENT:"ambient",DIRECTIONAL:"directional",HEMISPHERE:"hemisphere",POINT:"point",SPOT:"spot",FLASH:"flash"},clampingFactor$$module$src$3d$viewport$defaults$DefaultLights=
230/255,initFunction$$module$src$3d$viewport$defaults$DefaultLights={ambient:function(a,b,c){var d=module$src$shared$util$GlobalUtils.default.toTinyColor(a.properties.color).toThreeColor();a=new module$src$externals$three.default.AmbientLight(d,a.properties.intensity);b.add(a);b=new module$src$externals$three.default.Object3D;c.add(b);return{light:a,helper:new module$src$externals$three.default.Object3D}},directional:function(a,b,c,d,e,f){var h=module$src$shared$util$GlobalUtils.default.toTinyColor(a.properties.color).toThreeColor(),
g=new module$src$externals$three.default.DirectionalLight(h,a.properties.intensity),k=new module$src$externals$three.default.Object3D;b.add(k);g.target=k;b.add(g);g.direction=module$src$shared$util$GlobalUtils.default.toVector3(a.properties.direction).normalize();g.position.set(d.center.x+g.direction.x*d.radius*2.35,d.center.y+g.direction.y*d.radius*2.35,d.center.z+g.direction.z*d.radius*2.35);g.target.position.set(d.center.x,d.center.y,d.center.z);a.properties.castShadow&&(g.shadows=!0,g.castShadow=
e?!1:f,g.shadow.camera.up.set(0,0,1),g.shadow.camera.far=8*d.radius,g.shadow.camera.right=1.5*d.radius,g.shadow.camera.left=-1.5*d.radius,g.shadow.camera.top=1.5*d.radius,g.shadow.camera.bottom=-1.5*d.radius,g.shadow.mapSize.width=2048,g.shadow.mapSize.height=2048,g.shadow.radius=2,g.shadow.bias=-.00175,g.shadow.camera.updateProjectionMatrix());a=new module$src$externals$three.default.ArrowHelper(g.direction.clone().multiplyScalar(-1),g.position,g.target.position.distanceTo(g.position),h.clone().multiplyScalar(clampingFactor$$module$src$3d$viewport$defaults$DefaultLights));
a.cone.material.wireframe=!0;c.add(a);return{light:g,helper:a}},hemisphere:function(a,b,c){var d=module$src$shared$util$GlobalUtils.default.toTinyColor(a.properties.skyColor).toThreeColor(),e=module$src$shared$util$GlobalUtils.default.toTinyColor(a.properties.groundColor).toThreeColor();a=new module$src$externals$three.default.HemisphereLight(d,e,a.properties.intensity);a.position.set(0,0,1);a.up.set(0,0,1);b.add(a);b=new module$src$externals$three.default.Object3D;c.add(b);return{light:a,helper:b}},
point:function(a,b,c,d){var e=module$src$shared$util$GlobalUtils.default.toTinyColor(a.properties.color).toThreeColor(),f=new module$src$externals$three.default.PointLight(e,a.properties.intensity,a.properties.distance,a.properties.decay);f.position.set(a.properties.position.x,a.properties.position.y,a.properties.position.z);b.add(f);b=new module$src$externals$three.default.IcosahedronBufferGeometry(d.radius/10,0);e=new module$src$externals$three.default.MeshBasicMaterial({color:e.clone().multiplyScalar(clampingFactor$$module$src$3d$viewport$defaults$DefaultLights),
wireframe:!0,fog:!1});e=new module$src$externals$three.default.Mesh(b,e);b=new module$src$externals$three.default.Object3D;b.add(e);b.position.set(a.properties.position.x,a.properties.position.y,a.properties.position.z);c.add(b);return{light:f,helper:b}},spot:function(a,b,c){var d=module$src$shared$util$GlobalUtils.default.toTinyColor(a.properties.color).toThreeColor(),e=(new module$src$externals$three.default.Vector3(a.properties.position.x,a.properties.position.y,a.properties.position.z)).distanceTo(new module$src$externals$three.default.Vector3(a.properties.target.x,
a.properties.target.y,a.properties.target.z));e=new module$src$externals$three.default.SpotLight(d,a.properties.intensity,e,a.properties.angle,a.properties.penumbra,a.properties.decay);var f=new module$src$externals$three.default.Object3D;b.add(f);e.target=f;e.position.set(a.properties.position.x,a.properties.position.y,a.properties.position.z);e.target.position.set(a.properties.target.x,a.properties.target.y,a.properties.target.z);e.up.set(0,0,1);b.add(e);a=new module$src$externals$three.default.SpotLightHelper(e,
d.clone().multiplyScalar(clampingFactor$$module$src$3d$viewport$defaults$DefaultLights));a.up.set(0,0,1);c.add(a);return{light:e,helper:a}},flash:function(a,b,c){var d=module$src$shared$util$GlobalUtils.default.toTinyColor(a.properties.color).toThreeColor();a=new module$src$externals$three.default.SpotLight(d,a.properties.intensity,a.properties.distance,a.properties.angle,a.properties.penumbra,a.properties.decay);a.position.set(0,0,1);a.target=b.cameraHandler.camera;b.cameraHandler.camera.add(a);
b=new module$src$externals$three.default.Object3D;c.add(b);return{light:a,helper:b}}},updateFunction$$module$src$3d$viewport$defaults$DefaultLights={ambient:function(a,b){var c=module$src$shared$util$GlobalUtils.default.toTinyColor(a.properties.color).toThreeColor();b.light.color=c;b.light.intensity=a.properties.intensity},directional:function(a,b,c,d,e){var f=module$src$shared$util$GlobalUtils.default.toTinyColor(a.properties.color).toThreeColor();b.light.color=f;b.light.intensity=a.properties.intensity;
b.light.direction=module$src$shared$util$GlobalUtils.default.toVector3(a.properties.direction).normalize();b.light.position.set(c.center.x+b.light.direction.x*c.radius*2.35,c.center.y+b.light.direction.y*c.radius*2.35,c.center.z+b.light.direction.z*c.radius*2.35);b.light.target.position.set(c.center.x,c.center.y,c.center.z);b.light.shadows!==a.properties.castShadow&&(a.properties.castShadow?(b.light.shadows=!0,b.light.castShadow=d?!1:e,b.light.shadow.camera.up.set(0,0,1),b.light.shadow.camera.far=
8*c.radius,b.light.shadow.camera.right=1.5*c.radius,b.light.shadow.camera.left=-1.5*c.radius,b.light.shadow.camera.top=1.5*c.radius,b.light.shadow.camera.bottom=-1.5*c.radius,b.light.shadow.mapSize.width=2048,b.light.shadow.mapSize.height=2048,b.light.shadow.radius=2,b.light.shadow.bias=-.00175,b.light.shadow.camera.updateProjectionMatrix()):(b.light.shadows=!1,b.light.castShadow=!1));b.helper.setColor(f.clone().multiplyScalar(clampingFactor$$module$src$3d$viewport$defaults$DefaultLights));b.helper.setDirection(b.light.direction.clone().multiplyScalar(-1));
b.helper.position.set(b.light.position.x,b.light.position.y,b.light.position.z);b.helper.setLength(b.light.target.position.distanceTo(b.light.position))},hemisphere:function(a,b){b.light.intensity=a.properties.intensity;var c=module$src$shared$util$GlobalUtils.default.toTinyColor(a.properties.skyColor).toThreeColor();a=module$src$shared$util$GlobalUtils.default.toTinyColor(a.properties.groundColor).toThreeColor();if(b.light.color!=c||b.light.groundColor!=a)b.light.color=c,b.light.groundColor=a},point:function(a,
b){var c=module$src$shared$util$GlobalUtils.default.toTinyColor(a.properties.color).toThreeColor();b.light.color=c;b.light.intensity=a.properties.intensity;b.light.distance=a.properties.distance;b.light.decay=a.properties.decay;b.light.position.set(a.properties.position.x,a.properties.position.y,a.properties.position.z);b.helper.children[0].material.color=c.clone().multiplyScalar(clampingFactor$$module$src$3d$viewport$defaults$DefaultLights);b.helper.position.set(a.properties.position.x,a.properties.position.y,
a.properties.position.z)},spot:function(a,b){var c=module$src$shared$util$GlobalUtils.default.toTinyColor(a.properties.color).toThreeColor();b.light.color=c;b.light.intensity=a.properties.intensity;var d=(new module$src$externals$three.default.Vector3(a.properties.position.x,a.properties.position.y,a.properties.position.z)).distanceTo(new module$src$externals$three.default.Vector3(a.properties.target.x,a.properties.target.y,a.properties.target.z));b.light.distance=d;b.light.angle=a.properties.angle;
b.light.penumbra=a.properties.penumbra;b.light.decay=a.properties.decay;b.light.position.set(a.properties.position.x,a.properties.position.y,a.properties.position.z);b.light.target.position.set(a.properties.target.x,a.properties.target.y,a.properties.target.z);b.helper.color=c.clone().multiplyScalar(clampingFactor$$module$src$3d$viewport$defaults$DefaultLights);b.helper.update()},flash:function(a,b){var c=module$src$shared$util$GlobalUtils.default.toTinyColor(a.properties.color).toThreeColor();b.light.color=
c;b.light.intensity=a.properties.intensity;b.light.distance=a.properties.distance;b.light.angle=a.properties.angle;b.light.penumbra=a.properties.penumbra;b.light.decay=a.properties.decay}};
module$src$3d$viewport$defaults$DefaultLights.default={lightScenes:lightScenes$$module$src$3d$viewport$defaults$DefaultLights,lightProperties:lightProperties$$module$src$3d$viewport$defaults$DefaultLights,lightTypes:lightTypes$$module$src$3d$viewport$defaults$DefaultLights,lightInit:initFunction$$module$src$3d$viewport$defaults$DefaultLights,lightUpdate:updateFunction$$module$src$3d$viewport$defaults$DefaultLights};var module$src$3d$viewport$handlers$LightHandler={default:function(a,b){var c=module$src$3d$viewport$defaults$DefaultLights.default.lightTypes,d=module$src$3d$viewport$defaults$DefaultLights.default.lightInit,e=module$src$3d$viewport$defaults$DefaultLights.default.lightUpdate,f=a.settings,h,g=new module$src$externals$three.default.Object3D,k=new module$src$externals$three.default.Object3D,l=new module$src$externals$three.default.Object3D,m=new module$src$externals$three.default.Object3D,n=new module$src$externals$three.default.Sphere,
r=!1,u=a.shadows,p={},q=module$src$3d$viewport$defaults$DefaultLights.default.lightScenes,t={},v=module$src$3d$viewport$defaults$DefaultLights.default.lightProperties,w=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string",b.threeDManager.warn,"LightHandler.Hook->lightScene"))return!1;if(!q[a]&&!t[a])return b.threeDManager.warn("LightHandler.Hook->lightScene","The provided light scene is not available."),!1;if(q[a]===p.id||t[a]===p.id)return b.threeDManager.warn("LightHandler.Hook->lightScene",
"The current light scene is already set to this value."),!1;p.id!==a&&h.setLightSceneFromID(a);return!0},x=function(a){t=a;return!0},y=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",b.threeDManager.warn,"LightHandler.Hook->helper"))return!1;m.visible=a;b.renderingHandler.updateShadowMap();b.renderingHandler.render();return!0},A=function(){module$src$3d$interfaces$handlers$LightHandlerInterface.default.call(this);h=this;b.threeDManager.helpers.addSceneObject(g);g.add(l);
g.add(m);g.visible=b.threeDManager.getSetting("camera.type")==module$src$3d$viewport$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE;m.visible=f.getSetting("helper");b.threeDManager.helpers.addSceneObject(k);k.add(new module$src$externals$three.default.AmbientLight(16777215,1));k.visible=b.threeDManager.getSetting("camera.type")!=module$src$3d$viewport$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE;n.radius=25;p=JSON.parse(JSON.stringify(q["default"]));for(var a in p.lights)h.updateLight(p.lights[a]);
p.wasUpdated=!1;p.id="default";f.registerHook("lightScene",w);f.registerHook("lightScenes",x);f.registerHook("helper",y)};$jscomp.inherits(A,module$src$3d$interfaces$handlers$LightHandlerInterface.default);A.prototype.pause=function(){};A.prototype.resume=function(){};A.prototype.destroy=function(){};A.prototype._getCleanLightScene=function(a){a=JSON.parse(JSON.stringify(a));delete a.wasUpdated;for(var b in a.lights)delete a.lights[b].lightObject,delete a.lights[b].wasUpdated;return a};A.prototype._updateLightObject=
function(a,f){if(!f)a.type===c.DIRECTIONAL?f=d[c.DIRECTIONAL](a,l,m,n,r,u):a.type===c.AMBIENT?f=d[c.AMBIENT](a,l,m):a.type===c.HEMISPHERE?f=d[c.HEMISPHERE](a,l,m):a.type===c.POINT?f=d[c.POINT](a,l,m,n):a.type===c.SPOT?f=d[c.SPOT](a,l,m):a.type===c.FLASH&&(f=d[c.FLASH](a,b,m),f.visible=b.threeDManager.getSetting("camera.type")==module$src$3d$viewport$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE),a.lightObject=f;else if(a.type===c.DIRECTIONAL)e[c.DIRECTIONAL](a,f,n,r,u);else if(a.type===
c.AMBIENT)e[c.AMBIENT](a,f);else if(a.type===c.HEMISPHERE)e[c.HEMISPHERE](a,f);else if(a.type===c.POINT)e[c.POINT](a,f);else if(a.type===c.SPOT)e[c.SPOT](a,f);else if(a.type===c.FLASH)e[c.FLASH](a,f)};A.prototype._createDefault=function(a){var b={},d;for(d in v[a])b[d]=v[a][d].default;a===c.SPOT?(a=n.center.clone().add((new module$src$externals$three.default.Vector3(1,0,1)).normalize().multiplyScalar(2*n.radius)),b.position={x:a.x,y:a.y,z:a.z},b.target={x:n.center.x,y:n.center.y,z:n.center.z}):a===
c.POINT&&(a=n.center.clone().add((new module$src$externals$three.default.Vector3(0,0,1)).normalize().multiplyScalar(n.radius)),b.position={x:a.x,y:a.y,z:a.z});return b};A.prototype._evaluateProperties=function(a,b,c){for(var d in c.properties)void 0!==b[d]&&null!==b[d]&&v[a][d]&&module$src$shared$util$GlobalUtils.default.typeCheck(b[d],v[a][d].type)&&(c.properties[d]=b[d]);return c};A.prototype._parseLightDefinition=function(a,b){if(!a.id||!module$src$shared$util$GlobalUtils.default.typeCheck(a.id,
"string")){a.id=0===Object.keys(t).length?"scene":"scene_"+Object.keys(t).length;for(var d=Object.keys(t).length;t[a.id];)a.id="scene_"+d++}if(!a.type||-1===Object.values(c).indexOf(a.type))return null;b||(b={},b.id=a.id,b.type=a.type,b.properties=h._createDefault(a.type));return h._evaluateProperties(a.type,a.properties,b)};A.prototype.updateLight=function(a){var c=h._parseLightDefinition(a,a.id&&module$src$shared$util$GlobalUtils.default.typeCheck(a.id,"string")?p.lights[a.id]:null);if(!c||c.type!==
a.type)return!1;h._updateLightObject(c,c.lightObject);p.lights[c.id]=c;if(!p.wasUpdated)for(p.wasUpdated=!0,p.id=0===Object.keys(t).length?"scene":"scene_"+Object.keys(t).length,a=Object.keys(t).length;t[p.id];)p.id="scene_"+a++;b.renderingHandler.updateShadowMap();b.renderingHandler.render();return!0};A.prototype.removeLight=function(a){return a&&module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")?(m.remove(p.lights[a].lightObject.helper),p.lights[a].lightObject.light.target&&l.remove(p.lights[a].lightObject.light.target),
l.remove(p.lights[a].lightObject.light),p.lights[a].type===c.FLASH?b.cameraHandler.camera.remove(p.lights[a].lightObject.light):l.remove(p.lights[a].lightObject.light),delete p.lights[a].lightObject,delete p.lights[a],p.wasUpdated||(p.wasUpdated=!0,p.id=module$src$shared$util$GlobalUtils.default.createRandomId()),b.renderingHandler.updateShadowMap(),b.renderingHandler.render(),!0):!1};A.prototype.getLight=function(a){return h._getCleanLightScene(p).lights[a]};A.prototype.setLightSceneFromID=function(a){if(a&&
module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")&&(q[a]||t[a])){for(var b in p.lights)h.removeLight(b);var c;q[a]?c=JSON.parse(JSON.stringify(q[a])):t[a]&&(c=JSON.parse(JSON.stringify(t[a])));for(var d in c.lights)h.updateLight(c.lights[d]);p.id=c.id;p.wasUpdated=!1;f.updateSetting("lightScene",a);return!0}return!1};A.prototype.setLightSceneFromDefinition=function(a){a.id&&module$src$shared$util$GlobalUtils.default.typeCheck(a.id,"string")&&!q[a.id]||(a.id=module$src$shared$util$GlobalUtils.default.createRandomId());
for(var b in p.lights)h.removeLight(b);p={id:a.id,wasUpdated:!1,lights:{}};for(var c in a.lights)h.updateLight(a.lights[c]);h.saveLightScene(a.id);return p.id};A.prototype.getLightScene=function(a){if(a){if(q[a])return h._getCleanLightScene(q[a]);if(t[a])return h._getCleanLightScene(t[a])}else return h._getCleanLightScene(p)};A.prototype.getAllLightScenes=function(){return Object.keys(q).concat(Object.keys(t))};A.prototype.saveLightScene=function(a){if(!a||!module$src$shared$util$GlobalUtils.default.typeCheck(a,
"string")||q[a]){a=0===Object.keys(t).length?"scene":"scene_"+Object.keys(t).length;for(var b=Object.keys(t).length;t[a];)a="scene_"+b++}p.id=a;p.wasUpdated=!1;t[a]=h._getCleanLightScene(p);f.updateSetting("lightScenes",t);f.updateSetting("lightScene",a);return a};A.prototype.adjustToBoundingSphere=function(a){n=a;for(var c in p.lights){var d=p.lights[c].lightObject.light,e=p.lights[c].lightObject.helper;d.isDirectionalLight?(d.position.set(a.center.x+d.direction.x*a.radius*2.35,a.center.y+d.direction.y*
a.radius*2.35,a.center.z+d.direction.z*a.radius*2.35),d.target.position.set(a.center.x,a.center.y,a.center.z),e.setDirection(d.direction.clone().multiplyScalar(-1)),e.position.set(d.position.x,d.position.y,d.position.z),e.setLength(d.target.position.distanceTo(d.position)),d.shadows&&(d.shadow.camera.far=8*a.radius,d.shadow.camera.right=1.5*a.radius,d.shadow.camera.left=-1.5*a.radius,d.shadow.camera.top=1.5*a.radius,d.shadow.camera.bottom=-1.5*a.radius,d.shadow.camera.updateProjectionMatrix())):d.isPointLight&&
(e.children[0].geometry.radius=n.radius/10)}b.renderingHandler.updateShadowMap()};A.prototype.adaptLightingToCameraType=function(a){g.visible=a==module$src$3d$viewport$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE;k.visible=a!=module$src$3d$viewport$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE;for(var b in p.lights){var d=p.lights[b];d.type===c.FLASH&&(d.lightObject.visible=a==module$src$3d$viewport$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE)}return!0};A.prototype.setToggleLightShadows=
function(a){u=a;for(a=0;a<l.children.length;a++)l.children[a].shadows&&(l.children[a].castShadow=r?!1:u)};A.prototype.shadowSettingOverride=function(a){r||(r=a);r&&(b.threeDManager.warn("LightHandler","Due to restrictions to the number of maps that can be used with this device, the shadows were disabled."),h.setToggleLightShadows())};A.prototype.reevaluateNumberOfShadowMaps=function(a){for(var c=b.threeDManager.helpers.getMaterials(),d=0,e=c.length;d<e;d++){var f=c[d];f.availableTextures&&(a=Math.min(a,
f.availableTextures))}for(d=c=0;d<l.children.length;d++)l.children[d].castShadow&&c++;h.shadowSettingOverride(c-1>=a)};A.prototype.toggleLights=function(a){l.visible=a};return new A(a)}};var module$src$3d$viewport$handlers$HighlightingHandler={default:function(a,b){var c=a.pathUtils,d=a.geometryNode,e,f=null,h=null,g=[],k=[],l=!1,m=!1,n=function(){e=this};n.prototype._highlight=function(a,b,e){b&&(a=c.getPathObject(d,a.interactionPath+""),a.highlighted!=e&&(a.highlighted=e,a.traverse(function(a){e?b.apply(a,b.options):b.remove(a,b.options)})))};n.prototype.setDragged=function(a){e.setToggleHighlights(!1);h=a;e.setToggleHighlights(!0);return!0};n.prototype.removeDragged=function(){e.setToggleHighlights(!1);
h=null;e.setToggleHighlights(!0);return!0};n.prototype.getDragged=function(){return h};n.prototype.toggleSelected=function(a){e.setToggleHighlights(!1);for(var b=-1,c=0;c<g.length;c++)void 0!==a.interactionPath?a.interactionPath===g[c].interactionPath&&(b=c):g[c]==a&&(b=c);c=!1;-1<b?g.splice(b,1):(g.push(a),c=!0);m=!0;e.setToggleHighlights(!0,c);return c};n.prototype.setSelected=function(a){if(!a.interactionGroup)return!1;e.setToggleHighlights(!1);for(var b=-1,c=0;c<g.length;c++)void 0!==a.interactionPath?
a.interactionPath===g[c].interactionPath&&(b=c):g[c]==a&&(b=c);-1===b&&g.push(a);m=-1===b;e.setToggleHighlights(!0);return!0};n.prototype.removeSelected=function(a){if(!a.interactionGroup)return!1;var b=!1;e.setToggleHighlights(!1);for(var c=-1,d=0;d<g.length;d++)void 0!==a.interactionPath?a.interactionPath===g[d].interactionPath&&(c=d):g[d]==a&&(c=d);-1!==c&&(g.splice(c,1),b=!0);m=-1!==c;e.setToggleHighlights(!0);return b};n.prototype.getSelected=function(){return g};n.prototype.setHovered=function(a){e.setToggleHighlights(!1);
f=a;e.setToggleHighlights(!0);return!0};n.prototype.removeHovered=function(){e.setToggleHighlights(!1);f=null;e.setToggleHighlights(!0);return!0};n.prototype.getHovered=function(){return f};n.prototype.removeObject=function(a){e.removeSelected(a);f===a&&(f=null);h===a&&(h=null);a=k.indexOf(a);-1!=a&&k.splice(a,1);return!0};n.prototype.setInteractable=function(a){if(!Array.isArray(a))return!1;e.setToggleHighlights(!1);k=a;e.setToggleHighlights(!0);return!0};n.prototype.setToggleHighlights=function(a){if("boolean"!==
typeof a)return b.threeDManager.warn("HighlightingHandler.setToggleHighlights","Not a boolean. The highlighting was not toggled."),!1;if(l==a)return!1;b.threeDManager.helpers.toggleViewport(!0);l=a;if(h){var c=b.interactionGroupManager.getGroup(h.interactionGroup);e._highlight(h,c.getDraggableHighlight().active,a)}var d=0;for(c=g.length;d<c;d++){var q=g[d],n=b.interactionGroupManager.getGroup(q.interactionGroup);e._highlight(q,n.getSelectableHighlight().active,a)}f&&!m&&(c=b.interactionGroupManager.getGroup(f.interactionGroup),
e._highlight(f,c.getHoverableHighlight().active,a));if(h)for(d=b.interactionGroupManager.getGroup(h.interactionGroup),q=0,c=k.length;q<c;q++)k[q].interactionGroup==h.interactionGroup&&k[q]!=h&&e._highlight(k[q],d.getDraggableHighlight().passive,a);if(f&&!m)for(d=b.interactionGroupManager.getGroup(f.interactionGroup),q=0,c=k.length;q<c;q++)k[q].interactionGroup==f.interactionGroup&&k[q]!=f&&e._highlight(k[q],d.getHoverableHighlight().passive,a);d=0;for(c=g.length;d<c;d++){q=g[d];n=b.interactionGroupManager.getGroup(q.interactionGroup);
for(var r={i$211:0},w=k.length;r.i$211<w;r={i$211:r.i$211},r.i$211++)k[r.i$211].interactionGroup==q.interactionGroup&&(g.includes(k[r.i$211])||(void 0!==k[r.i$211].interactionPath?0===g.filter(function(a){return function(b){return b.interactionPath===k[a.i$211].interactionPath}}(r)).length&&e._highlight(k[r.i$211],n.getSelectableHighlight().passive,a):e._highlight(k[r.i$211],n.getSelectableHighlight().passive,a)))}m&&(m=l);b.threeDManager.helpers.toggleViewport(!1);return!0};n.prototype.getToggleHighlights=
function(){return l};return new n(a)}};var module$src$3d$viewport$handlers$InteractionHandler={default:function(a,b){var c=a.pathUtils,d=a.settings,e=a.scene,f=a.geometryNode,h,g=[],k=b.renderingHandler.getDomElement(),l=!1,m,n=new module$src$externals$three.default.Vector3,r=new module$src$externals$three.default.Vector3,u=function(){h=this;m=new module$src$externals$three.default.DragControls(g,b.cameraHandler.camera,k);m.addEventListener("dragstart",h._interactionStartEvent);m.addEventListener("drag",h._interactionEvent);m.addEventListener("dragend",
h._interactionEndEvent);m.addEventListener("hoveron",h._hoverStartEvent);m.addEventListener("hover",h._hoverEvent);m.addEventListener("hoveroff",h._hoverEndEvent);m.addEventListener("emptyclick",h._interactionEmptyClickEvent);m.addEventListener("mousedowncustom",function(){l=!0});m.addEventListener("mouseupcustom",function(){l=!1});b.highlightingHandler=new module$src$3d$viewport$handlers$HighlightingHandler.default({settings:d,scene:e,geometryNode:f,pathUtils:c},b);b.threeDManager.highlightingHandler=
b.highlightingHandler};u.prototype._dispatchEvent=function(a){for(var b=new CustomEvent(a.type),c=$jscomp.makeIterator(a),d=c.next();!d.done;d=c.next())d=d.value,b[d]=a[d];k.dispatchEvent(b);return b};u.prototype._interactionStartEvent=function(a){if(a.object.interactionGroup){var d=b.interactionGroupManager.getGroup(a.object.interactionGroup);if(d&&(1==d.isDraggable()||1==d.isSelectable())){var e=void 0===a.object.interactionPath||!0===a.object.parent.meshHelper&&"sub"===a.object.parent.interactionType?
a.object.parent:c.getPathObject(f,a.object.interactionPath+"");if(1==d.isDraggable()){n.copy(a.object.position);r.copy(a.object.position);b.threeDManager.updateSetting("camera.enableCameraControls",!1);b.renderingHandler.updateShadowMap();b.highlightingHandler.setDragged(a.object);b.renderingHandler.registerForContinuousRendering("interactionInProcess");var g={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_DRAG_START,viewportRuntimeId:b.threeDManager.runtimeId,obj:e,
scenePath:c.getObjectPath(e),dragPosStart:n.clone(),clientX:a.event.clientX,clientY:a.event.clientY},l=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,g);b.threeDManager.message(g.type,l);h._dispatchEvent(g)}if(1==d.isSelectable()){d={viewportRuntimeId:b.threeDManager.runtimeId,clientX:a.event.clientX,clientY:a.event.clientY};if(b.highlightingHandler.toggleSelected(a.object)){if(d.type=module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SELECT_ON,
"single"===b.interactionGroupManager.getGroup(a.object.interactionGroup).getSelectionMode()){g=b.highlightingHandler.getSelected();l=0;for(var p=g.length;l<p;l++)if(g[l].interactionGroup==a.object.interactionGroup&&g[l]!=a.object){p=void 0===g[l].interactionPath||!0===g[l].parent.meshHelper&&"sub"===g[l].parent.interactionType?g[l].parent:c.getPathObject(f,g[l].interactionPath+"");b.highlightingHandler.removeSelected(g[l]);g={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SELECT_OFF,
obj:p,scenePath:c.getObjectPath(p),clientX:a.event.clientX,clientY:a.event.clientY};l=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,g);b.threeDManager.message(g.type,l);h._dispatchEvent(g);break}}}else d.type=module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SELECT_OFF;d.obj=e;d.scenePath=c.getObjectPath(e);d.type===module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SELECT_ON&&
(d.selectPos=a.point);a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,d);b.threeDManager.message(d.type,a);h._dispatchEvent(d);b.renderingHandler.render()}}}};u.prototype._interactionEvent=function(a){if(a.object.interactionGroup){var d=b.interactionGroupManager.getGroup(a.object.interactionGroup);d&&0!=d.isDraggable()&&a.position&&(d=void 0===a.object.interactionPath||!0===a.object.parent.meshHelper&&
"sub"===a.object.parent.interactionType?a.object.parent:c.getPathObject(f,a.object.interactionPath+""),d.position.add(a.position.clone().sub(r)),r.copy(a.position),a={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_DRAG_MOVE,viewportRuntimeId:b.threeDManager.runtimeId,obj:d,scenePath:c.getObjectPath(d),dragPosStart:n.clone(),dragPosAbs:r.clone(),clientX:a.event.clientX,clientY:a.event.clientY},a.dragPosRel=a.dragPosAbs.clone().sub(a.dragPosStart),d=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,
a),b.threeDManager.message(a.type,d),h._dispatchEvent(a),b.renderingHandler.updateShadowMap())}};u.prototype._interactionEndEvent=function(a){if(a.object.interactionGroup){var d=b.interactionGroupManager.getGroup(a.object.interactionGroup);if(d&&0!=d.isDraggable()){b.highlightingHandler.removeDragged();d={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_DRAG_END,viewportRuntimeId:b.threeDManager.runtimeId,clientX:a.event.clientX,clientY:a.event.clientY};var e=b.highlightingHandler.getHovered();
e&&(e=void 0===e.interactionPath||!0===e.parent.meshHelper&&"sub"===e.parent.interactionType?e.parent:c.getPathObject(f,e.interactionPath+""),d.hovered={obj:e,scenePath:c.getObjectPath(e)});a=void 0===a.object.interactionPath||!0===a.object.parent.meshHelper&&"sub"===a.object.parent.interactionType?a.object.parent:c.getPathObject(f,a.object.interactionPath+"");d.obj=a;d.scenePath=c.getObjectPath(a);d.dragPosStart=n.clone();d.dragPosAbs=r.clone();d.dragPosRel=d.dragPosAbs.clone().sub(d.dragPosStart);
a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,d);b.threeDManager.message(d.type,a);b.threeDManager.updateSetting("camera.enableCameraControls",!0);b.renderingHandler.unregisterForContinuousRendering("interactionInProcess");h._dispatchEvent(d)}}};u.prototype._interactionEmptyClickEvent=function(){for(var a=b.highlightingHandler.getSelected(),d=!1,e=a.length;e--;)if("single"===b.interactionGroupManager.getGroup(a[e].interactionGroup).getSelectionMode()){d=
void 0===a[e].interactionPath||!0===a[e].parent.meshHelper&&"sub"===a[e].parent.interactionType?a[e].parent:c.getPathObject(f,a[e].interactionPath+"");b.highlightingHandler.removeSelected(a[e]);d={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SELECT_OFF,obj:d,scenePath:c.getObjectPath(d)};var g=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,d);b.threeDManager.message(d.type,
g);h._dispatchEvent(d);d=!0}1==d&&b.renderingHandler.render()};u.prototype._hoverStartEvent=function(a){if((!0!==l||b.highlightingHandler.getDragged())&&a.object.interactionGroup){var d=b.interactionGroupManager.getGroup(a.object.interactionGroup);d&&0!=d.isHoverable()&&(d=void 0===a.object.interactionPath||!0===a.object.parent.meshHelper&&"sub"===a.object.parent.interactionType?a.object.parent:c.getPathObject(f,a.object.interactionPath+""),b.highlightingHandler.setHovered(a.object),b.renderingHandler.registerForContinuousRendering("hoverInProcess"),
a={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_HOVER_ON,viewportRuntimeId:b.threeDManager.runtimeId,obj:d,scenePath:c.getObjectPath(d),hoverPos:a.point,clientX:a.event.clientX,clientY:a.event.clientY},d=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,a),b.threeDManager.message(a.type,d),h._dispatchEvent(a))}};u.prototype._hoverEvent=function(a){if((!0!==l||b.highlightingHandler.getDragged())&&
a.object.interactionGroup){var d=b.interactionGroupManager.getGroup(a.object.interactionGroup);if(d&&0!=d.isHoverable()){d=void 0===a.object.interactionPath||!0===a.object.parent.meshHelper&&"sub"===a.object.parent.interactionType?a.object.parent:c.getPathObject(f,a.object.interactionPath+"");if(b.highlightingHandler.getHovered()!==a.object){b.highlightingHandler.setHovered(a.object);b.renderingHandler.registerForContinuousRendering("hoverInProcess");var e={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_HOVER_ON,
viewportRuntimeId:b.threeDManager.runtimeId,obj:d,scenePath:c.getObjectPath(d),hoverPos:a.point,clientX:a.event.clientX,clientY:a.event.clientY},g=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,e);b.threeDManager.message(e.type,g);h._dispatchEvent(e)}a={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_HOVER_OVER,viewportRuntimeId:b.threeDManager.runtimeId,obj:d,scenePath:c.getObjectPath(d),
hoverPos:a.point,clientX:a.event.clientX,clientY:a.event.clientY};d=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,a);b.threeDManager.message(a.type,d);h._dispatchEvent(a)}}};u.prototype._hoverEndEvent=function(a){if(b.highlightingHandler.getHovered()&&a.object.interactionGroup){var d=b.interactionGroupManager.getGroup(a.object.interactionGroup);d&&0!=d.isHoverable()&&(d=void 0===a.object.interactionPath||
!0===a.object.parent.meshHelper&&"sub"===a.object.parent.interactionType?a.object.parent:c.getPathObject(f,a.object.interactionPath+""),b.highlightingHandler.removeHovered(),a={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_HOVER_OFF,viewportRuntimeId:b.threeDManager.runtimeId,obj:d,scenePath:c.getObjectPath(d),clientX:a.event.clientX,clientY:a.event.clientY},d=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,
a),b.threeDManager.message(a.type,d),b.renderingHandler.unregisterForContinuousRendering("hoverInProcess"),h._dispatchEvent(a))}};u.prototype.addToInteractionGroup=function(a,d,e,l){var k=c.getPathObject(f,a+"");if(!k)return b.threeDManager.warn("InteractionHandler.addToInteractionGroup","No valid path provided, interactivity was not set."),!1;if(!d||!b.interactionGroupManager.isInteractionGroup(d))return b.threeDManager.warn("InteractionHandler.addToInteractionGroup","No valid group provided, interactivity was not set."),
!1;var p=b.interactionGroupManager.getGroup(d);if(!p)return!1;if(module$src$shared$util$GlobalUtils.default.typeCheck(e,"notnegative")){k=c.getPathsAtDepth(k,e);p=!0;for(var n=0;n<k.length;n++)p=p&&this.addToInteractionGroup(k[n],d,"global",l);return p}"global"===e&&(k.interactionGroup=d);var q=p.isSelectable(d)||p.isDraggable(d)||p.isHoverable(d);k.traverse(function(b){"Mesh"==b.type&&(b.interactionGroup=d,!0===b.parent.meshHelper&&(b.parent.interactionGroup=d,b.interactionPath=c.getObjectPath(b.parent.parent),
b.parent.interactionType=e),"global"===e&&(b.interactionPath=a+""),q&&g.push(b))});l?h.setInteractionPlaneNormal(a,l):h.removeInteractionPlaneNormal(a);m.setObjects(g);b.highlightingHandler.setInteractable(g);return!0};u.prototype.removeFromInteractions=function(a){a=c.getPathObject(f,a+"");if(!a)return b.threeDManager.warn("InteractionHandler.removeFromInteractionGroup","No valid path provided, interactivity was not removed."),!1;a.traverse(function(a){for(var d=b.highlightingHandler.getSelected(),
e=-1,f=0;f<d.length;f++)void 0!==a.interactionPath?a.interactionPath===d[f].interactionPath&&(e=f):d[f]==a&&(e=f);-1!==e&&(b.highlightingHandler.removeObject(a),d={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SELECT_OFF,obj:a,scenePath:c.getObjectPath(a)},e=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,d),b.threeDManager.message(d.type,e),h._dispatchEvent(d));a===
b.highlightingHandler.getHovered()&&(b.highlightingHandler.removeHovered(),b.highlightingHandler.removeObject(a),d={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_HOVER_OFF,viewportRuntimeId:b.threeDManager.runtimeId,obj:a,scenePath:c.getObjectPath(a)},e=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,d),b.threeDManager.message(d.type,e),b.renderingHandler.unregisterForContinuousRendering("hoverInProcess"),
h._dispatchEvent(d));a===b.highlightingHandler.getDragged()&&(b.highlightingHandler.removeDragged(),b.highlightingHandler.removeObject(a),d=void 0!==a.interactionPath?r:a.position,d={type:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_DRAG_END,viewportRuntimeId:b.threeDManager.runtimeId,obj:a,scenePath:c.getObjectPath(a),dragPosStart:n.clone(),dragPosAbs:d.clone()},d.dragPosRel=d.dragPosAbs.clone().sub(d.dragPosStart),e=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION,
d),b.threeDManager.message(d.type,e),b.threeDManager.updateSetting("camera.enableCameraControls",!0),b.renderingHandler.unregisterForContinuousRendering("interactionInProcess"),h._dispatchEvent(d));"Mesh"==a.type&&(delete a.interactionGroup,delete a.interactionPath,a=g.indexOf(a),-1<a&&g.splice(a,1))});m.setObjects(g);b.highlightingHandler.setInteractable(g);return!0};u.prototype.removeAllInteractivity=function(){for(var a=0,c=g.length;a<c;a++)b.highlightingHandler.removeObject(g[a]),delete g[a].interactionGroup,
delete g[a].interactionPath;g=[];m.setObjects(g);b.highlightingHandler.setInteractable(g);return!0};u.prototype.setSelectedPaths=function(a,d){a=a||[];d=d||[];for(var e=h.getSelectedPaths(),l=[],m=[],k=0,p=g.length;k<p;k++)void 0!==g[k].interactionPath?(l.push(g[k].interactionPath),m.push("global")):(l.push(c.getObjectPath(g[k])),m.push("sub"));m=0;for(p=a.length;m<p;m++){if(!0!==module$src$shared$util$GlobalUtils.default.typeCheck(a[m],"string"))return b.threeDManager.warn("InteractionHandler.setSelectedPaths",
"At least one path is not a string."),!1;if(!l.includes(a[m]))return b.threeDManager.warn("InteractionHandler.setSelectedPaths","At least one path is not interactable."),!1}m=0;for(p=d.length;m<p;m++){if(!0!==module$src$shared$util$GlobalUtils.default.typeCheck(d[m],"string"))return b.threeDManager.warn("InteractionHandler.setSelectedPaths","At least one path is not a string."),!1;if(!l.includes(d[m]))return b.threeDManager.warn("InteractionHandler.setSelectedPaths","At least one path is not interactable."),
!1}l=0;for(p=d.length;l<p;l++)e.includes(d[l])&&c.getPathObject(f,d[l]+"").traverse(function(a){"Mesh"==a.type&&b.highlightingHandler.removeSelected(a)});e=h.getSelectedPaths();d=0;for(p=a.length;d<p;d++)e.includes(a[d])||c.getPathObject(f,a[d]+"").traverse(function(a){if("Mesh"==a.type){if("single"===b.interactionGroupManager.getGroup(a.interactionGroup).getSelectionMode())for(var c=b.highlightingHandler.getSelected(),d=0,e=c.length;d<e;d++)if(c[d].interactionGroup==a.interactionGroup){b.highlightingHandler.removeSelected(c[d]);
break}b.highlightingHandler.setSelected(a)}});b.renderingHandler.render();return!0};u.prototype.getSelectedPaths=function(){for(var a=b.highlightingHandler.getSelected(),d=[],e=0,f=a.length;e<f;e++)void 0!==a[e].interactionPath?d.push(a[e].interactionPath+""):d.push(c.getObjectPath(a[e]));return d};u.prototype.setInteractionPlaneNormal=function(a,d){a=c.getPathObject(f,a);if(!a)return b.threeDManager.warn("InteractionHandler.setInteractionPlaneNormal","No valid path provided, interaction plane was not set."),
!1;a.traverse(function(a){"Mesh"==a.type&&(a.interactionPlaneNormal=d)});return!0};u.prototype.removeInteractionPlaneNormal=function(a){a=c.getPathObject(f,a);if(!a)return b.threeDManager.warn("InteractionHandler.removeInteractionPlaneNormal","No valid path provided, interaction plane was not removed."),!1;a.traverse(function(a){"Mesh"==a.type&&a.hasOwnProperty("interactionPlaneNormal")&&delete a.interactionPlaneNormal});return!0};u.prototype.startExternalDragEvent=function(a,d){var e;"mouse"!==d&&
"touch"!==d&&(d="mouse");var g=e=function(e){b.threeDManager.viewerApi.scene.toggleGeometry([a],[]);var l=c.getPathObject(f,a),k;l.traverse(function(a){"Mesh"==a.type&&(k=a)});"mouse"===d?(m.onDocumentMouseDownFake({selected:k,point:l.position.clone(),event:{clientX:e.clientX,clientY:e.clientY}}),m.onDocumentMouseMove(e),h()):(m.onDocumentTouchStartFake({changedTouch:e.changedTouches[0],selected:k,point:l.position.clone(),event:{clientX:e.clientX,clientY:e.clientY}}),m.onDocumentTouchMove(e),g=m.onDocumentTouchMove,
b.threeDManager.viewerApi.scene.addEventListener(b.threeDManager.viewerApi.scene.EVENTTYPE.DRAG_END,h))};mobileDragWrapper=function(a){k===document.elementFromPoint(a.changedTouches[0].clientX,a.changedTouches[0].clientY)&&g(a)};var h=function(){"mouse"===d?document.removeEventListener("mouseup",h):document.removeEventListener("touchend",h);"mouse"===d?k.removeEventListener("mousemove",e):document.removeEventListener("touchmove",mobileDragWrapper)};"mouse"===d?document.addEventListener("mouseup",
h):document.addEventListener("touchend",h);"mouse"===d?k.addEventListener("mousemove",e):document.addEventListener("touchmove",mobileDragWrapper)};return new u(a)}};var module$src$3d$viewport$ThreeDManager={default:function(a,b){var c=b.pathUtils,d=b.settings,e=b.scene,f=b.geometryNode,h=b.container,g=b.interactionGroupManager,k=b.viewportManager,l={},m=[],n,r,u,p,q,t=0,v=h.offsetWidth,w=h.offsetHeight,x={},y=!0,A=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean"))return!1;h&&(h.style.opacity=a?1:0);return!0},z=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string"))return!1;h&&(h.style.transition=0<a.length?
"opacity "+a:"none");return!0},B=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",n.warn,"ThreeDManager.Hook->fullscreen"))return!1;var b=h;if("true"!=h.getAttribute("sdv-fullscreen"))for(var c=h.parentElement,d=!1;!d&&null!==c;)"true"==c.getAttribute("sdv-fullscreen")?(d=!0,b=c):c=c.parentElement;return a&&!n._isInFullScreen()?(b.requestFullscreen?b.requestFullscreen():b.webkitRequestFullscreen?b.webkitRequestFullscreen():b.msRequestFullscreen?b.msRequestFullscreen():
b.mozRequestFullScreen&&b.mozRequestFullScreen(),x.left=b.style.left,x.top=b.style.top,x.backgroundColor=b.style.backgroundColor,b.style.left="0%",b.style.top="0%",b.style.backgroundColor=b.style.backgroundColor||"rgba(255,255,255,1)",l.renderingHandler.render(),!0):!a&&n._isInFullScreen()?(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen&&document.mozCancelFullScreen(),
module$src$shared$util$GlobalUtils.default.typeCheck(x.left,"string")&&(b.style.left=x.left,delete x.left),module$src$shared$util$GlobalUtils.default.typeCheck(x.top,"string")&&(b.style.top=x.top,delete x.top),module$src$shared$util$GlobalUtils.default.typeCheck(x.backgroundColor,"string")&&""!==x.backgroundColor&&(b.style.backgroundColor=x.backgroundColor,delete x.backgroundColor),l.renderingHandler.render(),!0):n._isInFullScreen()===a?!0:!1},D=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,
"boolean",n.warn,"ThreeDManager.Hook->groundPlaneVisibility"))return!1;p&&(p.visible=a);l.renderingHandler.render();return!0},G=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",n.warn,"ThreeDManager.Hook->groundPlaneReflectionVisibility"))return!1;q&&(q.visible=a);a&&(n.warn("ThreeDManager.Hook->groundPlaneReflectionVisibility","The ground plane reflection and the environment as background do not work together right now."),n.updateSetting("material.environmentMapAsBackground",
!1),l.materialHandler.setSceneBackground(null));l.renderingHandler.render();return!0},F=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"number",n.warn,"ThreeDManager.Hook->groundPlaneReflectionThreshold"))return!1;q&&(q.threshold=a);l.renderingHandler.render();return!0},E=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",n.warn,"ThreeDManager.Hook->gridVisibility"))return!1;u&&(u.visible=a);l.renderingHandler.render();return!0},I=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,
"number",n.warn,"ThreeDManager.Hook->duration"))return!1;t=a;return!0},C=function(a,b){module$src$3d$interfaces$ThreeDManagerInterface.default.call(this,b,module$src$shared$util$GlobalUtils.default);n=this;n.constants=module$src$3d$viewport$ThreeDManagerConstants.default;l.threeDManager=n;n.viewerApi=a;r=new module$src$3d$viewport$helpers$ThreeDManagerHelpers.default({scene:e,geometryNode:f,pathUtils:c},l);l.threeDManager.helpers=r;h.style.padding="0";module$src$shared$mixins$SettingsMixin.default.call(n,
d,module$src$3d$viewport$ThreeDManagerConstants.default.defaultSettings,b.runtimeId);document.addEventListener("webkitfullscreenchange",function(){n.updateSetting("fullscreen",n._isInFullScreen())},!1);document.addEventListener("mozfullscreenchange",function(){n.updateSetting("fullscreen",n._isInFullScreen())},!1);document.addEventListener("fullscreenchange",function(){n.updateSetting("fullscreen",n._isInFullScreen())},!1);this.renderingHandler=new module$src$3d$viewport$handlers$RenderingHandler.default({settings:n.getSection("render"),
scene:e,geometryNode:f,container:h},l);l.renderingHandler=this.renderingHandler;!1!==n.success&&(this.materialHandler=new module$src$3d$viewport$handlers$MaterialHandler.default.MaterialHandler({settings:n.getSection("material"),scene:e,geometryNode:f,pathUtils:c},l),l.materialHandler=this.materialHandler,!1!==n.success&&(this.cameraHandler=new module$src$3d$viewport$handlers$camera$ProxyCameraHandler.default.ProxyCameraHandler({settings:n.getSection("camera"),scene:e,geometryNode:f,container:h},
l),l.cameraHandler=this.cameraHandler,!1!==n.success&&(this.lightHandler=new module$src$3d$viewport$handlers$LightHandler.default({settings:n.getSection("lights"),shadows:n.getSettingShallow("render.shadows"),scene:e,geometryNode:f},l),l.lightHandler=this.lightHandler,!1!==n.success&&(l.interactionGroupManager=g,l.threeDManager.interactionGroupManager=g,this.interactionHandler=new module$src$3d$viewport$handlers$InteractionHandler.default({settings:n.getSection("interaction"),scene:e,geometryNode:f,
pathUtils:c},l),l.interactionHandler=this.interactionHandler,!1!==n.success&&(this.registerHook("show",A),this.registerHook("showTransition",z),this.registerHook("fullscreen",B),this.registerHook("groundPlaneVisibility",D),this.registerHook("groundPlaneReflectionVisibility",G),this.registerHook("groundPlaneReflectionThreshold",F),this.registerHook("gridVisibility",E),this.registerHook("duration",I))))))};$jscomp.inherits(C,module$src$3d$interfaces$ThreeDManagerInterface.default);C.prototype._isInFullScreen=
function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||document.mozFullScreenElement)};C.prototype._getExchangeMeshMaterialObjects=function(){return m};C.prototype.init=function(a){l.renderingHandler.start();var b=a.min.distanceTo(a.max);if(1<b){var c=parseInt(b);c=c.toString();c=c.length;c=Math.pow(10,c-1);b=Math.max(Math.ceil(b/c)*c,1);c=b/(c/10)}else{c=1-Math.floor(Math.log(b)/Math.log(10))-2;b=b.toFixed(c+1);var d=parseInt(b.substr(b.length-
1))+1;b="0.";for(var e=0;e<c;++e)b+="0";b=parseFloat(b+d);c=10*d}u=new module$src$externals$three.default.GridHelper(2*b,c);u.material.opacity=.15;u.material.transparent=!0;u.isSelectable=!1;u.rotateX(Math.PI/2);u.visible=n.getSetting("gridVisibility");c=new module$src$externals$three.default.Object3D;c.SDLocalPath="grid";c.add(u);d=new module$src$externals$three.default.PlaneGeometry(2*b,2*b,2,2);e={color:13882323,side:module$src$externals$three.default.FrontSide,roughness:1,metalness:0};p=new module$src$externals$three.default.Mesh(d,
l.materialHandler.getMaterial(e));p.receiveShadow=!0;p.visible=n.getSetting("groundPlaneVisibility");b=new module$src$externals$three.default.Object3D;b.SDLocalPath="groundplane";b.add(p);n.addMesh(p,p.material,e);q=new module$src$externals$three.default.Reflector(d,{clipBias:.003,textureWidth:v*window.devicePixelRatio,textureHeight:w*window.devicePixelRatio,color:7829367,recursion:1});q.receiveShadow=!0;q.transparent=!0;q.visible=n.getSetting("groundPlaneReflectionVisibility");q.visible&&n.updateSetting("material.environmentMapAsBackground",
!1);b.add(q);d=a.getBoundingSphere();u.position.set(d.center.x,d.center.y,a.min.z-.005);p.position.set(d.center.x,d.center.y,a.min.z-.005);q.scale.set(d.radius,d.radius,d.radius);q.position.set(d.center.x,d.center.y,a.min.z-.005);r.addSceneObject(c);r.addSceneObject(b);r.initialize();n.adjustScene()};C.prototype.adjustScene=function(){if(r.isInitialized()){var a=f.computeSceneBoundingBox(),b=new module$src$externals$three.default.Sphere;a.getBoundingSphere(b);u.position.set(u.position.x,u.position.y,
a.min.z-.005);p.position.set(p.position.x,p.position.y,a.min.z-.005);q.position.set(q.position.x,q.position.y,a.min.z-.005);l.materialHandler.adjustToBoundingSphere(b);l.lightHandler.adjustToBoundingSphere(b);l.cameraHandler.adjustToBoundingSphere(b);l.materialHandler.compile();l.renderingHandler.updateShadowMap();l.renderingHandler.render()}};C.prototype.computeBoundingBox=function(a){return f.computeBoundingBox(a)};C.prototype.pause=function(){y=!1;l.renderingHandler.pause();l.cameraHandler.pause();
l.lightHandler.pause();l.materialHandler.pause()};C.prototype.resume=function(){y=!0;l.renderingHandler.resume();l.cameraHandler.resume();l.lightHandler.resume();l.materialHandler.resume();l.renderingHandler.render()};C.prototype.destroy=function(){delete l.threeDManager;r.destroyViewport();l.renderingHandler&&l.renderingHandler.destroy();l.cameraHandler&&l.cameraHandler.destroy();l.lightHandler&&l.lightHandler.destroy();l.materialHandler&&l.materialHandler.destroy();n.deregisterAllHooks();for(n.deregisterAllNotifiers();h.firstChild;)h.removeChild(h.firstChild);
for(var a in l)delete l[a]};C.prototype.reload=function(){return k.reloadThreeDManager(n.runtimeId)};C.prototype.addMesh=function(a,b,c){r.addMesh(a,b,c)};C.prototype.removeMesh=function(a){for(var b=0,c=m.length;b<c;b++)if(a===m[b].mesh){m.splice(b,1);break}r.removeMesh(a)};C.prototype.addAnchor=function(a,b){r.addAnchor(a,b)};C.prototype.removeAnchor=function(a){r.removeAnchor(a)};C.prototype.fadeIn=function(a,b){var d=c.getPathObject(f,a);if(null==d)return Promise.reject(Error("Could not fade in geometry, path not found"));
y?module$src$shared$util$GlobalUtils.default.typeCheck(b,"number")||(b=t):b=0;return new Promise(function(c){r.toggleMeshes(!0);d.traverseVisible(function(a){a.SDMaterialDefinition&&a.material&&(a.material.transparent=!0,a.material.opacity=0)});r.toggleMeshes(!1);var e={opacity:0},f=(new module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween(e)).to({opacity:1},b).onUpdate(function(){r.toggleMeshes(!0);d.traverseVisible(function(a){a.SDMaterialDefinition&&a.material&&(a.material.opacity="gem"===
a.SDMaterialDefinition.materialType?a.material.side===module$src$externals$three.default.FrontSide?e.opacity*(a.SDMaterialDefinition.transparent?a.SDMaterialDefinition.opacityFront:1):e.opacity*(a.SDMaterialDefinition.transparent?a.SDMaterialDefinition.opacityBack:1):e.opacity*(a.SDMaterialDefinition.transparent?a.SDMaterialDefinition.opacity:1))});r.toggleMeshes(!1)}).onComplete(function(){r.toggleMeshes(!0);d.traverseVisible(function(a){a.SDMaterialDefinition&&a.material&&(a.material.opacity="gem"===
a.SDMaterialDefinition.materialType?a.material.side===module$src$externals$three.default.FrontSide?a.SDMaterialDefinition.opacityFront:a.SDMaterialDefinition.opacityBack:a.SDMaterialDefinition.opacity,a.material.transparent=a.SDMaterialDefinition.transparent)});r.toggleMeshes(!1);l.renderingHandler.unregisterForContinuousRendering("FADE_IN_"+a);c()});l.renderingHandler.registerForContinuousRendering("FADE_IN_"+a);f.start()})};C.prototype.fadeOut=function(a,b){var d=c.getPathObject(f,a);if(null==d)return Promise.reject(Error("Could not fade out, geometry, path not found."));
y?module$src$shared$util$GlobalUtils.default.typeCheck(b,"number")||(b=t):b=0;return new Promise(function(c){r.toggleMeshes(!0);d.traverseVisible(function(a){a.hasOwnProperty("material")&&(a.material.transparent=!0)});r.toggleMeshes(!1);var e={opacity:1},f=(new module$node_modules$$tweenjs$tween_js$src$Tween.default.Tween(e)).to({opacity:0},b).onUpdate(function(){r.toggleMeshes(!0);d.traverseVisible(function(a){a.SDMaterialDefinition&&a.material&&(a.material.opacity="gem"===a.SDMaterialDefinition.materialType?
a.material.side===module$src$externals$three.default.FrontSide?e.opacity*a.SDMaterialDefinition.opacityFront:e.opacity*a.SDMaterialDefinition.opacityBack:e.opacity*a.SDMaterialDefinition.opacity)});r.toggleMeshes(!1)}).onComplete(function(){r.toggleMeshes(!0);d.traverseVisible(function(a){a.SDMaterialDefinition&&a.material&&(a.material.opacity=0)});r.toggleMeshes(!1);l.renderingHandler.unregisterForContinuousRendering("FADE_OUT_"+a);c()});l.renderingHandler.registerForContinuousRendering("FADE_OUT_"+
a);f.start()})};C.prototype.setLiveTransformation=function(a,b,c,d,e){return r.setLiveTransformation(a,b,c,d,e)};C.prototype.updateInteractions=function(a,b){if(b&&module$src$shared$util$GlobalUtils.default.typeCheck(b.interactionGroup,"string")){l.highlightingHandler.setToggleHighlights(!1);var c=b.interactionGroup,d="sub";module$src$shared$util$GlobalUtils.default.typeCheck(b.interactionMode,"string")?"global"===b.interactionMode&&(d="global"):module$src$shared$util$GlobalUtils.default.typeCheck(b.interactionMode,
"notnegative")&&(d=b.interactionMode);b=module$src$shared$util$GlobalUtils.default.typeCheck(b.dragPlaneNormal,"vector3any")?module$src$shared$util$GlobalUtils.default.toVector3(b.dragPlaneNormal):void 0;l.interactionHandler.addToInteractionGroup(a,c,d,b);l.highlightingHandler.setToggleHighlights(!0)}};C.prototype.removeFromInteractions=function(a){l.interactionHandler.removeFromInteractions(a)};C.prototype.toggleGeometry=function(a,b){r.toggleGeometry(a,b)};return new C(a,b)}};var module$src$3d$interfaces$api$ViewportApiInterface={default:function(){this.lights=this.camera=null}};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getViewportRuntimeId=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getContainer=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getScreenshot=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getScreenshotAsync=function(){};
module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.render=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.updateShadowMap=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.startContinuousRendering=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.stopContinuousRendering=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.convertTo2D=function(a){};
module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.pause=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.resume=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.addEventListener=function(a,b){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.removeEventListener=function(a){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getSettingDefinitions=function(){};
module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getSettings=function(a){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getSetting=function(a){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.updateSettingAsync=function(a,b){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.updateSettingsAsync=function(a){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.setTransformation=function(a){};
module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getTransformation=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.applyTransformation=function(a){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.resetTransformation=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.setLiveTransformation=function(a,b){};
module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.updateSelected=function(a,b){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.getSelected=function(){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.startExternalDragEvent=function(a,b){};module$src$3d$interfaces$api$ViewportApiInterface.default.prototype.toggleGeometry=function(){};var module$src$3d$viewport$api$CameraApi={default:{}},__awaiter$$module$src$3d$viewport$api$CameraApi=this&&module$src$3d$viewport$api$CameraApi.default.__awaiter||function(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function f(a){try{l(d.next(a))}catch(n){h(n)}}function k(a){try{l(d["throw"](a))}catch(n){h(n)}}function l(a){a.done?c(a.value):e(a.value).then(f,k)}l((d=d.apply(a,b||[])).next())})},__generator$$module$src$3d$viewport$api$CameraApi=
this&&module$src$3d$viewport$api$CameraApi.default.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(f)throw new TypeError("Generator is already executing.");for(;e;)try{if(f=1,h&&(g=c[0]&2?h["return"]:c[0]?h["throw"]||((g=h["return"])&&g.call(h),0):h.next)&&!(g=g.call(h,c[1])).done)return g;if(h=0,g)c=[c[0]&2,g.value];switch(c[0]){case 0:case 1:g=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();
e.trys.pop();continue;default:if(!(g=e.trys,g=0<g.length&&g[g.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3]))e.label=c[1];else if(6===c[0]&&e.label<g[1])e.label=g[1],g=c;else if(g&&e.label<g[2])e.label=g[2],e.ops.push(c);else{g[2]&&e.ops.pop();e.trys.pop();continue}}c=b.call(a,e)}catch(m){c=[6,m],h=0}finally{f=g=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},f,h,
g,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k},__importDefault$$module$src$3d$viewport$api$CameraApi=this&&module$src$3d$viewport$api$CameraApi.default.__importDefault||function(a){return a&&a.__esModule?a:{"default":a}};Object.defineProperty(module$src$3d$viewport$api$CameraApi.default,"__esModule",{value:!0});
var MessagingConstants_1$$module$src$3d$viewport$api$CameraApi=__importDefault$$module$src$3d$viewport$api$CameraApi(module$src$shared$constants$MessagingConstants.default),ApiResponse_1$$module$src$3d$viewport$api$CameraApi=__importDefault$$module$src$3d$viewport$api$CameraApi(module$src$api$v2$ApiResponse.default),ICameraHandler_1$$module$src$3d$viewport$api$CameraApi=module$src$3d$viewport$interfaces$ICameraHandler.default;
module$src$3d$viewport$api$CameraApi.default.CameraApi=function(){function a(a,c){this._api=a;this._threeDManager=c}a.prototype.addEventListener=function(a,c){if(!Object.values(module$src$3d$viewport$interfaces$ICameraHandler.default.CameraEventType).includes(a))return ApiResponse_1$$module$src$3d$viewport$api$CameraApi.default("Unsupported event type");var b=this._api.subscribeToMessageStream(MessagingConstants_1$$module$src$3d$viewport$api$CameraApi.default.messageTopics.SCENE_CAMERA+"."+a,function(b,
d){b=new CustomEvent(a);b.api=d.api;d.token&&(b.token=d.token);var e={};e[MessagingConstants_1$$module$src$3d$viewport$api$CameraApi.default.messageDataTypes.GENERIC]=null;e[MessagingConstants_1$$module$src$3d$viewport$api$CameraApi.default.messageDataTypes.SCENE_CAMERA]=null;for(var f in e){var k=d.getUniquePartByType(f);if(k){k.data&&(k=k.data);var l=e[f]?e[f]:k,m;for(m in l)b[m]=k[m]}}c(b)});b&&this._threeDManager.cameraHandler.increaseEventListenerCounter();return ApiResponse_1$$module$src$3d$viewport$api$CameraApi.default(null,
b)};a.prototype.animateAsync=function(a,c){return __awaiter$$module$src$3d$viewport$api$CameraApi(this,void 0,void 0,function(){var b;return __generator$$module$src$3d$viewport$api$CameraApi(this,function(d){switch(d.label){case 0:return[4,this._threeDManager.cameraHandler.setCameraPath(a,c)];case 1:return b=d.sent(),[2,ApiResponse_1$$module$src$3d$viewport$api$CameraApi.default(b?null:"Camera path animation failed",this._threeDManager.cameraHandler.getPositionAndTarget())]}})})};a.prototype.get=
function(){return ApiResponse_1$$module$src$3d$viewport$api$CameraApi.default(null,this._threeDManager.cameraHandler.getPositionAndTarget())};a.prototype.removeEventListener=function(a){(a=this._api.unsubscribeFromMessageStream(a))&&this._threeDManager.cameraHandler.decreaseEventListenerCounter();return ApiResponse_1$$module$src$3d$viewport$api$CameraApi.default(null,a)};a.prototype.resetAsync=function(a){return __awaiter$$module$src$3d$viewport$api$CameraApi(this,void 0,void 0,function(){var b;return __generator$$module$src$3d$viewport$api$CameraApi(this,
function(c){switch(c.label){case 0:return[4,this._threeDManager.cameraHandler.resetPositionAndTarget(a)];case 1:return b=c.sent(),[2,ApiResponse_1$$module$src$3d$viewport$api$CameraApi.default(b?null:"Resetting camera position or target failed",this._threeDManager.cameraHandler.getPositionAndTarget())]}})})};a.prototype.updateAsync=function(a,c){return __awaiter$$module$src$3d$viewport$api$CameraApi(this,void 0,void 0,function(){var b;return __generator$$module$src$3d$viewport$api$CameraApi(this,
function(d){switch(d.label){case 0:return[4,this._threeDManager.cameraHandler.setPositionAndTarget(a.position,a.target,c)];case 1:return b=d.sent(),[2,ApiResponse_1$$module$src$3d$viewport$api$CameraApi.default(b?null:"Setting new camera target and position failed",this._threeDManager.cameraHandler.getPositionAndTarget())]}})})};a.prototype.updateMatrices=function(a,c){this._threeDManager.cameraHandler.setViewAndProjectionMatrix(a,c)};a.prototype.zoomAsync=function(a,c){return __awaiter$$module$src$3d$viewport$api$CameraApi(this,
void 0,void 0,function(){var b;return __generator$$module$src$3d$viewport$api$CameraApi(this,function(d){switch(d.label){case 0:return[4,this._threeDManager.cameraHandler.zoomExtents(c,a)];case 1:return b=d.sent(),[2,ApiResponse_1$$module$src$3d$viewport$api$CameraApi.default(b?null:"Zooming to extents failed",this._threeDManager.cameraHandler.getPositionAndTarget())]}})})};return a}();var module$src$3d$viewport$api$LightApi={default:function(a,b){var c=b.threeDManager;b=function(){module$src$3d$interfaces$api$LightApiInterface.default.call(this);this.utils=a.utils;this.LIGHTTYPE={AMBIENT:"ambient",DIRECTIONAL:"directional",HEMISPHERE:"hemisphere",POINT:"point",SPOT:"spot",FLASH:"flash"};this.LIGHTSCENE={DEFAULT:"default",LEGACY:"legacy"};this.updateLight=this.updateLight.bind(this);this.getLight=this.getLight.bind(this);this.removeLight=this.removeLight.bind(this);this.setLightSceneFromID=
this.setLightSceneFromID.bind(this);this.setLightSceneFromDefinition=this.setLightSceneFromDefinition.bind(this);this.getLightScene=this.getLightScene.bind(this);this.getAllLightScenes=this.getAllLightScenes.bind(this);this.saveLightScene=this.saveLightScene.bind(this)};$jscomp.inherits(b,module$src$3d$interfaces$api$LightApiInterface.default);b.prototype.updateLight=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,c.lightHandler.updateLight(a))};b.prototype.getLight=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,
c.lightHandler.getLight(a))};b.prototype.removeLight=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,c.lightHandler.removeLight(a))};b.prototype.setLightSceneFromID=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,c.lightHandler.setLightSceneFromID(a))};b.prototype.setLightSceneFromDefinition=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,c.lightHandler.setLightSceneFromDefinition(a))};b.prototype.getLightScene=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,
c.lightHandler.getLightScene(a))};b.prototype.getAllLightScenes=function(){return(0,module$src$api$v2$ApiResponse.default)(null,c.lightHandler.getAllLightScenes())};b.prototype.saveLightScene=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,c.lightHandler.saveLightScene(a))};return new b}};var module$src$3d$viewport$api$ViewportApi={default:function(a,b){var c=function(a){return function(b){return[b.slice(0,a),b.slice(a+1)]}},d,e=b.threeDManager,f,h,g=new module$src$externals$three.default.Matrix4,k=new module$src$externals$three.default.Matrix4,l=[];b=function(){module$src$3d$interfaces$api$ViewportApiInterface.default.call(this);d=this;d.utils=a.utils;d.EVENTTYPE=a.scene.EVENTTYPE;f=function(a,b,c){c||(c="");if("object"===typeof a)for(var d in a){var e=a[d];if(e.desc){var g={description:e.desc};
e.type&&(g.type=e.type);g=module$src$shared$util$GlobalUtils.default.deepCopy(g);b[c.split(".value").join("")+d]=g}f(e,b,c+d+".")}};h=function(a,b){if(-1!==b.indexOf(".")){var d=$jscomp.makeIterator(c(b.indexOf("."))(b));b=d.next().value;d=d.next().value;if(a=a[b])return a.value&&(a=a.value),h(a,d)}else return a[b]};d.camera=new module$src$3d$viewport$api$CameraApi.default.CameraApi(a,e);d.lights=new module$src$3d$viewport$api$LightApi.default(a,{threeDManager:e});d.getViewportRuntimeId=d.getViewportRuntimeId.bind(d);
d.getContainer=d.getContainer.bind(d);d.getScreenshot=d.getScreenshot.bind(d);d.getScreenshotAsync=d.getScreenshotAsync.bind(d);d.render=d.render.bind(d);d.convertTo2D=d.convertTo2D.bind(d);d.pause=d.pause.bind(d);d.resume=d.resume.bind(d);d.addEventListener=d.addEventListener.bind(d);d.removeEventListener=d.removeEventListener.bind(d);d.getSettingDefinitions=d.getSettingDefinitions.bind(d);d.getSettings=d.getSettings.bind(d);d.getSetting=d.getSetting.bind(d);d.updateSettingAsync=d.updateSettingAsync.bind(d);
d.updateSettingsAsync=d.updateSettingsAsync.bind(d);d.setTransformation=d.setTransformation.bind(d);d.getTransformation=d.getTransformation.bind(d);d.applyTransformation=d.applyTransformation.bind(d);d.resetTransformation=d.resetTransformation.bind(d);d.setLiveTransformation=d.setLiveTransformation.bind(d);d.updateSelected=d.updateSelected.bind(d);d.getSelected=d.getSelected.bind(d)};$jscomp.inherits(b,module$src$3d$interfaces$api$ViewportApiInterface.default);b.prototype.getViewportRuntimeId=function(){return e.runtimeId};
b.prototype.getContainer=function(){return e.container};b.prototype.getScreenshot=function(){return e.renderingHandler.getScreenshot()};b.prototype.getScreenshotAsync=function(){return new Promise(function(a){var b=new Image;b.onload=function(){a((0,module$src$api$v2$ApiResponse.default)(null,b.src))};b.src=e.renderingHandler.getScreenshot()})};b.prototype.render=function(){e.renderingHandler.render();return(0,module$src$api$v2$ApiResponse.default)(null,!0)};b.prototype.updateShadowMap=function(){e.renderingHandler.updateShadowMap();
return(0,module$src$api$v2$ApiResponse.default)(null,!0)};b.prototype.startContinuousRendering=function(){e.renderingHandler.containsContinuousRendering("api_render")||e.renderingHandler.registerForContinuousRendering("api_render");return(0,module$src$api$v2$ApiResponse.default)(null,!0)};b.prototype.stopContinuousRendering=function(){e.renderingHandler.unregisterForContinuousRendering("api_render");return(0,module$src$api$v2$ApiResponse.default)(null,!0)};b.prototype.convertTo2D=function(a){var b=
new module$src$externals$three.default.Object3D,c=new module$src$externals$three.default.Vector3,d=e.renderingHandler.getDomElement(),f=d.getBoundingClientRect(),g=d.width;d=d.height;b.position.set(a.x,a.y,a.z);b.updateMatrixWorld();c.setFromMatrixPosition(b.matrixWorld);c.project(e.cameraHandler.camera);c.x=g/2*c.x+g/2;c.y=-(d/2*c.y)+d/2;c.xPixel=c.x/devicePixelRatio;c.yPixel=c.y/devicePixelRatio;return(0,module$src$api$v2$ApiResponse.default)(null,[{containerX:c.xPixel,containerY:c.yPixel,clientX:c.xPixel+
f.left,clientY:c.yPixel+f.top,pageX:c.xPixel+f.left+window.pageXOffset,pageY:c.yPixel+f.top+window.pageYOffset}])};b.prototype.pause=function(){e.pause();return(0,module$src$api$v2$ApiResponse.default)(null,!0)};b.prototype.resume=function(){e.resume();return(0,module$src$api$v2$ApiResponse.default)(null,!0)};b.prototype.addEventListener=function(b,c){if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,"string")||0>=b.length)return(0,module$src$api$v2$ApiResponse.default)("Event type must be a string");
if(!Object.keys(d.EVENTTYPE).find(function(a){return d.EVENTTYPE[a]===b}))return(0,module$src$api$v2$ApiResponse.default)("Unsupported event type");var e=a.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE+"."+b,function(a,e){a=new CustomEvent(b);a.api=d;e.token&&(a.token=e.token);var f={};f[module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION]=null;f[module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC]=
null;f[module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_ANCHORDATA]=null;f[module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_UPDATE]={assets:1};for(var g in f){var h=e.getUniquePartByType(g);if(h){h.data&&(h=h.data);var l=f[g]?f[g]:h,m;for(m in l)a[m]=h[m]}}a.viewportRuntimeId&&a.viewportRuntimeId!==a.api.getViewportRuntimeId()||c(a)});return(0,module$src$api$v2$ApiResponse.default)(null,e)};b.prototype.removeEventListener=function(b){return(0,module$src$api$v2$ApiResponse.default)(null,
a.unsubscribeFromMessageStream(b))};b.prototype.getSettingDefinitions=function(){var a={};f(module$src$3d$viewport$ThreeDManagerConstants.default.settingsDefinition,a,"");return a};b.prototype.getSettings=function(a){Array.isArray(a)||(a=Object.keys(d.getSettingDefinitions()));var b={};a.forEach(function(a){if(e.hasSetting(a)){var c=e.getSetting(a);module$src$shared$util$GlobalUtils.default.forceAtPath(b,a,c)}});return b};b.prototype.getSetting=function(a){if(e.hasSetting(a))return e.getSetting(a)};
b.prototype.updateSettingAsync=function(a,b){var c=h(module$src$3d$viewport$ThreeDManagerConstants.default.settingsDefinition,a);if(void 0===c)return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Setting does not exist",!1));if(void 0!==c.type&&null!==c.type)if(module$src$shared$util$GlobalUtils.default.typeCheck(c.type,"string")){if(module$src$shared$util$GlobalUtils.default.typeCheck(b,"m.type"))return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Setting has wrong value type",
!1))}else if("function"===typeof c.type&&!c.type(b))return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Setting has wrong value type",!1));c.hasOwnProperty("transform")&&"function"===typeof c.transform&&(b=c.transform(b));return e.updateSettingAsync(a,b).then(function(a){return a?Promise.resolve((0,module$src$api$v2$ApiResponse.default)(null,!0)):Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Update of setting failed",!1))},function(){return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Update of setting failed",
!1))})};b.prototype.updateSettingsAsync=function(a){var b=[];module$src$shared$util$GlobalUtils.default.getPaths(a,b);var c={},e=Promise.resolve(),f={};b=$jscomp.makeIterator(b);for(var g=b.next();!g.done;f={path:f.path},g=b.next())f.path=g.value,e=e.then(function(b){return function(){return d.updateSettingAsync(b.path,module$src$shared$util$GlobalUtils.default.getAtPath(a,b.path))}}(f)),e=e.then(function(a){return function(b){b.err?module$src$shared$util$GlobalUtils.default.forceAtPath(c,a.path,
!1):module$src$shared$util$GlobalUtils.default.forceAtPath(c,a.path,!0)}}(f),function(a){return function(){module$src$shared$util$GlobalUtils.default.forceAtPath(c,a.path,!1)}}(f));return e.then(function(){return(0,module$src$api$v2$ApiResponse.default)(null,c)})};b.prototype.setTransformation=function(a){e.transformationMatrices||(e.transformationMatrices=[]);if("number"===typeof a[0]||a.isMatrix4)a=[a];g.identity();for(var b=0,c=a.length>e.transformationMatrices.length?a.length:e.transformationMatrices.length;b<
c;b++){if(a[b]){var d;e.transformationMatrices[b]=a[b].isMatrix4?a[b]:(d=k.clone()).set.apply(d,$jscomp.arrayFromIterable(a[b]))}else e.transformationMatrices[b]||(e.transformationMatrices[b]=k.clone());g.premultiply(e.transformationMatrices[b])}e.transformationMatrix.identity();e.transformationMatrix.multiply(g);e.renderingHandler.updateShadowMap();e.renderingHandler.render();return(0,module$src$api$v2$ApiResponse.default)(null,!0)};b.prototype.getTransformation=function(){if(e.transformationMatrices&&
0<e.transformationMatrices.length){for(var a=[],b=0,c=e.transformationMatrices.length;b<c;b++)a[b]=e.transformationMatrices[b].clone();return a}return[e.transformationMatrix.clone()]};b.prototype.applyTransformation=function(a){e.transformationMatrices||(e.transformationMatrices=[]);if("number"===typeof a[0]||a.isMatrix4)a=[a];g.identity();for(var b=0,c=a.length>e.transformationMatrices.length?a.length:e.transformationMatrices.length;b<c;b++){if(null!=a[b]){var d;l[b]=a[b].isMatrix4?a[b]:(d=k.clone()).set.apply(d,
$jscomp.arrayFromIterable(a[b]))}e.transformationMatrices[b]?a[b]&&e.transformationMatrices[b].multiply(l[b]):e.transformationMatrices[b]=a[b]?l[b]:k.clone();g.premultiply(e.transformationMatrices[b])}e.transformationMatrix.identity();e.transformationMatrix.premultiply(g);e.renderingHandler.updateShadowMap();e.renderingHandler.render();return(0,module$src$api$v2$ApiResponse.default)(null,!0)};b.prototype.resetTransformation=function(){e.transformationMatrix=k.clone();e.transformationMatrices=[];e.renderingHandler.updateShadowMap();
e.renderingHandler.render();return(0,module$src$api$v2$ApiResponse.default)(null,!0)};b.prototype.setLiveTransformation=function(a,b){for(var c=new module$node_modules$$tweenjs$tween_js$src$Tween.default.Group,d=[],f=0,g=a.length;f<g;f++)d.push(e.setLiveTransformation(c,a[f].scenePaths,a[f].transformations,a[f].reset,b));a=0;for(g=d.length;a<g;a++)d[a].start();return d};b.prototype.updateSelected=function(a,b){return e.interactionHandler.setSelectedPaths(a,b)};b.prototype.getSelected=function(){return e.interactionHandler.getSelectedPaths()};
b.prototype.startExternalDragEvent=function(a,b){return e.interactionHandler.startExternalDragEvent(a,b)};b.prototype.toggleGeometry=function(a,b){module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")&&(a=[a]);module$src$shared$util$GlobalUtils.default.typeCheck(b,"string")&&(b=[b]);if(!(Array.isArray(a)&&Array.isArray(b)&&a.every(function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")})&&b.every(function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,
"string")})))return(0,module$src$api$v2$ApiResponse.default)("The provided input is not valid");e.toggleGeometry(a,b);e.renderingHandler.render();return(0,module$src$api$v2$ApiResponse.default)(null,!0)};return new b}};var module$src$3d$viewportManager$ViewportManager={default:function(a,b){var c=[],d,e=!1,f,h,g,k,l=function(a,b){d=this;h=a;k=b;module$src$shared$util$GlobalUtils.default.inject({message:h.message,subscribeToMessageStream:h.subscribeToMessageStream,unsubscribeFromMessageStream:h.unsubscribeFromMessageStream},d);var g=d.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_VISIBILITY_ON,function(){d.unsubscribeFromMessageStream(g);f=h.sceneGeometryManager.getGeometryNode().computeSceneBoundingBox();
e=!0;for(var a=0,b=c.length;a<b;a++)h.settingsHandler.restoreSettings(c[a]),c[a].threeDManager.init(f),!0===h.getSetting("showScene")&&c[a].updateSettingAsync("show",!0)});(0,module$src$3d$viewportManager$ViewportManagerThreeDManager.default)(d,c);(0,module$src$3d$viewportManager$ViewportManagerApi.default)(d,c)};l.prototype._convertInputObject=function(a){if(a.container){if(a.container instanceof Element)var b=a.container;else return;if(a=a.runtimeId){for(var d=!1,e=0,f=c.length;e<f;e++)c[e].getViewportRuntimeId()===
a&&(d=!0);a=d?module$src$shared$util$GlobalUtils.default.createRandomId():a}else a=module$src$shared$util$GlobalUtils.default.createRandomId()}else if(a instanceof Element)b=a,a=module$src$shared$util$GlobalUtils.default.createRandomId();else return;return{container:b,runtimeId:a}};l.prototype._createThreeDManager=function(a){g||(g=h.api({version:2}));if(!a)return null;var b=new module$src$3d$viewport$ThreeDManager.default(g,{scene:h.sceneGeometryManager.getScene(),geometryNode:h.sceneGeometryManager.getGeometryNode(),
pathUtils:h.sceneGeometryManager.getPathUtils(),container:a.container,runtimeId:a.runtimeId,loggingHandler:k,messagingHandler:{message:h.message,subscribeToMessageStream:h.subscribeToMessageStream,unsubscribeFromMessageStream:h.unsubscribeFromMessageStream},interactionGroupManager:h.interactionGroupManager,viewportManager:d});var c=new module$src$3d$viewport$api$ViewportApi.default(g,{threeDManager:b,viewportManager:d});g.camera||g.lights||(g.camera=c.camera,g.lights=c.lights);c.threeDManager=b;b.runtimeId=
a.runtimeId;b.container=a.container;b.api=c;b.startUpObject=a;b.transformationMatrix=new module$src$externals$three.default.Matrix4;b.transformationGroups=[];return c};l.prototype.createThreeDManager=function(a){if(!a)return null;Array.isArray(a)||(a=[a]);for(var b=[],g=0,l=a.length;g<l;g++){var k=d._convertInputObject(a[g]);k=d._createThreeDManager(k);c.push(k);if(!1===k.threeDManager.success)d.removeThreeDManager(k.getViewportRuntimeId());else{k.updateSettingAsync("show",!1);k.updateSettingAsync("showTransition",
h.getSetting("showSceneTransition"));for(var m=h.sceneGeometryManager.getMeshMaterialObjects(),t,v,w,x,y,A=0,z=m.length;A<z;A++)y=m[A],t=y.mesh,v=y.properties,w=y.hasTextureCoordinates,x=y.overrideColor,y=y.vertexColors,x=k.threeDManager.materialHandler.getMaterial(v,x,y),null===x||void 0===x?k.threeDManager.warn("The creation of a material failed."):(w||(x.map=null,x.alphaMap=null,x.aoMap=null,x.bumpMap=null,x.displacementMap=null,x.emissiveMap=null,x.normalMap=null,x.metalnessMap=null,x.roughnessMap=
null),k.threeDManager.addMesh(t,x,v));k&&(m=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC,{viewportApi:k,viewportRuntimeId:k.threeDManager.runtimeId}),d.message(module$src$shared$constants$MessagingConstants.default.messageTopics.VIEWPORTS_CREATED,m),b.push(k),e&&(h.settingsHandler.restoreSettings(k),k.threeDManager.init(f),!0===h.getSetting("showScene")&&k.updateSettingAsync("show",!0)))}}return b};l.prototype.removeThreeDManager=
function(a){for(var b=0,e=c.length;b<e;b++)if(c[b].getViewportRuntimeId()===a){e=c[b];e.threeDManager.destroy();for(var f in e)delete e[f];c.splice(b,1);a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC,{viewportRuntimeId:a});d.message(module$src$shared$constants$MessagingConstants.default.messageTopics.VIEWPORTS_DESTROYED,a);return!0}return!1};l.prototype.reloadThreeDManager=function(a){for(var b=0,e=c.length;b<
e;b++)if(c[b].getViewportRuntimeId()===a){a=c[b];e=Object.assign({},a.threeDManager.startUpObject);d.removeThreeDManager(a.getViewportRuntimeId());c.splice(b,1);d.createThreeDManager(e);break}};l.prototype.getContainers=function(){for(var a=[],b=0,d=c.length;b<d;b++)a.push(c[b].getContainer());return a};l.prototype.getApi=function(a){for(var b=0,d=c.length;b<d;b++)if(a===c[b].getViewportRuntimeId())return c[b]};l.prototype.getApis=function(){return c};return new l(a,b)}};var module$src$shared$util$PathUtils={default:function(){var a,b=null,c={},d=function(){a=this};d.prototype.setScene=function(a){b=a;b._sdIndexObj=c;c.obj=b};d.prototype.getChildByName=function(a,b){a=a._sdIndexObj;return null==a?null:module$src$shared$util$GlobalUtils.default.getAtPath(a,b+".obj")};d.prototype.getOrCreateChild=function(b,c){var d=b._sdIndexObj;if(null==d)return null;var e=a.getChildByName(b,c);null==e&&(e=new module$src$externals$three.default.Object3D,e.SDLocalPath=c,b.add(e),d[c]=
{obj:e},e._sdIndexObj=d[c]);return e};d.prototype.getPathObject=function(a,c){a=a||b;a=a._sdIndexObj;return null==a?null:module$src$shared$util$GlobalUtils.default.getAtPath(a,c+".obj")};d.prototype.ensurePath=function(b,c){c=c.split(".");c=$jscomp.makeIterator(c);for(var d=c.next();!d.done;d=c.next())b=a.getOrCreateChild(b,d.value);return b};d.prototype.deletePath=function(b,c){b=a.getPathObject(b,c);if(null==b)return!0;c=b.SDLocalPath;if(null==c||!module$src$shared$util$GlobalUtils.default.typeCheck(c,
"string")||""==c)return!1;var d=b.parent;if(null==d)return!1;var e=d._sdIndexObj;if(null==e)return!1;d.remove(b);delete e[c];return!0};d.prototype.getObjectPath=function(a){if(!a)return null;for(;a&&!a.hasOwnProperty("SDLocalPath");)a=a.parent;for(var b=[];a&&a.hasOwnProperty("SDLocalPath");)b.push(a.SDLocalPath),a=a.parent;b.reverse();a=b.join(".");return""===a?null:a};d.prototype.getPathsAtDepth=function(b,c){if(0===c)return[a.getObjectPath(b)];for(var d=[],e=0;e<b.children.length;e++)d=d.concat(a.getPathsAtDepth(b.children[e],
c-1));return d};return new d}};var module$src$3d$controls$DragControls={default:{}},THREE$$module$src$3d$controls$DragControls=module$src$externals$three.default,DETECT_IT$$module$src$3d$controls$DragControls=module$node_modules$detect_it$lib$index.default.default;
module$src$externals$three.default.DragControls=function(a,b,c){function d(){var a=!1;!0===module$node_modules$detect_it$lib$index.default.default.passiveEvents&&(a={capture:!1,passive:!1});c.addEventListener("mousemove",f,a);c.addEventListener("mousedown",h,a);c.addEventListener("mouseup",g,a);c.addEventListener("mouseleave",g,a);c.addEventListener("touchmove",k,a);c.addEventListener("touchstart",l,a);c.addEventListener("touchend",m,a)}function e(){c.removeEventListener("mousemove",f,!1);c.removeEventListener("mousedown",
h,!1);c.removeEventListener("mouseup",g,!1);c.removeEventListener("mouseleave",g,!1);c.removeEventListener("touchmove",k,!1);c.removeEventListener("touchstart",l,!1);c.removeEventListener("touchend",m,!1)}function f(d){d.preventDefault();var e=c.getBoundingClientRect();p.x=(d.clientX-e.left)/e.width*2-1;p.y=2*-((d.clientY-e.top)/e.height)+1;if(v&&y.enabled){var f;u.setFromCamera(p,b);u.ray.intersectPlane(r,t)&&(f=t.sub(q));y.dispatchEvent({type:"drag",object:v,position:f,event:d})}u.setFromCamera(p,
b);var g=a.indexOf(v);f=u.intersectObjects(a.filter(function(a,b){return g!==b}).filter(function(a,b){return v?a.parent.interactionGroup!==v.parent.interactionGroup:!0}));0<f.length?(e=f[0].object,f=f[0].point,w!==e?(null!==w&&y.dispatchEvent({type:"hoveroff",object:w,event:d}),y.dispatchEvent({type:"hoveron",object:e,point:f,event:d}),c.style.cursor="pointer",w=e):y.dispatchEvent({type:"hover",object:e,point:f,event:d})):null!==w&&(y.dispatchEvent({type:"hoveroff",object:w,event:d}),c.style.cursor=
"auto",w=null)}function h(d){d.preventDefault();if(0===d.button){y.dispatchEvent({type:"mousedowncustom",event:d});u.setFromCamera(p,b);var e=u.intersectObjects(a);0<e.length?(v=e[0].object,e=e[0].point,v.hasOwnProperty("interactionPlaneNormal")?r.setFromNormalAndCoplanarPoint(v.interactionPlaneNormal,v.position):r.setFromNormalAndCoplanarPoint(b.getWorldDirection(r.normal),v.position),u.ray.intersectPlane(r,t)&&q.copy(t).sub(v.position),c.style.cursor="move",y.dispatchEvent({type:"dragstart",object:v,
event:d,point:e})):y.dispatchEvent({type:"emptyclick",event:d})}}function g(a){a.preventDefault();y.dispatchEvent({type:"mouseupcustom",event:a});v&&(y.dispatchEvent({type:"dragend",object:v,event:a}),v=null);c.style.cursor="auto"}function k(d){if(null!==x){!1===d.passive&&d.preventDefault();for(var e=null,f,g=0;g<d.changedTouches.length;g++)if(f=d.changedTouches[g],f.identifier===x){e=f;break}if(e){d=e;e=c.getBoundingClientRect();p.x=(d.clientX-e.left)/e.width*2-1;p.y=2*-((d.clientY-e.top)/e.height)+
1;if(v&&y.enabled){var h;u.setFromCamera(p,b);u.ray.intersectPlane(r,t)&&(h=t.sub(q));y.dispatchEvent({type:"drag",object:v,position:h,event:d})}u.setFromCamera(p,b);var l=a.indexOf(v);e=u.intersectObjects(a.filter(function(a,b){return l!==b}).filter(function(a,b){return v?a.parent.interactionGroup!==v.parent.interactionGroup:!0}));0<e.length?(h=e[0].object,e=e[0].point,h.hasOwnProperty("interactionPlaneNormal")?r.setFromNormalAndCoplanarPoint(h.interactionPlaneNormal,h.position):r.setFromNormalAndCoplanarPoint(b.getWorldDirection(r.normal),
h.position),w!==h?(null!==w&&y.dispatchEvent({type:"hoveroff",object:w,event:d}),y.dispatchEvent({type:"hoveron",object:h,point:e,event:d}),w=h):y.dispatchEvent({type:"hover",object:h,point:e,event:d})):null!==w&&(y.dispatchEvent({type:"hoveroff",object:w,event:d}),w=null)}}}function l(d){d.preventDefault();if(!(1<d.touches.length)){d=d.changedTouches[0];x=d.identifier;var e=c.getBoundingClientRect();p.x=(d.clientX-e.left)/e.width*2-1;p.y=2*-((d.clientY-e.top)/e.height)+1;u.setFromCamera(p,b);e=u.intersectObjects(a);
0<e.length?(v=e[0].object,e=e[0].point,v.hasOwnProperty("interactionPlaneNormal")?r.setFromNormalAndCoplanarPoint(v.interactionPlaneNormal,v.position):r.setFromNormalAndCoplanarPoint(b.getWorldDirection(r.normal),v.position),u.ray.intersectPlane(r,t)&&q.copy(t).sub(v.position),c.style.cursor="move",y.dispatchEvent({type:"dragstart",object:v,event:d,point:e})):y.dispatchEvent({type:"emptyclick",event:d})}}function m(a){if(null!==x){a.preventDefault();for(var b=null,d,e=0;e<a.changedTouches.length;e++)if(d=
a.changedTouches[e],d.identifier===x){b=d;break}b&&(a=b,x=null,v&&(y.dispatchEvent({type:"dragend",object:v,event:a}),v=null),null!==w&&(y.dispatchEvent({type:"hoveroff",object:w,event:a}),w=null),c.style.cursor="auto")}}if(a instanceof module$src$externals$three.default.Camera){console.warn("THREE.DragControls: Constructor now expects ( objects, camera, domElement )");var n=a;a=b;b=n}var r=new module$src$externals$three.default.Plane,u=new module$src$externals$three.default.Raycaster,p=new module$src$externals$three.default.Vector2,
q=new module$src$externals$three.default.Vector3,t=new module$src$externals$three.default.Vector3,v=null,w=null,x=null,y=this;d();this.enabled=!0;this.activate=d;this.deactivate=e;this.dispose=function(){e()};this.onDocumentMouseDownFake=function(a){y.dispatchEvent({type:"mousedowncustom",event:a});v=a.selected;var d=a.point;v.hasOwnProperty("interactionPlaneNormal")?r.setFromNormalAndCoplanarPoint(v.interactionPlaneNormal,v.position):r.setFromNormalAndCoplanarPoint(b.getWorldDirection(r.normal),
v.position);q=new module$src$externals$three.default.Vector3;c.style.cursor="move";y.dispatchEvent({type:"dragstart",object:v,event:a,point:d})};this.onDocumentTouchStartFake=function(a){event=a.changedTouch;x=event.identifier;var d=c.getBoundingClientRect();p.x=(event.clientX-d.left)/d.width*2-1;p.y=2*-((event.clientY-d.top)/d.height)+1;v=a.selected;a=a.point;v.hasOwnProperty("interactionPlaneNormal")?r.setFromNormalAndCoplanarPoint(v.interactionPlaneNormal,v.position):r.setFromNormalAndCoplanarPoint(b.getWorldDirection(r.normal),
v.position);c.style.cursor="move";y.dispatchEvent({type:"dragstart",object:v,event:event,point:a})};this.onDocumentMouseMove=f;this.onDocumentTouchMove=k;this.setObjects=function(b){a=b};this.on=function(a,b){console.warn("THREE.DragControls: on() has been deprecated. Use addEventListener() instead.");y.addEventListener(a,b)};this.off=function(a,b){console.warn("THREE.DragControls: off() has been deprecated. Use removeEventListener() instead.");y.removeEventListener(a,b)};this.notify=function(a){console.error("THREE.DragControls: notify() has been deprecated. Use dispatchEvent() instead.");
y.dispatchEvent({type:a})}};module$src$externals$three.default.DragControls.prototype=Object.create(module$src$externals$three.default.EventDispatcher.prototype);module$src$externals$three.default.DragControls.prototype.constructor=module$src$externals$three.default.DragControls;var module$src$3d$viewport$materials$ShapeDiverStandardMaterial={default:{}},THREE$$module$src$3d$viewport$materials$ShapeDiverStandardMaterial=module$src$externals$three.default,Shaders$$module$src$3d$viewport$materials$ShapeDiverStandardMaterial=module$src$3d$viewport$shaders$ShaderFile.default;
module$src$externals$three.default.ShapeDiverStandardMaterial=function(a){module$src$externals$three.default.MeshStandardMaterial.call(this);this.defines={STANDARD:""};a&&0<a.threeDNoiseOpacity&&(this.defines.USE_3D_NOISE="",a.threeDNoiseID||(a.threeDNoiseID=0),0<=a.threeDNoiseID&&3>a.threeDNoiseID||999==a.threeDNoiseID)&&(this.defines["USE_3D_NOISE_F"+a.threeDNoiseID]="");this.uniforms=module$src$externals$three.default.UniformsUtils.merge([module$src$externals$three.default.UniformsLib.common,module$src$externals$three.default.UniformsLib.envmap,
module$src$externals$three.default.UniformsLib.aomap,module$src$externals$three.default.UniformsLib.lightmap,module$src$externals$three.default.UniformsLib.bumpmap,module$src$externals$three.default.UniformsLib.normalmap,module$src$externals$three.default.UniformsLib.displacementmap,module$src$externals$three.default.UniformsLib.roughnessmap,module$src$externals$three.default.UniformsLib.metalnessmap,module$src$externals$three.default.UniformsLib.lights,{emissive:{value:new module$src$externals$three.default.Color(0)},
roughness:{value:.5},metalness:{value:0},envMapIntensity:{value:1}},{lightWorldSize:{value:.005},lightFrustum:{value:6.5}},{shadowOpacity:{value:1}},{lightReflectivity:{value:1}},{threeDNoiseOpacity:{value:0},threeDNoiseID:{value:0},threeDNoiseScale:{value:1},threeDNoiseDistanceFade:{value:0}},{uvTransformMap:{type:"m3",value:(new module$src$externals$three.default.Matrix3).identity()},uvTransformBumpMap:{type:"m3",value:(new module$src$externals$three.default.Matrix3).identity()},uvTransformNormalMap:{type:"m3",
value:(new module$src$externals$three.default.Matrix3).identity()},uvTransformSpecularMap:{type:"m3",value:(new module$src$externals$three.default.Matrix3).identity()},uvTransformAlphaMap:{type:"m3",value:(new module$src$externals$three.default.Matrix3).identity()},uvTransformEmissiveMap:{type:"m3",value:(new module$src$externals$three.default.Matrix3).identity()},uvTransformRoughnessMap:{type:"m3",value:(new module$src$externals$three.default.Matrix3).identity()},uvTransformMetalnessMap:{type:"m3",
value:(new module$src$externals$three.default.Matrix3).identity()}},{rgbMap:{type:"t",value:null}},{mapsSize:{type:"i",value:0},additionalMaps0:{type:"t",value:null},additionalMaps1:{type:"t",value:null},additionalMaps2:{type:"t",value:null},additionalMaps3:{type:"t",value:null},additionalMaps4:{type:"t",value:null},mapPropertyType:{type:"iv1",value:[-1,-1,-1,-1,-1]},mapPropertyColor:{type:"v3v",value:[new module$src$externals$three.default.Color(0),new module$src$externals$three.default.Color(0),
new module$src$externals$three.default.Color(0),new module$src$externals$three.default.Color(0),new module$src$externals$three.default.Color(0)]},uvTransformAddMap:{type:"m3v",value:[(new module$src$externals$three.default.Matrix3).identity(),(new module$src$externals$three.default.Matrix3).identity(),(new module$src$externals$three.default.Matrix3).identity(),(new module$src$externals$three.default.Matrix3).identity(),(new module$src$externals$three.default.Matrix3).identity()]}}]);this.lightWorldSize=
this.uniforms.lightWorldSize.value;this.lightFrustum=this.uniforms.lightFrustum.value;this.shadowOpacity=this.uniforms.shadowOpacity.value;this.lightReflectivity=this.uniforms.lightReflectivity.value;this.threeDNoiseID=this.uniforms.threeDNoiseID.value;this.threeDNoiseScale=this.uniforms.threeDNoiseScale.value;this.threeDNoiseDistanceFade=this.uniforms.threeDNoiseDistanceFade.value;this.threeDNoiseOpacity=this.uniforms.threeDNoiseOpacity.value;this.mapsSize=this.uniforms.mapsSize.value;this.rgbMap=
this.uniforms.rgbMap.value;var b=0;if(a){a.map&&(this.uvTransformMap=a.map.uvTransform,a.map.matrix.identity(),b++);a.specularMap&&(this.uvTransformSpecularMap=a.specularMap.uvTransform,a.specularMap.matrix.identity(),b++);a.normalMap&&(this.uvTransformNormalMap=a.normalMap.uvTransform,a.normalMap.matrix.identity(),b++);a.bumpMap&&(this.uvTransformBumpMap=a.bumpMap.uvTransform,a.bumpMap.matrix.identity(),b++);a.roughnessMap&&(this.uvTransformRoughnessMap=a.roughnessMap.uvTransform,a.roughnessMap.matrix.identity(),
b++);a.metalnessMap&&(this.uvTransformMetalnessMap=a.metalnessMap.uvTransform,a.metalnessMap.matrix.identity(),b++);a.alphaMap&&(this.uvTransformAlphaMap=a.alphaMap.uvTransform,a.alphaMap.matrix.identity(),b++);a.emissiveMap&&(this.uvTransformEmissiveMap=a.emissiveMap.uvTransform,a.emissiveMap.matrix.identity(),b++);a.alphaMode&&(this.blending=a.alphaMap);a.alphaTest&&(this.alphaTest=a.alphaTest);a&&a.roughnessMap&&a.metalnessMap&&a.roughnessMap.image===a.metalnessMap.image&&(this.rgbMap=a.roughnessMap,
a.roughnessMap={uvTransform:a.roughnessMap.uvTransform,isTexture:!1},a.metalnessMap={uvTransform:a.metalnessMap.uvTransform,isTexture:!1},this.defines.USE_RGBMAP="",b--);if(a&&a.additionalMaps){for(this.mapsSize=a.additionalMaps.length;5>a.mapPropertyType.length;)a.mapPropertyType.push(-1);for(;5>a.mapPropertyColor.length;)a.mapPropertyColor.push(new module$src$externals$three.default.Color(0));for(;5>a.uvTransformAddMap.length;)a.uvTransformAddMap.push((new module$src$externals$three.default.Matrix3).identity());
this.mapPropertyType=a.mapPropertyType;this.mapPropertyColor=a.mapPropertyColor;this.uvTransformAddMap=a.uvTransformAddMap;for(var c=0,d=a.additionalMaps.length;c<d;c++)0==c&&(this.additionalMaps0=a.additionalMaps[c]),1==c&&(this.additionalMaps1=a.additionalMaps[c]),2==c&&(this.additionalMaps2=a.additionalMaps[c]),3==c&&(this.additionalMaps3=a.additionalMaps[c]),4==c&&(this.additionalMaps4=a.additionalMaps[c]);delete a.additionalMaps}b+=this.mapsSize;this.defines.NUM_ADD_MAPS=this.mapsSize;for(a.envMap&&
b++;b>=a.textureUnitCount;)if(a.envMap)delete a.envMap,this.envMap=null,b--;else if(a.emissiveMap&&a.emissiveMap.image)delete a.emissiveMap,this.uvTransformEmissiveMap=this.uniforms.uvTransformEmissiveMap.value,b--;else if(a.alphaMap&&a.alphaMap.image)delete a.alphaMap,this.uvTransformAlphaMap=this.uniforms.uvTransformAlphaMap.value,b--;else if(a.metalnessMap&&a.metalnessMap.image)delete a.metalnessMap,this.uvTransformMetalnessMap=this.uniforms.uvTransformMetalnessMap.value,b--;else if(a.roughnessMap&&
a.roughnessMap.image)delete a.roughnessMap,this.uvTransformRoughnessMap=this.uniforms.uvTransformRoughnessMap.value,b--;else if(this.rgbMap)this.rgbMap=null,delete this.defines.USE_RGBMAP,this.uvTransformMetalnessMap=this.uniforms.uvTransformMetalnessMap.value,this.uvTransformRoughnessMap=this.uniforms.uvTransformRoughnessMap.value,b--;else if(a.bumpMap&&a.bumpMap.image)delete a.bumpMap,this.uvTransformBumpMap=this.uniforms.uvTransformBumpMap.value,b--;else if(a.normalMap&&a.normalMap.image)delete a.normalMap,
this.uvTransformNormalMap=this.uniforms.uvTransformNormalMap.value,b--;else if(a.specularMap&&a.specularMap.image)delete a.specularMap,this.uvTransformSpecularMap=this.uniforms.uvTransformSpecularMap.value,b--;else break;this.availableTextures=a.textureUnitCount-1-b;delete a.textureUnitCount;this.renderAO=a.renderAO;delete a.line;delete a._json}this.vertexShader=module$src$3d$viewport$shaders$ShaderFile.default.standard_vert;this.fragmentShader=module$src$3d$viewport$shaders$ShaderFile.default.standard_frag;
this.type="ShapeDiverStandardMaterial";this.softShadow=!1;this.attributes=["position","normal"];0<b&&this.attributes.push("uv");delete a.line;delete a._json;this.needsUpdate=!1;this.setValues(a)};module$src$externals$three.default.ShapeDiverStandardMaterial.prototype=Object.create(module$src$externals$three.default.MeshStandardMaterial.prototype);module$src$externals$three.default.ShapeDiverStandardMaterial.prototype.constructor=module$src$externals$three.default.ShapeDiverStandardMaterial;
module$src$externals$three.default.ShapeDiverStandardMaterial.prototype.isMeshStandardMaterial=!0;module$src$externals$three.default.ShapeDiverStandardMaterial.prototype.copy=function(a){module$src$externals$three.default.MeshStandardMaterial.prototype.copy.call(this,a);this.defines=a.defines;this.uniforms=module$src$externals$three.default.UniformsUtils.clone(a.uniforms);this.type=a.type;this.softShadow=a.softShadow;this.renderAO=a.renderAO;return this};
module$src$externals$three.default.ShapeDiverStandardMaterial.prototype.deepCopy=function(a){module$src$externals$three.default.MeshStandardMaterial.prototype.copy.call(this,a);this.defines=Object.assign({},a.defines);this.uniforms=module$src$externals$three.default.UniformsUtils.clone(a.uniforms);this.type=a.type;this.softShadow=a.softShadow;this.renderAO=a.renderAO;return this};var module$src$3d$viewport$materials$ShapeDiverGemMaterial={default:{}},THREE$$module$src$3d$viewport$materials$ShapeDiverGemMaterial=module$src$externals$three.default,Shaders$$module$src$3d$viewport$materials$ShapeDiverGemMaterial=module$src$3d$viewport$shaders$ShaderFile.default;
module$src$externals$three.default.ShapeDiverGemMaterial=function(a){module$src$externals$three.default.MeshStandardMaterial.call(this);this.defines={STANDARD:"",DEPTH:5};this.uniforms=module$src$externals$three.default.UniformsUtils.merge([module$src$externals$three.default.UniformsLib.common,module$src$externals$three.default.UniformsLib.envmap,module$src$externals$three.default.UniformsLib.aomap,module$src$externals$three.default.UniformsLib.lightmap,module$src$externals$three.default.UniformsLib.bumpmap,
module$src$externals$three.default.UniformsLib.normalmap,module$src$externals$three.default.UniformsLib.displacementmap,module$src$externals$three.default.UniformsLib.roughnessmap,module$src$externals$three.default.UniformsLib.metalnessmap,module$src$externals$three.default.UniformsLib.lights,{emissive:{value:new module$src$externals$three.default.Color(0)},roughness:{value:0},metalness:{value:1},envMapIntensity:{value:1}},{refractionIndex:{value:2.4},impurityMap:{value:null},impurityScale:{value:1},
colorTransferBegin:{value:new module$src$externals$three.default.Color(16777215)},colorTransferEnd:{value:new module$src$externals$three.default.Color(16777215)},center:{value:new module$src$externals$three.default.Vector3(0,0,0)},radius:{value:1},sphericalNormalMap:{value:null},gamma:{value:1},contrast:{value:1},brightness:{value:0},dispersion:{value:0},tracingOpacity:{value:0},inverseModelMatrix:{value:new module$src$externals$three.default.Matrix4},inverseTransposeModelMatrix:{value:new module$src$externals$three.default.Matrix4}}]);
a&&(this.customEnvMap=a.customEnvMap,delete a.customEnvMap,delete a.materialType,delete a.environmentMap,this.depth=a.depth,this.defines.DEPTH=this.depth,0!=a.dispersion&&(this.defines.DISPERSION=""),this.roughness=0,this.metalness=1,this.transparent=!0,a.impurityMap&&(this.defines.USE_IMPURITY_MAP=""),this.inverseModelMatrix=this.uniforms.inverseModelMatrix.value=a.inverseModelMatrix,this.inverseTransposeModelMatrix=this.uniforms.inverseTransposeModelMatrix.value=a.inverseTransposeModelMatrix,this.refractionIndex=
this.uniforms.refractionIndex.value=a.refractionIndex,this.dispersion=this.uniforms.dispersion.value=a.dispersion,this.center=this.uniforms.center.value=a.center,this.radius=this.uniforms.radius.value=a.radius,this.sphericalNormalMap=this.uniforms.sphericalNormalMap.value=a.sphericalNormalMap,this.impurityMap=this.uniforms.impurityMap.value=a.impurityMap,this.impurityScale=this.uniforms.impurityScale.value=a.impurityScale,this.colorTransferBegin=this.uniforms.colorTransferBegin.value=a.colorTransferBegin,
this.colorTransferEnd=this.uniforms.colorTransferEnd.value=a.colorTransferEnd,this.gamma=this.uniforms.gamma.value=a.gamma,this.contrast=this.uniforms.contrast.value=a.contrast,this.brightness=this.uniforms.brightness.value=a.brightness,this.tracingOpacity=this.uniforms.tracingOpacity.value=a.tracingOpacity);this.vertexShader=module$src$3d$viewport$shaders$ShaderFile.default.gem_vert;this.fragmentShader=module$src$3d$viewport$shaders$ShaderFile.default.gem_frag;this.type="ShapeDiverGemMaterial";delete a.resolution;
delete a.line;delete a._json;this.needsUpdate=!1;this.setValues(a)};module$src$externals$three.default.ShapeDiverGemMaterial.prototype=Object.create(module$src$externals$three.default.MeshStandardMaterial.prototype);module$src$externals$three.default.ShapeDiverGemMaterial.prototype.constructor=module$src$externals$three.default.ShapeDiverGemMaterial;module$src$externals$three.default.ShapeDiverGemMaterial.prototype.isMeshStandardMaterial=!0;
module$src$externals$three.default.ShapeDiverGemMaterial.prototype.copy=function(a){module$src$externals$three.default.MeshStandardMaterial.prototype.copy.call(this,a);this.defines=a.defines;this.uniforms=module$src$externals$three.default.UniformsUtils.clone(a.uniforms);this.type=a.type;return this};
module$src$externals$three.default.ShapeDiverGemMaterial.prototype.deepCopy=function(a){module$src$externals$three.default.MeshStandardMaterial.prototype.copy.call(this,a);this.defines=Object.assign({},a.defines);this.uniforms=module$src$externals$three.default.UniformsUtils.clone(a.uniforms);this.type=a.type;return this};var module$src$3d$SceneGeometryManager={default:function(a,b){var c,d,e,f,h=[],g=[],k=[],l=new module$src$externals$three.default.Matrix4,m=new module$src$externals$three.default.Matrix4,n=[],r=new module$src$shared$util$PathUtils.default,u=function(a,b){c=this;d=a;module$src$externals$three.default.Cache.enabled=!0;e=new module$src$externals$three.default.Scene;f=new module$src$externals$three.default.Object3D;f.computeSceneBoundingBox=function(){var a=new module$src$externals$three.default.Box3;
this.traverse(function(b){var c=r.getObjectPath(b);c&&!c.includes("lightHelper")&&a.union((new module$src$externals$three.default.Box3).setFromObject(b))});0==a.min.distanceTo(a.max)&&(a=new module$src$externals$three.default.Box3(new module$src$externals$three.default.Vector3(-1,-1,-1),new module$src$externals$three.default.Vector3(1,1,1)));return a};f.computeBoundingBox=function(a){var b=new module$src$externals$three.default.Box3;if(!Array.isArray(a)||0===a.length)return this.computeSceneBoundingBox();
for(var c=0,d=a.length;c<d;c++){var e=r.getPathObject(this,a[c]+"");e&&b.union((new module$src$externals$three.default.Box3).setFromObject(e))}0==b.min.distanceTo(b.max)&&(b=this.computeSceneBoundingBox());return b};e.add(f);r.setScene(f);module$src$shared$mixins$GlobalMixin.default.call(c);b&&b.loggingHandler?module$src$shared$util$GlobalUtils.default.inject(b.loggingHandler,c):module$src$shared$mixins$LoggingMixin.default.call(c);module$src$shared$mixins$SettingsMixin.default.call(c,b.settings,
{});b&&b.messagingHandler&&module$src$shared$util$GlobalUtils.default.inject(b.messagingHandler,c)};u.prototype._getMaterials=function(a,b,e,f,g,h){a=d.threeDManager.materialHandler.getMaterial(a,b,e,f,g);(a.includes(null)||a.includes(void 0))&&c.warn("The creation of a material for at least one viewport failed.");if(!h)for(h=0,b=a.length;h<b;h++)a[h].map=null,a[h].alphaMap=null,a[h].aoMap=null,a[h].bumpMap=null,a[h].displacementMap=null,a[h].emissiveMap=null,a[h].normalMap=null,a[h].metalnessMap=
null,a[h].roughnessMap=null;return a};u.prototype._setMeshMaterialCombo=function(a,b,c,e,f,g){d.threeDManager.addMesh(a,b,c);h.push({mesh:a,properties:c,hasTextureCoordinates:e,overrideColor:f,vertexColors:g})};u.prototype._addMesh=function(a,b,d,e,f,g){if(a.transparentMeshHelper){b.renderAO=!1;b.side=module$src$externals$three.default.BackSide;var h=c._getMaterials(b,a.children[0],d,f,g,e);a.children[0].castShadow=!0;b.opacity&&.5<b.opacity&&(a.children[0].receiveShadow=!0);c._setMeshMaterialCombo(a.children[0],
h,b,e,f,g);b.side=module$src$externals$three.default.FrontSide;h=c._getMaterials(b,a.children[1],d,f,g,e);a.children[1].castShadow=!0;b.opacity&&.5<b.opacity&&(a.children[1].receiveShadow=!0);c._setMeshMaterialCombo(a.children[1],h,b,e,f,g);b.side=module$src$externals$three.default.DoubleSide}else a.meshHelper?(d=c._getMaterials(b,a.children[0],d,f,g,e),a.children[0].castShadow=!0,a.children[0].receiveShadow=!0,c._setMeshMaterialCombo(a.children[0],d,b,e,f,g)):(d=c._getMaterials(b,a,d,f,g,e),a.castShadow=
!0,a.receiveShadow=!0,c._setMeshMaterialCombo(a,d,b,e,f,g))};u.prototype._removeMesh=function(a){d.threeDManager.removeMesh(a);for(var b=0,c=h.length;b<c;b++)if(h[b].mesh===a){h.splice(b,1);break}};u.prototype._addAnchor=function(a,b){g.push({object:a,properties:b});d.threeDManager.addAnchor(a,b)};u.prototype._removeAnchor=function(a){d.threeDManager.removeAnchor(a);for(var b=0,c=g.length;b<c;b++)if(g[b].object===a){g.splice(b,1);break}};u.prototype.getScene=function(){return e};u.prototype.getGeometryNode=
function(){return f};u.prototype.getPathUtils=function(){return r};u.prototype.getMeshMaterialObjects=function(){return h};u.prototype.addGeometry=function(a,b,e,g){d.threeDManager.renderingHandler.registerForContinuousRendering("geomAddEvent");e=e||{};if(null!=r.getPathObject(f,a))return d.threeDManager.renderingHandler.unregisterForContinuousRendering("geomAddEvent"),Promise.reject(Error("Geometry already exists at that path: "+a));var h=r.ensurePath(f,a);module$src$shared$util$GlobalUtils.default.typeCheck(e.name,
"string")&&(h.SDName=e.name);module$src$shared$util$GlobalUtils.default.typeCheck(e.visible,"boolean")?h.visible=e.visible:h.visible=!0;var l=e.hasOwnProperty("boundingBox");l&&(h.SDBoundingBox=e.boundingBox);var k={};b=$jscomp.makeIterator(b);for(var m=b.next();!m.done;k={g:k.g},m=b.next()){k.g=m.value;["geometry","path","type","material"].forEach(function(a){return function(b){if(!a.g.hasOwnProperty(b))return d.threeDManager.renderingHandler.unregisterForContinuousRendering("geomAddEvent"),Promise.reject(Error("GeometryData object is missing property "+
b))}}(k));var p=r.ensurePath(h,k.g.path),n=void 0;n=k.g.material.color?new module$src$externals$three.default.Color(k.g.material.color):new module$src$externals$three.default.Color;k.g.color&&n.set(k.g.color.toRgbString());m=null;var q=!1;try{switch(k.g.type){case "mesh":k.g.geometry instanceof module$src$externals$three.default.BufferGeometry?k.g.geometry.hasOwnProperty("attributes")&&k.g.geometry.attributes.hasOwnProperty("uv")&&(q=!0):k.g.geometry instanceof module$src$externals$three.default.Geometry&&
0<k.g.geometry.faceVertexUvs.length&&(q=!0);if(k.g.geometry instanceof module$src$externals$three.default.BufferGeometry)k.g.geometry.attributes.hasOwnProperty("normal")&&null!=k.g.geometry.attributes.normal||k.g.geometry.computeVertexNormals();else if(k.g.geometry instanceof module$src$externals$three.default.Geometry&&0<k.g.geometry.faces.length){var u=k.g.geometry.faces[0];if(null==u.vertexNormals||0==u.vertexNormals.length)k.g.geometry.computeFaceNormals(),k.g.geometry.computeVertexNormals()}m=
new module$src$externals$three.default.Object3D;m.meshHelper=!0;k.g.geometry.boundingSphere||(k.g.geometry.computeBoundingSphere(),k.g.geometry.boundingSphere.realCenter=k.g.geometry.boundingSphere.center.clone(),k.g.geometry.translate(-k.g.geometry.boundingSphere.center.x,-k.g.geometry.boundingSphere.center.y,-k.g.geometry.boundingSphere.center.z));if(k.g.material&&!0===k.g.material.transparent&&k.g.material.side===module$src$externals$three.default.DoubleSide&&"gem"!==k.g.material.materialType){m.transparentMeshHelper=
!0;var F=new module$src$externals$three.default.Mesh(k.g.geometry,new module$src$externals$three.default.MeshBasicMaterial);F.position.set(k.g.geometry.boundingSphere.realCenter.x,k.g.geometry.boundingSphere.realCenter.y,k.g.geometry.boundingSphere.realCenter.z);var t=new module$src$externals$three.default.Mesh(k.g.geometry,new module$src$externals$three.default.MeshBasicMaterial);t.position.set(k.g.geometry.boundingSphere.realCenter.x,k.g.geometry.boundingSphere.realCenter.y,k.g.geometry.boundingSphere.realCenter.z);
m.add(F);m.add(t)}else{var v=new module$src$externals$three.default.Mesh(k.g.geometry,new module$src$externals$three.default.MeshBasicMaterial);v.position.set(k.g.geometry.boundingSphere.realCenter.x,k.g.geometry.boundingSphere.realCenter.y,k.g.geometry.boundingSphere.realCenter.z);m.add(v)}break;case "points":m=new module$src$externals$three.default.Points(k.g.geometry,new module$src$externals$three.default.PointsMaterial({color:n,size:1}));break;case "line":m=new module$src$externals$three.default.Line(k.g.geometry,
"dashed"===k.g.material.line.type?new module$src$externals$three.default.LineDashedMaterial({color:n,linewidth:k.g.material.line.lineWidth,dashSize:k.g.material.line.dashSize,gapSize:k.g.material.line.gapSize,scale:k.g.material.line.scale}):new module$src$externals$three.default.LineBasicMaterial({color:n,linewidth:k.g.material.line.lineWidth}));"dashed"===k.g.material.line.type&&m.computeLineDistances();break;case "linesegments":m=new module$src$externals$three.default.LineSegments(k.g.geometry,
"dashed"===k.g.material.line.type?new module$src$externals$three.default.LineDashedMaterial({color:n,linewidth:k.g.material.line.lineWidth,dashSize:k.g.material.line.dashSize,gapSize:k.g.material.line.gapSize,scale:k.g.material.line.scale}):new module$src$externals$three.default.LineBasicMaterial({color:n,linewidth:k.g.material.line.lineWidth}));"dashed"===k.g.material.line.type&&m.computeLineDistances();break;case "lineloop":m=new module$src$externals$three.default.LineLoop(k.g.geometry,"dashed"===
k.g.material.line.type?new module$src$externals$three.default.LineDashedMaterial({color:n,linewidth:k.g.material.line.lineWidth,dashSize:k.g.material.line.dashSize,gapSize:k.g.material.line.gapSize,scale:k.g.material.line.scale}):new module$src$externals$three.default.LineBasicMaterial({color:n,linewidth:k.g.material.line.lineWidth}));"dashed"===k.g.material.line.type&&m.computeLineDistances();break;case "anchor":m=new module$src$externals$three.default.Object3D,m.position.set(k.g.geometry.position.x,
k.g.geometry.position.y,k.g.geometry.position.z),m.type="Anchor",m.material={}}}catch(L){return d.threeDManager.renderingHandler.unregisterForContinuousRendering("geomAddEvent"),Promise.reject(L)}if(m){k.g.hasOwnProperty("initialMatrix")&&m.applyMatrix(k.g.initialMatrix);var C=0;for(n=m.children.length;C<n;C++)m.children[C].SDMaterialDefinition=k.g.material;p.add(m);m.meshHelper?c._addMesh(m,k.g.material,g,q,k.g.color,k.g.geometry.attributes&&k.g.geometry.attributes.hasOwnProperty("color")):"Anchor"===
m.type&&c._addAnchor(m,Object.assign({path:a+p.SDLocalPath},k.g.geometry));if("number"===typeof e.duration&&0<e.duration)for(p=0,n=m.children.length;p<n;p++)m.children[p].material.transparent=!0,m.children[p].material.opacity=0}}d.threeDManager.updateInteractions(a,e);c.evaluateGeometryVisibility();l||(g=new module$src$externals$three.default.Box3,g.setFromObject(h),h.SDBoundingBox=g);d.threeDManager.adjustScene();if("number"===typeof e.duration&&0<e.duration)return d.threeDManager.fadeIn(a,e.duration).then(function(){d.threeDManager.renderingHandler.unregisterForContinuousRendering("geomAddEvent")});
d.threeDManager.renderingHandler.unregisterForContinuousRendering("geomAddEvent");return Promise.resolve()};u.prototype.removeGeometry=function(a,b){b=b||{};var e=r.getPathObject(f,a);if(null==e)return Promise.resolve();d.threeDManager.renderingHandler.registerForContinuousRendering("geomRemoveEvent");var g=function(){d.threeDManager.removeFromInteractions(a);d.threeDManager.adjustScene();d.threeDManager.renderingHandler.unregisterForContinuousRendering("geomRemoveEvent");e.traverse(function(a){"Mesh"===
a.type?(c._removeMesh(a),a.material.dispose(),a.geometry.dispose()):"Anchor"===a.type&&c._removeAnchor(a)});if(!r.deletePath(f,a)){var b="Could not delete scene path "+a;c.error("ThreeDManager.removeGeometry",b);return Promise.reject(Error(b))}return Promise.resolve()};return"number"===typeof b.duration&&0<b.duration?d.threeDManager.fadeOut(a,b.duration).then(function(){return g()}).catch(function(b){c.error("ThreeDManager.removeGeometry","Exception when removing geometry at path "+a,b);return Promise.reject(b)}):
g()};u.prototype.replaceGeometry=function(a,b,e,g){e=e||{};d.threeDManager.renderingHandler.registerForContinuousRendering("geomReplaceEvent");for(var h=d.getApis(),l={},k=0,m=h.length;k<m;k++){var n=h[k].getSelected(),p=[];if(n.includes(a))p.push(a);else{var q=r.getPathObject(f,a);if(null!==q)for(var u=0,F=n.length;u<F;u++){var t=n[u];null!==r.getPathObject(q,t)&&p.push(t)}}l[h[k].getViewportRuntimeId()]=p}var v={};"number"===typeof e.duration&&0<e.duration&&(v={duration:.5*e.duration});["interactionGroup",
"interactionMode","dragPlaneNormal","visible"].forEach(function(a){e.hasOwnProperty(a)&&(v[a]=e[a])});return c.removeGeometry(a,v).catch(function(a){d.threeDManager.renderingHandler.unregisterForContinuousRendering("geomReplaceEvent");return Promise.reject(a)}).then(function(){c.addGeometry(a,b,v,g)}).catch(function(a){d.threeDManager.renderingHandler.unregisterForContinuousRendering("geomReplaceEvent");return Promise.reject(a)}).then(function(){for(var a=d.getApis(),b=0,c=a.length;b<c;b++){var e=
a[b],f=l[e.runtimeId];f&&0!=f.length&&e.api.updateSelected(e.api.getSelected().concat(f))}d.threeDManager.renderingHandler.unregisterForContinuousRendering("geomReplaceEvent")})};u.prototype.setToggleCastShadow=function(a,b){a=r.getPathObject(f,a);if(null==a)return!1;a.castShadow=b;a.traverse(function(a){a.castShadow=b});d.threeDManager.renderingHandler.updateShadowMap();d.api.render();return!0};u.prototype.getObjectPath=function(a){return r.getObjectPath(a)};u.prototype.getPathObject=function(a,
b){return r.getPathObject(a,b)};u.prototype.getBoundingBox=function(a){if(a=a?r.getPathObject(f,a):f){var b=new module$src$externals$three.default.Box3;a.traverseVisible(function(a){var c=r.getObjectPath(a);c&&!c.includes("lightHelpers")&&b.union((new module$src$externals$three.default.Box3).setFromObject(a))});return{min:b.min,max:b.max}}return null};u.prototype.setPluginTransformation=function(a,b,c){a=r.getPathObject(f,a);if(!a)return!1;a.originalMatrix||(a.originalMatrix=a.matrix.clone());a.transformationMatrices||
(a.transformationMatrices=[]);if(!Array.isArray(b[0])&&null!==b[0]||b.isMatrix4)b=[b];l.identity();for(var e=0,g=b.length>a.transformationMatrices.length?b.length:a.transformationMatrices.length;e<g;e++){if(b[e]){var h;a.transformationMatrices[e]=b[e].isMatrix4?b[e]:(h=m.clone()).set.apply(h,$jscomp.arrayFromIterable(b[e]))}else a.transformationMatrices[e]||(a.transformationMatrices[e]=m.clone());l.premultiply(a.transformationMatrices[e])}a.matrix.identity();a.applyMatrix(l);c||d.threeDManager.adjustScene();
d.api.render();return!0};u.prototype.getPluginTransformation=function(a){a=r.getPathObject(f,a);if(!a)return[new module$src$externals$three.default.Matrix4];if(a.transformationMatrices&&0<a.transformationMatrices.length){for(var b=[],c=0,d=a.transformationMatrices.length;c<d;c++)b[c]=a.transformationMatrices[c].clone();return b}return[a.matrix.clone()]};u.prototype.applyPluginTransformation=function(a,b,c){a=r.getPathObject(f,a);a.originalMatrix||(a.originalMatrix=a.matrix.clone());a.transformationMatrices||
(a.transformationMatrices=[]);if(!Array.isArray(b[0])&&null!==b[0]||b.isMatrix4)b=[b];l.identity();for(var e=0,g=b.length>a.transformationMatrices.length?b.length:a.transformationMatrices.length;e<g;e++){if(b[e]){var h;n[e]=b[e].isMatrix4?b[e]:(h=m.clone()).set.apply(h,$jscomp.arrayFromIterable(b[e]))}a.transformationMatrices[e]?b[e]&&a.transformationMatrices[e].multiply(n[e]):a.transformationMatrices[e]=b[e]?n[e]:m.clone();l.premultiply(a.transformationMatrices[e])}a.matrix.identity();a.applyMatrix(l);
c||d.threeDManager.adjustScene();d.api.render();return!0};u.prototype.resetPluginTransformation=function(a,b){a=r.getPathObject(f,a);a.originalMatrix&&(a.matrix.identity(),a.applyMatrix(a.originalMatrix),a.transformationMatrices=[]);b||d.threeDManager.adjustScene();d.api.render();return!0};u.prototype.toggleGeometry=function(a,b){for(var d=0;d<a.length;d++)if(module$src$shared$util$GlobalUtils.default.typeCheck(a[d],"string")){var e=r.getPathObject(f,a[d]);e&&(e.visible=!0,e.hiddenObject=!1);e=k.indexOf(a[d]);
-1<e&&k.splice(e,1)}for(a=0;a<b.length;a++)module$src$shared$util$GlobalUtils.default.typeCheck(b[a],"string")&&(k.includes(b[a])||k.push(b[a]));c.evaluateGeometryVisibility()};u.prototype.evaluateGeometryVisibility=function(){for(var a=0;a<k.length;a++){var b=r.getPathObject(f,k[a]);b&&(b.visible=!1,b.hiddenObject=!0)}d.threeDManager.renderingHandler.updateShadowMap();d.api.render()};return new u(a,b)}};var module$src$app$handlers$ViewportVisibilityHandler={},viewerAppConstants$$module$src$app$handlers$ViewportVisibilityHandler=module$src$app$ViewerAppConstants.default,MessagePrototype$$module$src$app$handlers$ViewportVisibilityHandler=module$src$shared$messages$MessagePrototype.default,GlobalUtils$$module$src$app$handlers$ViewportVisibilityHandler=module$src$shared$util$GlobalUtils.default,StateDashboardLibrary$$module$src$app$handlers$ViewportVisibilityHandler=module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary,
THREE$$module$src$app$handlers$ViewportVisibilityHandler=module$src$externals$three.default;
module$src$app$handlers$ViewportVisibilityHandler.default=function(a){var b=this,c,d=a.viewerApp,e=a.viewportManager,f=a.sceneGeometryManager,h=!1,g={isVisible:function(){return b.getSettingShallow("showScene")},showScene:function(a){if(!1===a)e.api.updateSettingAsync("show",!1),g.isVisible()&&(a=new module$src$shared$messages$MessagePrototype.default(module$src$app$ViewerAppConstants.default.messageDataTypes.GENERIC,{shownBefore:h}),b.message(module$src$app$ViewerAppConstants.default.messageTopics.SCENE_VISIBILITY_OFF,
a));else{e.api.updateSettingAsync("show",!0);c||(c=d.api({version:2}));if(!h&&!b.getSetting("hasRestoredSettings")){a=e.getApis();for(var f={},l=0;l<a.length;f={api:f.api},l++){f.api=a[l];var k=f.api.getSetting("camera.defaults.perspective");0!==k.position.x||0!==k.position.y||0!==k.position.z||0!==k.target.x||0!==k.target.y||0!==k.target.z?f.api.camera.resetAsync({duration:0}):f.api.camera.updateAsync({position:{x:0,y:-7.5,z:5},target:{x:0,y:0,z:0}},{duration:0}).then(function(a){return function(){var b=
c.scene.getBoundingBox().data;b=new module$src$externals$three.default.Box3(new module$src$externals$three.default.Vector3(b.min.x,b.min.y,b.min.z),new module$src$externals$three.default.Vector3(b.max.x,b.max.y,b.max.z));b.expandByVector(b.getSize().multiplyScalar(.25));a.api.camera.zoomAsync(b,{duration:0,default:!0})}}(f))}}h||module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary.getInstance(c.getSetting("viewerRuntimeId")).firstTimeVisible.resolve(!0);g.isVisible()||
(a=new module$src$shared$messages$MessagePrototype.default(module$src$app$ViewerAppConstants.default.messageDataTypes.GENERIC,{shownBefore:h}),b.message(module$src$app$ViewerAppConstants.default.messageTopics.SCENE_VISIBILITY_ON,a));h=!0}},hideScene:function(){b.updateSetting("showScene",!1)}};this.registerHook("showSceneTransition",function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string"))return!1;e.api.updateSettingAsync("showTransition",a);return!0});this.registerHook("showScene",
function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean")||0===f.getGeometryNode().children.length)return!1;g.showScene(a);return!0});var k={};g.messageReceiver=function(a,c,d){if(!h)if(c=c||{},d===module$src$app$ViewerAppConstants.default.messageDataTypes.PROCESS_STATUS&&0===c.progress)k[a.id]=a;else if(d===module$src$app$ViewerAppConstants.default.messageDataTypes.PROCESS_SUCCESS)k.hasOwnProperty(a.id)&&(delete k[a.id],a=b.getSettingShallow("showSceneMode"),(a===module$src$app$ViewerAppConstants.default.showSceneModes.ON_FIRST_PLUGIN||
0===Object.keys(k).length&&a===module$src$app$ViewerAppConstants.default.showSceneModes.ON_ALL_PLUGINS)&&b.updateSetting("showScene",!0));else if(d===module$src$app$ViewerAppConstants.default.messageDataTypes.PROCESS_ERROR)b.debug("ViewportVisibilityHandler.messageReceiver","Received PROCESS_ERROR for initial geometry loading process, not yet showing 3D scene",a);else if(d===module$src$app$ViewerAppConstants.default.messageDataTypes.PROCESS_FORK&&k.hasOwnProperty(a.id)){d=k[a.id];for(var e in c)c=
module$src$shared$util$GlobalUtils.default.deepCopy(d),c.id=e,k[e]=c;delete k[a.id]}};g.init=function(){b.getSetting("showSceneMode")===module$src$app$ViewerAppConstants.default.showSceneModes.INSTANT?b.updateSetting("showScene",!0):b.updateSetting("showScene",!1);setTimeout(function(){b.updateSetting("showSceneTransition",b.getSetting("showSceneTransition"))},0)};return g};var module$src$shared$scene$OutputVersion={},GlobalUtils$$module$src$shared$scene$OutputVersion=module$src$shared$util$GlobalUtils.default;
module$src$shared$scene$OutputVersion.default=function(a){var b=this,c={},d={};this.addOutputVersion=function(a){if(!a.hasOwnProperty("id")||c.hasOwnProperty(a.id))return!1;c[a.id]=a;a.hasOwnProperty("name")&&(d[a.name]=d[a.name]||[],d[a.name].push(a.id));return!0};this.removeOutputVersion=function(a){if(module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")){c[a]&&delete c[a];var b=Object.keys(d);b=$jscomp.makeIterator(b);for(var e=b.next();!e.done;e=b.next()){e=e.value;var f=d[e].indexOf(a);
-1!==f&&d[e].splice(f,1)}}};this.getOutputVersion=function(a){return c[a]};this.getOutputVersionIdByName=function(a){return d[a]};this.outputIds=Object.defineProperty(this,"outputIds",{enumerable:!0,configurable:!1,readable:!0,get:function(){return Object.keys(c)}});this.outputNames=Object.defineProperty(this,"outputNames",{enumerable:!0,configurable:!1,readable:!0,get:function(){return Object.keys(d)}});this.getCompiledOutputVersion=function(a,c){if("string"!==typeof a||!c)return null;var d=b.getOutputVersion(a);
if(!d||!Array.isArray(d.geometry)||0===d.geometry.length)return null;var e={geometry:[]};"id version name bbmin bbmax interactionGroup interactionMode duration dragPlaneNormal visible".split(" ").forEach(function(a){d.hasOwnProperty(a)&&(e[a]=d[a])});a=null;if(d.hasOwnProperty("materialId")){var f=this.getOutputVersion(d.materialId);f&&f.material&&(a=f.material)}f={};for(var h=$jscomp.makeIterator(d.geometry),n=h.next();!n.done;f={geom:f.geom,g:f.g},n=h.next()){f.geom=n.value;f.g={};"path type geometry texcoord initialMatrix material color".split(" ").forEach(function(a){return function(b){a.geom.hasOwnProperty(b)&&
(a.g[b]=a.geom[b])}}(f));["path","type"].forEach(function(a){return function(b){if(!a.g.hasOwnProperty(b))return null}}(f));if(!f.g.hasOwnProperty("material")){n=null;n=a?a:d.hasOwnProperty("material")?d.material:[c];var r=f.g.path.split(".");if(0<r.length){var u=null;r=$jscomp.makeIterator(r);for(var p=r.next();!p.done;p=r.next())if(p=p.value,p.includes("content_")){u=p;break}null!==u&&(u=u.split("_"),"content"===u[0]&&2===u.length&&(u=parseInt(u[1]),isNaN(u)||(f.g.material=n[u%n.length].clone(),
f.geom.hasOwnProperty("flatShade")&&!1===f.g.material.flatShading&&(f.g.material.flatShading=f.geom.flatShade))))}f.g.hasOwnProperty("material")||(f.g.material=n[0])}f.g.material.bumpScale=c.bumpScale;e.geometry.push(f.g)}return e};if(null!==a&&Array.isArray(a)){a=$jscomp.makeIterator(a);for(var e=a.next();!e.done;e=a.next())b.addOutputVersion(e.value)}};var module$src$shared$materials$MaterialPropertiesStandard={},THREE$$module$src$shared$materials$MaterialPropertiesStandard=module$src$externals$three.default,toTinyColor$$module$src$shared$materials$MaterialPropertiesStandard=module$src$shared$util$toTinyColor.default;
module$src$shared$materials$MaterialPropertiesStandard.default=function(){this.alphaMap=null;this.additionalMaps=[];this.mapPropertyType=[];this.mapPropertyColor=[];this.uvTransformAddMap=[];this.bumpMap=null;this.bumpScale=1;this.color=(0,module$src$shared$util$toTinyColor.default)("ffffffff").toThreeColor();this.flatShading=!1;this.lightReflectivity=1;this.line={type:"basic",lineWidth:1,dashSize:3,gapSize:1,scale:1};this.map=null;this.metalness=0;this.normalMap=this.metalnessMap=null;this.opacity=
1;this.roughness=.5;this.roughnessMap=null;this.shadowOpacity=1;this.side=module$src$externals$three.default.DoubleSide;this.threeDNoiseID=this.threeDNoiseOpacity=0;this.threeDNoiseScale=1;this.threeDNoiseDistanceFade=0;this.transparent=!1};module$src$shared$materials$MaterialPropertiesStandard.default.prototype.clone=function(){return Object.assign({},this)};var module$src$externals$verb_nurbs={};try{module$src$externals$verb_nurbs.default=eval("verb")}catch(a){"function"===typeof require&&(module$src$externals$verb_nurbs.default=eval("require('verb-nurbs')"))};var module$src$shared$util$verbToThreeConversion={default:{}},verb$$module$src$shared$util$verbToThreeConversion;try{verb$$module$src$shared$util$verbToThreeConversion=module$src$externals$verb_nurbs.default}catch(a){verb$$module$src$shared$util$verbToThreeConversion=null}
if(verb$$module$src$shared$util$verbToThreeConversion){var THREE$241=module$src$externals$three.default,asVector3=function(a){return a.map(function(a){return new module$src$externals$three.default.Vector3(a[0],a[1],a[2])})},tessellateCurve=function(a){var b=new module$src$externals$three.default.Geometry;b.vertices=asVector3(a.tessellate());return b},tessellateSurface=function(a){var b=a.tessellate();a=new module$src$externals$three.default.Geometry;a.vertices=asVector3(b.points);a.faces=b.faces.map(function(a){var c=
a.map(function(a){a=b.normals[a];return new module$src$externals$three.default.Vector3(a[0],a[1],a[2])});return new module$src$externals$three.default.Face3(a[0],a[1],a[2],c)});return a};verb$$module$src$shared$util$verbToThreeConversion.geom.NurbsCurve.prototype.toThreeGeometry=function(){return tessellateCurve(this)};verb$$module$src$shared$util$verbToThreeConversion.geom.NurbsSurface.prototype.toThreeGeometry=function(){return tessellateSurface(this)}};var module$src$shared$singletons$GLBLoader={},AXIOS$$module$src$shared$singletons$GLBLoader=module$src$externals$axios.default,THREE$$module$src$shared$singletons$GLBLoader=module$src$externals$three.default,TO_TINY_COLOR$$module$src$shared$singletons$GLBLoader=module$src$shared$util$toTinyColor.default,GLOBAL_UTILS$$module$src$shared$singletons$GLBLoader=module$src$shared$util$GlobalUtils.default,MATERIAL_PROPERTIES_STANDARD$$module$src$shared$singletons$GLBLoader=module$src$shared$materials$MaterialPropertiesStandard.default,
verb$$module$src$shared$singletons$GLBLoader,verb_util$$module$src$shared$singletons$GLBLoader;try{verb$$module$src$shared$singletons$GLBLoader=module$src$externals$verb_nurbs.default,null!==verb$$module$src$shared$singletons$GLBLoader&&(verb_util$$module$src$shared$singletons$GLBLoader=module$src$shared$util$verbToThreeConversion)}catch(a){verb$$module$src$shared$singletons$GLBLoader=null}
var GLBLoader$$module$src$shared$singletons$GLBLoader=function(){var a=this;this.log=function(){};this.warn=function(){};this.error=function(){};this.loadGeometry=function(a,d,e,f){e=e||.001;f=f||{};a={method:"GET",url:a,responseType:"arraybuffer",headers:{}};f.authorization&&(a.headers.Authorization=f.authorization);return(0,module$src$externals$axios.default)(a).catch(function(a){return a.response?Promise.reject(Error("Loading glb failed with status "+a.response.status+".")):a.request?Promise.reject(Error("No response to glb download AJAX request.")):
Promise.reject(Error("Error setting up the glb download AJAX request."))}).then(function(a){return b(a.data,d,e)})};var b=function(b,d,e){return new Promise(function(c,h){for(var f=new DataView(b),k="",l=0;4>l;++l)k+=String.fromCharCode(f.getUint8(l));if("glTF"!=k)h(Error("ShapeDiverGLBLoader got invalid data: glTF magic wrong."));else{k=f.getUint32(8,!0);l=f.getUint32(12,!0);for(var m="",n=0;n<l;++n)m+=String.fromCharCode(f.getUint8(20+n));var r=JSON.parse(m),u=20+l;if(r.hasOwnProperty("meshes")&&
r.hasOwnProperty("bufferViews")&&r.hasOwnProperty("accessors")){var p={};Object.keys(r.accessors).forEach(function(c){var d=r.accessors[c],e=d.bufferView;if(r.bufferViews.hasOwnProperty(e)){var f=r.bufferViews[e];e={};if(d.hasOwnProperty("type")&&d.hasOwnProperty("count")&&d.hasOwnProperty("componentType")){switch(d.type){case "SCALAR":e.itemSize=1;break;case "VEC2":e.itemSize=2;break;case "VEC3":e.itemSize=3;break;case "VEC4":e.itemSize=4;break;case "MAT2":e.itemSize=4;break;case "MAT3":e.itemSize=
9;break;case "MAT4":e.itemSize=16;break;default:e.itemSize=1}var g=u+parseInt(f.byteOffset)+parseInt(d.byteOffset);if(b.length<g+d.count*e.itemSize)h(Error("Error: buffer length exceeded"));else{var l=d.count*e.itemSize;switch(d.componentType){case 5120:e.typedArray=new Int8Array(b,g,l);break;case 5121:e.typedArray=new Uint8Array(b,g,l);break;case 5122:if(0==g%2)e.typedArray=new Int16Array(b,g,l);else{a.warn("Geometry loader encountered unaligned data.");f=new ArrayBuffer(2*l);var k=new Int8Array(f);
g=new Int8Array(b,g,2*l);for(var m=0,n=2*l;m<n;++m)k[m]=g[m];e.typedArray=new Int16Array(f,0,d.count*e.itemSize)}break;case 5123:if(0==g%2)e.typedArray=new Uint16Array(b,g,l);else{a.warn("Geometry loader encountered unaligned data.");f=new ArrayBuffer(2*l);k=new Int8Array(f);g=new Int8Array(b,g,2*l);d=0;for(n=2*l;d<n;++d)k[d]=g[d];e.typedArray=new Uint16Array(f,0,l)}break;case 5124:a.warn("Encountered 16 bit integer as type for array buffer. This is illegal for webGL. Ignoring it.");break;case 5125:a.warn("Encountered 16 bit unsigned integer as type for array buffer. This is illegal for webGL. Ignoring it.");
break;case 5126:if(0==g%4)e.typedArray=new Float32Array(b,g,l);else{a.warn("Geometry loader encountered unaligned data.");f=new ArrayBuffer(4*l);k=new Int8Array(f);g=new Int8Array(b,g,4*l);d=0;for(n=4*l;d<n;++d)k[d]=g[d];e.typedArray=new Float32Array(f,0,l)}break;default:e.typedArray=new Float32Array(b,g,l)}p[c]=e}}else h(Error("Invalid JSON format in glTF file. Accessor is missing required property."))}});var q={};r.hasOwnProperty("materials")&&Object.keys(r.materials).forEach(function(a){var b=
r.materials[a];if(b.hasOwnProperty("extensions"))if(b.extensions.hasOwnProperty("KHR_materials_common"))if(b.extensions.KHR_materials_common.hasOwnProperty("technique"))if("BLINN"!=b.extensions.KHR_materials_common.technique)h(Error("ShapeDiverGLBLoader got invalid data: only BLINN material technique is supported, we got "+b.extensions.KHR_materials_common.technique));else if(b.extensions.KHR_materials_common.hasOwnProperty("values")){var c=new module$src$shared$materials$MaterialPropertiesStandard.default;
b=b.extensions.KHR_materials_common.values;b.hasOwnProperty("doubleSided")&&(c.side=b.doubleSided?module$src$externals$three.default.DoubleSide:module$src$externals$three.default.FrontSide);if(b.hasOwnProperty("diffuse")){for(var d=b.diffuse.slice(0,3),e=0;3>e;++e)d[e]*=255;c.color=(0,module$src$shared$util$toTinyColor.default)(d).toThreeColor();d=Math.max(0,Math.min(b.diffuse[3],1));c.opacity=d;c.transparent=1>d}b.hasOwnProperty("shininess")&&(c.metalness=Math.min(1,b.shininess),c.roughness=1-Math.min(1,
b.shininess));b.hasOwnProperty("transparency")&&(d=Math.max(0,Math.min(b.transparency,1)),c.opacity=d,c.transparent=1>d);b.hasOwnProperty("transparent")&&(d=module$src$shared$util$GlobalUtils.default.toBoolean(b.transparent),c.transparent=d,d||(c.opacity=1));b.hasOwnProperty("_roughness")&&(c.roughness=Math.min(1,Math.max(0,b.roughness)));b.hasOwnProperty("_metalness")&&(c.metalness=Math.min(1,Math.max(0,b.metalness)));q[a]=c}else h(Error("ShapeDiverGLBLoader got invalid data: material definition did not contain values member."));
else h(Error("ShapeDiverGLBLoader got invalid data: material definition did not contain technique member."));else h(Error("ShapeDiverGLBLoader got invalid data: material definition did not contain KHR_materials_common member."));else h(Error("ShapeDiverGLBLoader got invalid data: material definition did not contain extensions member."))});var t={};Object.keys(r.meshes).forEach(function(a){var b=[],c=r.meshes[a];if(c.hasOwnProperty("primitives")){c=$jscomp.makeIterator(c.primitives);for(var d=c.next();!d.done;d=
c.next()){var e=d.value;if(!e.hasOwnProperty("indices")||!e.hasOwnProperty("attributes")){h(Error("ShapeDiverGLBLoader got invalid data: mesh definition primitive misses indices or attributes."));return}if(!e.attributes.hasOwnProperty("POSITION")){h(Error("ShapeDiverGLBLoader got invalid data: mesh definition primitive is missing POSITION"));return}d=new module$src$externals$three.default.BufferGeometry;if(!p.hasOwnProperty(e.indices)){h(Error("ShapeDiverGLBLoader got invalid data: accessor for mesh primitives not found."));
return}var f=p[e.indices];d.setIndex(new module$src$externals$three.default.BufferAttribute(f.typedArray,f.itemSize));if(!p.hasOwnProperty(e.attributes.POSITION)){h(Error("ShapeDiverGLBLoader got invalid data: accessor for mesh positions not found"));return}f=p[e.attributes.POSITION];d.addAttribute("position",new module$src$externals$three.default.BufferAttribute(f.typedArray,f.itemSize));f=!1;if(e.attributes.hasOwnProperty("NORMAL")){if(p.hasOwnProperty(e.attributes.NORMAL)){for(var g=p[e.attributes.NORMAL],
l=!1,k=0;10>k;++k){if(.001<Math.abs(g.typedArray[3*k])){l=!0;break}if(.001<Math.abs(g.typedArray[3*k+1])){l=!0;break}if(.001<Math.abs(g.typedArray[3*k+2])){l=!0;break}}l?d.addAttribute("normal",new module$src$externals$three.default.BufferAttribute(g.typedArray,g.itemSize)):d.computeVertexNormals()}}else f=!0;g=!1;e.attributes.hasOwnProperty("COLOR")&&p.hasOwnProperty(e.attributes.COLOR)&&(g=p[e.attributes.COLOR],d.addAttribute("color",new module$src$externals$three.default.BufferAttribute(g.typedArray,
g.itemSize,!0)),g=!0);k=!1;e.attributes.hasOwnProperty("TEXCOORD_0")&&p.hasOwnProperty(e.attributes.TEXCOORD_0)&&(l=p[e.attributes.TEXCOORD_0],d.addAttribute("uv",new module$src$externals$three.default.BufferAttribute(l.typedArray,l.itemSize)),k=!0);l=null;e.hasOwnProperty("material")&&(e=e.material,q.hasOwnProperty(e)&&(l=q[e]));d={geometry:d,hasTexCoord:k,hasVertexColors:g,flatShading:f};null!=l&&(d.material=l);b.push(d)}t[a]=b}else h(Error("ShapeDiverGLBLoader got invalid data: primitives property missing."))});
var v=[];Array.isArray(d)&&0!=d.length&&d.every(function(a){return a&&a.isMatrix4})||(d=[new module$src$externals$three.default.Matrix4]);Object.keys(r.nodes).forEach(function(a){var b=r.nodes[a],c=new module$src$externals$three.default.Matrix4;b.hasOwnProperty("matrix")&&c.fromArray(b.matrix);if(b.hasOwnProperty("meshes"))for(var e={transformIndex:0};e.transformIndex<d.length;e={transformIndex:e.transformIndex,matrixFinal:e.matrixFinal},++e.transformIndex){var f=d[e.transformIndex];e.matrixFinal=
new module$src$externals$three.default.Matrix4;e.matrixFinal.multiplyMatrices(f,c);b.meshes.forEach(function(b){return function(c){if(t.hasOwnProperty(c))for(var d=0,e=t[c].length;d<e;++d){var f={path:"transformation_"+b.transformIndex+"."+a+"."+c+".primitive_"+d,geometry:t[c][d].geometry,texCoord:t[c][d].hasTexCoord,vertexColors:t[c][d].hasVertexColors,initialMatrix:b.matrixFinal,type:"mesh"};t[c][d].hasOwnProperty("material")?(t[c][d].flatShading&&!1===t[c][d].material.flatShading&&(t[c][d].material.flatShading=
t[c][d].flatShading),f.material=t[c][d].material):f.flatShade=t[c][d].flatShading;v.push(f)}}}(e))}});k>=f.byteLength&&c(v);l="";for(m=0;5>m;++m)l+=String.fromCharCode(f.getUint8(k+m));if("sdgTF"!=l)a.warn("ShapeDiverGLBLoader got invalid data, sdgTF magic wrong : "+l);else{f=f.getUint32(k+13,!0);l="";m=Math.ceil(f/1024);for(n=0;n<m;++n){var w=1024;1024>f-1024*n&&(w=f-1024*n);l+=String.fromCharCode.apply(null,new Uint8Array(b,k+21+1024*n,w))}var x=JSON.parse(l),y=k+21+f;if(x.hasOwnProperty("accessors")){p=
{};Object.keys(x.accessors).forEach(function(d){var e=x.accessors[d],f={};if(e.hasOwnProperty("type")&&e.hasOwnProperty("count")&&e.hasOwnProperty("componentType")){switch(e.type){case "SCALAR":f.itemSize=1;break;case "VEC2":f.itemSize=2;break;case "VEC3":f.itemSize=3;break;case "VEC4":f.itemSize=4;break;case "VEC7":f.itemSize=7;break;case "VEC10":f.itemSize=10;break;case "VEC12":f.itemSize=12;break;case "MAT2":f.itemSize=4;break;case "MAT3":f.itemSize=9;break;case "MAT4":f.itemSize=16;break;default:f.itemSize=
1}var g=y+parseInt(e.byteOffset);b.length<g+e.count*e.itemSize&&a.warn("Error: buffer length exceeded");switch(e.componentType){case 5120:f.typedArray=new Int8Array(b,g,e.count*f.itemSize);break;case 5121:f.typedArray=new Uint8Array(b,g,e.count*f.itemSize);break;case 5122:f.typedArray=new Int16Array(b,g,e.count*f.itemSize);break;case 5123:f.typedArray=new Uint16Array(b,g,e.count*f.itemSize);break;case 5126:f.typedArray=new Float32Array(b,g,e.count*f.itemSize);break;default:f.typedArray=new Float32Array(b,
g,e.count*f.itemSize)}f.count=e.count;p[d]=f}else a.warn("ShapeDiverGLBLoader got invalid data for ShapeDiver formats. Returning pure glTF-based object only."),c(v)});if(x.hasOwnProperty("spheres")&&(k=x.spheres,k.hasOwnProperty("attributes")&&(k=k.attributes,k.hasOwnProperty("SPHERES"))))for(f=p[k.SPHERES],m=0,k=f.count;m<k;++m)l=new module$src$externals$three.default.SphereBufferGeometry(f.typedArray[4*m+3],20,20),l.translate(f.typedArray[4*m],f.typedArray[4*m+1],f.typedArray[4*m+2]),v.push({path:"sdgtf_sphere_"+
(m+1).toString(),geometry:l,texCoord:!1,type:"mesh"});if(x.hasOwnProperty("circles")&&(k=x.circles,k.hasOwnProperty("attributes")&&(k=k.attributes,k.hasOwnProperty("CIRCLES"))))for(f=p[k.CIRCLES],l=0,k=f.count;l<k;++l){m=new module$src$externals$three.default.Vector3(f.typedArray[10*l],f.typedArray[10*l+1],f.typedArray[10*l+2]);n=new module$src$externals$three.default.Vector3(f.typedArray[10*l+3],f.typedArray[10*l+4],f.typedArray[10*l+5]);w=new module$src$externals$three.default.Vector3(f.typedArray[10*
l+6],f.typedArray[10*l+7],f.typedArray[10*l+8]);var A=f.typedArray[10*l+9],z=new module$src$externals$three.default.Vector3;z.crossVectors(n,w);if(0<A){A=new module$src$externals$three.default.ArcCurve(0,0,A,0,2*Math.PI,!1);A=(new module$src$externals$three.default.Geometry).setFromPoints(A.getPoints(50));var B=new module$src$externals$three.default.Matrix4;B.set(n.x,w.x,z.x,0,n.y,w.y,z.y,0,n.z,w.z,z.z,0,0,0,0,1);A.applyMatrix(B);A.translate(m.x,m.y,m.z);A.sdgtfType="circle";v.push({path:"sdgtf_circle_"+
(l+1).toString(),geometry:A,type:"line"})}}if(x.hasOwnProperty("cylinders")&&(k=x.cylinders,k.hasOwnProperty("attributes")&&(k=k.attributes,k.hasOwnProperty("CYLINDERS"))))for(f=p[k.CYLINDERS],l=0,k=f.count;l<k;++l){z=new module$src$externals$three.default.Vector3(f.typedArray[7*l],f.typedArray[7*l+1],f.typedArray[7*l+2]);m=new module$src$externals$three.default.Vector3(f.typedArray[7*l+3],f.typedArray[7*l+4],f.typedArray[7*l+5]);A=f.typedArray[7*l+6];n=new module$src$externals$three.default.Vector3;
n.subVectors(z,m);B=Math.abs(n.dot(new module$src$externals$three.default.Vector3(1,0,0)));var D=Math.abs(n.dot(new module$src$externals$three.default.Vector3(0,1,0)));w=new module$src$externals$three.default.Vector3;B<D?w.crossVectors(n,new module$src$externals$three.default.Vector3(1,0,0)):w.crossVectors(n,new module$src$externals$three.default.Vector3(0,1,0));B=new module$src$externals$three.default.Vector3;B.crossVectors(n,w);n.normalize();w.normalize();B.normalize();A=new module$src$externals$three.default.CylinderBufferGeometry(A,
A,z.distanceTo(m),50,1,!0);A.rotateX(.5*Math.PI);A.translate(0,0,.5*z.distanceTo(m));z=new module$src$externals$three.default.Matrix4;z.set(w.x,B.x,n.x,0,w.y,B.y,n.y,0,w.z,B.z,n.z,0,0,0,0,1);A.applyMatrix(z);A.translate(m.x,m.y,m.z);v.push({path:"sdgtf_cylinder_"+(l+1).toString(),geometry:A,texCoord:!1,type:"mesh"})}if(x.hasOwnProperty("arcs")&&(k=x.arcs,k.hasOwnProperty("attributes")&&(k=k.attributes,k.hasOwnProperty("ARCS"))))for(f=p[k.ARCS],l=0,k=f.count;l<k;++l)m=new module$src$externals$three.default.Vector3(f.typedArray[12*
l],f.typedArray[12*l+1],f.typedArray[12*l+2]),n=new module$src$externals$three.default.Vector3(f.typedArray[12*l+3],f.typedArray[12*l+4],f.typedArray[12*l+5]),w=new module$src$externals$three.default.Vector3(f.typedArray[12*l+6],f.typedArray[12*l+7],f.typedArray[12*l+8]),D=f.typedArray[12*l+9],A=f.typedArray[12*l+10],B=f.typedArray[12*l+11],z=new module$src$externals$three.default.Vector3,z.crossVectors(n,w),0<D&&(D=new module$src$externals$three.default.ArcCurve(0,0,D,A,B,!1),A=(new module$src$externals$three.default.Geometry).setFromPoints(D.getPoints(Math.max(3,
Math.round((B-A)/2*50*Math.PI)))),B=new module$src$externals$three.default.Matrix4,B.set(n.x,w.x,z.x,0,n.y,w.y,z.y,0,n.z,w.z,z.z,0,0,0,0,1),A.applyMatrix(B),A.translate(m.x,m.y,m.z),A.sdgtfType="arc",v.push({path:"sdgtf_arc_"+(l+1).toString(),geometry:A,type:"line"}));if(verb$$module$src$shared$singletons$GLBLoader&&x.hasOwnProperty("beziercurves")){var G=x.beziercurves,F=0;Object.keys(G).forEach(function(b){var c=G[b];if(c.hasOwnProperty("attributes")&&c.hasOwnProperty("degree")){var d=c.attributes;
if(d.hasOwnProperty("KNOTS")&&d.hasOwnProperty("CONTROLPOINTS")){var f=p[d.KNOTS];b=[];for(var g=0,h=f.typedArray.length;g<h;++g)b.push(f.typedArray[g]),0!=g&&g!=f.typedArray.length-1||b.push(f.typedArray[g]);f=p[d.CONTROLPOINTS];d=[];g=0;for(h=f.typedArray.length/3;g<h;++g)d.push([f.typedArray[3*g],f.typedArray[3*g+1],f.typedArray[3*g+2]]);c=c.degree;try{var l=verb$$module$src$shared$singletons$GLBLoader.geom.NurbsCurve.byKnotsControlPointsWeights(c,b,d)}catch(W){a.warn("verb nurbs curve creation failed with error "+
W);return}l=l.toThreeGeometry(e);l.sdgtfType="beziercurve";v.push({path:"sdgtf_curve_"+(F+1).toString(),geometry:l,type:"line"});++F}}})}if(verb$$module$src$shared$singletons$GLBLoader&&x.hasOwnProperty("surfacepatches")){var E=x.surfacepatches,I=0;Object.keys(E).forEach(function(b){var c=E[b];if(c.hasOwnProperty("attributes")&&c.hasOwnProperty("degreeU")&&c.hasOwnProperty("degreeV")&&c.hasOwnProperty("controlPointCountU")&&c.hasOwnProperty("controlPointCountV")){var d=c.attributes;if(d.hasOwnProperty("KNOTSU")&&
d.hasOwnProperty("KNOTSV")&&d.hasOwnProperty("CONTROLPOINTS")){var f=p[d.KNOTSU];b=[];for(var g=0,h=f.typedArray.length;g<h;++g)b.push(f.typedArray[g]),0!=g&&g!=f.typedArray.length-1||b.push(f.typedArray[g]);g=p[d.KNOTSV];f=[];var l=0;for(h=g.typedArray.length;l<h;++l)f.push(g.typedArray[l]),0!=l&&l!=g.typedArray.length-1||f.push(g.typedArray[l]);h=c.controlPointCountU;g=c.controlPointCountV;l=p[d.CONTROLPOINTS];d=[];for(var k=0,m=0;m<h;++m){for(var n=[],q=0;q<g;++q)n.push([l.typedArray[3*k],l.typedArray[3*
k+1],l.typedArray[3*k+2]]),++k;d.push(n)}h=c.degreeU;c=c.degreeV;try{var F=verb$$module$src$shared$singletons$GLBLoader.geom.NurbsSurface.byKnotsControlPointsWeights(h,c,b,f,d)}catch(T){a.warn("verb surface curve creation failed with error "+T.message);return}F=F.toThreeGeometry(e);F.computeFaceNormals();F.computeVertexNormals();v.push({path:"sdgtf_surface_"+(I+1).toString(),geometry:F,texCoord:!1,type:"mesh"});++I}}})}if(x.hasOwnProperty("polylines")){var C=x.polylines,L=0;Object.keys(C).forEach(function(a){a=
C[a];if(a.hasOwnProperty("attributes")&&(a=a.attributes,a.hasOwnProperty("VERTICES"))){a=p[a.VERTICES];var b=new module$src$externals$three.default.BufferGeometry;b.addAttribute("position",new module$src$externals$three.default.BufferAttribute(a.typedArray,3));b.sdgtfType="polyline";v.push({path:"sdgtf_polyline_"+(L+1).toString(),geometry:b,type:"line"});++L}})}if(x.hasOwnProperty("points")){var H=x.points,K=0;Object.keys(H).forEach(function(a){a=H[a];if(a.hasOwnProperty("attributes")&&(a=a.attributes,
a.hasOwnProperty("POINTS"))){a=p[a.POINTS];for(var b=new module$src$externals$three.default.Geometry,c=0,d=a.typedArray.length/3;c<d;++c){var e=new module$src$externals$three.default.Vector3(a.typedArray[3*c],a.typedArray[3*c+1],a.typedArray[3*c+2]);b.vertices.push(e)}v.push({path:"sdgtf_pointcloud_"+(K+1).toString(),geometry:b,type:"points"});++K}})}}else a.warn("ShapeDiverGLBLoader got invalid data for ShapeDiver formats. Returning pure glTF-based object only.")}c(v)}else h(Error("Invalid JSON format in glTF file. Main object is missing required property."))}})}};
module$src$shared$singletons$GLBLoader.default=new GLBLoader$$module$src$shared$singletons$GLBLoader;var module$src$shared$singletons$GLTFHelpers$Node={},THREE$$module$src$shared$singletons$GLTFHelpers$Node=module$src$externals$three.default;
module$src$shared$singletons$GLTFHelpers$Node.default=function(a,b,c,d,e){this.id=a;this.gltf=b;this.nodeRef=b.nodes[a];this.parent=c||null;this.nodes=[];this.materials=[];this.rootNode=e;this.mesh=isNaN(this.nodeRef.mesh)?null:b.meshes[this.nodeRef.mesh];this.camera=isNaN(this.nodeRef.camera)?null:b.cameras[this.nodeRef.camera];this.matrix=new module$src$externals$three.default.Matrix4;this.matrix.multiply(b.rotationMatrix);this.transformedMatrix=new module$src$externals$three.default.Matrix4;this.transformationsOrder=
[];this.nodeRef.matrix?this.transformedMatrix.fromArray(this.nodeRef.matrix):(this.nodeRef.translation&&(a=new module$src$externals$three.default.Matrix4,a.makeTranslation.apply(a,$jscomp.arrayFromIterable(this.nodeRef.translation)),this.transformedMatrix.multiply(a)),this.nodeRef.rotation&&(a=new (Function.prototype.bind.apply(module$src$externals$three.default.Quaternion,[null].concat($jscomp.arrayFromIterable(this.nodeRef.rotation)))),c=new module$src$externals$three.default.Matrix4,c.makeRotationFromQuaternion(a),
this.transformedMatrix.multiply(c)),this.nodeRef.scale&&(a=new module$src$externals$three.default.Matrix4,a.makeScale.apply(a,$jscomp.arrayFromIterable(this.nodeRef.scale)),this.transformedMatrix.multiply(a)));this._setTransformationOrder();this._createChildNodes(b,d);this._resolveFinalMatrix(b);this._createMaterials(b);d.push(this)};
module$src$shared$singletons$GLTFHelpers$Node.default.prototype._mat4CoordChange=function(a){var b=new module$src$externals$three.default.Matrix4;b.fromArray(a);b.multiply(this.gltf.rotationMatrix);return b};
module$src$shared$singletons$GLTFHelpers$Node.default.prototype._setTransformationOrder=function(){var a=this.parent;for(this.transformationsOrder.push(this.transformedMatrix.clone());a;)a.transformedMatrix&&this.transformationsOrder.length&&this.transformationsOrder.push(a.transformedMatrix.clone()),a=a.parent;this.transformationsOrder.reverse()};
module$src$shared$singletons$GLTFHelpers$Node.default.prototype._createChildNodes=function(a,b){var c=this;this.nodeRef.children&&0<this.nodeRef.children.length&&this.nodeRef.children.forEach(function(d){return c.nodes.push(new module$src$shared$singletons$GLTFHelpers$Node.default(d,a,c,b))})};
module$src$shared$singletons$GLTFHelpers$Node.default.prototype._resolveFinalMatrix=function(){for(var a=this.transformationsOrder[0],b=1;b<this.transformationsOrder.length;b++)a.multiply(this.transformationsOrder[b]);this.matrix.multiply(a)};module$src$shared$singletons$GLTFHelpers$Node.default.prototype._createMaterials=function(a){var b=this;this.mesh&&this.mesh.primitives.forEach(function(c){c.hasOwnProperty("material")&&b.materials.push(a.materials[c.material])})};var module$src$shared$singletons$GLTFHelpers$SceneHierarchy={},Node$$module$src$shared$singletons$GLTFHelpers$SceneHierarchy=module$src$shared$singletons$GLTFHelpers$Node.default,THREE$$module$src$shared$singletons$GLTFHelpers$SceneHierarchy=module$src$externals$three.default;
module$src$shared$singletons$GLTFHelpers$SceneHierarchy.default=function(a){var b=this;this.sceneId=a.scene||0;this.sceneRef=a.scenes[this.sceneId];this.nodes=[];this.allNodes=[];this.rotationMatrix=new module$src$externals$three.default.Matrix4;this.rotationMatrix.makeRotationAxis(new module$src$externals$three.default.Vector3(1,0,0),.5*Math.PI);a.rotationMatrix=this.rotationMatrix;this.sceneRef.nodes.forEach(function(c){return b.nodes.push(new module$src$shared$singletons$GLTFHelpers$Node.default(c,
a,null,b.allNodes,!0))})};var module$src$shared$singletons$GLTFHelpers$WebGLConstants={default:{}};module$src$shared$singletons$GLTFHelpers$WebGLConstants.default.ELEMENT_ARRAY_BUFFER=34963;module$src$shared$singletons$GLTFHelpers$WebGLConstants.default.ARRAY_BUFFER=34962;module$src$shared$singletons$GLTFHelpers$WebGLConstants.default.UNSIGNED_BYTE=5121;module$src$shared$singletons$GLTFHelpers$WebGLConstants.default.UNSIGNED_SHORT=5123;module$src$shared$singletons$GLTFHelpers$WebGLConstants.default.UNSIGNED_INT=5125;
module$src$shared$singletons$GLTFHelpers$WebGLConstants.default.FLOAT=5126;var module$src$shared$singletons$GLTFHelpers$Accessor={},WebGLConstants$$module$src$shared$singletons$GLTFHelpers$Accessor=module$src$shared$singletons$GLTFHelpers$WebGLConstants.default,ELEM_IN_TYPE$$module$src$shared$singletons$GLTFHelpers$Accessor={SCALAR:1,VEC2:2,VEC3:3,VEC4:4},$jscomp$compprop11={},SIZE_OF_ELEM_IN_BYTES$$module$src$shared$singletons$GLTFHelpers$Accessor=($jscomp$compprop11[module$src$shared$singletons$GLTFHelpers$WebGLConstants.default.UNSIGNED_BYTE]=1,$jscomp$compprop11[module$src$shared$singletons$GLTFHelpers$WebGLConstants.default.UNSIGNED_SHORT]=
2,$jscomp$compprop11[module$src$shared$singletons$GLTFHelpers$WebGLConstants.default.UNSIGNED_INT]=4,$jscomp$compprop11[module$src$shared$singletons$GLTFHelpers$WebGLConstants.default.FLOAT]=4,$jscomp$compprop11);
module$src$shared$singletons$GLTFHelpers$Accessor.default=function(a,b,c,d){this.buffer=c;this.bufferView=d;this.id=a;this.accessorRef=b.accessors[a];this.type=this.accessorRef.type;this.componentType=this.accessorRef.componentType;this.offsetForInterleaved=this.bufferView.numOfTypeArrayElementsPerVertex;this.byteOffset=this.accessorRef.byteOffset||0;this.min=this.accessorRef.min;this.max=this.accessorRef.max;this.elementComponentsSize=ELEM_IN_TYPE$$module$src$shared$singletons$GLTFHelpers$Accessor[this.type];
this.bytesPerElement=SIZE_OF_ELEM_IN_BYTES$$module$src$shared$singletons$GLTFHelpers$Accessor[this.componentType];a=this.componentType===module$src$shared$singletons$GLTFHelpers$WebGLConstants.default.FLOAT;this.count=this.accessorRef.count;this.byteLength=this.count*this.elementComponentsSize*this.bytesPerElement;b=this.bufferView.dataView;this.bufferArray=null;c=[];this.bufferView.isInterleaved?null==this.bufferView.interleavedBuffer&&(c=this._processInterleavedBufferArray(b,a)):c=this._processBufferArray(b,
a);switch(this.bytesPerElement){case 1:this.bufferArray=new Uint8Array(c);break;case 2:this.bufferArray=new Uint16Array(c);break;case 4:this.bufferArray=a?new Float32Array(c):new Uint32Array(c)}this.array=c;this.bufferView.isInterleaved&&(this.bufferView.interleavedBuffer=this.bufferArray)};
module$src$shared$singletons$GLTFHelpers$Accessor.default.prototype._processInterleavedBufferArray=function(a,b){for(var c=[],d=0,e=0;e<this.bufferView.byteLength;e+=this.bytesPerElement){var f=0;switch(this.bytesPerElement){case 1:f=a.getUint8(e,!0);break;case 2:f=a.getUint16(e,!0);break;case 4:b?(f=a.getFloat32(e,!0),this.min&&f<this.min[d]&&(f=this.min[d]),this.max&&f>this.max[d]&&(f=this.max[d]),d++,d>=this.elementComponentsSize&&(d=0)):f=a.getUint32(e,!0)}c.push(f)}return c};
module$src$shared$singletons$GLTFHelpers$Accessor.default.prototype._processBufferArray=function(a,b){for(var c=[],d=0,e=this.byteOffset;e<this.byteOffset+this.byteLength;e+=this.bytesPerElement){var f=0;switch(this.bytesPerElement){case 1:f=a.getUint8(e,!0);break;case 2:f=a.getUint16(e,!0);break;case 4:b?(f=a.getFloat32(e,!0),this.min&&f<this.min[d]&&(f=this.min[d]),this.max&&f>this.max[d]&&(f=this.max[d]),d++,d>=this.elementComponentsSize&&(d=0)):f=a.getUint32(e,!0)}c.push(f)}return c};var module$src$shared$singletons$GLTFHelpers$BufferView={},Accessor$$module$src$shared$singletons$GLTFHelpers$BufferView=module$src$shared$singletons$GLTFHelpers$Accessor.default;
module$src$shared$singletons$GLTFHelpers$BufferView.default=function(a,b,c){var d=this;this.id=a;this.buffer=c;this.bufferViewRef=b.bufferViews[a];this.byteOffset=this.bufferViewRef.byteOffset;this.byteLength=this.bufferViewRef.byteLength;this.byteStride=this.bufferViewRef.byteStride||0;this.target=this.bufferViewRef.target;this.isInterleaved=!1;this.interleavedBuffer=null;c=b.accessors?b.accessors.filter(function(a){return a.bufferView==d.id}):[];0<c.length&&(this.isInterleaved=c[0].count*this.byteStride===
this.byteLength);this.numOfTypeArrayElementsPerVertex=0;this.accessors=[];this.dataView=new DataView(this.buffer.buffer,this.byteOffset,this.byteLength);this.strideOffset=0;for(var e in b.accessors)b.accessors[e].bufferView==a&&(c=new module$src$shared$singletons$GLTFHelpers$Accessor.default(e,b,this.buffer,this),this.numOfTypeArrayElementsPerVertex+=c.elementComponentsSize,this.accessors.push(c))};var module$src$shared$singletons$GLTFHelpers$Buffer={},BufferView$$module$src$shared$singletons$GLTFHelpers$Buffer=module$src$shared$singletons$GLTFHelpers$BufferView.default,DATA_URI_REGEX$$module$src$shared$singletons$GLTFHelpers$Buffer=/^data:(.*?)(;base64)?,(.*)$/;
module$src$shared$singletons$GLTFHelpers$Buffer.default=function(a,b){var c=this;this.id=a;this.bufferRef=b.buffers[a];this.buffer=null;this.byteLength=this.bufferRef.byteLength;this.bufferViews=[];this.onLoad=new Promise(function(a,e){if(DATA_URI_REGEX$$module$src$shared$singletons$GLTFHelpers$Buffer.test(c.bufferRef.uri)){var d=DATA_URI_REGEX$$module$src$shared$singletons$GLTFHelpers$Buffer.exec(c.bufferRef.uri);c.buffer=c._decodeDataUri(d,"arraybuffer");c._createBufferViews(b);a(c)}else if(b.isGlb){d=
new ArrayBuffer(b.dataView.byteLength);for(var h=new Uint8Array(d),g=0;g<b.dataView.byteLength;g++)h[g]=b.dataView.getUint8(g);c.buffer=d;c._createBufferViews(b);a(c)}else c._loadArrayBuffer(b.baseUrl+"/"+c.bufferRef.uri,function(d){c.buffer=d;c._createBufferViews(b);a(c)},function(a){return e(a)})})};
module$src$shared$singletons$GLTFHelpers$Buffer.default.prototype._decodeDataUri=function(a,b){b="undefined"!==typeof b?b:"";var c=a[1],d=!!a[2];a=a[3];switch(b){case "":case "text":return this._decodeDataUriText(d,a);case "arraybuffer":return this._decodeDataUriArrayBuffer(d,a);case "blob":return b=this._decodeDataUriArrayBuffer(d,a),new Blob([b],{type:c});case "document":return(new DOMParser).parseFromString(this._decodeDataUriText(d,a),c);case "json":return JSON.parse(this._decodeDataUriText(d,
a));default:throw"Unhandled responseType: "+b;}};module$src$shared$singletons$GLTFHelpers$Buffer.default.prototype._decodeDataUriText=function(a,b){b=decodeURIComponent(b);return a?atob(b):b};module$src$shared$singletons$GLTFHelpers$Buffer.default.prototype._decodeDataUriArrayBuffer=function(a,b){a=this._decodeDataUriText(a,b);b=new ArrayBuffer(a.length);for(var c=new Uint8Array(b),d=0;d<a.length;d++)c[d]=a.charCodeAt(d);return b};
module$src$shared$singletons$GLTFHelpers$Buffer.default.prototype._createBufferViews=function(a){for(var b in a.bufferViews)a.bufferViews[b].buffer==this.id&&this.bufferViews.push(new module$src$shared$singletons$GLTFHelpers$BufferView.default(b,a,this))};module$src$shared$singletons$GLTFHelpers$Buffer.default.prototype._binaryAgent3=function(a){return a.split(" ").map(function(a){return String.fromCharCode(parseInt(a,2)).join("")})};
module$src$shared$singletons$GLTFHelpers$Buffer.default.prototype._loadArrayBuffer=function(a,b,c){this._loadWithXhr(a,"arraybuffer",b,c)};
module$src$shared$singletons$GLTFHelpers$Buffer.default.prototype._loadWithXhr=function(a,b,c,d){var e=DATA_URI_REGEX$$module$src$shared$singletons$GLTFHelpers$Buffer.exec(a);if(null!==e)c(this._decodeDataUri(e,b));else{var f=new XMLHttpRequest;f.open("GET",a,!0);"undefined"!==typeof b&&(f.responseType=b);f.onload=function(a){200===f.status?c(f.response):d(a)};f.onerror=function(a){d(a)};f.send()}};var module$src$shared$singletons$GLTFHelpers$Texture={},TextureLoader$$module$src$shared$singletons$GLTFHelpers$Texture=module$src$shared$singletons$TextureLoader.default,DATA_URI_REGEX$$module$src$shared$singletons$GLTFHelpers$Texture=/^data:(.*?)(;base64)?,(.*)$/;
module$src$shared$singletons$GLTFHelpers$Texture.default=function(a,b){var c=this;this.id=a;this.textureRef=b.textures[this.id];this.imageRef=b.images[this.textureRef.source];this.texture=null;this.onLoad=new Promise(function(a,e){var d=DATA_URI_REGEX$$module$src$shared$singletons$GLTFHelpers$Texture.test(c.imageRef.uri)?c.imageRef.uri:b.baseUrl+"/"+c.imageRef.uri;module$src$shared$singletons$TextureLoader.default.loadTexture(d).then(function(b){b.flipY=!1;c.texture=b;a(c)},function(a){return e(a)})})};
module$src$shared$singletons$GLTFHelpers$Texture.default.prototype.toJSONTexture=function(){return{href:this.href}};var module$src$shared$singletons$GLTFLoader={},AXIOS$$module$src$shared$singletons$GLTFLoader=module$src$externals$axios.default,THREE$$module$src$shared$singletons$GLTFLoader=module$src$externals$three.default,SceneHierarchy$$module$src$shared$singletons$GLTFLoader=module$src$shared$singletons$GLTFHelpers$SceneHierarchy.default,Buffer$$module$src$shared$singletons$GLTFLoader=module$src$shared$singletons$GLTFHelpers$Buffer.default,Texture$$module$src$shared$singletons$GLTFLoader=module$src$shared$singletons$GLTFHelpers$Texture.default,
MaterialPropertiesStandard$$module$src$shared$singletons$GLTFLoader=module$src$shared$materials$MaterialPropertiesStandard.default,SUPPORTED_EXTENSIONS$$module$src$shared$singletons$GLTFLoader=[],GLTFLoader$$module$src$shared$singletons$GLTFLoader=function(){};GLTFLoader$$module$src$shared$singletons$GLTFLoader.prototype.log=function(){};GLTFLoader$$module$src$shared$singletons$GLTFLoader.prototype.warn=function(a){console.warn(a)};
GLTFLoader$$module$src$shared$singletons$GLTFLoader.prototype.error=function(){};
GLTFLoader$$module$src$shared$singletons$GLTFLoader.prototype.loadGeometry=function(a,b){var c=this,d=a.split(".").reverse()[0];if("glb"!=d&&"gltf"!=d)throw Error("Unexpected format "+d);var e="glb"===d;return(0,module$src$externals$axios.default)({method:"GET",url:a,timeout:3E4,responseType:e?"arraybuffer":"json"}).catch(function(a){var b="Error setting up the gltf download AJAX request.";a.response?b="Loading gltf failed with status "+a.response.status+".":a.request&&(b="No response to gltf download AJAX request.");
return Promise.reject(Error(b))}).then(function(d){var f=d.data;if(e){f=new DataView(d.data);for(var g="",k=0;4>k;++k)g+=String.fromCharCode(f.getUint8(k));if("glTF"!=g)throw Error("ShapeDiverGLtfLoader got invalid data: glTF magic wrong.");g=f.getUint32(12,!0);k="";for(var l=0;l<g;++l)k+=String.fromCharCode(f.getUint8(20+l));f=JSON.parse(k);f.glTFBinaryDataByteOffset=28+g;f.dataView=new DataView(d.data,f.glTFBinaryDataByteOffset);f.isGlb=e}f.baseUrl=c._removeLastDirectoryPartOf(a);return c._processGltf(f,
b)})};
GLTFLoader$$module$src$shared$singletons$GLTFLoader.prototype._processGltf=function(a,b){var c=this;a.extensionsUsed&&a.extensionsUsed.forEach(function(a){SUPPORTED_EXTENSIONS$$module$src$shared$singletons$GLTFLoader.some(function(b){return b===a})||c.warn("Extension "+a+" not supported.")});var d=new module$src$shared$singletons$GLTFHelpers$SceneHierarchy.default(a),e=[],f=[],h;for(h in a.buffers)e.push(new module$src$shared$singletons$GLTFHelpers$Buffer.default(h,a));for(var g in a.textures)f.push(new module$src$shared$singletons$GLTFHelpers$Texture.default(g,a));
return new Promise(function(g,h){Promise.all(e.concat(f).map(function(a){return a.onLoad})).then(function(){var h=[];e.forEach(function(a){a.bufferViews.forEach(function(a){a.accessors.forEach(function(a){h.push(a)})})});var l=[];d.allNodes.forEach(function(d){b&&Array.isArray(b)&&0!==b.length||(b=[new module$src$externals$three.default.Matrix4]);for(var e={transformIndex:0};e.transformIndex<b.length;e={transformIndex:e.transformIndex,geometry:e.geometry},e.transformIndex++)if(d.mesh)if(e.geometry=
c._createGeometry(a,d,h),d.mesh&&0===d.materials.length){var g={path:"transformation_"+e.transformIndex+"."+d.name+"."+d.mesh.name,geometry:e.geometry,initialMatrix:d.matrix.multiply(b[e.transformIndex]),type:"mesh"};l.push(g)}else d.mesh&&c._createMaterials(d,f).forEach(function(a){return function(c){c={path:"transformation_"+a.transformIndex+"."+d.name+"."+d.mesh.name,geometry:a.geometry,material:c,initialMatrix:d.matrix.multiply(b[a.transformIndex]),type:"mesh"};l.push(c)}}(e))});g(l)}).catch(function(a){return h(a)})})};
GLTFLoader$$module$src$shared$singletons$GLTFLoader.prototype._createGeometry=function(a,b,c){var d={POSITION:"position",JOINTS_0:"joint",WEIGHTS_0:"weight",NORMAL:"normal",TEXCOORD_0:"uv",COLOR_0:"color",TANGENT:"tangent"},e={POSITION:!1,NORMAL:!1,TEXCOORD_0:!1,COLOR_0:!0,TANGENT:!1,JOINTS_0:!1,WEIGHTS_0:!1},f=new module$src$externals$three.default.BufferGeometry;a=new module$src$externals$three.default.Box3;f.boundingSphere=a.getBoundingSphere();f.boundingSphere.realCenter=f.boundingSphere.center.clone();
b.mesh.primitives.forEach(function(a){var b=a.attributes||{},h=null;a.hasOwnProperty("indices")&&(h=a.indices);a=null;var l={};for(r in b){l.key=r;var m=c.find(function(a){return function(c){return c.id==b[a.key]}}(l));if(m){var n=m.bufferView;n.isInterleaved?(null==a&&(a=new module$src$externals$three.default.InterleavedBuffer(n.interleavedBuffer,n.numOfTypeArrayElementsPerVertex)),f.addAttribute(d[l.key],new module$src$externals$three.default.InterleavedBufferAttribute(a,m.elementComponentsSize,
m.offsetForInterleaved))):f.addAttribute(d[l.key],new module$src$externals$three.default.BufferAttribute(m.bufferArray,m.elementComponentsSize,e[l.key]))}l={key:l.key}}if(null!=h){var r=c.find(function(a){return a.id==h});f.setIndex(r.array)}});return f};
GLTFLoader$$module$src$shared$singletons$GLTFLoader.prototype._createDefaultMaterialForGLtfDef=function(){var a=new module$src$shared$materials$MaterialPropertiesStandard.default;a.side=module$src$externals$three.default.DoubleSide;a.metalness=1;a.roughness=1;return a};
GLTFLoader$$module$src$shared$singletons$GLTFLoader.prototype._createMaterials=function(a,b){var c=this,d=[],e={OPAQUE:module$src$externals$three.default.NormalBlending,BLEND:module$src$externals$three.default.AdditiveBlending,MASK:module$src$externals$three.default.MultiplyBlending};a.materials.forEach(function(a){var f=c._createDefaultMaterialForGLtfDef(),g=a.pbrMetallicRoughness;if(g.doubleSided||a.doubleSided)f.side=module$src$externals$three.default.DoubleSide;else if(!1===g.doubleSided||!1===
a.doubleSided)f.side=module$src$externals$three.default.FrontSide;g.hasOwnProperty("baseColorFactor")&&(f.color=new (Function.prototype.bind.apply(module$src$externals$three.default.Color,[null].concat($jscomp.arrayFromIterable(g.baseColorFactor)))));g.hasOwnProperty("baseColorTexture")&&(f.map=b[g.baseColorTexture.index].texture);g.hasOwnProperty("metallicFactor")&&(f.metalness=g.metallicFactor);g.hasOwnProperty("roughnessFactor")&&(f.roughness=g.roughnessFactor);g.hasOwnProperty("metallicRoughnessTexture")&&
(f.metalnessMap=b[g.metallicRoughnessTexture.index].texture,f.roughnessMap=b[g.metallicRoughnessTexture.index].texture);a.hasOwnProperty("normalTexture")&&(f.normalMap=b[a.normalTexture.index].texture);a.hasOwnProperty("alphaMode")?(f.blending=e[a.alphaMode],f.blending==module$src$externals$three.default.MultiplyBlending&&(f.alphaTest=.5)):f.blending=module$src$externals$three.default.NoBlending;a.hasOwnProperty("alphaCutoff")&&(f.alphaTest=a.alphaCutoff);d.push(f)});return d};
GLTFLoader$$module$src$shared$singletons$GLTFLoader.prototype._removeLastDirectoryPartOf=function(a){a=a.split("/");a.pop();return a.join("/")};module$src$shared$singletons$GLTFLoader.default=new GLTFLoader$$module$src$shared$singletons$GLTFLoader;var module$src$3d$loaders$MTLLoader={default:{}},THREE$$module$src$3d$loaders$MTLLoader=module$src$externals$three.default;module$src$externals$three.default.MTLLoader=function(a){this.manager=void 0!==a?a:module$src$externals$three.default.DefaultLoadingManager};
module$src$externals$three.default.MTLLoader.prototype={constructor:module$src$externals$three.default.MTLLoader,load:function(a,b,c,d){var e=this,f=new module$src$externals$three.default.FileLoader(this.manager);f.setPath(this.path);f.load(a,function(a){b(e.parse(a))},c,d)},setPath:function(a){this.path=a;return this},setTexturePath:function(a){this.texturePath=a;return this},setBaseUrl:function(a){console.warn("THREE.MTLLoader: .setBaseUrl() is deprecated. Use .setTexturePath( path ) for texture path or .setPath( path ) for general base path instead.");
return this.setTexturePath(a)},setCrossOrigin:function(a){this.crossOrigin=a;return this},setMaterialOptions:function(a){this.materialOptions=a;return this},parse:function(a){var b=a.split("\n"),c={},d=/\s+/;a={};for(var e=0;e<b.length;e++){var f=b[e];f=f.trim();if(0!==f.length&&"#"!==f.charAt(0)){var h=f.indexOf(" "),g=0<=h?f.substring(0,h):f;g=g.toLowerCase();f=0<=h?f.substring(h+1):"";f=f.trim();"newmtl"===g?(c={name:f},a[f]=c):c&&("ka"===g||"kd"===g||"ks"===g?(f=f.split(d,3),c[g]=[parseFloat(f[0]),
parseFloat(f[1]),parseFloat(f[2])]):c[g]=f)}}b=new module$src$externals$three.default.MTLLoader.MaterialCreator(this.texturePath||this.path,this.materialOptions);b.setCrossOrigin(this.crossOrigin);b.setManager(this.manager);b.setMaterials(a);return b}};
module$src$externals$three.default.MTLLoader.MaterialCreator=function(a,b){this.baseUrl=a||"";this.options=b;this.materialsInfo={};this.materials={};this.materialsArray=[];this.nameLookup={};this.side=this.options&&this.options.side?this.options.side:module$src$externals$three.default.FrontSide;this.wrap=this.options&&this.options.wrap?this.options.wrap:module$src$externals$three.default.RepeatWrapping};
module$src$externals$three.default.MTLLoader.MaterialCreator.prototype={constructor:module$src$externals$three.default.MTLLoader.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(a){this.crossOrigin=a;return this},setManager:function(a){this.manager=a},setMaterials:function(a){this.materialsInfo=this.convert(a);this.materials={};this.materialsArray=[];this.nameLookup={}},convert:function(a){if(!this.options)return a;var b={},c;for(c in a){var d=a[c],e={};b[c]=e;for(var f in d){var h=
!0,g=d[f],k=f.toLowerCase();switch(k){case "kd":case "ka":case "ks":this.options&&this.options.normalizeRGB&&(g=[g[0]/255,g[1]/255,g[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===g[0]&&0===g[1]&&0===g[2]&&(h=!1)}h&&(e[k]=g)}}return b},preload:function(){for(var a in this.materialsInfo)this.create(a)},getIndex:function(a){return this.nameLookup[a]},getAsArray:function(){var a=0,b;for(b in this.materialsInfo)this.materialsArray[a]=this.create(b),this.nameLookup[b]=a,a++;return this.materialsArray},
create:function(a){void 0===this.materials[a]&&this.createMaterial_(a);return this.materials[a]},createMaterial_:function(a){function b(a,b){return"string"!==typeof b||""===b?"":/^https?:\/\//i.test(b)?b:a+b}function c(a,c){if(!f[a]){c=d.getTextureParams(c,f);var e=d.loadTexture(b(d.baseUrl,c.url));e.repeat.copy(c.scale);e.offset.copy(c.offset);e.wrapS=d.wrap;e.wrapT=d.wrap;f[a]=e}}var d=this,e=this.materialsInfo[a],f={name:a,side:this.side},h;for(h in e){var g=e[h];if(""!==g)switch(h.toLowerCase()){case "kd":f.color=
(new module$src$externals$three.default.Color).fromArray(g);break;case "ks":f.specular=(new module$src$externals$three.default.Color).fromArray(g);break;case "map_kd":c("map",g);break;case "map_ks":c("specularMap",g);break;case "norm":c("normalMap",g);break;case "map_bump":case "bump":c("bumpMap",g);break;case "ns":f.shininess=parseFloat(g);break;case "d":g=parseFloat(g);1>g&&(f.opacity=g,f.transparent=!0);break;case "tr":g=parseFloat(g),this.options&&this.options.invertTrProperty&&(g=1-g),0<g&&(f.opacity=
1-g,f.transparent=!0)}}this.materials[a]=new module$src$externals$three.default.MeshPhongMaterial(f);return this.materials[a]},getTextureParams:function(a,b){var c={scale:new module$src$externals$three.default.Vector2(1,1),offset:new module$src$externals$three.default.Vector2(0,0)};a=a.split(/\s+/);var d=a.indexOf("-bm");0<=d&&(b.bumpScale=parseFloat(a[d+1]),a.splice(d,2));d=a.indexOf("-s");0<=d&&(c.scale.set(parseFloat(a[d+1]),parseFloat(a[d+2])),a.splice(d,4));d=a.indexOf("-o");0<=d&&(c.offset.set(parseFloat(a[d+
1]),parseFloat(a[d+2])),a.splice(d,4));c.url=a.join(" ").trim();return c},loadTexture:function(a,b,c,d,e){var f=module$src$externals$three.default.Loader.Handlers.get(a),h=void 0!==this.manager?this.manager:module$src$externals$three.default.DefaultLoadingManager;null===f&&(f=new module$src$externals$three.default.TextureLoader(h));f.setCrossOrigin&&f.setCrossOrigin(this.crossOrigin);a=f.load(a,c,d,e);void 0!==b&&(a.mapping=b);return a}};var module$src$3d$loaders$OBJLoader={default:{}},THREE$$module$src$3d$loaders$OBJLoader=module$src$externals$three.default;
module$src$externals$three.default.OBJLoader=function(){function a(){var a={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materialLibraries:[],startObject:function(a,b){if(this.object&&!1===this.object.fromDeclaration)this.object.name=a,this.object.fromDeclaration=!1!==b;else{var c=this.object&&"function"===typeof this.object.currentMaterial?this.object.currentMaterial():void 0;this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0);this.object={name:a||"",
fromDeclaration:!1!==b,geometry:{vertices:[],normals:[],colors:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(a,b){var c=this._finalize(!1);c&&(c.inherited||0>=c.groupCount)&&this.materials.splice(c.index,1);a={index:this.materials.length,name:a||"",mtllib:Array.isArray(b)&&0<b.length?b[b.length-1]:"",smooth:void 0!==c?c.smooth:this.smooth,groupStart:void 0!==c?c.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(a){a={index:"number"===typeof a?a:this.index,name:this.name,
mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};a.clone=this.clone.bind(a);return a}};this.materials.push(a);return a},currentMaterial:function(){if(0<this.materials.length)return this.materials[this.materials.length-1]},_finalize:function(a){var b=this.currentMaterial();b&&-1===b.groupEnd&&(b.groupEnd=this.geometry.vertices.length/3,b.groupCount=b.groupEnd-b.groupStart,b.inherited=!1);if(a&&1<this.materials.length)for(var c=this.materials.length-1;0<=c;c--)0>=
this.materials[c].groupCount&&this.materials.splice(c,1);a&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth});return b}};c&&c.name&&"function"===typeof c.clone&&(a=c.clone(0),a.inherited=!0,this.object.materials.push(a));this.objects.push(this.object)}},finalize:function(){this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(a,b){a=parseInt(a,10);return 3*(0<=a?a-1:a+b/3)},parseNormalIndex:function(a,b){a=parseInt(a,
10);return 3*(0<=a?a-1:a+b/3)},parseUVIndex:function(a,b){a=parseInt(a,10);return 2*(0<=a?a-1:a+b/2)},addVertex:function(a,b,c){var d=this.vertices,e=this.object.geometry.vertices;e.push(d[a+0],d[a+1],d[a+2]);e.push(d[b+0],d[b+1],d[b+2]);e.push(d[c+0],d[c+1],d[c+2])},addVertexPoint:function(a){var b=this.vertices;this.object.geometry.vertices.push(b[a+0],b[a+1],b[a+2])},addVertexLine:function(a){var b=this.vertices;this.object.geometry.vertices.push(b[a+0],b[a+1],b[a+2])},addNormal:function(a,b,c){var d=
this.normals,e=this.object.geometry.normals;e.push(d[a+0],d[a+1],d[a+2]);e.push(d[b+0],d[b+1],d[b+2]);e.push(d[c+0],d[c+1],d[c+2])},addColor:function(a,b,c){var d=this.colors,e=this.object.geometry.colors;e.push(d[a+0],d[a+1],d[a+2]);e.push(d[b+0],d[b+1],d[b+2]);e.push(d[c+0],d[c+1],d[c+2])},addUV:function(a,b,c){var d=this.uvs,e=this.object.geometry.uvs;e.push(d[a+0],d[a+1]);e.push(d[b+0],d[b+1]);e.push(d[c+0],d[c+1])},addUVLine:function(a){var b=this.uvs;this.object.geometry.uvs.push(b[a+0],b[a+
1])},addFace:function(a,b,c,d,e,f,r,u,p){var g=this.vertices.length;a=this.parseVertexIndex(a,g);b=this.parseVertexIndex(b,g);c=this.parseVertexIndex(c,g);this.addVertex(a,b,c);void 0!==d&&""!==d&&(c=this.uvs.length,a=this.parseUVIndex(d,c),b=this.parseUVIndex(e,c),c=this.parseUVIndex(f,c),this.addUV(a,b,c));void 0!==r&&""!==r&&(d=this.normals.length,a=this.parseNormalIndex(r,d),b=r===u?a:this.parseNormalIndex(u,d),c=r===p?a:this.parseNormalIndex(p,d),this.addNormal(a,b,c));0<this.colors.length&&
this.addColor(a,b,c)},addPointGeometry:function(a){this.object.geometry.type="Points";for(var b=this.vertices.length,c=0,d=a.length;c<d;c++)this.addVertexPoint(this.parseVertexIndex(a[c],b))},addLineGeometry:function(a,b){this.object.geometry.type="Line";for(var c=this.vertices.length,d=this.uvs.length,e=0,f=a.length;e<f;e++)this.addVertexLine(this.parseVertexIndex(a[e],c));a=0;for(f=b.length;a<f;a++)this.addUVLine(this.parseUVIndex(b[a],d))}};a.startObject("",!1);return a}function b(a){this.manager=
void 0!==a?a:module$src$externals$three.default.DefaultLoadingManager;this.materials=null}var c=/^[og]\s*(.+)?/,d=/^mtllib /,e=/^usemtl /;b.prototype={constructor:b,load:function(a,b,c,d){var e=this,f=new module$src$externals$three.default.FileLoader(e.manager);f.setPath(this.path);f.load(a,function(a){b(e.parse(a))},c,d)},setPath:function(a){this.path=a;return this},setMaterials:function(a){this.materials=a;return this},parse:function(b){console.time("OBJLoader");var f=new a;-1!==b.indexOf("\r\n")&&
(b=b.replace(/\r\n/g,"\n"));-1!==b.indexOf("\\\n")&&(b=b.replace(/\\\n/g,""));var g=b.split("\n"),k,l="function"===typeof"".trimLeft;b=0;for(var m=g.length;b<m;b++){var n=g[b];n=l?n.trimLeft():n.trim();var r=n.length;if(0!==r&&(r=n.charAt(0),"#"!==r))if("v"===r)switch(n=n.split(/\s+/),n[0]){case "v":f.vertices.push(parseFloat(n[1]),parseFloat(n[2]),parseFloat(n[3]));8===n.length&&f.colors.push(parseFloat(n[4]),parseFloat(n[5]),parseFloat(n[6]));break;case "vn":f.normals.push(parseFloat(n[1]),parseFloat(n[2]),
parseFloat(n[3]));break;case "vt":f.uvs.push(parseFloat(n[1]),parseFloat(n[2]))}else if("f"===r){n=n.substr(1).trim();var u=n.split(/\s+/);n=[];r=0;for(k=u.length;r<k;r++){var p=u[r];0<p.length&&(p=p.split("/"),n.push(p))}u=n[0];r=1;for(k=n.length-1;r<k;r++){p=n[r];var q=n[r+1];f.addFace(u[0],p[0],q[0],u[1],p[1],q[1],u[2],p[2],q[2])}}else if("l"===r){r=n.substring(1).trim().split(" ");k=[];u=[];if(-1===n.indexOf("/"))k=r;else for(n=0,p=r.length;n<p;n++)q=r[n].split("/"),""!==q[0]&&k.push(q[0]),""!==
q[1]&&u.push(q[1]);f.addLineGeometry(k,u)}else if("p"===r)n=n.substr(1).trim(),n=n.split(" "),f.addPointGeometry(n);else if(null!==(k=c.exec(n)))n=(" "+k[0].substr(1).trim()).substr(1),f.startObject(n);else if(e.test(n))f.object.startMaterial(n.substring(7).trim(),f.materialLibraries);else if(d.test(n))f.materialLibraries.push(n.substring(7).trim());else if("s"===r){if(k=n.split(" "),1<k.length?(n=k[1].trim().toLowerCase(),f.object.smooth="0"!==n&&"off"!==n):f.object.smooth=!0,n=f.object.currentMaterial())n.smooth=
f.object.smooth}else if("\x00"!==n)throw Error('THREE.OBJLoader: Unexpected line: "'+n+'"');}f.finalize();g=new module$src$externals$three.default.Group;g.materialLibraries=[].concat(f.materialLibraries);b=0;for(m=f.objects.length;b<m;b++)if(l=f.objects[b],n=l.geometry,r=l.materials,k="Line"===n.type,u="Points"===n.type,p=!1,0!==n.vertices.length){q=new module$src$externals$three.default.BufferGeometry;q.addAttribute("position",new module$src$externals$three.default.Float32BufferAttribute(n.vertices,
3));0<n.normals.length?q.addAttribute("normal",new module$src$externals$three.default.Float32BufferAttribute(n.normals,3)):q.computeVertexNormals();0<n.colors.length&&(p=!0,q.addAttribute("color",new module$src$externals$three.default.Float32BufferAttribute(n.colors,3)));0<n.uvs.length&&q.addAttribute("uv",new module$src$externals$three.default.Float32BufferAttribute(n.uvs,2));for(var t=[],v=0,w=r.length;v<w;v++){var x=r[v];n=void 0;if(null!==this.materials)if(n=this.materials.create(x.name),k&&n&&
!(n instanceof module$src$externals$three.default.LineBasicMaterial)){var y=new module$src$externals$three.default.LineBasicMaterial;y.copy(n);y.lights=!1;n=y}else if(u&&n&&!(n instanceof module$src$externals$three.default.PointsMaterial)){var A=new module$src$externals$three.default.PointsMaterial({size:10,sizeAttenuation:!1});y.copy(n);n=A}n||(n=k?new module$src$externals$three.default.LineBasicMaterial:u?new module$src$externals$three.default.PointsMaterial({size:1,sizeAttenuation:!1}):new module$src$externals$three.default.MeshPhongMaterial,
n.name=x.name);!1===n.flatShading&&(n.flatShading=x.smooth?!1:!0);n.vertexColors=p?module$src$externals$three.default.VertexColors:module$src$externals$three.default.NoColors;t.push(n)}if(1<t.length){v=0;for(w=r.length;v<w;v++)x=r[v],q.addGroup(x.groupStart,x.groupCount,v);n=k?new module$src$externals$three.default.LineSegments(q,t):u?new module$src$externals$three.default.Points(q,t):new module$src$externals$three.default.Mesh(q,t)}else n=k?new module$src$externals$three.default.LineSegments(q,t[0]):
u?new module$src$externals$three.default.Points(q,t[0]):new module$src$externals$three.default.Mesh(q,t[0]);n.name=l.name;g.add(n)}console.timeEnd("OBJLoader");return g}};return b}();var module$src$3d$loaders$DDSLoader={default:{}},THREE$$module$src$3d$loaders$DDSLoader=module$src$externals$three.default;module$src$externals$three.default.DDSLoader=function(a){module$src$externals$three.default.CompressedTextureLoader.call(this,a);this._parser=module$src$externals$three.default.DDSLoader.parse};module$src$externals$three.default.DDSLoader.prototype=Object.create(module$src$externals$three.default.CompressedTextureLoader.prototype);
module$src$externals$three.default.DDSLoader.prototype.constructor=module$src$externals$three.default.DDSLoader;
module$src$externals$three.default.DDSLoader.parse=function(a,b){function c(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function d(a,b,c,d){var e=c*d*4;a=new Uint8Array(a,b,e);e=new Uint8Array(e);for(var f=b=0,g=0;g<d;g++)for(var h=0;h<c;h++){var l=a[f];f++;var k=a[f];f++;var m=a[f];f++;var n=a[f];f++;e[b]=m;b++;e[b]=k;b++;e[b]=l;b++;e[b]=n;b++}return e}var e={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},f=c("DXT1"),h=c("DXT3"),g=c("DXT5"),
k=c("ETC1"),l=new Int32Array(a,0,31);if(542327876!==l[0])return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),e;if(!l[20]&4)return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),e;var m=l[21],n=!1;switch(m){case f:f=8;e.format=module$src$externals$three.default.RGB_S3TC_DXT1_Format;break;case h:f=16;e.format=module$src$externals$three.default.RGBA_S3TC_DXT3_Format;break;case g:f=16;e.format=module$src$externals$three.default.RGBA_S3TC_DXT5_Format;
break;case k:f=8;e.format=module$src$externals$three.default.RGB_ETC1_Format;break;default:if(32===l[22]&&l[23]&16711680&&l[24]&65280&&l[25]&255&&l[26]&4278190080)n=!0,f=64,e.format=module$src$externals$three.default.RGBAFormat;else return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",String.fromCharCode(m&255,m>>8&255,m>>16&255,m>>24&255)),e}e.mipmapCount=1;l[2]&131072&&!1!==b&&(e.mipmapCount=Math.max(1,l[7]));b=l[28];e.isCubemap=b&512?!0:!1;if(e.isCubemap&&!(b&1024&&b&2048&&b&
4096&&b&8192&&b&16384&&b&32768))return console.error("THREE.DDSLoader.parse: Incomplete cubemap faces"),e;e.width=l[4];e.height=l[3];l=l[1]+4;b=e.isCubemap?6:1;for(h=0;h<b;h++)for(g=e.width,k=e.height,m=0;m<e.mipmapCount;m++){if(n)var r=d(a,l,g,k),u=r.length;else u=Math.max(4,g)/4*Math.max(4,k)/4*f,r=new Uint8Array(a,l,u);e.mipmaps.push({data:r,width:g,height:k});l+=u;g=Math.max(g>>1,1);k=Math.max(k>>1,1)}return e};var module$src$shared$singletons$OBJLoader={},THREE$$module$src$shared$singletons$OBJLoader=module$src$externals$three.default,MaterialPropertiesStandard$$module$src$shared$singletons$OBJLoader=module$src$shared$materials$MaterialPropertiesStandard.default,OBJLoader$$module$src$shared$singletons$OBJLoader=function(){this.log=function(){};this.warn=function(){};this.error=function(){};module$src$externals$three.default.Loader.Handlers.add(/\.dds$/i,new module$src$externals$three.default.DDSLoader);
this.loadGeometry=function(a,b,c,d,e,f){var h=function(){var a=new module$src$externals$three.default.LoadingManager,f=new module$src$externals$three.default.MTLLoader(a);f.setCrossOrigin(!0);null!=c&&f.setPath(c);null!=d&&f.setTexturePath(d);var h=module$src$externals$three.default.DoubleSide;"front"===e?h=module$src$externals$three.default.FrontSide:"back"===e&&(h=module$src$externals$three.default.BackSide);var n={};n.wrap=module$src$externals$three.default.ClampToEdgeWrapping;n.side=h;f.setMaterialOptions(n);
return new Promise(function(){var c=null;a.onLoad=function(){return c.hasOwnProperty("materialsInfo")&&0<Object.keys(c.materialsInfo).length?g(c):g()};f.load(b,function(a){a.preload();c=a},function(){},function(){g()})})},g=function(b){return new Promise(function(d,e){var g=new module$src$externals$three.default.OBJLoader;null!=b&&g.setMaterials(b);null!=c&&g.setPath(c);g.load(a,function(a){Array.isArray(f)&&0!=f.length&&f.every(function(a){return a&&a.isMatrix4})||(f=[new module$src$externals$three.default.Matrix4]);
var c=[];a.traverse(function(a){if(null!=a.geometry){var d=!1;a.geometry instanceof module$src$externals$three.default.BufferGeometry?a.geometry.hasOwnProperty("attributes")&&a.geometry.attributes.hasOwnProperty("uv")&&(d=!0):a.geometry instanceof module$src$externals$three.default.Geometry&&0<a.geometry.faceVertexUvs.length&&(d=!0);var e=null;if(null!=b&&a.hasOwnProperty("material")){e=new module$src$shared$materials$MaterialPropertiesStandard.default;e.side=a.material.side;e.color=a.material.color;
e.opacity=a.material.opacity;e.transparent=a.material.transparent;a.material.hasOwnProperty("shininess")&&(e.metalness=Math.min(1,a.material.shininess),e.roughness=1-Math.min(1,a.material.shininess));if(null!=a.material.map){var g=a.material.map.clone();g.needsUpdate=!0;e.map=g}["alpha","normal","bump"].forEach(function(b){if(null!=a.material[b+"Map"]){var c=a.material[b+"Map"].clone();c.needsUpdate=!0;e[b+"Map"]=c}})}g=0;for(var h=$jscomp.makeIterator(f),l=h.next();!l.done;l=h.next())l={path:"transformation_"+
g,geometry:a.geometry,texCoord:d,initialMatrix:l.value,type:"mesh"},null!=e&&(l.material=e),c.push(l),++g}});d(c)},function(){},function(a){e(a)})})};return null!=b&&0<b.length?h:g()}};module$src$shared$singletons$OBJLoader.default=new OBJLoader$$module$src$shared$singletons$OBJLoader;var module$src$shared$singletons$THREELoader={},THREE$$module$src$shared$singletons$THREELoader=module$src$externals$three.default,THREELoader$$module$src$shared$singletons$THREELoader=function(){this.loadGeometry=function(a,b){var c=[];if(a.isMesh)var d="mesh";else if(a.isLineLoop)d="lineloop";else if(a.isLineSegments)d="linesegments";else if(a.isLine)d="line";else if(a.isPoints)d="points";else return Promise.reject(Error("Unsupported type of THREE.Object3D"));Array.isArray(b)&&0!=b.length&&b.every(function(a){return a&&
a.isMatrix4})||(b=[new module$src$externals$three.default.Matrix4]);var e=a.geometry;"Geometry"===a.geometry.type&&(e=(new module$src$externals$three.default.Geometry).copy(a.geometry));"BufferGeometry"===a.geometry.type&&(e=(new module$src$externals$three.default.BufferGeometry).copy(a.geometry));a=0;b=$jscomp.makeIterator(b);for(var f=b.next();!f.done;f=b.next())c.push({path:"transformation_"+a,geometry:e,texCoord:!1,initialMatrix:f.value,type:d}),++a;return Promise.resolve(c)}};
module$src$shared$singletons$THREELoader.default=new THREELoader$$module$src$shared$singletons$THREELoader;var module$src$shared$singletons$Tag3DLoader={default:{}},THREE$$module$src$shared$singletons$Tag3DLoader=module$src$externals$three.default,toTinyColor$$module$src$shared$singletons$Tag3DLoader=module$src$shared$util$toTinyColor.default,_font3d$$module$src$shared$singletons$Tag3DLoader=null;
module$src$shared$singletons$Tag3DLoader.default.load3DTags=function(a){return(new Promise(function(a){null==_font3d$$module$src$shared$singletons$Tag3DLoader?(new module$src$externals$three.default.FontLoader).load("https://viewer.shapediver.com/graphik_regular.typeface.json",function(b){_font3d$$module$src$shared$singletons$Tag3DLoader=b;a()}.bind(this)):a()})).then(function(){var b=[],c={},d;for(d in a){var e=a[d];e=e||{};e.size=e.size||1;e.text=e.text||"";for(var f={size:e.size,height:e.size/
10,font:_font3d$$module$src$shared$singletons$Tag3DLoader},h=e.text.split(/\r\n|\r|\n/g),g="tag3d_"+d,k=[],l=0;l<h.length;++l){var m=g+".line_"+l;f.justification=e.justification;var n=new module$src$externals$three.default.TextBufferGeometry(h[l],f);m={path:m,geometry:n,texCoord:!1,type:"mesh"};"default"!=e.color&&(m.color=(0,module$src$shared$util$toTinyColor.default)(e.color));k.push(m)}f=new module$src$externals$three.default.Object3D;g=$jscomp.makeIterator(k);for(h=g.next();!h.done;h=g.next())f.add(new module$src$externals$three.default.Mesh(h.value.geometry,
new module$src$externals$three.default.MeshPhongMaterial));g=h=g=void 0;c.lineHeight=void 0;c.lineHeight=0;h=$jscomp.makeIterator(f.children);for(g=h.next();!g.done;g=h.next())g=g.value,g=(new module$src$externals$three.default.Box3).setFromObject(g),g=g.max.y-g.min.y,c.lineHeight=Math.max(c.lineHeight,g);c.lineHeight*=1.15;k.forEach(function(a){return function(b,c){b.geometry.translate(0,(-c-1)*a.lineHeight,0)}}(c));g=(new module$src$externals$three.default.Box3).setFromObject(f);h=g.max.x-g.min.x;
g=g.max.y-g.min.y;f=new module$src$externals$three.default.Vector3(0,0,0);switch(e.justification){case "TC":f.x=.5*-h;break;case "TR":f.x=-h;break;case "ML":f.y=.5*g;break;case "MC":f.x=.5*-h;f.y=.5*g;break;case "MR":f.x=-h;f.y=.5*g;break;case "BL":f.y=g;break;case "BC":f.x=.5*-h;f.y=g;break;case "BR":f.x=-h,f.y=g}g=$jscomp.makeIterator(k);for(h=g.next();!h.done;h=g.next())h.value.geometry.translate(f.x,f.y,f.z);if(e.location.hasOwnProperty("xAxis"))for(f=new module$src$externals$three.default.Matrix4,
f.set(e.location.xAxis.X,e.location.yAxis.X,e.location.normal.X,0,e.location.xAxis.Y,e.location.yAxis.Y,e.location.normal.Y,0,e.location.xAxis.Z,e.location.yAxis.Z,e.location.normal.Z,0,0,0,0,1),g=$jscomp.makeIterator(k),h=g.next();!h.done;h=g.next())h=h.value,h.geometry.applyMatrix(f),h.geometry.translate(e.location.origin.X,e.location.origin.Y,e.location.origin.Z);Array.prototype.push.apply(b,k);c={lineHeight:c.lineHeight}}return b})};var module$src$shared$materials$MaterialPresetsDbFallback={default:{}};module$src$shared$materials$MaterialPresetsDbFallback.default["00"]={"00":{name:"Default material",color:[211,211,211,255],metalness:0,roughness:1},properties:{name:"Default materials"}};module$src$shared$materials$MaterialPresetsDbFallback.default["01"]={"01":{name:"Default groundplane material",color:[211,211,211,255],metalness:0,roughness:1},properties:{name:"Groundplane materials"}};
module$src$shared$materials$MaterialPresetsDbFallback.default["02"]={"00":{name:"Default plastic material",color:[211,211,211,255],metalness:0,roughness:1,normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},properties:{name:"Plastic materials"}};
module$src$shared$materials$MaterialPresetsDbFallback.default["03"]={10:{name:"Gold material",color:[230,207,92,255],roughness:0},11:{name:"Used gold material",color:[230,207,92,255],roughness:0,roughnesstexture:"roughnessMap.jpg"},21:{name:"Hammered metal material",color:[205,205,205,255],roughness:1,normaltexture:"normalMap.jpg"},"00":{name:"Default metal material",color:[205,205,205,255],roughness:.25},"01":{name:"Used metal material 1",color:[205,205,205,255],roughness:1,roughnesstexture:"roughnessMap.jpg"},
"02":{name:"Used metal material 2",color:[205,205,205,255],roughness:1,roughnesstexture:"roughnessMap.jpg"},"03":{name:"Used metal material 3",color:[205,205,205,255],roughness:1,roughnesstexture:"roughnessMap.jpg"},properties:{name:"Metal materials",metalness:1}};module$src$shared$materials$MaterialPresetsDbFallback.default["04"]={"00":{name:"Default glass material",color:[211,211,211,255],metalness:1,roughness:0,transparency:.75},properties:{name:"Glass materials"}};
module$src$shared$materials$MaterialPresetsDbFallback.default["05"]={10:{bitmaptexture:"map.jpg",name:"Natural oak material",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},11:{bitmaptexture:"map.jpg",name:"Premium oak material",roughnesstexture:"roughnessMap.jpg"},"00":{bitmaptexture:"map.jpg",name:"Default wood material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},"01":{bitmaptexture:"map.jpg",name:"Wood floor material",
metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},properties:{name:"Wood materials",color:[211,211,211,255],metalness:0,roughness:1}};
module$src$shared$materials$MaterialPresetsDbFallback.default["06"]={10:{bitmaptexture:"map.jpg",name:"Worn leather material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},"00":{bitmaptexture:"map.jpg",name:"Default leather material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},"01":{bitmaptexture:"map.jpg",name:"Dark brown leather material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",
roughnesstexture:"roughnessMap.jpg"},"02":{bitmaptexture:"map.jpg",name:"Black leather material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},properties:{name:"Leather materials",metalness:0,roughness:1}};
module$src$shared$materials$MaterialPresetsDbFallback.default["07"]={"00":{bitmaptexture:"map.jpg",name:"Default fabric material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},"01":{bitmaptexture:"map.jpg",name:"Grey fabric material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},properties:{name:"Fabric materials",metalness:1,roughness:1}};var module$src$modules$http_client$HttpClient={default:{}},__awaiter$$module$src$modules$http_client$HttpClient=this&&module$src$modules$http_client$HttpClient.default.__awaiter||function(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function f(a){try{l(d.next(a))}catch(n){h(n)}}function k(a){try{l(d["throw"](a))}catch(n){h(n)}}function l(a){a.done?c(a.value):e(a.value).then(f,k)}l((d=d.apply(a,b||[])).next())})},__generator$$module$src$modules$http_client$HttpClient=
this&&module$src$modules$http_client$HttpClient.default.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(f)throw new TypeError("Generator is already executing.");for(;e;)try{if(f=1,h&&(g=c[0]&2?h["return"]:c[0]?h["throw"]||((g=h["return"])&&g.call(h),0):h.next)&&!(g=g.call(h,c[1])).done)return g;if(h=0,g)c=[c[0]&2,g.value];switch(c[0]){case 0:case 1:g=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();
e.trys.pop();continue;default:if(!(g=e.trys,g=0<g.length&&g[g.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3]))e.label=c[1];else if(6===c[0]&&e.label<g[1])e.label=g[1],g=c;else if(g&&e.label<g[2])e.label=g[2],e.ops.push(c);else{g[2]&&e.ops.pop();e.trys.pop();continue}}c=b.call(a,e)}catch(m){c=[6,m],h=0}finally{f=g=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},f,h,
g,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k},__importDefault$$module$src$modules$http_client$HttpClient=this&&module$src$modules$http_client$HttpClient.default.__importDefault||function(a){return a&&a.__esModule?a:{"default":a}};Object.defineProperty(module$src$modules$http_client$HttpClient.default,"__esModule",{value:!0});
var axios_1$$module$src$modules$http_client$HttpClient=__importDefault$$module$src$modules$http_client$HttpClient(module$src$externals$axios.default),HttpClient$$module$src$modules$http_client$HttpClient=function(){function a(){this._cache={}}a.prototype.getCacheAsync=function(a){return __awaiter$$module$src$modules$http_client$HttpClient(this,void 0,void 0,function(){return __generator$$module$src$modules$http_client$HttpClient(this,function(b){this._cache[a]||(this._cache[a]=axios_1$$module$src$modules$http_client$HttpClient.default.get(a));
return[2,this._cache[a]]})})};return a}();module$src$modules$http_client$HttpClient.default.HttpClientInstance=new HttpClient$$module$src$modules$http_client$HttpClient;var module$src$shared$materials$MaterialPresets={default:{}},__awaiter$$module$src$shared$materials$MaterialPresets=this&&module$src$shared$materials$MaterialPresets.default.__awaiter||function(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function f(a){try{l(d.next(a))}catch(n){h(n)}}function k(a){try{l(d["throw"](a))}catch(n){h(n)}}function l(a){a.done?c(a.value):e(a.value).then(f,k)}l((d=d.apply(a,b||[])).next())})},__generator$$module$src$shared$materials$MaterialPresets=
this&&module$src$shared$materials$MaterialPresets.default.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(f)throw new TypeError("Generator is already executing.");for(;e;)try{if(f=1,h&&(g=c[0]&2?h["return"]:c[0]?h["throw"]||((g=h["return"])&&g.call(h),0):h.next)&&!(g=g.call(h,c[1])).done)return g;if(h=0,g)c=[c[0]&2,g.value];switch(c[0]){case 0:case 1:g=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=
e.ops.pop();e.trys.pop();continue;default:if(!(g=e.trys,g=0<g.length&&g[g.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3]))e.label=c[1];else if(6===c[0]&&e.label<g[1])e.label=g[1],g=c;else if(g&&e.label<g[2])e.label=g[2],e.ops.push(c);else{g[2]&&e.ops.pop();e.trys.pop();continue}}c=b.call(a,e)}catch(m){c=[6,m],h=0}finally{f=g=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],
ops:[]},f,h,g,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k},__importDefault$$module$src$shared$materials$MaterialPresets=this&&module$src$shared$materials$MaterialPresets.default.__importDefault||function(a){return a&&a.__esModule?a:{"default":a}};Object.defineProperty(module$src$shared$materials$MaterialPresets.default,"__esModule",{value:!0});
var GlobalUtils_1$$module$src$shared$materials$MaterialPresets=__importDefault$$module$src$shared$materials$MaterialPresets(module$src$shared$util$GlobalUtils.default),ViewerAppConstants_1$$module$src$shared$materials$MaterialPresets=__importDefault$$module$src$shared$materials$MaterialPresets(module$src$app$ViewerAppConstants.default),TEXTURE_PATH$$module$src$shared$materials$MaterialPresets="https://viewer.shapediver.com/v2/materials/",MATERIAL_PRESETS_URL$$module$src$shared$materials$MaterialPresets=
"https://viewer.shapediver.com/v2/materials/db.json",MaterialPresetsDbFallback_1$$module$src$shared$materials$MaterialPresets=__importDefault$$module$src$shared$materials$MaterialPresets(module$src$shared$materials$MaterialPresetsDbFallback.default),HttpClient_1$$module$src$shared$materials$MaterialPresets=module$src$modules$http_client$HttpClient.default,RESOLUTIONS$$module$src$shared$materials$MaterialPresets=["256","512","1024","2048"],DEFAULTRESOLUTION$$module$src$shared$materials$MaterialPresets=
"1024",MaterialPresets$$module$src$shared$materials$MaterialPresets=function(){function a(){var a=this;this._materials={};this._materialsPromise=module$src$modules$http_client$HttpClient.default.HttpClientInstance.getCacheAsync(MATERIAL_PRESETS_URL$$module$src$shared$materials$MaterialPresets).then(function(b){a.parseMaterialDatabase(b.data)},function(){return a.parseMaterialDatabase(MaterialPresetsDbFallback_1$$module$src$shared$materials$MaterialPresets.default)})}a.prototype.fromId=function(a){return __awaiter$$module$src$shared$materials$MaterialPresets(this,
void 0,void 0,function(){var b=this;return __generator$$module$src$shared$materials$MaterialPresets(this,function(c){return[2,new Promise(function(c,d){b._materialsPromise.then(function(){var d;if("string"===typeof a){var e=a.split("@");a=e[0];1<e.length&&(d=e[1])}RESOLUTIONS$$module$src$shared$materials$MaterialPresets.includes(d)||(d=DEFAULTRESOLUTION$$module$src$shared$materials$MaterialPresets);a=Number(a);100>a&&0==a%10&&(a/=10);10>a&&(a*=100);e=Math.floor(a/100);var f=a-100*e;b.hasMaterial(e,
f)?c(b.getMaterial(e,f,d)):b.hasMaterial(e,0)?c(b.getMaterial(e,0,d)):b.hasMaterial(0,0)?c(b.getMaterial(0,0,d)):c(ViewerAppConstants_1$$module$src$shared$materials$MaterialPresets.default.defaultSettings.defaultMaterial)},function(a){return d(a)})})]})})};a.prototype.getMaterial=function(a,c,d){a=this.castId(a);c=this.castId(c);d=d||DEFAULTRESOLUTION$$module$src$shared$materials$MaterialPresets;var b=GlobalUtils_1$$module$src$shared$materials$MaterialPresets.default.deepCopy(this._materials[a][c].mat),
f=TEXTURE_PATH$$module$src$shared$materials$MaterialPresets+d+"/"+a+"/"+c+"/";"bitmap metalness roughness bump normal transparency".split(" ").forEach(function(a){a+="texture";b.hasOwnProperty(a)&&(b[a]=f+b[a])});return b};a.prototype.hasMaterial=function(a,c){a=this.castId(a);c=this.castId(c);return this._materials.hasOwnProperty(a)&&this._materials[a].hasOwnProperty(c)?!0:!1};a.prototype.addMaterial=function(a,c,d,e){a=this.castId(a);c=this.castId(c);var b={version:null,name:null};Object.keys(d.properties).forEach(function(a){return b[a]=
d.properties[a]});Object.keys(e).forEach(function(a){return b[a]=e[a]});b.version=b.version||"2.0";this._materials.hasOwnProperty(a)||(this._materials[a]={});this._materials[a][c]={name:b.name,mat:b}};a.prototype.castId=function(a){"string"!==typeof a&&(a=String(a));return a.padStart(2,"0").slice(0,2)};a.prototype.parseMaterialDatabase=function(a){var b=this,d=/^\d+$/;Object.keys(a).forEach(function(c){Object.keys(a[c]).forEach(function(e){d.test(c)&&d.test(e)&&b.addMaterial(c,e,a[c],a[c][e])})})};
return a}();module$src$shared$materials$MaterialPresets.default.MaterialPresetsInstance=new MaterialPresets$$module$src$shared$materials$MaterialPresets;var module$src$shared$materials$MaterialPropertiesGem={},toTinyColor$$module$src$shared$materials$MaterialPropertiesGem=module$src$shared$util$toTinyColor.default;
module$src$shared$materials$MaterialPropertiesGem.default=function(){var a=this;a.materialType="gem";a.colorTransferBegin=(0,module$src$shared$util$toTinyColor.default)("ffffffff").toThreeColor();a.colorTransferEnd=(0,module$src$shared$util$toTinyColor.default)("ffffffff").toThreeColor();a.environmentMap=null;a.impurityMap=null;a.impurityScale=1;a.opacity=1;a.tracingOpacity=1;a.depth=8;a.refractionIndex=2.4;a.dispersion=0;a.gamma=1;a.contrast=1;a.brightness=0;a.resolution=1024;a.clone=function(){var b=
new module$src$shared$materials$MaterialPropertiesGem.default;b.materialType="gem";b.colorTransferBegin=a.colorTransferBegin;b.colorTransferEnd=a.colorTransferEnd;b.environmentMap=a.environmentMap;b.impurityMap=a.impurityMap;b.impurityScale=a.impurityScale;b.opacity=a.opacity;b.tracingOpacity=a.tracingOpacity;b.depth=a.depth;b.refractionIndex=a.refractionIndex;b.dispersion=a.dispersion;b.gamma=a.gamma;b.contrast=a.contrast;b.brightness=a.brightness;b.resolution=a.resolution;return b}};var module$src$shared$materials$MaterialParser={default:{}},__extends$$module$src$shared$materials$MaterialParser=this&&module$src$shared$materials$MaterialParser.default.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,
new d)}}(),__awaiter$$module$src$shared$materials$MaterialParser=this&&module$src$shared$materials$MaterialParser.default.__awaiter||function(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new (c||(c=Promise))(function(c,h){function f(a){try{l(d.next(a))}catch(n){h(n)}}function k(a){try{l(d["throw"](a))}catch(n){h(n)}}function l(a){a.done?c(a.value):e(a.value).then(f,k)}l((d=d.apply(a,b||[])).next())})},__generator$$module$src$shared$materials$MaterialParser=this&&
module$src$shared$materials$MaterialParser.default.__generator||function(a,b){function c(a){return function(b){return d([a,b])}}function d(c){if(f)throw new TypeError("Generator is already executing.");for(;e;)try{if(f=1,h&&(g=c[0]&2?h["return"]:c[0]?h["throw"]||((g=h["return"])&&g.call(h),0):h.next)&&!(g=g.call(h,c[1])).done)return g;if(h=0,g)c=[c[0]&2,g.value];switch(c[0]){case 0:case 1:g=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++;h=c[1];c=[0];continue;case 7:c=e.ops.pop();
e.trys.pop();continue;default:if(!(g=e.trys,g=0<g.length&&g[g.length-1])&&(6===c[0]||2===c[0])){e=0;continue}if(3===c[0]&&(!g||c[1]>g[0]&&c[1]<g[3]))e.label=c[1];else if(6===c[0]&&e.label<g[1])e.label=g[1],g=c;else if(g&&e.label<g[2])e.label=g[2],e.ops.push(c);else{g[2]&&e.ops.pop();e.trys.pop();continue}}c=b.call(a,e)}catch(m){c=[6,m],h=0}finally{f=g=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}var e={label:0,sent:function(){if(g[0]&1)throw g[1];return g[1]},trys:[],ops:[]},f,h,
g,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k},__importStar$$module$src$shared$materials$MaterialParser=this&&module$src$shared$materials$MaterialParser.default.__importStar||function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b["default"]=a;return b},__importDefault$$module$src$shared$materials$MaterialParser=this&&module$src$shared$materials$MaterialParser.default.__importDefault||
function(a){return a&&a.__esModule?a:{"default":a}};Object.defineProperty(module$src$shared$materials$MaterialParser.default,"__esModule",{value:!0});
var THREE$$module$src$shared$materials$MaterialParser=__importStar$$module$src$shared$materials$MaterialParser(module$src$externals$three.default),MaterialPresets_1$$module$src$shared$materials$MaterialParser=module$src$shared$materials$MaterialPresets.default,toTinyColor_1$$module$src$shared$materials$MaterialParser=__importDefault$$module$src$shared$materials$MaterialParser(module$src$shared$util$toTinyColor.default),TextureLoader_1$$module$src$shared$materials$MaterialParser=__importDefault$$module$src$shared$materials$MaterialParser(module$src$shared$singletons$TextureLoader.default),
loadTexture$$module$src$shared$materials$MaterialParser=TextureLoader_1$$module$src$shared$materials$MaterialParser.default.loadTexture,GlobalUtils_1$$module$src$shared$materials$MaterialParser=__importDefault$$module$src$shared$materials$MaterialParser(module$src$shared$util$GlobalUtils.default),MaterialPropertiesStandard_1$$module$src$shared$materials$MaterialParser=__importDefault$$module$src$shared$materials$MaterialParser(module$src$shared$materials$MaterialPropertiesStandard.default),MaterialPropertiesGem_1$$module$src$shared$materials$MaterialParser=
__importDefault$$module$src$shared$materials$MaterialParser(module$src$shared$materials$MaterialPropertiesGem.default),LoadCubeTextureFromJSONError$$module$src$shared$materials$MaterialParser=function(a){function b(b){void 0===b&&(b="Input object is not a valid JSON cube texture definition.");return a.call(this,b)||this}__extends$$module$src$shared$materials$MaterialParser(b,a);return b}(Error);
module$src$shared$materials$MaterialParser.default.MaterialParser=function(){function a(a){this._materialPresets=module$src$shared$materials$MaterialPresets.default.MaterialPresetsInstance;this.requestHeaders=a}a.prototype.fromJSONMaterialObject=function(a){var b=this,d="standard";a.hasOwnProperty("materialType")&&(d=a.materialType);return"gem"===d?(a.hasOwnProperty("version")||(a.version="1.0"),this.processGemMaterial(a)):a.hasOwnProperty("version")?a.hasOwnProperty("materialpreset")?new Promise(function(c,
d){b._materialPresets.fromId(a.materialpreset).then(function(d){d=GlobalUtils_1$$module$src$shared$materials$MaterialParser.default.deepCopy(d);!a.hasOwnProperty("color")||255===parseInt(a.color[0])&&255===parseInt(a.color[1])&&255===parseInt(a.color[2])||(d.color=a.color);a.hasOwnProperty("bitmaptexture")&&(d.bitmaptexture=a.bitmaptexture);a.hasOwnProperty("bumptexture")&&(d.bumptexture=a.bumptexture);c(b.processStandardMaterial(d,"2.0"))},function(a){return d(a)})}):this.processStandardMaterial(a,
a.version):Promise.reject(Error("Material definition did not have version number defined"))};a.prototype.loadCubeTextureFromJSON=function(b){return __awaiter$$module$src$shared$materials$MaterialParser(this,void 0,void 0,function(){var c,d,e,f;return __generator$$module$src$shared$materials$MaterialParser(this,function(h){if(void 0===b)return[2,Promise.reject(new LoadCubeTextureFromJSONError$$module$src$shared$materials$MaterialParser)];if("string"===typeof b||Array.isArray(b))b={href:b};d="px nx pz nz py ny".split(" ");
if(GlobalUtils_1$$module$src$shared$materials$MaterialParser.default.typeCheck(b.href,"string")&&b.href.startsWith('["https')&&b.href.endsWith('"]')){e=b.href;try{b.href=JSON.parse(e)}catch(g){b.href=e}}if(Array.isArray(b.href)&&(c=b.href,6!==c.length))return[2,Promise.reject(new LoadCubeTextureFromJSONError$$module$src$shared$materials$MaterialParser)];if(void 0===c)if(c=[],f=void 0,b.href.startsWith("https://")||b.href.startsWith("http://"))for(b.href.endsWith("/")||(b.href+="/"),f=0;f<d.length;f++)c.push(b.href+
d[f]+".jpg");else return[2,Promise.reject(Error())];return[2,new Promise(function(b,d){return a.cubeTextureLoader.load(c,function(a){return b(a)},null,function(){return d(new LoadCubeTextureFromJSONError$$module$src$shared$materials$MaterialParser)})})]})})};a.prototype.loadTextureFromJSON=function(a){"string"===typeof a&&(a={href:a});if(!a.hasOwnProperty("href")&&!a.hasOwnProperty("canvas"))return Promise.reject(Error("Input object is not a valid JSON texture definition."));var b={offset:a.offset||
[0,0],repeat:a.repeat||[1,1],rotation:a.rotation||0,center:a.center||[0,0],color:a.color||null};return loadTexture$$module$src$shared$materials$MaterialParser(a.href||a.canvas,b,this.requestHeaders).then(function(a){if(b.color){var c=toTinyColor_1$$module$src$shared$materials$MaterialParser.default(b.color);c&&c.isValid()&&(a.SDColor=c)}return a},function(a){return Promise.reject(a)})};a.prototype.processGemMaterial=function(a){var b=this,d=new MaterialPropertiesGem_1$$module$src$shared$materials$MaterialParser.default;
["depth","resolution"].forEach(function(b){if(a.hasOwnProperty(b)){var c=parseInt(a[b]);!isNaN(c)&&isFinite(c)&&("resolution"===b?c&c-1||(d[b]=c):d[b]=c)}});"impurityScale tracingTransparency transparency dispersion refractionIndex gamma contrast brightness".split(" ").forEach(function(b){if(a.hasOwnProperty(b)){var c=parseFloat(a[b]);if(!isNaN(c)&&isFinite(c))switch(b){case "tracingTransparency":d.tracingOpacity=1-c;break;case "transparency":d.opacity=1-c;break;default:d[b]=c}}});["colorTransferBegin",
"colorTransferEnd"].forEach(function(b){if(a.hasOwnProperty(b)){var c=toTinyColor_1$$module$src$shared$materials$MaterialParser.default(a[b]);c&&c.isValid()&&(d[b]=c.toThreeColor())}});var e=[];["impurity","environment"].forEach(function(c){var f=c+"texture",g=a[f];a.hasOwnProperty(f)&&g&&e.push(b.loadCubeTextureFromJSON(g).then(function(a){return d[c+"Map"]=a}))});return Promise.all(e).then(function(){d._json=a;return d})};a.prototype.processStandardMaterial=function(a,c){var b=this;if(-1==["1.0",
"2.0","3.0"].indexOf(c))return Promise.reject(Error("Material definition has unknown version."));var e=new MaterialPropertiesStandard_1$$module$src$shared$materials$MaterialParser.default;"1.0"===c&&(null!=a.shine&&(a.metalness=Math.min(1,a.shine)),null!=a.shine&&(a.roughness=1-Math.min(1,a.shine)),a.hasOwnProperty("diffuse")&&!a.hasOwnProperty("color")&&(a.color=a.diffuse));"metalness roughness alphaThreshold shadowOpacity lightReflectivity transparency bumpAmplitude".split(" ").forEach(function(b){if(a.hasOwnProperty(b)){var c=
parseFloat(a[b]);if(!isNaN(c)&&isFinite(c))switch(b){case "transparency":e.opacity=1-c;e.transparent=0<c;break;case "bumpAmplitude":e.bumpScale=c;break;default:e[b]=c}}});["color"].forEach(function(b){if(a.hasOwnProperty(b)){var c=toTinyColor_1$$module$src$shared$materials$MaterialParser.default(a[b]);c&&c.isValid()&&(e[b]=c.toThreeColor())}});a.hasOwnProperty("threeDNoise")&&(e.threeDNoiseOpacity=a.threeDNoise.opacity||0,e.threeDNoiseID=a.threeDNoise.noiseID||0,e.threeDNoiseScale=a.threeDNoise.scale||
1,e.threeDNoiseDistanceFade=a.threeDNoise.distance||0);a.hasOwnProperty("line")&&(e.line.type=GlobalUtils_1$$module$src$shared$materials$MaterialParser.default.typeCheck(a.line.type,"string")?a.line.type:"basic",e.line.lineWidth=GlobalUtils_1$$module$src$shared$materials$MaterialParser.default.typeCheck(a.line.lineWidth,"notnegative")?a.line.lineWidth:1,e.line.dashSize=GlobalUtils_1$$module$src$shared$materials$MaterialParser.default.typeCheck(a.line.dashSize,"notnegative")?a.line.dashSize:3,e.line.gapSize=
GlobalUtils_1$$module$src$shared$materials$MaterialParser.default.typeCheck(a.line.gapSize,"notnegative")?a.line.gapSize:1,e.line.scale=GlobalUtils_1$$module$src$shared$materials$MaterialParser.default.typeCheck(a.line.scale,"notnegative")?a.line.scale:1);var f=[];if(a.hasOwnProperty("bitmaptexture"))if(Array.isArray(a.bitmaptexture)){if(0===a.bitmaptexture.length)return Promise.resolve(null);c=[];for(var h=0,g=a.bitmaptexture;h<g.length;h++)c.push(this.loadTextureFromJSON(g[h]));f.push(Promise.all(c).then(function(a){if(1<
a.length){e.additionalMaps=[];e.mapPropertyType=[];e.mapPropertyColor=[];e.uvTransformAddMap=[];for(var b=1,c=a.length;b<c;++b){var d=a[b];e.additionalMaps.push(d);e.mapPropertyType.push(d.hasOwnProperty("SDColor")?1:0);var f=d.hasOwnProperty("SDColor")&&d.SDColor?d.SDColor.toThreeColor():new THREE$$module$src$shared$materials$MaterialParser.Color;e.mapPropertyColor.push(f);e.uvTransformAddMap.push(d.uvTransform)}}return e.map=a[0]}))}else f.push(this.loadTextureFromJSON(a.bitmaptexture).then(function(a){return e.map=
a}));["metalness","roughness","bump","normal","transparency"].forEach(function(c){a.hasOwnProperty(c+"texture")&&f.push(b.loadTextureFromJSON(a[c+"texture"]).then(function(a){"transparency"===c?(e.alphaMap=a,e.transparent=!0):e[c+"Map"]=a}))});return Promise.all(f).then(function(){e._json=a;return e})};a.cubeTextureLoader=new THREE$$module$src$shared$materials$MaterialParser.CubeTextureLoader;return a}();var module$src$app$partials$ViewerAppSceneManager={},THREE$$module$src$app$partials$ViewerAppSceneManager=module$src$externals$three.default,toTinyColor$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$util$toTinyColor.default,messagingConstants$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$constants$MessagingConstants.default,MessagePrototype$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$messages$MessagePrototype.default,SubScene$$module$src$app$partials$ViewerAppSceneManager=
module$src$shared$scene$OutputVersion.default,GlobalUtils$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$util$GlobalUtils.default,GLBLoader$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$singletons$GLBLoader.default,GLTFLoader$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$singletons$GLTFLoader.default,OBJLoader$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$singletons$OBJLoader.default,THREELoader$$module$src$app$partials$ViewerAppSceneManager=
module$src$shared$singletons$THREELoader.default,Tag3DLoader$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$singletons$Tag3DLoader.default,MaterialParser$$module$src$app$partials$ViewerAppSceneManager=module$src$shared$materials$MaterialParser.default.MaterialParser;
module$src$app$partials$ViewerAppSceneManager.default=function(a){var b=this,c=a.sceneGeometryManager,d={},e={},f={},h=["canvas","threeObject","transformations"],g={},k={},l={},m={},n=Promise.resolve(),r={},u={},p={},q=["interactionGroup","interactionMode","duration","dragPlaneNormal","visible"],t={authorization:b.getSettingShallow("authorization")};b.registerHook("authorization",function(a){t.authorization=a});var v=function(a,b,c){b=Error(b);b.scope=a;b.data=c;return Promise.reject(b)},w=function(a,
b){var c;var d=function(a,b){return v("SceneManager._addOutputVersion",a,b)};var e=a.id;var k=l[e];var m=k.creatorId;var n=b.id;var p=!1;if(f[m]&&f[m][n]&&(n=f[m][n],n.ov))for(c in p=!0,n=n.ov,n)"_json"===c?(b._json_scene=module$src$shared$util$GlobalUtils.default.deepCopy(b[c],h),module$src$shared$util$GlobalUtils.default.defaults(b._json_scene,n._json,!0)):"_json_scene"!==c&&(b[c]=n[c]);p||delete b._json_scene;if(!g[m][e].subScene.addOutputVersion(b))return d("could not add output version to subscene");
++k.finishedOutputVersions;return k.finishedOutputVersions<k.totalOutputVersions?Promise.resolve(!0):y(a)},x=function(a,f,g,h){var l=function(a,b){return v("SceneManager._publishSubScene",a,b)};var k=g.id;h=h||{};var F="boolean"===typeof h.forceUpdate||"string"===typeof h.forceUpdate?h.forceUpdate:!1;if(!b.hasSetting("defaultMaterial"))return l("no default material configured");var u=p[f+"."+k],w=r[f];return w&&w.serial>u?Promise.resolve(!1):n=w=n.then(function(){var n=null;return(new module$src$shared$materials$MaterialParser.default.MaterialParser(t)).fromJSONMaterialObject(b.getSetting("defaultMaterial")).then(function(a){n=
a},function(a){return l("could not create default material",a)}).then(function(){for(var p=a.outputIds,t=e.hasOwnProperty(f)?e[f]._subSceneObject:null,w=null!==t?t.outputIds:[],E=$jscomp.makeIterator(w),v=E.next();!v.done;v=E.next())v=v.value,-1===p.indexOf(v)&&(a.addOutputVersion(t.getOutputVersion(v)),p.push(v));E=[];var x={},I={},y={assets:{add:{},replace:{},remove:{}}};v={};for(var A=p.length-1;-1<A;v={compiledOutputVersion:v.compiledOutputVersion,options:v.options,options$292:v.options$292},
--A){var z=p[A],B=a.getOutputVersion(z),D=d.getJSONOutputVersion(z,f,!0);if(B.hasOwnProperty("geometry")){v.compiledOutputVersion=a.getCompiledOutputVersion(z,n);if(!v.compiledOutputVersion||!Array.isArray(v.compiledOutputVersion.geometry))return l("could not compile output version "+z);I[z]={};for(var C={},G=$jscomp.makeIterator(v.compiledOutputVersion.geometry),H=G.next();!H.done;C={g:C.g,o:C.o},H=G.next()){C.g=H.value;C.o=I[z];H=C.g.path.split(".");H=$jscomp.makeIterator(H);for(var L=H.next();!L.done;L=
H.next())L=L.value,C.o[L]=C.o[L]||{},C.o=C.o[L];["type","geometry","material","initialMatrix"].forEach(function(a){return function(b){a.g.hasOwnProperty(b)&&(a.o[b]=a.g[b])}}(C));C.o._isSDGeometry=!0}if(-1===w.indexOf(z)){v.options={};v.compiledOutputVersion.hasOwnProperty("name")&&(v.options.name=v.compiledOutputVersion.name);if(v.compiledOutputVersion.hasOwnProperty("bbmin")&&v.compiledOutputVersion.hasOwnProperty("bbmax"))try{var K=new module$src$externals$three.default.Box3(module$src$shared$util$GlobalUtils.default.toVector3(v.compiledOutputVersion.bbmin),
module$src$shared$util$GlobalUtils.default.toVector3(v.compiledOutputVersion.bbmax));if(0<K.min.lengthSq()||0<K.max.lengthSq())v.options.boundingBox=K}catch(ca){b.debug("SceneManager._publishSubScene","invalid bounding box for output version "+z,ca)}q.forEach(function(a){return function(b){a.compiledOutputVersion.hasOwnProperty(b)&&(a.options[b]=a.compiledOutputVersion[b])}}(v));E.push(c.addGeometry(f+"."+z,v.compiledOutputVersion.geometry,v.options,B.version));y.assets.add[z]=D}else(C=!0===F||F===
z)||(C=t.getOutputVersion(z).version!==B.version),!C&&B.materialId&&(G=a.getOutputVersion(B.materialId),(H=t.getOutputVersion(B.materialId))&&G.version===H.version&&B.materialId!==F||(C=!0)),C&&(v.options$292={},q.forEach(function(a){return function(b){a.compiledOutputVersion.hasOwnProperty(b)&&(a.options$292[b]=a.compiledOutputVersion[b])}}(v)),"number"===typeof h.duration&&0<=h.duration&&(v.options$292.duration=h.duration),E.push(c.replaceGeometry(f+"."+z,v.compiledOutputVersion.geometry,v.options$292,
B.version)),y.assets.replace[z]=D)}else t&&(C=t.getOutputVersion(z))&&C.geometry&&(E.push(c.removeGeometry(f+"."+z)),y.assets.remove[z]=D);B.hasOwnProperty("data")&&(x[z]=B.data)}return Promise.all(E).then(function(){e[f]=I;e[f]._subSceneObject=a;m[f]=x;r[f]={serial:u,id:k};Object.keys(y.assets.add).forEach(function(a){y.assets.add[a]=d.getJSONOutputVersion(a,f,!0)});var c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_UPDATE,
y,g);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_PUBLISHED,c);0<Object.keys(x).length&&(c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.DATA,x,g),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.DATA,c));return y})})})},y=function(a){var d=function(a,b){return v("SceneManager._finishProcess",a,b)};var f=a.id;var h=l[f];var m=h.creatorId;
k[m]=k[m]||{};k[m][f]=g[m][f];delete g[m][f];0===Object.keys(g[m]).length&&delete g[m];var n=k[m][f].subScene,p=e[m]?e[m]._subSceneObject:null,q=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{state:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_READY,progress:.75},a);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,q);return x(n,
m,a,h.options).then(function(a){delete k[m][f];0===Object.keys(k[m]).length&&delete k[m];return a},function(b){if(null!==p)return x(p,m,a).then(function(){return d("publishing of subscene failed, restored previous state",b)});e.hasOwnProperty(m)&&delete e[m];return c.removeGeometry(m).then(function(){return d("publishing of subscene failed, restored previous state",b)})}).catch(function(a){return d("publishing of subscene failed",a)})},A=function(a,b){var c=function(a,b){return v("SceneManager._convertOutputVersion",
a,b)};void 0===b&&(b=!1);a=a||{};if(!b){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a.version,"string"))return c("version missing");if(!Array.isArray(a.content))return c("content array missing")}var d={id:a.id};["version","name"].concat($jscomp.arrayFromIterable(q)).forEach(function(b){void 0!==a[b]&&null!==a[b]&&(d[b]=a[b])});module$src$shared$util$GlobalUtils.default.typeCheck(a.material,"string")&&(d.materialId=a.material);module$src$shared$util$GlobalUtils.default.typeCheck(a.bbmin,
"vector3any")&&(d.bbmin=module$src$shared$util$GlobalUtils.default.toVector3(a.bbmin));module$src$shared$util$GlobalUtils.default.typeCheck(a.bbmax,"vector3any")&&(d.bbmax=module$src$shared$util$GlobalUtils.default.toVector3(a.bbmax));var e=(d.bbmin&&d.bbmax?d.bbmin.distanceTo(d.bbmax):1)/1E4,f=[],g=[];b=[];if(Array.isArray(a.content))for(var l=$jscomp.makeIterator(a.content),k=l.next();!k.done;k=l.next()){k=k.value;if(!module$src$shared$util$GlobalUtils.default.typeCheck(k.format,"string"))return c("format of content item missing");
switch(k.format){case "material":if(!k.data)return c("data of material content item missing");k=module$src$shared$util$GlobalUtils.default.deepCopy(k.data,h);f.push(k);break;case "gltf":case "glb":case "obj":case "tag2d":case "tag3d":case "anchor":case "three":g.push(module$src$shared$util$GlobalUtils.default.deepCopy(k,h));break;default:b.push(module$src$shared$util$GlobalUtils.default.deepCopy(k))}}l=[];f=$jscomp.makeIterator(f);for(k=f.next();!k.done;k=f.next()){k=k.value;var m=new module$src$shared$materials$MaterialParser.default.MaterialParser(t);
l.push(m.fromJSONMaterialObject(k))}f=[];k={};g=$jscomp.makeIterator(g);for(m=g.next();!m.done;k={gj:k.gj,anchorArray:k.anchorArray},m=g.next()){k.gj=m.value;m=[];if(Array.isArray(k.gj.transformations))for(var n=$jscomp.makeIterator(k.gj.transformations),p=n.next();!p.done;p=n.next())if(p=p.value,p.isMatrix4)m.push(p.clone());else{var r=new module$src$externals$three.default.Matrix4;r.fromArray(p);m.push(r)}k.gj.hasOwnProperty("href")&&"gltf"===k.gj.format?f.push(module$src$shared$singletons$GLTFLoader.default.loadGeometry(k.gj.href,
m)):k.gj.hasOwnProperty("href")&&"glb"===k.gj.format?f.push(module$src$shared$singletons$GLBLoader.default.loadGeometry(k.gj.href,m,e,t)):"obj"===k.gj.format?k.gj.data&&k.gj.data.objUrl&&f.push(module$src$shared$singletons$OBJLoader.default.loadGeometry(k.gj.data.objUrl,k.gj.data.mtlUrl,k.gj.data.path,k.gj.data.texturePath,k.gj.data.side,m)):"three"===k.gj.format?k.gj.data&&k.gj.data.threeObject&&f.push(module$src$shared$singletons$THREELoader.default.loadGeometry(k.gj.data.threeObject,m)):"tag3d"===
k.gj.format&&k.gj.hasOwnProperty("data")&&Array.isArray(k.gj.data)?f.push(module$src$shared$singletons$Tag3DLoader.default.load3DTags(k.gj.data)):("tag2d"===k.gj.format||"anchor"===k.gj.format)&&k.gj.hasOwnProperty("data")&&Array.isArray(k.gj.data)&&(k.anchorArray=[],k.gj.data.forEach(function(a){return function(b,c){if(b.location){var d=b.location;d=void 0!==d.x?new module$src$externals$three.default.Vector3(d.x,d.y,d.z):new module$src$externals$three.default.Vector3(d.X,d.Y,d.Z);b.data&&!b.data.color&&
(b.data.color="black");a.anchorArray.push({path:"Anchor_"+c,type:"anchor",geometry:{position:d,viewports:b.viewports,format:"tag2d"===a.gj.format?a.gj.format:b.format,data:"tag2d"===a.gj.format?{color:b.color||"black",text:b.text}:b.data}})}}}(k)),f.push(Promise.resolve(k.anchorArray)))}e=Promise.all(f).then(function(a){a.forEach(function(a,b){a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next())c=c.value,c.path="content_"+b+"."+c.path});return a}).catch(function(a){return c("loading of geometry failed",
a)});l=Promise.all(l).catch(function(a){return c("loading of material failed",a)});b=Promise.resolve(b);return Promise.all([e,l,b]).then(function(b){if(0<b[0].length){d.geometry=[];for(var c=$jscomp.makeIterator(b[0]),e=c.next();!e.done;e=c.next()){e=$jscomp.makeIterator(e.value);for(var f=e.next();!f.done;f=e.next())d.geometry.push(f.value)}}0<b[1].length&&(d.material=b[1]);0<b[2].length&&(d.data=b[2]);d._json=a;return d})},z=function(a){for(var b in g)delete g[b][a],delete p[b+"."+a];delete l[a]};
d.initSubScene=function(a,c,d,e){var f=function(a,c){c instanceof Error?a=c:(a=Error(a),a.scope="SceneManager.initSubScene",a.data=c);h&&(c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,a,d),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,c));b.error(a.scope,a.message,a);return!1};if(!d||!d.id)return f("invalid token");var h=d.id;var k=d.serial?d.serial:Date.now();
"number"!==typeof k&&(k=parseInt(k),isNaN(k)&&(k=Date.now()));if(u.hasOwnProperty(c)&&u[c].serial>k||r.hasOwnProperty(c)&&r[c].serial>k)return a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT,"Subscene obsolete because of newer request",d),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,a),!1;if(l.hasOwnProperty(h))return f("attempt to register duplicate process "+
h);u[c]={serial:k,id:h};p[c+"."+h]=k;l[h]={initTime:Date.now(),creatorId:c,processId:h,totalOutputVersions:a,finishedOutputVersions:0,options:e};g[c]=g[c]||{};g[c][h]={creatorId:c,processId:h,subScene:new module$src$shared$scene$OutputVersion.default};return!0};d.addJSONOutputVersionToSubScene=function(a,c,e){var f=function(a,c){c instanceof Error?a=c:(a=Error(a),a.scope="SceneManager.addJSONOutputVersionToSubScene",a.data=c);g&&(c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,
a,e),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,c),z(g));b.error(a.scope,a.message,a);return Promise.reject(a)};if(!e||!e.id)return f("invalid token");var g=e.id;return A(a).then(function(a){return d.addOutputVersionToSubScene(a,c,e)},function(a){return f("conversion of output version failed",a)})};d.addOutputVersionToSubScene=function(a,c,d){var e=function(a,c,e){c instanceof Error?a=c:(a=e?{message:a}:Error(a),a.scope="SceneManager.addOutputVersionToSubScene",
a.data=c);f&&(c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,a,d),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,c),z(f));if(e)return b.warn(a.scope,a.message,a),Promise.resolve(!1);b.error(a.scope,a.message,a);return Promise.reject(a)};if(!a.id)return e("output version without id");if(!d||!d.id)return e("invalid token");var f=d.id;if(!l[f])return e("unknown process id "+
f+", probably process was superseded",void 0,!0);var h=l[f];if(h.creatorId!==c)return e("unexpected creatorId");if(!g[c]||!g[c][f])return e("no partial subscene for creatorId/processId, probably process was superseded",void 0,!0);var k=u[c];return k?b.getSettingShallow("ignoreSuperseded")&&k.id!==f?(z(f),a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT,"Subscene obsolete because of newer request",d),b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,
a),Promise.resolve(!1)):w(d,a).then(function(a){if(!1===a){var c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT,"Subscene superseded, not published",d);z(d.id)}else!0===a?c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{state:module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_OUTPUTVERSION,
progress:.25+h.finishedOutputVersions/h.totalOutputVersions*.5},d):(c=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS,"Subscene published",d),c.addPart(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_UPDATE,a),z(d.id));b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,c);return a},function(a){return e("adding output version failed",a)}):
e("could not find latest serial for creator id "+c+", probably process was superseded",void 0,!0)};d.numberOfPartialSubScenes=function(){return Object.keys(g).length};d.numberOfCompleteSubScenes=function(){return Object.keys(k).length};d.getModelData=function(a){var b=[];a=a||{};var c=a.creatorId?[a.creatorId]:Object.keys(m);c=$jscomp.makeIterator(c);for(var d=c.next();!d.done;d=c.next())if(d=d.value,m.hasOwnProperty(d)){var e=Object.keys(m[d]);e=$jscomp.makeIterator(e);for(var f=e.next();!f.done;f=
e.next())if(f=f.value,null==a.id||f==a.id)for(var g=$jscomp.makeIterator(m[d][f]),h=g.next();!h.done;h=g.next())if(h=h.value,null==a.name||h.name==a.name)h=module$src$shared$util$GlobalUtils.default.deepCopy(h),delete h.format,h.plugin=d,h.id=f,b.push(h)}return b};d.getGeometryNames=function(a){var b={};(null==a?Object.keys(e):[a]).forEach(function(a){if(e.hasOwnProperty(a)&&e[a].hasOwnProperty("_subSceneObject")){b[a]={};for(var c=$jscomp.makeIterator(e[a]._subSceneObject.outputNames),d=c.next();!d.done;d=
c.next()){d=d.value;b[a][d]=[];var f=e[a]._subSceneObject.getOutputVersionIdByName(d);f=$jscomp.makeIterator(f);for(var g=f.next();!g.done;g=f.next()){g=g.value;var h=e[a]._subSceneObject.getOutputVersion(g);h&&h.hasOwnProperty("geometry")&&b[a][d].push(g)}}}});return b};d.getGeometryPathsByName=function(a,b){var c=[];(null==b?Object.keys(e):[b]).forEach(function(b){if(e.hasOwnProperty(b)&&e[b].hasOwnProperty("_subSceneObject")){var d=e[b]._subSceneObject.getOutputVersionIdByName(a);d=$jscomp.makeIterator(d);
for(var f=d.next();!f.done;f=d.next()){f=f.value;var g=e[b]._subSceneObject.getOutputVersion(f);g&&g.hasOwnProperty("geometry")&&c.push(b+"."+f)}}});return c};d.getJSONOutputVersion=function(a,b,c){if(!e.hasOwnProperty(b))return null;var d=e[b]._subSceneObject.getOutputVersion(a);if(!d)return null;var f="_json";if(!d.hasOwnProperty(f))return null;c&&d.hasOwnProperty("_json_scene")&&(f="_json_scene");d=module$src$shared$util$GlobalUtils.default.deepCopy(d[f],h);d.scenePath=b+"."+a;if(!d.format){a=
null;if(Array.isArray(d.content))if(0===d.content.length)a="unknown";else{b=0;for(c=d.content.length;b<c;b++)if(f=d.content[b],f.format)if(!a)a=f.format;else if(a!==f.format){a=null;break}a||(a="mixed")}a&&(d.format=a)}return d};d.getOutputIds=function(a){return e.hasOwnProperty(a)?e[a]._subSceneObject.outputIds:[]};d.removeOutputIds=function(a,b){Array.isArray(b)||(b=[b]);var d=Promise.resolve();if(e[a]){var f=e[a],g={};b=$jscomp.makeIterator(b);for(var h=b.next();!h.done;g={id:g.id},h=b.next())g.id=
h.value,f[g.id]&&(f._subSceneObject.removeOutputVersion(g.id),delete f[g.id],d=d.then(function(b){return function(){return c.removeGeometry(a+"."+b.id)}}(g)))}return d};d.setPersistentAttributes=function(a,c,g){var k;var l=function(a,b){return v("SceneManager.setPersistentAttributes",a,b)};f[c]=f[c]||{};f[c][a]=f[c][a]||{};f[c][a].json=f[c][a].json||{};var m=-1;g.hasOwnProperty("duration")&&(m=g.duration,delete g.duration);var n=module$src$shared$util$GlobalUtils.default.deepCopy(f[c][a].json,h);
g=module$src$shared$util$GlobalUtils.default.deepCopy(g,h);for(k in g)null===g[k]?delete n[k]:n[k]=g[k];n.id=a;return A(n,!0).then(function(g){f[c][a].json=n;f[c][a].ov=g;if(!e.hasOwnProperty(c))return n;g=e[c]._subSceneObject.getOutputVersion(a);if(!g)return n;var h={id:module$src$shared$util$GlobalUtils.default.createRandomId(),serial:Date.now()};var k=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{busy:!1,
progress:0,creator:"SceneManager.setPersistentAttributes"},h);b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,k);k={forceUpdate:a};0<=m&&(k.duration=m);return d.initSubScene(1,c,h,k)?d.addOutputVersionToSubScene(g,c,h).then(function(){return n}):l("ViewerApp.initSubScene failed")})};d.getPersistentAttributes=function(a,b){return f[b]&&f[b][a]?f[b][a].json:null};d.getCreatorIds=function(){return Object.keys(e)};return d};var module$src$app$handlers$ProcessStatusHandler={},GlobalUtils$$module$src$app$handlers$ProcessStatusHandler=module$src$shared$util$GlobalUtils.default,MessagePrototype$$module$src$app$handlers$ProcessStatusHandler=module$src$shared$messages$MessagePrototype.default,viewerAppConstants$$module$src$app$handlers$ProcessStatusHandler=module$src$app$ViewerAppConstants.default;
module$src$app$handlers$ProcessStatusHandler.default=function(a){var b=this;if(a&&a.viewportManager)var c=a.viewportManager;var d={},e={busy:!1,progress:1,processes:module$src$shared$util$GlobalUtils.default.deepCopy(d)},f={getSummary:function(){return module$src$shared$util$GlobalUtils.default.deepCopy(e)},updateViewerStatus:function(){var a=e.busy,f={busy:!1,progress:1,processes:module$src$shared$util$GlobalUtils.default.deepCopy(d)};for(l in d){var k=d[l];k.busy&&(f.busy=!0);void 0!==k.progress&&
"number"===typeof k.progress&&k.progress<f.progress&&0<=k.progress&&(f.progress=k.progress)}e=module$src$shared$util$GlobalUtils.default.deepCopy(f);if(e.busy){var l=new module$src$shared$messages$MessagePrototype.default(module$src$app$ViewerAppConstants.default.messageDataTypes.APP_STATUS,f);b.message(module$src$app$ViewerAppConstants.default.messageTopics.STATUS_BUSY,l);a||(b.debug("ProcessStatusHandler.updateViewerStatus","Entering busy mode, progress "+100*e.progress+"%",f),c&&b.getSettingShallow("blurSceneWhenBusy")&&
c.threeDManager.renderingHandler.setBlur(e.busy,100))}else!e.busy&&a?(b.debug("ProcessStatusHandler.updateViewerStatus","Entering idle mode",f),a=new module$src$shared$messages$MessagePrototype.default(module$src$app$ViewerAppConstants.default.messageDataTypes.APP_STATUS,f),b.message(module$src$app$ViewerAppConstants.default.messageTopics.STATUS_IDLE,a),c&&b.getSettingShallow("blurSceneWhenBusy")&&c.threeDManager.renderingHandler.setBlur(e.busy,100)):e.busy&&b.debug("ProcessStatusHandler.updateViewerStatus",
"Updating busy mode",f)},updateProcessStatus:function(a,c){var e=a;e&&"object"===typeof e&&module$src$shared$util$GlobalUtils.default.typeCheck(a.id,"string")&&(e=a.id);if(!module$src$shared$util$GlobalUtils.default.typeCheck(e,"string"))return!1;c=c||{};if(d.hasOwnProperty(e))module$src$shared$util$GlobalUtils.default.inject(c,d[e],!0);else if(0===c.progress)d[e]={initTime:Date.now()},module$src$shared$util$GlobalUtils.default.inject(c,d[e],!0);else return b.debug("ProcessStatusHandler.updateProcessStatus",
"Ignoring status message for unknown process "+e,c),!1;f.updateViewerStatus();return!0},forkProcessStatus:function(a,b){var c=a;c&&"object"===typeof c&&module$src$shared$util$GlobalUtils.default.typeCheck(a.id,"string")&&(c=a.id);if(!(module$src$shared$util$GlobalUtils.default.typeCheck(c,"string")&&d.hasOwnProperty(c)&&Array.isArray(b)&&b.every(function(a){return a.startsWith(c+".")})))return!1;var e=d[c];b.forEach(function(a){d[a]=module$src$shared$util$GlobalUtils.default.deepCopy(e)});delete d[c];
return!0},unregisterProcess:function(a){var c=a;c&&"object"===typeof c&&module$src$shared$util$GlobalUtils.default.typeCheck(a.id,"string")&&(c=a.id);if(!module$src$shared$util$GlobalUtils.default.typeCheck(c,"string"))return!1;if(!d.hasOwnProperty(c))return b.debug("ProcessStatusHandler.unregisterProcess","Unregistering unknown process "+c),!1;delete d[c];f.updateViewerStatus();return!0}};return f};var module$src$ar$ArApiInterface={default:function(){}};module$src$ar$ArApiInterface.default.prototype.hitTest=function(){};module$src$ar$ArApiInterface.default.prototype.registerAnchor=function(){};module$src$ar$ArApiInterface.default.prototype.removeAnchor=function(){};module$src$ar$ArApiInterface.default.prototype.pauseSession=function(){};module$src$ar$ArApiInterface.default.prototype.runSession=function(){};module$src$ar$ArApiInterface.default.prototype.getStatus=function(){};
module$src$ar$ArApiInterface.default.prototype.addEventListener=function(){};module$src$ar$ArApiInterface.default.prototype.removeEventListener=function(){};module$src$ar$ArApiInterface.default.prototype.getPlacementAnchor=function(){};module$src$ar$ArApiInterface.default.prototype.resetPlacementAnchor=function(){};module$src$ar$ArApiInterface.default.prototype.setPlacementAnchor=function(){};
module$src$ar$ArApiInterface.default.prototype.EVENTTYPE={ANCHOR_CREATE_IMAGE:"anchor.create.image",ANCHOR_UPDATE:"anchor.update",OBJECT_PLACEMENT:"object.placement",STATUS_TRACKING:"status.tracking",STATUS_MAPPING:"status.mapping"};var module$src$ar$diagnostics$ArStatusType={default:function(a,b,c,d,e){this.framework=a;this.anchors=b;this.tracking=c;this.trackingReason=d;this.worldMapping=e}};var module$src$ar$ArSettingsHooks={},GLOBAL_UTILS$$module$src$ar$ArSettingsHooks=module$src$shared$util$GlobalUtils.default;
module$src$ar$ArSettingsHooks.default=function(a){var b=this;this._settings=a.settings;this._loggingHandler=a.loggingHandler;this._viewportManager=a.viewportManager;this._container=a.container;this.getDefaultHitTestTypeVal=this.getEnableAutomaticPlacementVal=this.getEnableTouchControlRotationVal=this.getEnableTouchControlsVal=this.getEnableLightingEstimationVal=this.getEnableCameraSyncVal=this.onSettingChange=null;a=this._settings.getSettings();var c=function(a,c){var d=b[a](c);if(b.onSettingChange&&
d)b.onSettingChange(a,c);return d};this.enableCameraSync(a.enableCameraSync);this._settings.registerHook("enableCameraSync",function(a){return c("enableCameraSync",a)});this.enableLightingEstimation(a.enableLightingEstimation);this._settings.registerHook("enableLightingEstimation",function(a){return c("enableLightingEstimation",a)});this.enableTouchControls(a.enableTouchControls);this._settings.registerHook("enableTouchControls",function(a){return c("enableTouchControls",a)});this.enableTouchControlRotation(a.enableTouchControlRotation);
this._settings.registerHook("enableTouchControlRotation",function(a){return c("enableTouchControlRotation",a)});this.enableAutomaticPlacement(a.enableAutomaticPlacement);this._settings.registerHook("enableAutomaticPlacement",function(a){return c("enableAutomaticPlacement",a)});this.defaultHitTestType(a.defaultHitTestType);this._settings.registerHook("defaultHitTestType",function(a){return c("defaultHitTestType",a)})};
module$src$ar$ArSettingsHooks.default.prototype.enableCameraSync=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",this._loggingHandler.warn,"ArHandler.Hook->enableCameraSync"))return!1;this.getEnableCameraSyncVal=a;return!0};
module$src$ar$ArSettingsHooks.default.prototype.enableLightingEstimation=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",this._loggingHandler.warn,"ArHandler.Hook->enableLightingEstimation"))return!1;this.getEnableLightingEstimationVal=a;return!0};
module$src$ar$ArSettingsHooks.default.prototype.enableTouchControls=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",this._loggingHandler.warn,"ArHandler.Hook->enableTouchControls"))return!1;this.getEnableTouchControlsVal=a;return!0};
module$src$ar$ArSettingsHooks.default.prototype.enableTouchControlRotation=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",this._loggingHandler.warn,"ArHandler.Hook->enableTouchControlRotation"))return!1;this.getEnableTouchControlRotationVal=a;return!0};
module$src$ar$ArSettingsHooks.default.prototype.enableAutomaticPlacement=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"boolean",this._loggingHandler.warn,"ArHandler.Hook->enableAutomaticPlacement"))return!1;this.getEnableAutomaticPlacementVal=a;return!0};
module$src$ar$ArSettingsHooks.default.prototype.defaultHitTestType=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string",this._loggingHandler.warn,"ArHandler.Hook->defaultHitTestType"))return!1;this.getDefaultHitTestTypeVal=a;return!0};var module$src$ar$ArEvent={default:function(a,b,c){this.type=a;this.api=b;c&&(c.image&&(this.image=c.image),c.anchors&&(this.anchors=c.anchors),c.tracking&&(this.tracking=c.tracking),c.trackingReason&&(this.trackingReason=c.trackingReason),c.worldMapping&&(this.worldMapping=c.worldMapping),c.runtimeId&&(this.runtimeId=c.runtimeId),c.anchorId&&(this.anchorId=c.anchorId))}};var module$src$ar$utils$ArApi_utils={default:{}};
module$src$ar$utils$ArApi_utils.default.temp2rgb=function(a){var b=a/100;var c=[];6504>=a?(c[0]=255,c[1]=b,c[1]=99.4708025861*Math.log(c[1])-161.1195681661):(c[0]=b-60,c[0]=329.698727446*Math.pow(c[0],-.1332047592),0>c[0]&&(c[0]=0),255<c[0]&&(c[0]=255),c[1]=b-60,c[1]=288.1221695283*Math.pow(c[1],-.0755148492));0>c[1]&&(c[1]=0);255<c[1]&&(c[1]=255);6504<=a?c[2]=255:19>=b?c[2]=0:(c[2]=b-10,c[2]=138.5177312231*Math.log(c[2])-305.0447927307,0>c[2]&&(c[2]=0),255<c[2]&&(c[2]=255));return c};var module$src$ar$ArApiARKit={},THREE$$module$src$ar$ArApiARKit=module$src$externals$three.default,GLOBAL_UTILS$$module$src$ar$ArApiARKit=module$src$shared$util$GlobalUtils.default,COMMPLUGIN_ID$$module$src$ar$ArApiARKit="CommPlugin_1",ArApiFactory$$module$src$ar$ArApiARKit=function(a){var b=new module$src$ar$ArApiInterface.default,c={events:[],listen:function(a,b,c){this.events[a]||(this.events[a]=[]);this.events[a].push({token:b,cb:c})},raise:function(a,b){this.events[a]&&this.events[a].forEach(function(a){a.cb(b)})},
remove:function(a){var b=a.split(":");a=b[0];b=b[1];if(this.events[a])for(var c=0;c<this.events[a].length;c++)if(this.events[a][c].token==b){this.events[a].splice(c,1);break}}},d=a.viewportManager,e=Array.isArray(a.container)&&0<a.container.length?a.container[0]:a.container,f=a.apiResponse,h=a.sceneGeometryManager,g={},k=null,l=new module$src$externals$three.default.Matrix4,m=new module$src$externals$three.default.Matrix4,n=null,r=new module$src$ar$ArSettingsHooks.default({viewportManager:a.viewportManager,
loggingHandler:a.loggingHandler,settings:a.settings}),u=function(){return function(){n||(n=d.getApis()[0]);return n}}(),p=function(){var a;return function(){a||(a=u().camera);return a}}();a={};var q=new module$src$externals$three.default.Matrix4,t=new module$src$externals$three.default.Matrix4,v={};q.makeRotationAxis(new module$src$externals$three.default.Vector3(1,0,0),-.5*Math.PI);t.getInverse(q);window.SDVARKitBridge=a;var w=function(a){return a.includes("'")||a.includes('"')?JSON.parse(a):a.replace(/["'\[\]]/g,
"").split(",").map(function(a){return parseFloat(a)})};a.viewProjectionMatrixUpdate=function(a,d,e,f,h){if(g.worldMappingStatus!==e){var k=new module$src$ar$ArEvent.default(b.EVENTTYPE.STATUS_MAPPING,{},{worldMapping:e,tracking:f,trackingReason:h});c.raise(b.EVENTTYPE.STATUS_MAPPING,k)}g.trackingStatus!==f&&(k=new module$src$ar$ArEvent.default(b.EVENTTYPE.STATUS_TRACKING,{},{worldMapping:e,tracking:f,trackingReason:h}),c.raise(b.EVENTTYPE.STATUS_TRACKING,k));g.worldMappingStatus=e;g.trackingStatus=
f;g.trackingStatusReason=h;"string"===typeof a&&(a=w(a));"string"===typeof d&&(d=w(d));l.identity();m.identity();l.fromArray(a);l.multiply(q);m.fromArray(d);r.getEnableCameraSyncVal&&p().updateMatrices(l,m);r.getEnableCameraSyncVal&&r.getEnableTouchControlsVal&&W()};a.lightingEstimateUpdate=function(){};var x=function(a){var b=new module$src$externals$three.default.Matrix4,c=a.plane;b.fromArray(a.transform);b.multiply(q);b.premultiply(t);a.transform=b;c&&(a=new module$src$externals$three.default.Vector3,
b=new module$src$externals$three.default.Vector3,a.fromArray(c.center),a.applyMatrix4(t),c.center=a,b.fromArray(c.extent),b.applyMatrix4(t),c.extent=b)};a.anchorTransformUpdate=function(a,b){k="string"===typeof a?JSON.parse(a):a;Object.keys(k).forEach(function(a){x(k[a])});A(k,b)};a.imageAnchorCreated=function(a){a="string"===typeof a?JSON.parse(a):a;x(a);a=new module$src$ar$ArEvent.default(b.EVENTTYPE.ANCHOR_CREATE_IMAGE,{},{image:a});c.raise(b.EVENTTYPE.ANCHOR_CREATE_IMAGE,a)};a.hitTestResponse=
function(a,b){var c=v[a];c&&(delete v[a],b?(a="string"===typeof b?JSON.parse(b):b,a.forEach(function(a){var b=new module$src$externals$three.default.Matrix4,c=new module$src$externals$three.default.Matrix4,d=a.anchor;b.fromArray(a.worldTransform);b.multiply(q);b.premultiply(t);a.worldTransform=b;c.fromArray(a.localTransform);c.multiply(q);c.premultiply(t);a.localTransform=c;d&&x(d)}),c.resolve(a)):c.resolve([]))};a.registerAnchorResponse=function(a,b){var c=v[a];c&&(delete v[a],c.resolve(b))};a.removeAnchorResponse=
function(a,b){var c=v[a];c&&(delete v[a],c.resolve(b))};a.pauseSessionResponse=function(a){var b=v[a];b&&(delete v[a],b.resolve())};a.runSessionResponse=function(a){var b=v[a];b&&(delete v[a],b.resolve())};var y=new module$src$ar$ArEvent.default(b.EVENTTYPE.ANCHOR_UPDATE,{}),A=function(a){if(r.getEnableCameraSyncVal){var d=M?M:"";d&&a[d]&&""===H&&h.setPluginTransformation(COMMPLUGIN_ID$$module$src$ar$ArApiARKit,[null,null,a[d].transform],!0)}y.anchors=a;c.raise(b.EVENTTYPE.ANCHOR_UPDATE,y)},z=0;var B=
window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.runSession?"arkit":"none";var D=function(a,b){return new Promise(function(c,d){if(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers[a]){var e="id"+z++;b=b||{};b.requestId=e;v[e]={resolve:c,reject:d};window.webkit.messageHandlers[a].postMessage(b)}else d("Handler "+a+" does not exist")})},G=function(a,b,c){if(0>a||1<a||0>b||1<b)return Promise.reject("Expects normalized screen coordinates");"string"===
typeof c?c=[c]:Array.isArray(c)||(c=[]);return D("hitTest",{screenX:a+"",screenY:b+"",types:c.join(";")})},F=function(a,b){if(!a||!a.isMatrix4)return Promise.reject("Provide a THREE.Matrix4");"string"!==typeof b&&(b="");var c=new module$src$externals$three.default.Matrix4;c.copy(a);c.multiply(t);c.premultiply(q);return D("registerAnchor",{transform:JSON.stringify(c.toArray(),null,0),name:b})},E=function(a){return"string"!==typeof a?Promise.reject("Anchor uuid must be a string"):a?D("removeAnchor",
{uuid:a}):Promise.resolve(!1)},I=0,C=0,L=0,H="",K=[],S=new module$src$externals$three.default.Matrix4,J=new module$src$externals$three.default.Matrix4,M="",O,N,R,P={},W=function(){""!==H&&X(K[0],K[1]).then(function(a){a&&(O=a)})},V=function(a,d){a=a||"";d=d||COMMPLUGIN_ID$$module$src$ar$ArApiARKit;var e=M?M:"";M=a;a=new module$src$ar$ArEvent.default(b.EVENTTYPE.OBJECT_PLACEMENT,{},{runtimeId:d,anchorId:a});c.raise(b.EVENTTYPE.OBJECT_PLACEMENT,a);r.getEnableCameraSyncVal&&h.toggleGeometry([COMMPLUGIN_ID$$module$src$ar$ArApiARKit],
[]);return e},U=function(a,b){b=b||COMMPLUGIN_ID$$module$src$ar$ArApiARKit;return F(a).then(function(a){var c=V(a,b);c&&E(c);return a})},Q=function(a){a=a||COMMPLUGIN_ID$$module$src$ar$ArApiARKit;if(!P[a]&&r.getEnableCameraSyncVal&&r.getEnableAutomaticPlacementVal&&(!M||!M)){P[a]=!0;var b=function(){P[a]=setTimeout(function(){P[a]=!1;Q(a)},250)};if(""!==H)b();else return X(.5,.5).then(function(c){if(c)return U(c.worldTransform).then(function(){P[a]=!1});b()})}},X=function(a,b,c,d){c=c||r.getDefaultHitTestTypeVal;
d=d||COMMPLUGIN_ID$$module$src$ar$ArApiARKit;return G(a,b,c).then(function(a){if(Array.isArray(a)&&0<a.length)return a=a[0],h.setPluginTransformation(d,[null,null,a.worldTransform],!0),a})},T=function(a){if(2>a.length)return[0,0];for(var b=[],c=0,d=a.length;c<d;c++)b.push(a.item(c));b.sort(function(a,b){return a.identifier<b.identifier});return new module$src$externals$three.default.Vector2(b[1].screenX-b[0].screenX,b[1].screenY-b[0].screenY)},ba=function(a){a.preventDefault();if(2===a.touches.length)I=
T(a.touches).angle();else if(!(1<a.touches.length)){a=a.changedTouches.item(0);var b=a.screenX/window.innerWidth,c=a.screenY/window.innerHeight;H=a.identifier;K=[b,c];X(b,c).then(function(a){a&&(O=a)})}},Z=function(a){a.preventDefault();var b=a.changedTouches;a=a.touches;2===a.length&&(a=T(a),C=I-a.angle()+L,S.makeRotationZ(C),r.getEnableTouchControlRotationVal&&h.setPluginTransformation(COMMPLUGIN_ID$$module$src$ar$ArApiARKit,[null,S],!0));a=0;for(var c=b.length;a<c;a++)if(b.item(a).identifier===
H){a=b.item(a);b=a.screenX/window.innerWidth;a=a.screenY/window.innerHeight;K=[b,a];X(b,a).then(function(a){a&&(O=a)});break}},Y=function(a){a.preventDefault();a=a.changedTouches;L=C;for(var b=!1,c=0,e=a.length;c<e;c++)if(a.item(c).identifier===H){b=!0;break}b?(d.threeDManager.adjustScene(),U(O.worldTransform).then(function(){H=""})):b&&(H="")};if(e){var aa=!1;r.onSettingChange=function(a,b){"enableCameraSync"===a?b?(N&&R&&h.setPluginTransformation(COMMPLUGIN_ID$$module$src$ar$ArApiARKit,[null,N,
R]),d.threeDManager.renderingHandler.registerForContinuousRendering("AR"),b&&u().updateSettingAsync("camera.enableCameraControls",!b),M&&M||(h.toggleGeometry([],[COMMPLUGIN_ID$$module$src$ar$ArApiARKit]),r.getEnableAutomaticPlacementVal&&Q(COMMPLUGIN_ID$$module$src$ar$ArApiARKit))):(a=h.getPluginTransformation(COMMPLUGIN_ID$$module$src$ar$ArApiARKit),Array.isArray(a)&&3<=a.length&&(N=a[1],R=a[2]),h.setPluginTransformation(COMMPLUGIN_ID$$module$src$ar$ArApiARKit,[null,J,J]),d.threeDManager.renderingHandler.unregisterForContinuousRendering("AR"),
M&&M||h.toggleGeometry([COMMPLUGIN_ID$$module$src$ar$ArApiARKit],[])):"enableAutomaticPlacement"===a&&b&&Q(COMMPLUGIN_ID$$module$src$ar$ArApiARKit);r.getEnableCameraSyncVal&&r.getEnableTouchControlsVal&&!aa?(e.addEventListener("touchstart",ba,!1),e.addEventListener("touchmove",Z,!1),e.addEventListener("touchend",Y,!1),e.addEventListener("touchcancel",Y,!1),aa=!0):(e.removeEventListener("touchstart",ba,!1),e.removeEventListener("touchmove",Z,!1),e.removeEventListener("touchend",Y,!1),e.removeEventListener("touchcancel",
Y,!1),H="",aa=!1)};setTimeout(function(){if(u())r.onSettingChange("enableCameraSync",r.getEnableCameraSyncVal)},0)}a=function(){module$src$ar$ArApiInterface.default.call(this)};$jscomp.inherits(a,module$src$ar$ArApiInterface.default);a.prototype.hitTest=function(a,b,c){return G(a,b,c)};a.prototype.registerAnchor=function(a,b){return F(a,b)};a.prototype.removeAnchor=function(a){return E(a)};a.prototype.pauseSession=function(){return D("pauseSession")};a.prototype.runSession=function(a,b){"string"===
typeof a?a=[a]:Array.isArray(a)||(a=[]);"string"===typeof b?b=[b]:Array.isArray(b)||(b=[]);return D("runSession",{planeDetection:a.join(";"),options:b.join(";")})};a.prototype.getStatus=function(){return f(null,new module$src$ar$diagnostics$ArStatusType.default(B,k,g.trackingStatus,g.trackingStatusReason,g.worldMappingStatus))};a.prototype.addEventListener=function(a,d){if(!Object.keys(b.EVENTTYPE).find(function(c){return b.EVENTTYPE[c]===a}))return f("Unsupported event type");var e=module$src$shared$util$GlobalUtils.default.createRandomId();
c.listen(a,e,d);return f(null,{token:a+":"+e})};a.prototype.removeEventListener=function(a){return f(null,c.remove(a))};a.prototype.getPlacementAnchor=function(a){return f(null,M?M:"")};a.prototype.resetPlacementAnchor=function(a){var d=a||COMMPLUGIN_ID$$module$src$ar$ArApiARKit;a=M?M:"";M="";d=new module$src$ar$ArEvent.default(b.EVENTTYPE.OBJECT_PLACEMENT,{},{runtimeId:d,anchorId:""});c.raise(b.EVENTTYPE.OBJECT_PLACEMENT,d);r.getEnableCameraSyncVal&&(h.toggleGeometry([],[COMMPLUGIN_ID$$module$src$ar$ArApiARKit]),
r.getEnableAutomaticPlacementVal&&Q(COMMPLUGIN_ID$$module$src$ar$ArApiARKit));return f(null,a)};a.prototype.setPlacementAnchor=function(a,b){return f(null,V(a,b))};return new a},_ArApiInstance$$module$src$ar$ArApiARKit;module$src$ar$ArApiARKit.default=function(a){_ArApiInstance$$module$src$ar$ArApiARKit||(_ArApiInstance$$module$src$ar$ArApiARKit=ArApiFactory$$module$src$ar$ArApiARKit(a));return _ArApiInstance$$module$src$ar$ArApiARKit};var module$src$api$v2$interface$ApiParameterInterfaceV2_1={default:function(){this.EVENTTYPE={REGISTERED:"registered",UPDATE:"update",VALUE_UPDATE:"value.update"};this.RESULT={PARAM_NOT_FOUND:"param_not_found",NO_VALUE:"no_value",VALUE_REJECT:"value_reject",VALUE_EXISTS:"value_exists",VALUE_OK:"value_ok",PLUGIN_NOT_FOUND:"plugin_not_found",ERROR:"error",LIVE:"live",CACHE:"cache",LOAD:"load",ABORT:"abort"};this.TYPE={FLOAT:"Float",INT:"Int",EVEN:"Even",ODD:"Odd",STRING:"String",COLOR:"Color",STRINGLIST:"StringList",
BOOL:"Bool",TIME:"Time",FILE:"File"};this.VISUALIZATION={SLIDER:"slider",SEQUENCE:"sequence",CYCLE:"cycle",DROPDOWN:"dropdown",CHECKLIST:"checklist",CLOCK:"clock",CALENDAR:"calendar"};this.get=function(){};this.updateAsync=function(){};this.canGoBackInHistory=function(){};this.canGoForwardInHistory=function(){};this.goBackInHistoryAsync=function(){};this.goForwardInHistoryAsync=function(){};this.updateProperties=function(){};this.addEventListener=function(){};this.removeEventListener=function(){}}};var module$src$api$v2$interface$ApiExportInterfaceV2_1={default:function(){this.RESULT={EXPORT_NOT_FOUND:"export_not_found",PLUGIN_NOT_FOUND:"plugin_not_found",ERROR:"error",CACHE:"cache",LOAD:"load"};this.EVENTTYPE={AVAILABLE:"available",REGISTERED:"registered",UPDATE:"update",STATUS:"status"};this.get=function(){};this.requestAsync=function(){};this.updateProperties=function(){};this.addEventListener=function(){};this.removeEventListener=function(){}}};var module$src$api$v2$interface$ApiPluginInterfaceV2_1={default:function(){this.STATUS={NONE:"none",READY:"ready",FAILED:"failed",LOADED:"loaded",ACTIVE:"active",UNLOADED:"unloaded"};this.get=function(){};this.registerPluginAsync=function(){};this.registerCommPluginAsync=function(){};this.refreshPluginAsync=function(){};this.saveDefaultParameterValuesAsync=function(){};this.deregisterPluginAsync=function(){}}};var module$src$api$v2$interface$ApiStateInterfaceV2_1={default:function(){this.EVENTTYPE={BUSY:"busy",IDLE:"idle",MESSAGE:"message",FAILED:"failed"};this.get=function(){};this.setBusy=function(){};this.addEventListener=function(){};this.removeEventListener=function(){}}};var module$src$api$v2$interface$ApiViewportsInterfaceV2_1={default:function(){this.EVENTTYPE={CREATED:"created",DESTROYED:"destroyed"};this.get=function(){};this.create=function(){};this.destroy=function(){}}};var module$src$api$v2$interface$ApiSceneInterfaceV2_1={default:function(){this.FORMAT={GLB:"glb",GLTF:"gltf",OBJ:"obj",THREE:"three",DATA:"data",MATERIAL:"material",TAG2D:"tag2d",TAG3D:"tag3d",ANCHOR:"anchor"};this.EVENTTYPE={ANCHOR_ADD:"anchor.add",ANCHOR_REMOVE:"anchor.remove",DRAG_START:"drag.start",DRAG_MOVE:"drag.move",DRAG_END:"drag.end",FRAMERATE:"framerate",HOVER_ON:"hover.on",HOVER_OVER:"hover.over",HOVER_OFF:"hover.off",RENDER_BEAUTY_START:"render.beauty.start",RENDER_BEAUTY_CANCEL:"render.beauty.cancel",
RENDER_BEAUTY_END:"render.beauty.end",SELECT_ON:"select.on",SELECT_OFF:"select.off",SUBSCENE_PUBLISHED:"subscene.published",VISIBILITY_ON:"visibility.on",VISIBILITY_OFF:"visibility.off"};this.MATERIALTYPE={STANDARD:"standard",GEM:"gem"};this.INTERACTIONMODETYPE={GLOBAL:"global",SUB:"sub"};this.SELECTIONMODETYPE={SINGLE:"single",MULTIPLE:"multiple"};this.TRANSFORMATIONTYPE={PLUGIN:"plugin",VIEWPORT:"viewport"};this.LIVETRANSFORMATIONTYPE={ROTATION:"rotation",TRANSLATION:"translation",SCALING:"scaling"};
this.updateAsync=function(){};this.get=function(){};this.getData=function(){};this.convertTo2D=function(){};this.getBoundingBox=function(){};this.setTransformation=function(){};this.getTransformation=function(){};this.applyTransformation=function(){};this.resetTransformation=function(){};this.setLiveTransformation=function(){};this.getScreenshot=function(){};this.getScreenshotAsync=function(){};this.updateSelected=function(){};this.getSelected=function(){};this.startExternalDragEvent=function(a,b){};
this.removeAsync=function(){};this.render=function(){};this.updateShadowMap=function(){};this.startContinuousRendering=function(){};this.stopContinuousRendering=function(){};this.pause=function(){};this.resume=function(){};this.updatePersistentAsync=function(){};this.getPersistent=function(){};this.updateInteractionGroups=function(){};this.getInteractionGroups=function(){};this.addEventListener=function(){};this.removeEventListener=function(){};this.toggleGeometry=function(){};this.getViewportRuntimeId=
function(){};this.getContainer=function(){}}};var module$src$api$v2$ApiInterfaceV2_1={},ARAPIINTERFACE$$module$src$api$v2$ApiInterfaceV2_1=module$src$ar$ArApiInterface.default,ApiParameterInterface$$module$src$api$v2$ApiInterfaceV2_1=module$src$api$v2$interface$ApiParameterInterfaceV2_1.default,ApiExportInterface$$module$src$api$v2$ApiInterfaceV2_1=module$src$api$v2$interface$ApiExportInterfaceV2_1.default,ApiPluginInterface$$module$src$api$v2$ApiInterfaceV2_1=module$src$api$v2$interface$ApiPluginInterfaceV2_1.default,ApiStateInterface$$module$src$api$v2$ApiInterfaceV2_1=
module$src$api$v2$interface$ApiStateInterfaceV2_1.default,ApiViewportsInterface$$module$src$api$v2$ApiInterfaceV2_1=module$src$api$v2$interface$ApiViewportsInterfaceV2_1.default,ApiSceneInterface$$module$src$api$v2$ApiInterfaceV2_1=module$src$api$v2$interface$ApiSceneInterfaceV2_1.default;
module$src$api$v2$ApiInterfaceV2_1.default=function(){this.EVENTTYPE={SETTINGS_UPDATE:"settings.update",SETTINGS_REGISTERED:"settings.registered"};this.state=new module$src$api$v2$interface$ApiStateInterfaceV2_1.default;this.parameters=new module$src$api$v2$interface$ApiParameterInterfaceV2_1.default;this.exports=new module$src$api$v2$interface$ApiExportInterfaceV2_1.default;this.plugins=new module$src$api$v2$interface$ApiPluginInterfaceV2_1.default;this.viewports=new module$src$api$v2$interface$ApiViewportsInterfaceV2_1.default;
this.scene=new module$src$api$v2$interface$ApiSceneInterfaceV2_1.default;this.ar=new module$src$ar$ArApiInterface.default;this.addEventListener=function(){};this.removeEventListener=function(){};this.getSettingDefinitions=function(){};this.getSettings=function(){};this.getSetting=function(){};this.updateSettingAsync=function(){};this.updateSettingsAsync=function(){};this.saveSettingsAsync=function(){};this.createAsynchronousFunctions=function(){};this.getRuntimeId=function(){}};
module$src$api$v2$ApiInterfaceV2_1.default.utils={};var module$src$api$v2$implementation$ApiExportImplementationV2_1={},messagingConstants$$module$src$api$v2$implementation$ApiExportImplementationV2_1=module$src$shared$constants$MessagingConstants.default,pluginConstantsGlobal$$module$src$api$v2$implementation$ApiExportImplementationV2_1=module$src$shared$constants$PluginConstantsGlobal.default,GlobalUtils$$module$src$api$v2$implementation$ApiExportImplementationV2_1=module$src$shared$util$GlobalUtils.default,ApiInterfaceV2$$module$src$api$v2$implementation$ApiExportImplementationV2_1=
new module$src$api$v2$ApiInterfaceV2_1.default,APIResponse$$module$src$api$v2$implementation$ApiExportImplementationV2_1=module$src$api$v2$ApiResponse.default;
module$src$api$v2$implementation$ApiExportImplementationV2_1.default=function(a,b){var c=this;this.RESULT=ApiInterfaceV2$$module$src$api$v2$implementation$ApiExportImplementationV2_1.exports.RESULT;this.EVENTTYPE=ApiInterfaceV2$$module$src$api$v2$implementation$ApiExportImplementationV2_1.exports.EVENTTYPE;var d=b.exportHandler;this.get=function(){return(0,module$src$api$v2$ApiResponse.default)(null,d.getExportDefinitions())};var e=function(a){return!a||"object"!==typeof a||!module$src$shared$util$GlobalUtils.default.typeCheck(a.id,
"string")&&!module$src$shared$util$GlobalUtils.default.typeCheck(a.idOrName,"string")&&!module$src$shared$util$GlobalUtils.default.typeCheck(a.name,"string")||a.plugin&&"string"!==typeof a.plugin?!1:!0};this.requestAsync=function(b,c){if(!e(b))return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Invalid input, expecting an ExportRequestObject.",null,c));var f=d.getUniqueExportByRequestObject(b);if(void 0===f)return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Invalid input, ExportRequestObject did not match a unique export definition.",
null,c));var h=module$src$shared$constants$MessagingConstants.default.makeMessageToken();h.payload=c;b.silent&&(h.attributes={silent:!0});return new Promise(function(b){var e=a.setProcessCallback(h.id,function(d,g){if(g.hasOwnProperty("parts"))for(d=$jscomp.makeIterator(g.parts),g=d.next();!g.done;g=d.next()){g=g.value;if(g.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_RESULT){module$src$shared$util$GlobalUtils.default.defaults(f,g.data,!0);a.clearProcessCallback(e);
b((0,module$src$api$v2$ApiResponse.default)(null,f,c));break}if(g.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT){a.clearProcessCallback(e);b((0,module$src$api$v2$ApiResponse.default)(g.data,null,c));break}if(g.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR){a.clearProcessCallback(e);b((0,module$src$api$v2$ApiResponse.default)(g.data,null,c));break}}}),g=d.requestExport(f,h);f.resultcode=g;g!==module$src$shared$constants$PluginConstantsGlobal.default.requestExportResults.CACHE&&
g!==module$src$shared$constants$PluginConstantsGlobal.default.requestExportResults.LOAD&&(a.error("ApiImplementationV2.ExportApi.requestAsync","_exportHandler.requestExport returned error",g),a.clearProcessCallback(e),b((0,module$src$api$v2$ApiResponse.default)({m:"Failed to request export",d:g},f,c)))})};this.updateProperties=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,d.updateMultipleExports(a))};this.addEventListener=function(b,d){if(!Object.keys(c.EVENTTYPE).find(function(a){return c.EVENTTYPE[a]===
b}))return(0,module$src$api$v2$ApiResponse.default)("Unsupported event type");var e=a.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT+"."+b,function(a,c){a=new CustomEvent(b);a.api=c.api;c.token&&(a.token=c.token);a.export={};var e={};e[module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_DEFINITION]=null;e[module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_RESULT]=null;e[module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_STATUS]=
null;for(var f in e){var g=c.getUniquePartByType(f);if(g){g.data&&(g=g.data);var h=e[f]?e[f]:g,k;for(k in h)a.export[k]=g[k]}}d(a)});return(0,module$src$api$v2$ApiResponse.default)(null,e)};this.removeEventListener=function(b){return(0,module$src$api$v2$ApiResponse.default)(null,a.unsubscribeFromMessageStream(b))}};var module$src$api$v2$implementation$ApiParameterImplementationV2_1={},messagingConstants$$module$src$api$v2$implementation$ApiParameterImplementationV2_1=module$src$shared$constants$MessagingConstants.default,GlobalUtils$$module$src$api$v2$implementation$ApiParameterImplementationV2_1=module$src$shared$util$GlobalUtils.default,ApiInterfaceV2$$module$src$api$v2$implementation$ApiParameterImplementationV2_1=new module$src$api$v2$ApiInterfaceV2_1.default,APIResponse$$module$src$api$v2$implementation$ApiParameterImplementationV2_1=
module$src$api$v2$ApiResponse.default;
module$src$api$v2$implementation$ApiParameterImplementationV2_1.default=function(a,b){var c=this;this.RESULT=ApiInterfaceV2$$module$src$api$v2$implementation$ApiParameterImplementationV2_1.parameters.RESULT;this.TYPE=ApiInterfaceV2$$module$src$api$v2$implementation$ApiParameterImplementationV2_1.parameters.TYPE;this.VISUALIZATION=ApiInterfaceV2$$module$src$api$v2$implementation$ApiParameterImplementationV2_1.parameters.VISUALIZATION;this.EVENTTYPE=ApiInterfaceV2$$module$src$api$v2$implementation$ApiParameterImplementationV2_1.parameters.EVENTTYPE;var d=
b.parameterHandler;this.get=function(a){return(a=d.getParameterDefinitionsAndValues(a))?(0,module$src$api$v2$ApiResponse.default)(null,a):(0,module$src$api$v2$ApiResponse.default)("Failed to get parameter definitions")};var e=function(a){return!a||"object"!==typeof a||!module$src$shared$util$GlobalUtils.default.typeCheck(a.id,"string")&&!module$src$shared$util$GlobalUtils.default.typeCheck(a.idOrName,"string")&&!module$src$shared$util$GlobalUtils.default.typeCheck(a.name,"string")||a.plugin&&!module$src$shared$util$GlobalUtils.default.typeCheck(a.plugin,
"string")||void 0===a.value?!1:!0};this.updateAsync=function(b,c){Array.isArray(b)||(b=[b]);for(var f=$jscomp.makeIterator(b),h=f.next();!h.done;h=f.next())if(!e(h.value))return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Invalid input, expecting array of ParameterUpdateObject.",null,c));var l=module$src$shared$util$GlobalUtils.default.deepCopy(b);f=0;for(h=b.length;f<h;f++)b[f].value instanceof Blob&&(l[f].value=b[f].value);var m=module$src$shared$constants$MessagingConstants.default.makeMessageToken();
m.payload=c;return new Promise(function(b){var e=function(){var e=a.setProcessCallback(m.id,function(d,f){if(f.hasOwnProperty("parts"))for(d=$jscomp.makeIterator(f.parts),f=d.next();!f.done;f=d.next()){f=f.value;if(f.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS){a.clearProcessCallback(e);b((0,module$src$api$v2$ApiResponse.default)(null,l,c));break}if(f.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT){a.clearProcessCallback(e);
b((0,module$src$api$v2$ApiResponse.default)(f.data,null,c));break}if(f.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR){a.clearProcessCallback(e);b((0,module$src$api$v2$ApiResponse.default)(f.data,null,c));break}}}),f=d.setMultipleParameterValues(l,m);if(f.err)a.error("ApiImplementationV2.ParameterApi.updateAsync","_parameterHandler.setMultipleParameterValues returned error",f),a.clearProcessCallback(e),b((0,module$src$api$v2$ApiResponse.default)({m:"Failed to set parameter values",
d:f},null,c));else{f.warn&&a.warn("ApiImplementationV2.ParameterApi.updateAsync","_parameterHandler.setMultipleParameterValues returned warning",f);var g={};f=$jscomp.makeIterator(f.params);for(var h=f.next();!h.done;g={p:g.p},h=f.next())g.p=h.value,l.find(function(a){return function(b){return b.id===a.p.id&&b.plugin===a.p.plugin}}(g)).result=g.p.result}},f=d.updateRequiresPriorUpload(l);void 0===f?b((0,module$src$api$v2$ApiResponse.default)("Parameter not found",null,c)):!1===f?e():d.priorUpload(l).then(function(d){d.err?
(a.error("ApiImplementationV2.ParameterApi.updateAsync","_parameterHandler.priorUpload returned error",d),b((0,module$src$api$v2$ApiResponse.default)({m:"Failed to upload blobs",d:d},null,c))):e()},function(d){a.error("ApiImplementationV2.ParameterApi.updateAsync","_parameterHandler.priorUpload failed",d);b((0,module$src$api$v2$ApiResponse.default)({m:"Failed to upload blobs",d:d},null,c))})})};this.canGoBackInHistory=function(){return d.canGoBackInHistory()};this.canGoForwardInHistory=function(){return d.canGoForwardInHistory()};
this.goBackInHistoryAsync=function(b){var c=module$src$shared$constants$MessagingConstants.default.makeMessageToken();c.payload=b;return new Promise(function(e){var f=a.setProcessCallback(c.id,function(c,g){if(g.hasOwnProperty("parts"))for(c=$jscomp.makeIterator(g.parts),g=c.next();!g.done;g=c.next()){g=g.value;if(g.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS){a.clearProcessCallback(f);e((0,module$src$api$v2$ApiResponse.default)(null,d.getParameterState(),
b));break}if(g.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT){a.clearProcessCallback(f);e((0,module$src$api$v2$ApiResponse.default)(g.data,null,b));break}if(g.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR){a.clearProcessCallback(f);e((0,module$src$api$v2$ApiResponse.default)(g.data,null,b));break}}});d.goBackInHistory(c)||(a.error("ApiImplementationV2.goBackInHistoryAsync","_parameterHandler.goBackInHistory returned false"),
a.clearProcessCallback(f),e((0,module$src$api$v2$ApiResponse.default)("Failed to go back in history",null,b)))})};this.goForwardInHistoryAsync=function(b){var c=module$src$shared$constants$MessagingConstants.default.makeMessageToken();c.payload=b;return new Promise(function(e){var f=a.setProcessCallback(c.id,function(c,g){if(g.hasOwnProperty("parts"))for(c=$jscomp.makeIterator(g.parts),g=c.next();!g.done;g=c.next()){g=g.value;if(g.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS){a.clearProcessCallback(f);
e((0,module$src$api$v2$ApiResponse.default)(null,d.getParameterState(),b));break}if(g.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT){a.clearProcessCallback(f);e((0,module$src$api$v2$ApiResponse.default)(g.data,null,b));break}if(g.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR){a.clearProcessCallback(f);e((0,module$src$api$v2$ApiResponse.default)(g.data,null,b));break}}});d.goForwardInHistory(c)||(a.error("ApiImplementationV2.goForwardInHistoryAsync",
"_parameterHandler.goForwardInHistory returned false"),a.clearProcessCallback(f),e((0,module$src$api$v2$ApiResponse.default)("Failed to go forward in history",null,b)))})};this.updateProperties=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,d.updateMultipleParameters(a))};this.addEventListener=function(b,d){if(!Object.keys(c.EVENTTYPE).find(function(a){return c.EVENTTYPE[a]===b}))return(0,module$src$api$v2$ApiResponse.default)("Unsupported event type");var e=a.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.PARAMETER+
"."+b,function(a,c){a=new CustomEvent(b);a.api=c.api;c.token&&(a.token=c.token);a.parameter={};var e={};e[module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_DEFINITION]=null;e[module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_UPDATE]=null;for(var f in e){var g=c.getUniquePartByType(f);if(g){g.data&&(g=g.data);var h=e[f]?e[f]:g,k;for(k in h)a.parameter[k]=g[k]}}d(a)});return(0,module$src$api$v2$ApiResponse.default)(null,e)};this.removeEventListener=
function(b){return(0,module$src$api$v2$ApiResponse.default)(null,a.unsubscribeFromMessageStream(b))}};var module$src$api$v2$implementation$ApiPluginImplementationV2_1={},COMM_PLUGIN$$module$src$api$v2$implementation$ApiPluginImplementationV2_1=module$src$plugins$comm$CommPlugin.default,messagingConstants$$module$src$api$v2$implementation$ApiPluginImplementationV2_1=module$src$shared$constants$MessagingConstants.default,pluginConstantsGlobal$$module$src$api$v2$implementation$ApiPluginImplementationV2_1=module$src$shared$constants$PluginConstantsGlobal.default,ApiInterfaceV2$$module$src$api$v2$implementation$ApiPluginImplementationV2_1=
new module$src$api$v2$ApiInterfaceV2_1.default,APIResponse$$module$src$api$v2$implementation$ApiPluginImplementationV2_1=module$src$api$v2$ApiResponse.default;
module$src$api$v2$implementation$ApiPluginImplementationV2_1.default=function(a,b){var c=this;this.STATUS=ApiInterfaceV2$$module$src$api$v2$implementation$ApiPluginImplementationV2_1.plugins.STATUS;var d=b.pluginHandler,e=b.messagingHandler,f=b.parameterHandler;this.get=function(){return(0,module$src$api$v2$ApiResponse.default)(null,d.getStatusDescription())};this.registerPluginAsync=function(a){return new Promise(function(b){try{var c=a.getRuntimeId(),f=[],g=function(d,g){(d=g.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PLUGIN_RUNTIME_ID))&&
d.data===c&&(f.forEach(function(a){e.unsubscribeFromMessageStream(a)}),b((0,module$src$api$v2$ApiResponse.default)(null,a.getStatusDescription())))};f.push(e.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.PLUGIN_ACTIVE,g));f.push(e.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.PLUGIN_FAILED,g));void 0===d.registerPlugin(a)&&(f.forEach(function(a){e.unsubscribeFromMessageStream(a)}),b((0,module$src$api$v2$ApiResponse.default)("Failed to register plugin.",
a.getStatusDescription())))}catch(n){b((0,module$src$api$v2$ApiResponse.default)(n))}})};this.registerCommPluginAsync=function(a){a=new module$src$plugins$comm$CommPlugin.default(a);return c.registerPluginAsync(a)};this.refreshPluginAsync=function(b,c){var d=module$src$shared$constants$MessagingConstants.default.makeMessageToken();d.payload=c;return new Promise(function(e){var g=a.setProcessCallback(d.id,function(b,d){if(d.hasOwnProperty("parts"))for(b=$jscomp.makeIterator(d.parts),d=b.next();!d.done;d=
b.next()){d=d.value;if(d.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS){a.clearProcessCallback(g);e((0,module$src$api$v2$ApiResponse.default)(null,f.getParameterState(),c));break}if(d.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT){a.clearProcessCallback(g);e((0,module$src$api$v2$ApiResponse.default)(d.data,null,c));break}if(d.type==module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR){a.clearProcessCallback(g);
e((0,module$src$api$v2$ApiResponse.default)(d.data,null,c));break}}});f.refreshPlugin(b,d).err&&(a.error("ApiImplementationV2.refreshPluginAsync","_parameterHandler.refreshPlugin failed"),a.clearProcessCallback(g),e((0,module$src$api$v2$ApiResponse.default)("Failed to refresh plugin "+b,null,c)))})};this.saveDefaultParameterValuesAsync=function(a){a||(a=d.getRuntimeIds());Array.isArray(a)||(a=[a]);for(var b=[],c=0,e=a.length;c<e;c++){var h=a[c],n=d.getPluginByRuntimeId(h);n?n.getCapabilities().includes(module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities.DEFAULTPARAM)?
(h=f.getParameterValuesForPlugin(h,!0),b.push(n.saveDefaultParameterValues(h))):b.push(Promise.resolve(!1)):b.push(Promise.resolve(!1))}return Promise.all(b).then(function(a){return(0,module$src$api$v2$ApiResponse.default)(null,a.every(function(a){return a}))},function(a){return(0,module$src$api$v2$ApiResponse.default)(a,!1)})};this.deregisterPluginAsync=function(){return Promise.reject("not implemented yet")}};var module$src$api$v2$implementation$ApiSceneImplementationV2_1={},messagingConstants$$module$src$api$v2$implementation$ApiSceneImplementationV2_1=module$src$shared$constants$MessagingConstants.default,GlobalUtils$$module$src$api$v2$implementation$ApiSceneImplementationV2_1=module$src$shared$util$GlobalUtils.default,MessagePrototype$$module$src$api$v2$implementation$ApiSceneImplementationV2_1=module$src$shared$messages$MessagePrototype.default,ApiInterfaceV2$$module$src$api$v2$implementation$ApiSceneImplementationV2_1=
new module$src$api$v2$ApiInterfaceV2_1.default,TWEEN$$module$src$api$v2$implementation$ApiSceneImplementationV2_1=module$node_modules$$tweenjs$tween_js$src$Tween.default,APIResponse$$module$src$api$v2$implementation$ApiSceneImplementationV2_1=module$src$api$v2$ApiResponse.default;
module$src$api$v2$implementation$ApiSceneImplementationV2_1.default=function(a,b){var c=this;this.FORMAT=ApiInterfaceV2$$module$src$api$v2$implementation$ApiSceneImplementationV2_1.scene.FORMAT;this.EVENTTYPE=ApiInterfaceV2$$module$src$api$v2$implementation$ApiSceneImplementationV2_1.scene.EVENTTYPE;this.INTERACTIONMODETYPE=ApiInterfaceV2$$module$src$api$v2$implementation$ApiSceneImplementationV2_1.scene.INTERACTIONMODETYPE;this.SELECTIONMODETYPE=ApiInterfaceV2$$module$src$api$v2$implementation$ApiSceneImplementationV2_1.scene.SELECTIONMODETYPE;
this.TRANSFORMATIONTYPE=ApiInterfaceV2$$module$src$api$v2$implementation$ApiSceneImplementationV2_1.scene.TRANSFORMATIONTYPE;this.LIVETRANSFORMATIONTYPE=ApiInterfaceV2$$module$src$api$v2$implementation$ApiSceneImplementationV2_1.scene.LIVETRANSFORMATIONTYPE;var d=b.sceneManager,e=b.viewportManager,f=b.sceneGeometryManager,h=b.interactionGroupManager,g=b.messagingHandler;c.lights=e.api.lights;c.camera=e.api.camera;this.updateAsync=function(b,e,f,h){Array.isArray(b)||(b=[b]);var k=e||a.getRuntimeId(),
l=[],m=[];b=$jscomp.makeIterator(b);for(e=b.next();!e.done;e=b.next()){var n=e.value;if(!n||!n.id)return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Asset without id property",null,f));m.push(n.id);e=module$src$shared$util$GlobalUtils.default.deepCopy(n,["canvas","threeObject","transformations"]);if(n=d.getJSONOutputVersion(n.id,k,!1)){var t=Object.keys(n);t=$jscomp.makeIterator(t);for(var v=t.next();!v.done;v=t.next())v=v.value,e.hasOwnProperty(v)||"version"===v||(e[v]=n[v])}e.hasOwnProperty("version")||
(e.version=module$src$shared$util$GlobalUtils.default.createRandomId());l.push(e)}var w=module$src$shared$constants$MessagingConstants.default.makeMessageToken();w.payload=f;return(new Promise(function(a,b){h||(h={});h.busy||(h.busy=!1);var e=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,{busy:h.busy,progress:0},w);g.message(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,
e);if(d.initSubScene(l.length,k,w)){e=[];for(var f=$jscomp.makeIterator(l),n=f.next();!n.done;n=f.next())e.push(d.addJSONOutputVersionToSubScene(n.value,k,w));return Promise.all(e).then(function(){for(var e=[],f={},g=$jscomp.makeIterator(m),h=g.next();!h.done;f={asset$298:f.asset$298},h=g.next())f.asset$298=d.getJSONOutputVersion(h.value,k,!0),f.asset$298&&(f.asset$298.addEventListener=function(a){return function(b,d){if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,"string")||0>=b.length)return(0,module$src$api$v2$ApiResponse.default)("Event type must be a string");
var e=b;b.endsWith(a.asset$298.scenePath)||(e=b+"."+a.asset$298.scenePath);return c.addEventListener(e,d)}}(f),e.push(f.asset$298));e.length==m.length?a(e):b("Failed to publish all assets, unknown error.")},function(a){b(a)})}b(Error("Could not initialize subscene."))})).then(function(a){return(0,module$src$api$v2$ApiResponse.default)(null,a,f)},function(a){return Promise.resolve((0,module$src$api$v2$ApiResponse.default)(a,null,f))})};this.get=function(b,c,e){b=b||{};"object"!==typeof b&&(b={});var f=
[];f=module$src$shared$util$GlobalUtils.default.typeCheck(c,"string")?[c]:[a.getRuntimeId()];c=[];f=$jscomp.makeIterator(f);for(var g=f.next();!g.done;g=f.next()){g=g.value;var h=b.hasOwnProperty("id")?[b.id]:d.getOutputIds(g);h=$jscomp.makeIterator(h);for(var k=h.next();!k.done;k=h.next()){k=d.getJSONOutputVersion(k.value,g,e);if(null===k)return(0,module$src$api$v2$ApiResponse.default)(void 0,[]);c.push(k)}}f=Object.keys(b);e={};f=$jscomp.makeIterator(f);for(g=f.next();!g.done;e={f:e.f},g=f.next())e.f=
g.value,c=c.filter(function(a){return function(c){return c[a.f]===b[a.f]}}(e));return(0,module$src$api$v2$ApiResponse.default)(null,c)};this.getData=function(a,b){a=module$src$shared$util$GlobalUtils.default.deepCopy(a);module$src$shared$util$GlobalUtils.default.typeCheck(b,"string")&&(a.plugin=b);b=d.getModelData(a);return(0,module$src$api$v2$ApiResponse.default)(null,b)};this.convertTo2D=function(a){return e.api.convertTo2D(a)};this.getBoundingBox=function(a){return a&&!module$src$shared$util$GlobalUtils.default.typeCheck(a,
"string")?(0,module$src$api$v2$ApiResponse.default)("Path must be a string."):(a=f.getBoundingBox(a))?(0,module$src$api$v2$ApiResponse.default)(null,a):(0,module$src$api$v2$ApiResponse.default)("No Object was found at this path.")};this.setTransformation=function(b,c,d){if("number"===typeof d[0]||d.isMatrix4){if(!module$src$shared$util$GlobalUtils.default.typeCheck(d,"matrix4x4arr")&&!d.isMatrix4)return(0,module$src$api$v2$ApiResponse.default)("The provided matrix is not valid.")}else for(var g=0,
h=d.length;g<h;g++)if(null!==d[g]&&!module$src$shared$util$GlobalUtils.default.typeCheck(d[g],"matrix4x4arr")&&!d[g].isMatrix4)return(0,module$src$api$v2$ApiResponse.default)("At least one provided matrix is not valid.");if(b===this.TRANSFORMATIONTYPE.PLUGIN){b=a.plugins.get().data;if(c){g=!1;var k=0;for(h=b.length;k<h;k++)b[k].id===c&&(f.setPluginTransformation(c,d),g=!0);if(!g)return(0,module$src$api$v2$ApiResponse.default)("Plugin with id "+c+" does not exist.")}else for(c=0,h=b.length;c<h;c++)f.setPluginTransformation(b[c].id,
d);e.api.updateShadowMap();e.api.render()}else if(b===this.TRANSFORMATIONTYPE.VIEWPORT)e.api.setTransformation(c,d);else return(0,module$src$api$v2$ApiResponse.default)('Invalid transformation type. Types: "plugin", "viewport"');return(0,module$src$api$v2$ApiResponse.default)(null,!0)};this.getTransformation=function(b,c){if(b===this.TRANSFORMATIONTYPE.PLUGIN){b=a.plugins.get().data;if(c){for(var d=0,g=b.length;d<g;d++)if(b[d].id===c){b=f.getPluginTransformation(c);g=[];d=0;for(c=b.length;d<c;d++)g[d]=
b[d].transpose().elements;return(0,module$src$api$v2$ApiResponse.default)(null,1===g.length?g[0]:g)}return(0,module$src$api$v2$ApiResponse.default)("Plugin with id "+c+" does not exist.")}if(1==b.length){b=f.getPluginTransformation(b[0].id);g=[];d=0;for(c=b.length;d<c;d++)g[d]=b[d].transpose().elements;return(0,module$src$api$v2$ApiResponse.default)(null,1===g.length?g[0]:g)}d=0;for(g=b.length;d<g;d++){var h=f.getPluginTransformation(b[d].id),k=0;for(c=h.length;k<c;k++)h[k].transpose()}return(0,module$src$api$v2$ApiResponse.default)(null,
void 0)}return b===this.TRANSFORMATIONTYPE.VIEWPORT?(0,module$src$api$v2$ApiResponse.default)(null,e.api.getTransformation(c)):(0,module$src$api$v2$ApiResponse.default)('Invalid transformation type. Types: "plugin", "viewport"')};this.applyTransformation=function(b,c,d){if("number"===typeof d[0]||d.isMatrix4){if(!module$src$shared$util$GlobalUtils.default.typeCheck(d,"matrix4x4arr")&&!d.isMatrix4)return(0,module$src$api$v2$ApiResponse.default)("The provided matrix is not valid.")}else for(var g=0,
h=d.length;g<h;g++)if(null!==d[g]&&!module$src$shared$util$GlobalUtils.default.typeCheck(d[g],"matrix4x4arr")&&!d[g].isMatrix4)return(0,module$src$api$v2$ApiResponse.default)("At least one provided matrix is not valid.");if(b===this.TRANSFORMATIONTYPE.PLUGIN){b=a.plugins.get().data;if(c){g=!1;var k=0;for(h=b.length;k<h;k++)b[k].id===c&&(f.applyPluginTransformation(c,d),g=!0);if(!g)return(0,module$src$api$v2$ApiResponse.default)("Plugin with id "+c+" does not exist.")}else for(c=0,h=b.length;c<h;c++)f.applyPluginTransformation(b[c].id,
d);e.api.updateShadowMap();e.api.render()}else if(b===this.TRANSFORMATIONTYPE.VIEWPORT)e.api.applyTransformation(c,d);else return(0,module$src$api$v2$ApiResponse.default)('Invalid transformation type. Types: "plugin", "viewport"');return(0,module$src$api$v2$ApiResponse.default)(null,!0)};this.resetTransformation=function(b,c){if(b===this.TRANSFORMATIONTYPE.PLUGIN){b=a.plugins.get().data;if(c){for(var d=!1,g=0,h=b.length;g<h;g++)b[g].id===c&&(f.resetPluginTransformation(c),d=!0);if(!d)return(0,module$src$api$v2$ApiResponse.default)("Plugin with id "+
c+" does not exist.")}else for(c=0,h=b.length;c<h;c++)f.resetPluginTransformation(b[c].id);e.api.updateShadowMap();e.api.render()}else if(b===this.TRANSFORMATIONTYPE.VIEWPORT)e.api.resetTransformation(c);else return(0,module$src$api$v2$ApiResponse.default)('Invalid transformation type. Types: "plugin", "viewport"');return(0,module$src$api$v2$ApiResponse.default)(null,!0)};this.setLiveTransformation=function(b,d,g){if(d&&!module$src$shared$util$GlobalUtils.default.typeCheck(d,"string")&&!Array.isArray(d))return(0,module$src$api$v2$ApiResponse.default)("The provided viewports is not of type array or string, but also not null.");
module$src$shared$util$GlobalUtils.default.typeCheck(d,"string")&&!Array.isArray(d)&&(d=[d]);d||(d=[],e.getApis().forEach(function(a){d.push(a.getViewportRuntimeId())}));if(g&&!module$src$shared$util$GlobalUtils.default.typeCheck(g,"notnegative"))return(0,module$src$api$v2$ApiResponse.default)("The provided duration is not a valid number.");g||(g=Infinity);b=Array.isArray(b)?b:[b];if(0===b.length)return(0,module$src$api$v2$ApiResponse.default)("No live transformations were provided.");for(var h=0,
k=b.length;h<k;h++){var l=b[h];if(!l.scenePaths)return(0,module$src$api$v2$ApiResponse.default)("No scene paths provided.");Array.isArray(l.scenePaths)||(l.scenePaths=[l.scenePaths]);for(var m=0,q=l.scenePaths.length;m<q;m++)if(!module$src$shared$util$GlobalUtils.default.typeCheck(l.scenePaths[m],"string"))return(0,module$src$api$v2$ApiResponse.default)("One of the provided scenePaths of a live transformation is not of valid type.");if(!l.transformations)return(0,module$src$api$v2$ApiResponse.default)("No live transformations provided.");
Array.isArray(l.transformations)||(l.transformations=[b]);if(0===l.transformations.length)return(0,module$src$api$v2$ApiResponse.default)("One of the provided live transformations does not have any transformations.");m=0;for(q=l.transformations.length;m<q;m++){var t=l.transformations[m];if(!module$src$shared$util$GlobalUtils.default.typeCheck(t.type,"string")||t.type!==c.LIVETRANSFORMATIONTYPE.ROTATION&&t.type!==c.LIVETRANSFORMATIONTYPE.TRANSLATION&&t.type!==c.LIVETRANSFORMATIONTYPE.SCALING)return(0,module$src$api$v2$ApiResponse.default)("No valid transformation type provided for at least one of the live transformations.");
if(!module$src$shared$util$GlobalUtils.default.typeCheck(t.duration,"notnegative"))return(0,module$src$api$v2$ApiResponse.default)("No valid duration provided for at least one of the live transformations.");module$src$shared$util$GlobalUtils.default.typeCheck(t.delay,"notnegative")||(t.delay&&a.warn("setLiveTransformation","The value "+t.delay+" is not a valid input for the delay. It is set to the default (0)."),t.delay=0);module$src$shared$util$GlobalUtils.default.typeCheck(t.repeat,"notnegative")||
(t.repeat&&a.warn("setLiveTransformation","The value "+t.repeat+" is not a valid input for the repeat. It is set to the default (0)."),t.repeat=0);module$src$shared$util$GlobalUtils.default.typeCheck(t.yoyo,"boolean")||(t.yoyo&&a.warn("setLiveTransformation","The value "+t.yoyo+" is not a valid input for the yoyo. It is set to the default (false)."),t.yoyo=!1);module$src$shared$util$GlobalUtils.default.typeCheck(t.parent,"string")?f.getBoundingBox(t.parent)||(a.warn("setLiveTransformation","The value "+
t.parent+" is not a valid path to a parent. It is set to the default (null)."),t.parent=null):(t.parent&&a.warn("setLiveTransformation","The value "+t.parent+" is not a valid input for the parent. It is set to the default (null)."),t.parent=null);t.easing?module$src$shared$util$GlobalUtils.default.typeCheck(t.easing,"string")?(t.easing=module$src$shared$util$GlobalUtils.default.getAtPath(module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing,t.easing),t.easing||(a.warn("setLiveTransformation",
"The value "+t.easing+" is not a valid input for the easing. It is set to the default (Linear.None)."),t.easing=module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Linear.None)):module$src$shared$util$GlobalUtils.default.typeCheck(t.easing,"function")||t.easing||(a.warn("setLiveTransformation","The value "+t.easing+" is not a valid input for the easing. It is set to the default (Linear.None)."),t.easing=module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Linear.None):t.easing=
module$node_modules$$tweenjs$tween_js$src$Tween.default.Easing.Linear.None;module$src$shared$util$GlobalUtils.default.typeCheck(t.pivot,"vector3any")||(t.pivot&&a.warn("setLiveTransformation","The value "+t.pivot+" is not a valid input for the pivot. It is set to the default (null)."),t.pivot=null);if(!module$src$shared$util$GlobalUtils.default.typeCheck(t.rotationAxis,"vector3any")&&t.type===c.LIVETRANSFORMATIONTYPE.ROTATION)return(0,module$src$api$v2$ApiResponse.default)("No valid rotationAxis provided for at least one of the live transformations with type ROTATION.");
if(!module$src$shared$util$GlobalUtils.default.typeCheck(t.rotationDegree,"number")&&t.type===c.LIVETRANSFORMATIONTYPE.ROTATION)return(0,module$src$api$v2$ApiResponse.default)("No valid rotationDegree provided for at least one of the live transformations with type ROTATION.");if(!module$src$shared$util$GlobalUtils.default.typeCheck(t.scalingVector,"vector3any")&&t.type===c.LIVETRANSFORMATIONTYPE.SCALING)return(0,module$src$api$v2$ApiResponse.default)("No valid scalingVector provided for at least one of the live transformations with type SCALING.");
if(!module$src$shared$util$GlobalUtils.default.typeCheck(t.translationVector,"vector3any")&&t.type===c.LIVETRANSFORMATIONTYPE.TRANSLATION)return(0,module$src$api$v2$ApiResponse.default)("No valid translationVector provided for at least one of the live transformations with type TRANSLATION.")}module$src$shared$util$GlobalUtils.default.typeCheck(l.reset,"boolean")||(l.reset&&a.warn("setLiveTransformation","The value "+l.reset+" is not a valid input for the reset. It is set to the default (true)."),
l.reset=!0)}h=[];l={};q=0;for(m=d.length;q<m;l={stops:l.stops},q++){t=[];l.stops=[];var v=[],w=e.api.setLiveTransformation(d[q],b,g),x=0;for(k=w.length;x<k;x++)t.push({stop:w[x].stop,promise:w[x].promise}),l.stops.push(w[x].stop),v.push(w[x].promise);h.push({responses:t,stop:function(a){return function(b){for(var c=0,d=a.stops.length;c<d;c++)a.stops[c](b)}}(l),promise:Promise.all(v)})}return(0,module$src$api$v2$ApiResponse.default)(null,1===h.length?h[0]:h)};this.getScreenshot=function(){return e.api.getScreenshot()};
this.getScreenshotAsync=function(){return e.api.getScreenshotAsync()};this.updateSelected=function(a,b){return e.api.updateSelected(a,b)};this.getSelected=function(){return e.api.getSelected()};this.startExternalDragEvent=function(a,b){return e.api.startExternalDragEvent(a,b)};this.removeAsync=function(b,e,f){e=e||a.getRuntimeId();var g=c.get(b,e,!0);g.payload=f;if(g.err)return g;b=[];for(var h=$jscomp.makeIterator(g.data),k=h.next();!k.done;k=h.next())b.push(k.value.id);return d.removeOutputIds(e,
b).then(function(){return(0,module$src$api$v2$ApiResponse.default)(null,g.data,f)},function(a){return Promise.resolve((0,module$src$api$v2$ApiResponse.default)(a,null,f))})};this.updatePersistentAsync=function(b,c,e){Array.isArray(b)||(b=[b]);c=c||a.getRuntimeId();var f=[];b=$jscomp.makeIterator(b);for(var g=b.next();!g.done;g=b.next()){g=g.value;if(void 0===g||"object"!==typeof g)return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Unexpected asset format",null,e));if(!g.hasOwnProperty("id"))return Promise.resolve((0,module$src$api$v2$ApiResponse.default)('Asset does not have "id" attribute.',
null,e));f.push(d.setPersistentAttributes(g.id,c,g))}return Promise.all(f).then(function(a){return(0,module$src$api$v2$ApiResponse.default)(null,a,e)}).catch(function(a){return Promise.resolve((0,module$src$api$v2$ApiResponse.default)(a,null,e))})};this.getPersistent=function(b,e){e=e||a.getRuntimeId();var f=c.get(b,e,!1);if(f.err)return f;b=[];f=$jscomp.makeIterator(f.data);for(var g=f.next();!g.done;g=f.next())(g=d.getPersistentAttributes(g.value.id,e))&&b.push(g);return(0,module$src$api$v2$ApiResponse.default)(null,
b)};this.updateInteractionGroups=function(a){Array.isArray(a)||(a=[a]);var b={};a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;b={g:b.g,group:b.group},c=a.next()){b.group=c.value;if(!b.group||!b.group.id)return(0,module$src$api$v2$ApiResponse.default)("Interaction group without id property");b.g={};["hoverable","selectable","draggable"].forEach(function(a){return function(b){a.g[b]=a.group[b]||!1}}(b));b.group.selectionMode&&(b.g.selectionMode=b.group.selectionMode);b.g.name=b.group.id;c=function(a){var b=
["active","passive"],c;for(c in b)if(b=a[c]){if("object"!==typeof b)return"Effect has invalid type. Should be object.";if(!b.name)return"Effect has no name property.";if(-1==["colorHighlight","opacityHighlight"].indexOf(b.name))return"Invalid effect type name."}};if(b.g.hoverable&&b.group.hoverEffect){var d=c(b.group.hoverEffect);if(d)return(0,module$src$api$v2$ApiResponse.default)(d);b.g.hoverableHighlight=b.group.hoverEffect}if(b.g.selectable&&b.group.selectionEffect){if(d=c(b.group.selectionEffect))return(0,module$src$api$v2$ApiResponse.default)(d);
b.g.selectableHighlight=b.group.selectionEffect}if(b.g.draggable&&b.group.dragEffect){if(c=c(b.group.dragEffect))return(0,module$src$api$v2$ApiResponse.default)(c);b.g.draggableHighlight=b.group.dragEffect}h.isInteractionGroup(b.g.name)&&(c=h.getGroup(b.g.name),b.g.hasOwnProperty("hoverable")||(b.g.hoverable=c.isHoverable()),b.g.hasOwnProperty("selectable")||(b.g.selectable=c.isSelectable()),b.g.hasOwnProperty("selectionMode")||(b.g.selectionMode=c.getSelectionMode()),b.g.hasOwnProperty("draggable")||
(b.g.draggable=c.isDraggable()),b.g.hasOwnProperty("hoverEffect")||(b.g.hoverEffect=c.getHoverableHighlight()),b.g.hasOwnProperty("selectionEffect")||(b.g.selectionEffect=c.getSelectableHighlight()),b.g.hasOwnProperty("dragEffect")||(b.g.dragEffect=c.getDraggableHighlight()));h.addOrReplaceInteractionGroup(b.g)}return(0,module$src$api$v2$ApiResponse.default)(null,!0)};this.getInteractionGroups=function(){var a=h.getGroups(),b=[],c={};a=$jscomp.makeIterator(a);for(var d=a.next();!d.done;c={g:c.g},
d=a.next())d=d.value,c.g={},c.g.id=d.getName(),c.g.hoverable=d.isHoverable(),c.g.selectable=d.isSelectable(),c.g.selectionMode=d.getSelectionMode(),c.g.draggable=d.isDraggable(),c.g.hoverEffect=d.getHoverableHighlight(),c.g.selectionEffect=d.getSelectableHighlight(),c.g.dragEffect=d.getDraggableHighlight(),["dragEffect","hoverEffect","selectionEffect"].forEach(function(a){return function(b){if(a.g[b]){var c=a.g[b],d={};["active","passive"].forEach(function(a){if(c[a]&&(d[a]={name:c[a].name},c[a].options&&
(d[a].options={},d[a].options.opacity&&(d[a].options.opacity=c[a].options.opacity),c[a].options.color))){var b=c[a].options.color;["r","g","b"].every(function(a){return b.hasOwnProperty(a)})&&(d[a].options.color=[255*b.r,255*b.g,255*b.b])}});a.g[b]=d}}}(c)),b.push(c.g);return(0,module$src$api$v2$ApiResponse.default)(null,b)};this.addEventListener=function(b,d){if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,"string")||0>=b.length)return(0,module$src$api$v2$ApiResponse.default)("Event type must be a string");
var e;if(!Object.keys(c.EVENTTYPE).find(function(a){a=c.EVENTTYPE[a];return b.startsWith(a)?(e=a,!0):!1}))return(0,module$src$api$v2$ApiResponse.default)("Unsupported event type");var f=a.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE+"."+b,function(a,b){a=new CustomEvent(e);a.api=b.api;b.token&&(a.token=b.token);var c={};c[module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_INTERACTION]=null;c[module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC]=
null;c[module$src$shared$constants$MessagingConstants.default.messageDataTypes.SCENE_ANCHORDATA]=null;c[module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_UPDATE]={assets:1};for(var f in c){var g=b.getUniquePartByType(f);if(g){g.data&&(g=g.data);var h=c[f]?c[f]:g,k;for(k in h)a[k]=g[k]}}d(a)});return(0,module$src$api$v2$ApiResponse.default)(null,f)};this.removeEventListener=function(b){return(0,module$src$api$v2$ApiResponse.default)(null,a.unsubscribeFromMessageStream(b))};
this.render=function(){return e.api.render()};this.updateShadowMap=function(){return e.api.updateShadowMap()};this.startContinuousRendering=function(){return e.api.startContinuousRendering()};this.stopContinuousRendering=function(){return e.api.stopContinuousRendering()};this.pause=function(){return e.api.pause()};this.resume=function(){return e.api.resume()};this.toggleGeometry=function(a,b){return e.api.toggleGeometry(a,b)};this.getViewportRuntimeId=function(){return e.api.getViewportRuntimeId()};
this.getContainer=function(a){return e.api.getContainer(a)}};var module$src$api$v2$implementation$ApiStateImplementationV2_1={},messagingConstants$$module$src$api$v2$implementation$ApiStateImplementationV2_1=module$src$shared$constants$MessagingConstants.default,ApiInterfaceV2$$module$src$api$v2$implementation$ApiStateImplementationV2_1=new module$src$api$v2$ApiInterfaceV2_1.default,APIResponse$$module$src$api$v2$implementation$ApiStateImplementationV2_1=module$src$api$v2$ApiResponse.default;
module$src$api$v2$implementation$ApiStateImplementationV2_1.default=function(a,b){var c=this;this.EVENTTYPE=ApiInterfaceV2$$module$src$api$v2$implementation$ApiStateImplementationV2_1.state.EVENTTYPE;var d=b.messagingHandler,e=b.processStatusHandler;this.get=function(){var a=e.getSummary();a.failedStatusMessages=d.getFailedStatusMessages();return(0,module$src$api$v2$ApiResponse.default)(null,a)};this.setBusy=function(b,c){var d={};if(c){if("number"!==typeof c||0>c||1<c)return(0,module$src$api$v2$ApiResponse.default)("progess must be a number between 0 and 1",
e.getSummary());d.progress=c}else d.progress=0;b?(d.busy=!0,e.updateProcessStatus(a.getRuntimeId(),d)):e.unregisterProcess(a.getRuntimeId());return this.get()};this.addEventListener=function(b,d){if(!Object.keys(c.EVENTTYPE).find(function(a){return c.EVENTTYPE[a]===b}))return(0,module$src$api$v2$ApiResponse.default)("Unsupported event type");var e=a.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.STATUS+"."+b,function(a,c){a=new CustomEvent(b);a.api=c.api;
c.token&&(a.token=c.token);var e={};e[module$src$shared$constants$MessagingConstants.default.messageDataTypes.APP_STATUS]={progress:1};e[module$src$shared$constants$MessagingConstants.default.messageDataTypes.STATUS_MESSAGE]=null;for(var f in e){var g=c.getUniquePartByType(f);if(g){g.data&&(g=g.data);var h=e[f]?e[f]:g,k;for(k in h)a[k]=g[k]}}d(a)});return(0,module$src$api$v2$ApiResponse.default)(null,e)};this.removeEventListener=function(b){return(0,module$src$api$v2$ApiResponse.default)(null,a.unsubscribeFromMessageStream(b))}};var module$src$api$v2$implementation$ApiViewportsImplementationV2_1={},messagingConstants$$module$src$api$v2$implementation$ApiViewportsImplementationV2_1=module$src$shared$constants$MessagingConstants.default,GlobalUtils$$module$src$api$v2$implementation$ApiViewportsImplementationV2_1=module$src$shared$util$GlobalUtils.default,ApiInterfaceV2$$module$src$api$v2$implementation$ApiViewportsImplementationV2_1=new module$src$api$v2$ApiInterfaceV2_1.default,APIResponse$$module$src$api$v2$implementation$ApiViewportsImplementationV2_1=
module$src$api$v2$ApiResponse.default;
module$src$api$v2$implementation$ApiViewportsImplementationV2_1.default=function(a,b){var c=this,d=b.viewportManager;this.EVENTTYPE=ApiInterfaceV2$$module$src$api$v2$implementation$ApiViewportsImplementationV2_1.viewports.EVENTTYPE;this.get=function(a){return a?module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")?(a=d.getApi(a))?a:(0,module$src$api$v2$ApiResponse.default)("The requested api was not found"):(0,module$src$api$v2$ApiResponse.default)("The provided input is not a valid runtimeId"):1===
d.getApis().length?d.getApis()[0]:d.getApis()};this.create=function(a){return d.createThreeDManager(a)[0]};this.destroy=function(a){return d.removeThreeDManager(a)};this.addEventListener=function(b,d){if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,"string")||0>=b.length)return(0,module$src$api$v2$ApiResponse.default)("Event type must be a string");if(!Object.keys(c.EVENTTYPE).find(function(a){return c.EVENTTYPE[a]===b}))return(0,module$src$api$v2$ApiResponse.default)("Unsupported event type");
var e=a.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.VIEWPORTS+"."+b,function(a,c){a=new CustomEvent(b);a.api=c.api;c.token&&(a.token=c.token);var e={};e[module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC]=null;for(var f in e){var g=c.getUniquePartByType(f);if(g){g.data&&(g=g.data);var h=e[f]?e[f]:g,k;for(k in h)a[k]=g[k]}}d(a)});return(0,module$src$api$v2$ApiResponse.default)(null,e)};this.removeEventListener=function(b){return(0,module$src$api$v2$ApiResponse.default)(null,
a.unsubscribeFromMessageStream(b))}};var module$src$api$v2$ApiImplementationV2_1={},messagingConstants$$module$src$api$v2$ApiImplementationV2_1=module$src$shared$constants$MessagingConstants.default,GlobalUtils$$module$src$api$v2$ApiImplementationV2_1=module$src$shared$util$GlobalUtils.default,ApiInterfaceV2$$module$src$api$v2$ApiImplementationV2_1=new module$src$api$v2$ApiInterfaceV2_1.default,APIResponse$$module$src$api$v2$ApiImplementationV2_1=module$src$api$v2$ApiResponse.default,ExportApi$$module$src$api$v2$ApiImplementationV2_1=
module$src$api$v2$implementation$ApiExportImplementationV2_1.default,ParameterApi$$module$src$api$v2$ApiImplementationV2_1=module$src$api$v2$implementation$ApiParameterImplementationV2_1.default,PluginApi$$module$src$api$v2$ApiImplementationV2_1=module$src$api$v2$implementation$ApiPluginImplementationV2_1.default,SceneApi$$module$src$api$v2$ApiImplementationV2_1=module$src$api$v2$implementation$ApiSceneImplementationV2_1.default,StateApi$$module$src$api$v2$ApiImplementationV2_1=module$src$api$v2$implementation$ApiStateImplementationV2_1.default,
ViewportsApi$$module$src$api$v2$ApiImplementationV2_1=module$src$api$v2$implementation$ApiViewportsImplementationV2_1.default;
module$src$api$v2$ApiImplementationV2_1.default=function(a,b){var c=this,d=module$src$shared$util$GlobalUtils.default.deepCopy(b);d.runtimeId&&module$src$shared$util$GlobalUtils.default.typeCheck(d.runtimeId,"string")||(d.runtimeId=module$src$shared$util$GlobalUtils.default.createRandomId());this.EVENTTYPE=ApiInterfaceV2$$module$src$api$v2$ApiImplementationV2_1.EVENTTYPE;this.getRuntimeId=function(){return d.runtimeId};b=a.app;var e=a.exportHandler,f=a.messagingHandler,h=a.parameterHandler,g=a.pluginHandler,
k=a.processStatusHandler,l=a.sceneManager,m=a.settingsHandler,n=a.viewportManager,r=a.sceneGeometryManager,u=a.interactionGroupManager,p=a.arApi,q=/^scene\./;module$src$shared$util$GlobalUtils.default.inject(a.loggingHandler,c);var t={};this.clearProcessCallback=function(a){if(!t.hasOwnProperty(a))return!1;f.unsubscribeFromMessageStream(t[a].subToken);delete t[a];return!0};this.setProcessCallback=function(a,b){if(!t.hasOwnProperty(a)){var d=f.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS+
"."+a,function(d,e){var f=d.substring(d.indexOf(".")+1);if(t.hasOwnProperty(a)){var g=t[a],h=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_FORK);if(h&&Array.isArray(h.data)){if(h.data.every(function(b){return b.startsWith(a+".")})){var k=g.procTokens;k=k.splice(k.indexOf(f),1);k=k.concat(h.data);g.procTokens=k}else c.error("ApiImplementationV2.setProcessCallback","Forked process token must be a sub-token of "+a);try{b(d,e)}catch(I){c.error("ApiImplementationV2.setProcessCallback",
"Exception in process callback:",I)}}else{h=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR);k=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT);var l=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS);h?g.procTokenStat[f]=module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR:k?g.procTokenStat[f]=
module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT:l&&(g.procTokenStat[f]=module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS);g.procTokens.every(function(a){return g.procTokenStat.hasOwnProperty(a)})&&(c.debug("ApiImplementationV2.setProcessCallback","Clearing process callback for token "+a),c.clearProcessCallback(a));try{b(d,e)}catch(I){c.error("ApiImplementationV2.setProcessCallback","Exception in process callback:",I)}}}else c.warn("ApiImplementationV2.setProcessCallback",
"Message for unknown token:",e)});t[a]={subToken:d,procTokens:[a],procTokenStat:{}};return a}};this.subscribeToMessageStream=function(a,b){return f.subscribeToMessageStream(a,function(a,d){try{d=d||{},d.api=c,b(a,d)}catch(z){c.warn("ApiImplementationV2.subscribeToMessageStream","Exception in callback for topic "+a,z,d)}})};this.unsubscribeFromMessageStream=function(a){return f.unsubscribeFromMessageStream(a)};this.state=new module$src$api$v2$implementation$ApiStateImplementationV2_1.default(c,{processStatusHandler:k,
messagingHandler:f});this.parameters=new module$src$api$v2$implementation$ApiParameterImplementationV2_1.default(c,{parameterHandler:h,messagingHandler:f});this.plugins=new module$src$api$v2$implementation$ApiPluginImplementationV2_1.default(c,{pluginHandler:g,messagingHandler:f,parameterHandler:h});this.exports=new module$src$api$v2$implementation$ApiExportImplementationV2_1.default(c,{exportHandler:e});this.viewports=new module$src$api$v2$implementation$ApiViewportsImplementationV2_1.default(c,
{viewportManager:n});this.scene=new module$src$api$v2$implementation$ApiSceneImplementationV2_1.default(c,{sceneManager:l,viewportManager:n,sceneGeometryManager:r,interactionGroupManager:u,messagingHandler:f});var v={};v.viewerRuntimeId={handler:b,namespace:"app",setting:"viewerRuntimeId",desc:"The runtime id of this viewer",type:"string"};v["defaultMaterial.color"]={handler:b,namespace:"app",setting:"defaultMaterial.color",desc:"Color of the default material",type:function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,
"color")?!0:!1}};v["defaultMaterial.bumpAmplitude"]={handler:b,namespace:"app",setting:"defaultMaterial.bumpAmplitude",desc:"Bump amplitude of the default material",type:"notnegative"};v["defaultMaterial.metalness"]={handler:b,namespace:"app",setting:"defaultMaterial.metalness",desc:"Metalness of the default material",type:function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"number")&&0<=a&&1>=a}};v["defaultMaterial.roughness"]={handler:b,namespace:"app",setting:"defaultMaterial.roughness",
desc:"Roughness of the default material",type:function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"number")&&0<=a&&1>=a}};v.ignoreSuperseded={handler:b,namespace:"app",setting:"ignoreSuperseded",desc:"Ignore intermediate solutions which at the time of their arrival have already been superseded by another customization request",type:"boolean"};v.blurSceneWhenBusy={handler:b,namespace:"app",setting:"blurSceneWhenBusy",desc:"Blur or don't blur the scene while a process is busy",
type:"boolean"};v.hasRestoredSettings={handler:b,namespace:"app",setting:"hasRestoredSettings",desc:"True if settings have been restored from a settings object delivered by a CommPlugin",type:function(){return!1}};v.loggingLevel={handler:b,namespace:"app",setting:"loggingLevel",desc:"Level of log messages shown on the console, allowed values: -1 (none), 0 (error), 1 (warn), 2 (info), 3 (debug)",type:function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"number")&&-1<=a&&3>=a}};
v.messageLoggingLevel={handler:b,namespace:"app",setting:"messageLoggingLevel",desc:"Log level to be used for logging internal messages, allowed values: -1 (none), 0 (error), 1 (warn), 2 (info), 3 (debug)",type:function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"number")&&-1<=a&&3>=a}};v["scene.show"]={handler:b,namespace:"app",setting:"showScene",desc:"Show / hide the scene",type:"boolean"};v.showMessages={handler:b,namespace:"app",setting:"showMessages",desc:"Show or don't show user messages in the viewport",
type:"boolean"};v.commitParameters={handler:b,namespace:"app",setting:"commitParameters",desc:"Use or don't commit mode for parameters",type:"boolean"};v.commitSettings={handler:b,namespace:"app",setting:"commitSettings",desc:"Use or don't commit mode for settings",type:"boolean"};v["ar.enableCameraSync"]={handler:b,namespace:"app",setting:"ar.enableCameraSync",desc:"Enable / disable synchronisation of the camera with AR tracking information. Enabling this will disable the orbit controls.",tyoe:"boolean"};
v["ar.enableLightingEstimation"]={handler:b,namespace:"app",setting:"ar.enableLightingEstimation",desc:"Enable / disable automatic lighting estimation. Enabling this stores the current state of the lights which will get restored once automatic lighting estimation gets disabled again.",type:"boolean"};v["ar.enableTouchControls"]={handler:b,namespace:"app",setting:"ar.enableTouchControls",desc:"Enable / disable touch controls for placement of objects in the AR scene while AR camera synchronisation is enabled.",
type:"boolean"};v["ar.enableTouchControlRotation"]={handler:b,namespace:"app",setting:"ar.enableTouchControlRotation",desc:"Enable / disable rotation of objects in the AR scene by means of touch controls. Typically this should be enabled for objects to be placed horizontally.",type:"boolean"};v["ar.enableAutomaticPlacement"]={handler:b,namespace:"app",setting:"ar.enableAutomaticPlacement",desc:"Enable / disable initial automatic placement of objects in the AR scene as soon as plane anchors get detected. Automatic placement stops once the user starts to interact.",
type:"boolean"};v["ar.defaultHitTestType"]={handler:b,namespace:"app",setting:"ar.defaultHitTestType",desc:"Default type of feature to use for hit tests, used by touch controls. ",type:function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")&&"featurePoint estimatedHorizontalPlane estimatedVerticalPlane existingPlane existingPlaneUsingExtent existingPlaneUsingGeometry".split(" ").contains(a)}};this.addEventListener=function(a,b){if(!Object.keys(c.EVENTTYPE).find(function(b){return c.EVENTTYPE[b]===
a}))return(0,module$src$api$v2$ApiResponse.default)("Unsupported event type");var d=c.subscribeToMessageStream(a,function(d,e){d=new CustomEvent(a);d.api=e.api;e.token&&(d.token=e.token);d.settings={};var f=d.settings;if(e=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.SETTINGS_UPDATE)){e.data&&(e=e.data);if(n.api.getViewportRuntimeId().includes(e.namespace))f.key=e.key,f.runtimeId=e.namespace,f.namespace="scene";else for(var g in v){var h=v[g];if(h.namespace===
e.namespace&&h.setting===e.key){f.key=g;f.runtimeId=c.getRuntimeId();break}}f.key&&(f.valueNew=e.valueNew,f.valueOld=e.valueOld,b(d))}});return(0,module$src$api$v2$ApiResponse.default)(null,d)};this.removeEventListener=function(a){return(0,module$src$api$v2$ApiResponse.default)(null,c.unsubscribeFromMessageStream(a))};this.getSettingDefinitions=function(){var a={};Object.keys(v).forEach(function(b){var c=v[b],d={description:c.desc};c.type&&(d.type=c.type);c=module$src$shared$util$GlobalUtils.default.deepCopy(d);
a[b]=c});var b=n.api.getSettingDefinitions(),c;for(c in b)a["scene."+c]=b[c];return a};this.getSettings=function(a){if(!Array.isArray(a)){a=Object.keys(c.getSettingDefinitions());for(var b=Object.keys(n.api.getSettingDefinitions()),d=0,e=b.length;d<e;d++){var f="scene."+b[d];a.includes(f)||a.push(f)}}var g={};a.forEach(function(a){var b=v[a];void 0!==b?(b=b.handler.getSetting(b.setting),module$src$shared$util$GlobalUtils.default.forceAtPath(g,a,b)):(b=n.api.getSetting(a.replace(q,"")),void 0!==b&&
module$src$shared$util$GlobalUtils.default.forceAtPath(g,a,b))});return g};this.getSetting=function(a){var b=v[a];return void 0===b?n.api.getSetting(a.replace(q,"")):b.handler.getSetting(b.setting)};this.updateSettingAsync=function(a,b){var c=v[a];if(void 0===c)return n.api.updateSettingAsync(a.replace(q,""),b);if(void 0!==c.type&&null!==c.type)if(module$src$shared$util$GlobalUtils.default.typeCheck(c.type,"string")){if(module$src$shared$util$GlobalUtils.default.typeCheck(b,"m.type"))return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Setting has wrong value type",
!1))}else if("function"===typeof c.type&&!c.type(b))return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Setting has wrong value type",!1));c.hasOwnProperty("transform")&&"function"===typeof c.transform&&(b=c.transform(b));return c.handler.updateSettingAsync(c.setting,b).then(function(a){return a?Promise.resolve((0,module$src$api$v2$ApiResponse.default)(null,!0)):Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Update of setting failed",!1))},function(){return Promise.resolve((0,module$src$api$v2$ApiResponse.default)("Update of setting failed",
!1))})};this.updateSettingsAsync=function(a){var b=[];module$src$shared$util$GlobalUtils.default.getPaths(a,b);var d={},e=Promise.resolve(),f={};b=$jscomp.makeIterator(b);for(var g=b.next();!g.done;f={path:f.path},g=b.next())f.path=g.value,e=e.then(function(b){return function(){return c.updateSettingAsync(b.path,module$src$shared$util$GlobalUtils.default.getAtPath(a,b.path))}}(f)),e=e.then(function(a){return function(b){b.err?module$src$shared$util$GlobalUtils.default.forceAtPath(d,a.path,!1):module$src$shared$util$GlobalUtils.default.forceAtPath(d,
a.path,!0)}}(f),function(a){return function(){module$src$shared$util$GlobalUtils.default.forceAtPath(d,a.path,!1)}}(f));return e.then(function(){return(0,module$src$api$v2$ApiResponse.default)(null,d)})};this.createAsynchronousFunctions=function(){var a=function(b){var c={},d;for(d in b)c.key=d,b[c.key]instanceof Function?c.key.endsWith("Async")||c.key.endsWith("EventListener")||b[c.key+"Async"]||(b[c.key+"Async"]=function(a){return function(c){for(var d=[],e=0;e<arguments.length;++e)d[e-0]=arguments[e];
return new Promise(function(c,e){c(b[a.key].call.apply(b[a.key],[b].concat($jscomp.arrayFromIterable(d))))})}}(c)):-1<"state parameters plugins exports viewports scene camera lights".split(" ").indexOf(c.key)&&a(b[c.key]),c={key:c.key}};a(this)};this.saveSettingsAsync=function(a){return m.saveSettings(a).then(function(a){return(0,module$src$api$v2$ApiResponse.default)(null,a)},function(a){return(0,module$src$api$v2$ApiResponse.default)(a,!1)})};p&&(this.ar=p);this.utils=module$src$shared$util$GlobalUtils.default};var module$src$api$v1$ApiInterfaceV1={default:function(){this.STATUSCODE={READY:0,BUSY:1,INITIALIZING:2,ERROR:3};this.TYPE={FLOAT:"Float",INT:"Int",EVEN:"Even",ODD:"Odd",STRING:"String",COLOR:"Color",STRINGLIST:"StringList",BOOL:"Bool",TIME:"Time"};this.VISUALIZATION={SLIDER:"slider",SEQUENCE:"sequence",CYCLE:"cycle",DROPDOWN:"dropdown",CHECKLIST:"checklist",CLOCK:"clock",CALENDAR:"calendar"};this.activateTopView=function(){};this.addDraggableShape=function(){};this.cameraPath=function(){};this.changeEnvMap=
function(){};this.clearMessagingCallback=function(){};this.clearProcessCallback=function(){};this.deregisterPlugin=function(){};this.disablePan=function(){};this.disableZoom=function(){};this.fadeInViewer=function(){};this.findTexturedGeometry=function(){};this.getApiVersion=function(){};this.getBackgroundColor=function(){};this.getCamera=function(){};this.getDraggableShapePosition=function(){};this.getExportDefinitions=function(){};this.getGeometryNames=function(){};this.getGeometryPathsByName=function(){};
this.getModelData=function(){};this.getParameterDefinitions=function(){};this.getParameterValues=function(){};this.getScreenshot=function(){};this.getStatus=function(){};this.hideControls=function(){};this.hideFullscreenToggle=function(){};this.hideZoomToggle=function(){};this.loadStaticMesh=function(){};this.refreshPlugin=function(){};this.registerPlugin=function(){};this.removeDraggableShape=function(){};this.removeExternalTexture=function(){};this.removeStaticMesh=function(){};this.requestExport=
function(){};this.requestSceneUpdate=function(){};this.resetCamera=function(){};this.restrictCamera=function(){};this.restrictPan=function(){};this.restrictZoom=function(){};this.setAutoRotate=function(){};this.setAutoRotation=function(){};this.setAutoRotationSpeed=function(){};this.setBackgroundColor=function(){};this.setBumpAmplitude=function(){};this.setBusyGraphic=function(){};this.setBusyGraphicPosition=function(){};this.setButtonColor=function(){};this.setCamera=function(){};this.setCommandResultCallback=
function(){};this.setDefaultMaterialColor=function(){};this.setExternalTexture=function(){};this.setFOV=function(){};this.setPointSize=function(){};this.setToggleAmbientOcclusion=function(){};this.setToggleCastShadow=function(){};this.setControlDamping=function(){};this.setDamping=function(){};this.setEdgeColor=function(){};this.setEdgeColorByObject=function(){};this.setIgnoreMouse=function(){};this.setMessagingCallback=function(){};this.setParameterValue=function(){};this.setParameterValues=function(){};
this.setProcessCallback=function(){};this.setRotateSpeed=function(){};this.setRotationSpeed=function(){};this.setZoomExtentFactor=function(){};this.setZoomSpeed=function(){};this.showControls=function(){};this.showEdges=function(){};this.showFullscreenToggle=function(){};this.showGrid=function(){};this.showGroundPlane=function(){};this.showShadows=function(){};this.showStaticMesh=function(){};this.showZoomToggle=function(){};this.toggleDisablePan=function(){};this.toggleDisableZoom=function(){};this.toggleFullscreen=
function(){};this.toggleSceneBackground=function(){};this.toggleShadows=function(){};this.toggleTopView=function(){};this.zoomExt=function(){};this.zoomExtents=function(){}}};var module$src$api$v1$ApiImplementationV1={},pluginConstants$$module$src$api$v1$ApiImplementationV1=module$src$shared$constants$PluginConstantsGlobal.default,messagingConstants$$module$src$api$v1$ApiImplementationV1=module$src$shared$constants$MessagingConstants.default,GlobalUtils$$module$src$api$v1$ApiImplementationV1=module$src$shared$util$GlobalUtils.default,threeDManagerConstants$$module$src$api$v1$ApiImplementationV1=module$src$3d$viewport$ThreeDManagerConstants.default,toTinyColor$$module$src$api$v1$ApiImplementationV1=
module$src$shared$util$toTinyColor.default,ApiInterfaceV1$$module$src$api$v1$ApiImplementationV1=new module$src$api$v1$ApiInterfaceV1.default,THREE$$module$src$api$v1$ApiImplementationV1=module$src$externals$three.default;
module$src$api$v1$ApiImplementationV1.default=function(a){var b=this,c=a.app,d=a.viewportVisibilityHandler,e=a.exportHandler,f=a.messagingHandler,h=a.parameterHandler,g=a.pluginHandler,k=a.processStatusHandler,l=a.sceneManager,m=a.threeDManager;module$src$shared$util$GlobalUtils.default.inject(a.loggingHandler,b);var n=c.api({version:2}),r=n.getRuntimeId();module$src$shared$mixins$GlobalMixin.default.call(this);this.STATUSCODE=ApiInterfaceV1$$module$src$api$v1$ApiImplementationV1.STATUSCODE;this.TYPE=
ApiInterfaceV1$$module$src$api$v1$ApiImplementationV1.TYPE;this.VISUALIZATION=ApiInterfaceV1$$module$src$api$v1$ApiImplementationV1.VISUALIZATION;var u={},p,q=function(a,c){if("function"===typeof p)try{p(a,c)}catch(I){b.error("ApiImplementationV1._callCommandResultCallback","Exception in callback:",a,I)}return c};this._callCommandResultCallback=q;var t={},v=function(a){a.type===n.scene.EVENTTYPE.DRAG_START?z("ObjectDragStarted"):a.type===n.scene.EVENTTYPE.DRAG_END&&z("ObjectDragEnded");if(a.dragPosAbs&&
a.scenePath){var b=a.scenePath.split(".");t[b[1]]=a.dragPosAbs}},w=[],x=function(){if(0<Object.keys(t).length){var a=n.scene.addEventListener(n.scene.EVENTTYPE.DRAG_START+"."+r,v);a.data&&w.push(a.data);a=n.scene.addEventListener(n.scene.EVENTTYPE.DRAG_MOVE+"."+r,v);a.data&&w.push(a.data);a=n.scene.addEventListener(n.scene.EVENTTYPE.DRAG_END+"."+r,v);a.data&&w.push(a.data)}else w.forEach(function(a){n.scene.removeEventListener(a)}),w=[]},y=[],A,z=function(a){if("function"===typeof A)try{A(a)}catch(E){b.error("ApiImplementationV1._sendExternalMsg",
"Exception in messaging callback ("+a+"):",E)}},B=function(){y.forEach(function(a){f.unsubscribeFromMessageStream(a)});y=[]},D=function(){if(!(0<y.length)){var a=module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_PUBLISHED;a=f.subscribeToMessageStream(a,function(){z("GeometryUpdateDone");z("GeometryUpdateVisible")});y=y.concat(a);a=module$src$shared$constants$MessagingConstants.default.messageTopics.PLUGIN_ACTIVE;a=f.subscribeToMessageStream(a,function(a,b){if(a=b.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PLUGIN_RUNTIME_ID))a=
g.getPluginByRuntimeId(a.data).getShortName()+"Loaded",z(a)});y=y.concat(a);a=module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_VISIBILITY_ON;var b=f.subscribeToMessageStream(a,function(){f.unsubscribeFromMessageStream(b);z("InitialSceneReady")});y=y.concat(b)}};this.activateTopView=function(a){a=m.updateSetting("camera.type",a?module$src$3d$viewport$ThreeDManagerConstants.default.cameraViewTypes.TOP:module$src$3d$viewport$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE);
return q("activateTopView",a)};this.addDraggableShape=function(a,c,d,e,f){if(!(module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")&&module$src$shared$util$GlobalUtils.default.typeCheck(c,"string")&&module$src$shared$util$GlobalUtils.default.typeCheck(d,"notnegative")&&module$src$shared$util$GlobalUtils.default.typeCheck(e,"color")&&module$src$shared$util$GlobalUtils.default.typeCheck(f,"vector3obj")))return q("addDraggableShape",!1);var g=n.scene.get({id:a},r);if(g.err||0<g.data.length)return q("addDraggableShape",
!1);var h;"box"===c?h=new module$src$externals$three.default.BoxBufferGeometry(d,d,d):"sphere"===c?h=new module$src$externals$three.default.SphereBufferGeometry(.5*d,20,20):"dodecahedron"===c&&(h=new module$src$externals$three.default.DodecahedronBufferGeometry(.5*d));if(void 0===h)return q("addDraggableShape",!1);c=n.scene.updateInteractionGroups({id:r,draggable:!0,selectable:!1,hoverable:!1});!0!==c.data?(b.error("ApiImplementationV1._createInteractionGroup","Could not add interaction group",c.err),
c=!1):c=!0;if(!c)return q("addDraggableShape",!1);e=[{id:a,name:a,material:a+"_m",interactionGroup:r,content:[{format:"three",data:{threeObject:new module$src$externals$three.default.Mesh(h)},transformations:(new module$src$externals$three.default.Matrix4).makeTranslation(f.x,f.y,f.z)}]},{id:a+"_m",content:[{format:"material",data:{version:"3.0",color:e}}]}];n.scene.updateAsync(e,r);t[a]=module$src$shared$util$GlobalUtils.default.toVector3(f);x();return q("addDraggableShape",!0)};this.cameraPath=
function(a,b,c){if(a.length!==b.length||0>=a.length)return q("cameraPath",!1);var d={};c&&(d.duration=c);m.cameraHandler.setCameraPath(a,b,d);return q("cameraPath",!0)};this.changeEnvMap=function(a){m.updateSettingAsync("material.environmentMap",a);return!0};this.clearMessagingCallback=function(){B();A=void 0};this.clearProcessCallback=function(a){if(!u.hasOwnProperty(a))return!1;f.unsubscribeFromMessageStream(u[a].subToken);delete u[a];return!0};this.deregisterPlugin=function(a){return g.deregisterPlugin(a)};
this.disablePan=function(a){if(m.getSetting("camera.enablePan")===!a)return q("disablePan",!1);a=m.updateSetting("camera.enablePan",!a);return q("disablePan",a)};this.disableZoom=function(a){if(m.getSetting("camera.enableZoom")===!a)return q("disableZoom",!1);a=m.updateSetting("camera.enableZoom",!a);return q("disableZoom",a)};this.fadeInViewer=function(){d.showScene(!0);return!0};this.findTexturedGeometry=function(){var a=b.getGeometryNames(),c=[],d,e;for(d in a)for(e in a[d])c.push(e);return q("findTexturedGeometry",
c)};this.getApiVersion=function(){return"1.0.0"};this.getBackgroundColor=function(){var a=m.getSetting("render.clearColor"),b=m.getSetting("render.clearAlpha");a=(0,module$src$shared$util$toTinyColor.default)(a);a.setAlpha(b);return a.toString("hex8")};this.getCamera=function(){var a=m.cameraHandler.getPositionAndTarget();return q("getCamera",a)};this.getDraggableShapePosition=function(a){return t.hasOwnProperty(a)?q("getDraggableShapePosition",t[a]):q("getDraggableShapePosition",!1)};this.getExportDefinitions=
function(){var a=e.getExportDefinitions();q("getExportDefinitions",a)};this.getGeometryNames=function(a){return l.getGeometryNames(a)};this.getGeometryPathsByName=function(a,b){return l.getGeometryPathsByName(a,b)};this.getModelData=function(a){var b={};l.getModelData(a).forEach(function(a){b[a.id]=a});return q("getModelData",b)};this.getParameterDefinitions=function(a){a=h.getParameterDefinitions(a);return q("getParameterDefinitions",a)};this.getParameterValues=function(){var a=h.getParameterValuesCompat();
return q("getParameterValues",a)};this.getScreenshot=function(){var a=m.renderingHandler.getScreenshot();return q("getScreenshot",a)};this.getStatus=function(){var a=g.getStatusDescription();if(!a.every(function(a){return a.status!==module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.FAILED}))return a={statusCode:3,statusText:"Error",statusInfo:"At least one plugin failed"},q("getStatus",a);if(!a.every(function(a){return a.status===module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.ACTIVE}))return a=
{statusCode:2,statusText:"Initializing",statusInfo:"The viewer is still initializing"},q("getStatus",a);if(k.getSummary().busy)return a={statusCode:1,statusText:"Busy",statusInfo:"Viewer is processing a parameter update"},q("getStatus",a);a={statusCode:0,statusText:"Ready",statusInfo:"Viewer is fully loaded, geometry is being displayed"};return q("getStatus",a)};this.hideControls=function(){b.error("ApiImplementationV1.hideControls","Requires UI");return q("hideControls",!1)};this.hideFullscreenToggle=
function(){b.error("ApiImplementationV1.hideFullscreenToggle","Requires UI");return!1};this.hideZoomToggle=function(){b.error("ApiImplementationV1.hideZoomToggle","Requires UI");return!1};this.loadStaticMesh=function(a,b,c,d,e,f){if(4>arguments.length||!module$src$shared$util$GlobalUtils.default.typeCheck(d,"string")||0===d.length)d=module$src$shared$util$GlobalUtils.default.createRandomId();if(!module$src$shared$util$GlobalUtils.default.typeCheck(b,"string")||0===b.length)return!1;var g=n.scene.get({id:d},
r);if(g.err||0<g.data.length)return!1;g=[{id:d,material:"material_1",version:"1",duration:0,content:[{format:"obj",data:{objUrl:b}}]}];module$src$shared$util$GlobalUtils.default.typeCheck(c,"string")&&(g[0].content.data.mtlUrl=c);module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")&&(g[0].content.data.path=a);module$src$shared$util$GlobalUtils.default.typeCheck(e,"string")&&(g[0].content.data.texturePath=e);module$src$shared$util$GlobalUtils.default.typeCheck(f,"string")&&(g[0].content.data.side=
f);n.scene.updateAsync(g,r).then(function(){z("LoadStaticMeshDone")});return!0};this.refreshPlugin=function(a,b){b=module$src$shared$constants$MessagingConstants.default.makeMessageToken(b);return h.refreshPlugin(a,b).err?!1:!0};this.registerPlugin=function(a){return g.registerPlugin(a)};this.removeExternalTexture=function(a,c){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string"))return q("removeExternalTexture",!1);var d="color alpha roughness metalness normal bump".split(" ");if("string"===
typeof c)try{c=JSON.parse(c),Array.isArray(c)||(c=[c])}catch(K){c=d}else Array.isArray(c)||(c=d);c.includes("color")&&(c.splice(c.findIndex(function(a){return"color"===a}),1),c.push("bitmap"));c.includes("alpha")&&(c.splice(c.findIndex(function(a){return"alpha"===a}),1),c.push("transparency"));d=b.getGeometryNames();var e;for(e in d)if(d[e].hasOwnProperty(a)){var f=e;break}if(!f)return q("removeExternalTexture",!1);a=n.scene.get({name:a},f);if(a.err||1>=a.data.length)return q("removeExternalTexture",
!1);a=a.data.filter(function(a){return a.material});if(1!==a.length)return q("removeExternalTexture",!1);a=n.scene.getPersistent({id:a[0].material},f);if(a.err||1!==a.data.length)return q("removeExternalTexture",!1);a=module$src$shared$util$GlobalUtils.default.deepCopy(a.data[0]);if(!Array.isArray(a.content)||0>=a.content.length||"material"!==a.content[0].format)return q("removeExternalTexture",!1);var g=a.content[0].data;c.forEach(function(a){delete g[a+"texture"]});n.scene.updatePersistentAsync([a],
f);return q("removeExternalTexture",!0)};this.removeDraggableShape=function(a){if(!t.hasOwnProperty(a))return q("removeDraggableShape",!1);n.scene.removeAsync({id:a},r);delete t[a];x();return q("removeDraggableShape",!0)};this.removeStaticMesh=function(a){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")||0< !a.length)return!1;var b=n.scene.get({id:a},r);if(b.err||1!==b.data.length)return!1;n.scene.removeAsync({id:a},r);return!0};this.requestExport=function(a,b,c,d){if("string"===
typeof a)a={idOrName:a},"string"===typeof c&&(a.plugin=c);else if(!a||"object"!==typeof a||!module$src$shared$util$GlobalUtils.default.typeCheck(a.id,"string")&&!module$src$shared$util$GlobalUtils.default.typeCheck(a.idOrName,"string")&&!module$src$shared$util$GlobalUtils.default.typeCheck(a.name,"string")||a.plugin&&"string"!==typeof a.plugin)return q("requestExport",!1);d=module$src$shared$constants$MessagingConstants.default.makeMessageToken(d);c=e.requestExport(a,d);return c!==module$src$shared$constants$PluginConstantsGlobal.default.requestExportResults.CACHE&&
c!==module$src$shared$constants$PluginConstantsGlobal.default.requestExportResults.LOAD?q("requestExport",!1):q("requestExport",!0)};this.requestSceneUpdate=function(){var a=g.getStatusDescription(),b=!0;a=$jscomp.makeIterator(a);for(var c=a.next();!c.done;c=a.next())c=c.value,c.status===module$src$shared$constants$PluginConstantsGlobal.default.pluginStatuses.ACTIVE&&h.refreshPlugin(c.id).err&&(b=!1);return b};this.resetCamera=function(a,b){var c={duration:0};void 0===a&&(a=!0);a&&(c.duration=b?b:
800);m.cameraHandler.resetPositionAndTarget(c);return!0};this.restrictCamera=function(a,b,c){if("number"===typeof a)if(0===a)a="x";else if(1===a)a="y";else if(2===a)a="z";else return q("restrictCamera",!1);else if("string"===typeof a){if("x"!==a&&"y"!==a&&"z"!==a)return q("restrictCamera",!1)}else return q("restrictCamera",!1);var d="min";b&&(d="max");if("number"!==typeof c)return q("restrictCamera",!1);b=m.getSetting("camera.restrictions.position.cube");b[d][a]=c;c=m.updateSetting("camera.restrictions.position.cube",
b);return q("restrictCamera",c)};this.restrictPan=function(a,b,c){if("number"===typeof a)if(0===a)a="x";else if(1===a)a="y";else if(2===a)a="z";else return q("restrictPan",!1);else if("string"===typeof a){if("x"!==a&&"y"!==a&&"z"!==a)return!1}else return q("restrictPan",!1);var d="min";b&&(d="max");if("number"!==typeof c)return q("restrictPan",!1);b=m.getSetting("camera.restrictions.target.cube");b[d][a]=c;c=m.updateSetting("camera.restrictions.target.cube",b);return q("restrictPan",c)};this.restrictZoom=
function(a,b){a=m.updateSetting("camera.restrictions.zoom",{minDistance:a,maxDistance:b});return q("restrictZoom",a)};this.setAutoRotate=function(a){if("number"===typeof a){var c=b.setAutoRotationSpeed(a);a=m.updateSetting("camera.enableAutoRotation",0!==a);return q("setAutoRotate",c||a)}return"boolean"===typeof a?(c=m.updateSetting("camera.enableAutoRotation",a),q("setAutoRotate",c)):q("setAutoRotate",!1)};this.setAutoRotation=function(a){return b.setAutoRotate(a)};this.setAutoRotationSpeed=function(a){return"number"!==
typeof a?!1:m.updateSetting("camera.autoRotationSpeed",a)};this.setBackgroundColor=function(a){a=(0,module$src$shared$util$toTinyColor.default)(a);return a.isValid()&&m.updateSetting("render.clearColor",a.toString("hex6"))&&m.updateSetting("render.clearAlpha",a.getAlpha())?q("setBackgroundColor",!0):q("setBackgroundColor",!1)};this.setBumpAmplitude=function(a){n.updateSettingAsync("defaultMaterial.bumpAmplitude",a);return q("setBumpAmplitude",!0)};this.setBusyGraphic=function(){b.error("ApiImplementationV1.setBusyGraphic",
"Requires UI")};this.setBusyGraphicPosition=function(){b.error("ApiImplementationV1.setBusyGraphicPosition","Requires UI")};this.setButtonColor=function(){b.error("ApiImplementationV1.setButtonColor","Not implemented yet");return q("setButtonColor",!1)};this.setCamera=function(a,b,c,d){var e={duration:0};void 0===c&&(c=!0);c&&(e.duration=d?d:800);a=m.cameraHandler.setPositionAndTarget(a,b,e);return q("setCamera",a)};this.setCommandResultCallback=function(a){p=a};this.setDefaultMaterialColor=function(a){n.updateSettingAsync("defaultMaterial.color",
a);return q("setDefaultMaterialColor",!0)};this.setExternalTexture=function(a,c){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string"))return q("setExternalTexture",!1);if("string"===typeof c)try{c=JSON.parse(c)}catch(K){c={color:c}}else if(c&&"object"===typeof c)c=module$src$shared$util$GlobalUtils.default.deepCopy(c);else return q("setExternalTexture",!1);c.color&&(c.bitmap=c.color,delete c.color);c.alpha&&(c.transparency=c.alpha,delete c.alpha);var d=b.getGeometryNames();for(f in d)if(d[f].hasOwnProperty(a)){var e=
f;break}if(!e)return q("setExternalTexture",!1);a=n.scene.get({name:a},e);if(a.err||1>=a.data.length)return q("setExternalTexture",!1);a=a.data.filter(function(a){return a.material});if(1!==a.length)return q("setExternalTexture",!1);d=a[0];a=n.scene.get({id:d.material},e);if(a.err||1!==a.data.length||!Array.isArray(a.data[0].content)||0>=a.data[0].content.length)return q("setExternalTexture",!1);var f={};f.content=module$src$shared$util$GlobalUtils.default.deepCopy(a.data[0].content);if("material"!==
f.content[0].format)return q("setExternalTexture",!1);var g=f.content[0].data;"bitmap metalness roughness bump normal transparency".split(" ").forEach(function(a){if(c[a]&&module$src$shared$util$GlobalUtils.default.typeCheck(c[a],"string")){var b=a+"texture";g[b]&&"object"===typeof g[b]?g[b].href=c[a]:g[b]=c[a]}});f.id=d.material;n.scene.updatePersistentAsync([f],e);return q("setExternalTexture",!0)};this.setFOV=function(a){a=m.updateSetting("camera.fov",a);return q("setFOV",a)};this.setPointSize=
function(a){"number"!==typeof a&&(a=1);a=m.updateSetting("render.pointSize",a);return q("setPointSize",a)};this.setToggleAmbientOcclusion=function(a){return m.updateSetting("render.ambientOcclusion",a)};this.setToggleCastShadow=function(a,b){m.setToggleCastShadow(a,b)};this.setControlDamping=function(a){a=m.updateSetting("camera.damping",a);return q("setControlDamping",a)};this.setDamping=function(a){return b.setControlDamping(a)};this.setEdgeColor=function(){b.warn("ApiImplementationV1.setEdgeColor",
"Not implemented");return q("setEdgeColor",!1)};this.setEdgeColorByObject=function(){b.warn("ApiImplementationV1.setEdgeColorByObject","Not implemented");return q("setEdgeColorByObject",!1)};this.setIgnoreMouse=function(a){return!0};this.setMessagingCallback=function(a){"function"===typeof a&&(D(),A=a)};var G=function(a){return!a||"object"!==typeof a||"string"!==typeof a.id&&"string"!==typeof a.idOrName&&"string"!==typeof a.name||a.plugin&&"string"!==typeof a.plugin||void 0===a.value?!1:!0};this.setParameterValue=
function(a,c){if("string"===typeof a)a={idOrName:a,value:c};else if(G(a))var d=c;else return q("setParameterValue",!1);d=module$src$shared$constants$MessagingConstants.default.makeMessageToken(d);c=h.setParameterValue(a,d);if(c.err)return b.error("ApiImplementationV1.setParameterValue","_parameterHandler.setParameterValue returned error",c),q("setParameterValue",!1);if(c.warn)return b.warn("ApiImplementationV1.setParameterValue","_parameterHandler.setParameterValue returned warning",c),q("setParameterValue",
!1);b.debug("ApiImplementationV1.setParameterValue","_parameterHandler.setParameterValue returned",c);return q("setParameterValue",!0)};this.setParameterValues=function(a,c){var d=[];if(!Array.isArray(a))return q("setParameterValues",!1);if(a.every(function(a){return"string"===typeof a})){if(!Array.isArray(c)||c.length!==a.length)return!1;for(var e=0;e<a.length;e++)d.push({idOrName:a[e],value:c[e]})}else if(a.every(function(a){return G(a)})){d=a;var f=c}f=module$src$shared$constants$MessagingConstants.default.makeMessageToken(f);
a=h.setMultipleParameterValues(d,f);if(a.err)return b.error("ApiImplementationV1.setParameterValues","_parameterHandler.setParameterValue returned error",a),q("setParameterValues",!1);if(a.warn)return b.warn("ApiImplementationV1.setParameterValues","_parameterHandler.setParameterValue returned warning",a),q("setParameterValues",!1);b.debug("ApiImplementationV1.setParameterValues","_parameterHandler.setParameterValue returned",a);return q("setParameterValues",!0)};this.setProcessCallback=function(a,
c){if(!u.hasOwnProperty(a)){var d=f.subscribeToMessageStream(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS+"."+a,function(d,e){var f=d.substring(d.indexOf(".")+1);if(u.hasOwnProperty(a)){var g=u[a],h=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_FORK);if(h&&Array.isArray(h.data)){if(h.data.every(function(b){return b.startsWith(a+".")})){var k=g.procTokens;k=k.splice(k.indexOf(f),1);k=k.concat(h.data);g.procTokens=
k}else b.error("ApiImplementationV1.setProcessCallback","Forked process token must be a sub-token of "+a);try{c(d,e)}catch(O){b.error("ApiImplementationV1.setProcessCallback","Exception in process callback:",O)}}else{h=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR);k=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT);var l=e.getUniquePartByType(module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS);
h?g.procTokenStat[f]=module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR:k?g.procTokenStat[f]=module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT:l&&(g.procTokenStat[f]=module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS);g.procTokens.every(function(a){return g.procTokenStat.hasOwnProperty(a)})&&(b.debug("ApiImplementationV1.setProcessCallback","Clearing process callback for token "+a),b.clearProcessCallback(a));
try{c(d,e)}catch(O){b.error("ApiImplementationV1.setProcessCallback","Exception in process callback:",O)}}}else b.warn("ApiImplementationV1.setProcessCallback","Message for unknown token:",e)});u[a]={subToken:d,procTokens:[a],procTokenStat:{}};return a}};this.setRotateSpeed=function(a){a=m.updateSetting("camera.rotationSpeed",a);return q("setRotateSpeed",a)};this.setRotationSpeed=function(a){return b.setRotateSpeed(a)};this.setZoomExtentFactor=function(a){a=m.updateSetting("camera.zoomExtentsFactor",
a);return q("setZoomExtentFactor",a)};this.setZoomSpeed=function(a){a=m.updateSetting("camera.zoomSpeed",a);return q("setZoomSpeed",a)};this.showControls=function(){b.error("ApiImplementationV1.showControls","Requires UI");return q("showControls",!1)};this.showEdges=function(){b.warn("ApiImplementationV1.showEdges","Not implemented");return q("showEdges",!1)};this.showFullscreenToggle=function(){b.error("ApiImplementationV1.showFullscreenToggle","Requires UI");return!1};this.showGrid=function(a){"boolean"!==
typeof a&&(a=!0);if(m.getSettingShallow("gridVisibility")==a)return q("showGrid",!1);a=m.updateSetting("gridVisibility",a);return q("showGrid",a)};this.showGroundPlane=function(a){"boolean"!==typeof a&&(a=!0);if(m.getSettingShallow("groundPlaneVisibility")==a)return q("showGroundPlane",!1);a=m.updateSetting("groundPlaneVisibility",a);return q("showGroundPlane",a)};this.showShadows=function(a){"boolean"!==typeof a&&(a=!0);if(m.getSettingShallow("render.shadows")==a)return q("showShadows",!1);a=m.updateSetting("render.shadows",
a);return q("showShadows",a)};this.showStaticMesh=function(a,b){if(!module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")||0===a.length||!module$src$shared$util$GlobalUtils.default.typeCheck(b,"boolean"))return!1;var c=n.scene.get({id:a},r);if(c.err||1!==c.data.length)return!1;n.scene.updateAsync({id:a,visible:b},r);return!0};this.showZoomToggle=function(){b.error("ApiImplementationV1.showZoomToggle","Requires UI");return!1};this.toggleDisablePan=function(){var a=m.getSettingShallow("camera.enablePan");
return m.updateSetting("camera.enablePan",!a)};this.toggleDisableZoom=function(){var a=m.getSettingShallow("camera.enableZoom");a=m.updateSetting("camera.enableZoom",!a);return q(a)};this.toggleFullscreen=function(a){var b=m.getSettingShallow("fullscreen");if("boolean"!==typeof a)a=!b;else if(a===b)return!1;return m.updateSetting("fullscreen",a)};this.toggleSceneBackground=function(a){"boolean"!==typeof a&&(a=!0);return m.updateSetting("material.environmentMapAsBackground",a)};this.toggleShadows=
function(){var a=m.getSettingShallow("render.shadows");return m.updateSetting("render.shadows",!a)};this.toggleTopView=function(){var a=m.getSettingShallow("camera.type")===module$src$3d$viewport$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE?module$src$3d$viewport$ThreeDManagerConstants.default.cameraViewTypes.TOP:module$src$3d$viewport$ThreeDManagerConstants.default.cameraViewTypes.PERSPECTIVE;return m.updateSetting("camera.type",a)};this.zoomExt=function(a){return b.zoomExtents(a)};
this.zoomExtents=function(a,b){var c={duration:0};void 0===a&&(a=!0);a&&(c.duration=b?b:800);m.cameraHandler.zoomExtents(c);return!0};return this};var module$src$app$handlers$SettingsHandler={},GLOBAL_UTILS$$module$src$app$handlers$SettingsHandler=module$src$shared$util$GlobalUtils.default,TO_TINY_COLOR$$module$src$app$handlers$SettingsHandler=module$src$shared$util$toTinyColor.default,viewerAppConstants$$module$src$app$handlers$SettingsHandler=module$src$app$ViewerAppConstants.default,messagingConstants$$module$src$app$handlers$SettingsHandler=module$src$shared$constants$MessagingConstants.default,pluginConstantsGlobal$$module$src$app$handlers$SettingsHandler=
module$src$shared$constants$PluginConstantsGlobal.default,MessagePrototype$$module$src$app$handlers$SettingsHandler=module$src$shared$messages$MessagePrototype.default,StateDashboardLibrary$$module$src$app$handlers$SettingsHandler=module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary;
module$src$app$handlers$SettingsHandler.default=function(a){var b=this,c=a.pluginManager,d=a.parameterManager,e=a.exportManager,f=a.viewportManager,h=a.app,g={},k=!1,l,m={},n=function(a){var b={};a&&(a.lightHandler&&(b.lightScenes={handler:a,setting:"lights.lightScenes",type:"object",order:10},b.lightScene={handler:a,setting:"lights.lightScene",type:"string",order:20}),b.ambientOcclusion={handler:a,setting:"render.ambientOcclusion",type:"boolean",order:40},b.autoRotateSpeed={handler:a,setting:"camera.autoRotationSpeed",
type:"number",hook:function(a){return 0!=a?[["enableAutoRotation",!0]]:[]},order:50},b.backgroundColor={type:function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")&&10===a.length},hook:function(a){a=(0,module$src$shared$util$toTinyColor.default)(a);return[["clearColor",a.toHexString()],["clearAlpha",a.getAlpha()]]},handlerInverse:function(){var b=a.getSetting("render.clearColor"),c=a.getSetting("render.clearAlpha");b=(0,module$src$shared$util$toTinyColor.default)(b);b.setAlpha(c);
return"0x"+b.toHex8()},order:60},b.cameraAutoAdjust={handler:a,setting:"camera.autoAdjust",type:"boolean",order:80},b.cameraMovementDuration={handler:a,setting:"camera.cameraMovementDuration",type:"number",order:90},b.cameraRevertAtMouseUp={handler:a,setting:"camera.revertAtMouseUp",type:"boolean",order:100},b.revertAtMouseUpDuration={handler:a,setting:"camera.revertAtMouseUpDuration",type:"number",order:110},b.clearAlpha={handler:a,setting:"render.clearAlpha",type:"number",order:120},b.clearColor=
{handler:a,setting:"render.clearColor",type:"string",order:130},b.controlDamping={handler:a,setting:"camera.damping",type:"number",order:140},b.disablePan={handler:a,setting:"camera.enablePan",type:"boolean",transform:function(a){return!a},handlerInverse:function(){return!a.getSetting("camera.enablePan")},order:150},b.disableZoom={handler:a,setting:"camera.enableZoom",type:"boolean",transform:function(a){return!a},handlerInverse:function(){return!a.getSetting("camera.enableZoom")},order:160},b.enableAutoRotation=
{handler:a,setting:"camera.enableAutoRotation",type:"boolean",order:170},b.environmentMapResolution={handler:a,setting:"material.environmentMapResolution",type:function(a){return["256","512","1024","2048"].includes(a)},order:180},b.environmentMap={handler:a,setting:"material.environmentMap",type:function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"string")||module$src$shared$util$GlobalUtils.default.isArrayOfType(a,"string")},order:190},b.fov={handler:a,setting:"camera.fov",
type:"number",order:200},b.pointSize={handler:a,setting:"render.pointSize",type:function(a){return"number"===typeof a&&0<=a},order:210},b.rotateSpeed={handler:a,setting:"camera.rotationSpeed",type:"number",transform:function(a){return!k.build_version||module$src$shared$util$GlobalUtils.default.versionStringLowerThan(k.build_version,"2.17.0")?.5:a},order:220},b.showEnvironmentMap={handler:a,setting:"material.environmentMapAsBackground",type:"boolean",order:230},b.showGrid={handler:a,setting:"gridVisibility",
type:"boolean",order:240},b.showGroundPlane={handler:a,setting:"groundPlaneVisibility",type:"boolean",order:250},b.showShadows={handler:a,setting:"render.shadows",type:"boolean",order:260},b.zoomExtentFactor={handler:a,setting:"camera.zoomExtentsFactor",type:"number",order:270},b.zoomSpeed={handler:a,setting:"camera.zoomSpeed",type:"number",transform:function(a){return!k.build_version||module$src$shared$util$GlobalUtils.default.versionStringLowerThan(k.build_version,"2.17.0")?.5:a},order:280},b.panSpeed=
{handler:a,setting:"camera.panSpeed",type:"number",transform:function(a){return!k.build_version||module$src$shared$util$GlobalUtils.default.versionStringLowerThan(k.build_version,"2.17.0")?.5:a},order:290},b.enableRotation={handler:a,setting:"camera.enableRotation",type:"boolean",order:300},b.topView={handler:function(b){return a.constants.cameraViewTypes?a.updateSettingAsync("camera.type",b?a.constants.cameraViewTypes.TOP:a.constants.cameraViewTypes.PERSPECTIVE):null},handlerInverse:function(){var b=
a.getSetting("camera.type");return a.constants.cameraViewTypes?b===a.constants.cameraViewTypes.TOP?!0:!1:!1},order:310},b.camera={handler:a,setting:"camera.defaults.perspective",type:"object",handlerInverse:function(){return a.getSetting("camera.type")===a.constants.cameraViewTypes.PERSPECTIVE?a.cameraHandler.getPositionAndTarget():a.getSetting("camera.defaults.perspective")},order:320},b.cameraOrtho={handler:a,setting:"camera.defaults.orthographic",type:"object",handlerInverse:function(){return a.getSetting("camera.type")===
a.constants.cameraViewTypes.TOP?a.cameraHandler.getPositionAndTarget():a.getSetting("camera.defaults.orthographic")},order:325},b.directUpdates={handler:function(){return!0}},b.edgeColor={handler:function(){return!0}},b.edgeColorByObject={handler:function(){return!0}},b.showEdges={handler:function(){return!0}},b.build_version={handler:function(){return!0}},b.build_date={handler:function(){return!0}});return b};m.controlOrder={handler:function(){return!0}};m.controlNames={handler:function(){return!0}};
m.parametersHidden={handler:function(){return!0}};m.version={handler:function(a){},order:500};h&&(m.defaultMaterialColor={handler:h,setting:"defaultMaterial.color",type:function(a){return module$src$shared$util$GlobalUtils.default.typeCheck(a,"color")},transform:function(a){return(0,module$src$shared$util$toTinyColor.default)(a).toArray()},order:510},m.bumpAmplitude={handler:h,setting:"defaultMaterial.bumpAmplitude",type:"number",order:520},m.commitParameters={handler:h,setting:"commitParameters",
type:"boolean",order:530});var r=function(a,b){if(!a||module$src$shared$util$GlobalUtils.default.versionStringLowerThan(a,"2.14.0"))b.lightHandler.setLightSceneFromID("legacy"),k.ambientIntensity&&b.lightHandler.updateLight({id:"ambient0",type:"ambient",properties:{intensity:parseFloat(k.ambientIntensity)}}),k.spotlightIntensity&&b.lightHandler.updateLight({id:"directional0",type:"directional",properties:{intensity:parseFloat(k.spotlightIntensity)}})};g.getStoredSetting=function(a){return k?module$src$shared$util$GlobalUtils.default.deepCopy(module$src$shared$util$GlobalUtils.default.getAtPath(k,
a)):!1};g.hasStoredSetting=function(a){return k?void 0!==module$src$shared$util$GlobalUtils.default.getAtPath(k,a):!1};g.restoreSetting=function(a,c,d){if(d.hasOwnProperty(a)){var e=d[a];if(e.hasOwnProperty("handler")&&"function"===typeof e.handler){var f=e.handler(c);return f instanceof Promise?f:Promise.resolve(f)}if(void 0===e.handler||"object"!==typeof e.handler||!module$src$shared$util$GlobalUtils.default.typeCheck(e.setting,"string")||0>=e.setting.length||!e.handler.hasOwnProperty("updateSettingAsync")){if(e.hasOwnProperty("hook")&&
"function"===typeof e.hook)return f=e.hook(c),Promise.all(f.map(function(a){return g.restoreSetting(a[0],a[1],d)}));b.debug("SettingsHandler.restoreSetting","Mapping for property "+a+" not configured correctly",e);return Promise.resolve(!1)}if(void 0!==e.type&&null!==e.type)if(module$src$shared$util$GlobalUtils.default.typeCheck(e.type,"string")){if(typeof c!==e.type)if(module$src$shared$util$GlobalUtils.default.typeCheck(c,"string")&&"number"===e.type){if(c=parseFloat(c),Number.isNaN(c))return b.warn("SettingsHandler.restoreSetting",
"Not restoring setting "+a+" due to NaN",k[a]),Promise.resolve(!1)}else return b.warn("SettingsHandler.restoreSetting","Not restoring setting "+a+" due to unexpected data type",k[a]),Promise.resolve(!1)}else if("function"===typeof e.type&&!e.type(c))return b.warn("SettingsHandler.restoreSetting","Not restoring setting "+a+" due to unexpected data type",k[a]),Promise.resolve(!1);e.hasOwnProperty("transform")&&"function"===typeof e.transform&&(c=e.transform(c));return e.handler.updateSettingAsync(e.setting,
c).then(function(f){if(!f)b.warn("SettingsHandler.restoreSetting","Setting "+a+" could not be restored",k[a]);else if(e.hasOwnProperty("hook")&&"function"===typeof e.hook)return f=e.hook(c),Promise.all(f.map(function(a){return g.restoreSetting(a[0],a[1],d)}));return f},function(c){b.warn("SettingsHandler.restoreSetting","Setting "+a+" could not be restored",k[a],c);return!1})}b.warn("SettingsHandler.restoreSetting","Unknown setting "+a);return Promise.resolve(!1)};g.restoreSettings=function(a){if(void 0===
k||"object"!==typeof k)return!1;var c=[];if(a){Array.isArray(a)||(a=[a]);for(var d=0,e=a.length;d<e;d++)a[d].threeDManager.restoredSettings||(a[d].threeDManager.restoredSettings=!0,r(k.build_version,a[d].threeDManager),c.push(n(a[d].threeDManager)))}else c=[m];var h=Promise.resolve(!0),l=!0;d={};e=0;for(var u=c.length;e<u;d={current_mapping:d.current_mapping},e++){d.current_mapping=c[e];var y=[],A;for(A in k)d.current_mapping.hasOwnProperty(A)&&y.push({prop:A,order:d.current_mapping[A].order||0});
y.sort(function(a,b){return a.order-b.order});y.forEach(function(a){return function(c){var d=k[c.prop];h=h.then(function(b){b||(l=!1);return g.restoreSetting(c.prop,d,a.current_mapping)},function(e){b.error("SettingsHandler.restoreSettings",e);l=!1;return g.restoreSetting(c.prop,d,a.current_mapping)})}}(d))}a||(h=h.then(function(a){a||(l=!1);return g.restoreSettings(f.getApis())},function(a){b.error("SettingsHandler.restoreSettings",a);l=!1;return g.restoreSettings(f.getApis())}));return h.then(function(){return l})};
g.saveSettings=function(a){if(module$src$shared$util$GlobalUtils.default.typeCheck(a,"string"))var b=c.getPluginByRuntimeId(a);else l&&l.plugin&&(b=c.getPluginByRuntimeId(l.plugin))&&!b.getCapabilities().includes(module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities.SETTINGS)&&(b=void 0),b||(b=c.getPluginByCapabilities(module$src$shared$constants$PluginConstantsGlobal.default.pluginCapabilities.SETTINGS));if(!b||!module$src$shared$util$GlobalUtils.default.typeCheck(b.saveSettings,
"function"))return Promise.resolve(!1);var f=g.getCurrentSettingsObject();if(!f)return Promise.resolve(!1);var h=d.getConfig(b.getRuntimeId());Object.keys(h).forEach(function(a){f.hasOwnProperty(a)?f[a]=[].concat($jscomp.arrayFromIterable(f[a]),$jscomp.arrayFromIterable(h[a])):f[a]=h[a]});var k=e.getConfig(b.getRuntimeId());Object.keys(k).forEach(function(a){f.hasOwnProperty(a)?f[a]=[].concat($jscomp.arrayFromIterable(f[a]),$jscomp.arrayFromIterable(k[a])):f[a]=k[a]});f.hasOwnProperty("controlNames")&&
(a=f.controlNames,f.controlNames={},a.forEach(function(a){return f.controlNames[a.id]=a.name}));f.hasOwnProperty("controlOrder")&&(f.controlOrder.sort(function(a,b){return a.order-b.order}),f.controlOrder=f.controlOrder.map(function(a){return a.id}));return b.saveSettings(f).then(function(){return!0})};g.messageReceiver=function(a,c,d,e){k||d!==module$src$app$ViewerAppConstants.default.messageDataTypes.APP_SETTINGS||(k=c,l=e,g.restoreSettings().then(function(){var a=new module$src$shared$messages$MessagePrototype.default(module$src$shared$constants$MessagingConstants.default.messageDataTypes.GENERIC,
{});b.message(module$src$shared$constants$MessagingConstants.default.messageTopics.SETTINGS_REGISTERED,a);module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary.getInstance(h.api({version:2}).getSetting("viewerRuntimeId")).settingsLoaded.resolve(!0)}),b.updateSetting("hasRestoredSettings",!0))};g.getCurrentSettingsObject=function(a){var c={},d;c.version=b.getSetting("build_version");c.build_version=b.getSetting("build_version");c.build_date=b.getSetting("build_date");
var e=[];a||(e=[m],a=f.getApis());Array.isArray(a)||(a=[a]);var g=0;for(var h=a.length;g<h;g++)e.push(n(a[g].threeDManager));e.reverse();h=0;for(var k=e.length;h<k;h++){var l=e[h];for(d in l){var r=l[d];a=r.handler;g=r.handlerInverse;r=r.setting;module$src$shared$util$GlobalUtils.default.typeCheck(g,"function")?c[d]=g():module$src$shared$util$GlobalUtils.default.typeCheck(r,"string")&&a&&module$src$shared$util$GlobalUtils.default.typeCheck(a.getSetting,"function")&&(c[d]=a.getSetting(r))}}return c};
return g};var module$src$app$conf$DispatchingConstants={},callbackParamTypes$$module$src$app$conf$DispatchingConstants={TYPE:"type",DATA:"data",TOKEN:"token",ORIGIN:"origin",TOPIC:"topic",PLUGIN:"plugin"},callbackParamTypesDefault$$module$src$app$conf$DispatchingConstants=[callbackParamTypes$$module$src$app$conf$DispatchingConstants.TOKEN,callbackParamTypes$$module$src$app$conf$DispatchingConstants.DATA,callbackParamTypes$$module$src$app$conf$DispatchingConstants.TYPE,callbackParamTypes$$module$src$app$conf$DispatchingConstants.ORIGIN],
dispatchingConstants$$module$src$app$conf$DispatchingConstants={callbackParamTypes:callbackParamTypes$$module$src$app$conf$DispatchingConstants,callbackParamTypesDefault:callbackParamTypesDefault$$module$src$app$conf$DispatchingConstants},GlobalUtils$$module$src$app$conf$DispatchingConstants=module$src$shared$util$GlobalUtils.default;module$src$app$conf$DispatchingConstants.default=module$src$shared$util$GlobalUtils.default.deepCopy(dispatchingConstants$$module$src$app$conf$DispatchingConstants);var module$src$app$conf$DispatchingConfig={},GlobalUtils$$module$src$app$conf$DispatchingConfig=module$src$shared$util$GlobalUtils.default;module$src$app$conf$DispatchingConfig.default=function(){var a={};this.getConfig=function(){return a};this.addPartListener=function(b,c,d,e){a.hasOwnProperty(b)&&"object"===typeof a[b]||(a[b]={});b=a[b];b.hasOwnProperty("partListeners")&&Array.isArray(b.partListeners)||(b.partListeners=[]);var f={};f.type=c;f.cb=d;f.params=e;b.partListeners.push(f);return!0}};var module$src$app$conf$DefaultDispatching={},messagingConstants$$module$src$app$conf$DefaultDispatching=module$src$shared$constants$MessagingConstants.default,dispatchingConstants$$module$src$app$conf$DefaultDispatching=module$src$app$conf$DispatchingConstants.default,DispatchingConfig$$module$src$app$conf$DefaultDispatching=module$src$app$conf$DispatchingConfig.default;
module$src$app$conf$DefaultDispatching.default=function(a){var b=new module$src$app$conf$DispatchingConfig.default;b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PARAMETER_REGISTER,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PARAMETER_DEFINITION,a.parameterManager.registerMultipleParameters,[module$src$app$conf$DispatchingConstants.default.callbackParamTypes.DATA,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.PLUGIN,
module$src$app$conf$DispatchingConstants.default.callbackParamTypes.TOKEN]);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PARAMETER_REGISTER,module$src$shared$constants$MessagingConstants.default.messageDataTypes.APP_SETTINGS,a.parameterManager.registerConfig,[module$src$app$conf$DispatchingConstants.default.callbackParamTypes.DATA,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.PLUGIN,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.TOKEN]);
b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_REGISTER,module$src$shared$constants$MessagingConstants.default.messageDataTypes.APP_SETTINGS,a.exportManager.registerConfig,[module$src$app$conf$DispatchingConstants.default.callbackParamTypes.DATA,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.PLUGIN,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.TOKEN]);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PLUGIN_ACTIVE,
module$src$shared$constants$MessagingConstants.default.messageDataTypes.PLUGIN_RUNTIME_ID,a.parameterManager.refreshPluginInitial,[module$src$app$conf$DispatchingConstants.default.callbackParamTypes.PLUGIN,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.TOKEN]);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.EXPORT_REGISTER,module$src$shared$constants$MessagingConstants.default.messageDataTypes.EXPORT_DEFINITION,a.exportManager.registerMultipleExports,
[module$src$app$conf$DispatchingConstants.default.callbackParamTypes.DATA,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.PLUGIN,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.TOKEN]);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_INIT,module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_INIT,a.sceneManager.initSubScene,[module$src$app$conf$DispatchingConstants.default.callbackParamTypes.DATA,
module$src$app$conf$DispatchingConstants.default.callbackParamTypes.PLUGIN,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.TOKEN]);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_OUTPUTVERSION,module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_OUTPUTVERSION_JSON,a.sceneManager.addJSONOutputVersionToSubScene,[module$src$app$conf$DispatchingConstants.default.callbackParamTypes.DATA,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.PLUGIN,
module$src$app$conf$DispatchingConstants.default.callbackParamTypes.TOKEN]);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.SCENE_SUBSCENE_OUTPUTVERSION,module$src$shared$constants$MessagingConstants.default.messageDataTypes.SUBSCENE_OUTPUTVERSION_OBJ,a.sceneManager.addOutputVersionToSubScene,[module$src$app$conf$DispatchingConstants.default.callbackParamTypes.DATA,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.PLUGIN,module$src$app$conf$DispatchingConstants.default.callbackParamTypes.TOKEN]);
b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,a.processStatusHandler.updateProcessStatus);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS,a.processStatusHandler.unregisterProcess);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,
module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ABORT,a.processStatusHandler.unregisterProcess);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,a.processStatusHandler.unregisterProcess);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_FORK,
a.processStatusHandler.forkProcessStatus);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_STATUS,a.viewportVisibilityHandler.messageReceiver);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_SUCCESS,a.viewportVisibilityHandler.messageReceiver);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,
module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_ERROR,a.viewportVisibilityHandler.messageReceiver);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.PROCESS,module$src$shared$constants$MessagingConstants.default.messageDataTypes.PROCESS_FORK,a.processStatusHandler.forkProcessStatus);b.addPartListener(module$src$shared$constants$MessagingConstants.default.messageTopics.SETTINGS_REGISTER,module$src$shared$constants$MessagingConstants.default.messageDataTypes.APP_SETTINGS,
a.settingsHandler.messageReceiver);return b.getConfig()};var module$src$app$ViewerApp={},viewerAppConstants$$module$src$app$ViewerApp=module$src$app$ViewerAppConstants.default,GlobalUtils$$module$src$app$ViewerApp=module$src$shared$util$GlobalUtils.default,StateDashboardLibrary$$module$src$app$ViewerApp=module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary;
module$src$app$ViewerApp.default=function(a){var b=this;module$src$shared$mixins$GlobalMixin.default.call(this);module$src$shared$mixins$SettingsMixin.default.call(this,a,module$src$app$ViewerAppConstants.default.defaultSettings,"app",["container","containerControls","containerSettings","resizeHandler"]);var c=module$src$shared$util$GlobalUtils.default.createRandomId();b.updateSetting("viewerRuntimeId",c);module$src$modules$shapediver_state_dashboard$StateDashboard.default.StateDashboardLibrary.getInstance(c);
module$src$shared$mixins$LoggingMixin.default.call(this);module$src$app$partials$ViewerAppLoggingPartial.default.call(this);var d={error:b.error,warn:b.warn,info:b.info,debug:b.debug,log:b.log};THREE.Extensions.Logger.bind(d);THREE.Extensions.Settings.bind({debug:function(){return!1},allowedCachedPrograms:function(){return 50}});module$src$shared$mixins$MessagingMixin.default.call(this);module$src$app$partials$ViewerAppMessagingPartial.default.call(this);this.pluginManager=module$src$app$partials$ViewerAppPluginManager.default.call(b);
this.parameterManager=module$src$app$partials$ViewerAppParameterManager.default.call(b,{pluginManager:b.pluginManager});this.exportManager=module$src$app$partials$ViewerAppExportManager.default.call(b,{pluginManager:b.pluginManager,parameterManager:b.parameterManager});this.interactionGroupManager=new module$src$3d$InteractionGroupManager.default;this.viewportManager=new module$src$3d$viewportManager$ViewportManager.default(b,d,b.interactionGroupManager);this.sceneGeometryManager=new module$src$3d$SceneGeometryManager.default(b.viewportManager,
{loggingHandler:d,messagingHandler:{message:b.message,subscribeToMessageStream:b.subscribeToMessageStream,unsubscribeFromMessageStream:b.unsubscribeFromMessageStream}});this.viewportVisibilityHandler=module$src$app$handlers$ViewportVisibilityHandler.default.call(b,{viewerApp:b,viewportManager:b.viewportManager,sceneGeometryManager:b.sceneGeometryManager});this.getContainer=function(){var a=b.viewportManager.getContainers();return 1===a.length?a[0]:a};this.sceneManager=module$src$app$partials$ViewerAppSceneManager.default.call(b,
{sceneGeometryManager:b.sceneGeometryManager});this.processStatusHandler=module$src$app$handlers$ProcessStatusHandler.default.call(b,{viewportManager:b.viewportManager});!0===this.getSetting("arkitbridge")&&(this.arApi=(0,module$src$ar$ArApiARKit.default)({viewportManager:b.viewportManager,apiResponse:module$src$api$v2$ApiResponse.default,sceneGeometryManager:b.sceneGeometryManager,settings:b.getSection("ar"),container:a.container,loggingHandler:d}));this.api=function(a){a=a||{version:1};return!a.version||
2!==a.version&&"2"!==a.version?new module$src$api$v1$ApiImplementationV1.default({exportHandler:b.exportManager,parameterHandler:b.parameterManager,pluginHandler:b.pluginManager,processStatusHandler:b.processStatusHandler,sceneManager:b.sceneManager,settingsHandler:b.settingsHandler,threeDManager:b.viewportManager.getApis()[0].threeDManager,viewportVisibilityHandler:b.viewportVisibilityHandler,messagingHandler:{message:b.message,subscribeToMessageStream:b.subscribeToMessageStream,unsubscribeFromMessageStream:b.unsubscribeFromMessageStream,
getFailedStatusMessages:b.getFailedStatusMessages},loggingHandler:d,app:b},a):new module$src$api$v2$ApiImplementationV2_1.default({exportHandler:b.exportManager,parameterHandler:b.parameterManager,pluginHandler:b.pluginManager,processStatusHandler:b.processStatusHandler,sceneManager:b.sceneManager,settingsHandler:b.settingsHandler,viewportManager:b.viewportManager,sceneGeometryManager:b.sceneGeometryManager,interactionGroupManager:b.interactionGroupManager,arApi:b.arApi,messagingHandler:{message:b.message,
subscribeToMessageStream:b.subscribeToMessageStream,unsubscribeFromMessageStream:b.unsubscribeFromMessageStream,getFailedStatusMessages:b.getFailedStatusMessages},loggingHandler:d,app:b},a)};a.container&&b.viewportManager.createThreeDManager(a.container);this.settingsHandler=module$src$app$handlers$SettingsHandler.default.call(b,{viewportManager:b.viewportManager,parameterManager:b.parameterManager,exportManager:b.exportManager,pluginManager:b.pluginManager,app:b});this.setupDispatching(module$src$app$conf$DefaultDispatching.default.call(b,
{parameterManager:b.parameterManager,exportManager:b.exportManager,pluginManager:b.pluginManager,sceneManager:b.sceneManager,processStatusHandler:b.processStatusHandler,viewportVisibilityHandler:b.viewportVisibilityHandler,settingsHandler:b.settingsHandler}));this.viewportVisibilityHandler.init();a.build_version&&a.build_date&&("number"===typeof a.brandedModeConsole?console.log((1===a.brandedModeConsole?"SD":"ShapeDiver")+" Viewer App "+a.build_version+", built "+a.build_date):console.log("%cShapeDiver Viewer App "+
a.build_version+"           \n%c"+a.build_date+"\n\n%cWe're hiring: https://shapediver.com/jobs","font-size:16px; font-weight:200; letter-spacing:0.02em; line-height:1.4em; font-family:helvetica,arial; color: #0a12c6; background:url(https://s3.amazonaws.com/wp-shapediver-content/static/images/logomark_gradient%40400x17.png) no-repeat; display: block; background-size: 400px 17px; background-position: right bottom;","font-size:10px; font-weight:200; letter-spacing:0.02em; line-height:1.4em; font-family:helvetica,arial; color: #be47fd;",
"font-size:12px; font-weight:200; letter-spacing:0.02em; line-height:1.4em; font-family:helvetica,arial; color: #0a12c6;"));return this};var module$build$package={},GLOBAL_UTILS$$module$build$package=module$src$shared$util$GlobalUtils.default,BUILD_DATA$$module$build$package=module$build$build_data.default,API_REFLECTOR$$module$build$package=module$src$api$v2$ApiReflectorV2_1.default,RUNNING_IN_BROWSER$$module$build$package=module$src$shared$util$GlobalUtils.default.runningInBrowser(),RUNNING_IN_IFRAME$$module$build$package=module$src$shared$util$GlobalUtils.default.runningInIframe(),SETTING_DEFINITIONS$$module$build$package={anchorElements:{type:"boolean",
defval:RUNNING_IN_BROWSER$$module$build$package},authorization:{type:"string",defval:""},arkitbridge:{type:"boolean",defval:!1},brandedMode:{type:"boolean",defval:!0},busyGraphic:{type:"string",defval:null},createButtons:{type:"boolean",defval:!0},editMode:{type:"boolean",defval:!1},commitParameters:{type:"boolean",defval:!1},exportModal:{type:"boolean",defval:!0},showControlsButton:{type:"boolean",defval:!0},showControlsInitial:{type:"boolean",defval:!1},showSettingsButton:{type:"boolean",defval:!0},
showSettingsInitial:{type:"boolean",defval:!1},showZoomButton:{type:"boolean",defval:!0},zoomButtonResetsCamera:{type:"boolean",defval:!1},showFullscreenButton:{type:"boolean",defval:!0},showInitialSpinner:{type:"boolean",defval:!0},showBusySpinner:{type:"boolean",defval:!0},viewportOverlays:{type:"boolean",defval:!0},apiversion:{type:"string",defval:"2"},runtimeId:{type:"string",defval:""},blurSceneWhenBusy:{type:"boolean",defval:!0},deferGeometryLoading:{type:"boolean",defval:!1},ignoreSuperseded:{type:"boolean",
defval:!0},exposeViewer:{type:"boolean",defval:!1},loggingLevel:{type:"number",defval:-1},messageLoggingLevel:{type:"number",defval:-1},iframeDebugging:{type:"boolean",defval:!1},modelViewUrl:{type:"string",defval:""},showSceneMode:{type:"number",defval:2},ticket:{type:"string",defval:""},iframeId:{type:"string",defval:"sdv-iframe"},commPluginRuntimeId:{type:"string",defval:"CommPlugin_1"}},ParametricViewer$$module$build$package=function(){var a=this;this.constants=module$src$app$ViewerAppConstants.default;
this.plugins={runtimeIds:[]};this.plugins.CommPlugin=module$src$plugins$comm$CommPlugin.default;this.plugins.PluginPrototype=module$src$plugins$PluginPrototype.default;this.apps={};this.apps.controls=module$src$api$apps$SDControls.default.default;this.apps.domElements=module$src$api$apps$DomElementManager.default;this.apps.overlays=module$src$api$apps$UIkitViewportOverlays.default;this.apps.exportModal=module$src$api$apps$UIkitExportModal.default;this.utils=module$src$shared$util$GlobalUtils.default;
this.getBuildData=function(){return module$src$shared$util$GlobalUtils.default.deepCopy(module$build$build_data.default)};this.ParametricViewer=function(b){b=b||{};if(RUNNING_IN_IFRAME$$module$build$package&&(b.useQueryStringParameters||b.forceQueryStringParameters)){var c=module$src$shared$util$GlobalUtils.default.parseQueryString(window.location.search.substring(1));Object.keys(c).forEach(function(a){if(SETTING_DEFINITIONS$$module$build$package.hasOwnProperty(a)&&(b.forceQueryStringParameters||
!b.hasOwnProperty(a))){var d=SETTING_DEFINITIONS$$module$build$package[a];b[a]="boolean"===d.type?module$src$shared$util$GlobalUtils.default.toBoolean(c[a],d.defval):"number"===d.type?module$src$shared$util$GlobalUtils.default.toNumber(c[a],d.defval):c[a]}})}b.domElementIdPrefix=b.domElementIdPrefix||"sdv-container";if(RUNNING_IN_BROWSER$$module$build$package){b.container||(b.container=document.getElementById(b.domElementIdPrefix+"-viewport"));!b.container&&1<(b.logginglevel&3)&&console.log("No viewport container");
b.containerControls=void 0===b.containerControls?document.getElementById(b.domElementIdPrefix+"-controls"):b.containerControls;b.containerSettings=void 0===b.containerSettings?document.getElementById(b.domElementIdPrefix+"-settings"):b.containerSettings;var d=b.container?Array.isArray(b.container)&&0<b.container.length?b.container[0].parentElement:b.container.parentElement:null,e=b.containerControls,f=b.containerSettings;if(d&&e&&f){var h=d.parentElement,g=f.parentElement;if(h===e.parentElement&&
h===g&&null!==h){var k=[h,d,e,f];b.resizeHandler=function(){var a="landscape",b="portrait",c=250,d=h.offsetWidth,g=0,l="landscape";"none"!==e.style.display&&(d-=c,g+=1);"none"!==f.style.display&&(d-=c,g+=1);h.offsetHeight>d&&(a="portrait",b="landscape",c=40+(1<g?99:198),l="portrait");k.forEach(function(c){c&&(c.classList.remove(b),c.classList.add(a))});e.style.flexBasis=c+"px";f.style.flexBasis=c+"px";c=new CustomEvent("viewer-resized",{detail:{mode:l,flexBasis:c,clientWidth:window.innerWidth}});
f.dispatchEvent(c);e.dispatchEvent(c)};window.addEventListener("resize",b.resizeHandler);window.addEventListener("orientationchange",b.resizeHandler);b.resizeHandler()}}}Object.keys(SETTING_DEFINITIONS$$module$build$package).forEach(function(a){if(!b.hasOwnProperty(a)){var c=SETTING_DEFINITIONS$$module$build$package[a],d=a.toLowerCase();d=module$src$shared$util$GlobalUtils.default.getNodeAttribute(b.container,d,c.defval);b[a]="boolean"===c.type?module$src$shared$util$GlobalUtils.default.toBoolean(d,
c.defval):"number"===c.type?module$src$shared$util$GlobalUtils.default.toNumber(d,c.defval):d}});if(1>b.showSceneMode||3<b.showSceneMode)b.showSceneMode=2;b.editMode||void 0!==b.showSettingsButton||(b.showSettingsButton=!1);for(var l in module$build$build_data.default)b[l]=module$build$build_data.default[l];RUNNING_IN_IFRAME$$module$build$package&&document.referrer&&parent.postMessage({type:"sdv-DOMContentLoaded",iframeId:b.iframeId},document.referrer);var m=new module$src$app$ViewerApp.default(b),
n=m.api({version:b.apiversion,runtimeId:b.runtimeId});n.apps={};n.getApiV2=function(a){a=a||{};a.version=2;return m.api(a)};b.exposeViewer&&(module$build$build_data.default.build_branch.startsWith("feature")||module$build$build_data.default.build_branch.startsWith("development"))&&(n.getViewer=function(){console.warn("Direct access to the ShapeDiver Viewer is disabled for release builds.");return m});d=n;d.scene||(d=n.getApiV2());if(b.ticket){var r={runtimeId:b.commPluginRuntimeId,ticket:b.ticket,
deferGeometryLoading:b.deferGeometryLoading,loggingLevel:b.loggingLevel,messageLoggingLevel:b.messageLoggingLevel,authorization:b.authorization,ignoreSuperseded:b.ignoreSuperseded};b.modelViewUrl&&(r.modelViewUrl=b.modelViewUrl);g=new a.plugins.CommPlugin(r);d.plugins.registerPluginAsync(g).then(function(c){RUNNING_IN_IFRAME$$module$build$package&&document.referrer&&(c.err||c.data&&"failed"===c.data.status?parent.postMessage({type:"sdv-CommPluginFailed",runtimeId:r.runtimeId,iframeId:b.iframeId},
document.referrer):(a.plugins.runtimeIds.push(r.runtimeId),parent.postMessage({type:"sdv-CommPluginLoaded",data:c.data,runtimeId:r.runtimeId,iframeId:b.iframeId},document.referrer)))},function(a){RUNNING_IN_IFRAME$$module$build$package&&document.referrer&&parent.postMessage({type:"sdv-CommPluginFailed",err:a,runtimeId:r.runtimeId,iframeId:b.iframeId},document.referrer)})}if(b.viewportOverlays){var u={containerViewport:b.container,containerControls:b.containerControls,containerSettings:b.containerSettings,
domElementIdPrefix:b.domElementIdPrefix};"brandedMode createButtons showControlsButton showSettingsButton showControlsInitial showSettingsInitial showZoomButton showFullscreenButton showInitialSpinner showBusySpinner viewportOverlays zoomButtonResetsCamera resizeHandler".split(" ").forEach(function(a){u[a]=b[a]});try{n.apps.overlays=new a.apps.overlays(d,u),n.apps.overlays||n.warn("SDVApp.ParametricViewer","Viewport overlays could not be created, has UIkit been loaded ?")}catch(q){delete n.apps.overlays,
n.warn("SDVApp.ParametricViewer","Exception when creating viewport overlays, has UIkit been loaded ?",q)}b.busyGraphic&&n.apps.overlays.setBusyGraphic(b.busyGraphic)}if(b.containerControls){g={editMode:b.editMode,commitParameters:b.commitParameters};n.apps.overlays&&(g.showMessage=n.apps.overlays.showMessage);try{n.apps.controls=new a.apps.controls(d,b.containerControls,g,{onElementCreated:b.resizeHandler}),n.apps.controls||n.warn("SDVApp.ParametricViewer","Parameter controls could not be created.")}catch(q){delete n.apps.controls,
n.warn("SDVApp.ParametricViewer","Exception when creating parameter controls",q)}}if(b.containerSettings)try{n.apps.settings=new a.apps.controls(d,b.containerSettings,{settings:!0,editMode:b.editMode},{onElementCreated:b.resizeHandler}),n.apps.settings||n.warn("SDVApp.ParametricViewer","Setting controls could not be created.")}catch(q){delete n.apps.settings,n.warn("SDVApp.ParametricViewer","Exception when creating setting controls",q)}if(b.anchorElements)try{n.apps.domElements=new a.apps.domElements(d),
n.apps.domElements||n.warn("SDVApp.ParametricViewer","Anchor elements app could not be created.")}catch(q){delete n.apps.domElements,n.warn("SDVApp.ParametricViewer","Exception when creating anchor elements app",q)}if(b.exportModal)try{n.apps.exportModal=new a.apps.exportModal(d,{domElementIdPrefix:b.domElementIdPrefix+"-modal-export"}),n.apps.exportModal||n.warn("SDVApp.ParametricViewer","Modal dialog could not be created, has UIkit been loaded ?")}catch(q){delete n.apps.exportModal,n.warn("SDVApp.ParametricViewer",
"Exception when creating modal dialog",q)}var p=function(a){n.apps.overlays&&(a.setBusyGraphic=n.apps.overlays.setBusyGraphic,a.setBusyGraphicPosition=n.apps.overlays.setBusyGraphicPosition,a.hideControls=function(){n.apps.overlays.buttonOnClick("controls",!1);n.apps.overlays.toggleVisibility("controls",!1);a._callCommandResultCallback("hideControls",!0)},a.hideFullscreenToggle=function(){n.apps.overlays.toggleVisibility("fullscreen",!1);return!0},a.hideZoomToggle=function(){n.apps.overlays.toggleVisibility("zoom",
!1);return!0},a.showControls=function(){n.apps.overlays.buttonOnClick("controls",!0);n.apps.overlays.toggleVisibility("controls",!0);a._callCommandResultCallback("showControls",!0)},a.showFullscreenToggle=function(){n.apps.overlays.toggleVisibility("fullscreen",!0);return!0},a.showZoomToggle=function(){n.apps.overlays.toggleVisibility("zoom",!0);return!0});return a};1===Number(b.apiversion)&&p(n);n.getApiV1=function(a){a=a||{};a.version=1;return p(m.api(a))};RUNNING_IN_IFRAME$$module$build$package&&
document.referrer&&(d.apps||(d.apps=n.apps),(new module$src$api$v2$ApiReflectorV2_1.default(parent,document.referrer,b.iframeDebugging,b.iframeId)).reflect(d,"api").then(function(){parent.postMessage({type:"sdv-ViewerLoaded",iframeId:b.iframeId},document.referrer);b.iframeDebugging&&console.log("API object could be reflected")},function(){b.iframeDebugging&&console.log("API object could NOT be reflected")}));return n};return this};module$build$package.default=new ParametricViewer$$module$build$package;var SDVApp=module$build$package.default;



//# sourceMappingURL=sdv.concat.min.js.map